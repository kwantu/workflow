(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Workflow = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function Workflow(e,s,r){var t=this;if(""===e||void 0===e)throw util.error("ParamRequired","A profile id is required.");if("string"!=typeof e)throw new Error("The profile id must be a javascript string.");if(t.profile=e||"",""===s||void 0===s)throw util.error("ParamRequired","An app id is required.");if("string"!=typeof s)throw new Error("The app id must be a javascript string.");if(t.app=s||"",""===r||void 0===r)throw util.error("ParamRequired","A workflow configuration is required.");"object"!=typeof r?t.config=JSON.parse(r):t.config=r,t.instance,t.subprocesses=[],t.indicators=[],t.history=[]}var Process=require("./lib/process"),util=require("utility"),userInterface=require("./lib/interface");Workflow.prototype.getProfile=function(){return this.profile},Workflow.prototype.getApp=function(){return this.app},Workflow.prototype.getConfig=function(){return this.config},Workflow.prototype.getInstance=function(){return this.instance},Workflow.prototype.setInstance=function(e){this.instance=e},Workflow.prototype.getSubProcesses=function(){return this.subprocesses},Workflow.prototype.setSubProcesses=function(e){this.subprocesses=e},Workflow.prototype.getIndicators=function(){return this.indicators},Workflow.prototype.setIndicators=function(e){this.indicators=e},Workflow.prototype.create=function(){var e=this;return new Promise(function(s,r){try{if(void 0!==e.instance){var t=util.warn("Instance already exists.",e);s(t)}else{var o={_id:"",version:"",type:"workflowInstance",processes:[]};o._id=e.profile+":processes",o.version=e.config.version,e.instance=o;var i=util.success("Workflow processes instance created successfully.",e);s(i)}}catch(e){r(e)}})},Workflow.prototype.initialise=function(e,s){var r=this;return new Promise(function(t,o){try{var i=[];if(""!==e&&void 0!==e){if(i=r.config.processes.filter(function(s){if(s._id===e)return s}),void 0===i[0]._id){var n=util.error("WFConfigError","No valid process definition found with process id: "+e);o(n)}}else i.push(r.config.processes[0]),e=r.config.processes[0]._id;var c=[];r.instance.processes.filter(function(s){s.id===e&&c.push(s)});var u=c.length+1,f={id:"",seq:"",subProcesses:[]};f.id=e,f.seq=u,r.instance.processes.push(f);var a=i[0].subProcesses[0]._id,p=1;r.instance.processes.filter(function(s){s.id===e&&s.seq===u&&(p=s.subProcesses.length+1)}),Process.subProcess(e,u,a,p,s,r).then(function(s){var i=r.profile+":"+r.app+":"+e+":"+u+":"+a+":"+p,n={id:a,seq:p,uuid:i};f.subProcesses.push(n),r.subprocesses.push(s.data);for(var c=0;c<r.instance.processes.length;c++){var l=r.instance.processes[c];l.id===e&&l.seq===u&&r.instance.processes.splice(c,1,f)}var d=s.data.indicators,h=s.data.step;Process.indicatorDocs(e,d,h,r).then(function(e){var s=util.success("Process: "+r.config.processes[0]._id+" initialized successfully.",r);t(s)},function(e){o(e)})},function(e){o(e)})}catch(e){o(e)}})},Workflow.prototype.transition=function(e,s,r,t,o,i,n){var c=this;return new Promise(function(u,f){try{Process.transition(e,s,r,t,o,i,n,c).then(function(o){var i=function(i){c.instance.processes.filter(function(n){n.id===e&&n.seq===s&&n.subProcesses.filter(function(e){e.id===r&&e.seq===t&&c.subprocesses.filter(function(s){if(s._id===e.uuid)if("step"===i){s.step=o.data;var r=util.success(o.message,s);u(r)}else if("stepComplete"===i){s.step=o.data.step,s.complete=!0;var r=util.success(o.message,s);u(r)}})})})};i(o.data.subProcessComplete?"stepComplete":"step")},function(e){f(e)})}catch(e){f(e)}})},Workflow.prototype.assignUser=function(e,s,r,t,o){var i=this;return new Promise(function(n,c){try{Process.assignUser(e,s,r,t,o,i).then(function(e){n(e)},function(e){c(e)})}catch(e){c(e)}})},Workflow.prototype.ui=function(){var e=this;return{getProcess:function(s,r){return new Promise(function(t,o){try{userInterface.getProcess(s,r,e).then(function(e){t(e)},function(e){o(e)})}catch(e){o(e)}})}}},module.exports=Workflow;

},{"./lib/interface":3,"./lib/process":4,"utility":5}],2:[function(require,module,exports){
"use strict";function create(e){var s=e[0]||"",t=e[1]||{},i=t.indicators||[],c=e[3]||{},r=e[2]||{};return new Promise(function(e,u){util.syncLoop(i.length,function(e){var u=e.iteration(),n=i[u]._id,a=util.getName(i[u].name,"en"),o=c.profile+":"+c.app+":"+n+":0",l={_id:o,title:a,category:{term:n,label:a},workflows:[{id:c.config._id,instance:c.instance._id,processes:[{id:s,subProcessId:t._id,step:{id:r.id,seq:r.seq,startDate:"",status:r.status,message:r.message,assignedTo:{userId:r.assignedTo.userId,name:r.assignedTo.name},comment:r.comment,complete:!1,endDate:""}}]}]};c.indicators.push(l),e.next()},function(){var s=util.success("Form created successfully.",c.indicators);e(s)})})}function save(e){var s={complete:!0,data:[]};return new Promise(function(e,t){var i=util.success("Form indicator set saved successfully.",s);e(i)})}function submit(e){var s={complete:!0,data:[]};return new Promise(function(e,t){var i=util.success("Form submitted successfully.",s);e(i)})}function authorise(e){var s={complete:!0,data:[]};return new Promise(function(e,t){var i=util.success("Form authorised successfully.",s);e(i)})}function close(e){var s={complete:!0,data:[]};return new Promise(function(e,t){var i=util.success("Form closed successfully.",s);e(i)})}var util=require("utility");module.exports={create:create,save:save,submit:submit,authorise:authorise,close:close};

},{"utility":5}],3:[function(require,module,exports){
"use strict";function getProcess(e,s,t){return new Promise(function(n,i){try{var c=[],r=[];t.instance.processes.filter(function(s){s.id===e&&(r=s)}),util.syncLoop(r.subProcesses.length,function(n){var o=n.iteration(),u=r.seq,f=r.subProcesses[o].id,a=r.subProcesses[o].seq;getSubProcess(e,u,f,a,s,t).then(function(e){c.push(e),n.next()},function(e){n.break(),i(e)})},function(){n(c)})}catch(e){i(e)}})}function getSubProcess(e,s,t,n,i,c){return new Promise(function(r,o){try{var u={id:"",seq:"",name:"",help:"",dates:"",step:""},f=[],a=[];c.instance.processes.filter(function(i){if(i.id===e&&i.seq===s){i.subProcesses.length;i.subProcesses.filter(function(e){e.id===t&&e.seq===n&&e.complete===!1&&(f=e)})}}),c.config.processes.filter(function(s){s._id===e&&s.subProcesses.filter(function(e){e._id===t&&(a=e)})}),u.id=a._id,u.seq=f.seq,u.name=util.getName(a.name,i),u.help=util.getName(a.help,i),u.dates=f.dates,u.step=f.step,r(u)}catch(e){o(e)}})}var util=require("utility");module.exports={getProcess:getProcess};

},{"utility":5}],4:[function(require,module,exports){
"use strict";function count(e){return void 0!==e?e.length:0}function preRequisites(e,t){return new Promise(function(s,i){var n=[];try{util.syncLoop(e.length,function(s){var r=s.iteration();preRequisite(e[r],t).then(function(e){n.push(!0),s.next()},function(e){n.push(!1),s.break(),i(e)})},function(){if(n.every(Boolean)){var e=util.success("Pre-requisites completed successfully.",{});s(e)}else{var t=util.error("WFPreRequisiteError","Not all pre-requisites passed.");i(t)}})}catch(e){i(e)}})}function preRequisite(e,t){return new Promise(function(s,i){switch(e._type){case"processInstances":try{var n=e._parameter,r=count(getSubProcess(n,t)),o=util.compare(r,e._operator,parseInt(e._value));if(o){var a=util.success("Pre-requisites passed.",{});s(a)}else{var c="";e.message.i18n.filter(function(e){if("en"===e._lang){c=e.value;var t=util.error("WFPreRequisiteError",c);i(t)}})}}catch(e){i(e)}default:var u=util.error("WFPreRequisiteError","Pre-requisite type: "+e._type+" not defined.");i(u)}})}function preActions(e,t){return new Promise(function(s,i){var n=[];try{util.syncLoop(e.length,function(s){var r=s.iteration();action(e[r],t).then(function(e){n.push(!0),s.next()},function(e){n.push(!1),s.break(),i(e)})},function(){if(n.every(Boolean)){var e=util.success("Pre-requisites completed successfully.",{});s(e)}else{var t=util.error("WFPreRequisiteError","Not all pre-requisites passed.");i(t)}})}catch(e){i(e)}})}function getSubProcess(e,t){return void 0===t.subprocesses?[]:void t.subprocesses.filter(function(t){if(t.id===e)return t})}function subProcess(e,t,s,i,n,r){var o=[],a=[],c=[];r.instance.processes.filter(function(n){if(n.id===e&&n.seq===t){n.subProcesses.length;n.subProcesses.filter(function(e){if(e.id===s&&e.seq===i){var t=e.uuid;r.subprocesses.filter(function(e){e._id===t&&(o=e)})}})}}),r.config.processes.filter(function(t){t._id===e&&(a=t,t.subProcesses.filter(function(e){e._id===s&&(c=e)}))});var u={_id:r.profile+":"+r.app+":"+e+":"+t+":"+s+":"+i,id:s,type:"workflowInstanceSubProcess",seq:i,initiated:!1,dates:{created:"",valid:"",due:"",closed:""},complete:!1,indicators:[],step:{}};return new Promise(function(d,l){try{var f=a.prerequisites;preRequisites(f,r).then(function(a){var f=c.initiate;initiate(f,o,n).then(function(o){u.initiated=o.data.initiated,u.dates=o.data.dates;var a=c.steps[0]._id,f=c.steps[0].transitions[0]._id,p=1;step(e,t,s,i,a,p,n,r).then(function(o){u.step=o.data,indicators(c.indicators,r).then(function(o){u.indicators=o.data,transition(e,t,s,i,a,f,n,r).then(function(e){u.step=e.data;var t=util.success(e.message,u);d(t)},function(e){l(e)})},function(e){l(e)})},function(e){l(e)})},function(e){l(e)})},function(e){l(e)})}catch(e){l(e)}})}function initiate(e,t,s){var i={initiated:!1,dates:{created:"",valid:"",due:"",closed:""}};return new Promise(function(n,r){var o=function(){switch(e._type){case"user":if(i.dates.created=s.createdDate,"userSelected"===e.dates.valid._type)if(void 0!==s.validDate)i.dates.valid=s.validDate;else{var t=util.error("WFInitiateError","No valid date passed in - {inputData.validDate}");r(t)}if("userSelected"===e.dates.due._type)if(void 0!==s.dueDate)i.dates.due=s.dueDate;else{var t=util.error("WFInitiateError","No due date passed in - {inputData.dueDate}");r(t)}i.initiated=!0;var o=util.success("Sub-Process initiate completed successfully.",i);n(o);break;default:var t=util.error("WFInitiateError","Initiate type: "+e._type+" not defined.");r(t)}};if(void 0===t.complete)o();else if(!t.complete)if(e.parallelInstances)o();else{var a=util.error("WFInitiateError","Sub-process: "+t.id+" still active and parallel instances are not allowed.");r(a)}})}function step(e,t,s,i,n,r,o,a){var c,u={id:"",seq:"",status:"",message:"",assignedTo:{userId:"",name:""},comment:""},d={},l="",f={};return new Promise(function(p,v){try{a.instance.processes.filter(function(n){n.id===e&&n.seq===t&&n.subProcesses.filter(function(e){e.id===s&&e.seq===i&&(l=e.uuid)})}),a.subprocesses.filter(function(e){e._id===l&&(c=e)}),a.config.processes.filter(function(t){t._id===e&&t.subProcesses.filter(function(e){e._id===s&&(d=e,e.steps.filter(function(e){e._id===n&&(f=e)}))})}),u.id=n,u.seq=r,u.status=f._setInstanceStatusTo,u.message=f._setStatusMsgTo,u.assignedTo.userId=void 0!==o.userId?o.userId:"",u.assignedTo.name=void 0!==o.name?o.name:"",u.comment=void 0!==o.comment?o.comment:"";var m=void 0!==c?c.indicators:[];indicatorDocs(e,m,u,a).then(function(n){if(void 0!==f.actions[0])actions(f.actions,e,t,s,i,d,u,a).then(function(e){var t=util.success("Actions completed successfully.",u);p(t)},function(e){v(e)});else if(void 0!==f.task){var r=util.success("Task awaiting user action.",u);p(r)}},function(e){v(e)})}catch(e){v(e)}})}function indicators(e,t){var s=[];return new Promise(function(i,n){try{for(var r=0;r<e.length;r++)for(var o=e[r]._id,a=0;a<t.indicators.length;a++){var c=t.indicators[a],u={id:"",instances:[]},d={uuid:"",title:"",key:"",seq:1};o===c.category.term&&(u.id=o,d.uuid=c._id,d.title=c.title,d.key="",d.seq=1,u.instances.push(d),s.push(u))}var l=util.success("Process indicator model updated.",s);i(l)}catch(e){n(e)}})}function assignUser(e,t,s,i,n,r){return new Promise(function(o,a){try{var c="";r.instance.processes.filter(function(n){n.id===e&&n.seq===t&&n.subProcesses.filter(function(e){e.id===s&&e.seq===i&&(c=e.uuid)})}),r.subprocesses.filter(function(t){if(t._id===c){t.step.assignedTo.userId=n.id,t.step.assignedTo.name=n.name;for(var s=t.indicators,i=0;i<s.length;i++)for(var a=s[i],u=0;u<a.instances.length;u++)for(var d=a.instances[u],l=0;l<r.indicators.length;l++){var f=r.indicators[l];d.uuid===f._id&&f.workflows.filter(function(t){t.id===r.config._id&&t.processes.filter(function(t){t.id===e&&(t.step.assignedTo.userId=n.id,t.step.assignedTo.name=n.name)})})}var p=util.success('User assigned successfully. UserId: "'+n.id+'", Name: "'+n.name+'"',t);o(p)}})}catch(e){a(e)}})}function indicatorDocs(e,t,s,i){return new Promise(function(n,r){try{if(void 0===t){util.error("WFIndicatorsUpdate","Indicators parameter is required. - Value: "+t);r(err)}else{for(var o=0;o<t.length;o++)for(var a=t[o],c=0;c<a.instances.length;c++)for(var u=a.instances[c],d=0;d<i.indicators.length;d++){var l=i.indicators[d];u.uuid===l._id&&l.workflows.filter(function(t){t.id===i.config._id&&t.processes.filter(function(t){t.id===e&&(t.step.id=s.id,t.step.seq=s.seq,t.step.status=s.status,t.step.message=s.message,t.step.assignedTo.userId=s.assignedTo.userId,t.step.assignedTo.name=s.assignedTo.name,t.step.comment=void 0!==s.comment?s.comment:"")})})}var f=util.success("Indicator documents workflow process model updated.",i);n(f)}}catch(e){r(e)}})}function actions(e,t,s,i,n,r,o,a){var c=[];return new Promise(function(u,d){util.syncLoop(e.length,function(u){var l=u.iteration();action(e[l],t,s,i,n,r,o,a).then(function(t){var s={id:e[l]._id,seq:l,data:t};c.push(s),u.next()},function(e){u.break(),d(e)})},function(){var e=util.success("Actions completed successfully.",c);u(e)})})}function action(e,t,s,i,n,r,o,a){return new Promise(function(c,u){var d=[],l="global",f="";void 0!==e._id&&(l=e._id.split(".")[0]),void 0!==e._id&&(f=e._id.split(".")[1]),d.length=0;for(var p=0;p<e._args.length;p++){var v=e._args[p];switch(v){case"processId":d.push(t);break;case"processSeq":d.push(s);break;case"subProcessId":d.push(i);break;case"subProcessSeq":d.push(n);break;case"subProcess":d.push(r);break;case"step":d.push(o);break;default:d=[]}}if(d.push(a),"form.create"===e._id)form.create(d).then(function(e){c(e.data)},function(e){u(e)});else if("form.authorise"===e._id)form.authorise(d).then(function(e){c(e.data)},function(e){u(e)});else if("form.close"===e._id)form.close(d).then(function(e){c(e.data)},function(e){u(e)});else{var m=util.error("WFActionError","Method: "+action_id+" not defined.");u(m)}})}function task(e){return"Implementation pending.."}function transition(e,t,s,i,n,r,o,a){return new Promise(function(c,u){try{for(var d=0,l="",f=0,p=[],v=a.config.processes.filter(function(t){if(t._id===e)return t}),m=v[0].subProcesses.filter(function(e){if(e._id===s)return e}),h=m[0].steps.filter(function(e){if(e._id===n)return e}),g=h[0].transitions.filter(function(e){if(e._id===r)return e}),_=0;_<m[0].steps.length;_++)m[0].steps[_]._id===n&&(d=parseInt(m[0].steps[_]._seq));m[0].steps.filter(function(e){f=d+1,parseInt(e._seq)===f&&(l=e._id)}),a.instance.processes.filter(function(n){n.id===e&&n.seq===t&&n.subProcesses.filter(function(e){if(e.id===s&&e.seq===i){var t=e.uuid;a.subprocesses.filter(function(e){e._id===t&&(p=e)})}})});var y=m[0].steps.length;switch(g[0]._type){case"auto":"nextStep"===g[0].goTo._type&&step(e,t,s,i,l,f,o,a).then(function(e){if(f===y){var t=util.success("All Step transitions have completed successfully.",{subProcessComplete:!0,step:e.data});c(t)}else{var t=util.success("Step transition completed successfully.",e.data);c(t)}var t=util.success("Step transition completed successfully.",e.data);c(t)},function(e){u(e)});break;case"user":if("nextStep"===g[0].goTo._type)step(e,t,s,i,l,f,o,a).then(function(e){if(f===y){var t=util.success("All Step transitions have completed successfully.",{subProcessComplete:!0,step:e.data});c(t)}else{var t=util.success("Step transition completed successfully.",e.data);c(t)}var t=util.success("Step transition completed successfully.",e.data);c(t)},function(e){u(e)});else if("stepId"===g[0].goTo._type){var P=g[0].goTo._stepId,b=1;m[0].steps.filter(function(e){e._id===P&&(b=parseInt(e._seq))}),step(e,t,s,i,P,b,o,a).then(function(e){if(b===y){var t=util.success("All Step transitions have completed successfully.",{subProcessComplete:!0,step:e.data});c(t)}else{var t=util.success("Step transition completed successfully.",e.data);c(t)}var t=util.success("Step transition completed successfully.",e.data);c(t)},function(e){u(e)})}break;default:var q=util.error("WFTransitionError","Transition type: "+g[0]._type+" not defined.");u(q)}}catch(e){u(e)}})}function postActions(e){return"Implementation pending.."}var util=require("utility"),form=require("./form");module.exports={preRequisites:preRequisites,preActions:preActions,subProcess:subProcess,indicatorDocs:indicatorDocs,task:task,transition:transition,assignUser:assignUser};

},{"./form":2,"utility":5}],5:[function(require,module,exports){
"use strict";function success(r,e){return{message:r,data:e}}function warn(r,e){return console.warn(e),{warning:r,data:e}}function error(r,e){var n=new Error("");return n.name=r,n.message=e,n}function syncLoop(r,e,n){var a=0,t=!1,o=!1,u={next:function(){return t&&o&&n?n():void(a<r?(a++,e(u)):(t=!0,n&&n()))},iteration:function(){return a-1},break:function(r){t=!0,o=r}};return u.next(),u}function compare(r,e,n){switch(e){case"greaterThan":return r>n;case"lessThan":return r<n;case"greaterThanEqual":return r>=n;case"lessThanEqual":return r<=n;case"equalTo":return r===n;case"notEqualTo":return r!==n}}function getName(r,e){if(void 0!==r)for(var n=0;n<r.length;n++)if(r[n].i18n._lang===e)return r[n].i18n.value}module.exports={success:success,warn:warn,error:error,syncLoop:syncLoop,compare:compare,getName:getName};

},{}]},{},[1])(1)
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Vzci9sb2NhbC9saWIvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsImluZGV4LmpzIiwibGliL2Zvcm0uanMiLCJsaWIvaW50ZXJmYWNlLmpzIiwibGliL3Byb2Nlc3MuanMiLCJub2RlX21vZHVsZXMvdXRpbGl0eS9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBLFlBMENBLFNBQVMsVUFBUyxFQUFTLEVBQUssR0FDL0IsR0FBSSxHQUFRLElBRVosSUFBZ0IsS0FBWixHQUE4QixTQUFaLEVBQ2YsS0FBTSxNQUFLLE1BQU0sZ0JBQWlCLDRCQUMvQixJQUF3QixnQkFBZCxHQUNoQixLQUFNLElBQUksT0FBTSw4Q0FLcEIsSUFISSxFQUFNLFFBQVUsR0FBVyxHQUduQixLQUFSLEdBQXNCLFNBQVIsRUFDWCxLQUFNLE1BQUssTUFBTSxnQkFBaUIseUJBQy9CLElBQW9CLGdCQUFWLEdBQ2hCLEtBQU0sSUFBSSxPQUFNLDBDQUtqQixJQUhDLEVBQU0sSUFBTSxHQUFPLEdBR0wsS0FBWCxHQUE0QixTQUFYLEVBQ3BCLEtBQU0sTUFBSyxNQUFNLGdCQUFpQix3Q0FDTCxpQkFBYixHQUNiLEVBQU0sT0FBUyxLQUFLLE1BQU0sR0FFN0IsRUFBTSxPQUFTLEVBR2hCLEVBQU0sU0FFUixFQUFNLGdCQUVOLEVBQU0sY0FFTixFQUFNLFdBekVSLEdBQUksU0FBVSxRQUFRLGlCQUNsQixLQUFPLFFBQVEsV0FDZixjQUFnQixRQUFRLGtCQW1GNUIsVUFBUyxVQUFVLFdBQWEsV0FDL0IsTUFBTyxNQUFLLFNBV2IsU0FBUyxVQUFVLE9BQVMsV0FDM0IsTUFBTyxNQUFLLEtBV2IsU0FBUyxVQUFVLFVBQVksV0FDOUIsTUFBTyxNQUFLLFFBV2IsU0FBUyxVQUFVLFlBQWMsV0FDaEMsTUFBTyxNQUFLLFVBYWIsU0FBUyxVQUFVLFlBQWMsU0FBUyxHQUN6QyxLQUFL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U0FBUyxHQUNYLEdBQU8sRUFDUCxFQUFhLEdBSXJCLE9BREEsR0FBSyxPQUNFLEVBR1gsUUFBUyxTQUFRLEVBQVMsRUFBVSxHQUNqQyxPQUFRLEdBQ1AsSUFBSyxjQUNOLE1BQU8sR0FBVSxDQUNsQixLQUFLLFdBQ0osTUFBTyxHQUFVLENBQ2xCLEtBQUssbUJBQ0osTUFBTyxJQUFXLENBQ25CLEtBQUssZ0JBQ0osTUFBTyxJQUFXLENBQ25CLEtBQUssVUFDSixNQUFPLEtBQVksQ0FDcEIsS0FBSyxhQUNKLE1BQU8sS0FBWSxHQUl0QixRQUFTLFNBQVEsRUFBSyxHQUNyQixHQUFZLFNBQVIsRUFDSCxJQUFLLEdBQUksR0FBSSxFQUFHLEVBQUksRUFBSSxPQUFTLElBQ2hDLEdBQUksRUFBSSxHQUFHLEtBQUssUUFBVSxFQUN6QixNQUFPLEdBQUksR0FBRyxLQUFLLE1BTXZCLE9BQU8sU0FFTCxRQUFTLFFBQ1QsS0FBTSxLQUNOLE1BQU8sTUFDUCxTQUFVLFNBQ1YsUUFBUyxRQUNWLFFBQVMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgUHJvY2VzcyA9IHJlcXVpcmUoJy4vbGliL3Byb2Nlc3MnKTtcbnZhciB1dGlsID0gcmVxdWlyZSgndXRpbGl0eScpO1xudmFyIHVzZXJJbnRlcmZhY2UgPSByZXF1aXJlKCcuL2xpYi9pbnRlcmZhY2UnKTtcblxuLypnbG9iYWxzICovXG5cbi8qKlxuICogQSBuZXcgV29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2UgY29udGFpbnMgdGhlIHJlZmVyZW5jZSB0byB0aGUgYXBwbGljYXRpb25cbiAqIGFuZCBhc3NvY2lhdGVkIHByb2ZpbGUgd2hpY2ggaXQgcmVxdWlyZXMgYXMgdGhlIGZpcnN0IHR3byBwYXJhbWV0ZXJzLiBJdCBhbHNvXG4gKiByZXF1aXJlcyBhIHdvcmtmbG93IGNvbmZpZ3VyYXRpb24sIGFzIHRoZSB0aGlyZCBwYXJhbWV0ZXIsIHdoaWNoIGlzIHVzZWQgdG9cbiAqIGRlc2NpYmUgdGhlIHdvcmtmbG93IHByb2Nlc3Nlcy4gSWYgYSB3b3JrZmxvdyBpbnN0YW5jZSBleGlzdHMgeW91IGNhbiBwYXNzIGl0XG4gKiBpbiBhcyB0aGUgZm91cnRoIHBhcmFtZXRlciB3aGljaCBpdCB3aWxsIHRoZW4gdXNlLCBlbHNlIGNyZWF0ZSBhIG5ldyBvbmUuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2ZpbGUgLSBUaGUgY3VycmVudCBwcm9maWxlIGlkXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwIC0gVGhlIGFzc29jaWF0ZWQgYXBwbGljYXRpb24gaWRcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgLSBUaGUgYXBwbGljYXRpb24gd29ya2Zsb3cgY29uZmlndXJhdGlvbiAvIGRlZmluaXRpb25cbiAqIEBwYXJhbSB7T2JqZWN0fSBbaW5zdGFuY2VdIC0gQW4gZXhpc3RpbmcgYXBwbGljYXRpb24gcHJvZmlsZSB3b3JrZmxvdyBpbnN0YW5jZSBiYXNlZFxuICogb24gdGhlIGRlZmluaXRpb25cbiAqXG4gKiBAYXV0aG9yIEJyZW50IEdvcmRvblxuICogQHZlcnNpb24gMC4xLjBcbiAqXG4gKiBAZXhhbXBsZVxuICogdmFyIGNvbmZpZyA9IHsgJ19pZCc6ICdhYmMxMjMnIH07XG4gKiB2YXIgaW5zdGFuY2UgPSB7ICdfaWQnOiAnaW5zdGFuY2VfYWJjMTIzJyB9O1xuICogLy8gSWYgdGhlcmUgaXNuJ3QgYW4gZXhpc3RpbmcgaW5zdGFuY2VcbiAqIHZhciB3b3JrZmxvdyA9IG5ldyBXb3JrZmxvdygnMTIzNCcsICc1Njc4JywgY29uZmlnKTtcbiAqIC8vIElmIHRoZXJlIGlzIGFuIGV4aXN0aW5nIGluc3RhbmNlXG4gKiB2YXIgd29ya2Zsb3cgPSBuZXcgV29ya2Zsb3coJzEyMzQnLCAnNTY3OCcsIGNvbmZpZywgaW5zdGFuY2UpO1xuICpcbiAqIEByZXR1cm4ge09iamVjdH0gbmV3IFdvcmtmbG93IG9iamVjdFxuICpcbiAqIEB0aHJvd3MgRXJyb3I6IEEgcHJvZmlsZSBpZCBpcyByZXF1aXJlZFxuICogQHRocm93cyBFcnJvcjogQW4gYXBwIGlkIGlzIHJlcXVpcmVkXG4gKiBAdGhyb3dzIEVycm9yOiBBIHdvcmtmbG93IGNvbmZpZ3VyYXRpb24gaXMgcmVxdWlyZWRcbiAqXG4gKi9cblxuZnVuY3Rpb24gV29ya2Zsb3cocHJvZmlsZSwgYXBwLCBjb25maWcpe1xuXHR2YXIgX3RoaXMgPSB0aGlzO1xuXHQvLyBQcm9maWxlIElEIHZhbGlkYXRpb24gY2hlY2tzXG5cdGlmIChwcm9maWxlID09PSAnJyB8fCBwcm9maWxlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgdXRpbC5lcnJvcignUGFyYW1SZXF1aXJlZCcsICdBIHByb2ZpbGUgaWQgaXMgcmVxdWlyZWQuJyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YocHJvZmlsZSkgIT09ICdzdHJpbmcnKSB7XG4gICAgXHR0aHJvdyBuZXcgRXJyb3IoJ1RoZSBwcm9maWxlIGlkIG11c3QgYmUgYSBqYXZhc2NyaXB0IHN0cmluZy4nKTtcbiAgICB9IGVsc2Uge1xuICAgIFx0X3RoaXMucHJvZmlsZSA9IHByb2ZpbGUgfHwgJyc7XG4gICAgfVxuICAgIC8vIEFwcCBJRCB2YWxpZGF0aW9uIGNoZWNrc1xuXHRpZiAoYXBwID09PSAnJyB8fCBhcHAgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyB1dGlsLmVycm9yKCdQYXJhbVJlcXVpcmVkJywgJ0FuIGFwcCBpZCBpcyByZXF1aXJlZC4nKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZihhcHApICE9PSAnc3RyaW5nJykge1xuICAgIFx0dGhyb3cgbmV3IEVycm9yKCdUaGUgYXBwIGlkIG11c3QgYmUgYSBqYXZhc2NyaXB0IHN0cmluZy4nKTtcbiAgICB9IGVsc2Uge1xuICAgIFx0X3RoaXMuYXBwID0gYXBwIHx8ICcnO1xuICAgIH1cbiAgICAvLyBXb3JrZmxvdyBjb25maWd1cmF0aW9uIHZhbGlkYXRpb24gY2hlY2tzXG4gICAgaWYgKGNvbmZpZyA9PT0gJycgfHwgY29uZmlnID09PSB1bmRlZmluZWQpIHtcbiAgICBcdHRocm93IHV0aWwuZXJyb3IoJ1BhcmFtUmVxdWlyZWQnLCAnQSB3b3JrZmxvdyBjb25maWd1cmF0aW9uIGlzIHJlcXVpcmVkLicpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mKGNvbmZpZykgIT09ICdvYmplY3QnKSB7XG4gICAgICAgIF90aGlzLmNvbmZpZyA9IEpTT04ucGFyc2UoY29uZmlnKTtcbiAgICB9IGVsc2Uge1xuICAgIFx0X3RoaXMuY29uZmlnID0gY29uZmlnO1xuICAgIH1cbiAgICAvLyBXb3JrZmxvdyBpbnN0YW5jZSB2YWxpZGF0aW9uIGNoZWNrc1xuICAgIF90aGlzLmluc3RhbmNlO1xuXHRcdC8vIFdvcmtmbG93IHN1Yi1wcm9jZXNzZXMgdmFsaWRhdGlvbiBjaGVja3Ncblx0XHRfdGhpcy5zdWJwcm9jZXNzZXMgPSBbXTtcblx0XHQvLyBXb3JrZmxvdyBpbmRpY2F0b3JzIHBsYWNlIGhvbGRlclxuXHRcdF90aGlzLmluZGljYXRvcnMgPSBbXTtcblx0XHQvLyBXb3JrZmxvdyBzdWItcHJvY2VzcyBzdGVwIGhpc3RvcnkgcGxhY2UgaG9sZGVyXG5cdFx0X3RoaXMuaGlzdG9yeSA9IFtdO1xuXG59XG5cbi8qKlxuICogV29ya2Zsb3cgZ2V0IHByb2ZpbGUgaWQuXG4gKlxuICogQGV4YW1wbGUgXCJcIlxuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLmdldFByb2ZpbGUgPSBmdW5jdGlvbigpe1xuXHRyZXR1cm4gdGhpcy5wcm9maWxlO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyBnZXQgYXBwIGlkLlxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5nZXRBcHAgPSBmdW5jdGlvbigpe1xuXHRyZXR1cm4gdGhpcy5hcHA7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IGdldCBjb25maWcuXG4gKlxuICogQGV4YW1wbGUgXCJcIlxuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLmdldENvbmZpZyA9IGZ1bmN0aW9uKCl7XG5cdHJldHVybiB0aGlzLmNvbmZpZztcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgZ2V0IGluc3RhbmNlLlxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uKCl7XG5cdHJldHVybiB0aGlzLmluc3RhbmNlO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyBzZXQgdGhlIGluc3RhbmNlIGRhdGEuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGRhdGEgLSB0aGUgd29ya2Zsb3cgcHJvY2VzcyBpbnN0YW5jZSBkYXRhXG4gKlxuICogQGV4YW1wbGUgXCJcIlxuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLnNldEluc3RhbmNlID0gZnVuY3Rpb24oZGF0YSl7XG5cdHRoaXMuaW5zdGFuY2UgPSBkYXRhO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyBnZXQgc3ViLXByb2Nlc3NlcyBkYXRhLlxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5nZXRTdWJQcm9jZXNzZXMgPSBmdW5jdGlvbigpe1xuXHRyZXR1cm4gdGhpcy5zdWJwcm9jZXNzZXM7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IHNldCB0aGUgc3ViLXByb2Nlc3NlcyBkYXRhLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIC0gdGhlIHdvcmtmbG93IHByb2Nlc3MgaW5zdGFuY2UgZGF0YVxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5zZXRTdWJQcm9jZXNzZXMgPSBmdW5jdGlvbihkYXRhKXtcblx0dGhpcy5zdWJwcm9jZXNzZXMgPSBkYXRhO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyBnZXQgaW5kaWNhdG9yIHNldCBkYXRhLlxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5nZXRJbmRpY2F0b3JzID0gZnVuY3Rpb24oKXtcblx0cmV0dXJuIHRoaXMuaW5kaWNhdG9ycztcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgc2V0IHRoZSBpbmRpY2F0b3Igc2V0IGRhdGEuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGRhdGEgLSB0aGUgd29ya2Zsb3cgcHJvY2VzcyBpbnN0YW5jZSBkYXRhXG4gKlxuICogQGV4YW1wbGUgXCJcIlxuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLnNldEluZGljYXRvcnMgPSBmdW5jdGlvbihkYXRhKXtcblx0dGhpcy5pbmRpY2F0b3JzID0gZGF0YTtcbn07XG5cbi8qKlxuICogU2V0IHRoZSB2YXJpYWJsZSB2YWx1ZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2UgcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdWJQcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdWItcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHN1YlByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2Ugc3ViLXByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RlcElkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3RlcCBpZFxuICogQHBhcmFtIHtPYmplY3R9IHZhcmlhYmxlIC0gdGhlIFdvcmtmbG93IHZhcmlhYmxlIG9iamVjdFxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuLy8gV29ya2Zsb3cucHJvdG90eXBlLnNldFZhcmlhYmxlID0gZnVuY3Rpb24ocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwgdmFyaWFibGUpe1xuLy8gXHR2YXIgX3RoaXMgPSB0aGlzO1xuLy8gXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4vLyBcdFx0dHJ5IHtcbi8vIFx0XHRcdFByb2Nlc3MuZ2V0VmFyaWFibGUocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwgdmFyaWFibGUpLnRoZW4oZnVuY2lvbihyZXN1bHQpe1xuLy8gXHRcdFx0XHRyZXNvbHZlKHJlc3VsdC5kYXRhKTtcbi8vIFx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG4vLyBcdFx0XHRcdHJlamVjdChlcnIpO1xuLy8gXHRcdFx0fSlcbi8vIFx0XHR9IGNhdGNoIChlcnIpIHtcbi8vIFx0XHRcdHJlamVjdChlcnIpO1xuLy8gXHRcdH1cbi8vIFx0fSk7XG4vLyB9O1xuXG4vKipcbiAqIEdldCB0aGUgdmFyaWFibGUgdmFsdWUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBwcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3ViUHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3ViLXByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdWJQcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHN1Yi1wcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN0ZXBJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN0ZXAgaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSB0aGUgV29ya2Zsb3cgdmFyaWFibGUgaWRcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbi8vIFdvcmtmbG93LnByb3RvdHlwZS5nZXRWYXJpYWJsZSA9IGZ1bmN0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIGtleSl7XG4vLyBcdHZhciBfdGhpcyA9IHRoaXM7XG4vLyBcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbi8vIFx0XHR0cnkge1xuLy8gXHRcdFx0UHJvY2Vzcy5zZXRWYXJpYWJsZShwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCBrZXkpLnRoZW4oZnVuY2lvbihyZXN1bHQpe1xuLy8gXHRcdFx0XHRyZXNvbHZlKHJlc3VsdC5kYXRhKTtcbi8vIFx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG4vLyBcdFx0XHRcdHJlamVjdChlcnIpO1xuLy8gXHRcdFx0fSlcbi8vIFx0XHR9IGNhdGNoIChlcnIpIHtcbi8vIFx0XHRcdHJlamVjdChlcnIpO1xuLy8gXHRcdH1cbi8vIFx0fSk7XG4vLyB9O1xuXG4vKipcbiAqIFRoaXMgbWV0aG9kIGNyZWF0ZXMgYSBuZXcgd29ya2Zsb3cgcHJvY2VzcyBpLmUuIGl0IGNyZWF0ZXMgYSB3b3JrZmxvdyBwcm9jZXNzZXMgaW5zdGFuY2VcbiAqIG9iamVjdCB3aXRoIHRoZSBtaW5pbXVtIHJlcXVpcmVkIGRhdGEuIFRoaXMgaW5zdGFuY2UgY2FuIGJlIHJlZmVyZW5jZWQgaW4gdGhlIGZvbGxvd2luZ1xuICogd2F5LCBzZWUgZXhhbXBsZSBiZWxvdy5cbiAqXG4gKiBAZXhhbXBsZVxuICogdmFyIGNvbmZpZyA9IHsgJ19pZCc6ICdhYmMxMjMnIH07XG4gKiB2YXIgd29ya2Zsb3cgPSBuZXcgV29ya2Zsb3coJzEyMzQnLCAnNTY3OCcsIGNvbmZpZyk7XG4gKiB3b3JrZmxvdy5jcmVhdGUoKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gKlx0Y29uc29sZS5sb2cocmVzdWx0Lm1lc3NhZ2UpO1xuICpcdC8vIFRoZSBmb2xsb3dpbmcgcHJvcGVydGllcyBjYW4gbm93IGJlIGFjY2Vzc2VkXG4gKiBcdHZhciBwcm9maWxlID0gd29ya2Zsb3cucHJvZmlsZTtcbiAqIFx0dmFyIGFwcCA9IHdvcmtmbG93LmFwcDtcbiAqIFx0dmFyIGNvbmZpZyA9IHdvcmtmbG93LmNvbmZpZztcbiAqXHQvLyBPbiBzdWNjZXNzIHlvdSBjYW4gYWNjZXNzIHRoZSBpbnN0YW5jZSB0aGUgZm9sbG93aW5nIHdheVxuICpcdHZhciBpbnN0YW5jZSA9IHdvcmtmbG93Lmluc3RhbmNlO1xuICogfSwgZnVuY3Rpb24oZXJyb3Ipe1xuICpcdGNvbnNvbGUubG9nKGVycm9yKTtcbiAqIH0pO1xuICpcbiAqIEByZXR1cm4ge09iamVjdH0gbmV3IFdvcmtmbG93IGluc3RhbmNlIHdpdGggdXBkYXRlZCBpbnN0YW5jZSBkYXRhLlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uKCl7XG5cdHZhciBfdGhpcyA9IHRoaXM7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHR0cnkge1xuXHRcdFx0aWYgKF90aGlzLmluc3RhbmNlICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0dmFyIHdhcm4gPSB1dGlsLndhcm4oJ0luc3RhbmNlIGFscmVhZHkgZXhpc3RzLicsIF90aGlzKVxuXHRcdFx0XHRyZXNvbHZlKHdhcm4pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gQ3JlYXRlIHRoZSB3b3JrZmxvdyBwcm9jZXNzZXMgaW5zdGFuY2Ugb2JqZWN0XG5cdFx0XHRcdHZhciBtb2RlbCA9IHtcblx0XHRcdFx0ICAgIF9pZDogJycsXG5cdFx0XHRcdCAgICB2ZXJzaW9uOiAnJyxcblx0XHRcdFx0ICAgIHR5cGU6ICd3b3JrZmxvd0luc3RhbmNlJyxcblx0XHRcdFx0ICAgIHByb2Nlc3NlczogW11cblx0XHRcdFx0fTtcblx0XHRcdFx0bW9kZWwuX2lkID0gX3RoaXMucHJvZmlsZSArICc6cHJvY2Vzc2VzJztcblx0XHRcdFx0bW9kZWwudmVyc2lvbiA9IF90aGlzLmNvbmZpZy52ZXJzaW9uO1xuXHRcdFx0XHRfdGhpcy5pbnN0YW5jZSA9IG1vZGVsO1xuXHRcdFx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnV29ya2Zsb3cgcHJvY2Vzc2VzIGluc3RhbmNlIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5LicsIF90aGlzKTtcblx0XHRcdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnIpIHtcblx0XHRcdHJlamVjdChlcnIpO1xuXHRcdH1cblx0fSk7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IGluaXRpYWxpc2UsIHRoaXMgZnVuY3Rpb24gZXhlY3V0ZXMgYSBwcm9jZXNzIHdpdGhpbiBhIHdvcmtmbG93XG4gKiBjb25maWd1cmF0aW9uLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgcHJvY2VzcyBpZCB0byBwcm9jZXNzXG4gKiBAcGFyYW0ge29iamVjdH0gW2RhdGFdIC0gdGhlIGlucHV0IGRhdGEgdG8gcHJvY2Vzc1xuICpcbiAqIEBleGFtcGxlXG4gKiBXb3JrZmxvdy5pbml0aWFsaXplKCdwcm9jZXNzSWQnLCB7IHZhbGlkRGF0ZTogJ2RhdGUnIH0pO1xuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLmluaXRpYWxpc2UgPSBmdW5jdGlvbihwcm9jZXNzSWQsIGRhdGEpe1xuXHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0dHJ5IHtcblx0XHRcdHZhciBjb25maWdQcm9jZXNzID0gW107XG5cdFx0XHQvLyBDaGVjayB0aGUgcGFzc2VkIGluIHBhcmFtZXRlcnNcblx0XHRcdGlmIChwcm9jZXNzSWQgIT09ICcnICYmIHByb2Nlc3NJZCAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdC8vIEdldCB0aGUgY3VycmVudCBwcm9jZXNzIGNvbmZpZ1xuXHRcdFx0XHRjb25maWdQcm9jZXNzID0gX3RoaXMuY29uZmlnLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqUHJvY2Vzcyl7XG5cdFx0XHRcdFx0aWYgKG9ialByb2Nlc3MuX2lkID09PSBwcm9jZXNzSWQpIHtcblx0XHRcdFx0XHRcdHJldHVybiBvYmpQcm9jZXNzO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdGlmIChjb25maWdQcm9jZXNzWzBdLl9pZCA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0dmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZDb25maWdFcnJvcicsICdObyB2YWxpZCBwcm9jZXNzIGRlZmluaXRpb24gZm91bmQgd2l0aCBwcm9jZXNzIGlkOiAnICsgcHJvY2Vzc0lkKTtcblx0XHRcdFx0XHRyZWplY3QoZXJyb3IpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25maWdQcm9jZXNzLnB1c2goX3RoaXMuY29uZmlnLnByb2Nlc3Nlc1swXSk7XG5cdFx0XHRcdHByb2Nlc3NJZCA9IF90aGlzLmNvbmZpZy5wcm9jZXNzZXNbMF0uX2lkO1xuXHRcdFx0fVxuXHRcdFx0Ly8gR2V0IHRoZSBjdXJyZW50IGxpc3Qgb2YgcHJvY2VzcyBpbnN0YW5jZXNcblx0XHRcdC8vIHZhciBwcm9jZXNzU2VxID0gMTtcblx0XHRcdHZhciBjdXJyZW50UHJvY2VzcyA9IFtdO1xuXHRcdFx0X3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihwcm9jZXNzSXRlbSl7XG5cdFx0XHRcdGlmIChwcm9jZXNzSXRlbS5pZCA9PT0gcHJvY2Vzc0lkKSB7XG5cdFx0XHRcdFx0Y3VycmVudFByb2Nlc3MucHVzaChwcm9jZXNzSXRlbSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0dmFyIHByb2Nlc3NTZXEgPSBjdXJyZW50UHJvY2Vzcy5sZW5ndGggKyAxO1xuXHRcdFx0Ly8gdmFyIG5leHRTZXEgPSBwcm9jZXNzU2VxICsgMTtcblx0XHRcdC8vIFB1c2ggdGhlIHByb2Nlc3Mgb2JqZWN0IGludG8gdGhlIGFycmF5XG5cdFx0XHR2YXIgcHJvY2Vzc01vZGVsID0ge1xuXHRcdFx0XHRpZDogJycsXG5cdFx0XHRcdHNlcTogJycsXG5cdFx0XHRcdHN1YlByb2Nlc3NlczogW11cblx0XHRcdH1cblx0XHRcdC8vIDEuIFVwZGF0ZSB0aGUgcHJvY2VzcyBpZCBhbmQgc2VxXG5cdFx0XHRwcm9jZXNzTW9kZWwuaWQgPSBwcm9jZXNzSWQ7XG5cdFx0XHRwcm9jZXNzTW9kZWwuc2VxID0gcHJvY2Vzc1NlcTtcblx0XHRcdF90aGlzLmluc3RhbmNlLnByb2Nlc3Nlcy5wdXNoKHByb2Nlc3NNb2RlbCk7XG5cdFx0XHQvLyBQYXJhbWV0ZXJzXG5cdFx0XHR2YXIgc3ViUHJvY2Vzc0lkID0gY29uZmlnUHJvY2Vzc1swXS5zdWJQcm9jZXNzZXNbMF0uX2lkO1xuXHRcdFx0dmFyIHN1YlByb2Nlc3NTZXEgPSAxO1xuXHRcdFx0X3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihwcm9jZXNzSXRlbSl7XG5cdFx0XHRcdGlmIChwcm9jZXNzSXRlbS5pZCA9PT0gcHJvY2Vzc0lkICYmIHByb2Nlc3NJdGVtLnNlcSA9PT0gcHJvY2Vzc1NlcSkge1xuXHRcdFx0XHRcdHN1YlByb2Nlc3NTZXEgPSBwcm9jZXNzSXRlbS5zdWJQcm9jZXNzZXMubGVuZ3RoICsgMVxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdFx0Ly8gQ2FsbCB0aGUgc3VicHJvY2VzcyBtZXRob2Rcblx0XHRcdFByb2Nlc3Muc3ViUHJvY2Vzcyhwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgZGF0YSwgX3RoaXMpLnRoZW4oZnVuY3Rpb24oc3ViUHJvY2Vzcyl7XG5cdFx0XHRcdC8vIEdlbmVyYXRlIHRoZSB1dWlkXG5cdFx0XHRcdHZhciB1dWlkID0gX3RoaXMucHJvZmlsZSArICc6JyArIF90aGlzLmFwcCArICc6JyArIHByb2Nlc3NJZCArICc6JyArIHByb2Nlc3NTZXEgKyAnOicgKyBzdWJQcm9jZXNzSWQgKyAnOicgKyBzdWJQcm9jZXNzU2VxO1xuXHRcdFx0XHQvLyBCdWlsZCB0aGUgc3ViLXByb2Nlc3MgcmVmZXJlbmNlIG9iamVjdFxuXHRcdFx0XHR2YXIgc3ViUHJvY2Vzc1JlZiA9IHtcblx0XHRcdFx0XHRpZDogc3ViUHJvY2Vzc0lkLFxuXHRcdFx0XHRcdHNlcTogc3ViUHJvY2Vzc1NlcSxcblx0XHRcdFx0XHR1dWlkOiB1dWlkXG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gQWRkIHRoZSByZWZlcmVuY2UgdG8gdGhlIHByb2Nlc3MgbW9kZWxcblx0XHRcdFx0cHJvY2Vzc01vZGVsLnN1YlByb2Nlc3Nlcy5wdXNoKHN1YlByb2Nlc3NSZWYpO1xuXHRcdFx0XHQvLyBBZGQgdGhlIHN1YlByb2Nlc3MgbW9kZWwgdG8gdGhlIHN1YnByb2Nlc3NlcyBhcnJheVxuXHRcdFx0XHRfdGhpcy5zdWJwcm9jZXNzZXMucHVzaChzdWJQcm9jZXNzLmRhdGEpO1xuXHRcdFx0XHQvLyBfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXMucHVzaChwcm9jZXNzTW9kZWwpO1xuXHRcdFx0XHRmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgX3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzLmxlbmd0aDsgaW5kZXgrKyl7XG5cdFx0XHRcdFx0dmFyIHByb2Nlc3NJdGVtID0gX3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzW2luZGV4XTtcblx0XHRcdFx0XHRpZiAocHJvY2Vzc0l0ZW0uaWQgPT09IHByb2Nlc3NJZCAmJiBwcm9jZXNzSXRlbS5zZXEgPT09IHByb2Nlc3NTZXEpIHtcblx0XHRcdFx0XHRcdC8vIFJlbW92ZSB0aGUgY3VycmVudCBwcm9jZXNzIGZyb20gdGhlIGFycmF5IGFuZCBhZGQgdGhlIHVwZGF0ZWQgcHJvY2Vzc01vZGVsXG5cdFx0XHRcdFx0XHRfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXMuc3BsaWNlKGluZGV4LCAxLCBwcm9jZXNzTW9kZWwpXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIFByb2Nlc3MgdGhlIGluZGljYXRvciBkb2N1bWVudHMgd29ya2Zsb3cgcHJvY2Vzc2VzIHVwZGF0ZXNcblx0XHRcdFx0dmFyIGluZGljYXRvcnMgPSBzdWJQcm9jZXNzLmRhdGEuaW5kaWNhdG9ycztcblx0XHRcdFx0dmFyIHN0ZXAgPSBzdWJQcm9jZXNzLmRhdGEuc3RlcDtcblx0XHRcdFx0UHJvY2Vzcy5pbmRpY2F0b3JEb2NzKHByb2Nlc3NJZCwgaW5kaWNhdG9ycywgc3RlcCwgX3RoaXMpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcblx0XHRcdFx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUHJvY2VzczogJyArIF90aGlzLmNvbmZpZy5wcm9jZXNzZXNbMF0uX2lkICsgJyBpbml0aWFsaXplZCBzdWNjZXNzZnVsbHkuJywgX3RoaXMpO1xuXHRcdFx0XHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdFx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG5cdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdH0pXG5cdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuXHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdH0pO1xuXHRcdH0gY2F0Y2goZXJyKSB7XG5cdFx0XHRyZWplY3QoZXJyKTtcblx0XHR9XG5cdH0pO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyB0cmFuc2l0aW9uIHRvIHRoZSBuZXh0IHN0ZXAuIFRoaXMgbW92ZXMgdGhlIHdvcmtmbG93IGZyb20gdGhlIGN1cnJlbnQgcHJvY2VzcyxcbiAqIHN1Yi1wcm9jZXNzIHN0ZXAgdG8gdGhlIG5leHQgb25lIGFzIHNwZWNpZmllZC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2UgcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdWJQcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdWItcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHN1YlByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2Ugc3ViLXByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RlcElkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3RlcCBpZFxuICogQHBhcmFtIHtzdHJpbmd9IHRyYW5zaXRpb25JZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHRyYW5zaXRpb24gaWRcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gYW55IGFkZGl0aW9uYWwgZGF0YSBwYXNzZWQgaW4gYXMga2V5IHZhbHVlIHBhaXJzXG4gKlxuICogQGV4YW1wbGVcbiAqIFdvcmtmbG93LnRyYW5zaXRpb24oJ3Byb2Nlc3NJZCcsIDEsICdzdWJQcm9jZXNzSWQnLCAxLCAnc3RlcElkJywgJ3RyYW5zaXRpb25JZCcsIHsga2V5OiAnJywgdmFsdWU6ICcnIH0pO1xuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLnRyYW5zaXRpb24gPSBmdW5jdGlvbihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCB0cmFuc2l0aW9uSWQsIGRhdGEpe1xuXHQvLyBSZS1hc3NpZ24gdGhpc1xuXHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0dHJ5IHtcblx0XHRcdFByb2Nlc3MudHJhbnNpdGlvbihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCB0cmFuc2l0aW9uSWQsIGRhdGEsIF90aGlzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG5cdFx0XHRcdC8vIFVwZGF0ZSB0aGUgY3VycmVudCBzdWItcHJvY2VzcyBzdGVwIGRhdGFcblx0XHRcdFx0dmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKHR5cGUpe1xuXHRcdFx0XHRcdF90aGlzLmluc3RhbmNlLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ocHJvY2Vzc0l0ZW0pe1xuXHRcdFx0XHRcdFx0aWYgKHByb2Nlc3NJdGVtLmlkID09PSBwcm9jZXNzSWQgJiYgcHJvY2Vzc0l0ZW0uc2VxID09PSBwcm9jZXNzU2VxKSB7XG5cdFx0XHRcdFx0XHRcdHByb2Nlc3NJdGVtLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzc0l0ZW0pe1xuXHRcdFx0XHRcdFx0XHRcdGlmIChzdWJQcm9jZXNzSXRlbS5pZCA9PT0gc3ViUHJvY2Vzc0lkICYmIHN1YlByb2Nlc3NJdGVtLnNlcSA9PT0gc3ViUHJvY2Vzc1NlcSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0X3RoaXMuc3VicHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihzdWJQcm9jZXNzT2JqKXtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHN1YlByb2Nlc3NPYmouX2lkID09PSBzdWJQcm9jZXNzSXRlbS51dWlkKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHR5cGUgPT09ICdzdGVwJykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0c3ViUHJvY2Vzc09iai5zdGVwID0gcmVzdWx0LmRhdGE7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcyhyZXN1bHQubWVzc2FnZSwgc3ViUHJvY2Vzc09iaik7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAodHlwZSA9PT0gJ3N0ZXBDb21wbGV0ZScpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHN1YlByb2Nlc3NPYmouc3RlcCA9IHJlc3VsdC5kYXRhLnN0ZXA7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzdWJQcm9jZXNzT2JqLmNvbXBsZXRlID0gdHJ1ZVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MocmVzdWx0Lm1lc3NhZ2UsIHN1YlByb2Nlc3NPYmopO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHJlc3VsdC5kYXRhLnN1YlByb2Nlc3NDb21wbGV0ZSkge1xuXHRcdFx0XHRcdHVwZGF0ZSgnc3RlcENvbXBsZXRlJyk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dXBkYXRlKCdzdGVwJyk7XG5cdFx0XHRcdH1cblx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG5cdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0fSk7XG5cdFx0fSBjYXRjaChlcnIpIHtcblx0XHRcdHJlamVjdChlcnIpO1xuXHRcdH1cblx0fSk7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IGFzc2lnbiB1c2VyLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBwcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gcHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBwcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN1YlByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN1Yi1wcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gc3ViUHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBzdWItcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGVwSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdGVwIGlkXG4gKiBAcGFyYW0ge29iamVjdH0gdXNlciAtIHRoZSB1c2VyIGlkIGFuZCBuYW1lIGRhdGFcbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuYXNzaWduVXNlciA9IGZ1bmN0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCB1c2VyKXtcblx0Ly8gUmUtYXNzaWduIHRoZSBXb3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZSBhcyBfdGhpc1xuXHR2YXIgX3RoaXMgPSB0aGlzO1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0dHJ5IHtcblx0XHRcdFByb2Nlc3MuYXNzaWduVXNlcihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgdXNlciwgX3RoaXMpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcblx0XHRcdFx0cmVzb2x2ZShyZXN1bHQpO1xuXHRcdFx0fSwgZnVuY3Rpb24oZXJyKXtcblx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHR9KVxuXHRcdH0gY2F0Y2goZXJyKSB7XG5cdFx0XHRyZWplY3QoZXJyKTtcblx0XHR9XG5cdH0pXG59O1xuXG4vKipcbiAqIFdvcmtmbG93IHRhc2ssIHRoaXMgbWV0aG9kIGV4ZWN1dGVzIGEgc3BlY2lmaWMgdGFzay5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIHByb2Nlc3MgaWQgdG8gcHJvY2Vzc1xuICogQHBhcmFtIHtvYmplY3R9IGlucHV0RGF0YSAtIHRoZSBpbnB1dCBkYXRhIHRvIHByb2Nlc3NcbiAqXG4gKiBAZXhhbXBsZVxuICogV29ya2Zsb3cuaW5pdGlhbGl6ZSgncHJvY2Vzc0lkJywgeyB2YWxpZERhdGU6ICdkYXRlJyB9KTtcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS51aSA9IGZ1bmN0aW9uKCl7XG5cdC8vIFJlLWFzc2lnbiB0aGUgV29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2UgYXMgX3RoaXNcblx0dmFyIF90aGlzID0gdGhpcztcblx0cmV0dXJuIHtcblx0XHRnZXRQcm9jZXNzOiBmdW5jdGlvbihwcm9jZXNzSWQsIGxhbmcpe1xuXHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdHVzZXJJbnRlcmZhY2UuZ2V0UHJvY2Vzcyhwcm9jZXNzSWQsIGxhbmcsIF90aGlzKS50aGVuKGZ1bmN0aW9uKG1vZGVsKXtcblx0XHRcdFx0XHRcdHJlc29sdmUobW9kZWwpO1xuXHRcdFx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG5cdFx0XHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9IGNhdGNoKGVycikge1xuXHRcdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH1cblx0fVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBXb3JrZmxvdztcbiIsIid1c2Ugc3RyaWN0JztcblxuLy8gdmFyIEdLID0gcmVxdWlyZSgnLi9nYXRla2VlcGVyJyk7XG52YXIgdXRpbCA9IHJlcXVpcmUoJ3V0aWxpdHknKTtcbi8vIHZhciB1dWlkID0gcmVxdWlyZSgnbm9kZS11dWlkJyk7XG5cbi8vIHZhciBnYXRla2VlcGVyID0gbmV3IEdLKCk7XG5cbi8qKlxuICogRm9ybSBNb2R1bGVcbiAqXG4gKiBAbW9kdWxlIGxpYi9mb3JtXG4gKiBAYXV0aG9yIEJyZW50IEdvcmRvblxuICogQHZlcnNpb24gMi4wLjBcbiAqIEBkZXNjcmlwdGlvbiB0ZXN0IGRlc2NyaXB0aW9uXG4gKiBAY29weXJpZ2h0IEt3YW50dSBMdGQgUlNBIDIwMDktMjAxNS5cbiAqXG4gKi9cblxuZnVuY3Rpb24gY3JlYXRlKGFyZ3Mpe1xuXHR2YXIgcHJvY2Vzc0lkID0gYXJnc1swXSB8fCAnJztcblx0Ly8gY29uc29sZS5sb2cocHJvY2Vzc0lkKTtcblx0dmFyIHN1YlByb2Nlc3MgPSBhcmdzWzFdIHx8IHt9O1xuXHQvLyBjb25zb2xlLmxvZyhzdWJQcm9jZXNzKTtcblx0dmFyIGluZGljYXRvcnMgPSBzdWJQcm9jZXNzLmluZGljYXRvcnMgfHwgW107XG5cdC8vIGNvbnNvbGUubG9nKGluZGljYXRvcnMpO1xuXHR2YXIgX1dGSW5zdGFuY2UgPSBhcmdzWzNdIHx8IHt9O1xuXHQvLyBjb25zb2xlLmxvZyhfV0ZJbnN0YW5jZSk7XG5cdHZhciBzdGVwID0gYXJnc1syXSB8fCB7fTtcblx0Ly8gdmFyIGRhdGEgPSBhcmdzWzNdIHx8IHt9O1xuXHQvLyBjb25zb2xlLmxvZyhzdGVwKTtcblx0dmFyIHJlc3VsdCA9IFtdO1xuXHQvLyBjb25zb2xlLmxvZyhzdWJQcm9jZXNzKTtcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdHV0aWwuc3luY0xvb3AoaW5kaWNhdG9ycy5sZW5ndGgsIGZ1bmN0aW9uKGxvb3Ape1xuXHRcdFx0dmFyIGNvdW50ZXIgPSBsb29wLml0ZXJhdGlvbigpO1xuXHRcdFx0dmFyIGluZGljYXRvcklkID0gaW5kaWNhdG9yc1tjb3VudGVyXS5faWQ7XG5cdFx0XHR2YXIgaW5kaWNhdG9yTmFtZSA9IHV0aWwuZ2V0TmFtZShpbmRpY2F0b3JzW2NvdW50ZXJdLm5hbWUsICdlbicpO1xuXHRcdFx0dmFyIGlkID0gX1dGSW5zdGFuY2UucHJvZmlsZSArICc6JyArIF9XRkluc3RhbmNlLmFwcCArICc6JyArIGluZGljYXRvcklkICsgJzowJztcblxuXHRcdFx0Ly8gVE9ETzogUmVwbGFjZSB3aXRoIHRoZSBnYXRla2VlcGVyIHByb21pc2UgY2FsbCwgcmV0dXJuIHRoZSBvYmplY3QsIHVwZGF0ZSB0aGUgaW5kaWNhdG9yXG5cdFx0XHQvLyBkb2N1bWVudCB3b3JrZmxvdyBwcm9jZXNzZXMgZGF0YSBhbmQgdXBkYXRlIHRoZSB3b3JrZmxvdyBjbGFzcyBpbmRpY2F0b3JzIGFycmF5LlxuXG5cdFx0XHQvLyBnYXRla2VlcGVyLmluc3RhbnRpYXRlKGlkLCAnbmV3SW5zdGFuY2UnLCBpbmRpY2F0b3JJZCwgX1dGSW5zdGFuY2UucHJvZmlsZSwgZGF0YS52YWxpZERhdGUpLnRoZW4oZnVuY3Rpb24oZG9jKXtcblx0XHRcdC8vXHQvLyBVcGRhdGUgdGhlIGluZGljYXRvciB3b3JrZmxvdyBwcm9jZXNzZXMgc2VjdGlvblxuXHRcdFx0Ly9cdHZhciB3b3JrZmxvd3MgPSBkb2Mud29ya2Zsb3dzO1xuXHRcdFx0Ly9cdHdvcmtmbG93cy5pZCA9IF9XRkluc3RhbmNlLmNvbmZpZy5faWQ7XG5cdFx0XHQvL1x0d29ya2Zsb3dzLmluc3RhbmNlID0gX1dGSW5zdGFuY2UuaW5zdGFuY2UuX2lkO1xuXHRcdFx0Ly9cdF9XRkluc3RhbmNlLmluZGljYXRvcnMucHVzaChkb2MpO1xuXHRcdFx0Ly9cdGxvb3AubmV4dCgpO1xuXHRcdFx0Ly8gfSwgZnVuY3Rpb24oZXJyKXtcblx0XHRcdC8vXHRyZWplY3QoZXJyKTtcblx0XHRcdC8vIH0pXG5cblx0XHRcdC8vIFRoaXMgc2hvdWxkIGJlIHRoZSBkYXRhIHJldHVybmVkIGZyb20gdGhlIGdhdGVrZWVwZXIgY2FsbC5cblx0XHRcdHZhciBkb2MgPSB7XG5cdFx0XHRcdFwiX2lkXCI6IGlkLFxuXHRcdFx0XHRcInRpdGxlXCI6IGluZGljYXRvck5hbWUsXG5cdFx0XHRcdFwiY2F0ZWdvcnlcIjoge1xuXHRcdFx0XHRcdFwidGVybVwiOiBpbmRpY2F0b3JJZCxcblx0XHRcdFx0XHRcImxhYmVsXCI6IGluZGljYXRvck5hbWVcblx0XHRcdFx0fSxcblx0XHRcdFx0XCJ3b3JrZmxvd3NcIjogW3tcblx0ICAgICAgICBcImlkXCI6IF9XRkluc3RhbmNlLmNvbmZpZy5faWQsXG5cdCAgICAgICAgXCJpbnN0YW5jZVwiOiBfV0ZJbnN0YW5jZS5pbnN0YW5jZS5faWQsXG5cdCAgICAgICAgXCJwcm9jZXNzZXNcIjogW3tcbiAgICAgICAgICAgIFwiaWRcIjogcHJvY2Vzc0lkLFxuICAgICAgICAgICAgXCJzdWJQcm9jZXNzSWRcIjogc3ViUHJvY2Vzcy5faWQsXG4gICAgICAgICAgICBcInN0ZXBcIjoge1xuICAgICAgICAgICAgICBcImlkXCI6IHN0ZXAuaWQsXG4gICAgICAgICAgICAgIFwic2VxXCI6IHN0ZXAuc2VxLFxuICAgICAgICAgICAgICBcInN0YXJ0RGF0ZVwiOiBcIlwiLFxuICAgICAgICAgICAgICBcInN0YXR1c1wiOiBzdGVwLnN0YXR1cyxcbiAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IHN0ZXAubWVzc2FnZSxcbiAgICAgICAgICAgICAgXCJhc3NpZ25lZFRvXCI6IHtcbiAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBzdGVwLmFzc2lnbmVkVG8udXNlcklkLFxuICAgICAgICAgICAgICAgIFwibmFtZVwiOiBzdGVwLmFzc2lnbmVkVG8ubmFtZVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBcImNvbW1lbnRcIjogc3RlcC5jb21tZW50LFxuICAgICAgICAgICAgICBcImNvbXBsZXRlXCI6IGZhbHNlLFxuICAgICAgICAgICAgICBcImVuZERhdGVcIjogXCJcIlxuICAgICAgICAgICAgfVxuXHQgICAgICAgIH1dXG5cdFx0ICAgIH1dXG5cdFx0XHR9O1xuXG5cdFx0XHQvLyBVcGRhdGUgdGhlIGluZGljYXRvcnMgcHJvcGVydHkgYXJyYXlcblx0XHRcdF9XRkluc3RhbmNlLmluZGljYXRvcnMucHVzaChkb2MpO1xuXHRcdFx0Ly8gR290IHRvIHRoZSBuZXh0IHByb2Nlc3MgaXRlbVxuXHRcdFx0bG9vcC5uZXh0KCk7XG5cdFx0fSwgZnVuY3Rpb24oKXtcblx0XHRcdC8vIE9uIGNvbXBsZXRpb24gb2YgYWxsIHByb2Nlc3MgbG9vcCBpdGVtc1xuXHQgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gY3JlYXRlZCBzdWNjZXNzZnVsbHkuJywgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycyk7XG5cdFx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdH0pO1xuXHRcdC8vIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdGb3JtIGluZGljYXRvciBzZXQgc2F2ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdCk7XG5cdFx0Ly8gcmVzb2x2ZShzdWNjZXNzKTtcblx0fSk7XG59O1xuXG5mdW5jdGlvbiBzYXZlKGluZGljYXRvcil7XG5cdHZhciBjb21wbGV0ZWQgPSBbXTtcblx0dmFyIHJlc3VsdCA9IHtcblx0XHRjb21wbGV0ZTogdHJ1ZSxcblx0XHRkYXRhOiBbXVxuXHR9O1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gaW5kaWNhdG9yIHNldCBzYXZlZCBzdWNjZXNzZnVsbHkuJywgcmVzdWx0KTtcblx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHR9KTtcbn07XG5cbmZ1bmN0aW9uIHN1Ym1pdChmb3JtKXtcblx0dmFyIGNvbXBsZXRlZCA9IFtdO1xuXHR2YXIgcmVzdWx0ID0ge1xuXHRcdGNvbXBsZXRlOiB0cnVlLFxuXHRcdGRhdGE6IFtdXG5cdH07XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBzdWJtaXR0ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdCk7XG5cdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0fSk7XG59O1xuXG5mdW5jdGlvbiBhdXRob3Jpc2UoZm9ybSl7XG5cdHZhciBjb21wbGV0ZWQgPSBbXTtcblx0dmFyIHJlc3VsdCA9IHtcblx0XHRjb21wbGV0ZTogdHJ1ZSxcblx0XHRkYXRhOiBbXVxuXHR9O1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBhdXRob3Jpc2VkIHN1Y2Nlc3NmdWxseS4nLCByZXN1bHQpO1xuXHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdH0pO1xufTtcblxuZnVuY3Rpb24gY2xvc2UoZm9ybSl7XG5cdHZhciBjb21wbGV0ZWQgPSBbXTtcblx0dmFyIHJlc3VsdCA9IHtcblx0XHRjb21wbGV0ZTogdHJ1ZSxcblx0XHRkYXRhOiBbXVxuXHR9O1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gY2xvc2VkIHN1Y2Nlc3NmdWxseS4nLCByZXN1bHQpO1xuXHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdH0pO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG5cbiBcdGNyZWF0ZTogY3JlYXRlLFxuIFx0c2F2ZTogc2F2ZSxcbiBcdHN1Ym1pdDogc3VibWl0LFxuIFx0YXV0aG9yaXNlOiBhdXRob3Jpc2UsXG4gXHRjbG9zZTogY2xvc2VcblxufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbCA9IHJlcXVpcmUoJ3V0aWxpdHknKTtcblxuLyoqXG4gKiBVc2VyIEludGVyZmFjZSBNb2R1bGVcbiAqXG4gKiBAbW9kdWxlIGxpYi91aVxuICogQGF1dGhvciBCcmVudCBHb3Jkb25cbiAqIEB2ZXJzaW9uIDAuMS4wXG4gKiBAZGVzY3JpcHRpb24gdGVzdCBkZXNjcmlwdGlvblxuICpcbiAqL1xuXG4gLyoqXG4gICogR2V0IGFsbCBwcm9jZXNzIHN1Yi1wcm9jZXNzZXMgdXNlciBpbnRlcmZhY2UgZGF0YVxuICAqXG4gICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAgKiBAcGFyYW0ge3N0cmluZ30gbGFuZyAtIHRoZSB1c2VyIHByZWZmZXJlZCBsYW5nYXVnZVxuICAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gICpcbiAgKiBAZXhhbXBsZSAnJ1xuICAqXG4gICogQHJldHVybiAnJ1xuICAqXG4gICovXG4gZnVuY3Rpb24gZ2V0UHJvY2Vzcyhwcm9jZXNzSWQsIGxhbmcsIF9XRkluc3RhbmNlKXtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHRyeSB7XG4gICAgICB2YXIgcHJvY2Vzc01vZGVsID0gW107XG4gICAgICB2YXIgcHJvY2Vzc0luc3RhbmNlID0gW107XG4gICAgXHRfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHByb2Nlc3NJdGVtKXtcbiAgICBcdFx0aWYgKHByb2Nlc3NJdGVtLmlkID09PSBwcm9jZXNzSWQpIHtcbiAgICBcdFx0XHRwcm9jZXNzSW5zdGFuY2UgPSBwcm9jZXNzSXRlbTtcbiAgICBcdFx0fVxuICAgIFx0fSlcbiAgICAgIC8vIGNvbnNvbGUubG9nKHByb2Nlc3NJbnN0YW5jZS5zdWJQcm9jZXNzZXMubGVuZ3RoKTtcbiAgICAgIHV0aWwuc3luY0xvb3AocHJvY2Vzc0luc3RhbmNlLnN1YlByb2Nlc3Nlcy5sZW5ndGgsIGZ1bmN0aW9uKGxvb3Ape1xuICBcdFx0XHR2YXIgY291bnRlciA9IGxvb3AuaXRlcmF0aW9uKCk7XG4gICAgICAgIHZhciBwcm9jZXNzU2VxID0gcHJvY2Vzc0luc3RhbmNlLnNlcTtcbiAgICAgICAgdmFyIHN1YlByb2Nlc3NJZCA9IHByb2Nlc3NJbnN0YW5jZS5zdWJQcm9jZXNzZXNbY291bnRlcl0uaWQ7XG4gICAgICAgIHZhciBzdWJQcm9jZXNzU2VxID0gcHJvY2Vzc0luc3RhbmNlLnN1YlByb2Nlc3Nlc1tjb3VudGVyXS5zZXE7XG4gICAgICAgIGdldFN1YlByb2Nlc3MocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIGxhbmcsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKG1vZGVsKXtcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhtb2RlbCk7XG4gICAgICAgICAgcHJvY2Vzc01vZGVsLnB1c2gobW9kZWwpO1xuICAgICAgICAgIGxvb3AubmV4dCgpO1xuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2Nlc3NNb2RlbCk7XG4gIFx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG4gICAgICAgICAgLy8gY29uc29sZS5sb2cocHJvY2Vzc01vZGVsKTtcbiAgXHRcdFx0XHRsb29wLmJyZWFrKCk7XG4gIFx0XHRcdFx0cmVqZWN0KGVycik7XG4gIFx0XHRcdH0pO1xuICBcdFx0fSwgZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gY29uc29sZS5sb2cocHJvY2Vzc01vZGVsKTtcbiAgXHRcdFx0cmVzb2x2ZShwcm9jZXNzTW9kZWwpO1xuICBcdFx0fSk7XG4gICAgfSBjYXRjaChlcnIpe1xuICAgICAgcmVqZWN0KGVycik7XG4gICAgfVxuICB9KVxufTtcblxuIC8qKlxuICAqIEdldCBTdWJQcm9jZXNzIHVzZXIgaW50ZXJmYWNlIGRhdGFcbiAgKlxuICAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBwcm9jZXNzIGlkXG4gICogQHBhcmFtIHtudW1iZXJ9IHByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2UgcHJvY2VzcyBzZXFcbiAgKiBAcGFyYW0ge3N0cmluZ30gc3ViUHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3ViLXByb2Nlc3MgaWRcbiAgKiBAcGFyYW0ge251bWJlcn0gc3ViUHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBzdWItcHJvY2VzcyBzZXFcbiAgKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgY3VycmVudCB3b3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZVxuICAqXG4gICogQGV4YW1wbGUgJydcbiAgKlxuICAqIEByZXR1cm4gJydcbiAgKlxuICAqL1xuZnVuY3Rpb24gZ2V0U3ViUHJvY2Vzcyhwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgbGFuZywgX1dGSW5zdGFuY2Upe1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhciBtb2RlbCA9IHtcbiAgICAgICAgaWQ6ICcnLFxuICAgICAgICBzZXE6ICcnLFxuICAgICAgICBuYW1lOiAnJyxcbiAgICAgICAgaGVscDogJycsXG4gICAgICAgIGRhdGVzOiAnJyxcbiAgICAgICAgc3RlcDogJydcbiAgICAgIH07XG4gICAgICB2YXIgc3ViUHJvY2VzcyA9IFtdO1xuICAgIFx0dmFyIHN1YlByb2Nlc3NDb25mID0gW107XG4gICAgXHRfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHByb2Nlc3NJdGVtKXtcbiAgICBcdFx0aWYgKHByb2Nlc3NJdGVtLmlkID09PSBwcm9jZXNzSWQgJiYgcHJvY2Vzc0l0ZW0uc2VxID09PSBwcm9jZXNzU2VxKSB7XG4gICAgXHRcdFx0dmFyIHNwTGVuZ3RoID0gcHJvY2Vzc0l0ZW0uc3ViUHJvY2Vzc2VzLmxlbmd0aDtcbiAgICBcdFx0XHRwcm9jZXNzSXRlbS5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NJdGVtKXtcbiAgICBcdFx0XHRcdGlmIChzdWJQcm9jZXNzSXRlbS5pZCA9PT0gc3ViUHJvY2Vzc0lkICYmIHN1YlByb2Nlc3NJdGVtLnNlcSA9PT0gc3ViUHJvY2Vzc1NlcSAmJiBzdWJQcm9jZXNzSXRlbS5jb21wbGV0ZSA9PT0gZmFsc2UpIHtcbiAgICBcdFx0XHRcdFx0c3ViUHJvY2VzcyA9IHN1YlByb2Nlc3NJdGVtO1xuICAgIFx0XHRcdFx0fVxuICAgIFx0XHRcdH0pXG4gICAgXHRcdH1cbiAgICBcdH0pXG4gICAgXHQvLyBHZXQgdGhlIGN1cnJlbnQgc3ViUHJvY2VzcyBjb25maWd1cmF0aW9uXG4gICAgXHRfV0ZJbnN0YW5jZS5jb25maWcucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihwcm9jZXNzQ29uZmlnKXtcbiAgICBcdFx0aWYgKHByb2Nlc3NDb25maWcuX2lkID09PSBwcm9jZXNzSWQpIHtcbiAgICBcdFx0XHRwcm9jZXNzQ29uZmlnLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzc0NvbmZpZyl7XG4gICAgXHRcdFx0XHRpZiAoc3ViUHJvY2Vzc0NvbmZpZy5faWQgPT09IHN1YlByb2Nlc3NJZCkge1xuICAgIFx0XHRcdFx0XHRzdWJQcm9jZXNzQ29uZiA9IHN1YlByb2Nlc3NDb25maWc7XG4gICAgXHRcdFx0XHR9XG4gICAgXHRcdFx0fSlcbiAgICBcdFx0fVxuICAgIFx0fSlcbiAgICAgIC8vIFVwZGF0ZSB0aGUgbW9kZWxcbiAgICAgIG1vZGVsLmlkID0gc3ViUHJvY2Vzc0NvbmYuX2lkO1xuICAgICAgbW9kZWwuc2VxID0gc3ViUHJvY2Vzcy5zZXE7XG4gICAgICBtb2RlbC5uYW1lID0gdXRpbC5nZXROYW1lKHN1YlByb2Nlc3NDb25mLm5hbWUsIGxhbmcpO1xuICAgICAgbW9kZWwuaGVscCA9IHV0aWwuZ2V0TmFtZShzdWJQcm9jZXNzQ29uZi5oZWxwLCBsYW5nKTtcbiAgICAgIG1vZGVsLmRhdGVzID0gc3ViUHJvY2Vzcy5kYXRlcztcbiAgICAgIG1vZGVsLnN0ZXAgPSBzdWJQcm9jZXNzLnN0ZXA7XG4gICAgICByZXNvbHZlKG1vZGVsKTtcbiAgICB9IGNhdGNoKGVycikge1xuICAgICAgcmVqZWN0KGVycik7XG4gICAgfVxuICB9KVxufTtcblxuIG1vZHVsZS5leHBvcnRzID0ge1xuXG4gIGdldFByb2Nlc3M6IGdldFByb2Nlc3NcblxuIH1cbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWwgPSByZXF1aXJlKCd1dGlsaXR5Jyk7XG52YXIgZm9ybSA9IHJlcXVpcmUoJy4vZm9ybScpO1xuXG4vKipcbiAqIFByb2Nlc3MgTW9kdWxlXG4gKlxuICogQG1vZHVsZSBsaWIvcHJvY2Vzc1xuICogQGF1dGhvciBCcmVudCBHb3Jkb25cbiAqIEB2ZXJzaW9uIDAuMS4wXG4gKiBAZGVzY3JpcHRpb24gdGVzdCBkZXNjcmlwdGlvblxuICpcbiAqL1xuXG4gLyoqXG4gICogQ291bnQgYW4gYXJyYXkgb2YgaXRlbXNcbiAgKlxuICAqIEBwYXJhbSB7QXJyYXl9IGFyciAtIHRoZSBhcnJheSBkYXRhXG4gICpcbiAgKiBAZXhhbXBsZSAnJ1xuICAqXG4gICogQHJldHVybiAnJ1xuICAqXG4gICovXG4gZnVuY3Rpb24gY291bnQoYXJyKXtcbiAgIGlmIChhcnIgIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBhcnIubGVuZ3RoO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiAwO1xuICB9XG5cbiB9O1xuXG4vKipcbiAqIFByb2Nlc3MgcHJlLXJlcXVpc2l0ZXNcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gcHJlcmVxdWlzaXRlcyAtIHRoZSBwcmUtcmVxdWlzaXRlcyBjb25maWcgZGF0YVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gcHJlUmVxdWlzaXRlcyhwcmVyZXF1aXNpdGVzLCBfV0ZJbnN0YW5jZSkge1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0Ly8gVW5jb21tZW50IGJlbG93IHNlY3Rpb24gd2hlbiByZWFkeSB0byBpbXBsZW1lbnRcblx0XHR2YXIgY29tcGxldGVkID0gW107XG5cdFx0dHJ5IHtcblx0XHRcdHV0aWwuc3luY0xvb3AocHJlcmVxdWlzaXRlcy5sZW5ndGgsIGZ1bmN0aW9uKGxvb3Ape1xuXHRcdFx0XHR2YXIgY291bnRlciA9IGxvb3AuaXRlcmF0aW9uKCk7XG5cdFx0XHRcdHByZVJlcXVpc2l0ZShwcmVyZXF1aXNpdGVzW2NvdW50ZXJdLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihkYXRhKXtcblx0XHRcdFx0XHQvLyBDaGVjayBpZiBhbGwgcHJlLXJlcXVpc2l0ZXMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS5cblx0XHRcdFx0XHRjb21wbGV0ZWQucHVzaCh0cnVlKTtcblx0XHRcdFx0XHRsb29wLm5leHQoKTtcblx0XHRcdFx0fSwgZnVuY3Rpb24oZXJyKXtcblx0XHRcdFx0XHRjb21wbGV0ZWQucHVzaChmYWxzZSk7XG5cdFx0XHRcdFx0bG9vcC5icmVhaygpO1xuXHRcdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0sIGZ1bmN0aW9uKCl7XG5cdFx0XHRcdGlmIChjb21wbGV0ZWQuZXZlcnkoQm9vbGVhbikpIHtcblx0XHRcdFx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUHJlLXJlcXVpc2l0ZXMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7fSk7XG5cdFx0XHRcdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywgJ05vdCBhbGwgcHJlLXJlcXVpc2l0ZXMgcGFzc2VkLicpO1xuXHRcdFx0XHRcdHJlamVjdChlcnJvcik7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0gY2F0Y2ggKGVycikge1xuXHRcdFx0cmVqZWN0KGVycik7XG5cdFx0fVxuXHR9KTtcbn07XG5cbi8qKlxuICogUHJvY2VzcyBwcmUtcmVxdWlzaXRlLCBleGVjdXRlIHRoZSBwcmUtcmVxdWlzaXRlIGNvbmRpdGlvbi5cbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gcHJlcmVxdWlzaXRlIC0gdGhlIHByZS1yZXF1aXNpdGUgY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSB3b3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZVxuICpcbiAqIEBleGFtcGxlXG4gKiBQcm9jZXNzLnByZVJlcXVpc2l0ZShjb25maWcsIGNvdW50ZXIsIGluc3RhbmNlLCBkb2MpO1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIHByZVJlcXVpc2l0ZShwcmVyZXF1aXNpdGUsIF9XRkluc3RhbmNlKXtcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdHN3aXRjaChwcmVyZXF1aXNpdGUuX3R5cGUpIHtcblx0XHRcdC8vIFRPRE86IEFkZCB0aGUgY2FsbCB0byB0aGUgcmVsZXZhbnQgbWV0aG9kcyBiYXNlZCBvbiB0aGUgX3R5cGUgYXR0cmlidXRlLiBTaG91bGQgY2FsbCB0aGUgZ2VuZXJpYyBhY3Rpb24oKSBtZXRob2QuXG5cdFx0XHRjYXNlICdwcm9jZXNzSW5zdGFuY2VzJzpcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHR2YXIgaWQgPSBwcmVyZXF1aXNpdGUuX3BhcmFtZXRlcjtcblx0XHRcdFx0XHR2YXIgc3ViamVjdCA9IGNvdW50KGdldFN1YlByb2Nlc3MoaWQsIF9XRkluc3RhbmNlKSk7XG5cdFx0XHRcdFx0dmFyIGNvbXBhcmUgPSB1dGlsLmNvbXBhcmUoc3ViamVjdCwgcHJlcmVxdWlzaXRlLl9vcGVyYXRvciwgcGFyc2VJbnQocHJlcmVxdWlzaXRlLl92YWx1ZSkpO1xuXHRcdFx0XHRcdGlmIChjb21wYXJlKSB7XG5cdFx0XHRcdFx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUHJlLXJlcXVpc2l0ZXMgcGFzc2VkLicsIHt9KTtcblx0XHRcdFx0XHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHZhciBtZXNzYWdlID0gJyc7XG5cdFx0XHRcdFx0XHRwcmVyZXF1aXNpdGUubWVzc2FnZS5pMThuLmZpbHRlcihmdW5jdGlvbihpdGVtKXtcblx0XHRcdFx0XHRcdFx0aWYgKGl0ZW0uX2xhbmcgPT09ICdlbicpIHtcblx0XHRcdFx0XHRcdFx0XHRtZXNzYWdlID0gaXRlbS52YWx1ZTtcblx0XHRcdFx0XHRcdFx0XHR2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywgbWVzc2FnZSk7XG5cdFx0XHRcdFx0XHRcdFx0cmVqZWN0KGVycm9yKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGNhdGNoKGVycikge1xuXHRcdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0XHR9XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHR2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywnUHJlLXJlcXVpc2l0ZSB0eXBlOiAnICsgcHJlcmVxdWlzaXRlLl90eXBlICsgJyBub3QgZGVmaW5lZC4nKTtcblx0XHRcdFx0cmVqZWN0KGVycm9yKTtcblx0XHR9XG5cdH0pO1xufTtcblxuLyoqXG4gKiBQcm9jZXNzIHByZS1hY3Rpb25zc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBwcmVBY3Rpb25zIC0gdGhlIHByZS1hY3Rpb25zIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgY3VycmVudCB3b3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gcHJlQWN0aW9ucyhwcmVBY3Rpb25zLCBfV0ZJbnN0YW5jZSl7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHR2YXIgY29tcGxldGVkID0gW107XG5cdFx0dHJ5IHtcblx0XHRcdHV0aWwuc3luY0xvb3AocHJlQWN0aW9ucy5sZW5ndGgsIGZ1bmN0aW9uKGxvb3Ape1xuXHRcdFx0XHR2YXIgY291bnRlciA9IGxvb3AuaXRlcmF0aW9uKCk7XG5cdFx0XHRcdGFjdGlvbihwcmVBY3Rpb25zW2NvdW50ZXJdLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihkYXRhKXtcblx0XHRcdFx0XHQvLyBDaGVjayBpZiBhbGwgcHJlLXJlcXVpc2l0ZXMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS5cblx0XHRcdFx0XHRjb21wbGV0ZWQucHVzaCh0cnVlKTtcblx0XHRcdFx0XHRsb29wLm5leHQoKTtcblx0XHRcdFx0fSwgZnVuY3Rpb24oZXJyKXtcblx0XHRcdFx0XHRjb21wbGV0ZWQucHVzaChmYWxzZSk7XG5cdFx0XHRcdFx0bG9vcC5icmVhaygpO1xuXHRcdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0sIGZ1bmN0aW9uKCl7XG5cdFx0XHRcdGlmIChjb21wbGV0ZWQuZXZlcnkoQm9vbGVhbikpIHtcblx0XHRcdFx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUHJlLXJlcXVpc2l0ZXMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7fSk7XG5cdFx0XHRcdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywgJ05vdCBhbGwgcHJlLXJlcXVpc2l0ZXMgcGFzc2VkLicpO1xuXHRcdFx0XHRcdHJlamVjdChlcnJvcik7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0gY2F0Y2ggKGVycikge1xuXHRcdFx0cmVqZWN0KGVycik7XG5cdFx0fVxuXHR9KTtcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgZ2V0IHN1Yi1wcm9jZXNzIGRhdGEuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGlkIC0gdGhlIHN1YlByb2Nlc3MgY29uZmlnIGlkXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgY3VycmVudCB3b3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZVxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbmZ1bmN0aW9uIGdldFN1YlByb2Nlc3MoaWQsIF9XRkluc3RhbmNlKXtcblx0aWYgKF9XRkluc3RhbmNlLnN1YnByb2Nlc3NlcyA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIFtdO1xuXHR9IGVsc2Uge1xuXHRcdF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzcyl7XG5cdFx0XHRpZiAoc3ViUHJvY2Vzcy5pZCA9PT0gaWQpIHtcblx0XHRcdFx0cmV0dXJuIHN1YlByb2Nlc3M7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxufTtcblxuLyoqXG4gKiBQcm9jZXNzIHN1Yi1wcm9jZXNzXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IHByb2Nlc3MgLSB0aGUgY3VycmVudCBwcm9jZXNzIGlkIGFuZCBzZXFcbiAqIEBwYXJhbSB7b2JqZWN0fSBzdWJQcm9jZXNzIC0gdGhlIHN1Yi1wcm9jZXNzIGlkIGFuZCBzZXFcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gdGhlIHVzZXIgaW5wdXQgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIHN1YlByb2Nlc3MocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIGRhdGEsIF9XRkluc3RhbmNlKXtcblx0Ly8gR2V0IHRoZSBjdXJyZW50IHByb2Nlc3Mgc3ViUHJvY2VzcyBpbnN0YW5jZVxuXHQvLyB2YXIgc3ViUHJvY2Vzc1NlcSA9IDE7XG5cdHZhciBzdWJQcm9jZXNzID0gW107XG5cdHZhciBwcm9jZXNzQ29uZiA9IFtdO1xuXHR2YXIgc3ViUHJvY2Vzc0NvbmYgPSBbXTtcblx0X1dGSW5zdGFuY2UuaW5zdGFuY2UucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpQcm9jZXNzKXtcblx0XHRpZiAob2JqUHJvY2Vzcy5pZCA9PT0gcHJvY2Vzc0lkICYmIG9ialByb2Nlc3Muc2VxID09PSBwcm9jZXNzU2VxKSB7XG5cdFx0XHR2YXIgc3BMZW5ndGggPSBvYmpQcm9jZXNzLnN1YlByb2Nlc3Nlcy5sZW5ndGg7XG5cdFx0XHRvYmpQcm9jZXNzLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqU3ViUHJvY2Vzcyl7XG5cdFx0XHRcdGlmIChvYmpTdWJQcm9jZXNzLmlkID09PSBzdWJQcm9jZXNzSWQgJiYgb2JqU3ViUHJvY2Vzcy5zZXEgPT09IHN1YlByb2Nlc3NTZXEpIHtcblx0XHRcdFx0XHR2YXIgdXVpZCA9IG9ialN1YlByb2Nlc3MudXVpZDtcblx0XHRcdFx0XHQvLyBzdWJQcm9jZXNzID0gb2JqU3ViUHJvY2Vzcztcblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyh1dWlkKTtcblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMubGVuZ3RoKTtcblx0XHRcdFx0XHRfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NJdGVtKXtcblx0XHRcdFx0XHRcdGlmIChzdWJQcm9jZXNzSXRlbS5faWQgPT09IHV1aWQpIHtcblx0XHRcdFx0XHRcdFx0c3ViUHJvY2VzcyA9IHN1YlByb2Nlc3NJdGVtO1xuXHRcdFx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhzdWJQcm9jZXNzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdH1cblx0fSlcblx0Ly8gR2V0IHRoZSBjdXJyZW50IHN1YlByb2Nlc3MgY29uZmlndXJhdGlvblxuXHRfV0ZJbnN0YW5jZS5jb25maWcucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihwcm9jZXNzQ29uZmlnKXtcblx0XHRpZiAocHJvY2Vzc0NvbmZpZy5faWQgPT09IHByb2Nlc3NJZCkge1xuXHRcdFx0cHJvY2Vzc0NvbmYgPSBwcm9jZXNzQ29uZmlnO1xuXHRcdFx0cHJvY2Vzc0NvbmZpZy5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NDb25maWcpe1xuXHRcdFx0XHRpZiAoc3ViUHJvY2Vzc0NvbmZpZy5faWQgPT09IHN1YlByb2Nlc3NJZCkge1xuXHRcdFx0XHRcdHN1YlByb2Nlc3NDb25mID0gc3ViUHJvY2Vzc0NvbmZpZztcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHR9XG5cdH0pXG5cdC8vIGlmIChzdWJQcm9jZXNzLmxlbmd0aCAhPT0gMCkge1xuXHQvLyBcdHN1YlByb2Nlc3NTZXEgPSBzdWJQcm9jZXNzLmxlbmd0aCArIDE7XG5cdC8vIH1cblx0Ly8gVGhlIGRlZmF1bHQgc3ViUHJvY2VzcyBtb2RlbFxuXHR2YXIgbW9kZWwgPSB7XG5cdFx0X2lkOiBfV0ZJbnN0YW5jZS5wcm9maWxlICsgJzonICsgX1dGSW5zdGFuY2UuYXBwICsgJzonICsgcHJvY2Vzc0lkICsgJzonICsgcHJvY2Vzc1NlcSArICc6JyArIHN1YlByb2Nlc3NJZCArICc6JyArIHN1YlByb2Nlc3NTZXEsXG5cdFx0aWQ6IHN1YlByb2Nlc3NJZCxcblx0XHR0eXBlOiAnd29ya2Zsb3dJbnN0YW5jZVN1YlByb2Nlc3MnLFxuXHRcdHNlcTogc3ViUHJvY2Vzc1NlcSxcblx0XHRpbml0aWF0ZWQ6IGZhbHNlLFxuXHRcdGRhdGVzOiB7XG5cdFx0XHRjcmVhdGVkOiAnJyxcblx0XHRcdHZhbGlkOiAnJyxcblx0XHRcdGR1ZTogJycsXG5cdFx0XHRjbG9zZWQ6ICcnXG5cdFx0fSxcblx0XHRjb21wbGV0ZTogZmFsc2UsXG5cdFx0aW5kaWNhdG9yczogW10sXG5cdFx0c3RlcDoge31cblx0fTtcblx0Ly8gUmV0dXJuIGEgcHJvbWlzZVxuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0Ly8gQ2F0Y2ggYWxsIHVuY2F1Z2h0IGVycm9yc1xuXHRcdHRyeSB7XG5cdFx0XHQvLyAxLiBQcm9jZXNzIHRoZSBwcmUtcmVxdWlzaXRlc1xuXHRcdFx0dmFyIHByZXJlcXVpc2l0ZUNvbmYgPSBwcm9jZXNzQ29uZi5wcmVyZXF1aXNpdGVzO1xuXHRcdFx0cHJlUmVxdWlzaXRlcyhwcmVyZXF1aXNpdGVDb25mLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuXHRcdFx0XHQvLyAyLiBJbml0aWF0ZSB0aGUgc3ViUHJvY2Vzc1xuXHRcdFx0XHR2YXIgaW5pdGlhdGVDb25mID0gc3ViUHJvY2Vzc0NvbmYuaW5pdGlhdGU7XG5cdFx0XHRcdGluaXRpYXRlKGluaXRpYXRlQ29uZiwgc3ViUHJvY2VzcywgZGF0YSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuXHRcdFx0XHRcdC8vVXBkYXRlIHRoZSBzdWJQcm9jZXNzIG1vZGVsXG5cdFx0XHRcdFx0bW9kZWwuaW5pdGlhdGVkID0gcmVzdWx0LmRhdGEuaW5pdGlhdGVkO1xuXHRcdFx0XHRcdG1vZGVsLmRhdGVzID0gcmVzdWx0LmRhdGEuZGF0ZXM7XG5cdFx0XHRcdFx0Ly8gRXhlY3V0ZSB0aGUgZmlyc3Qgc3RlcFxuXHRcdFx0XHRcdHZhciBzdGVwSWQgPSBzdWJQcm9jZXNzQ29uZi5zdGVwc1swXS5faWQ7XG5cdFx0XHRcdFx0dmFyIHRyYW5zaXRpb25JZCA9IHN1YlByb2Nlc3NDb25mLnN0ZXBzWzBdLnRyYW5zaXRpb25zWzBdLl9pZDtcblx0XHRcdFx0XHR2YXIgc3RlcFNlcSA9IDE7XG5cdFx0XHRcdFx0c3RlcChwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCBzdGVwU2VxLCBkYXRhLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuXHRcdFx0XHRcdFx0bW9kZWwuc3RlcCA9IHJlc3VsdC5kYXRhO1xuXHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2cobW9kZWwpO1xuXHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coc3ViUHJvY2Vzc0NvbmYpO1xuXHRcdFx0XHRcdFx0Ly8gVXBkYXRlIHRoZSBpbmRpY2F0b3Igc2VjdGlvbnMgb2YgdGhlIHN1YlByb2Nlc3Ncblx0XHRcdFx0XHRcdGluZGljYXRvcnMoc3ViUHJvY2Vzc0NvbmYuaW5kaWNhdG9ycywgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcblx0XHRcdFx0XHRcdFx0bW9kZWwuaW5kaWNhdG9ycyA9IHJlc3VsdC5kYXRhO1xuXHRcdFx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhyZXN1bHQuZGF0YSk7XG5cdFx0XHRcdFx0XHRcdC8vIEV4ZWN1dGUgdGhlIHRyYW5zaXRpb25zLCBpZiBhdXRvXG5cdFx0XHRcdFx0XHRcdHRyYW5zaXRpb24ocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwgdHJhbnNpdGlvbklkLCBkYXRhLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuXHRcdFx0XHRcdFx0XHRcdC8vIFVwZGF0ZSB0aGUgc3ViUHJvY2VzcyBzdGVwIGRhdGFcblx0XHRcdFx0XHRcdFx0XHRtb2RlbC5zdGVwID0gcmVzdWx0LmRhdGE7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2cocmVzdWx0LmRhdGEpO1xuXHRcdFx0ICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKHJlc3VsdC5tZXNzYWdlLCBtb2RlbCk7XG5cdFx0XHQgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblx0XHRcdCAgICAgICAgfSwgZnVuY3Rpb24oZXJyKXtcblx0XHRcdCAgICAgICAgICByZWplY3QoZXJyKTtcblx0XHRcdCAgICAgICAgfSk7XG5cdFx0XHRcdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuXHRcdFx0XHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0fSwgZnVuY3Rpb24oZXJyKXtcblx0XHRcdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG5cdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdH0pXG5cdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuXHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdH0pXG5cdFx0fSBjYXRjaChlcnIpe1xuXHRcdFx0cmVqZWN0KGVycik7XG5cdFx0fVxuXHR9KTtcbn07XG5cbi8qKlxuICogUHJvY2VzcyBpbml0aWF0ZVxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBpbml0aWF0ZSAtIHRoZSBpbml0aWF0ZSBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IGRhdGEgLSB0aGUgdXNlciBpbnB1dCBkYXRhXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBpbml0aWF0ZShpbml0aWF0ZSwgc3ViUHJvY2VzcywgZGF0YSl7XG5cdHZhciBjb21wbGV0ZWQgPSBbXTtcblx0dmFyIHJlc3VsdCA9IHtcblx0XHRpbml0aWF0ZWQ6IGZhbHNlLFxuXHRcdGRhdGVzOiB7XG5cdFx0XHRjcmVhdGVkOiAnJyxcblx0XHRcdHZhbGlkOiAnJyxcblx0XHRcdGR1ZTogJycsXG5cdFx0XHRjbG9zZWQ6ICcnXG5cdFx0fVxuXHR9O1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0dmFyIGluaXQgPSBmdW5jdGlvbigpe1xuXHRcdFx0c3dpdGNoKGluaXRpYXRlLl90eXBlKSB7XG5cdFx0XHRcdGNhc2UgJ3VzZXInOlxuXHRcdFx0XHRcdC8vIElmIHRoZSBzdWJQcm9jZXNzIGluaXRpYXRpb24gaXMgdXNlciBkZWZpbmVkIHRoZW5cblx0XHRcdFx0XHRyZXN1bHQuZGF0ZXMuY3JlYXRlZCA9IGRhdGEuY3JlYXRlZERhdGU7XG5cdFx0XHRcdFx0aWYgKGluaXRpYXRlLmRhdGVzLnZhbGlkLl90eXBlID09PSAndXNlclNlbGVjdGVkJykge1xuXHRcdFx0XHRcdFx0aWYgKGRhdGEudmFsaWREYXRlICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRcdFx0cmVzdWx0LmRhdGVzLnZhbGlkID0gZGF0YS52YWxpZERhdGU7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRkluaXRpYXRlRXJyb3InLCAnTm8gdmFsaWQgZGF0ZSBwYXNzZWQgaW4gLSB7aW5wdXREYXRhLnZhbGlkRGF0ZX0nKTtcblx0XHRcdFx0XHRcdFx0cmVqZWN0KGVycm9yKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKGluaXRpYXRlLmRhdGVzLmR1ZS5fdHlwZSA9PT0gJ3VzZXJTZWxlY3RlZCcpIHtcblx0XHRcdFx0XHRcdGlmIChkYXRhLmR1ZURhdGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdFx0XHRyZXN1bHQuZGF0ZXMuZHVlID0gZGF0YS5kdWVEYXRlO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0dmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZJbml0aWF0ZUVycm9yJywgJ05vIGR1ZSBkYXRlIHBhc3NlZCBpbiAtIHtpbnB1dERhdGEuZHVlRGF0ZX0nKTtcblx0XHRcdFx0XHRcdFx0cmVqZWN0KGVycm9yKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmVzdWx0LmluaXRpYXRlZCA9IHRydWU7XG5cdFx0XHRcdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1N1Yi1Qcm9jZXNzIGluaXRpYXRlIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywgcmVzdWx0KTtcblx0XHRcdFx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGSW5pdGlhdGVFcnJvcicsICdJbml0aWF0ZSB0eXBlOiAnICsgaW5pdGlhdGUuX3R5cGUgKyAnIG5vdCBkZWZpbmVkLicpO1xuXHRcdFx0XHRcdHJlamVjdChlcnJvcik7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmIChzdWJQcm9jZXNzLmNvbXBsZXRlID09PSB1bmRlZmluZWQpIHtcblx0XHRcdGluaXQoKTtcblx0XHR9IGVsc2UgaWYgKCFzdWJQcm9jZXNzLmNvbXBsZXRlKSB7XG5cdFx0XHRpZiAoaW5pdGlhdGUucGFyYWxsZWxJbnN0YW5jZXMpIHtcblx0XHRcdFx0aW5pdCgpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZJbml0aWF0ZUVycm9yJywgJ1N1Yi1wcm9jZXNzOiAnICsgc3ViUHJvY2Vzcy5pZCArICcgc3RpbGwgYWN0aXZlIGFuZCBwYXJhbGxlbCBpbnN0YW5jZXMgYXJlIG5vdCBhbGxvd2VkLicpO1xuXHRcdFx0XHRyZWplY3QoZXJyb3IpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG59O1xuXG4vKipcbiAqIFByb2Nlc3Mgc3RlcFxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgY3VycmVudCBwcm9jZXNzIGlkXG4gKiBAcGFyYW0ge3N0cmluZ30gc3ViUHJvY2Vzc0lkIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGVwSWQgLSB0aGUgY3VycmVudCBzdWItcHJvY2VzcyBzdGVwIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gc3RlcFNlcSAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIHN0ZXAgaW5zdGFuY2UgY291bnRlciAvIHNlcXVlbmNlXG4gKiBAcGFyYW0ge29iamVjdH0gZGF0YSAtIHRoZSB1c2VyIGlucHV0IGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IF9XRkluc3RhbmNlIGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBzdGVwKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHN0ZXBTZXEsIGRhdGEsIF9XRkluc3RhbmNlKXtcblx0Ly8gRGVmYXVsdCBzdGVwIG1vZGVsXG5cdHZhciBtb2RlbCA9IHtcblx0XHRpZDogJycsXG5cdFx0c2VxOiAnJyxcblx0XHRzdGF0dXM6ICcnLFxuXHRcdG1lc3NhZ2U6ICcnLFxuXHRcdGFzc2lnbmVkVG86IHtcblx0XHRcdHVzZXJJZDogJycsXG5cdFx0XHRuYW1lOiAnJ1xuXHRcdH0sXG5cdFx0Y29tbWVudDogJydcblx0fTtcblx0dmFyIHN1YlByb2Nlc3MgPSB7fTtcblx0dmFyIHV1aWQgPSAnJztcblx0dmFyIGluc3RTdWJQcm9jZXNzO1xuXHR2YXIgc3RlcCA9IHt9O1xuXHR2YXIgdHJhbnNpdGlvbklkID0gJyc7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHR0cnkge1xuXHRcdFx0Ly9HZXQgdGhlIGN1cnJlbnQgc3ViUHJvY2VzcyBpbnN0YW5jZSBkYXRhXG5cdFx0XHRfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialByb2Nlc3Mpe1xuXHRcdFx0XHRpZiAob2JqUHJvY2Vzcy5pZCA9PT0gcHJvY2Vzc0lkICYmIG9ialByb2Nlc3Muc2VxID09PSBwcm9jZXNzU2VxKSB7XG5cdFx0XHRcdFx0Ly8gY29uc29sZS5sb2cob2JqUHJvY2Vzcyk7XG5cdFx0XHRcdFx0b2JqUHJvY2Vzcy5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialN1YlByb2Nlc3Mpe1xuXHRcdFx0XHRcdFx0aWYgKG9ialN1YlByb2Nlc3MuaWQgPT09IHN1YlByb2Nlc3NJZCAmJiBvYmpTdWJQcm9jZXNzLnNlcSA9PT0gc3ViUHJvY2Vzc1NlcSkge1xuXHRcdFx0XHRcdFx0XHQvLyBpbnN0U3ViUHJvY2VzcyA9IG9ialN1YlByb2Nlc3M7XG5cdFx0XHRcdFx0XHRcdHV1aWQgPSBvYmpTdWJQcm9jZXNzLnV1aWQ7XG5cdFx0XHRcdFx0XHRcdC8vIHN1YlByb2Nlc3MgPSBvYmpTdWJQcm9jZXNzO1xuXHRcdFx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyh1dWlkKTtcblx0XHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzLmxlbmd0aCk7XG5cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdFx0Ly8gY29uc29sZS5sb2coX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzKTtcblx0XHRcdF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzc0l0ZW0pe1xuXHRcdFx0XHRpZiAoc3ViUHJvY2Vzc0l0ZW0uX2lkID09PSB1dWlkKSB7XG5cdFx0XHRcdFx0aW5zdFN1YlByb2Nlc3MgPSBzdWJQcm9jZXNzSXRlbTtcblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhpbnN0U3ViUHJvY2Vzcyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0XHQvLyBjb25zb2xlLmxvZyhpbnN0U3ViUHJvY2Vzcyk7XG5cdFx0XHQvLyBHZXQgdGhlIGN1cnJlbnQgY29uZmlnIHN0ZXBcblx0XHRcdF9XRkluc3RhbmNlLmNvbmZpZy5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialByb2Nlc3Mpe1xuXHRcdFx0XHRpZiAob2JqUHJvY2Vzcy5faWQgPT09IHByb2Nlc3NJZCkge1xuXHRcdFx0XHRcdG9ialByb2Nlc3Muc3ViUHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpTdWJQcm9jZXNzKXtcblx0XHRcdFx0XHRcdGlmIChvYmpTdWJQcm9jZXNzLl9pZCA9PT0gc3ViUHJvY2Vzc0lkKSB7XG5cdFx0XHRcdFx0XHRcdHN1YlByb2Nlc3MgPSBvYmpTdWJQcm9jZXNzO1xuXHRcdFx0XHRcdFx0XHRvYmpTdWJQcm9jZXNzLnN0ZXBzLmZpbHRlcihmdW5jdGlvbihvYmpTdGVwKXtcblx0XHRcdFx0XHRcdFx0XHRpZiAob2JqU3RlcC5faWQgPT09IHN0ZXBJZCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0c3RlcCA9IG9ialN0ZXA7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pXG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0Ly8gVXBkYXRlIHRoZSBzdWItcHJvY2VzcyBzdGVwIGRhdGFcblx0XHRcdG1vZGVsLmlkID0gc3RlcElkO1xuXHRcdFx0bW9kZWwuc2VxID0gc3RlcFNlcTtcblx0XHRcdG1vZGVsLnN0YXR1cyA9IHN0ZXAuX3NldEluc3RhbmNlU3RhdHVzVG87XG5cdFx0XHRtb2RlbC5tZXNzYWdlID0gc3RlcC5fc2V0U3RhdHVzTXNnVG87XG5cdFx0XHRtb2RlbC5hc3NpZ25lZFRvLnVzZXJJZCA9IGRhdGEudXNlcklkICE9PSB1bmRlZmluZWQgPyBkYXRhLnVzZXJJZCA6ICcnO1xuXHRcdFx0bW9kZWwuYXNzaWduZWRUby5uYW1lID0gZGF0YS5uYW1lICE9PSB1bmRlZmluZWQgPyBkYXRhLm5hbWUgOiAnJztcblx0XHRcdG1vZGVsLmNvbW1lbnQgPSBkYXRhLmNvbW1lbnQgIT09IHVuZGVmaW5lZCA/IGRhdGEuY29tbWVudCA6ICcnO1xuXHRcdFx0Ly8gVXBkYXRlIHRoZSBpbmRpY2F0b3IgZG9jdW1lbnRzIHByb2Nlc3Mgc3RlcCBkYXRhXG5cdFx0XHQvLyBjb25zb2xlLmxvZyhpbnN0U3ViUHJvY2Vzcyk7XG5cdFx0XHR2YXIgaW5kaWNhdG9ycyA9IGluc3RTdWJQcm9jZXNzICE9PSB1bmRlZmluZWQgPyBpbnN0U3ViUHJvY2Vzcy5pbmRpY2F0b3JzIDogW107XG5cdFx0XHRpbmRpY2F0b3JEb2NzKHByb2Nlc3NJZCwgaW5kaWNhdG9ycywgbW9kZWwsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG5cdFx0XHRcdC8vIElmIGFjdGlvbnMgYXJlIHNwZWNpZmllZCwgZXhlY3V0ZSB0aGVtXG5cdFx0XHRcdGlmIChzdGVwLmFjdGlvbnNbMF0gIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdGFjdGlvbnMoc3RlcC5hY3Rpb25zLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2VzcywgbW9kZWwsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG5cdFx0XHRcdFx0XHQvLyBFeGVjdXRlIHRoZSB0cmFuc2l0aW9ucywgaWYgYXV0b1xuXHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2cobW9kZWwpO1xuXHRcdFx0XHRcdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0FjdGlvbnMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCBtb2RlbCk7XG5cdFx0XHRcdFx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdFx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG5cdFx0XHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHQvLyBFbHNlIHRhc2tzIGFyZSBzcHJlY2lmaWVkLCBleGVjdXRlIHRoZW1cblx0XHRcdFx0fSBlbHNlIGlmIChzdGVwLnRhc2sgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdUYXNrIGF3YWl0aW5nIHVzZXIgYWN0aW9uLicsIG1vZGVsKTtcblx0XHRcdFx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuXHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdH0pXG5cdFx0fSBjYXRjaChlcnIpIHtcbiAgICBcdHJlamVjdChlcnIpO1xuICAgIH1cblx0fSk7XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgaW5kaWNhdG9yIHVwZGF0ZXNcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gYWN0aW9ucyAtIHRoZSBhY3Rpb25zIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gc3ViUHJvY2VzcyAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIGZvcm0gY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBpbmRpY2F0b3JzKGluZGljYXRvcnMsIF9XRkluc3RhbmNlKXtcblx0dmFyIG1vZGVsID0gW107XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHR0cnkge1xuXHRcdFx0Ly8gVXBkYXRlIHRoZSBpbmRpY2F0b3Igc2VjdGlvbnMgb2YgdGhlIHN1YlByb2Nlc3Ncblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgaW5kaWNhdG9ycy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgaW5kaWNhdG9ySWQgPSBpbmRpY2F0b3JzW2ldLl9pZDtcblx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRcdFx0dmFyIGluZGljYXRvciA9IF9XRkluc3RhbmNlLmluZGljYXRvcnNbal07XG5cdFx0XHRcdFx0dmFyIGluZGljYXRvck1vZGVsID0ge1xuXHRcdFx0XHRcdFx0aWQ6ICcnLFxuXHRcdFx0XHRcdFx0aW5zdGFuY2VzOiBbXVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR2YXIgaW5zdGFuY2VNb2RlbCA9IHtcblx0XHRcdFx0XHRcdHV1aWQ6ICcnLFxuXHRcdFx0XHRcdFx0dGl0bGU6ICcnLFxuXHRcdFx0XHRcdFx0a2V5OiAnJyxcblx0XHRcdFx0XHRcdHNlcTogMVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoaW5kaWNhdG9ySWQgPT09IGluZGljYXRvci5jYXRlZ29yeS50ZXJtKSB7XG5cdFx0XHRcdFx0XHRpbmRpY2F0b3JNb2RlbC5pZCA9IGluZGljYXRvcklkO1xuXHRcdFx0XHRcdFx0aW5zdGFuY2VNb2RlbC51dWlkID0gaW5kaWNhdG9yLl9pZDtcblx0XHRcdFx0XHRcdGluc3RhbmNlTW9kZWwudGl0bGUgPSBpbmRpY2F0b3IudGl0bGU7XG5cdFx0XHRcdFx0XHRpbnN0YW5jZU1vZGVsLmtleSA9ICcnO1xuXHRcdFx0XHRcdFx0aW5zdGFuY2VNb2RlbC5zZXEgPSAxO1xuXHRcdFx0XHRcdFx0aW5kaWNhdG9yTW9kZWwuaW5zdGFuY2VzLnB1c2goaW5zdGFuY2VNb2RlbCk7XG5cdFx0XHRcdFx0XHRtb2RlbC5wdXNoKGluZGljYXRvck1vZGVsKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdQcm9jZXNzIGluZGljYXRvciBtb2RlbCB1cGRhdGVkLicsIG1vZGVsKTtcblx0XHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdFx0fSBjYXRjaChlcnIpIHtcblx0XHRcdHJlamVjdChlcnIpO1xuXHRcdH1cblx0fSlcbn07XG5cbi8qKlxuICogUHJvY2VzcyBhc3NpZ24gdXNlclxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBwcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gcHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBwcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN1YlByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN1Yi1wcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gc3ViUHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBzdWItcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGVwSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdGVwIGlkXG4gKiBAcGFyYW0ge3N0cmluZ30gdHJhbnNpdGlvbklkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gdHJhbnNpdGlvbiBpZFxuICogQHBhcmFtIHtvYmplY3R9IHVzZXIgLSB0aGUgdXNlciB0byBhc3NpZ24gdG9cbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBhc3NpZ25Vc2VyKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCB1c2VyLCBfV0ZJbnN0YW5jZSl7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHR0cnkge1xuXHRcdFx0dmFyIHV1aWQgPSAnJztcblx0XHRcdC8vIEdldCB0aGUgY3VycmVudCBzdWJQcm9jZXNzIGluc3RhbmNlIGRhdGFcblx0XHRcdF9XRkluc3RhbmNlLmluc3RhbmNlLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqUHJvY2Vzcyl7XG5cdFx0XHRcdGlmIChvYmpQcm9jZXNzLmlkID09PSBwcm9jZXNzSWQgJiYgb2JqUHJvY2Vzcy5zZXEgPT09IHByb2Nlc3NTZXEpIHtcblx0XHRcdFx0XHRvYmpQcm9jZXNzLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqU3ViUHJvY2Vzcyl7XG5cdFx0XHRcdFx0XHRpZiAob2JqU3ViUHJvY2Vzcy5pZCA9PT0gc3ViUHJvY2Vzc0lkICYmIG9ialN1YlByb2Nlc3Muc2VxID09PSBzdWJQcm9jZXNzU2VxKSB7XG5cdFx0XHRcdFx0XHRcdHV1aWQgPSBvYmpTdWJQcm9jZXNzLnV1aWQ7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0fVxuXHRcdFx0fSlcblx0XHRcdF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzc0l0ZW0pe1xuXHRcdFx0XHRpZiAoc3ViUHJvY2Vzc0l0ZW0uX2lkID09PSB1dWlkKSB7XG5cdFx0XHRcdFx0Ly8gU2V0IHRoZSB1c2VyIGRldGFpbHNcblx0XHRcdFx0XHRzdWJQcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8udXNlcklkID0gdXNlci5pZDtcblx0XHRcdFx0XHRzdWJQcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8ubmFtZSA9IHVzZXIubmFtZTtcblx0XHRcdFx0XHQvLyBVcGRhdGUgdGhlIGluZGljYXRvcnMgdXNlciBkZXRhaWxzXG5cdFx0XHRcdFx0dmFyIGluZGljYXRvcnMgPSBzdWJQcm9jZXNzSXRlbS5pbmRpY2F0b3JzO1xuXHRcdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgaW5kaWNhdG9ycy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdFx0dmFyIGluZGljYXRvciA9IGluZGljYXRvcnNbaV07XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBqID0gMDsgaiA8IGluZGljYXRvci5pbnN0YW5jZXMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0XHRcdFx0dmFyIGluc3RhbmNlID0gaW5kaWNhdG9yLmluc3RhbmNlc1tqXTtcblx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgayA9IDA7IGsgPCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmxlbmd0aDsgaysrKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGRvYyA9IF9XRkluc3RhbmNlLmluZGljYXRvcnNba107XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGluc3RhbmNlLnV1aWQgPT09IGRvYy5faWQpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGRvYy53b3JrZmxvd3MuZmlsdGVyKGZ1bmN0aW9uKHdvcmtmbG93KXtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHdvcmtmbG93LmlkID09PSBfV0ZJbnN0YW5jZS5jb25maWcuX2lkKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0d29ya2Zsb3cucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihwcm9jZXNzSXRlbSl7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAocHJvY2Vzc0l0ZW0uaWQgPT09IHByb2Nlc3NJZCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBVcGRhdGUgdGhlIHVzZXIgaWQgYW5kIG5hbWUgaW4gdGhlIGRvY3VtZW50XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUby51c2VySWQgPSB1c2VyLmlkO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRwcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8ubmFtZSA9IHVzZXIubmFtZTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnVXNlciBhc3NpZ25lZCBzdWNjZXNzZnVsbHkuIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJywgc3ViUHJvY2Vzc0l0ZW0pO1xuXHRcdFx0XHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0fSBjYXRjaChlcnIpe1xuXHRcdFx0cmVqZWN0KGVycik7XG5cdFx0fVxuXHR9KTtcbn07XG4vKipcbiAqIFByb2Nlc3MgaW5kaWNhdG9yIGRvY3VtZW50IHVwZGF0ZXNcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gYWN0aW9ucyAtIHRoZSBhY3Rpb25zIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gc3ViUHJvY2VzcyAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIGZvcm0gY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBpbmRpY2F0b3JEb2NzKHByb2Nlc3NJZCwgaW5kaWNhdG9ycywgc3RlcCwgX1dGSW5zdGFuY2Upe1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0dHJ5IHtcblx0XHRcdC8vIFVwZGF0ZSB0aGUgaW5kaWNhdG9yIHNlY3Rpb25zIG9mIHRoZSBzdWJQcm9jZXNzXG5cdFx0XHRpZiAoaW5kaWNhdG9ycyA9PT0gdW5kZWZpbmVkKXtcblx0XHRcdFx0dmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZJbmRpY2F0b3JzVXBkYXRlJywgJ0luZGljYXRvcnMgcGFyYW1ldGVyIGlzIHJlcXVpcmVkLiAtIFZhbHVlOiAnICsgaW5kaWNhdG9ycylcblx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGluZGljYXRvcnMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHR2YXIgaW5kaWNhdG9yID0gaW5kaWNhdG9yc1tpXTtcblx0XHRcdFx0XHRmb3IgKHZhciBqID0gMDsgaiA8IGluZGljYXRvci5pbnN0YW5jZXMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0XHRcdHZhciBpbnN0YW5jZSA9IGluZGljYXRvci5pbnN0YW5jZXNbal07XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBrID0gMDsgayA8IF9XRkluc3RhbmNlLmluZGljYXRvcnMubGVuZ3RoOyBrKyspIHtcblx0XHRcdFx0XHRcdFx0dmFyIGRvYyA9IF9XRkluc3RhbmNlLmluZGljYXRvcnNba107XG5cdFx0XHRcdFx0XHRcdGlmIChpbnN0YW5jZS51dWlkID09PSBkb2MuX2lkKSB7XG5cdFx0XHRcdFx0XHRcdFx0ZG9jLndvcmtmbG93cy5maWx0ZXIoZnVuY3Rpb24od29ya2Zsb3cpe1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKHdvcmtmbG93LmlkID09PSBfV0ZJbnN0YW5jZS5jb25maWcuX2lkKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHdvcmtmbG93LnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ocHJvY2Vzc0l0ZW0pe1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChwcm9jZXNzSXRlbS5pZCA9PT0gcHJvY2Vzc0lkKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRwcm9jZXNzSXRlbS5zdGVwLmlkID0gc3RlcC5pZDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHByb2Nlc3NJdGVtLnN0ZXAuc2VxID0gc3RlcC5zZXE7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRwcm9jZXNzSXRlbS5zdGVwLnN0YXR1cyA9IHN0ZXAuc3RhdHVzO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cHJvY2Vzc0l0ZW0uc3RlcC5tZXNzYWdlID0gc3RlcC5tZXNzYWdlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLnVzZXJJZCA9IHN0ZXAuYXNzaWduZWRUby51c2VySWQ7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRwcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8ubmFtZSA9IHN0ZXAuYXNzaWduZWRUby5uYW1lO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cHJvY2Vzc0l0ZW0uc3RlcC5jb21tZW50ID0gc3RlcC5jb21tZW50ICE9PSB1bmRlZmluZWQgPyBzdGVwLmNvbW1lbnQgOiAnJztcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnSW5kaWNhdG9yIGRvY3VtZW50cyB3b3JrZmxvdyBwcm9jZXNzIG1vZGVsIHVwZGF0ZWQuJywgX1dGSW5zdGFuY2UpO1xuXHRcdFx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2goZXJyKSB7XG5cdFx0XHRyZWplY3QoZXJyKTtcblx0XHR9XG5cdH0pXG59O1xuXG4vKipcbiAqIFByb2Nlc3MgYWN0aW9uc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBhY3Rpb25zIC0gdGhlIGFjdGlvbnMgY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBzdWJQcm9jZXNzIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3MgZm9ybSBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIGFjdGlvbnMoYWN0aW9ucywgcHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN1YlByb2Nlc3MsIHN0ZXAsIF9XRkluc3RhbmNlKXtcblx0dmFyIGFyckFjdGlvbnMgPSBbXTtcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdHV0aWwuc3luY0xvb3AoYWN0aW9ucy5sZW5ndGgsIGZ1bmN0aW9uKGxvb3Ape1xuXHRcdFx0dmFyIGNvdW50ZXIgPSBsb29wLml0ZXJhdGlvbigpO1xuXHRcdFx0YWN0aW9uKGFjdGlvbnNbY291bnRlcl0sIHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdWJQcm9jZXNzLCBzdGVwLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuXHRcdFx0XHR2YXIgcmV0QWN0aW9uID0geyBpZDogYWN0aW9uc1tjb3VudGVyXS5faWQsIHNlcTogY291bnRlciwgZGF0YTogcmVzdWx0IH07XG5cdFx0XHRcdGFyckFjdGlvbnMucHVzaChyZXRBY3Rpb24pO1xuXHRcdFx0XHRsb29wLm5leHQoKTtcblx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG5cdFx0XHRcdGxvb3AuYnJlYWsoKTtcblx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHR9KTtcblx0XHR9LCBmdW5jdGlvbigpe1xuXHRcdFx0Ly8gT24gY29tcGxldGlvbiBvZiB0aGUgbG9vcFxuXHRcdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0FjdGlvbnMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCBhcnJBY3Rpb25zKTtcblx0XHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdFx0fSk7XG5cdH0pO1xufTtcblxuLyoqXG4gKiBQcm9jZXNzIGFjdGlvblxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBhY3Rpb24gLSB0aGUgYWN0aW9uIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gc3ViUHJvY2VzcyAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIGZvcm0gY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBhY3Rpb24oYWN0aW9uLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2Vzcywgc3RlcCwgX1dGSW5zdGFuY2Upe1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0dmFyIGFyZ3MgPSBbXTtcblx0XHR2YXIgY29udGV4dCA9ICdnbG9iYWwnO1xuXHRcdHZhciBtZXRob2QgPSAnJztcblx0XHRpZiAoYWN0aW9uLl9pZCAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRjb250ZXh0ID0gYWN0aW9uLl9pZC5zcGxpdChcIi5cIilbMF07XG5cdFx0fVxuXHRcdGlmIChhY3Rpb24uX2lkICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdG1ldGhvZCA9IGFjdGlvbi5faWQuc3BsaXQoXCIuXCIpWzFdO1xuXHRcdH1cblx0XHRhcmdzLmxlbmd0aCA9IDA7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBhY3Rpb24uX2FyZ3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciBhcmcgPSBhY3Rpb24uX2FyZ3NbaV07XG5cdFx0XHRzd2l0Y2goYXJnKSB7XG5cdFx0XHRcdGNhc2UgJ3Byb2Nlc3NJZCc6XG5cdFx0XHRcdFx0YXJncy5wdXNoKHByb2Nlc3NJZCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ3Byb2Nlc3NTZXEnOlxuXHRcdFx0XHRcdGFyZ3MucHVzaChwcm9jZXNzU2VxKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnc3ViUHJvY2Vzc0lkJzpcblx0XHRcdFx0XHRhcmdzLnB1c2goc3ViUHJvY2Vzc0lkKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnc3ViUHJvY2Vzc1NlcSc6XG5cdFx0XHRcdFx0YXJncy5wdXNoKHN1YlByb2Nlc3NTZXEpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdzdWJQcm9jZXNzJzpcblx0XHRcdFx0XHRhcmdzLnB1c2goc3ViUHJvY2Vzcyk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ3N0ZXAnOlxuXHRcdFx0XHRcdGFyZ3MucHVzaChzdGVwKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Ly8gQWRkIHRoZSByZXF1aXJlZCBwYXJhbWV0ZXJzIHRvIHRoZSBhcmdzIGFycmF5XG5cblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRhcmdzID0gW107XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG5cdFx0aWYgKGFjdGlvbi5faWQgPT09ICdmb3JtLmNyZWF0ZScpIHtcblx0XHRcdGZvcm0uY3JlYXRlKGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcblx0XHRcdFx0cmVzb2x2ZShyZXN1bHQuZGF0YSk7XG5cdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuXHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSBpZiAoYWN0aW9uLl9pZCA9PT0gJ2Zvcm0uYXV0aG9yaXNlJykge1xuXHRcdFx0Zm9ybS5hdXRob3Jpc2UoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuXHRcdFx0XHRyZXNvbHZlKHJlc3VsdC5kYXRhKTtcblx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG5cdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIGlmIChhY3Rpb24uX2lkID09PSAnZm9ybS5jbG9zZScpIHtcblx0XHRcdGZvcm0uY2xvc2UoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuXHRcdFx0XHRyZXNvbHZlKHJlc3VsdC5kYXRhKTtcblx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG5cdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGQWN0aW9uRXJyb3InLCAnTWV0aG9kOiAnICsgYWN0aW9uX2lkICsgJyBub3QgZGVmaW5lZC4nKTtcblx0XHRcdHJlamVjdChlcnJvcik7XG5cdFx0fVxuXHRcdC8vIGlmIChjb250ZXh0ID09PSAnZm9ybScpIHtcblx0XHQvLyBcdGZvcm1bbWV0aG9kXShhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG5cdFx0Ly8gXHRcdHJlc29sdmUocmVzdWx0LmRhdGEpO1xuXHRcdC8vIFx0fSwgZnVuY3Rpb24oZXJyKXtcblx0XHQvLyBcdFx0cmVqZWN0KGVycik7XG5cdFx0Ly8gXHR9KTtcblx0XHQvLyB9IGVsc2Uge1xuXHRcdC8vIFx0dmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZBY3Rpb25FcnJvcicsICdNb2R1bGU6ICcgKyBjb250ZXh0ICsgJyBub3QgZGVmaW5lZC4nKTtcblx0XHQvLyBcdHJlamVjdChlcnJvcik7XG5cdFx0Ly8gfVxuXHR9KTtcbn07XG5cbi8qKlxuICogUHJvY2VzcyB0YXNrXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IHRhc2sgLSB0aGUgdGFzayBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IGlucHV0RGF0YSAtIHRoZSB1c2VyIGlucHV0IGRhdGFcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIHRhc2sodGFzayl7XG5cdHJldHVybiAnSW1wbGVtZW50YXRpb24gcGVuZGluZy4uJztcbn07XG5cbi8qKlxuICogUHJvY2VzcyB0cmFuc2l0aW9uXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBwcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3ViUHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3ViLXByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdWJQcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHN1Yi1wcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN0ZXBJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN0ZXAgaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0cmFuc2l0aW9uSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiB0cmFuc2l0aW9uIGlkXG4gKiBAcGFyYW0ge29iamVjdH0gZGF0YSAtIGFueSBhZGRpdGlvbmFsIGRhdGEgcGFzc2VkIGluIGFzIGtleSB2YWx1ZSBwYWlyc1xuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIHRyYW5zaXRpb24ocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwgdHJhbnNpdGlvbklkLCBkYXRhLCBfV0ZJbnN0YW5jZSl7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHR0cnkge1xuXHRcdFx0dmFyIHN0ZXBTZXEgPSAwO1xuXHRcdFx0dmFyIG5leHRTdGVwSWQgPSAnJztcblx0XHRcdHZhciBuZXh0U3RlcFNlcSA9IDA7XG5cdFx0XHR2YXIgc3ViUHJvY2VzcyA9IFtdO1xuXHRcdFx0dmFyIGN1cnJlbnRQcm9jZXNzID0gX1dGSW5zdGFuY2UuY29uZmlnLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqUHJvY2Vzcyl7XG5cdFx0XHRcdGlmIChvYmpQcm9jZXNzLl9pZCA9PT0gcHJvY2Vzc0lkKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG9ialByb2Nlc3M7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0dmFyIGN1cnJlbnRTdWJQcm9jZXNzID0gY3VycmVudFByb2Nlc3NbMF0uc3ViUHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpTdWJQcm9jZXNzKXtcblx0XHRcdFx0aWYgKG9ialN1YlByb2Nlc3MuX2lkID09PSBzdWJQcm9jZXNzSWQpIHtcblx0XHRcdFx0XHRyZXR1cm4gb2JqU3ViUHJvY2Vzcztcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHR2YXIgY3VycmVudFN0ZXAgPSBjdXJyZW50U3ViUHJvY2Vzc1swXS5zdGVwcy5maWx0ZXIoZnVuY3Rpb24ob2JqU3RlcCl7XG5cdFx0XHRcdGlmIChvYmpTdGVwLl9pZCA9PT0gc3RlcElkKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG9ialN0ZXA7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0dmFyIHRyYW5zaXRpb24gPSBjdXJyZW50U3RlcFswXS50cmFuc2l0aW9ucy5maWx0ZXIoZnVuY3Rpb24ob2JqVHJhbnNpdGlvbil7XG5cdFx0XHRcdGlmIChvYmpUcmFuc2l0aW9uLl9pZCA9PT0gdHJhbnNpdGlvbklkKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG9ialRyYW5zaXRpb247XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjdXJyZW50U3ViUHJvY2Vzc1swXS5zdGVwcy5sZW5ndGg7IGkrKyl7XG5cdFx0XHRcdGlmIChjdXJyZW50U3ViUHJvY2Vzc1swXS5zdGVwc1tpXS5faWQgPT09IHN0ZXBJZCkge1xuXHRcdFx0XHRcdHN0ZXBTZXEgPSBwYXJzZUludChjdXJyZW50U3ViUHJvY2Vzc1swXS5zdGVwc1tpXS5fc2VxKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Y3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHMuZmlsdGVyKGZ1bmN0aW9uKHN0ZXBJdGVtKXtcblx0XHRcdFx0bmV4dFN0ZXBTZXEgPSBzdGVwU2VxICsgMTtcblx0XHRcdFx0aWYgKHBhcnNlSW50KHN0ZXBJdGVtLl9zZXEpID09PSBuZXh0U3RlcFNlcSkge1xuXHRcdFx0XHRcdG5leHRTdGVwSWQgPSBzdGVwSXRlbS5faWQ7XG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0XHQvLyBjb25zb2xlLmxvZyhfV0ZJbnN0YW5jZS5pbnN0YW5jZSk7XG5cdFx0XHRfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialByb2Nlc3Mpe1xuXHRcdFx0XHRpZiAob2JqUHJvY2Vzcy5pZCA9PT0gcHJvY2Vzc0lkICYmIG9ialByb2Nlc3Muc2VxID09PSBwcm9jZXNzU2VxKSB7XG5cdFx0XHRcdFx0b2JqUHJvY2Vzcy5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialN1YlByb2Nlc3Mpe1xuXHRcdFx0XHRcdFx0aWYgKG9ialN1YlByb2Nlc3MuaWQgPT09IHN1YlByb2Nlc3NJZCAmJiBvYmpTdWJQcm9jZXNzLnNlcSA9PT0gc3ViUHJvY2Vzc1NlcSkge1xuXHRcdFx0XHRcdFx0XHR2YXIgdXVpZCA9IG9ialN1YlByb2Nlc3MudXVpZDtcblx0XHRcdFx0XHRcdFx0Ly8gc3ViUHJvY2VzcyA9IG9ialN1YlByb2Nlc3M7XG5cdFx0XHRcdFx0XHRcdF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzc0l0ZW0pe1xuXHRcdFx0XHRcdFx0XHRcdGlmIChzdWJQcm9jZXNzSXRlbS5faWQgPT09IHV1aWQpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHN1YlByb2Nlc3MgPSBzdWJQcm9jZXNzSXRlbTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHR2YXIgbWF4U3RlcHMgPSBjdXJyZW50U3ViUHJvY2Vzc1swXS5zdGVwcy5sZW5ndGg7XG5cdFx0XHRzd2l0Y2godHJhbnNpdGlvblswXS5fdHlwZSkge1xuXHRcdFx0XHRjYXNlICdhdXRvJzpcblx0XHRcdFx0XHRpZiAodHJhbnNpdGlvblswXS5nb1RvLl90eXBlID09PSAnbmV4dFN0ZXAnKSB7XG5cdFx0XHRcdFx0XHRzdGVwKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBuZXh0U3RlcElkLCBuZXh0U3RlcFNlcSwgZGF0YSwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcblx0XHRcdFx0XHRcdFx0aWYgKG5leHRTdGVwU2VxID09PSBtYXhTdGVwcykge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdBbGwgU3RlcCB0cmFuc2l0aW9ucyBoYXZlIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywgeyBzdWJQcm9jZXNzQ29tcGxldGU6IHRydWUsIHN0ZXA6IHJlc3VsdC5kYXRhIH0pO1xuXHRcdFx0XHRcdFx0XHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1N0ZXAgdHJhbnNpdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdC5kYXRhKTtcblx0XHRcdFx0XHRcdFx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdGVwIHRyYW5zaXRpb24gY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCByZXN1bHQuZGF0YSk7XG5cdFx0XHRcdFx0XHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdFx0XHRcdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuXHRcdFx0XHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAndXNlcic6XG5cdFx0XHRcdFx0aWYgKHRyYW5zaXRpb25bMF0uZ29Uby5fdHlwZSA9PT0gJ25leHRTdGVwJykge1xuXHRcdFx0XHRcdFx0c3RlcChwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgbmV4dFN0ZXBJZCwgbmV4dFN0ZXBTZXEsIGRhdGEsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG5cdFx0XHRcdFx0XHRcdGlmIChuZXh0U3RlcFNlcSA9PT0gbWF4U3RlcHMpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnQWxsIFN0ZXAgdHJhbnNpdGlvbnMgaGF2ZSBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHsgc3ViUHJvY2Vzc0NvbXBsZXRlOiB0cnVlLCBzdGVwOiByZXN1bHQuZGF0YSB9KTtcblx0XHRcdFx0XHRcdFx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdGVwIHRyYW5zaXRpb24gY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCByZXN1bHQuZGF0YSk7XG5cdFx0XHRcdFx0XHRcdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnU3RlcCB0cmFuc2l0aW9uIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywgcmVzdWx0LmRhdGEpO1xuXHRcdFx0XHRcdFx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdFx0XHRcdFx0fSwgZnVuY3Rpb24oZXJyKXtcblx0XHRcdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKHRyYW5zaXRpb25bMF0uZ29Uby5fdHlwZSA9PT0gJ3N0ZXBJZCcpIHtcblx0XHRcdFx0XHRcdHZhciBnb1RvU3RlcElkID0gdHJhbnNpdGlvblswXS5nb1RvLl9zdGVwSWQ7XG5cdFx0XHRcdFx0XHR2YXIgZ29Ub1N0ZXBTZXEgPSAxO1xuXHRcdFx0XHRcdFx0Y3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHMuZmlsdGVyKGZ1bmN0aW9uKHN0ZXBJdGVtKXtcblx0XHRcdFx0XHRcdFx0aWYgKHN0ZXBJdGVtLl9pZCA9PT0gZ29Ub1N0ZXBJZCkge1xuXHRcdFx0XHRcdFx0XHRcdGdvVG9TdGVwU2VxID0gcGFyc2VJbnQoc3RlcEl0ZW0uX3NlcSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0XHRzdGVwKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBnb1RvU3RlcElkLCBnb1RvU3RlcFNlcSwgZGF0YSwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcblx0XHRcdFx0XHRcdFx0aWYgKGdvVG9TdGVwU2VxID09PSBtYXhTdGVwcykge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdBbGwgU3RlcCB0cmFuc2l0aW9ucyBoYXZlIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywgeyBzdWJQcm9jZXNzQ29tcGxldGU6IHRydWUsIHN0ZXA6IHJlc3VsdC5kYXRhIH0pO1xuXHRcdFx0XHRcdFx0XHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1N0ZXAgdHJhbnNpdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdC5kYXRhKTtcblx0XHRcdFx0XHRcdFx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdGVwIHRyYW5zaXRpb24gY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCByZXN1bHQuZGF0YSk7XG5cdFx0XHRcdFx0XHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdFx0XHRcdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuXHRcdFx0XHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHR2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlRyYW5zaXRpb25FcnJvcicsJ1RyYW5zaXRpb24gdHlwZTogJyArIHRyYW5zaXRpb25bMF0uX3R5cGUgKyAnIG5vdCBkZWZpbmVkLicpO1xuXHRcdFx0XHRcdHJlamVjdChlcnJvcik7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaChlcnIpe1xuXHRcdFx0cmVqZWN0KGVycik7XG5cdFx0fVxuXHR9KTtcbn07XG5cbi8qKlxuICogUHJvY2VzcyBwb3N0QWN0aW9uc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBwb3N0QWN0aW9ucyAtIHRoZSBwb3N0QWN0aW9ucyBjb25maWcgZGF0YVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gcG9zdEFjdGlvbnMocG9zdEFjdGlvbnMpe1xuXHRyZXR1cm4gJ0ltcGxlbWVudGF0aW9uIHBlbmRpbmcuLic7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuIFx0cHJlUmVxdWlzaXRlczogcHJlUmVxdWlzaXRlcyxcbiBcdHByZUFjdGlvbnM6IHByZUFjdGlvbnMsXG4gXHRzdWJQcm9jZXNzOiBzdWJQcm9jZXNzLFxuXHRpbmRpY2F0b3JEb2NzOiBpbmRpY2F0b3JEb2NzLFxuIFx0dGFzazogdGFzayxcbiBcdHRyYW5zaXRpb246IHRyYW5zaXRpb24sXG5cdGFzc2lnblVzZXI6IGFzc2lnblVzZXJcblxufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIFV0aWxpdHkgTW9kdWxlXG4gKlxuICogQG1vZHVsZSBsaWIvdXRpbFxuICpcbiAqIEBhdXRob3IgQnJlbnQgR29yZG9uXG4gKiBAdmVyc2lvbiAwLjEuMFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogV29ya2Zsb3cgdXRpbGl0eSBtb2R1bGUgdXNlZCB0byBmb3JtYXQgdGhlIHJldHVybiBhbmQgZXJyb3Igb2JqZWN0cywgYW5kXG4gKiBjb250YWlucyBzb21lIG90aGVyIHV0aWxpdHkgZnVuY3Rpb25zIHN1Y2ggYXMgYSBzeW5jIGxvb3AgYW5kIGNvbXBhcmUuXG4gKlxuICovXG5cbi8qKlxuICogU3VjY2VzcyBibG9jayByZXR1cm4gb2JqZWN0LCBjb250YWlucyBhIG1lc3NhZ2UgYW5kIG9wdGlvbmFsIGRhdGEgb2JqZWN0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlIC0gdGhlIHN1Y2Nlc3MgbWVzc2FnZVxuICogQHBhcmFtIHtzdHJpbmd8T2JqZWN0fSBbZGF0YV0gLSB0aGUgc3VjY2VzcyByZXR1cm5lZCBkYXRhXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIFJldHVybiBzdWNjZXNzIHdpdGhvdXQgYSBkYXRhIGJsb2NrXG4gKiB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnU3VjY2VzcyBtZXNzYWdlIGdvZXMgaGVyZS4uLicpO1xuICpcbiAqIEByZXR1cm4ge09iamVjdH0gLSB3aXRoIG1lc3NhZ2UgYW5kIGRhdGEgcHJvcGVydGllc1xuICpcbiAqL1xuZnVuY3Rpb24gc3VjY2VzcyhtZXNzYWdlLCBkYXRhKXtcblx0cmV0dXJuIHtcblx0XHRtZXNzYWdlOiBtZXNzYWdlLFxuXHRcdGRhdGE6IGRhdGFcblx0fTtcbn07XG5cbi8qKlxuICogV2FybmluZyBibG9jayByZXR1cm4gb2JqZWN0LCBjb250YWlucyBhIG1lc3NhZ2UgYW5kIG9wdGlvbmFsIGRhdGEgb2JqZWN0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlIC0gdGhlIHdhcm5pbmcgbWVzc2FnZVxuICogQHBhcmFtIHtzdHJpbmd8T2JqZWN0fSBbZGF0YV0gLSB0aGUgcmV0dXJuZWQgZGF0YVxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBSZXR1cm4gc3VjY2VzcyB3aXRob3V0IGEgZGF0YSBibG9ja1xuICogdmFyIHN1Y2Nlc3MgPSB1dGlsLndhcm4oJ1dhcm5pbmcgbWVzc2FnZSBnb2VzIGhlcmUuLi4nKTtcbiAqXG4gKiBAcmV0dXJuIHtPYmplY3R9IHdpdGggbWVzc2FnZSBhbmQgZGF0YSBwcm9wZXJ0aWVzLCBhbmQgbG9ncyB0aGUgd2FybmluZyB0byB0aGUgY29uc29sZS5cbiAqXG4gKi9cbmZ1bmN0aW9uIHdhcm4obWVzc2FnZSwgZGF0YSl7XG5cdGNvbnNvbGUud2FybihkYXRhKTtcblx0cmV0dXJuIHtcblx0XHR3YXJuaW5nOiBtZXNzYWdlLFxuXHRcdGRhdGE6IGRhdGFcblx0fTtcbn07XG5cbi8qKlxuICogRXJyb3IgYmxvY2sgSlMgZXJyb3Igb2JqZWN0LCBjb250YWlucyBhIGNvZGUgYW5kIG1lc3NhZ2UgZm9yIHRoZSBlcnJvci5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gY29kZSAtIHRoZSBlcnJvciBjb2RlXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSAtIHRoZSBlcnJvciBtZXNzYWdlXG4gKlxuICogQGV4YW1wbGVcbiAqIHZhciBzdWNjZXNzID0gdXRpbC5lcnJvcignRXJyb3IwMDEnLCdFcnJvciBtZXNzYWdlIGdvZXMgaGVyZS4uLicpO1xuICpcbiAqIEByZXR1cm4ge09iamVjdH0gd2l0aCBhIGNvZGUgYW5kIG1lc3NhZ2UgcHJvcGVydGllcy5cbiAqXG4gKi9cbmZ1bmN0aW9uIGVycm9yKGNvZGUsIG1lc3NhZ2Upe1xuXHR2YXIgZXJyID0gbmV3IEVycm9yKCcnKTtcblx0ZXJyLm5hbWUgPSBjb2RlO1xuXHRlcnIubWVzc2FnZSA9IG1lc3NhZ2U7XG5cdHJldHVybiBlcnI7XG59O1xuXG4vKipcbiAqIEEgbG9vcCB3aGljaCBjYW4gbG9vcCBYIGFtb3VudCBvZiB0aW1lcywgd2hpY2ggY2FycmllcyBvdXRcbiAqIGFzeW5jaHJvbm91cyBjb2RlLCBidXQgd2FpdHMgZm9yIHRoYXQgY29kZSB0byBjb21wbGV0ZSBiZWZvcmUgbG9vcGluZy5cbiAqXG4gKiBAcGFyYW0ge251bWJlcn0gaXRlcmF0aW9ucyAtIHRoZSBudW1iZXIgb2YgaXRlcmF0aW9ucyB0byBjYXJyeSBvdXRcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IHByb2Nlc3MgLSB0aGUgY29kZS9mdW5jdGlvbiB3ZSdyZSBydW5uaW5nIGZvciBldmVyeVxuICogaXRlcmF0aW9uXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBleGl0IC0gYW4gb3B0aW9uYWwgY2FsbGJhY2sgdG8gY2Fycnkgb3V0IG9uY2UgdGhlIGxvb3BcbiAqIGhhcyBjb21wbGV0ZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogdXRpbC5zeW5jTG9vcCg1LCBmdW5jdGlvbihsb29wKXtcbiAqIFx0dmFyIGNvdW50ZXIgPSBsb29wLml0ZXJhdGlvbigpO1xuICogXHQvLyBBZGQgYXN5bmMgY2FsbHMgaGVyZS4uXG4gKlxuICogfSwgZnVuY3Rpb24oKXtcbiAqIFx0Ly8gT24gY29tcGxldGUgcGVyZm9ybSBhY3Rpb25zIGhlcmUuLi5cbiAqXG4gKiB9KTtcbiAqXG4gKiBAcmV0dXJuIHtPYmplY3R9IHRoZSBsb29wIGNvbnRyb2wgb2JqZWN0LlxuICpcbiAqL1xuZnVuY3Rpb24gc3luY0xvb3AoaXRlcmF0aW9ucywgcHJvY2VzcywgZXhpdCl7XG4gICAgdmFyIGluZGV4ID0gMCxcbiAgICAgICAgZG9uZSA9IGZhbHNlLFxuICAgICAgICBzaG91bGRFeGl0ID0gZmFsc2U7XG4gICAgdmFyIGxvb3AgPSB7XG4gICAgICAgIG5leHQ6ZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGlmKGRvbmUpe1xuICAgICAgICAgICAgICAgIGlmKHNob3VsZEV4aXQgJiYgZXhpdCl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBleGl0KCk7IC8vIEV4aXQgaWYgd2UncmUgZG9uZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIElmIHdlJ3JlIG5vdCBmaW5pc2hlZFxuICAgICAgICAgICAgaWYoaW5kZXggPCBpdGVyYXRpb25zKXtcbiAgICAgICAgICAgICAgICBpbmRleCsrOyAvLyBJbmNyZW1lbnQgb3VyIGluZGV4XG4gICAgICAgICAgICAgICAgcHJvY2Vzcyhsb29wKTsgLy8gUnVuIG91ciBwcm9jZXNzLCBwYXNzIGluIHRoZSBsb29wXG4gICAgICAgICAgICAvLyBPdGhlcndpc2Ugd2UncmUgZG9uZVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkb25lID0gdHJ1ZTsgLy8gTWFrZSBzdXJlIHdlIHNheSB3ZSdyZSBkb25lXG4gICAgICAgICAgICAgICAgaWYoZXhpdCkgZXhpdCgpOyAvLyBDYWxsIHRoZSBjYWxsYmFjayBvbiBleGl0XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGl0ZXJhdGlvbjpmdW5jdGlvbigpe1xuICAgICAgICAgICAgcmV0dXJuIGluZGV4IC0gMTsgLy8gUmV0dXJuIHRoZSBsb29wIG51bWJlciB3ZSdyZSBvblxuICAgICAgICB9LFxuICAgICAgICBicmVhazpmdW5jdGlvbihlbmQpe1xuICAgICAgICAgICAgZG9uZSA9IHRydWU7IC8vIEVuZCB0aGUgbG9vcFxuICAgICAgICAgICAgc2hvdWxkRXhpdCA9IGVuZDsgLy8gUGFzc2luZyBlbmQgYXMgdHJ1ZSBtZWFucyB3ZSBzdGlsbCBjYWxsIHRoZSBleGl0IGNhbGxiYWNrXG4gICAgICAgIH1cbiAgICB9O1xuICAgIGxvb3AubmV4dCgpO1xuICAgIHJldHVybiBsb29wO1xufTtcblxuZnVuY3Rpb24gY29tcGFyZShzdWJqZWN0LCBvcGVyYXRvciwgdmFsdWUpIHtcbiAgXHRzd2l0Y2ggKG9wZXJhdG9yKSB7XG4gIFx0XHRjYXNlICdncmVhdGVyVGhhbic6XG5cdFx0XHRyZXR1cm4gc3ViamVjdCA+IHZhbHVlO1xuXHRcdGNhc2UgJ2xlc3NUaGFuJzpcblx0XHRcdHJldHVybiBzdWJqZWN0IDwgdmFsdWU7XG5cdFx0Y2FzZSAnZ3JlYXRlclRoYW5FcXVhbCc6XG5cdFx0XHRyZXR1cm4gc3ViamVjdCA+PSB2YWx1ZTtcblx0XHRjYXNlICdsZXNzVGhhbkVxdWFsJzpcblx0XHRcdHJldHVybiBzdWJqZWN0IDw9IHZhbHVlO1xuXHRcdGNhc2UgJ2VxdWFsVG8nOlxuXHRcdFx0cmV0dXJuIHN1YmplY3QgPT09IHZhbHVlO1xuXHRcdGNhc2UgJ25vdEVxdWFsVG8nOlxuXHRcdFx0cmV0dXJuIHN1YmplY3QgIT09IHZhbHVlO1xuICBcdH1cbn07XG5cbmZ1bmN0aW9uIGdldE5hbWUoYXJyLCBsYW5nKXtcblx0aWYgKGFyciAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoIDsgaSsrKSB7XG5cdFx0XHRpZiAoYXJyW2ldLmkxOG4uX2xhbmcgPT09IGxhbmcpIHtcblx0XHRcdFx0cmV0dXJuIGFycltpXS5pMThuLnZhbHVlO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuIFx0c3VjY2Vzczogc3VjY2VzcyxcbiBcdHdhcm46IHdhcm4sXG4gXHRlcnJvcjogZXJyb3IsXG4gXHRzeW5jTG9vcDogc3luY0xvb3AsXG4gXHRjb21wYXJlOiBjb21wYXJlLFxuXHRnZXROYW1lOiBnZXROYW1lXG5cbiB9XG4iXX0=
