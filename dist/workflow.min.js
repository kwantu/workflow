(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Workflow = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";function Workflow(e,s,t,o){var r=this;if(""==s||void 0==s)throw util.error("ParamRequired","A community id is required.");if("string"!=typeof s)throw new Error("The community id must be a javascript string.");if(r.communityId=s||"",""==e||void 0==e)throw util.error("ParamRequired","A profile id is required.");if("string"!=typeof e)throw new Error("The profile id must be a javascript string.");if(r.profile=e||"",""==t||void 0==t)throw util.error("ParamRequired","An app id is required.");if("string"!=typeof t)throw new Error("The app id must be a javascript string.");if(r.app=t||"",""==o||void 0==o)throw util.error("ParamRequired","A workflow configuration is required.");r.config="object"!=typeof o?JSON.parse(o):o,r.instance,r.subprocesses=[],r.indicators=[]}var Process=require("./lib/process"),util=require("utility"),userInterface=require("./lib/interface"),helper=require("./lib/helper");Workflow.prototype.getProfile=function(){return this.profile},Workflow.prototype.getApp=function(){return this.app},Workflow.prototype.getConfig=function(){return this.config},Workflow.prototype.getInstance=function(){return this.instance},Workflow.prototype.setInstance=function(e){this.instance=e},Workflow.prototype.getSubProcesses=function(){return this.subprocesses},Workflow.prototype.setSubProcesses=function(e){this.subprocesses=e},Workflow.prototype.getIndicators=function(){return this.indicators},Workflow.prototype.setIndicators=function(e){this.indicators=e},Workflow.prototype.create=function(){var e=this;return new Promise(function(s,t){try{if(void 0!==e.instance){s(util.warn("Instance already exists.",e))}else{var o={_id:"",version:"",type:"workflowInstance",processes:[],channels:["community_"+app.SCOPE.getCommunityId(),"profile_"+app.SCOPE.profileId,"application_"+app.SCOPE.applicationId,"community_"+app.SCOPE.getCommunityId()+"_application_"+app.SCOPE.applicationId]};o._id="_local/"+e.profile+":processes",o.version=e.config.version,e.instance=o;s(util.success("Workflow processes instance created successfully.",e))}}catch(e){t(e)}})},Workflow.prototype.initialise=function(e,s,t){var o=this;return new Promise(function(r,i){try{var n=[];if(""!==e&&void 0!==e){if(n=o.config.processes.filter(function(s){if(s._id==e)return s}),void 0==n[0]._id){var c=util.error("WFConfigError","No valid process definition found with process id: "+e);i(c)}}else n.push(o.config.processes[0]),e=o.config.processes[0]._id;var a=function(e){for(var s="",t=0;t<e.length-1;t++)s=s+"'"+e[t]+"',";return"("+s+"'"+e[e.length-1]+"')"},u=n[0].subProcesses[0]._id,p=n[0].subProcesses[0].instanceType,f=JSON.xpath("indicators/_id",n[0].subProcesses[0],{});if(function(e){var s=JSON.xpath("/indicators[setId = "+a(e)+" and cardinality eq 'single' ]/setId",app.SCOPE.APP_CONFIG,{});if(s.length>0){var t=JSON.xpath("/processes/subProcesses[indicators/_id = "+a(s)+"]/_id",o.config,{}),r=JSON.xpath("count(/instance/processes/subProcesses[id = "+a(t)+" and complete = false()])",o,{})[0];return 0==r}if(void 0!=p.newSequence){var r=JSON.xpath("count(/instance/processes/subProcesses[id eq '"+u+"' and complete eq 'false'])",o,{})[0];return 0==r}return p.newInstance,!0}(f)){var d=[];o.instance.processes.filter(function(s){s.id==e&&d.push(s)});var l=d.length+1,h={id:"",seq:"",subProcesses:[]};h.id=e,h.seq=l,o.instance.processes.push(h);var v=n[0].subProcesses[0]._id,m=1;o.instance.processes.filter(function(s){s.id==e&&s.seq==l&&(m=s.subProcesses.length+1)});var P=generateUUID();void 0!=s.subprocessUUID&&s.subprocessUUID.length>0&&(P=s.subprocessUUID);var S={communityId:app.SCOPE.communityId,uuid:P,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,transactionType:"subProcess",documents:[{document:P,rev:"0"}]};dao.startTransaction(S).then(function(n){Process.subProcess(P,e,l,v,m,t,s,o).then(function(s){var n=s.data._id,c=s.data.groupKey;void 0==t&&(t="");var a={id:v,subprofileId:t,seq:s.data["meta-data"].subProcessInsSeq,uuid:n,groupKey:c,label:s.data.label};h.subProcesses.push(a);for(var u=0;u<o.instance.processes.length;u++){var p=o.instance.processes[u];p.id==e&&p.seq==l&&o.instance.processes.splice(u,1,h)}var f=s.data.indicators,d=s.data.step;Process.indicatorDocs(e,f,d,o,n).then(function(e){var s=util.success("Process: "+o.config.processes[0]._id+" initialized successfully.",a);r(s)},function(e){i(e)})},function(s){o.instance.processes=o.instance.processes.filter(function(s){return!(s.id==e&&s.seq==l)}),console.log(s),i(s)})}).catch(function(e){console.log(e),i(void 0!=e.responseJSON&&void 0!=e.responseJSON.message?e.responseJSON.message:void 0!=e.responseText?e.responseText:e)})}else i("Cannot create workflow as other process using same SDO is not complete")}catch(e){i(e)}})},Workflow.prototype.transition=function(e,s,t,o,r,i,n,c){var a=this;return new Promise(function(o,u){try{var p=JSON.xpath("/subprocesses[_id eq '"+c+"']/step",app.SCOPE.workflow,{})[0],f=JSON.xpath("/processes[_id eq '"+e+"']/subProcesses[_id eq '"+t+"']/steps[_id eq '"+r+"']",a.config,{})[0],d=JSON.xpath("/subprocesses[_id eq '"+c+"']/meta-data/subProcessInsSeq",app.SCOPE.workflow,{})[0],l=function(r,i){a.instance.processes.filter(function(n){n.id==e&&n.seq==s&&n.subProcesses.filter(function(e){e.id==t&&a.subprocesses.filter(function(e){if(e._id==c)if("step"==r){e.step=i.data.step;var s=util.success(i.message,e);o(s)}else if("stepComplete"==r){e.step=i.data.step,e.complete=!0;var t=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+e._id+"']",app.SCOPE.workflow,{})[0];t.complete=!0;var s=util.success(i.message,e.step);o(s)}})})})},h={};void 0!=f.function.task&&void 0!=f.function.task.postActions?(h=f.function.task.postActions,Process.postActions(h,a,c).then(function(o){Process.transition(e,s,t,d,r,i,n,a,c,p).then(function(e){e.data.subProcessComplete?l("stepComplete",e):l("step",e)},function(e){u(e)})},function(e){u(e)})):void 0!=f.function.server&&void 0!=f.function.server.postActions?(h=f.function.server.postActions,Process.postActions(h,a,c).then(function(o){Process.transition(e,s,t,d,r,i,n,a,c,p).then(function(e){e.data.subProcessComplete?l("stepComplete",e):l("step",e)},function(e){u(e)})},function(e){u(e)})):Process.transition(e,s,t,d,r,i,n,a,c,p).then(function(e){e.data.subProcessComplete?l("stepComplete",e):l("step",e)},function(e){u(e)})}catch(e){u(e)}})},Workflow.prototype.assignUser=function(e,s,t,o,r,i){var n=this;return new Promise(function(c,a){try{var u=JSON.xpath("/subprocesses[_id eq '"+i+"']",app.SCOPE.workflow,{})[0],p=u._rev;app.SCOPE.communityId,LOCAL_SETTINGS.SUBSCRIPTIONS.userId;Process.assignUser(e,s,t,o,r,i,n).then(function(e){c(e)},function(e){a(e)})}catch(e){a(e)}})},Workflow.prototype.ui=function(){var e=this;return{getProcess:function(s,t){return new Promise(function(o,r){try{userInterface.getProcess(s,t,e).then(function(e){o(e)},function(e){r(e)})}catch(e){r(e)}})}}},Workflow.prototype.getNodeValue=function(e,s){var t=this;return new Promise(function(o,r){try{helper.getNodeValue(e,t,s).then(function(e){o(e)},function(e){r(e)})}catch(e){r(e)}})},Workflow.prototype.takeAssignment=function(e){var s=this;return new Promise(function(t,o){try{var r=JSON.xpath("/subprocesses[_id eq '"+e+"']",s,{})[0],i=JSON.xpath("/step/assignedTo",r,{})[0];void 0==r.step.assignmentHistory&&(r.step.assignmentHistory=[]),""!=i.userId&&""!=i.name&&r.step.assignmentHistory.push(JSON.parse(JSON.stringify(i))),i.name=LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,i.userId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"",i.dateTime=moment().format(),i.type=ASSIGNMENT_TYPE_ACCEPTANCE,i.dueDateTime="",i.by=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"";var n=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+e+"']/id",s,{})[0],c=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+e+"']/id",s,{})[0],a=JSON.xpath("/subprocesses[_id eq '"+e+"']/step/id",s,{})[0],u=JSON.xpath("/processes[_id eq '"+n+"']/subProcesses[_id eq '"+c+"']/steps[_id eq '"+a+"']",s.config,{})[0];if(void 0!=u.function.task.preWorkActions){var p=u.function.task.preWorkActions;Process.preWorkActions(p,s).then(function(e){t(s)},function(e){o(e)})}else t(s)}catch(e){o(e)}})},Workflow.prototype.condition=function(e,s){var t=this;return new Promise(function(o,r){try{var i=e.operator,n=e.value.data;if(void 0!=e.subject.indicator){var c=e.subject.indicator.setId,a=e.subject.indicator.modelScope,u=e.subject.indicator.elementPath;if("subProcess"==e.subject.indicator.context){for(var p=JSON.xpath("/subprocesses[_id eq '"+s+"']/indicators[id eq '"+c+"']/instances[1]/uuid",t,{})[0],f=JSON.xpath("/indicators[_id eq '"+p+"']",t,{})[0],d=f.model[a].data[c],l=d,h=""==u?[]:u.split(/['"\[\].]+/),v=0;v<h.length;v++)""!=h[v]&&(l=l[h[v]]);var m=l;helper.getNodeValue(n,t,s).then(function(e){var s=helper.compare(m,i,e);o(s)},function(e){r(e)})}else if("subProfile"==e.subject.indicator.context){for(var f=JSON.xpath("/indicators[category/term eq '"+c+"']",t,{})[0],d=f.model[a].data[c],l=d,h=""==u?[]:u.split(/['"\[\].]+/),v=0;v<h.length;v++)""!=h[v]&&(l=l[h[v]]);var m=l;helper.getNodeValue(n,t,s).then(function(e){var s=helper.compare(m,i,e);o(s)},function(e){r(e)})}else r("Not implemented")}else if(void 0!=e.subject.indicatorWrapper)r("Not implemented");else if(void 0!=e.subject.variable)helper.getNodeValue(n,t,s).then(function(n){helper.getNodeValue(e.subject,t,s).then(function(e){var s=helper.compare(e,i,n);o(s)},function(e){r(e)})},function(e){r(e)});else if(void 0!=e.subject.subProcess){for(var u=e.subject.subProcess.elementPath,P=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],l=P,h=""==u?[]:u.split(/['"\[\].]+/),v=0;v<h.length;v++)""!=h[v]&&(l=l[h[v]]);var m=l;helper.getNodeValue(n,t,s).then(function(e){var s=helper.compare(m,i,e);o(s)},function(e){r(e)})}}catch(e){r(e)}})},module.exports=Workflow;

},{"./lib/helper":4,"./lib/interface":5,"./lib/process":7,"utility":8}],2:[function(require,module,exports){
"use strict";var util=require("utility"),nodeValue=require("./nodeValue"),form=require("./form"),helper=require("./helper"),gatekeeper=new GK,community=function(){return{createCommunity:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/indicators[category/term eq 'Community']/_id",t,{})[0],r={createCommunity:{newCommunityId:t.profile,indicatorUUID:{Community:s}}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processed successfully.",o);e(n)},function(e){o(e)})})},userJoinCommunity:function(e,i,t){return new Promise(function(e,i){})},releaseAdoptedApplication:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'adoptedApplication']/instances[1]/uuid",t,{})[0],r={releaseAdoptedApplication:{communityId:t.profile,indicatorUUID:{adoptedApplication:s}}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})}}}(),application=function(){return{createAppDefinition:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/indicators[category/term eq 'Application']/_id",t,{})[0],r={createApplication:{newApplicationId:t.profile,indicatorUUID:{Application:s}}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})},buildApplication:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'PublishApplication']/instances[1]/uuid",t,{})[0],r=JSON.xpath("/indicators[category/term eq 'ApplicationDefinition']/_id",t,{})[0],c=JSON.xpath("/indicators[category/term eq 'Roles']/_id",t,{})[0],p=JSON.xpath("/indicators[category/term eq 'Application']/_id",t,{})[0],d=JSON.xpath("/indicators[category/term eq 'AppPermissions']/_id",t,{})[0],u={buildApplication:{applicationId:t.profile,indicatorUUID:{PublishApplication:s,ApplicationDefinition:r,Roles:c,Application:p,AppPermissions:d}}};a.action=u,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})},applicationAdoption:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'Adoption']/instances[1]/uuid",t,{})[0],r=JSON.xpath("/indicators[category/term eq 'PublishApplication']/_id",t,{})[0],c=JSON.xpath("/indicators[category/term eq 'Application']/_id",t,{})[0],p={adoptApplication:{applicationId:t.profile,indicatorUUID:{Adoption:s,PublishApplication:r,Application:c}}};a.action=p,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})},createTaxonomy:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'Taxonomy']/instances[1]/uuid",t,{})[0],r={createTaxonomy:{taxonomyUUID:s}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})}}}(),performance=function(){return{unlockPeriod:function(e,i,t){return new Promise(function(e,o){var a=JSON.xpath("/subprocesses[_id eq '"+i+"']",t,{})[0],n=JSON.xpath("/indicators[id eq '"+PERIOD_SET_ID+"' or id eq '"+AUDIT_PERIOD_SET_ID+"']/instances/uuid",a,{})[0],s=a.dates.valid;library.unlockPeriod(n,s,i).then(function(i){var t=util.success("Unlock period.",i);e(t)},function(e){o(e)})})},setModelStatus:function(e,i,t){return new Promise(function(o,a){var n=JSON.xpath("/subprocesses[_id eq '"+i+"']",t,{})[0],s=JSON.xpath("/indicators[id eq '"+PERIOD_SET_ID+"' or id eq '"+AUDIT_PERIOD_SET_ID+"']/instances/uuid",n,{})[0],r=n.dates.valid,c=JSON.xpath("/label",e,{})[0],p=helper.getLanguageMessage(c);library.setPeriodStatus(s,r,p,i).then(function(e){var i=util.success("setModelStatus",e);o(i)},function(e){a(e)})})},lockPerformanceModel:function(e,i,t){return new Promise(function(e,o){var a=JSON.xpath("/subprocesses[_id eq '"+i+"']",t,{})[0],n=JSON.xpath("/indicators[id eq '"+PERFORMANCE_SET_ID+"']/instances/uuid",a,{})[0],s=a.dates.valid;library.lockPerformanceModel(n,s,i).then(function(i){var t=util.success("Lock performance model.",i);e(t)},function(e){o(e)})})}}}(),sdo=function(){return{create:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'SDO']/instances[1]/uuid",t,{})[0],r={createSDO:{sdoUUID:s}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})}}}(),taxonomy=function(){return{create:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'Taxonomy']/instances[1]/uuid",t,{})[0],r={createTaxonomy:{taxonomyUUID:s}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})}}}(),subProcessInstance=function(){return{setTitle:function(e,i,t,o){return new Promise(function(e,a){var n=JSON.xpath("/subprocesses[_id eq '"+i+"']",app.SCOPE.workflow,{})[0],s=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+i+"']",app.SCOPE.workflow,{})[0];void 0!=s&&(s.label=t),n.label=t;var r=[],c={};c.model=o.subprocesses,r.push(c),e(util.success("Subprocess setTitle success.",o.subprocesses))})},setValidDate:function(e,i,t,o){return new Promise(function(e,a){var n=JSON.xpath("/subprocesses[_id eq '"+i+"']",app.SCOPE.workflow,{})[0];n.dates.valid=t;var s=[],r={};r.model=n,s.push(r),e(util.success("valid date set.",o.subprocesses))})},setSPStatus:function(e,i,t,o){return new Promise(function(e,a){JSON.xpath("/subprocesses[_id eq '"+i+"']",app.SCOPE.workflow,{})[0].spStatus=t;var n=[],s={};s.model=o.subprocesses,n.push(s),e(util.success("Subprocess spStatus success.",o.subprocesses))})}}}(),variables=function(){return{setVariable:function(e,i,t){return new Promise(function(o,a){helper.getNodeValue(e.data,i,t).then(function(n){var s=e.scope,r=e.name,c=e.variableType,p=JSON.xpath("/subprocesses[_id eq '"+t+"']/dates/valid",i,{})[0];switch(s){case"profile":var d=i.profile,u=d+":variables",l=app.SCOPE.txn;dao.get(u).then(function(e){for(var s={},d=function(){if("periodic"==c){var d=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+t+"']/id]/type",i,{})[0],u=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id])",i,{})[0]+1;if(d==PROCESS_TYPE_SUBPROFILE){var l=library.getSubprofileSubprocessIds();u=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+l+"])",i,{})[0]+1}var f={subProcessUUID:t,user:{userName:LOCAL_SETTINGS.SUBSCRIPTIONS.username,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userProfileId},seq:u,validDate:p,value:n};if(void 0!=e[r]){for(var m=e,I=""==r?[]:r.split(/['"\[\].]+/),S=0;S<I.length;S++)""!=I[S]&&(m=m[I[S]]);m.push(f)}else e[r]=[f]}else e[r]=n;dao.save(e).then(function(e){s.rev=e.rev,o("Variable set successfully")}).catch(function(e){a("Failed to set Variable")})},f=!1,m=0;m<l.documents.length;m++)u==l.documents[m].document&&(s=l.documents[m],f=!0);f?d():(l=JSON.parse(JSON.stringify(app.SCOPE.txn)),l.documents=[],s={document:u,rev:void 0==e._rev?"0":e._rev},l.documents.push(s),app.SCOPE.txn.documents.push(s),dao.updateTransaction(l).then(function(e){d()}).catch(function(e){console.log(e),a(void 0!=e.responseJSON&&void 0!=e.responseJSON.message?e.responseJSON.message:void 0!=e.responseText?e.responseText:e)}))}).catch(function(e){var s={_id:u};if(s.channels=app.profile.channels,"periodic"==c){var d=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+t+"']/id]/type",i,{})[0],l=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id])",i,{})[0]+1;if(d==PROCESS_TYPE_SUBPROFILE){var f=library.getSubprofileSubprocessIds();l=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+f+"])",i,{})[0]+1}s[r]=[{subProcessUUID:t,user:{userName:LOCAL_SETTINGS.SUBSCRIPTIONS.username,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userProfileId},seq:l,validDate:p,value:n}]}else s[r]=n;var m=JSON.parse(JSON.stringify(app.SCOPE.txn));m.documents=[];var I={document:u,rev:void 0==s._rev?"0":s._rev};m.documents.push(I),app.SCOPE.txn.documents.push(I),dao.updateTransaction(m).then(function(e){dao.save(s).then(function(e){I.rev=e.rev,o("Variable set successfully")}).catch(function(e){a("Failed to set Variable")})}).catch(function(e){console.log(e),a(void 0!=e.responseJSON&&void 0!=e.responseJSON.message?e.responseJSON.message:void 0!=e.responseText?e.responseText:e)})});break;case"subProcessInstance":case"step":o("not implemented");break;case"subProfileSubProcessInstance":var f=app.profile.subprofileId,m=f+":variables",l=app.SCOPE.txn;dao.get(m).then(function(e){for(var s={},d=function(){if("periodic"==c){var d=library.getSubprofileSubprocessIds(),u=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+d+"])",i,{})[0]+1,l={subProcessUUID:t,user:{userName:LOCAL_SETTINGS.SUBSCRIPTIONS.username,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userProfileId},seq:u,validDate:p,value:n};if(void 0!=e[r]){for(var f=e,m=""==r?[]:r.split(/['"\[\].]+/),I=0;I<m.length;I++)""!=m[I]&&(f=f[m[I]]);f.push(l)}else e[r]=[l]}else e[r]=n;dao.save(e).then(function(e){s.rev=e.rev,o("Variable at subprofile set successfully")}).catch(function(e){a("Failed to set Variable at subprofile")})},u=!1,f=0;f<l.documents.length;f++)m==l.documents[f].document&&(s=l.documents[f],u=!0);u?d():(l=JSON.parse(JSON.stringify(app.SCOPE.txn)),l.documents=[],s={document:m,rev:void 0==e._rev?"0":e._rev},l.documents.push(s),app.SCOPE.txn.documents.push(s),dao.updateTransaction(l).then(function(e){d()}).catch(function(e){console.log(e),a(void 0!=e.responseJSON&&void 0!=e.responseJSON.message?e.responseJSON.message:void 0!=e.responseText?e.responseText:e)}))}).catch(function(e){var s={_id:m};if(s.channels=app.profile.channels,"periodic"==c){var d=library.getSubprofileSubprocessIds(),u=JSON.xpath("count(/subprocesses[_id eq '"+t+"']/preceding-sibling::node()[id = /subprocesses[_id eq '"+t+"']/id and _id = /subprocesses[_id = "+d+"]/_id])",i,{})[0]+1;s[r]=[{subProcessUUID:t,user:{userName:LOCAL_SETTINGS.SUBSCRIPTIONS.username,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userProfileId},seq:u,validDate:p,value:n}]}else s[r]=n;var l=JSON.parse(JSON.stringify(app.SCOPE.txn));l.documents=[];var f={document:m,rev:void 0==s._rev?"0":s._rev};l.documents.push(f),app.SCOPE.txn.documents.push(f),dao.updateTransaction(l).then(function(e){dao.save(s).then(function(e){f.rev=e.rev,o("Variable at subprofile set successfully")}).catch(function(e){a("Failed to set Variable at subprofile")})}).catch(function(e){console.log(e),a(void 0!=e.responseJSON&&void 0!=e.responseJSON.message?e.responseJSON.message:void 0!=e.responseText?e.responseText:e)})})}},function(e){a("getNodeValue value not found.")})})}}}(),notification=function(){return{sendNotificationWorker:function(e,i,t){return new Promise(function(o,a){var n=new NotificatioWorker(app),s=JSON.xpath("/subprocesses[_id eq '"+t+"']/meta-data/subprofileId",i,{})[0],r=DOMAIN.replace("exist/rest",""),c="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(c=app.profile.subprofileId);var p={notification:{message:{},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:t,subProfileId:s},notificationType:"",subprofileId:c,priority:"",recipients:{},url:r,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:"",validDate:"",dueDate:""},notification:{createdDateTime:moment().format()},step:{stepCreatedDateTime:"",stepName:"",stepId:""},node:{title:""}}}},d=JSON.xpath("/indicators[_id eq '"+app.profile._id+"']/title",i,{})[0];p.notification.keys.profile.name=d,p.notification.keys.profile.id=app.profile._id,p.notification.keys.community.name=app.getNameByLang(LOCAL_SETTINGS.COMMUNITY_CONFIG.communityName),p.notification.keys.community.id=LOCAL_SETTINGS.COMMUNITY_CONFIG.communityId;var u=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",LOCAL_SETTINGS.COMMUNITY_CONFIG,{})[0];p.notification.keys.application.name=app.getNameByLang(u.name),p.notification.keys.application.id=u.appId,p.notification.keys.currentUser.name=LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,p.notification.keys.currentUser.id=LOCAL_SETTINGS.SUBSCRIPTIONS.userId;var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];p.notification.keys.subProcess.name=l.label,p.notification.keys.subProcess.id=t,p.notification.keys.subProcess.validDate=l.dates.valid,p.notification.keys.subProcess.dueDate=l.dates.due;try{var f=l.step;p.notification.keys.step.stepCreatedDateTime=f.dateTimeCreated,p.notification.keys.step.stepId=f.id;var m=JSON.xpath("/processes/subProcesses[_id eq '"+l.id+"']/steps[_id eq '"+f.id+"']",app.SCOPE.workflow.config,{})[0];p.notification.keys.step.stepName=app.getNameByLang(m.name)}catch(e){}var I=JSON.xpath("/indicators[_id eq '"+c+"']/title",app.SCOPE.workflow,{})[0];if(p.notification.keys.node.title=void 0==I?"":I,p.notification.message.default=e.message.default,p.notification.message.title=e.message.title,void 0!=e.message.rtf&&(p.notification.message.rtf={},void 0!=e.message.rtf.template?p.notification.message.rtf.template=e.message.rtf.template:void 0!=e.message.rtf.markup&&(p.notification.message.rtf.markup=e.message.rtf.markup)),p.notification.messageType=e.messageType,p.notification.notificationType=e.notificationType,p.notification.priority=e.priority,void 0!=e.notificationAction&&(p.notification.notificationAction={},p.notification.notificationAction.label=e.notificationAction.label,void 0!=e.notificationAction.action.URI?(p.notification.notificationAction.action={},p.notification.notificationAction.action.URI=e.notificationAction.action.URI):void 0!=e.notificationAction.action.goto&&(p.notification.notificationAction.action={},p.notification.notificationAction.action.goto=e.notificationAction.action.goto)),void 0!=e.schedule){var S=e.schedule.executeCommand,y={dateTime:"",unit:"",factor:""};if(void 0!=S.now)y.dateTime=moment().format();else if(void 0!=S.exact)y.dateTime=S.exact.dateTime;else if(void 0!=S.dueDate){var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",g=l.dates.due;h=""!=g?moment(g,"YYYY-MM-DD"):moment().format(),y.dateTime=h,y.factor=S.dueDate.factor,y.unit=S.dueDate.unit}else if(void 0!=S.validDate){var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",g=l.dates.valid;h=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),y.dateTime=h,y.factor=S.validDate.factor,y.unit=S.validDate.unit}else if(void 0!=S.stepCreatedDate){var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",v=l.step.dueDateTime;h=""!=v?moment(v).format():moment().format(),y.dateTime=h,y.factor=S.stepCreatedDate.factor,y.unit=S.stepCreatedDate.unit}else y.dateTime=moment().format();n.setSchedule(y)}(function(e){return new Promise(function(o,a){var n={};if(void 0!=e.recipients.role)n.role=e.recipients.role,o(n);else if(void 0!=e.recipients.profileRole)n.profileRole={},n.profileRole.role=e.recipients.profileRole.role,n.profileRole.profile=e.recipients.profileRole.profile,o(n);else if(void 0!=e.recipients.subProfileRole)n.subProfileRole={},n.subProfileRole.role=e.recipients.subProfileRole.role,n.subProfileRole.subProfileCategory=e.recipients.subProfileRole.subProfileCategory,n.subProfileRole.profile=e.recipients.subProfileRole.profile,o(n);else if(void 0!=e.recipients.function)n.function={},n.function.users={},helper.getNodeValue(e.recipients.function.users,i,t).then(function(e){n.function.users=e,o(n)},function(e){rej(e)});else if(void 0!=e.recipients.stepAssignee)n.stepAssignee={},n.stepAssignee.role=e.recipients.stepAssignee.role,o(n);else if(void 0!=e.recipients.stepAssigneeFromStep){n.stepAssigneeFromStep={};var s=e.recipients.stepAssigneeFromStep.stepId;n.stepAssigneeFromStep.stepId=s;for(var r=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],c={},p=0;p<r.history.length;p++)r.history[p].id==s&&(c=r.history[p]);if(void 0!=c.assignmentHistory&&c.assignmentHistory.length>0){var d=c.assignmentHistory[c.assignmentHistory.length-1];n.stepAssigneeFromStep.userId=d.userId}o(n)}else if(void 0!=e.recipients.indicator){n.indicator={};var u=e.recipients.indicator.indicatorSetId,l=e.recipients.indicator.elementId,f=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+u+"']/instances/uuid",i,{})[0],m=JSON.xpath("/indicators[_id eq '"+f+"']",i,{})[0],I="/model/pending/data/"+u+"/"+l,S=JSON.xpath(I,m,{})[0];n.indicator.userId=S,o(n)}})})(e).then(function(e){p.notification.recipients=e,n.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),n.setAction(p);var a=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];n.setContext({step:{stepDateTime:a.step.dateTimeCreated}}),n.send().then(function(e){console.log(n);var i=util.success("Notification Worker processes successfully.",e);o(i)},function(e){o(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),a(e)})})},reAssignmentNotification:function(e,i,t,o){return new Promise(function(a,n){var s=new NotificatioWorker(app),r=JSON.xpath("/subprocesses[_id eq '"+t+"']/meta-data/subprofileId",i,{})[0],c=DOMAIN.replace("exist/rest",""),p={notification:{message:{rtf:{}},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:t,subProfileId:r},notificationType:"workflow",priority:"",recipients:{},url:c,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:"",validDate:"",dueDate:""},notification:{createdDateTime:moment().format()},step:{stepCreatedDateTime:"",stepName:"",stepId:""},node:{title:""}}}},d=JSON.xpath("/indicators[_id eq '"+app.profile._id+"']/title",i,{})[0];p.notification.keys.profile.name=d,p.notification.keys.profile.id=app.profile._id,p.notification.keys.community.name=app.getNameByLang(LOCAL_SETTINGS.COMMUNITY_CONFIG.communityName),p.notification.keys.community.id=LOCAL_SETTINGS.COMMUNITY_CONFIG.communityId;var u=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",LOCAL_SETTINGS.COMMUNITY_CONFIG,{})[0];p.notification.keys.application.name=app.getNameByLang(u.name),p.notification.keys.application.id=u.appId,p.notification.keys.currentUser.name=LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,p.notification.keys.currentUser.id=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,p.notification.keys.subProcess.name=JSON.xpath("/subprocesses[_id eq '"+t+"']/label",i,{})[0],p.notification.keys.subProcess.id=t,p.notification.keys.subProcess.validDate=y.dates.valid,p.notification.keys.subProcess.dueDate=y.dates.due;var l=y.step;p.notification.keys.step.stepCreatedDateTime=l.dateTimeCreated,p.notification.keys.step.stepId=l.id;var f=JSON.xpath("/processes/subProcesses[_id eq '"+y.id+"']/steps[_id eq '"+l.id+"']",app.SCOPE.workflow.config,{})[0];p.notification.keys.step.stepName=app.getNameByLang(f.name);var m=JSON.xpath("/indicators[_id eq '"+subprofileId+"']/title",app.SCOPE.workflow,{})[0];if(p.notification.keys.node.title=void 0==m?"":m,p.notification.message.default="",p.notification.message.title=e.reAssignment.title,p.notification.message.rtf.markup=e.reAssignment.message,p.notification.messageType=e.reAssignment.messageType,p.notification.priority=e.reAssignment.priority,void 0!=e.reAssignment.notificationAction&&(p.notification.notificationAction={},p.notification.notificationAction.label=e.reAssignment.notificationAction.label,void 0!=e.reAssignment.notificationAction.action.URI?(p.notification.notificationAction.action={},p.notification.notificationAction.action.URI=e.reAssignment.notificationAction.action.URI):void 0!=e.reAssignment.notificationAction.action.goto&&(p.notification.notificationAction.action={},p.notification.notificationAction.action.goto=e.reAssignment.notificationAction.action.goto)),void 0!=e.reAssignment.schedule){var I=e.reAssignment.schedule.executeCommand,S={dateTime:"",unit:"",factor:""};if(void 0!=I.now)S.dateTime=moment().format();else if(void 0!=I.exact)S.dateTime=I.exact.dateTime;else if(void 0!=I.dueDate){var y=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",g=y.dates.due;h=""!=g?moment(g,"YYYY-MM-DD"):moment().format(),S.dateTime=h,S.factor=I.dueDate.factor,S.unit=I.dueDate.unit}else if(void 0!=I.validDate){var y=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",g=y.dates.valid;h=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),S.dateTime=h,S.factor=I.validDate.factor,S.unit=I.validDate.unit}else if(void 0!=I.stepCreatedDate){var y=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",v=y.step.dueDateTime;h=""!=v?moment(v).format():moment().format(),S.dateTime=h,S.factor=I.stepCreatedDate.factor,S.unit=I.stepCreatedDate.unit}else S.dateTime=moment().format();s.setSchedule(S)}(function(e){return new Promise(function(i,t){var o={};o.function={},o.function.users={},o.function.users=e.id,i(o)})})(o).then(function(e){p.notification.recipients=e,s.setAction(p),s.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),s.send().then(function(e){var i=util.success("Notification Worker processes successfully for reassignment.",e);a(i)},function(e){a(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),n(e)})})},assignmentNotification:function(e,i,t,o){return new Promise(function(a,n){var s=new NotificatioWorker(app),r=JSON.xpath("/subprocesses[_id eq '"+t+"']/meta-data/subprofileId",i,{})[0],c=DOMAIN.replace("exist/rest",""),p={notification:{message:{rtf:{}},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:t,subProfileId:r},notificationType:"workflow",priority:"",recipients:{},url:c,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:"",validDate:"",dueDate:""},notification:{createdDateTime:moment().format()},step:{stepCreatedDateTime:"",stepName:"",stepId:""},node:{title:""}}}},d=JSON.xpath("/indicators[_id eq '"+app.profile._id+"']/title",i,{})[0];p.notification.keys.profile.name=d,p.notification.keys.profile.id=app.profile._id,p.notification.keys.community.name=app.getNameByLang(LOCAL_SETTINGS.COMMUNITY_CONFIG.communityName),p.notification.keys.community.id=LOCAL_SETTINGS.COMMUNITY_CONFIG.communityId;var u=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",LOCAL_SETTINGS.COMMUNITY_CONFIG,{})[0];p.notification.keys.application.name=app.getNameByLang(u.name),p.notification.keys.application.id=u.appId,p.notification.keys.currentUser.name=LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,p.notification.keys.currentUser.id=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,p.notification.keys.subProcess.name=JSON.xpath("/subprocesses[_id eq '"+t+"']/label",i,{})[0],p.notification.keys.subProcess.id=t,p.notification.keys.subProcess.validDate=y.dates.valid,p.notification.keys.subProcess.dueDate=y.dates.due;var l=y.step;p.notification.keys.step.stepCreatedDateTime=l.dateTimeCreated,p.notification.keys.step.stepId=l.id;var f=JSON.xpath("/processes/subProcesses[_id eq '"+y.id+"']/steps[_id eq '"+l.id+"']",app.SCOPE.workflow.config,{})[0];p.notification.keys.step.stepName=app.getNameByLang(f.name);var m=JSON.xpath("/indicators[_id eq '"+subprofileId+"']/title",app.SCOPE.workflow,{})[0];if(p.notification.keys.node.title=void 0==m?"":m,p.notification.message.default="",p.notification.message.title=e.assignment.title,p.notification.message.rtf.markup=e.assignment.message,p.notification.messageType=e.assignment.messageType,p.notification.priority=e.assignment.priority,void 0!=e.assignment.notificationAction&&(p.notification.notificationAction={},p.notification.notificationAction.label=e.assignment.notificationAction.label,void 0!=e.assignment.notificationAction.action.URI?(p.notification.notificationAction.action={},p.notification.notificationAction.action.URI=e.assignment.notificationAction.action.URI):void 0!=e.assignment.notificationAction.action.goto&&(p.notification.notificationAction.action={},p.notification.notificationAction.action.goto=e.assignment.notificationAction.action.goto)),void 0!=e.assignment.schedule){var I=e.assignment.schedule.executeCommand,S={dateTime:"",unit:"",factor:""};if(void 0!=I.now)S.dateTime=moment().format();else if(void 0!=I.exact)S.dateTime=I.exact.dateTime;else if(void 0!=I.dueDate){var y=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",g=y.dates.due;h=""!=g?moment(g,"YYYY-MM-DD"):moment().format(),S.dateTime=h,S.factor=I.dueDate.factor,S.unit=I.dueDate.unit}else if(void 0!=I.validDate){var y=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",g=y.dates.valid;h=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),S.dateTime=h,S.factor=I.validDate.factor,S.unit=I.validDate.unit}else if(void 0!=I.stepCreatedDate){var y=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",v=y.step.dueDateTime;h=""!=v?moment(v).format():moment().format(),S.dateTime=h,S.factor=I.stepCreatedDate.factor,S.unit=I.stepCreatedDate.unit}else S.dateTime=moment().format();s.setSchedule(S)}(function(e){return new Promise(function(i,t){var o={};o.function={},o.function.users={},o.function.users=e.id,i(o)})})(o).then(function(e){p.notification.recipients=e,s.setAction(p),s.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),s.send().then(function(e){console.log(s);var i=util.success("Notification Worker processes successfully for assignment.",e);a(i)},function(e){a(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),n(e)})})},acceptanceNotification:function(e,i,t,o){return new Promise(function(a,n){var s=new NotificatioWorker(app),r=JSON.xpath("/subprocesses[_id eq '"+t+"']/meta-data/subprofileId",i,{})[0],c=DOMAIN.replace("exist/rest",""),p={notification:{message:{rtf:{}},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:t,subProfileId:r},notificationType:"workflow",priority:"",recipients:{},url:c,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:"",validDate:"",dueDate:""},notification:{createdDateTime:moment().format()},step:{stepCreatedDateTime:"",stepName:"",stepId:""},node:{title:""}}}},d=JSON.xpath("/indicators[_id eq '"+app.profile._id+"']/title",i,{})[0];p.notification.keys.profile.name=d,p.notification.keys.profile.id=app.profile._id,p.notification.keys.community.name=app.getNameByLang(LOCAL_SETTINGS.COMMUNITY_CONFIG.communityName),p.notification.keys.community.id=LOCAL_SETTINGS.COMMUNITY_CONFIG.communityId;var u=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",LOCAL_SETTINGS.COMMUNITY_CONFIG,{})[0];p.notification.keys.application.name=app.getNameByLang(u.name),p.notification.keys.application.id=u.appId,p.notification.keys.currentUser.name=LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,p.notification.keys.currentUser.id=LOCAL_SETTINGS.SUBSCRIPTIONS.userId;var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];p.notification.keys.subProcess.name=l.label,p.notification.keys.subProcess.id=t,p.notification.keys.subProcess.validDate=l.dates.valid,p.notification.keys.subProcess.dueDate=l.dates.due;var f=l.step;p.notification.keys.step.stepCreatedDateTime=f.dateTimeCreated,p.notification.keys.step.stepId=f.id;var m=JSON.xpath("/processes/subProcesses[_id eq '"+l.id+"']/steps[_id eq '"+f.id+"']",app.SCOPE.workflow.config,{})[0];p.notification.keys.step.stepName=app.getNameByLang(m.name);var I=JSON.xpath("/indicators[_id eq '"+r+"']/title",app.SCOPE.workflow,{})[0]
;if(p.notification.keys.node.title=void 0==I?"":I,p.notification.message.default="",p.notification.message.title=e.assignmentAcceptance.title,p.notification.message.rtf.markup=e.assignmentAcceptance.message,p.notification.messageType=e.assignmentAcceptance.messageType,p.notification.priority=e.assignmentAcceptance.priority,void 0!=e.assignmentAcceptance.notificationAction&&(p.notification.notificationAction={},p.notification.notificationAction.label=e.assignmentAcceptance.notificationAction.label,void 0!=e.assignmentAcceptance.notificationAction.action.URI?(p.notification.notificationAction.action={},p.notification.notificationAction.action.URI=e.assignmentAcceptance.notificationAction.action.URI):void 0!=e.assignmentAcceptance.notificationAction.action.goto&&(p.notification.notificationAction.action={},p.notification.notificationAction.action.goto=e.assignmentAcceptance.notificationAction.action.goto)),void 0!=e.assignmentAcceptance.schedule){var S=e.assignmentAcceptance.schedule.executeCommand,y={dateTime:"",unit:"",factor:""};if(void 0!=S.now)y.dateTime=moment().format();else if(void 0!=S.exact)y.dateTime=S.exact.dateTime;else if(void 0!=S.dueDate){var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",g=l.dates.due;h=""!=g?moment(g,"YYYY-MM-DD"):moment().format(),y.dateTime=h,y.factor=S.dueDate.factor,y.unit=S.dueDate.unit}else if(void 0!=S.validDate){var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",g=l.dates.valid;h=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),y.dateTime=h,y.factor=S.validDate.factor,y.unit=S.validDate.unit}else if(void 0!=S.stepCreatedDate){var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",v=l.step.dueDateTime;h=""!=v?moment(v).format():moment().format(),y.dateTime=h,y.factor=S.stepCreatedDate.factor,y.unit=S.stepCreatedDate.unit}else y.dateTime=moment().format();s.setSchedule(y)}(function(e){return new Promise(function(i,t){var o={};o.role=e,i(o)})})(o).then(function(e){p.notification.recipients=e,s.setAction(p),s.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),s.setContext({process:{}}),s.send(s).then(function(e){console.log(s);var i=util.success("Notification Worker processes successfully for assignment.",e);a(i)},function(e){a(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),n(e)})})},acceptanceNotificationExternal:function(e,i,t,o){return new Promise(function(a,n){var s=new NotificatioWorker(app),r=JSON.xpath("/subprocesses[_id eq '"+t+"']/meta-data/subprofileId",i,{})[0],c=DOMAIN.replace("exist/rest",""),p={notification:{message:{rtf:{}},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:t,subProfileId:r},notificationType:"workflow",priority:"",recipients:{},url:c,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:"",validDate:"",dueDate:""},notification:{createdDateTime:moment().format()},step:{stepCreatedDateTime:"",stepName:"",stepId:""},node:{title:""}}}},d=JSON.xpath("/indicators[_id eq '"+app.profile._id+"']/title",i,{})[0];p.notification.keys.profile.name=d,p.notification.keys.profile.id=app.profile._id,p.notification.keys.community.name=app.getNameByLang(LOCAL_SETTINGS.COMMUNITY_CONFIG.communityName),p.notification.keys.community.id=LOCAL_SETTINGS.COMMUNITY_CONFIG.communityId;var u=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",LOCAL_SETTINGS.COMMUNITY_CONFIG,{})[0];p.notification.keys.application.name=app.getNameByLang(u.name),p.notification.keys.application.id=u.appId,p.notification.keys.currentUser.name=LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,p.notification.keys.currentUser.id=LOCAL_SETTINGS.SUBSCRIPTIONS.userId;var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];p.notification.keys.subProcess.name=l.label,p.notification.keys.subProcess.id=t,p.notification.keys.subProcess.validDate=l.dates.valid,p.notification.keys.subProcess.dueDate=l.dates.due;var f=l.step;p.notification.keys.step.stepCreatedDateTime=f.dateTimeCreated,p.notification.keys.step.stepId=f.id;var m=JSON.xpath("/processes/subProcesses[_id eq '"+l.id+"']/steps[_id eq '"+f.id+"']",app.SCOPE.workflow.config,{})[0];p.notification.keys.step.stepName=app.getNameByLang(m.name);var I=JSON.xpath("/indicators[_id eq '"+r+"']/title",app.SCOPE.workflow,{})[0];if(p.notification.keys.node.title=void 0==I?"":I,p.notification.message.default="",p.notification.message.title=e.assignmentAcceptance.title,p.notification.message.rtf.markup=e.assignmentAcceptance.message,p.notification.messageType=e.assignmentAcceptance.messageType,p.notification.priority=e.assignmentAcceptance.priority,void 0!=e.assignmentAcceptance.notificationAction&&(p.notification.notificationAction={},p.notification.notificationAction.label=e.assignmentAcceptance.notificationAction.label,void 0!=e.assignmentAcceptance.notificationAction.action.URI?(p.notification.notificationAction.action={},p.notification.notificationAction.action.URI=e.assignmentAcceptance.notificationAction.action.URI):void 0!=e.assignmentAcceptance.notificationAction.action.goto&&(p.notification.notificationAction.action={},p.notification.notificationAction.action.goto=e.assignmentAcceptance.notificationAction.action.goto)),void 0!=e.assignmentAcceptance.schedule){var S=e.assignmentAcceptance.schedule.executeCommand,y={dateTime:"",unit:"",factor:""};if(void 0!=S.now)y.dateTime=moment().format();else if(void 0!=S.exact)y.dateTime=S.exact.dateTime;else if(void 0!=S.dueDate){var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",g=l.dates.due;h=""!=g?moment(g,"YYYY-MM-DD"):moment().format(),y.dateTime=h,y.factor=S.dueDate.factor,y.unit=S.dueDate.unit}else if(void 0!=S.validDate){var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",g=l.dates.valid;h=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),y.dateTime=h,y.factor=S.validDate.factor,y.unit=S.validDate.unit}else if(void 0!=S.stepCreatedDate){var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",v=l.step.dueDateTime;h=""!=v?moment(v).format():moment().format(),y.dateTime=h,y.factor=S.stepCreatedDate.factor,y.unit=S.stepCreatedDate.unit}else y.dateTime=moment().format();s.setSchedule(y)}(function(e){return new Promise(function(i,t){var o={};o.function={},o.function.users=e,i(o)})})(o).then(function(e){p.notification.recipients=e,s.setAction(p),s.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),s.setContext({process:{}}),s.send(s).then(function(e){console.log(s);var i=util.success("Notification Worker processes successfully for assignment.",e);a(i)},function(e){a(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),n(e)})})}}}(),report=function(){return{createPerformanceReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("createPerformanceReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.workplanSetId,c=e.configSetId,p=JSON.xpath("/indicators[category/term eq '"+r+"']/_id",app.SCOPE.workflow,{})[0],d=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+c+"']/instances[1]/uuid",i,{})[0],u={createPerformanceReport:{workplanUUID:p,configUUID:d,profilId:i.profile}};n.action=u,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("WorkplanReport Worker processed successfully.",e);o(a)},function(e){a(e)})})},createReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("executeReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.PerformanceReportDefinitionSetId,c=e.reportingSDOSetId,p=JSON.xpath("/indicators[category/term eq '"+r+"']/_id",i,{})[0],d=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+c+"']/instances[1]/uuid",i,{})[0],u={createReport:{performanceReportDefinition:p,reportingSDO:d,profilId:i.profile}};n.action=u,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("Reprot Worker processed successfully.",e);o(a)},function(e){a(e)})})},sdoReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sdoReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.indicatorSetId,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={sdoReport:{sdoReportUUID:c,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("report Worker processed successfully.",e);o(a)},function(e){a(e)})})},executeReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("executeReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.SDOreportSetId,c=e.reportingSDOSetid,p=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],d=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+c+"']/instances[1]/uuid",i,{})[0];void 0==p&&(p=JSON.xpath("/indicators[category/term eq '"+r+"']/_id",i,{})[0]);var u={executeReport:{sdoReportUUID:p,reportingSDOUUID:d,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=u,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("report Worker processed successfully.",e);o(a)},function(e){a(e)})})},generateView:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sdoReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.ViewConfigSetId,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={generateView:{viewConfigUUID:c,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("report Worker processed successfully.",e);o(a)},function(e){a(e)})})},requestReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("executeReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.sdoRequestReportSetId,c=e.sdoReportCreationSetId,p=e.performanceReportSetId,d=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],u=JSON.xpath("/indicators[category/term eq '"+c+"']/_id",i,{})[0],l=JSON.xpath("/indicators[category/term eq '"+p+"']/_id",i,{})[0],f={requestReport:{performanceReportUUID:l,sdoRequestReportUUID:d,sdoReportCreationUUID:u,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=f,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("Request report Worker processed successfully.",e);o(a)},function(e){a(e)})})},generateBasicView:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sdoReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.sdoDataObjectViewSetId,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={generateBasicView:{sdoDataObjectViewUUID:c,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("generateBasicView Worker processed successfully.",e);o(a)},function(e){a(e)})})},generateUnionView:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sdoReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.sdoDataObjectViewUnionSetId,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={generateUnionView:{sdoDataObjectViewUnionUUID:c,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("generateUnionView Worker processed successfully.",e);o(a)},function(e){a(e)})})},sdoReportMultiple:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sdoReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.sdoReportCreationSetId,c=e.sdoReportViewsSetId,p=e.sdoReportJoinsSetId,d=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],u=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+c+"']/instances[1]/uuid",i,{})[0],l=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+p+"']/instances[1]/uuid",i,{})[0],f={sdoReportMultiple:{sdoReportCreationUUID:d,sdoReportViewsUUID:u,sdoReportJoinsUUID:l,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=f,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("sdoReportMultiple Worker processed successfully.",e);o(a)},function(e){a(e)})})},subprofileQuarterlyReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("executeReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.scheduleReportIndicator,c=JSON.xpath("/indicators[category/term eq '"+r+"']/_id",i,{})[0],p=e.sdoReportApprovalIndicator,d=JSON.xpath("/indicators[category/term eq '"+p+"' and workflows[1]/processes[1]/subProcessUUID eq '"+t+"']/_id",i,{})[0],u={subprofileQuarterlyReport:{scheduleReportIndicatorUUID:c,sdoReportApprovalIndicatorUUID:d,subprofileCode:app.profile.subProfile.code,subprofileTitle:app.profile.subProfile.title,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=u,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("QuarterlyReport report Worker processed successfully.",e);o(a)},function(e){a(e)})})}}}(),participants=function(){return{linkParticipants:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("follow"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.EPWPLinkParticipantsInBulkId,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p=e.EPWPLocalityId,d=JSON.xpath("/indicators[category/term eq '"+p+"']/_id",i,{})[0],u=e.EPWPActiveParticipantsId,l=JSON.xpath("/indicators[category/term eq '"+u+"']/_id",i,{})[0],f={linkParticipants:{EPWPLinkParticipantsInBulkIdUUID:c,EPWPLocalityIdUUID:d,EPWPActiveParticipantsIdUUID:l,profilId:i.profile}};n.action=f,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("EPWPLinkParticipants Worker processed successfully.",e);o(a)},function(e){a(e)})})},monthlyAttendance:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("follow"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.EPWPMonthlyAttendanceBulkUploadUUID,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p=e.EPWPActiveParticipantsIdUUID,d=JSON.xpath("/indicators[category/term eq '"+p+"']/_id",i,{})[0],u=e.EPWPMonthlyEmploymentPerLocalityUUID,l=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+u+"']/instances[1]/uuid",i,{})[0],f={monthlyAttendance:{EPWPMonthlyAttendanceBulkUploadUUID:c,EPWPActiveParticipantsIdUUID:d,EPWPMonthlyEmploymentPerLocalityUUID:l,profilId:i.profile}};n.action=f,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("monthlyAttendance Worker processed successfully.",e);o(a)},function(e){a(e)})})},monthlyProgressSummary:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("follow"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.EPWPMonthlyProgressSummaryIdUUID,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={monthlyProgressSummary:{EPWPMonthlyProgressSummaryIdUUID:c,profilId:i.profile}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("monthlyAttendance Worker processed successfully.",e);o(a)},function(e){a(e)})})},participantContracts:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("follow"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.EPWPParticipantContractsIdUUID,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={participantContracts:{EPWPParticipantContractsIdUUID:c,profilId:i.profile}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("participantContracts Worker processed successfully.",e);o(a)},function(e){a(e)})})},genericLinkParticipants:function(e,i,t){return new Promise(function(e,i){})}}}(),worker=function(){return{getWorkerWrapper:function(){return{source:"remote",type:"workerObject",_id:"",channels:["workerObject"],profileId:"",communityId:"",applicationId:"",subProcessUUID:"",message:"",messageType:"info",createdDateTime:"",senderUserId:"",subProfileId:"",parentTransactionId:void 0==app.SCOPE.txn?"":app.SCOPE.txn.transactionId,action:{}}},send:function(e){return new Promise(function(i,t){console.log("Submitting Worker Object to server"),console.log(e),dao.save(e).then(function(e){i(e)}).catch(function(e){console.log("Error submitting worker response !!"+e),t(e)})})},sendWorker:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sendWorker"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=function(e,o,a){return new Promise(function(n,s){helper.getNodeValue(e,i,t).then(function(e){n({seq:o,paramName:a,dataValue:e})},function(e){s(e)})})},c=function(e){return new Promise(function(o,a){for(var n=[],s=e.length,c=0;c<e.length;c++){var p=e[c].parameterValue,d=e[c].seq,u=e[c].parameterName;r(p,d,u).then(function(e){n.push({seq:e.seq,paramName:e.paramName,paramValue:e.dataValue}),0==--s&&(n.push({seq:s+1,paramName:"communityId",paramValue:i.communityId}),n.push({seq:s+2,paramName:"applicationId",paramValue:i.app}),n.push({seq:s+3,paramName:"profileId",paramValue:i.profile}),n.push({seq:s+4,paramName:"subProcessUUID",paramValue:t}),o(n))},function(e){0==--s&&(n.push({seq:s+1,paramName:"communityId",paramValue:i.communityId}),n.push({seq:s+2,paramName:"applicationId",paramValue:i.app}),n.push({seq:s+3,paramName:"profileId",paramValue:i.profile}),n.push({seq:s+4,paramName:"subProcessUUID",paramValue:t}),o(n))})}})};if(void 0!=e.rest){var p=e.rest.parameters;c(p).then(function(s){var r={sendWorker:{rest:{}}};r.sendWorker.rest.uri=e.rest.uri,r.sendWorker.rest.profilId=i.profile,r.sendWorker.rest.parameters=s,n.action=r,worker.send(n).then(function(e){var s=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];s.spStatus="submitted",void 0==s.messages&&(s.messages=[]);var r={message:{i18n:{_id:"",en:"The server is processing your request. Please wait a few seconds and then click the refresh button.",pt:"The server is processing your request. Please wait a few seconds and then click the refresh button."}},type:"info"};s.messages.push(r),void 0==s.workers&&(s.workers=[]),s.workers.push({workerId:n._id,dateTime:moment().format()}),persistData("subprocesses",app.SCOPE.workflow,t).then(function(i){var t=util.success("Worker Rest processed successfully.",e);o(t)}).catch(function(e){console.log("Worker submitted subprocess file update failed"),a(e)})},function(e){console.log("Worker failed "),a(e)})},function(e){console.log("parameter creation failed. Abording worker object")})}else if(void 0!=e.functional){var p=e.functional.parameters;c(p).then(function(s){var r={sendWorker:{functional:{}}};r.sendWorker.functional.methodName=e.functional.methodName,r.sendWorker.functional.profilId=i.profile,r.sendWorker.functional.parameters=s,n.action=r,worker.send(n).then(function(e){var s=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];s.spStatus="submitted",void 0==s.messages&&(s.messages=[]);var r={message:{i18n:{_id:"",en:"The server is processing your request. Please wait a few seconds and then click the refresh button.",pt:"The server is processing your request. Please wait a few seconds and then click the refresh button."}},type:"info"};s.messages.push(r),void 0==s.workers&&(s.workers=[]),s.workers.push({workerId:n._id,dateTime:moment().format()}),persistData("subprocesses",app.SCOPE.workflow,t).then(function(i){var t=util.success("Worker functional processed successfully.",e);o(t)}).catch(function(e){console.log("Worker submitted subprocess file update failed"),a(e)})},function(e){console.log("Worker failed "),a(e)})},function(e){console.log("parameter creation failed. Abording worker object")})}})},executeLocal:function(workerConfig,_WFInstance,uuid){return new Promise(function(resolve,reject){var processGetNodeValue=function(e,i,t){return new Promise(function(o,a){helper.getNodeValue(e,_WFInstance,uuid).then(function(e){o({seq:i,dataType:t,dataValue:e})},function(e){a(e)})})},processParams=function(e){return new Promise(function(i,t){for(var o=[],a=e.length,n=0;n<e.length;n++){var s=e[n].parameterValue,r=e[n].seq,c=e[n].dataType.dataType;processGetNodeValue(s,r,c).then(function(e){o.push({seq:e.seq,dataType:e.dataType,paramValue:e.dataValue}),0==--a&&i(o)},function(e){0==--a&&i(o)})}})},fixParamType=function(e,i){switch(i){case"string":return"'"+e.replace(/'/g,"\\'")+"'";case"date":case"dateTime":return"'"+e+"'";case"number":case"decimal":return e}},methodName=workerConfig.methodName,configParam=workerConfig.parameters;processParams(configParam).then(function(paramsArray){for(var pList="",i=0;i<paramsArray.length-1;i++)pList=pList+fixParamType(paramsArray[i].paramValue,paramsArray[i].dataType)+",";pList+=fixParamType(paramsArray[i].paramValue,paramsArray[i].dataType);var callbackSuccess=function(){return console.log("S"),resolve("Function '"+methodName+"' executed. Response success.")},callbackFailure=function(){return console.log("E"),reject("Function '"+methodName+"' executed. Response failed.")},spUUID="'"+uuid+"'";console.log("Going to execute == "+methodName),0==paramsArray.length?eval(methodName)(callbackSuccess,callbackFailure,spUUID):1==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,callbackSuccess,callbackFailure,spUUID):2==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,callbackSuccess,callbackFailure,spUUID):3==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,callbackSuccess,callbackFailure,spUUID):4==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,paramsArray[3].paramValue,callbackSuccess,callbackFailure,spUUID):5==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,paramsArray[3].paramValue,paramsArray[4].paramValue,callbackSuccess,callbackFailure,spUUID):6==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,paramsArray[3].paramValue,paramsArray[4].paramValue,paramsArray[5].paramValue,callbackSuccess,callbackFailure,spUUID):7==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,paramsArray[3].paramValue,paramsArray[4].paramValue,paramsArray[5].paramValue,paramsArray[6].paramValue,callbackSuccess,callbackFailure,spUUID):8==paramsArray.length&&eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,paramsArray[3].paramValue,paramsArray[4].paramValue,paramsArray[5].paramValue,paramsArray[6].paramValue,paramsArray[7].paramValue,callbackSuccess,callbackFailure,spUUID)},function(e){console.log("parameter creation failed. Abording worker object"),reject(e)})})},setWorkerInfoInSubprocess:function(e,i,t){var o=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],a={message:{i18n:{_id:"",en:"The server is processing your request. Please wait a few seconds and then click the refresh button.",pt:"O servidor está processando sua solicitação. Por favor aguarde alguns segundos e depois clique no botão atualizar."}},type:"info"};o.messages=[],o.messages.push(a),void 0==o.workers&&(o.workers=[]),o.workers.push({workerId:e._id,dateTime:moment().format()})},create:function(e,i,t){return new Promise(function(o,a){var n=e.channel,s=e.action,r=worker.getWorkerWrapper(),c="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(c=app.profile.subprofileId),r._id=generateUUID(),r.communityId=app.SCOPE.getCommunityId(),r.applicationId=app.SCOPE.applicationId,r.createdDateTime=moment().format(),r.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,r.profileId=i.profile,r.subProcessUUID=t,r.subprofileId=c,r.channels.push(n),r.channels.push("community_"+app.SCOPE.getCommunityId());var p={};p[s]={};for(var d=0;d<e.indicators.length;d++){var u=e.indicators[d].label,l=e.indicators[d].setId,f=e.indicators[d].context,m="";if("subProcess"==f||"currentSubProcessInstance"==f||"currentSubProcess"==f){if(void 0==(m=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+l+"']/instances[1]/uuid",i,{})[0])){var I=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];void 0!=I&&I.indicators.length>0&&(m=JSON.xpath("/indicators[category/term eq '"+l+"']/_id",i,{})[0])}}else m=JSON.xpath("/indicators[category/term eq '"+l+"']/_id",i,{})[0];p[s][u]=m}if(p[s].profilId=i.profile,void 0!=e.fixed)for(var d=0;d<e.fixed.length;d++){var S=e.fixed[d],y=Object.keys(S)[0];p[s][y]=S[y]}void 0!=e.dataFields&&(p[s].dataFields=e.dataFields),r.action=p,worker.send(r).then(function(e){worker.setWorkerInfoInSubprocess(r,i,t);var a=util.success(s+" worker processed successfully.",e);o(a)},function(e){a(e)})})}}}(),user=function(){return{addToRole:function(e,i,t){return new Promise(function(o,a){helper.getNodeValue(e.userName,t,i).then(function(n){helper.getNodeValue(e.userId,t,i).then(function(i){var t=JSON.xpath("/roles[id eq '"+e.roleId+"']/type",app.SCOPE.APP_CONFIG,{})[0]
;"instance"==t?rolesManager.doUserRegistration(i,n,e.roleId,"instance").then(function(e){var i=util.success("Role assigned to user in context instance",e);o(i)}).catch(function(e){console.log("rolesManager- instance fail"),o("role update failed")}):"subprofile"==t?rolesManager.doUserRegistration_node(i,n,e.roleId,"subprofile").then(function(e){var i=util.success("Role assigned to user in context subprofile",e);o(i)}).catch(function(e){console.log("rolesManager- subprofile fail"),o("role update failed")}):"adoption"==t?rolesManager.doUserRegistration_adoption(i,n,e.roleId,"adoption").then(function(e){var i=util.success("Role assigned to user in context adoption",e);o(i)}).catch(function(e){console.log("rolesManager- adoption fail"),o("role update failed")}):(console.log("Role not found in any context"),a("Role not found in any context"))}).catch(function(e){a(e)})}).catch(function(e){a(e)})})}}}(),generalFunctions=function(){return{addToFavourites:function(e,i,t){return new Promise(function(i,o){var a=e.context;"profile"==a?library.addToFavouritesProfile().then(function(e){i(e)}).catch(function(e){o(e)}):"subprofile"==a?library.addToFavouritesSubProfile().then(function(e){i(e)}).catch(function(e){o(e)}):"subprocess"==a&&library.addToFavouritesSubProcess(t).then(function(e){i(e)}).catch(function(e){o(e)})})},addToUserFavourites:function(e,i,t){return new Promise(function(o,a){var n=e.context,s=e.user,r="";if(void 0!=s.stepAssigneeFromStep){for(var c=s.stepAssigneeFromStep.stepId,p=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],d={},u=0;u<p.history.length;u++)p.history[u].id==c&&(d=p.history[u]);if(void 0!=d.assignmentHistory&&d.assignmentHistory.length>0){r=d.assignmentHistory[d.assignmentHistory.length-1].userId}}else if(void 0!=s.indicator){var l=s.indicator.indicatorSetId,f=s.indicator.elementId,m=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+l+"']/instances/uuid",i,{})[0],I=JSON.xpath("/indicators[_id eq '"+m+"']",i,{})[0],S="/model/pending/data/"+l+"/"+f,y=JSON.xpath(S,I,{})[0];r=y}"profile"==n?library.addToFavouritesProfileForUser(r).then(function(e){console.log("Workflow ****** Profile Done"),o(e)}).catch(function(e){a(e)}):"subprofile"==n?library.addToFavouritesSubprofileForUser(r).then(function(e){console.log("Workflow ****** SubProfile Done"),o(e)}).catch(function(e){a(e)}):"subprocess"==n&&library.addToUsersFavouritesSubProcessForUser(r,t).then(function(e){console.log("Workflow ****** Subprocess Done"),o(e)}).catch(function(e){a(e)})})}}}();module.exports={community:community,application:application,performance:performance,worker:worker,sdo:sdo,taxonomy:taxonomy,subProcessInstance:subProcessInstance,variables:variables,notification:notification,report:report,participants:participants,user:user,generalFunctions:generalFunctions};

},{"./form":3,"./helper":4,"./nodeValue":6,"utility":8}],3:[function(require,module,exports){
"use strict";function create(e){var t=e[0]||"",s=e[1]||{},i=e[2]||{},r=e[3]||{},o=e[6]||{},a=(e[6],s.indicators||[]),n=(r._type,e[4],e[5],e[7],s._id),c=e[8]||"",d=e[9]||"",u=(o.profile,e[10]||{}),l=r.method.form.create,p=r.method.form.type,f={formCreateType:l,formType:p};return new Promise(function(e,p){var h=a.length,m=!1,v=[],g=function(){if(0==m){var t=util.success("Form create indicator persist success.",o.indicators);e(t)}else{for(var s=[],i=0;i<o.instance.processes.length;i++)o.instance.processes[i].subProcesses.length>0&&s.push(o.instance.processes[i]);o.instance.processes=[],o.instance.processes=s;var r=[],a=JSON.xpath("/subprocesses[_id eq '"+c+"']",o,{})[0],n=a.id,d=JSON.xpath("/config/processes/subProcesses[_id eq '"+n+"']",o,{})[0];if(void 0!=d.instanceType.newSequence){for(var i=0;i<d.indicators.length;i++){var u=d.indicators[i],l=u._id,f=JSON.xpath("distinct-values(/subprocesses[groupKey = '"+a.groupKey+"']/indicators[id = '"+l+"']/instances/uuid)",o,{})[0];if(void 0!=f){var h=JSON.xpath("/indicators[_id eq '"+f+"']",o,{})[0];void 0!=h&&(h.model.pending=h.model.approved)}}for(var g="",i=0;i<d.indicators.length-1;i++)g=g+"'"+d.indicators[i]._id+"',";g=g+"'"+d.indicators[d.indicators.length-1]._id+"'",r=JSON.xpath("distinct-values(/indicators[category/term = ("+g+")]/model/approved/subProcessUUID)",o,{});var I=function(e,t){if(e==t.length){for(var s=[],i=0;i<o.subprocesses.length;i++)o.subprocesses[i].indicators.length>0&&s.push(o.subprocesses[i]);o.subprocesses=[],o.subprocesses=s;var r=util.success("Process failed",v);p(r)}else persistData("indicators",o,t[e]).then(function(s){I(e+1,t)}).catch(function(s){I(e+1,t)})};I(0,r)}else{for(var O=[],i=0;i<o.subprocesses.length;i++)o.subprocesses[i].indicators.length>0&&O.push(o.subprocesses[i]);o.subprocesses=[],o.subprocesses=O;var S=util.success("Process failed",v);p(S)}}},I=JSON.xpath("/config/processes/subProcesses[_id eq '"+n+"']/type",o,{})[0],O=function(e,a,l,p){return new Promise(function(O,S){gatekeeper.instantiate(d,e,a,o.profile,l,n,I).then(function(e){for(var n=0;n<e.length;n++){for(var d=e[n],I=0;I<o.indicators.length;I++){if(o.indicators[I]._id==d.model._id){o.indicators.splice(I,1),o.indicators.push(d.model);break}}if(!d.model._id.endsWith(":approved")&&!d.model._id.endsWith(":rejected")){d.model.model.pending.validDate=l,d.model.model.pending.subProcessUUID=c;var S={id:o.config._id,instance:o.instance._id,processes:[{id:t,subProcessId:s._id,subProcessUUID:c,step:{id:i.id,seq:i.seq,startDate:"",status:i.status,message:i.message,assignedTo:{userId:i.assignedTo.userId,name:i.assignedTo.name},comment:i.comment,complete:!1,endDate:""}}]};1==d.model.model.pending.seq&&void 0!=r.setWorkflowLabelInTitle&&""!=r.setWorkflowLabelInTitle&&1==r.setWorkflowLabelInTitle&&(d.model.title=u.label),void 0!=r.setDraft&&""!=r.setDraft&&1==r.setDraft&&(d.model.control.draft=!0);var _=!1,N=-1;d.model.workflows.forEach(function(e,t){c==e.processes[0].subProcessUUID&&(_=!0,N=t)}),_?d.model.workflows[N]=S:d.model.workflows.push(S);var b=d.model._id;gatekeeper.persist(e).then(function(e){dao.get(b).then(function(e){var t=ko.mapping.fromJS({defaultModel:{setId:a}}),s=e.model.pending.seq;gatekeeper.instantiateData(b,p,t,e.model.pending.seq,f).then(function(e){if("200"==e[0].status){for(var t=0;t<o.indicators.length;t++){if(o.indicators[t]._id==e[0].model._id){o.indicators.splice(t,1),o.indicators.push(e[0].model);break}}if(1==s&&void 0!=r.setWorkflowLabelInField&&""!=r.setWorkflowLabelInField){if(r.setWorkflowLabelInField.split(".")[0]==a){console.log(e[0]);var i=u.label,n=i.replace(/'/g,"\\'"),d=e[0].model.model.pending.data,l=""==r.setWorkflowLabelInField?[]:r.setWorkflowLabelInField.split(/['"\[\].]+/),p=0;for(p=0;p<l.length-1;p++)""!=l[p]&&(d=d[l[p]]);d[l[p]]=n}}gatekeeper.persist(e).then(function(e){dao.get(b).then(function(e){if(0==o.indicators.length)o.indicators.push(e),h--,0==h&&persistData("indicators",o,c).then(function(e){util.success("Form create indicator persist success.",o.indicators);g()}).catch(function(e){v.push({error:"persistData "+c,errorBlock:e}),console.error(e);util.success("Form create indicator persist failed.",{});m=!0,g()}),O({});else{for(var t=!1,s=0;s<o.indicators.length;s++){o.indicators[s]._id==e._id&&(t=!0,o.indicators.splice(s,1),o.indicators.push(e),s=o.indicators.length,h--,0==h&&persistData("indicators",o,c).then(function(e){util.success("Form create indicator persist success.",o.indicators);g()}).catch(function(e){v.push({error:"persistData "+c,errorBlock:e}),console.error(e);util.success("Form create indicator persist failed.",{});m=!0,g()}),O({}))}0==t&&(o.indicators.push(e),h--,0==h&&persistData("indicators",o,c).then(function(e){util.success("Form create indicator persist success.",o.indicators);g()}).catch(function(e){v.push({error:"persistData "+c,errorBlock:e}),console.error(e);util.success("Form create indicator persist failed.",{});m=!0,g()}),O({}))}}).catch(function(e){v.push({error:"dao.get(mainId) "+b,errorBlock:e}),console.error(e);util.success("1 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),O({})})},function(e){v.push({error:"gatekeeper.persist(data) - Persisting all docs ",errorBlock:e}),console.error(e);util.success("2 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),O({})})}else{v.push({error:"gatekeeper.instantiateData"+b+" "+e[0].status,errorBlock:{}});util.success("3 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),O({})}},function(e){v.push({error:"gatekeeper.instantiateData"+b,errorBlock:e});util.success("4 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),O({})})}).catch(function(e){v.push({error:"dao.get(mainId) "+b,errorBlock:e}),console.error(e);util.success("5 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),O({})})},function(e){v.push({error:"gatekeeper.persist savedArray",errorBlock:e}),console.error(e);util.success("6 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),O({})})}}},function(e){v.push({error:"gatekeeper.instantiate",errorBlock:e}),m=!0,h--,0==h&&g(),O({})})})},S=FROM_DEFINITION,_=function(e,t){if(0==e.length)0==--h&&g();else if(t<e.length){var i=e[t]._id,r=(util.getName(e[t].name,"en"),e[t].initiateData,"");void 0!=s.instanceType.newSequence?r=INSTANCE_TYPE_NEW_SEQ:void 0!=s.instanceType.newInstance&&(r=INSTANCE_TYPE_NEW_INS);var a=function(){O(r,i,u.validDate,S).then(function(s){_(e,t+1)}).catch(function(e){m=!0,0==--h&&g()})};if(void 0!=d&&""!=d&&d.length>0){var p=JSON.xpath("/subprocesses[_id eq '"+d+"']",o,{})[0];void 0==s.periodType.periodic&&d!=c&&(p.active=!1),S=l==BLANK_MODEL?FROM_DEFINITION:FROM_AUTHORISED,a()}else{var f=JSON.xpath("/indicators[setId eq '"+i+"']/cardinality",app.SCOPE.APP_CONFIG,{})[0];if(r==INSTANCE_TYPE_NEW_INS)f==INDICATOR_CARDINALITY_SINGLE?library.getSingleIndicator(i).then(function(e){S=e.length>0?FROM_AUTHORISED:FROM_DEFINITION,a()}).catch(function(e){S=FROM_DEFINITION,a()}):(S=FROM_DEFINITION,a());else if(f==INDICATOR_CARDINALITY_SINGLE)library.getSingleIndicator(i).then(function(e){S=e.length>0?FROM_AUTHORISED:FROM_DEFINITION,a()}).catch(function(e){S=FROM_DEFINITION,a()});else{var v="/indicators[category/term eq '"+i+"' and id = /subprocesses[id = '"+n+"']/indicators/instances/uuid]/_id",N=library.getSubprofileSubprocessIds();I==PROCESS_TYPE_SUBPROFILE&&(v="/indicators[category/term eq '"+i+"' and id = /subprocesses[id = '"+n+"' and id = "+N+"]/indicators/instances/uuid]/_id");var b=JSON.xpath(v,o,{});S=b.length>0?FROM_AUTHORISED:FROM_DEFINITION,a()}}}};_(a,0)})}function setInstanceTitle(e){var t=e[0]||{},s=e[2]||"",i=e[4]||{},r=i.label;return new Promise(function(e,i){for(var o=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],a=o.indicators,n=0;n<a.length;n++){var c=a[n].instances[0].uuid;JSON.xpath("/indicators[_id eq '"+c+"']",t,{})[0].title=a[n].id+" "+r}e("Set Title Success",a)})}function deleteProfile(e){var t=e[0]||{},s=t.profile;return new Promise(function(e,i){var r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId);var o={source:"remote",type:"workerObject",_id:generateUUID(),channels:["deleteProfile","community_"+app.SCOPE.getCommunityId(),"workerObject"],communityId:app.SCOPE.getCommunityId(),applicationId:app.SCOPE.applicationId,profileId:t.profile,message:"",subprofileId:r,messageType:"info",createdDateTime:moment().format(),senderUserId:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,parentTransactionId:void 0==app.SCOPE.txn?"":app.SCOPE.txn.transactionId,notification:{},profile:{action:"deleteProfile",profileId:s}};console.log(o),dao.save(o).then(function(t){console.log("Worker Object submitted for profile("+s+") deletion."),console.log(t),e(t)}).catch(function(e){console.log(e),i(data)})})}function createProfile(e){var t=e[1]||{},s=t.communityId,i=t.profile;return new Promise(function(e,t){library.createProfileDocuments(s,i).then(function(t){var s=util.success("Form created successfully.",t);e(s)}).catch(function(e){console.error(e);var s=util.success("ERROR: Profile creation failed",{});t(s)})})}function setDraft(e){var t=e[0]||{},s=e[2]||"";return new Promise(function(e,i){for(var r=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],o=r.indicators,a=0;a<o.length;a++){var n=o[a].instances[0].uuid;JSON.xpath("/indicators[_id eq '"+n+"']",t,{})[0].control.draft=!0}e("Set Draft Success",o)})}function setUnDraft(e){var t=e[0]||{},s=e[2]||"";return new Promise(function(e,i){for(var r=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],o=r.indicators,a=0;a<o.length;a++){var n=o[a].instances[0].uuid;JSON.xpath("/indicators[_id eq '"+n+"']",t,{})[0].control.draft=!1}e("Set Draft Success",o)})}function save(e){var t={complete:!0,data:[]};return new Promise(function(e,s){e(util.success("Form indicator set saved successfully.",t))})}function submit(e){var t={complete:!0,data:[]};return new Promise(function(e,s){e(util.success("Form submitted successfully.",t))})}function authorise(e){var t=(e[0],e[1],e[2],e[3],e[4]||{}),s=e[6]||"";return new Promise(function(e,i){var r=(JSON.xpath("/subprocesses[_id eq '"+s+"']",app.SCOPE.workflow,{})[0],JSON.xpath("/subprocesses[_id eq '"+s+"']/indicators/instances/uuid",t,{})),o=r.length,a=[],n=[],c=function(d){gatekeeper.authorise(r[d]).then(function(r){gatekeeper.persist(r).then(function(r){for(var u="",l=0;l<r.length;l++)r[l].id.endsWith(":approved")||(u=r[l].id);dao.get(u).then(function(r){if(0==t.indicators.length)t.indicators.push(r),o--,0==o?persistData("indicators",t,s).then(function(t){var s=util.success("Form authorised successfully.",a);e(s)}).catch(function(e){console.error(e);var t=util.success("Form authorised persist failed.",{});i(t)}):o>0&&c(d+1);else{for(var u=!1,l=0;l<t.indicators.length;l++){if(t.indicators[l]._id==r._id&&(u=!0,n.push(r),0==--o)){for(var p=t.indicators.length,f=n.length,h=0;h<p;h++){for(var m=!1,v=0;v<f;v++)t.indicators[h]._id==n[v]._id&&(m=!0);m||n.push(t.indicators[h])}t.indicators=n;break}}1==u&&0==o?persistData("indicators",t,s).then(function(t){var s=util.success("Form authorised successfully.",a);e(s)}).catch(function(e){console.error(e);var t=util.success("Form authorised persist failed.",{});i(t)}):o>0&&c(d+1)}}).catch(function(e){console.error(e);var t=util.success("Form authorised persist failed 2.",{});i(t)})},function(e){console.error(e);var t=util.success("Form authorised persist failed 3.",{});i(t)})},function(e){var t=util.success("Form authorised persist failed 4.",{});i(t)})};c(0)})}function close(e){var t={complete:!0,data:[]};return new Promise(function(e,s){e(util.success("Form closed successfully.",t))})}function updateIndicator(e){var t=e[0]||{},s=e[1]||"",i=e[2]||"",r=e[3]||"";return new Promise(function(e,o){var a=i.split(".",1)[0],n=JSON.xpath("/indicators[workflows/processes/subProcessUUID = '"+s+"' and category/term = '"+a+"']",t,{})[0];if(void 0==n&&"appProfile"==a&&void 0==(n=JSON.xpath("/indicators[model/pending/status = 'Authorised' and category/term = '"+a+"']",t,{})[0])){var c=[],d={};d.model={},c.push(d);var u=util.success("Indicator updated skipped.",c);return void e(u)}var l=(r+"").replace(/'/g,"\\'"),l=l.split("\n").join(" "),p=n.model.pending.data,f=""==i?[]:i.split(/['"\[\].]+/),h=0;for(h=0;h<f.length-1;h++)""!=f[h]&&(p=p[f[h]]);p[f[h]]=l;var c=[],d={};d.model=n,c.push(d);var m=JSON.parse(JSON.stringify(app.SCOPE.txn));m.documents=[];var v={document:n._id,rev:n._rev};m.documents.push(v),app.SCOPE.txn.documents.push(v),dao.updateTransaction(m).then(function(t){dao.save(n).then(function(t){v.rev=t.rev;var s=util.success("Indicator updated.",c);e(s)}).catch(function(t){console.log(t);var s=util.success("Indicator updated.",c);e(s)})}).catch(function(t){console.log(t);var s=util.success("Indicator updated.",c);e(s)})})}function updateIndicatorWrapper(e){var t=e[0]||{},s=e[1]||"",i=e[2]||"",r=e[3]||"",o=e[4]||"";return new Promise(function(e,a){var n=JSON.xpath("/indicators[workflows/processes/subProcessUUID = '"+s+"' and category/term = '"+o+"']",t,{})[0];if(void 0==n&&"appProfile"==o&&void 0==(n=JSON.xpath("/indicators[model/pending/status = 'Authorised' and category/term = '"+o+"']",t,{})[0])){var c=[],d={};d.model={},c.push(d);var u=util.success("Indicator updated skipped.",c);return void e(u)}var l=r.replace(/'/g,"\\'"),l=l.split("\n").join(" "),p=n,f=""==i?[]:i.split(/['"\[\].]+/),h=0;for(h=0;h<f.length-1;h++)""!=f[h]&&(p=p[f[h]]);p[f[h]]=l;var c=[],d={};d.model=n,c.push(d);var m=JSON.parse(JSON.stringify(app.SCOPE.txn));m.documents=[];var v={document:n._id,rev:n._rev};m.documents.push(v),app.SCOPE.txn.documents.push(v),dao.updateTransaction(m).then(function(t){dao.save(n).then(function(t){v.rev=t.rev;var s=util.success("Indicator updated.",c);e(s)}).catch(function(t){console.log(t);var s=util.success("Indicator updated.",c);e(s)})}).catch(function(t){console.log(t);var s=util.success("Indicator updated.",c);e(s)})})}function markUpdateIndicator(e){var t=e[0]||{},s=e[1]||"",i=e[2]||"",r=e[3]||"";return new Promise(function(e,o){var a=JSON.xpath("/indicators[workflows/processes/subProcessUUID = '"+s+"' and category/term = '"+r+"']",t,{})[0];a.model.pending.status=i;var n=[],c={};c.model=a,n.push(c),e(util.success("Indicator updated.",n))})}function setStatus(e){var t=e[0]||{},s=e[1]||"",i=e[2]||"";return new Promise(function(e,r){var o=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0];o.step.message=i,e("Set profile status Success",o)})}var util=require("utility"),gatekeeper=new GK;module.exports={create:create,save:save,submit:submit,authorise:authorise,close:close,setDraft:setDraft,setUnDraft:setUnDraft,createProfile:createProfile,setInstanceTitle:setInstanceTitle,deleteProfile:deleteProfile,updateIndicator:updateIndicator,markUpdateIndicator:markUpdateIndicator,updateIndicatorWrapper:updateIndicatorWrapper};

},{"utility":8}],4:[function(require,module,exports){
"use strict";function getLanguageMessage(e){var a=service.getLanguage();return e.i18n[a]}function getNodeValue(e,a,r){return new Promise(function(t,i){if(void 0!=e.value){var s="string";s=void 0!=e.value.datatype.dataType?e.value.datatype.dataType:e.value.datatype;var o=e.value.data;t("number"==s?Number(o):"string"==s?o:"integer"==s?parseInt(o):"decimal"==s?parseFloat(o):"date"==s||"dateTime"==s?o:o)}else if(void 0!=e.indicatorUUID){var n=null,c=JSON.xpath("/subprocesses[_id eq '"+r+"']",a,{})[0];0==c.indicators.length?n=JSON.xpath("/indicators[category/term eq '"+e.indicatorUUID.indicatorSetId+"']/_id",a,{})[0]:void 0==(n=JSON.xpath("/indicators[id eq '"+e.indicatorUUID.indicatorSetId+"']/instances/uuid",c,{})[0])&&(n=JSON.xpath("/indicators[category/term eq '"+e.indicatorUUID.indicatorSetId+"']/_id",a,{})[0]),t(n)}else if(void 0!=e.indicator){var n=JSON.xpath("/subprocesses[_id eq '"+r+"']/indicators[id eq '"+e.indicator.indicatorSetId+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],p="/model/pending/data/"+e.indicator.indicatorSetId+"/"+e.indicator.elementId,l=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+r+"']/id]/type",a,{})[0],u=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+r+"']/id])",a,{})[0]+1;if(l==PROCESS_TYPE_SUBPROFILE){var S=library.getSubprofileSubprocessIds();u=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+r+"']/id and uuid = "+S+"])",a,{})[0]+1}var f=replaceAll(p,"#SEQUENCE#",u),b=JSON.xpath("/subprocesses[_id eq '"+r+"']/dates/valid",a,{})[0],v="'"+b+"'",m=replaceAll(f,"#END_DATE#",v),O=replaceAll(m,"[.]","/"),h=JSON.xpath(O,d,{})[0];void 0!=e.indicator.addString&&""!=e.indicator.addString&&(h+=e.indicator.addString),t(h)}else if(void 0!=e.system)t("ERROR: Unimplemented system type found.");else if(void 0!=e.variable)if(void 0!=e.variable.profile){var N=e.variable.profile,g=a.profile,x=g+":variables";dao.get(x).then(function(s){if(void 0!=e.variable.type)"count"==e.variable.type?t(s[e.variable.name].length):i("ERROR: Profile variables type implementation - Case not found");else{for(var o=s,n=""==N?[]:N.split(/['"\[\].]+/),c=0;c<n.length;c++)""!=n[c]&&(o=o[n[c]]);var d=o;if(void 0==d)i("Variable not found");else if("object"==typeof d){var p=function(){return new Promise(function(t,i){void 0!=e.variable.periodic&&void 0!=e.variable.periodic.value?getNodeValue(e.variable.periodic.value,a,r).then(function(e){t(e)}).catch(function(e){i(e)}):t("value")})};(function(){return new Promise(function(t,i){var s=0;if(void 0==e.variable.periodic||void 0==e.variable.periodic.seq){var o=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+r+"']/id]/type",a,{})[0];if(s=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+r+"']/id])",a,{})[0]+1,o==PROCESS_TYPE_SUBPROFILE){var n=library.getSubprofileSubprocessIds();s=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+r+"']/id and uuid = "+n+"])",a,{})[0]+1}t(s)}else getNodeValue(e.variable.periodic.seq,a,r).then(function(e){t(e)}).catch(function(e){i(e)})})})().then(function(e){p().then(function(a){var r="/"+N+"["+e+"]/"+a,i=JSON.xpath(r,s,{})[0];t(i)}).catch(function(e){i(e)})}).catch(function(e){i(e)})}else"string"==typeof d&&t(d)}}).catch(function(e){i("ERROR: Profile variables not found")})}else if(void 0!=e.variable.subProfile){var N=e.variable.subProfile,I=app.profile.subprofileId;void 0!=e.variable.subprofileId&&""!=e.variable.subprofileId&&(I=e.variable.subprofileId);var x=I+":variables";dao.get(x).then(function(s){for(var o=s,n=""==N?[]:N.split(/['"\[\].]+/),c=0;c<n.length;c++)""!=n[c]&&(o=o[n[c]]);var d=o;if(void 0==d)i("Variable not found");else if("object"==typeof d){var p=0;if(void 0==e.variable.periodic||void 0==e.variable.periodic.seq){var l=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+r+"']/id]/type",a,{})[0];if(p=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+r+"']/id])",a,{})[0]+1,l==PROCESS_TYPE_SUBPROFILE){var u=library.getSubprofileSubprocessIds();p=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+r+"']/id and uuid = "+u+"])",a,{})[0]+1}}else p=getNodeValue(e.variable.periodic.seq,a,r);var S="value";void 0!=e.variable.periodic&&void 0!=e.variable.periodic.value&&(S=getNodeValue(e.variable.periodic.value,a,r));var f="/"+N+"["+p+"]/"+S,b=JSON.xpath(f,s,{})[0];t(b)}else"string"==typeof d&&t(d)}).catch(function(e){i("ERROR: sub Profile variables not found")})}else i("ERROR: Unimplemented profile type found.");else if(void 0!=e.indicatorWrapper){var E=e.indicatorWrapper.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+r+"']/indicators[id eq '"+E+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],q=replaceAll(e.indicatorWrapper.path,"[.]","/"),p="/"+q,J=JSON.xpath(p,d,{})[0];t(J)}else if(void 0!=e.calculated){for(var J="",_=e.calculated.separator,P=0;P<e.calculated.elements.length-1;P++){var R=e.calculated.elements,y=["fromRepeat","elementProperty","constantValue","elementWrapper","currentDate","randomDigits","profileObjectElement","profileObjectWrapper","currentFinancialYear","scopeVariable","xpath"];switch(propertyExists(R[P],y)){case"elementProperty":var E=R[P].elementProperty.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+r+"']/indicators[id eq '"+E+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],q=replaceAll(R[P].elementProperty.elementId,"[.]","/"),p="/model/pending/data/"+E+"/"+q,A=JSON.xpath(p,d,{})[0];J=J+A+_;break;case"constantValue":var A=R[P].constantValue.value;J=J+A+_;break;case"scopeVariable":var D=R[P].scopeVariable,A="";"#USER_ID"==D?A=LOCAL_SETTINGS.SUBSCRIPTIONS.userId:"#USERNAME"==D?A=LOCAL_SETTINGS.SESSION.username:"#FIRSTNAME"==D?A=LOCAL_SETTINGS.SESSION.firstName:"#LASTNAME"==D&&(A=LOCAL_SETTINGS.SESSION.lastName),A.length>0&&(J=J+A+_);break;case"elementWrapper":var E=R[P].elementWrapper.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+r+"']/indicators[id eq '"+E+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],q=replaceAll(R[P].elementWrapper.elementId,"[.]","/"),p="/"+q,A=JSON.xpath(p,d,{})[0];J=J+A+_;break;case"currentDate":J=J+formatDate(new Date)+_;break;case"randomDigits":var T=R[P].randomDigits.digits,k=Math.random(),L=Math.pow(10,T),w=k*L^0;J=J+w+_;break;case"profileObjectElement":var E=R[P].profileObjectElement.indicatorSetId,d=JSON.xpath("/indicators[category/term eq 'appProfile']",app.SCOPE.workflow,{})[0],q=replaceAll(R[P].profileObjectElement.elementId,"[.]","/"),p="/model/pending/data/"+E+"/"+q,A=JSON.xpath(p,d,{})[0];J=J+A+_;break;case"profileObjectWrapper":var E=R[P].profileObjectWrapper.indicatorSetId,d=JSON.xpath("/indicators[category/term eq 'appProfile']",app.SCOPE.workflow,{})[0],q=replaceAll(R[P].profileObjectWrapper.wrapperElementId,"[.]","/"),p="/"+q,A=JSON.xpath(p,d,{})[0];J=J+A+_;break;case"currentFinancialYear":var U=R[P].currentFinancialYear.startDate,V=R[P].currentFinancialYear.startMonth,C=(new Date).getFullYear()+"-"+V+"-"+U;J=J+C+_;break;case"fromRepeat":var E=R[P].fromRepeat.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+r+"']/indicators[id eq '"+E+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],q=replaceAll(R[P].fromRepeat.path,"[.]","/"),p="/model/pending/data/"+E+"/"+q,W="";if("validDate"==R[P].fromRepeat.filter){var j=JSON.xpath("/subprocesses[_id eq '"+r+"']",a,{})[0],F=j.dates.valid;W="[enddate eq '"+F+"']/"}p=p+W+replaceAll(R[P].fromRepeat.element,"[.]","/");var A=JSON.xpath(p,d,{})[0];J=J+A+_;break;case"xpath":if(void 0!=R[P].xpath.indicatorSetId){var E=R[P].xpath.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+r+"']/indicators[id eq '"+E+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],A=JSON.xpath(R[P].xpath.expr,d,{})[0];J=J+A+_;break}var A=JSON.xpath(R[P].xpath.expr,a,{})[0];J=J+A+_;break;default:i("No method found from implemented list.")}}var P=e.calculated.elements.length-1,R=e.calculated.elements,y=["fromRepeat","elementProperty","constantValue","elementWrapper","currentDate","randomDigits","profileObjectElement","profileObjectWrapper","currentFinancialYear","scopeVariable"];switch(propertyExists(R[P],y)){case"elementProperty":var E=R[P].elementProperty.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+r+"']/indicators[id eq '"+E+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],q=replaceAll(R[P].elementProperty.elementId,"[.]","/"),p="/model/pending/data/"+E+"/"+q,A=JSON.xpath(p,d,{})[0];J+=A;break;case"constantValue":var A=R[P].constantValue.value;J+=A;break;case"scopeVariable":var D=R[P].scopeVariable,A="";"#USER_ID"==D?A=LOCAL_SETTINGS.SUBSCRIPTIONS.userId:"#USERNAME"==D?A=LOCAL_SETTINGS.SESSION.username:"#FIRSTNAME"==D?A=LOCAL_SETTINGS.SESSION.firstName:"#LASTNAME"==D&&(A=LOCAL_SETTINGS.SESSION.lastName),A.length>0&&(J+=A);break;case"elementWrapper":var E=R[P].elementWrapper.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+r+"']/indicators[id eq '"+E+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],q=replaceAll(R[P].elementWrapper.elementId,"[.]","/"),p="/"+q,A=JSON.xpath(p,d,{})[0];J+=A;break;case"currentDate":J+=formatDate(new Date);break;case"randomDigits":var T=R[P].randomDigits.digits,k=Math.random(),L=Math.pow(10,T),w=k*L^0;J+=w;break;case"profileObjectElement":var E=R[P].profileObjectElement.indicatorSetId,d=JSON.xpath("/indicators[category/term eq 'appProfile']",app.SCOPE.workflow,{})[0],q=replaceAll(R[P].profileObjectElement.elementId,"[.]","/"),p="/model/pending/data/"+E+"/"+q,A=JSON.xpath(p,d,{})[0];J+=A;break;case"profileObjectWrapper":var E=R[P].profileObjectWrapper.indicatorSetId,d=JSON.xpath("/indicators[category/term eq 'appProfile']",app.SCOPE.workflow,{})[0],q=replaceAll(R[P].profileObjectWrapper.wrapperElementId,"[.]","/"),p="/"+q,A=JSON.xpath(p,d,{})[0];J+=A;break;case"currentFinancialYear":var U=R[P].currentFinancialYear.startDate,V=R[P].currentFinancialYear.startMonth,C=(new Date).getFullYear()+"-"+V+"-"+U;J+=C;break;case"fromRepeat":var E=R[P].fromRepeat.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+r+"']/indicators[id eq '"+E+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],q=replaceAll(R[P].fromRepeat.path,"[.]","/"),p="/model/pending/data/"+E+"/"+q,W="";if("validDate"==R[P].fromRepeat.filter){var j=JSON.xpath("/subprocesses[_id eq '"+r+"']",a,{})[0],F=j.dates.valid;W="[enddate eq '"+F+"']/"}p=p+W+replaceAll(R[P].fromRepeat.element,"[.]","/");var A=JSON.xpath(p,d,{})[0];J+=A;break;default:i("No method found from implemented list.")}t(J)}else if(void 0!=e.subProcess)if(void 0!=e.subProcess.path){for(var M=e.subProcess.path,Y=M.split("."),G="",P=0;P<Y.length;P++)G=G+"['"+Y[P]+"']";for(var c=JSON.xpath("/subprocesses[_id eq '"+r+"']",a,{})[0],B=c,Q=""==G?[]:G.split(/['"\[\].]+/),z=0;z<Q.length;z++)""!=Q[z]&&(B=B[Q[z]]);var J=B;t(J)}else e.subProcess.stepUser})}function replaceAll(e,a,r){return"function"!=typeof e.replace&&(console.log(a+" "+r),console.log(e)),e.replace(new RegExp(a,"g"),r)}function formatDate(e){return e.getDate()+"-"+e.getMonth()+"-"+e.getFullYear()}function compare(e,a,r){switch(a){case">":return e>r;case"<":return e<r;case">=":return e>=r;case"<=":return e<=r;case"==":return void 0==e&&(e=""),e==r;case"!=":return e!=r}}module.exports={getLanguageMessage:getLanguageMessage,getNodeValue:getNodeValue,compare:compare};

},{}],5:[function(require,module,exports){
"use strict";function getProcess(e,s,t){return new Promise(function(n,i){try{var c=[],r=[];t.instance.processes.filter(function(s){s.id==e&&(r=s)}),util.syncLoop(r.subProcesses.length,function(n){var o=n.iteration(),u=r.seq,f=r.subProcesses[o].id,a=r.subProcesses[o].seq;getSubProcess(e,u,f,a,s,t).then(function(e){c.push(e),n.next()},function(e){n.break(),i(e)})},function(){n(c)})}catch(e){i(e)}})}function getSubProcess(e,s,t,n,i,c){return new Promise(function(r,o){try{var u={id:"",seq:"",name:"",help:"",dates:"",step:""},f=[],a=[];c.instance.processes.filter(function(i){if(i.id==e&&i.seq==s){i.subProcesses.length;i.subProcesses.filter(function(e){e.id==t&&e.seq==n&&0==e.complete&&(f=e)})}}),c.config.processes.filter(function(s){s._id==e&&s.subProcesses.filter(function(e){e._id==t&&(a=e)})}),u.id=a._id,u.seq=f.seq,u.name=util.getName(a.name,i),u.help=util.getName(a.help,i),u.dates=f.dates,u.step=f.step,r(u)}catch(e){o(e)}})}function prepareNotificationScreen(){""}var util=require("utility");module.exports={getProcess:getProcess};

},{"utility":8}],6:[function(require,module,exports){
"use strict";function get(){return new Promise(function(e,t){})}module.exports={get:get};

},{}],7:[function(require,module,exports){
"use strict";function count(e){return void 0!==e?e.length:0}function preRequisites(e,s,t){return new Promise(function(i,n){var o=[];try{util.syncLoop(e.length,function(i){var a=i.iteration();preRequisite(e[a],s,t).then(function(e){o.push(!0),i.next()},function(e){o.push(!1),i.break(),n(e)})},function(){if(o.every(Boolean)){var e=util.success("Pre-requisites completed successfully.",{});i(e)}else{var s=util.error("WFPreRequisiteError","Not all pre-requisites passed.");n(s)}})}catch(e){n(e)}})}function preRequisite(e,s,t){return new Promise(function(i,n){if(void 0!=e.check.numberProcessInstances){var o=e.check.numberProcessInstances,a=o.operator;switch(a){case"greaterThan":"gt";break;case"lessThan":"lt";break;case"greaterThanEqual":"ge";break;case"lessThanEqual":"le";break;case"equalTo":"eq";break;case"notEqualTo":"ne"}var r=o.subProcessId,c=o.type,u="";u="all"==c?"":"[complete eq 'true']";var d="";void 0!=o.filter&&o.filter.length>0&&(d="["+o.filter+"]");var p="count(/instance/processes/subProcesses[id eq '"+r+"']"+u+d+")",l=JSON.xpath("/config/processes/subProcesses[_id eq '"+r+"']/type",s,{})[0],f=library.getSubprofileSubprocessIds();void 0!=app.profile.subprofileId&&""!=app.profile.subprofileId&&void 0!=l&&l==PROCESS_TYPE_SUBPROFILE&&(p="count(/instance/processes/subProcesses[id eq '"+r+"' and uuid = "+f+"]"+u+")");var m=JSON.xpath(p,s,{})[0],h=e.check.numberProcessInstances.count;if(util.compare(m,e.check.numberProcessInstances.operator,parseInt(h))){var g=util.success("Pre-requisites passed.",{});i(g)}else{var v=helper.getLanguageMessage(e.message),S=util.error("WFPreRequisiteError",v);n(S)}}else if(void 0!=e.check.variable){var I=e.check.variable.scope,N="";if("profile"==I){var b=s.profile;N=b+":variables"}else if("subProfileSubProcessInstance"==I){var y=app.profile.subprofileId;N=y+":variables"}else n("ERROR: Scope '"+I+"' not implemented in pre-requisites");dao.get(N).then(function(o){for(var a=e.check.variable.name,r=e.check.variable.type,c=o,u=""==a?[]:a.split(/['"\[\].]+/),d=0;d<u.length;d++)""!=u[d]&&(c=c[u[d]]);var p,l=c;if(void 0!=r&&"array"==r)p=l;else if("object"==typeof l){var f=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+t+"']/id]/type",s,{})[0],m=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id])",s,{})[0]+1;if(f==PROCESS_TYPE_SUBPROFILE){var h=library.getSubprofileSubprocessIds();m=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+h+"])",s,{})[0]+1}var g="/"+a+"["+m+"]/value";p=JSON.xpath(g,o,{})[0]}else"string"==typeof l&&(p=l);var v=e.check.variable.value.data,S=e.check.variable.value.dataType.dataType;if(0==v.indexOf("xpath:")){var I=v.substring(6);v=JSON.xpath(I,s,{})[0]}if("#VALID_DATE"==v){var N=JSON.xpath("/subprocesses[_id eq '"+t+"']",s,{})[0];void 0!=N&&(v=N.dates.valid)}var c;if("number"==S?c=Number(v):"string"==S?c=v:"integer"==S?(c=parseInt(v),void 0!=r&&"array"==r&&(p=void 0==p?0:p.length)):"decimal"==S?c=parseFloat(v):"date"!=S&&"dateTime"!=S||(c=v),void 0==p&&void 0!=e.check.variable.allowBlank&&1==e.check.variable.allowBlank){var b=util.success("Variable Pre-requisites passed.",{});i(b)}else{if(util.compare(p,e.check.variable.operator,c)){var b=util.success("Variable Pre-requisites passed.",{});i(b)}else{var y=helper.getLanguageMessage(e.message);y=y.replace("#VALID_DATE",p);var T=util.error("WFPreRequisiteError",y);n(T)}}}).catch(function(s){if(void 0!=e.check.variable.allowBlank&&1==e.check.variable.allowBlank){var t=util.success("Variable Pre-requisites passed.",{});i(t)}else{var o=helper.getLanguageMessage(e.message),s=util.error("WFPreRequisiteError:",o);n(s)}})}else{var S=util.error("WFPreRequisiteError","Pre-requisite type not defined.");n(S)}})}function preActions(e,s,t){return new Promise(function(i,n){var o=[];try{var a=JSON.xpath("/subprocesses[_id eq '"+t+"']",s,{})[0],r=a["meta-data"].processConfigId,c=a["meta-data"].subProcessConfigId,u=a["meta-data"].subProcessInsSeq,d=a["meta-data"].subProcessInsSeq,p=JSON.xpath("/processes[_id eq '"+r+"']/subProcesses[_id eq '"+c+"']",s.config,{})[0],l=JSON.xpath("/subprocesses[_id eq '"+t+"']/step",s,{})[0];util.syncLoop(e.length,function(i){var a=i.iteration();action(e[a],r,u,c,d,p,l,s,{},t).then(function(e){o.push(!0),i.next()},function(e){o.push(!1),i.break(),n(e)})},function(){if(o.every(Boolean)){var e=util.success("Pre-actions completed successfully.",{});i(e)}else{var s=util.error("WFPreRequisiteError","Not all pre-actions passed.");n(s)}})}catch(e){n(e)}})}function getSubProcess(e,s){if(void 0==s.subprocesses)return[];s.subprocesses.filter(function(s){if(s.id==e)return s})}function subProcess(e,s,t,i,n,o,a,r){var c=[],u=[],d=[];r.subprocesses.filter(function(s){s._id==e&&(c=s)}),r.config.processes.filter(function(e){e._id==s&&(u=e,e.subProcesses.filter(function(e){e._id==i&&(d=e)}))});var p="",l=a.baseUUID,f=0;if(void 0!=l&&""!=l&&l.length>0){var m=JSON.xpath("/subprocesses[_id eq '"+l+"']",r,{})[0];p=m.groupKey,f=m["meta-data"].subProcessInsSeq}else{for(var h="",g=0;g<d.indicators.length-1;g++)h=h+"'"+d.indicators[g]._id+"',";h=h+"'"+d.indicators[g]._id+"'";var v=JSON.xpath("/indicators[setId = ("+h+") and cardinality eq 'single']",app.SCOPE.APP_CONFIG,{}).length;if(void 0!=d.instanceType.newSequence||v>0){var m=JSON.xpath("/instance/processes[id eq '"+s+"']",r,{})[0];p=void 0!=m&&m.subProcesses.length>0?m.subProcesses[0].groupKey:generateUUID()}else p=generateUUID();f=JSON.xpath("count(/processes/subProcesses[groupKey eq '"+p+"'])",r.instance,{})[0]}var S=a.label,I=e,N={_id:I,id:i,type:"workflowInstanceSubProcess",dateTimeCreated:moment().format(),dueDateTime:moment().format(),seq:n,initiated:!1,dates:{created:"",valid:"",start:"",due:"",closed:""},complete:!1,indicators:[],step:{},active:!0,groupKey:p,label:S,channels:["community_"+app.SCOPE.getCommunityId(),"profile_"+app.SCOPE.profileId,"application_"+app.SCOPE.applicationId,"community_"+app.SCOPE.getCommunityId()+"_application_"+app.SCOPE.applicationId],history:[],"meta-data":{applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.profileId,subprofileId:void 0==o?"":o,processConfigId:s,subProcessConfigId:i,subProcessInsSeq:f+1},messages:[],spStatus:""};return void 0!=a.validDate&&a.validDate.length>0&&(N.dates.valid=a.validDate),void 0!=app.profile.subprofileId&&""!=app.profile.subprofileId?(N.channels.push("profile_"+app.SCOPE.profileId+"_subprofile_"+app.profile.subprofileId),N.channels.push("subprofile_"+app.profile.subprofileId)):(N.channels.push("profile_"+app.SCOPE.profileId+"_subprofile_0"),N.channels.push("subprofile_0")),r.subprocesses.push(N),new Promise(function(e,o){try{preActions(u.preActions,r,I).then(function(p){preRequisites(u.prerequisites,r,I).then(function(u){initiate(d.initiate,c,a).then(function(c){N.initiated=c.data.initiated,N.dates=c.data.dates;var u=d.steps[0]._id;d.steps[0].transition[0]._id,step(s,t,i,n,u,1,a,r,I).then(function(s){N.step=s.data,indicators(d.indicators,r,N._id).then(function(s){N.indicators=s.data;var t=util.success(s.message,N);e(t)},function(e){o(e)})},function(e){console.log(e),o(e)})},function(e){r.subprocesses=r.subprocesses.filter(function(e){return!(e._id==I)}),o(e)})},function(e){r.subprocesses=r.subprocesses.filter(function(e){return!(e._id==I)}),o(e)})},function(e){r.subprocesses=r.subprocesses.filter(function(e){return!(e._id==I)}),o(e)})}catch(e){o(e)}})}function initiate(e,s,t){var i={initiated:!1,dates:{created:"",valid:"",start:"",due:"",closed:""}};return new Promise(function(n,o){var a=function(){if(void 0!=e.user){i.dates.created=t.createdDate,"userSelected"!=e.user.validDate._type&&"autoSelected"!=e.user.validDate._type||(void 0!=t.validDate?i.dates.valid=t.validDate:i.dates.valid=(new Date).toISOString().substring(0,10)),"userSelected"!=e.user.dueDate._type&&"autoSelected"!=e.user.dueDate._type||void 0!==t.dueDate&&(i.dates.due=t.dueDate),i.dates.start=t.firstDate,i.initiated=!0;var s=util.success("Sub-Process initiate completed successfully.",i);n(s)}else if(void 0!=e.auto);else{var a=util.error("WFInitiateError","Initiate type: "+e._type+" not defined.");o(a)}};if(void 0==s.complete)a();else if(!s.complete)if(e.parallelInstances)a();else{var r=util.error("WFInitiateError","Sub-process: "+s.id+" still active and parallel instances are not allowed.");o(r)}})}function step(e,s,t,i,n,o,a,r,c){var u,d={key:generateUUID(),id:"",seq:"",status:"",message:"",assignedTo:{userId:"",name:"",dateTime:"",type:"",dueDateTime:"",by:""},assignmentHistory:[],dateTimeCreated:moment().format(),dueDateTime:moment().format(),transition:{transitionId:"",dateTime:"",userId:""},assignment:{},comment:""},p={},l="",f={};return new Promise(function(m,h){try{r.subprocesses.filter(function(e){e._id==app.SCOPE.processUUID&&(u=e)}),r.config.processes.filter(function(s){s._id==e&&s.subProcesses.filter(function(e){e._id==t&&(p=e,e.steps.filter(function(e){e._id==n&&(f=e)}))})}),d.id=n,d.seq=o;var g="";void 0!=f.setInstanceStatusTo.NotStarted?g="NotStarted":void 0!=f.setInstanceStatusTo.Created?g="Created":void 0!=f.setInstanceStatusTo.InProgress?g="InProgress":void 0!=f.setInstanceStatusTo.Submitted?g="Submitted":void 0!=f.setInstanceStatusTo.Complete&&(g="Complete");var v=service.getLanguage();d.status=g,d.message=f.setInstanceStatusTo[g].label.i18n[v],d.comment=void 0!==a.comment?a.comment:"";var S=void 0!==u?u.indicators:[],I=function(e,s){var t=d.assignedTo;if(e.length>0)for(var i=0;i<e.length;i++){var n=e[i],o=n.instances[0].uuid,a=JSON.xpath("/indicators[_id eq '"+o+"']",s,{})[0];n.instances[0].seq=a.model.pending.seq;for(var r=0;r<a.workflows.length;r++)void 0!=a.workflows[r].processes[0]&&void 0!=a.workflows[r].processes[0].subProcessUUID&&void 0!=a.workflows[r].processes[0].step&&c==a.workflows[r].processes[0].subProcessUUID&&(a.workflows[r].processes[0].step.assignedTo=t)}},N=function(e){JSON.xpath("/subprocesses[_id eq '"+e+"']",r,{})[0].spStatus=""};indicatorDocs(e,S,d,r,c).then(function(o){l=c,void 0!=f.function.actions?actions(f.function.actions,e,s,t,i,p,d,r,a,c).then(function(o){var u=d.assignedTo;u.name=LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,u.userId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"",u.dateTime=moment().format(),u.type=ASSIGNMENT_TYPE_AUTO,u.dueDateTime="",u.by=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"",I(S,r);var p=f.transition[0]._id;transition(e,s,t,i,n,p,a,r,c,d).then(function(e){var s=util.success("Transition completed successfully.",e.data.step);m(s)},function(e){h(e)})},function(e){console.log(e),h(e)}):void 0!=f.function.task?task(e,s,f.function.task,c,d).then(function(e){I(S,r);var s=util.success("Task awaiting user action.",d);m(s)},function(e){h(e)}):void 0!=f.function.server&&(N(c),server(f.function.server,e,s,t,i,p,d,r,a,c).then(function(e){I(S,r);var s=util.success("Server awaiting server response.",d);m(s)},function(e){h(e)}))},function(e){h(e)})}catch(e){h(e)}})}function indicators(e,s,t){var i=[];return new Promise(function(e,n){try{for(var o=JSON.xpath("indicators[fn:count(./workflows/processes[subProcessUUID eq '"+t+"']) gt 0]",s,{}),a=0;a<o.length;a++){var r=o[a],c={id:"",instances:[]},u={uuid:"",title:"",key:"",seq:1,rev:""};c.id=r.category.term,u.uuid=r._id,u.rev=r._rev,u.title=r.title,u.key="",u.seq=r.model.pending.seq,c.instances.push(u),i.push(c)}e(util.success("Process indicator model updated.",i))}catch(e){n(e)}})}function assignUser(e,s,t,i,n,o,a){return new Promise(function(s,t){try{a.subprocesses.filter(function(t){if(t._id==o){void 0==t.step.assignmentHistory&&(t.step.assignmentHistory=[]),""!=t.step.assignedTo.userId&&""!=t.step.assignedTo.name&&t.step.assignmentHistory.push(JSON.parse(JSON.stringify(t.step.assignedTo))),t.step.assignedTo.userId=n.id,t.step.assignedTo.name=n.name,t.step.assignedTo.dateTime=moment().format(),t.step.assignedTo.type=ASSIGNMENT_TYPE_REASSIGNMENT,t.step.assignedTo.dueDateTime="",t.step.assignedTo.by=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"";for(var i=t.indicators,r=0;r<i.length;r++)for(var c=i[r],u=0;u<c.instances.length;u++)for(var d=c.instances[u],p=0;p<a.indicators.length;p++){var l=a.indicators[p];d.uuid==l._id&&l.workflows.filter(function(s){s.processes.filter(function(s){s.id==e&&(s.step.assignedTo.userId=n.id,s.step.assignedTo.name=n.name)})})}var f=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=f&&void 0!=f.reAssignment)actionsModule.notification.reAssignmentNotification(f,a,o,n).then(function(e){var e=util.success('User assigned successfully. UserId: "'+n.id+'", Name: "'+n.name+'"',t);s(e)}).catch(function(e){s(e)});else{var m=util.success('User assigned successfully. UserId: "'+n.id+'", Name: "'+n.name+'"',t);s(m)}}})}catch(e){t(e)}})}function indicatorDocs(e,s,t,i,n){return new Promise(function(e,o){try{if(void 0==s){util.error("WFIndicatorsUpdate","Indicators parameter is required. - Value: "+s);o(err)}else{for(var a=0;a<s.length;a++)for(var r=s[a],c=0;c<r.instances.length;c++)for(var u=r.instances[c],d=0;d<i.indicators.length;d++){var p=i.indicators[d];u.uuid==p._id&&p.workflows.filter(function(e){e.processes.filter(function(e){e.subProcessUUID==n&&(e.step.id=t.id,e.step.seq=t.seq,e.step.status=t.status,e.step.message=t.message,e.step.assignedTo.userId=t.assignedTo.userId,e.step.assignedTo.name=t.assignedTo.name,e.step.comment=void 0!==t.comment?t.comment:"")})})}e(util.success("Indicator documents workflow process model updated.",i))}}catch(e){o(e)}})}function actions(e,s,t,i,n,o,a,r,c,u){var d=[];return new Promise(function(p,l){util.syncLoop(e.length,function(p){var f=p.iteration();action(e[f],s,t,i,n,o,a,r,c,u).then(function(s){var t={id:e[f]._id,seq:f,data:s};d.push(t),p.next()},function(e){p.break(),l(e)})},function(){var e=util.success("Actions completed successfully.",d);p(e)})})}function action(e,s,t,i,n,o,a,r,c,u){return new Promise(function(i,d){if(void 0!=e.method){var p=["form","indicator","profile","subProcessInstance","step","community","application","user","sdo","performance","taxonomy","variables","notification","report","worker","participants","generalFunctions"];switch(propertyExists(e.method,p)){case"form":if(void 0!=e.method.form.create){var l=[];l.push(s),l.push(o),l.push(a),l.push(e),l.push(t),l.push(n),l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.create(l).then(function(e){i(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.authorise){var l=[];l.push(s),l.push(o),l.push(t),l.push(n),l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.authorise(l).then(function(e){i(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.undraft){var l=[];l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.setUnDraft(l).then(function(e){i(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.draft){var l=[];l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.setDraft(l).then(function(e){i(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.close){var l=[];l.push(o.indicators),l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.close(l).then(function(e){i(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.authoriseAndCreateNewSeq){var l=[];l.push(s),l.push(o),l.push(t),l.push(n),l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.authorise(l).then(function(p){var l=[];l.push(s),l.push(o),l.push(a),l.push(e),l.push(t),l.push(n),l.push(r),l.push(c.createType),l.push(u),l.push(u),l.push(c),form.create(l).then(function(e){i(e.data)},function(e){d(e)})},function(e){d(e)})}else if(void 0!=e.method.form.createNewSeq){var l=[];l.push(s),l.push(o),l.push(a),l.push(e),l.push(t),l.push(n),l.push(r),l.push(c.createType),l.push(u),l.push(u),l.push(c),form.create(l).then(function(e){i(e.data)},function(e){d(e)})}break;case"indicator":if(void 0!=e.method.indicator.create)i("Not implemented");else if(void 0!=e.method.indicator.instantiate)i("Not implemented");else if(void 0!=e.method.indicator.setValue){var f=e.method.indicator.setValue.path;helper.getNodeValue(e.method.indicator.setValue.data,r,u).then(function(e){var s=[];s.push(r),s.push(u),s.push(f),s.push(e),form.updateIndicator(s).then(function(e){i(e.data)},function(e){d(e)})},function(e){d(e)})}else if(void 0!=e.method.indicator.updateStatus){var m=e.method.indicator.indicatorSetId,l=[];if(l.push(r),l.push(u),void 0!=e.method.indicator.updateStatus){var h=e.method.indicator.updateStatus;l.push(h),l.push(m),form.markUpdateIndicator(l).then(function(e){i(e.data)},function(e){d(e)})}else i("Action indicator sub type not found.")}else if(void 0!=e.method.indicator.setWrapperElement){var f=e.method.indicator.setWrapperElement.path,m=e.method.indicator.setWrapperElement.indicatorSetId;helper.getNodeValue(e.method.indicator.setWrapperElement.data,r,u).then(function(e){var s=[];s.push(r),s.push(u),s.push(f),s.push(e),s.push(m),form.updateIndicatorWrapper(s).then(function(e){i(e.data)},function(e){d(e)})},function(e){d(e)})}break;case"profile":if(void 0!=e.method.profile.create){var l=[];l.push(s),l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.createProfile(l).then(function(e){i(e.data)},function(e){d(e)})}else if(void 0!=e.method.profile.setStatusTo){var l=[],h=e.method.profile.setStatusTo;l.push(r),l.push(u),l.push(h),form.setStatus(l).then(function(e){i(e.data)},function(e){d(e)})}break;case"subProcessInstance":var g=["instantiate","authorise","close","setVariable","setStatusTo","setStatusMsgTo","setTitle","setValidDate","setSPStatus"];switch(propertyExists(e.method.subProcessInstance,g)){case"setTitle":helper.getNodeValue(e.method.subProcessInstance.setTitle,r,u).then(function(s){actionsModule.subProcessInstance.setTitle(e.method.subProcessInstance.setTitle,u,s,r).then(function(e){i(e.data)},function(e){d(e)})},function(e){d(e)});break;case"setValidDate":helper.getNodeValue(e.method.subProcessInstance.setValidDate,r,u).then(function(s){actionsModule.subProcessInstance.setValidDate(e.method.subProcessInstance.setValidDate,u,s,r).then(function(e){i(e.data)},function(e){d(e)})},function(e){d(e)});break;case"setSPStatus":helper.getNodeValue(e.method.subProcessInstance.setSPStatus,r,u).then(function(s){actionsModule.subProcessInstance.setSPStatus(e.method.subProcessInstance.setSPStatus,u,s,r).then(function(e){i(e.data)},function(e){d(e)})},function(e){d(e)});break;default:d("No method found from implemented list in subprocess action.")}break;case"step":break;case"community":var v=["createCommunity","releaseAdoptedApplication","userJoinCommunity"];switch(propertyExists(e.method.community,v)){case"createCommunity":return actionsModule.community.createCommunity(e.method.community.createCommunity,u,r).then(function(e){i(e.data)},function(e){d(e)});case"releaseAdoptedApplication":return actionsModule.community.releaseAdoptedApplication(e.method.community.releaseAdoptedApplication,u,r).then(function(e){i(e.data)},function(e){d(e)});case"userJoinCommunity":return actionsModule.community.userJoinCommunity(e.method.community.userJoinCommunity,u,r).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"application":var S=["createAppDefinition","buildApplication","applicationAdoption"];switch(propertyExists(e.method.application,S)){case"createAppDefinition":return actionsModule.application.createAppDefinition(e.method.application.createAppDefinition,u,r).then(function(e){i(e.data)},function(e){d(e)});case"buildApplication":return actionsModule.application.buildApplication(e.method.application.buildApplication,u,r).then(function(e){i(e.data)},function(e){d(e)});case"applicationAdoption":return actionsModule.application.applicationAdoption(e.method.application.applicationAdoption,u,r).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"user":var I=["addToRole"];switch(propertyExists(e.method.user,I)){case"addToRole":return actionsModule.user.addToRole(e.method.user.addToRole,u,r).then(function(e){i(e.data)},function(e){d(e)})}break;case"sdo":var N=["create","enrollCourse"];switch(propertyExists(e.method.sdo,N)){case"create":return actionsModule.sdo.create(e.method.sdo.create,u,r).then(function(e){i(e.data)},function(e){d(e)});case"enrollCourse":return actionsModule.sdo.enrollCourse(e.method.sdo.enrollCourse,u,r).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"performance":var b=["unlockPeriod","lockPerformanceModel","setModelStatus"];switch(propertyExists(e.method.performance,b)){case"unlockPeriod":return actionsModule.performance.unlockPeriod(e.method.performance.unlockPeriod,u,r).then(function(e){i(e.data)},function(e){d(e)});case"setModelStatus":return actionsModule.performance.setModelStatus(e.method.performance.setModelStatus,u,r).then(function(e){i(e.data)},function(e){d(e)});case"lockPerformanceModel":return actionsModule.performance.lockPerformanceModel(e.method.performance.lockPerformanceModel,u,r).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"taxonomy":var y=["create"];switch(propertyExists(e.method.taxonomy,y)){case"create":return actionsModule.taxonomy.create(e.method.taxonomy.create,u,r).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"variables":var T=["setVariable"];switch(propertyExists(e.method.variables,T)){case"setVariable":return actionsModule.variables.setVariable(e.method.variables.setVariable,r,u).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"notification":return actionsModule.notification.sendNotificationWorker(e.method.notification,r,u).then(function(e){i(e.data)},function(e){d(e)});case"report":var P=["createPerformanceReport","createReport","sdoReport","executeReport","requestReport","generateView","generateBasicView","generateUnionView","sdoReportMultiple","subprofileQuarterlyReport"];switch(propertyExists(e.method.report,P)){case"createPerformanceReport":return actionsModule.report.createPerformanceReport(e.method.report.createPerformanceReport,r,u).then(function(e){i(e.data)},function(e){d(e)});case"createReport":return actionsModule.report.createReport(e.method.report.createReport,r,u).then(function(e){i(e.data)},function(e){d(e)});case"sdoReport":return actionsModule.report.sdoReport(e.method.report.sdoReport,r,u).then(function(e){i(e.data)},function(e){d(e)});case"executeReport":return actionsModule.report.executeReport(e.method.report.executeReport,r,u).then(function(e){i(e.data)},function(e){d(e)});case"generateView":return actionsModule.report.generateView(e.method.report.generateView,r,u).then(function(e){i(e.data)},function(e){d(e)});case"requestReport":return actionsModule.report.requestReport(e.method.report.requestReport,r,u).then(function(e){i(e.data)},function(e){d(e)});case"generateBasicView":return actionsModule.report.generateBasicView(e.method.report.generateBasicView,r,u).then(function(e){i(e.data)},function(e){d(e)});case"generateUnionView":return actionsModule.report.generateUnionView(e.method.report.generateUnionView,r,u).then(function(e){i(e.data)},function(e){d(e)});case"sdoReportMultiple":return actionsModule.report.sdoReportMultiple(e.method.report.sdoReportMultiple,r,u).then(function(e){i(e.data)},function(e){d(e)});case"subprofileQuarterlyReport":return actionsModule.report.subprofileQuarterlyReport(e.method.report.subprofileQuarterlyReport,r,u).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"worker":var O=["sendWorker","executeLocal","create"];switch(propertyExists(e.method.worker,O)){case"sendWorker":return actionsModule.worker.sendWorker(e.method.worker.sendWorker,r,u).then(function(e){i(e.data)},function(e){d(e)});case"executeLocal":return actionsModule.worker.executeLocal(e.method.worker.executeLocal,r,u).then(function(e){i(e.data)},function(e){d(e)});case"create":return actionsModule.worker.create(e.method.worker.create,r,u).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"participants":var _=["linkParticipants","monthlyAttendance","monthlyProgressSummary","participantContracts"];switch(propertyExists(e.method.participants,_)){case"linkParticipants":return actionsModule.participants.linkParticipants(e.method.participants.linkParticipants,r,u).then(function(e){i(e.data)},function(e){d(e)});case"monthlyAttendance":return actionsModule.participants.monthlyAttendance(e.method.participants.monthlyAttendance,r,u).then(function(e){i(e.data)},function(e){d(e)});case"monthlyProgressSummary":return actionsModule.participants.monthlyProgressSummary(e.method.participants.monthlyProgressSummary,r,u).then(function(e){i(e.data)},function(e){d(e)});case"participantContracts":return actionsModule.participants.participantContracts(e.method.participants.participantContracts,r,u).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"generalFunctions":var q=["addToFavourites","addToUserFavourites"];switch(propertyExists(e.method.generalFunctions,q)){case"addToFavourites":return actionsModule.generalFunctions.addToFavourites(e.method.generalFunctions.addToFavourites,r,u).then(function(e){i(e.data)},function(e){d(e)});case"addToUserFavourites":return actionsModule.generalFunctions.addToUserFavourites(e.method.generalFunctions.addToUserFavourites,r,u).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;default:d("method not defined in configuration")}}else d("No method found from implemented list.")})}function task(e,s,t,i,n){return new Promise(function(s,o){var a=app.SCOPE.workflow;preActions(t.preActions,a,i).then(function(r){var c=[];if(void 0!=t.assign.role){var u=a.profile,d="",p=function(){var r=t.assign.role.roleId;library.getUsersFromProfileRole(d,r).then(function(o){if(void 0!=o)if(o.length>1){for(var r=!1,c=0;c<o.length;c++)o[c].id,LOCAL_SETTINGS.SUBSCRIPTIONS.userId==o[c].id&&(r=!0);if(r){void 0==n.assignmentHistory&&(n.assignmentHistory=[]);var u=n.assignedTo;if(""!=u.userId&&""!=u.name){var p=JSON.parse(JSON.stringify(u));n.assignmentHistory.push(p)}u.name=LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,u.userId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"",u.dateTime=moment().format(),u.type=ASSIGNMENT_TYPE_AUTO,u.dueDateTime="",u.by=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"";var l=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=l&&void 0!=l.assignment){var f={id:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,name:LOCAL_SETTINGS.SUBSCRIPTIONS.username};actionsModule.notification.assignmentNotification(l,a,i,f).then(function(e){console.log('User assigned successfully. UserId: "'+f.id+'", Name: "'+f.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+f.id+'", Name: "'+f.name+'"')})}}var m="";if(void 0!=t.assign.assignment){var m=n.assignment,h={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};m.accept=h,m.message=_getNameByLang(t.assign.assignment.message.i18n);var g={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};m.reject=g;var v={profileId:d,type:"user",userId:o};m.value=v,m.profileRoleId=d}if(r){var S=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+i+"']/id",a,{})[0],I=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+i+"']/id",a,{})[0],N=JSON.xpath("/subprocesses[_id eq '"+i+"']/step/id",a,{})[0];if(JSON.xpath("/processes[_id eq '"+S+"']/subProcesses[_id eq '"+I+"']/steps[_id eq '"+N+"']",a.config,{})[0],void 0!=t.preWorkActions){var b=t.preWorkActions;preWorkActions(b,a).then(function(e){s("Assignment is made. Pre work actions found and executed ")},function(e){g(e)})}else s("Assignment is made. No pre work actions found. ")}else{var l=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=l&&void 0!=l.assignmentAcceptance){var f={id:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,name:LOCAL_SETTINGS.SUBSCRIPTIONS.username};actionsModule.notification.acceptanceNotificationExternal(l,a,i,o).then(function(e){s("Notifications request submitted for acceptance.")}).catch(function(e){s("Notifications failed"),console.log('User assignment notification failed to user UserId: "'+f.id+'", Name: "'+f.name+'"')})}else s("Notifications not found")}}else if(1==o.length){var y=o[0].id,T=o[0].name;void 0==n.assignmentHistory&&(n.assignmentHistory=[]);var u=n.assignedTo;if(""!=u.userId&&""!=u.name){var p=JSON.parse(JSON.stringify(u));n.assignmentHistory.push(p)}u.name=T+"",u.userId=y+"",u.dateTime=moment().format(),u.type=ASSIGNMENT_TYPE_AUTO,u.dueDateTime="",u.by=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"";var m="";if(void 0!=t.assign.assignment){var m=n.assignment,h={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};m.accept=h,m.message=_getNameByLang(t.assign.assignment.message.i18n);var g={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};m.reject=g;var v={profileId:d,userId:o,type:"user"};m.value=v,m.profileRoleId=d}var l=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=l&&void 0!=l.assignment){var f={id:y,name:T};actionsModule.notification.assignmentNotification(l,a,i,f).then(function(e){console.log('User assigned successfully. UserId: "'+f.id+'", Name: "'+f.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+f.id+'", Name: "'+f.name+'"')})}var S=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+i+"']/id",a,{})[0],I=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+i+"']/id",a,{})[0],N=JSON.xpath("/subprocesses[_id eq '"+i+"']/step/id",a,{})[0];if(JSON.xpath("/processes[_id eq '"+S+"']/subProcesses[_id eq '"+I+"']/steps[_id eq '"+N+"']",a.config,{})[0],void 0!=t.preWorkActions){var b=t.preWorkActions;preWorkActions(b,a).then(function(e){s("Assigned to the only user in role. Pre work actions executed")},function(e){g(e)})}else s("Assigned to the only user in role. No pre work actions found.")}else{var u=n.assignedTo;u.name="",u.userId="";var m="";if(void 0!=t.assign.assignment){var m=n.assignment,h={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};m.accept=h,m.message=_getNameByLang(t.assign.assignment.message.i18n);var g={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};m.reject=g;var v={profileId:d,userId:o,type:"user"};m.value=v,m.profileRoleId=d}s("No users found in list. Assigning blank ")}else g("Error in getUsersFromProfileRole ")}).catch(function(e){o(e)})};void 0!=t.assign.role.profile?("current"==t.assign.role.profile?d=a.profile:"community"==t.assign.role.profile&&(d=app.SCOPE.getCommunityId()),function(){var r=t.assign.role.roleId;library.getUsersListByRole(d,r).then(function(o){if(void 0!=o)if(o.length>1){var c=!1,p=library.getCurrentUserRoles(),l=p.profile.indexOf(r),f=p.community.indexOf(r),m=p.implicit.indexOf(r),h=p.adoption.indexOf(r),g=p.subprofile.indexOf(r);if(c=l>-1||f>-1||m>-1||h>-1||g>-1){void 0==n.assignmentHistory&&(n.assignmentHistory=[]);var v=n.assignedTo;if(""!=v.userId&&""!=v.name){var S=JSON.parse(JSON.stringify(v));n.assignmentHistory.push(S)}v.name=LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,v.userId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"",v.dateTime=moment().format(),v.type=ASSIGNMENT_TYPE_AUTO,v.dueDateTime="",v.by=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"";var I=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=I&&void 0!=I.assignment){var N={
id:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,name:LOCAL_SETTINGS.SUBSCRIPTIONS.username};actionsModule.notification.assignmentNotification(I,a,i,N).then(function(e){console.log('User assigned successfully. UserId: "'+N.id+'", Name: "'+N.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}}var b="";if(void 0!=t.assign.assignment){var b=n.assignment,y={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};b.accept=y,b.message=_getNameByLang(t.assign.assignment.message.i18n);var T={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};b.reject=T;var P={profileId:u,roleId:r,type:"role"};b.value=P,b.profileRoleId=d}if(c){var O=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+i+"']/id",a,{})[0],_=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+i+"']/id",a,{})[0],q=JSON.xpath("/subprocesses[_id eq '"+i+"']/step/id",a,{})[0];if(JSON.xpath("/processes[_id eq '"+O+"']/subProcesses[_id eq '"+_+"']/steps[_id eq '"+q+"']",a.config,{})[0],void 0!=t.preWorkActions){var A=t.preWorkActions;preWorkActions(A,a).then(function(e){s("Assignment is made. Pre work actions found and executed ")},function(e){T(e)})}else s("Assignment is made. No pre work actions found. ")}else{var I=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=I&&void 0!=I.assignmentAcceptance){var N={id:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,name:LOCAL_SETTINGS.SUBSCRIPTIONS.username};actionsModule.notification.acceptanceNotification(I,a,i,r).then(function(e){s("Notifications request submitted for acceptance.")}).catch(function(e){s("Notifications failed"),console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}else s("Notifications not found")}}else if(1==o.length){var k=o[0].id,E=o[0].name;void 0==n.assignmentHistory&&(n.assignmentHistory=[]);var v=n.assignedTo;if(""!=v.userId&&""!=v.name){var S=JSON.parse(JSON.stringify(v));n.assignmentHistory.push(S)}v.name=E+"",v.userId=k+"",v.dateTime=moment().format(),v.type=ASSIGNMENT_TYPE_AUTO,v.dueDateTime="",v.by=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"";var b="";if(void 0!=t.assign.assignment){var b=n.assignment,y={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};b.accept=y,b.message=_getNameByLang(t.assign.assignment.message.i18n);var T={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};b.reject=T;var P={profileId:u,roleId:r,type:"role"};b.value=P,b.profileRoleId=d}var I=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=I&&void 0!=I.assignment){var N={id:k,name:E};actionsModule.notification.assignmentNotification(I,a,i,N).then(function(e){console.log('User assigned successfully. UserId: "'+N.id+'", Name: "'+N.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}var O=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+i+"']/id",a,{})[0],_=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+i+"']/id",a,{})[0],q=JSON.xpath("/subprocesses[_id eq '"+i+"']/step/id",a,{})[0];if(JSON.xpath("/processes[_id eq '"+O+"']/subProcesses[_id eq '"+_+"']/steps[_id eq '"+q+"']",a.config,{})[0],void 0!=t.preWorkActions){var A=t.preWorkActions;preWorkActions(A,a).then(function(e){s("Assigned to the only user in role. Pre work actions executed")},function(e){T(e)})}else s("Assigned to the only user in role. No pre work actions found.")}else{var v=n.assignedTo;v.name="",v.userId="";var b="";if(void 0!=t.assign.assignment){var b=n.assignment,y={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};b.accept=y,b.message=_getNameByLang(t.assign.assignment.message.i18n);var T={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};b.reject=T;var P={profileId:u,roleId:r,type:"role"};b.value=P,b.profileRoleId=d}s("No users found in list. Assigning blank ")}else T(err)},function(e){o(e)})}()):void 0!=t.assign.role.profileId&&helper.getNodeValue(t.assign.role.profileId,a,i).then(function(e){d=e,p()}).catch(function(e){o(e)})}else if(void 0!=t.assign.user)helper.getNodeValue(t.assign.user.userName,a,i).then(function(r){helper.getNodeValue(t.assign.user.userId,a,i).then(function(o){var o=o,u=r,p=a.profile;void 0==n.assignmentHistory&&(n.assignmentHistory=[]);var l=n.assignedTo;if(""!=l.userId&&""!=l.name){var f=JSON.parse(JSON.stringify(l));n.assignmentHistory.push(f)}l.name=u+"",l.userId=o+"",l.dateTime=moment().format(),l.type=ASSIGNMENT_TYPE_AUTO,l.dueDateTime="",l.by=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"";var m="";if(void 0!=t.assign.assignment){var m=n.assignment,h={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};m.accept=h,m.message=_getNameByLang(t.assign.assignment.message.i18n);var g={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)},v={id:o,name:r};c.push(v),m.reject=g;var S={profileId:p,userId:c,type:"user"};m.value=S,m.profileRoleId=d}var I=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=I&&void 0!=I.assignment){var N={id:o,name:u};actionsModule.notification.assignmentNotification(I,a,i,N).then(function(e){console.log('User assigned successfully. UserId: "'+N.id+'", Name: "'+N.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}var b=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+i+"']/id",a,{})[0],y=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+i+"']/id",a,{})[0],T=JSON.xpath("/subprocesses[_id eq '"+i+"']/step/id",a,{})[0];JSON.xpath("/processes[_id eq '"+b+"']/subProcesses[_id eq '"+y+"']/steps[_id eq '"+T+"']",a.config,{})[0],void 0!=t.preWorkActions?preWorkActions(t.preWorkActions,a).then(function(e){s("Assigned to the only user in role. Pre work actions executed")},function(e){g(e)}):s("Assigned to the only user in role. No pre work actions found.")},function(e){o(e)})},function(e){o(e)});else if(void 0!=t.assign.swimlane){var l=t.assign.swimlane.stepId,f=t.assign.swimlane.sequence,m=JSON.xpath("/subprocesses[_id eq '"+i+"']",a,{})[0],h=JSON.xpath("/history[id eq '"+l+"']",m,{}),g="";g="last"==f?JSON.xpath("max(for $s in /* return xs:dateTime($s/dateTimeCreated))",h,{})[0]:JSON.xpath("min(for $s in /* return xs:dateTime($s/dateTimeCreated))",h,{})[0];var v=JSON.xpath("/*[xs:dateTime(dateTimeCreated) eq xs:dateTime('"+g+"')]",h,{})[0],S=JSON.xpath("/assignmentHistory[last()]",v,{})[0],I=S.userId,N=S.name;void 0==n.assignmentHistory&&(n.assignmentHistory=[]);var b=n.assignedTo;if(""!=b.userId&&""!=b.name){var y=JSON.parse(JSON.stringify(b));n.assignmentHistory.push(y)}b.name=N+"",b.userId=I+"",b.dateTime=moment().format(),b.type=ASSIGNMENT_TYPE_SWIMLANE,b.dueDateTime="",b.by=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"";var T=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=T&&void 0!=T.assignment){var P={id:I,name:N};actionsModule.notification.assignmentNotification(T,a,i,P).then(function(e){console.log('User assigned successfully. UserId: "'+P.id+'", Name: "'+P.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+P.id+'", Name: "'+P.name+'"')})}var O=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+i+"']/id",a,{})[0],_=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+i+"']/id",a,{})[0],l=JSON.xpath("/subprocesses[_id eq '"+i+"']/step/id",a,{})[0];if(JSON.xpath("/processes[_id eq '"+O+"']/subProcesses[_id eq '"+_+"']/steps[_id eq '"+l+"']",a.config,{})[0],void 0!=t.preWorkActions){var q=t.preWorkActions;preWorkActions(q,a).then(function(e){s("Assigned to the only user in role. Pre work actions executed")},function(e){o(e)})}else s("Assigned to the only user in role. No pre work actions found.")}},function(e){o(e)})})}function server(e,s,t,i,n,o,a,r,c,u){return new Promise(function(d,p){var l=(r.profile,e.serverAction[0]);void 0==a.assignmentHistory&&(a.assignmentHistory=[]);var f=a.assignedTo;if(""!=f.userId&&""!=f.name){var m=JSON.parse(JSON.stringify(f));a.assignmentHistory.push(m)}f.name=LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,f.userId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"",f.dateTime=moment().format(),f.type=ASSIGNMENT_TYPE_AUTO,f.dueDateTime="",f.by=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"",action(l,s,t,i,n,o,a,r,c,u).then(function(e){d("No users found in list. Assigning blank ")},function(e){p("Server action error found rejected")})})}function transition(e,s,t,i,n,o,a,r,c,u){return new Promise(function(d,p){try{for(var l=0,f="",m=0,h=r.config.processes.filter(function(s){if(s._id==e)return s}),g=h[0].subProcesses.filter(function(e){if(e._id==t)return e}),v=g[0].steps.filter(function(e){if(e._id==n)return e}),S=v[0].transition.filter(function(e){if(e._id==o)return e}),I=0;I<g[0].steps.length;I++)g[0].steps[I]._id==n&&(l=parseInt(g[0].steps[I]._seq));g[0].steps.filter(function(e){m=l+1,parseInt(e._seq)==m&&(f=e._id)});var N=g[0].steps.length,b=JSON.xpath("/subprocesses[_id eq '"+c+"']",r,{})[0],y=JSON.xpath("/subprocesses[_id eq '"+c+"']/step",r,{})[0];void 0==b.history&&(b.history=[]);var T={transitionId:S[0]._id,dateTime:moment().format(),userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userId+""};if(void 0!=u&&Object.keys(u).length>0?u.transition=T:y.transition=T,void 0!=u&&Object.keys(u).length>0){void 0==u.assignmentHistory&&(u.assignmentHistory=[]);var P=JSON.parse(JSON.stringify(u.assignedTo));""!=P.userId&&""!=P.name&&u.assignmentHistory.push(P)}else{void 0==y.assignmentHistory&&(y.assignmentHistory=[]);var P=JSON.parse(JSON.stringify(y.assignedTo));""!=P.userId&&""!=P.name&&y.assignmentHistory.push(P)}var O;O=void 0!=u&&Object.keys(u).length>0?JSON.parse(JSON.stringify(u)):JSON.parse(JSON.stringify(y));var _=function(e){var s=JSON.xpath("/subprocesses[_id eq '"+c+"']/indicators",r,{}),t=!1;void 0!=s&&0!=s.length||(t=!0,s=JSON.xpath("/indicators[workflows/processes[subProcessUUID eq '"+c+"']]",r,{})),void 0==e.indicators&&(e.indicators=[]);for(var i=0;i<s.length;i++)if(t){var n=s[i]._id,o=JSON.xpath("/indicators[_id eq '"+n+"']/_rev",r,{})[0],a=s[i].model.pending.seq,u=s[i].model.pending.status,d={uuid:n,rev:o,seq:a,status:u};e.indicators.push(d)}else{var n=s[i].instances[0].uuid,o=JSON.xpath("/indicators[_id eq '"+n+"']/_rev",r,{})[0],a=JSON.xpath("/indicators[_id eq '"+n+"']/model/pending/seq",r,{})[0],u=JSON.xpath("/indicators[_id eq '"+n+"']/model/pending/status",r,{})[0],d={uuid:n,rev:o,seq:a,status:u};e.indicators.push(d)}return delete e.assignedTo,delete e.assignment,e}(O);if(b.history.push(_),void 0!=S[0].transitionAction.goToStep){var q=parseInt(v[0]._seq)+parseInt(S[0].transitionAction.goToStep.default),A="";g[0].steps.filter(function(e){parseInt(e._seq)==m&&(A=e._id)}),step(e,s,t,i,A,q,a,r,c).then(function(e){if(q==N){var s=util.success("All Step transitions have completed successfully.",{subProcessComplete:!0,step:e.data});d(s)}else{var s=util.success("Step transition completed successfully.",{subProcessComplete:!1,step:e.data});d(s)}},function(e){p(e)})}else if(void 0!=S[0].transitionAction.goToStepId){var k=S[0].transitionAction.goToStepId.stepId,E=1;g[0].steps.filter(function(e){e._id==k&&(E=parseInt(e._seq))}),step(e,s,t,i,k,E,a,r,c).then(function(e){if(E==N||"Complete"==e.data.status){var s=util.success("All Step transitions have completed successfully.",{subProcessComplete:!0,step:e.data});d(s)}else{var s=util.success("Step transition completed successfully.",{subProcessComplete:!1,step:e.data});d(s)}},function(e){p(e)})}else if(void 0!=S[0].transitionAction.stop){var w=h[0].postActions;postActions(w,r,c).then(function(e){var s=util.success("Step transition completed successfully.Workflow stopped.",{subProcessComplete:!0,step:u});d(s)},function(e){p(e)})}}catch(e){p(e)}})}function postActions(e,s,t){return new Promise(function(i,n){var o=[];try{var a=JSON.xpath("/subprocesses[_id eq '"+t+"']",s,{})[0],r=a["meta-data"].processConfigId,c=a["meta-data"].subProcessConfigId,u=a["meta-data"].subProcessInsSeq,d=a["meta-data"].subProcessInsSeq,p=JSON.xpath("/config/processes[_id eq '"+r+"']/subProcesses[_id eq '"+c+"']",s,{})[0],l=JSON.xpath("/subprocesses[_id eq '"+t+"']/step",s,{})[0];util.syncLoop(e.length,function(i){var a=i.iteration();action(e[a],r,u,c,d,p,l,s,{},t).then(function(e){o.push(!0),i.next()},function(e){o.push(!1),i.break(),n(e)})},function(){if(o.every(Boolean)){var e=util.success("Post-actions completed successfully.",{});i(e)}else{var s=util.error("WFPreActionsError","Not all post-actions passed.");n(s)}})}catch(e){n(e)}})}function processWorkflowMessage(e,s){var t=e;if(-1!==t.indexOf("#INSTANCE_LABEL")){var i=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+s+"']/label",app.SCOPE.workflow,{})[0];t=t.replace("#INSTANCE_LABEL",i)}if(-1!==t.indexOf("#USER_NAME")){var i=JSON.xpath("/subprocesses[_id eq '"+s+"']/step/assignedTo/name",app.SCOPE.workflow,{})[0];t=t.replace("#USER_NAME",i)}if(-1!==t.indexOf("#PROFILE_TITLE")){var i=app.profile.title;t=t.replace("#PROFILE_TITLE",i)}if(-1!==t.indexOf("#PROFILE_TYPE")){var i=app.SCOPE.APP_CONFIG.name;t=t.replace("#PROFILE_TYPE",i)}if(-1!==t.indexOf("#VAR_SPUUID")){var i=s;t=t.replace("#VAR_SPUUID",i)}return t}function _getName(e,s){if(void 0!==e)for(var t=0;t<e.length;t++)if(e[t]._lang===s)return e[t].value}function _getNameByLang(e){return library.getNameByLang(e)}function preWorkActions(e,s){return new Promise(function(t,i){var n=[];try{var o=JSON.xpath("/config/processes[_id eq '"+app.SCOPE.spo.pObject.id+"']/subProcesses[_id eq '"+app.SCOPE.spo.spObject.id+"']",s,{})[0],a=JSON.xpath("/subprocesses[_id eq '"+app.SCOPE.processUUID+"']/step",s,{})[0];util.syncLoop(e.length,function(t){var r=t.iteration();action(e[r],app.SCOPE.spo.pObject.id,app.SCOPE.spo.pObject.seq,app.SCOPE.spo.spObject.id,app.SCOPE.spo.spObject.seq,o,a,s,{},app.SCOPE.processUUID).then(function(e){n.push(!0),t.next()},function(e){n.push(!1),t.break(),i(e)})},function(){if(n.every(Boolean)){var e=util.success("PreWork-actions completed successfully.",{});t(e)}else{var s=util.error("WFPreActionsError","Not all pre-work-actions passed.");i(s)}})}catch(e){i(e)}})}var util=require("utility"),actionsModule=require("./actions"),helper=require("./helper"),form=require("./form");module.exports={preRequisites:preRequisites,preActions:preActions,postActions:postActions,preWorkActions:preWorkActions,subProcess:subProcess,indicatorDocs:indicatorDocs,task:task,transition:transition,assignUser:assignUser};

},{"./actions":2,"./form":3,"./helper":4,"utility":8}],8:[function(require,module,exports){
"use strict";function success(r,e){return{message:r,data:e}}function warn(r,e){return console.warn(e),{warning:r,data:e}}function error(r,e){var n=new Error("");return n.name=r,n.message=e,n}function syncLoop(r,e,n){var a=0,t=!1,o=!1,u={next:function(){if(t&&o&&n)return n();a<r?(a++,e(u)):(t=!0,n&&n())},iteration:function(){return a-1},break:function(r){t=!0,o=r}};return u.next(),u}function compare(r,e,n){switch(e){case"greaterThan":return r>n;case"lessThan":return r<n;case"greaterThanEqual":return r>=n;case"lessThanEqual":return r<=n;case"equalTo":return r===n;case"notEqualTo":return r!==n}}function getName(r,e){if(void 0!==r)for(var n=0;n<r.length;n++)if(r[n].i18n._lang===e)return r[n].i18n.value}module.exports={success:success,warn:warn,error:error,syncLoop:syncLoop,compare:compare,getName:getName};

},{}]},{},[1])(1)
});

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Vzci9sb2NhbC9saWIvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsImluZGV4LmpzIiwibGliL2FjdGlvbnMuanMiLCJsaWIvZm9ybS5qcyIsImxpYi9oZWxwZXIuanMiLCJsaWIvaW50ZXJmYWNlLmpzIiwibGliL25vZGVWYWx1ZS5qcyIsImxpYi9wcm9jZXNzLmpzIiwibm9kZV9tb2R1bGVzL3V0aWxpdHkvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQSxZQThDQSxTQUFTLFVBQVMsRUFBUyxFQUFhLEVBQUssR0FDekMsR0FBSSxHQUFRLElBR1osSUFBbUIsSUFBZixPQUFvQyxJQUFmLEVBQ3JCLEtBQU0sTUFBSyxNQUFNLGdCQUFpQiw4QkFDL0IsSUFBNEIsZ0JBQWxCLEdBQ2IsS0FBTSxJQUFJLE9BQU0sZ0RBTXBCLElBSkksRUFBTSxZQUFjLEdBQWUsR0FJeEIsSUFBWCxPQUE0QixJQUFYLEVBQ2pCLEtBQU0sTUFBSyxNQUFNLGdCQUFpQiw0QkFDL0IsSUFBd0IsZ0JBQWQsR0FDYixLQUFNLElBQUksT0FBTSw4Q0FNcEIsSUFKSSxFQUFNLFFBQVUsR0FBVyxHQUlwQixJQUFQLE9BQW9CLElBQVAsRUFDYixLQUFNLE1BQUssTUFBTSxnQkFBaUIseUJBQy9CLElBQW9CLGdCQUFWLEdBQ2IsS0FBTSxJQUFJLE9BQU0sMENBTXBCLElBSkksRUFBTSxJQUFNLEdBQU8sR0FJVCxJQUFWLE9BQTBCLElBQVYsRUFDaEIsS0FBTSxNQUFLLE1BQU0sZ0JBQWlCLHdDQUVsQyxHQUFNLE9BRG9CLGdCQUFiLEdBQ0UsS0FBSyxNQUFNLEdBRVgsRUFJbkIsRUFBTSxTQUVOLEVBQU0sZ0JBRU4sRUFBTSxjQXhGVixHQUFJLFNBQVUsUUFBUSxpQkFDbEIsS0FBTyxRQUFRLFdBQ2YsY0FBZ0IsUUFBUSxtQkFDeEIsT0FBUyxRQUFRLGVBa0dyQixVQUFT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Q3pCLE1BQU8sR0FBSSxHQUFHLEtBQUssTUFNdkIsT0FBTyxTQUVMLFFBQVMsUUFDVCxLQUFNLEtBQ04sTUFBTyxNQUNQLFNBQVUsU0FDVixRQUFTLFFBQ1YsUUFBUyIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIid1c2Ugc3RyaWN0JztcblxudmFyIFByb2Nlc3MgPSByZXF1aXJlKCcuL2xpYi9wcm9jZXNzJyk7XG52YXIgdXRpbCA9IHJlcXVpcmUoJ3V0aWxpdHknKTtcbnZhciB1c2VySW50ZXJmYWNlID0gcmVxdWlyZSgnLi9saWIvaW50ZXJmYWNlJyk7XG52YXIgaGVscGVyID0gcmVxdWlyZSgnLi9saWIvaGVscGVyJyk7XG5cblxuLypnbG9iYWxzICovXG5cbi8qKlxuICogQSBuZXcgV29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2UgY29udGFpbnMgdGhlIHJlZmVyZW5jZSB0byB0aGUgYXBwbGljYXRpb25cbiAqIGFuZCBhc3NvY2lhdGVkIHByb2ZpbGUgd2hpY2ggaXQgcmVxdWlyZXMgYXMgdGhlIGZpcnN0IHR3byBwYXJhbWV0ZXJzLiBJdCBhbHNvXG4gKiByZXF1aXJlcyBhIHdvcmtmbG93IGNvbmZpZ3VyYXRpb24sIGFzIHRoZSB0aGlyZCBwYXJhbWV0ZXIsIHdoaWNoIGlzIHVzZWQgdG9cbiAqIGRlc2NpYmUgdGhlIHdvcmtmbG93IHByb2Nlc3Nlcy4gSWYgYSB3b3JrZmxvdyBpbnN0YW5jZSBleGlzdHMgeW91IGNhbiBwYXNzIGl0XG4gKiBpbiBhcyB0aGUgZm91cnRoIHBhcmFtZXRlciB3aGljaCBpdCB3aWxsIHRoZW4gdXNlLCBlbHNlIGNyZWF0ZSBhIG5ldyBvbmUuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2ZpbGUgLSBUaGUgY3VycmVudCBwcm9maWxlIGlkXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwIC0gVGhlIGFzc29jaWF0ZWQgYXBwbGljYXRpb24gaWRcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgLSBUaGUgYXBwbGljYXRpb24gd29ya2Zsb3cgY29uZmlndXJhdGlvbiAvIGRlZmluaXRpb25cbiAqIEBwYXJhbSB7T2JqZWN0fSBbaW5zdGFuY2VdIC0gQW4gZXhpc3RpbmcgYXBwbGljYXRpb24gcHJvZmlsZSB3b3JrZmxvdyBpbnN0YW5jZSBiYXNlZFxuICogb24gdGhlIGRlZmluaXRpb25cbiAqXG4gKiBAYXV0aG9yIEJyZW50IEdvcmRvblxuICogQHZlcnNpb24gMC4xLjBcbiAqXG4gKiBAZXhhbXBsZVxuICogdmFyIGNvbmZpZyA9IHsgJ19pZCc6ICdhYmMxMjMnIH07XG5cbiAqIHZhciBpbnN0YW5jZSA9IHsgJ19pZCc6ICdpbnN0YW5jZV9hYmMxMjMnIH07XG5cbiAqIC8vIElmIHRoZXJlIGlzbid0IGFuIGV4aXN0aW5nIGluc3RhbmNlXG4gKiB2YXIgd29ya2Zsb3cgPSBuZXcgV29ya2Zsb3coJzEyMzQnLCAnNTY3OCcsIGNvbmZpZyk7XG4gKiAvLyBJZiB0aGVyZSBpcyBhbiBleGlzdGluZyBpbnN0YW5jZVxuICogdmFyIHdvcmtmbG93ID0gbmV3IFdvcmtmbG93KCcxMjM0JywgJzU2NzgnLCBjb25maWcsIGluc3RhbmNlKTtcbiAqXG4gKiBAcmV0dXJuIHtPYmplY3R9IG5ldyBXb3JrZmxvdyBvYmplY3RcbiAqXG4gKiBAdGhyb3dzIEVycm9yOiBBIHByb2ZpbGUgaWQgaXMgcmVxdWlyZWRcbiAqIEB0aHJvd3MgRXJyb3I6IEFuIGFwcCBpZCBpcyByZXF1aXJlZFxuICogQHRocm93cyBFcnJvcjogQSB3b3JrZmxvdyBjb25maWd1cmF0aW9uIGlzIHJlcXVpcmVkXG4gKlxuICovXG5cbmZ1bmN0aW9uIFdvcmtmbG93KHByb2ZpbGUsIGNvbW11bml0eUlkLCBhcHAsIGNvbmZpZykge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAvLyBDb21tdW5pdHkgSUQgdmFsaWRhdGlvbiBjaGVja3NcbiAgICBpZiAoY29tbXVuaXR5SWQgPT0gJycgfHwgY29tbXVuaXR5SWQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IHV0aWwuZXJyb3IoJ1BhcmFtUmVxdWlyZWQnLCAnQSBjb21tdW5pdHkgaWQgaXMgcmVxdWlyZWQuJyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YoY29tbXVuaXR5SWQpICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb21tdW5pdHkgaWQgbXVzdCBiZSBhIGphdmFzY3JpcHQgc3RyaW5nLicpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIF90aGlzLmNvbW11bml0eUlkID0gY29tbXVuaXR5SWQgfHwgJyc7XG4gICAgfVxuXG4gICAgLy8gUHJvZmlsZSBJRCB2YWxpZGF0aW9uIGNoZWNrc1xuICAgIGlmIChwcm9maWxlID09ICcnIHx8IHByb2ZpbGUgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IHV0aWwuZXJyb3IoJ1BhcmFtUmVxdWlyZWQnLCAnQSBwcm9maWxlIGlkIGlzIHJlcXVpcmVkLicpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mKHByb2ZpbGUpICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBwcm9maWxlIGlkIG11c3QgYmUgYSBqYXZhc2NyaXB0IHN0cmluZy4nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBfdGhpcy5wcm9maWxlID0gcHJvZmlsZSB8fCAnJztcbiAgICB9XG5cbiAgICAvLyBBcHAgSUQgdmFsaWRhdGlvbiBjaGVja3NcbiAgICBpZiAoYXBwID09ICcnIHx8IGFwcCA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgdXRpbC5lcnJvcignUGFyYW1SZXF1aXJlZCcsICdBbiBhcHAgaWQgaXMgcmVxdWlyZWQuJyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YoYXBwKSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgYXBwIGlkIG11c3QgYmUgYSBqYXZhc2NyaXB0IHN0cmluZy4nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBfdGhpcy5hcHAgPSBhcHAgfHwgJyc7XG4gICAgfVxuXG4gICAgLy8gV29ya2Zsb3cgY29uZmlndXJhdGlvbiB2YWxpZGF0aW9uIGNoZWNrc1xuICAgIGlmIChjb25maWcgPT0gJycgfHwgY29uZmlnID09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyB1dGlsLmVycm9yKCdQYXJhbVJlcXVpcmVkJywgJ0Egd29ya2Zsb3cgY29uZmlndXJhdGlvbiBpcyByZXF1aXJlZC4nKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZihjb25maWcpICE9PSAnb2JqZWN0Jykge1xuICAgICAgICBfdGhpcy5jb25maWcgPSBKU09OLnBhcnNlKGNvbmZpZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgX3RoaXMuY29uZmlnID0gY29uZmlnO1xuICAgIH1cblxuICAgIC8vIFdvcmtmbG93IGluc3RhbmNlIHZhbGlkYXRpb24gY2hlY2tzXG4gICAgX3RoaXMuaW5zdGFuY2U7XG4gICAgLy8gV29ya2Zsb3cgc3ViLXByb2Nlc3NlcyB2YWxpZGF0aW9uIGNoZWNrc1xuICAgIF90aGlzLnN1YnByb2Nlc3NlcyA9IFtdO1xuICAgIC8vIFdvcmtmbG93IGluZGljYXRvcnMgcGxhY2UgaG9sZGVyXG4gICAgX3RoaXMuaW5kaWNhdG9ycyA9IFtdO1xuXG5cbn1cblxuLyoqXG4gKiBXb3JrZmxvdyBnZXQgcHJvZmlsZSBpZC5cbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuZ2V0UHJvZmlsZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnByb2ZpbGU7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IGdldCBhcHAgaWQuXG4gKlxuICogQGV4YW1wbGUgXCJcIlxuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLmdldEFwcCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmFwcDtcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgZ2V0IGNvbmZpZy5cbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuZ2V0Q29uZmlnID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyBnZXQgaW5zdGFuY2UuXG4gKlxuICogQGV4YW1wbGUgXCJcIlxuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuXG5Xb3JrZmxvdy5wcm90b3R5cGUuZ2V0SW5zdGFuY2UgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5pbnN0YW5jZTtcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgc2V0IHRoZSBpbnN0YW5jZSBkYXRhLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIC0gdGhlIHdvcmtmbG93IHByb2Nlc3MgaW5zdGFuY2UgZGF0YVxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5zZXRJbnN0YW5jZSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICB0aGlzLmluc3RhbmNlID0gZGF0YTtcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgZ2V0IHN1Yi1wcm9jZXNzZXMgZGF0YS5cbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuZ2V0U3ViUHJvY2Vzc2VzID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuc3VicHJvY2Vzc2VzO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyBzZXQgdGhlIHN1Yi1wcm9jZXNzZXMgZGF0YS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gZGF0YSAtIHRoZSB3b3JrZmxvdyBwcm9jZXNzIGluc3RhbmNlIGRhdGFcbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuc2V0U3ViUHJvY2Vzc2VzID0gZnVuY3Rpb24oZGF0YSkge1xuICAgIHRoaXMuc3VicHJvY2Vzc2VzID0gZGF0YTtcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgZ2V0IGluZGljYXRvciBzZXQgZGF0YS5cbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuZ2V0SW5kaWNhdG9ycyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmluZGljYXRvcnM7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IHNldCB0aGUgaW5kaWNhdG9yIHNldCBkYXRhLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIC0gdGhlIHdvcmtmbG93IHByb2Nlc3MgaW5zdGFuY2UgZGF0YVxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5zZXRJbmRpY2F0b3JzID0gZnVuY3Rpb24oZGF0YSkge1xuICAgIHRoaXMuaW5kaWNhdG9ycyA9IGRhdGE7XG59O1xuXG4vKipcbiAqIFNldCB0aGUgdmFyaWFibGUgdmFsdWUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBwcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3ViUHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3ViLXByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdWJQcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHN1Yi1wcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN0ZXBJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN0ZXAgaWRcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YXJpYWJsZSAtIHRoZSBXb3JrZmxvdyB2YXJpYWJsZSBvYmplY3RcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbi8vIFdvcmtmbG93LnByb3RvdHlwZS5zZXRWYXJpYWJsZSA9IGZ1bmN0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHZhcmlhYmxlKXtcbi8vIFx0dmFyIF90aGlzID0gdGhpcztcbi8vIFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuLy8gXHRcdHRyeSB7XG4vLyBcdFx0XHRQcm9jZXNzLmdldFZhcmlhYmxlKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHZhcmlhYmxlKS50aGVuKGZ1bmNpb24ocmVzdWx0KXtcbi8vIFx0XHRcdFx0cmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4vLyBcdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuLy8gXHRcdFx0XHRyZWplY3QoZXJyKTtcbi8vIFx0XHRcdH0pXG4vLyBcdFx0fSBjYXRjaCAoZXJyKSB7XG4vLyBcdFx0XHRyZWplY3QoZXJyKTtcbi8vIFx0XHR9XG5cbi8vIFx0fSk7XG4vLyB9O1xuXG4vKipcbiAqIEdldCB0aGUgdmFyaWFibGUgdmFsdWUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBwcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3ViUHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3ViLXByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdWJQcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHN1Yi1wcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN0ZXBJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN0ZXAgaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSB0aGUgV29ya2Zsb3cgdmFyaWFibGUgaWRcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbi8vIFdvcmtmbG93LnByb3RvdHlwZS5nZXRWYXJpYWJsZSA9IGZ1bmN0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIGtleSl7XG4vLyBcdHZhciBfdGhpcyA9IHRoaXM7XG4vLyBcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbi8vIFx0XHR0cnkge1xuLy8gXHRcdFx0UHJvY2Vzcy5zZXRWYXJpYWJsZShwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCBrZXkpLnRoZW4oZnVuY2lvbihyZXN1bHQpe1xuLy8gXHRcdFx0XHRyZXNvbHZlKHJlc3VsdC5kYXRhKTtcbi8vIFx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG4vLyBcdFx0XHRcdHJlamVjdChlcnIpO1xuLy8gXHRcdFx0fSlcbi8vIFx0XHR9IGNhdGNoIChlcnIpIHtcbi8vIFx0XHRcdHJlamVjdChlcnIpO1xuLy8gXHRcdH1cblxuLy8gXHR9KTtcbi8vIH07XG5cbi8qKlxuICogVGhpcyBtZXRob2QgY3JlYXRlcyBhIG5ldyB3b3JrZmxvdyBwcm9jZXNzIGkuZS4gaXQgY3JlYXRlcyBhIHdvcmtmbG93IHByb2Nlc3NlcyBpbnN0YW5jZVxuICogb2JqZWN0IHdpdGggdGhlIG1pbmltdW0gcmVxdWlyZWQgZGF0YS4gVGhpcyBpbnN0YW5jZSBjYW4gYmUgcmVmZXJlbmNlZCBpbiB0aGUgZm9sbG93aW5nXG4gKiB3YXksIHNlZSBleGFtcGxlIGJlbG93LlxuICpcbiAqIEBleGFtcGxlXG4gKiB2YXIgY29uZmlnID0geyAnX2lkJzogJ2FiYzEyMycgfTtcblxuICogdmFyIHdvcmtmbG93ID0gbmV3IFdvcmtmbG93KCcxMjM0JywgJzU2NzgnLCBjb25maWcpO1xuICogd29ya2Zsb3cuY3JlYXRlKCkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuICpcdGNvbnNvbGUubG9nKHJlc3VsdC5tZXNzYWdlKTtcbiAqXHQvLyBUaGUgZm9sbG93aW5nIHByb3BlcnRpZXMgY2FuIG5vdyBiZSBhY2Nlc3NlZFxuICogXHR2YXIgcHJvZmlsZSA9IHdvcmtmbG93LnByb2ZpbGU7XG4gKiBcdHZhciBhcHAgPSB3b3JrZmxvdy5hcHA7XG4gKiBcdHZhciBjb25maWcgPSB3b3JrZmxvdy5jb25maWc7XG4gKlx0Ly8gT24gc3VjY2VzcyB5b3UgY2FuIGFjY2VzcyB0aGUgaW5zdGFuY2UgdGhlIGZvbGxvd2luZyB3YXlcbiAqXHR2YXIgaW5zdGFuY2UgPSB3b3JrZmxvdy5pbnN0YW5jZTtcbiAqIH0sIGZ1bmN0aW9uKGVycm9yKXtcbiAqXHRjb25zb2xlLmxvZyhlcnJvcik7XG4gKiB9KTtcbiAqXG4gKiBAcmV0dXJuIHtPYmplY3R9IG5ldyBXb3JrZmxvdyBpbnN0YW5jZSB3aXRoIHVwZGF0ZWQgaW5zdGFuY2UgZGF0YS5cbiAqXG4gKi9cblxuV29ya2Zsb3cucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKF90aGlzLmluc3RhbmNlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgd2FybiA9IHV0aWwud2FybignSW5zdGFuY2UgYWxyZWFkeSBleGlzdHMuJywgX3RoaXMpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh3YXJuKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSB3b3JrZmxvdyBwcm9jZXNzZXMgaW5zdGFuY2Ugb2JqZWN0XG4gICAgICAgICAgICAgICAgdmFyIG1vZGVsID0ge1xuICAgICAgICAgICAgICAgICAgICBfaWQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3dvcmtmbG93SW5zdGFuY2UnLFxuICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZXM6IFtdLFxuICAgICAgICAgICAgICAgICAgICBjaGFubmVsczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZV9cIiArIGFwcC5TQ09QRS5wcm9maWxlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uX1wiICsgYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpICsgXCJfYXBwbGljYXRpb25fXCIgKyBhcHAuU0NPUEUuYXBwbGljYXRpb25JZFxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIG1vZGVsLl9pZCA9IFwiX2xvY2FsL1wiICsgX3RoaXMucHJvZmlsZSArICc6cHJvY2Vzc2VzJztcbiAgICAgICAgICAgICAgICAvL21vZGVsLl9pZCA9IF90aGlzLnByb2ZpbGUgKyAnOnByb2Nlc3Nlcyc7XG5cbiAgICAgICAgICAgICAgICBtb2RlbC52ZXJzaW9uID0gX3RoaXMuY29uZmlnLnZlcnNpb247XG4gICAgICAgICAgICAgICAgX3RoaXMuaW5zdGFuY2UgPSBtb2RlbDtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnV29ya2Zsb3cgcHJvY2Vzc2VzIGluc3RhbmNlIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5LicsIF90aGlzKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IGluaXRpYWxpc2UsIHRoaXMgZnVuY3Rpb24gZXhlY3V0ZXMgYSBwcm9jZXNzIHdpdGhpbiBhIHdvcmtmbG93XG4gKiBjb25maWd1cmF0aW9uLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgcHJvY2VzcyBpZCB0byBwcm9jZXNzXG4gKiBAcGFyYW0ge29iamVjdH0gW2RhdGFdIC0gdGhlIGlucHV0IGRhdGEgdG8gcHJvY2Vzc1xuICpcbiAqIEBleGFtcGxlXG4gKiBXb3JrZmxvdy5pbml0aWFsaXNlKCdwcm9jZXNzSWQnLCB7IHZhbGlkRGF0ZTogJ2RhdGUnIH0pO1xuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLmluaXRpYWxpc2UgPSBmdW5jdGlvbihwcm9jZXNzSWQsIGRhdGEsIHN1YnByb2ZpbGVJZCkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGNvbmZpZ1Byb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgIC8vIENoZWNrIHRoZSBwYXNzZWQgaW4gcGFyYW1ldGVyc1xuICAgICAgICAgICAgaWYgKHByb2Nlc3NJZCAhPT0gJycgJiYgcHJvY2Vzc0lkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAvLyBHZXQgdGhlIGN1cnJlbnQgcHJvY2VzcyBjb25maWdcbiAgICAgICAgICAgICAgICBjb25maWdQcm9jZXNzID0gX3RoaXMuY29uZmlnLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqUHJvY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAob2JqUHJvY2Vzcy5faWQgPT0gcHJvY2Vzc0lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqUHJvY2VzcztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpZ1Byb2Nlc3NbMF0uX2lkID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRkNvbmZpZ0Vycm9yJywgJ05vIHZhbGlkIHByb2Nlc3MgZGVmaW5pdGlvbiBmb3VuZCB3aXRoIHByb2Nlc3MgaWQ6ICcgKyBwcm9jZXNzSWQpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25maWdQcm9jZXNzLnB1c2goX3RoaXMuY29uZmlnLnByb2Nlc3Nlc1swXSk7XG4gICAgICAgICAgICAgICAgcHJvY2Vzc0lkID0gX3RoaXMuY29uZmlnLnByb2Nlc3Nlc1swXS5faWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBidWlsZFBhcmFtID0gZnVuY3Rpb24oYXJyYXkpIHtcblxuICAgICAgICAgICAgICAgIHZhciBpbmROYW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBsID0gMDsgbCA8IGFycmF5Lmxlbmd0aCAtIDE7IGwrKykge1xuICAgICAgICAgICAgICAgICAgICBpbmROYW1lID0gaW5kTmFtZSArIFwiJ1wiICsgYXJyYXlbbF0gKyBcIicsXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAnKCcgKyBpbmROYW1lICsgXCInXCIgKyBhcnJheVthcnJheS5sZW5ndGggLSAxXSArIFwiJylcIlxuXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgc3BJZCA9IGNvbmZpZ1Byb2Nlc3NbMF0uc3ViUHJvY2Vzc2VzWzBdLl9pZDtcbiAgICAgICAgICAgIHZhciB0b0NoZWNrQXJyYXkgPSBbXTtcbiAgICAgICAgICAgIHZhciBpbnN0YW5jZVR5cGUgPSBjb25maWdQcm9jZXNzWzBdLnN1YlByb2Nlc3Nlc1swXS5pbnN0YW5jZVR5cGU7XG4gICAgICAgICAgICB2YXIgcHJvY2Vzc0luZGljYXRvcnMgPSBKU09OLnhwYXRoKFwiaW5kaWNhdG9ycy9faWRcIiwgY29uZmlnUHJvY2Vzc1swXS5zdWJQcm9jZXNzZXNbMF0sIHt9KTtcblxuICAgICAgICAgICAgdmFyIGNhbkNyZWF0ZVByb2Nlc3MgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vU1A6VE9ETyBET05FXG4gICAgICAgICAgICAgICAgdmFyIGNvdW50U2luZ2xlTGlzdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tzZXRJZCA9IFwiICsgYnVpbGRQYXJhbShhcnJheSkgKyBcIiBhbmQgY2FyZGluYWxpdHkgZXEgJ3NpbmdsZScgXS9zZXRJZFwiLCBhcHAuU0NPUEUuQVBQX0NPTkZJRywge30pO1xuICAgICAgICAgICAgICAgIHZhciBjb3VudFNpbmdsZSA9IGNvdW50U2luZ2xlTGlzdC5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICBpZiAoY291bnRTaW5nbGUgPiAwKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGludm9sdmVkcHJvY2Vzc2VzID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW2luZGljYXRvcnMvX2lkID0gXCIrIGJ1aWxkUGFyYW0oY291bnRTaW5nbGVMaXN0KSArXCJdL19pZFwiLCBfdGhpcy5jb25maWcse30pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY291bnQgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSBcIisgYnVpbGRQYXJhbShpbnZvbHZlZHByb2Nlc3NlcykgK1wiIGFuZCBjb21wbGV0ZSA9IGZhbHNlKCldKVwiLCBfdGhpcyx7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoY291bnQgPT0gMClcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cblxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5zdGFuY2VUeXBlLm5ld1NlcXVlbmNlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnQgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgZXEgJ1wiKyBzcElkICtcIicgYW5kIGNvbXBsZXRlIGVxICdmYWxzZSddKVwiLCBfdGhpcyAsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoY291bnQgPT0gMClcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5zdGFuY2VUeXBlLm5ld0luc3RhbmNlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKGNhbkNyZWF0ZVByb2Nlc3MocHJvY2Vzc0luZGljYXRvcnMpKSB7XG5cbiAgICAgICAgICAgICAgICAvLyB2YXIgcHJvY2Vzc1NlcSA9IDE7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRQcm9jZXNzID0gW107XG4gICAgICAgICAgICAgICAgX3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihwcm9jZXNzSXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2Vzc0l0ZW0uaWQgPT0gcHJvY2Vzc0lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UHJvY2Vzcy5wdXNoKHByb2Nlc3NJdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NTZXEgPSBjdXJyZW50UHJvY2Vzcy5sZW5ndGggKyAxO1xuICAgICAgICAgICAgICAgIC8vIHZhciBuZXh0U2VxID0gcHJvY2Vzc1NlcSArIDE7XG4gICAgICAgICAgICAgICAgLy8gUHVzaCB0aGUgcHJvY2VzcyBvYmplY3QgaW50byB0aGUgYXJyYXlcbiAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc01vZGVsID0ge1xuICAgICAgICAgICAgICAgICAgICBpZDogJycsXG4gICAgICAgICAgICAgICAgICAgIHNlcTogJycsXG4gICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NlczogW11cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyAxLiBVcGRhdGUgdGhlIHByb2Nlc3MgaWQgYW5kIHNlcVxuICAgICAgICAgICAgICAgIHByb2Nlc3NNb2RlbC5pZCA9IHByb2Nlc3NJZDtcbiAgICAgICAgICAgICAgICBwcm9jZXNzTW9kZWwuc2VxID0gcHJvY2Vzc1NlcTtcbiAgICAgICAgICAgICAgICBfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXMucHVzaChwcm9jZXNzTW9kZWwpO1xuICAgICAgICAgICAgICAgIC8vIFBhcmFtZXRlcnNcbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc0lkID0gY29uZmlnUHJvY2Vzc1swXS5zdWJQcm9jZXNzZXNbMF0uX2lkO1xuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzU2VxID0gMTtcbiAgICAgICAgICAgICAgICBfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHByb2Nlc3NJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9jZXNzSXRlbS5pZCA9PSBwcm9jZXNzSWQgJiYgcHJvY2Vzc0l0ZW0uc2VxID09IHByb2Nlc3NTZXEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NTZXEgPSBwcm9jZXNzSXRlbS5zdWJQcm9jZXNzZXMubGVuZ3RoICsgMVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAvLyBDYWxsIHRoZSBzdWJwcm9jZXNzIG1ldGhvZFxuICAgICAgICAgICAgICAgIHZhciBpbnB1dFVVSUQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICBpZihkYXRhLnN1YnByb2Nlc3NVVUlEICE9IHVuZGVmaW5lZCAmJiBkYXRhLnN1YnByb2Nlc3NVVUlELmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgICAgICBpbnB1dFVVSUQgPSBkYXRhLnN1YnByb2Nlc3NVVUlEO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL2NyZWF0ZSB0eG5cbiAgICAgICAgICAgICAgICB2YXIgdHhuUGFja2V0ID0ge1xuICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5jb21tdW5pdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgXCJ1dWlkXCI6IGlucHV0VVVJRCxcbiAgICAgICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQsXG4gICAgICAgICAgICAgICAgICAgIFwidHJhbnNhY3Rpb25UeXBlXCI6IFwic3ViUHJvY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgICBcImRvY3VtZW50c1wiOiBbe1wiZG9jdW1lbnRcIjogaW5wdXRVVUlELCBcInJldlwiOiBcIjBcIn1dXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGRhby5zdGFydFRyYW5zYWN0aW9uKHR4blBhY2tldCkudGhlbihmdW5jdGlvbihzdWNjKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgUHJvY2Vzcy5zdWJQcm9jZXNzKGlucHV0VVVJRCwgcHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN1YnByb2ZpbGVJZCwgZGF0YSwgX3RoaXMpLnRoZW4oZnVuY3Rpb24oc3ViUHJvY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2VuZXJhdGUgdGhlIHV1aWRcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHV1aWQgPSBzdWJQcm9jZXNzLmRhdGEuX2lkOyAvL190aGlzLnByb2ZpbGUgKyAnOicgKyBfdGhpcy5hcHAgKyAnOicgKyBwcm9jZXNzSWQgKyAnOicgKyBwcm9jZXNzU2VxICsgJzonICsgc3ViUHJvY2Vzc0lkICsgJzonICsgc3ViUHJvY2Vzc1NlcTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQnVpbGQgdGhlIHN1Yi1wcm9jZXNzIHJlZmVyZW5jZSBvYmplY3RcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdyb3VwS2V5ID0gc3ViUHJvY2Vzcy5kYXRhLmdyb3VwS2V5O1xuICAgICAgICAgICAgICAgICAgICAgICAgLy9UT0RPOiBDaGFuZ2UgcmVxdWlyZWQgdG8gbW92ZSBpc0FjdGl2ZSB0byBzdWJQcm9jZXNzIGZpbGUuUmVtb3ZlIGZyb20gaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnByb2ZpbGVJZCA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzUmVmID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBzdWJQcm9jZXNzSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkOiBzdWJwcm9maWxlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VxOiBzdWJQcm9jZXNzLmRhdGFbXCJtZXRhLWRhdGFcIl0uc3ViUHJvY2Vzc0luc1NlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dWlkOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb3VwS2V5OiBncm91cEtleSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogc3ViUHJvY2Vzcy5kYXRhLmxhYmVsXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHRoZSByZWZlcmVuY2UgdG8gdGhlIHByb2Nlc3MgbW9kZWxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NNb2RlbC5zdWJQcm9jZXNzZXMucHVzaChzdWJQcm9jZXNzUmVmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgc3ViUHJvY2VzcyBtb2RlbCB0byB0aGUgc3VicHJvY2Vzc2VzIGFycmF5XG4gICAgICAgICAgICAgICAgICAgICAgICAvL190aGlzLnN1YnByb2Nlc3Nlcy5wdXNoKHN1YlByb2Nlc3MuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXMucHVzaChwcm9jZXNzTW9kZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IF90aGlzLmluc3RhbmNlLnByb2Nlc3Nlcy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc0l0ZW0gPSBfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXNbaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9jZXNzSXRlbS5pZCA9PSBwcm9jZXNzSWQgJiYgcHJvY2Vzc0l0ZW0uc2VxID09IHByb2Nlc3NTZXEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBjdXJyZW50IHByb2Nlc3MgZnJvbSB0aGUgYXJyYXkgYW5kIGFkZCB0aGUgdXBkYXRlZCBwcm9jZXNzTW9kZWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzLnNwbGljZShpbmRleCwgMSwgcHJvY2Vzc01vZGVsKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIHRoZSBpbmRpY2F0b3IgZG9jdW1lbnRzIHdvcmtmbG93IHByb2Nlc3NlcyB1cGRhdGVzXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9ycyA9IHN1YlByb2Nlc3MuZGF0YS5pbmRpY2F0b3JzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXAgPSBzdWJQcm9jZXNzLmRhdGEuc3RlcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIFByb2Nlc3MuaW5kaWNhdG9yRG9jcyhwcm9jZXNzSWQsIGluZGljYXRvcnMsIHN0ZXAsIF90aGlzLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdQcm9jZXNzOiAnICsgX3RoaXMuY29uZmlnLnByb2Nlc3Nlc1swXS5faWQgKyAnIGluaXRpYWxpemVkIHN1Y2Nlc3NmdWxseS4nLCBzdWJQcm9jZXNzUmVmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb21taXQgY2FsbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzID0gX3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIShvYmouaWQgPT0gcHJvY2Vzc0lkICYmIG9iai5zZXEgPT0gcHJvY2Vzc1NlcSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgaWYoZXJyLnJlc3BvbnNlSlNPTiAhPSB1bmRlZmluZWQgJiYgZXJyLnJlc3BvbnNlSlNPTi5tZXNzYWdlICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyLnJlc3BvbnNlSlNPTi5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKGVyci5yZXNwb25zZVRleHQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfSk7XG5cblxuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlamVjdChcIkNhbm5vdCBjcmVhdGUgd29ya2Zsb3cgYXMgb3RoZXIgcHJvY2VzcyB1c2luZyBzYW1lIFNETyBpcyBub3QgY29tcGxldGVcIilcbiAgICAgICAgICAgIH1cblxuXG5cblxuXG5cblxuXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyB0cmFuc2l0aW9uIHRvIHRoZSBuZXh0IHN0ZXAuIFRoaXMgbW92ZXMgdGhlIHdvcmtmbG93IGZyb20gdGhlIGN1cnJlbnQgcHJvY2VzcyxcbiAqIHN1Yi1wcm9jZXNzIHN0ZXAgdG8gdGhlIG5leHQgb25lIGFzIHNwZWNpZmllZC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2UgcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdWJQcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdWItcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHN1YlByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2Ugc3ViLXByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RlcElkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3RlcCBpZCBcbiAqIEBwYXJhbSB7c3RyaW5nfSB0cmFuc2l0aW9uSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiB0cmFuc2l0aW9uIGlkXG4gKiBAcGFyYW0ge29iamVjdH0gZGF0YSAtIGFueSBhZGRpdGlvbmFsIGRhdGEgcGFzc2VkIGluIGFzIGtleSB2YWx1ZSBwYWlyc1xuICpcbiAqIEBleGFtcGxlXG4gKiBXb3JrZmxvdy50cmFuc2l0aW9uKCdwcm9jZXNzSWQnLCAxLCAnc3ViUHJvY2Vzc0lkJywgMSwgJ3N0ZXBJZCcsICd0cmFuc2l0aW9uSWQnLCB7IGtleTogJycsIHZhbHVlOiAnJyB9KTtcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS50cmFuc2l0aW9uID0gZnVuY3Rpb24ocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwgdHJhbnNpdGlvbklkLCBkYXRhLCBzcHV1aWQpIHtcbiAgICAvLyBSZS1hc3NpZ24gdGhpc1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIG1vZGVsID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vc3RlcFwiLCBhcHAuU0NPUEUud29ya2Zsb3csIHt9KVswXTtcbiAgICAgICAgICAgIHZhciBzdGVwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHByb2Nlc3NJZCArIFwiJ10vc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzSWQgKyBcIiddL3N0ZXBzW19pZCBlcSAnXCIgKyBzdGVwSWQgKyBcIiddXCIsIF90aGlzLmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NTZXEgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9tZXRhLWRhdGEvc3ViUHJvY2Vzc0luc1NlcVwiLCBhcHAuU0NPUEUud29ya2Zsb3csIHt9KVswXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKHR5cGUsIHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmluc3RhbmNlLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ocHJvY2Vzc0l0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2Nlc3NJdGVtLmlkID09IHByb2Nlc3NJZCAmJiBwcm9jZXNzSXRlbS5zZXEgPT0gcHJvY2Vzc1NlcSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzSXRlbS5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YlByb2Nlc3NJdGVtLmlkID09IHN1YlByb2Nlc3NJZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnN1YnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzc09iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YlByb2Nlc3NPYmouX2lkID09IHNwdXVpZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0gJ3N0ZXAnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc09iai5zdGVwID0gcmVzdWx0LmRhdGEuc3RlcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MocmVzdWx0Lm1lc3NhZ2UsIHN1YlByb2Nlc3NPYmopO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09ICdzdGVwQ29tcGxldGUnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc09iai5zdGVwID0gcmVzdWx0LmRhdGEuc3RlcDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc09iai5jb21wbGV0ZSA9IHRydWVcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5zT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW3V1aWQgZXEgJ1wiKyBzdWJQcm9jZXNzT2JqLl9pZCArXCInXVwiLGFwcC5TQ09QRS53b3JrZmxvdyx7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc09iamVjdC5jb21wbGV0ZSA9IHRydWU7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcyhyZXN1bHQubWVzc2FnZSwgc3ViUHJvY2Vzc09iai5zdGVwKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcG9zdEFjdGlvbnMgPSB7fVxuXG4gICAgICAgICAgICBpZihzdGVwT2JqZWN0LmZ1bmN0aW9uLnRhc2sgIT0gdW5kZWZpbmVkICYmIHN0ZXBPYmplY3QuZnVuY3Rpb24udGFzay5wb3N0QWN0aW9ucyAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcG9zdEFjdGlvbnMgPSBzdGVwT2JqZWN0LmZ1bmN0aW9uLnRhc2sucG9zdEFjdGlvbnM7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgUHJvY2Vzcy5wb3N0QWN0aW9ucyhwb3N0QWN0aW9ucywgX3RoaXMsIHNwdXVpZCkudGhlbihmdW5jdGlvbihzdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgUHJvY2Vzcy50cmFuc2l0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHRyYW5zaXRpb25JZCwgZGF0YSwgX3RoaXMsIHNwdXVpZCwgbW9kZWwpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuZGF0YS5zdWJQcm9jZXNzQ29tcGxldGUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZSgnc3RlcENvbXBsZXRlJywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUoJ3N0ZXAnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYoc3RlcE9iamVjdC5mdW5jdGlvbi5zZXJ2ZXIgIT0gdW5kZWZpbmVkICYmIHN0ZXBPYmplY3QuZnVuY3Rpb24uc2VydmVyLnBvc3RBY3Rpb25zICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBwb3N0QWN0aW9ucyA9IHN0ZXBPYmplY3QuZnVuY3Rpb24uc2VydmVyLnBvc3RBY3Rpb25zO1xuICAgICAgICAgICAgICAgIFByb2Nlc3MucG9zdEFjdGlvbnMocG9zdEFjdGlvbnMsIF90aGlzLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24oc3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIFByb2Nlc3MudHJhbnNpdGlvbihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCB0cmFuc2l0aW9uSWQsIGRhdGEsIF90aGlzLCBzcHV1aWQsIG1vZGVsKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmRhdGEuc3ViUHJvY2Vzc0NvbXBsZXRlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUoJ3N0ZXBDb21wbGV0ZScsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlKCdzdGVwJywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgUHJvY2Vzcy50cmFuc2l0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHRyYW5zaXRpb25JZCwgZGF0YSwgX3RoaXMsIHNwdXVpZCwgbW9kZWwpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5kYXRhLnN1YlByb2Nlc3NDb21wbGV0ZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUoJ3N0ZXBDb21wbGV0ZScsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZSgnc3RlcCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG5cbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG5cbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgYXNzaWduIHVzZXIuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBwcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3ViUHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3ViLXByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdWJQcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHN1Yi1wcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN0ZXBJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN0ZXAgaWRcbiAqIEBwYXJhbSB7b2JqZWN0fSB1c2VyIC0gdGhlIHVzZXIgaWQgYW5kIG5hbWUgZGF0YVxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5hc3NpZ25Vc2VyID0gZnVuY3Rpb24ocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHVzZXIsIHV1aWQpIHtcbiAgICAvLyBSZS1hc3NpZ24gdGhlIFdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlIGFzIF90aGlzXG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgc3BPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBzcFJldiA9IHNwT2JqZWN0Ll9yZXY7XG4gICAgICAgICAgICB2YXIgdHhuUGFja2V0ID0ge1xuICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogYXBwLlNDT1BFLmNvbW11bml0eUlkLFxuICAgICAgICAgICAgICAgIFwidXVpZFwiOiB1dWlkLFxuICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkLFxuICAgICAgICAgICAgICAgIFwidHJhbnNhY3Rpb25UeXBlXCI6IFwic3ViUHJvY2Vzc1wiLFxuICAgICAgICAgICAgICAgIFwiZG9jdW1lbnRzXCI6IFt7XG4gICAgICAgICAgICAgICAgICAgIFwiZG9jdW1lbnRcIjogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgXCJyZXZcIjogc3BSZXZcbiAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgUHJvY2Vzcy5hc3NpZ25Vc2VyKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCB1c2VyLCB1dWlkLCBfdGhpcykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcblxuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgICAgXG5cblxuICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgIFxuXG5cblxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KVxufTtcblxuLyoqXG4gKiBXb3JrZmxvdyB0YXNrLCB0aGlzIG1ldGhvZCBleGVjdXRlcyBhIHNwZWNpZmljIHRhc2suXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBwcm9jZXNzIGlkIHRvIHByb2Nlc3NcbiAqIEBwYXJhbSB7b2JqZWN0fSBpbnB1dERhdGEgLSB0aGUgaW5wdXQgZGF0YSB0byBwcm9jZXNzXG4gKlxuICogQGV4YW1wbGVcbiAqIFdvcmtmbG93LmluaXRpYWxpemUoJ3Byb2Nlc3NJZCcsIHsgdmFsaWREYXRlOiAnZGF0ZScgfSk7XG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUudWkgPSBmdW5jdGlvbigpIHtcbiAgICAvLyBSZS1hc3NpZ24gdGhlIFdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlIGFzIF90aGlzXG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICByZXR1cm4ge1xuICAgICAgICBnZXRQcm9jZXNzOiBmdW5jdGlvbihwcm9jZXNzSWQsIGxhbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB1c2VySW50ZXJmYWNlLmdldFByb2Nlc3MocHJvY2Vzc0lkLCBsYW5nLCBfdGhpcykudGhlbihmdW5jdGlvbihtb2RlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShtb2RlbCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgfVxuXG59O1xuXG4vKipcbiAqIFdvcmtmbG93IHRhc2ssIHRoaXMgbWV0aG9kIGV4ZWN1dGVzIGEgc3BlY2lmaWMgdGFzay5cbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gZGF0YSAtIHRoZSBwcm9jZXNzIGlkIHRvIHByb2Nlc3NcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBpbnB1dCBkYXRhIHRvIHByb2Nlc3NcbiAqICogQHBhcmFtIHtzdHJpbmd9IHV1aWQgLSB0aGUgaW5wdXQgZGF0YSB0byBwcm9jZXNzXG4gKlxuICogQGV4YW1wbGVcbiAqIFdvcmtmbG93LmdldE5vZGVWYWx1ZShkYXRhLCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5cbldvcmtmbG93LnByb3RvdHlwZS5nZXROb2RlVmFsdWUgPSBmdW5jdGlvbihkYXRhLCB1dWlkKSB7XG4gICAgLy8gUmUtYXNzaWduIHRoZSBXb3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZSBhcyBfdGhpc1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShkYXRhLCBfdGhpcywgdXVpZCkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlcyk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KVxufTtcblxuLyoqXG4gKiBXb3JrZmxvdyB0YXNrLCB0aGlzIG1ldGhvZCBleGVjdXRlcyBhIHNwZWNpZmljIHRhc2suXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IGRhdGEgLSB0aGUgcHJvY2VzcyBpZCB0byBwcm9jZXNzXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgaW5wdXQgZGF0YSB0byBwcm9jZXNzXG4gKlxuICogQGV4YW1wbGVcbiAqIFdvcmtmbG93LnRha2VBc3NpZ25tZW50KHNwdXVpZCwgX1dGSW5zdGFuY2UpO1xuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuXG5Xb3JrZmxvdy5wcm90b3R5cGUudGFrZUFzc2lnbm1lbnQgPSBmdW5jdGlvbihzcHV1aWQpIHtcbiAgICAvLyBSZS1hc3NpZ24gdGhlIFdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlIGFzIF90aGlzXG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICBcbiAgICAgICAgICAgLy9Bc3NpZ25tZW50IGFyZSBleGVjdXRpbmcgaGVyZVxuXG4gICAgICAgICAgIHZhciBzcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddXCIsIF90aGlzLCB7fSlbMF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgdmFyIGFzc2lnbmVlID0gSlNPTi54cGF0aChcIi9zdGVwL2Fzc2lnbmVkVG9cIiwgc3BPYmplY3QsIHt9KVswXTtcbiAgICAgICAgICAgLy9QdXNoaW5nIG9sZGVyIHJlY29yZCBpbiByZUFzc2lnbiBhcnJheVxuXG4gICAgICAgICAgIGlmIChzcE9iamVjdC5zdGVwLmFzc2lnbm1lbnRIaXN0b3J5ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgc3BPYmplY3Quc3RlcC5hc3NpZ25tZW50SGlzdG9yeSA9IFtdO1xuICAgICAgICAgICB9XG4gICAgICAgICAgIGlmIChhc3NpZ25lZS51c2VySWQgIT0gXCJcIiAmJiBhc3NpZ25lZS5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgIHNwT2JqZWN0LnN0ZXAuYXNzaWdubWVudEhpc3RvcnkucHVzaChKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFzc2lnbmVlKSkpO1xuICAgICAgICAgICB9XG5cblxuXG4gICAgICAgICAgIGFzc2lnbmVlLm5hbWUgPSBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmZpcnN0TmFtZSArIFwiIFwiICsgTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5sYXN0TmFtZTtcbiAgICAgICAgICAgYXNzaWduZWUudXNlcklkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQgKyBcIlwiO1xuICAgICAgICAgICBhc3NpZ25lZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICBhc3NpZ25lZS50eXBlID0gQVNTSUdOTUVOVF9UWVBFX0FDQ0VQVEFOQ0U7XG4gICAgICAgICAgIGFzc2lnbmVlLmR1ZURhdGVUaW1lID0gJyc7XG4gICAgICAgICAgIGFzc2lnbmVlLmJ5ID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQgKyBcIlwiO1xuXG5cbiAgICAgICAgICAgLy9mZXRjaCBwcmVXb3JrQWN0aW9ucyBoZXJlIFxuXG4gICAgICAgICAgIHZhciBwcm9jZXNzSWQgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlc1tzdWJQcm9jZXNzZXMvdXVpZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXCIsIF90aGlzLCB7fSlbMF07XG4gICAgICAgICAgIHZhciBzdWJQcm9jZXNzSWQgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbdXVpZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXCIsIF90aGlzLCB7fSlbMF07XG4gICAgICAgICAgIFxuICAgICAgICAgICB2YXIgc3RlcElkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vc3RlcC9pZFwiLCBfdGhpcywge30pWzBdO1xuICAgICAgICAgXG4gICAgICAgICAgIHZhciBzdGVwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHByb2Nlc3NJZCArIFwiJ10vc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzSWQgKyBcIiddL3N0ZXBzW19pZCBlcSAnXCIgKyBzdGVwSWQgKyBcIiddXCIsIF90aGlzLmNvbmZpZywge30pWzBdO1xuXG4gICAgICAgICAgIGlmIChzdGVwT2JqZWN0LmZ1bmN0aW9uLnRhc2sucHJlV29ya0FjdGlvbnMgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgIHZhciBwcmVXb3JrQWN0aW9ucyA9IHN0ZXBPYmplY3QuZnVuY3Rpb24udGFzay5wcmVXb3JrQWN0aW9ucztcbiAgICAgICAgICAgICAgIFByb2Nlc3MucHJlV29ya0FjdGlvbnMocHJlV29ya0FjdGlvbnMsIF90aGlzKS50aGVuKGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMpO1xuXG4gICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuXG4gICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICByZXNvbHZlKF90aGlzKTtcblxuICAgICAgICAgICB9XG5cblxuXG5cblxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcblxuICAgICAgICAgICAgcmVqZWN0KGVycik7XG5cbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG5cbi8qKlxuICogV29ya2Zsb3cgdGFzaywgdGhpcyBtZXRob2QgZXhlY3V0ZXMgYSBzcGVjaWZpYyB0YXNrLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gdGhlIHByb2Nlc3MgaWQgdG8gcHJvY2Vzc1xuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGlucHV0IGRhdGEgdG8gcHJvY2Vzc1xuICpcbiAqIEBleGFtcGxlXG4gKiBXb3JrZmxvdy5jb25kaXRpb24oY29uZGl0aW9uLCBzcHV1aWQpO1xuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuXG5Xb3JrZmxvdy5wcm90b3R5cGUuY29uZGl0aW9uID0gZnVuY3Rpb24oY29uZGl0aW9uLCBzcHV1aWQpIHtcblxuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgIHZhciBvcGVyYXRvciA9IGNvbmRpdGlvbi5vcGVyYXRvcjtcbiAgICAgICAgICAgIHZhciBkYXRhQmxvY2sgPSBjb25kaXRpb24udmFsdWUuZGF0YTtcblxuICAgICAgICAgICAgaWYgKGNvbmRpdGlvbi5zdWJqZWN0LmluZGljYXRvciAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzZXRJZCA9IGNvbmRpdGlvbi5zdWJqZWN0LmluZGljYXRvci5zZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWxTY29wZSA9IGNvbmRpdGlvbi5zdWJqZWN0LmluZGljYXRvci5tb2RlbFNjb3BlO1xuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50UGF0aCA9IGNvbmRpdGlvbi5zdWJqZWN0LmluZGljYXRvci5lbGVtZW50UGF0aDtcbiAgICAgICAgICAgICAgICBpZiAoY29uZGl0aW9uLnN1YmplY3QuaW5kaWNhdG9yLmNvbnRleHQgPT0gJ3N1YlByb2Nlc3MnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfdGhpcywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yTW9kZWwgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF90aGlzLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhRWxlbWVudCA9IGluZGljYXRvck1vZGVsLm1vZGVsW21vZGVsU2NvcGVdLmRhdGFbc2V0SWRdO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbmFsVmFsdWUgPSBkYXRhRWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGhUb0VsZW1lbnQgPSBlbGVtZW50UGF0aCA9PSBcIlwiID8gW10gOiBlbGVtZW50UGF0aC5zcGxpdCgvWydcIlxcW1xcXS5dKy8pO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcGF0aFRvRWxlbWVudC5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYocGF0aFRvRWxlbWVudFtrXSA9PSBcIlwiKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGZpbmFsVmFsdWU7IFxuXG4gICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUoZGF0YUJsb2NrLCBfdGhpcywgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGhlbHBlci5jb21wYXJlKHZhbHVlLCBvcGVyYXRvciwgcmVzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbmRpdGlvbi5zdWJqZWN0LmluZGljYXRvci5jb250ZXh0ID09ICdzdWJQcm9maWxlJykge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vU1A6VE9ETyBET05FXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JNb2RlbCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIHNldElkICsgXCInXVwiLCBfdGhpcywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGFFbGVtZW50ID0gaW5kaWNhdG9yTW9kZWwubW9kZWxbbW9kZWxTY29wZV0uZGF0YVtzZXRJZF07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgZmluYWxWYWx1ZSA9IGRhdGFFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aFRvRWxlbWVudCA9IGVsZW1lbnRQYXRoID09IFwiXCIgPyBbXSA6IGVsZW1lbnRQYXRoLnNwbGl0KC9bJ1wiXFxbXFxdLl0rLyk7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBwYXRoVG9FbGVtZW50Lmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihwYXRoVG9FbGVtZW50W2tdID09IFwiXCIpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IGZpbmFsVmFsdWVbcGF0aFRvRWxlbWVudFtrXV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZmluYWxWYWx1ZTsgXG5cbiAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShkYXRhQmxvY2ssIF90aGlzLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gaGVscGVyLmNvbXBhcmUodmFsdWUsIG9wZXJhdG9yLCByZXMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCgnTm90IGltcGxlbWVudGVkJylcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgfSBlbHNlIGlmIChjb25kaXRpb24uc3ViamVjdC5pbmRpY2F0b3JXcmFwcGVyICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgcmVqZWN0KCdOb3QgaW1wbGVtZW50ZWQnKTtcblxuICAgICAgICAgICAgfSBlbHNlIGlmIChjb25kaXRpb24uc3ViamVjdC52YXJpYWJsZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgIC8vIHZhciB2YWx1ZSA9IGRhdGFCbG9jay52YWx1ZS5kYXRhO1xuXG4gICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShkYXRhQmxvY2sgLCBfdGhpcywgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHJocykge1xuICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGNvbmRpdGlvbi5zdWJqZWN0LCBfdGhpcywgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKGxocykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGhlbHBlci5jb21wYXJlKGxocywgb3BlcmF0b3IsIHJocyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAvLyByZWplY3QoJ05vdCBpbXBsZW1lbnRlZCcpXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNvbmRpdGlvbi5zdWJqZWN0LnN1YlByb2Nlc3MgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudFBhdGggPSBjb25kaXRpb24uc3ViamVjdC5zdWJQcm9jZXNzLmVsZW1lbnRQYXRoO1xuICAgICAgICAgICAgICAgIHZhciBzcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddXCIsIF90aGlzLCB7fSlbMF07XG4gICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgZmluYWxWYWx1ZSA9IHNwT2JqZWN0O1xuICAgICAgICAgICAgICAgIHZhciBwYXRoVG9FbGVtZW50ID0gZWxlbWVudFBhdGggPT0gXCJcIiA/IFtdIDogZWxlbWVudFBhdGguc3BsaXQoL1snXCJcXFtcXF0uXSsvKTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcGF0aFRvRWxlbWVudC5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICBpZihwYXRoVG9FbGVtZW50W2tdID09IFwiXCIpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlID0gZmluYWxWYWx1ZVtwYXRoVG9FbGVtZW50W2tdXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZmluYWxWYWx1ZTsgXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShkYXRhQmxvY2ssIF90aGlzLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBoZWxwZXIuY29tcGFyZSh2YWx1ZSwgb3BlcmF0b3IsIHJlcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG5cbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuXG4gICAgICAgIH1cblxuICAgIH0pO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBXb3JrZmxvdzsiLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlsID0gcmVxdWlyZSgndXRpbGl0eScpO1xudmFyIG5vZGVWYWx1ZSA9IHJlcXVpcmUoJy4vbm9kZVZhbHVlJyk7XG52YXIgZm9ybSA9IHJlcXVpcmUoJy4vZm9ybScpO1xudmFyIGhlbHBlciA9IHJlcXVpcmUoJy4vaGVscGVyJyk7XG5cbnZhciBnYXRla2VlcGVyID0gbmV3IEdLKCk7XG5cbi8qKlxuICogQWN0aW9ucyBNb2R1bGVcbiAqXG4gKiBAbW9kdWxlIGxpYi9hY3Rpb25zXG4gKiBAYXV0aG9yIEhhc2FuIEFiYmFzXG4gKiBAdmVyc2lvbiAyLjAuMFxuICogQGRlc2NyaXB0aW9uIHRlc3QgZGVzY3JpcHRpb25cbiAqIEBjb3B5cmlnaHQgS3dhbnR1IEx0ZCBSU0EgMjAwOS0yMDE1LlxuICpcbiAqL1xuXG4vKipcbiAqICBGb3JtIE1vZHVsZSBhY3Rpb25zIG5lZWRzIHRvIGJlIG1vdmVkIGhlcmUuXG4gKiAgVGhpcyBhY3Rpb25zIG1vZHVsZSB3aWxsIGJlIGNlbnRhbCBwbGFjZSB0byBob2xkIGFsbCBmdW5jdGlvbnMuXG4gKiAgXG4gKi9cblxudmFyIGNvbW11bml0eSA9IChmdW5jdGlvbigpIHtcblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgY3JlYXRlQ29tbXVuaXR5OiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJmb2xsb3dcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdXVpZENvbW11bml0eSA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdDb21tdW5pdHknXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVDb21tdW5pdHlcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJuZXdDb21tdW5pdHlJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpbmRpY2F0b3JVVUlEXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkNvbW11bml0eVwiOiB1dWlkQ29tbXVuaXR5XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIHVzZXJKb2luQ29tbXVuaXR5OiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG4gICAgICAgIHJlbGVhc2VBZG9wdGVkQXBwbGljYXRpb246IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImZvbGxvd1wiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgdXVpZFJlbGVhc2VBZG9wdGVkQXBwbGljYXRpb24gPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnYWRvcHRlZEFwcGxpY2F0aW9uJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcInJlbGVhc2VBZG9wdGVkQXBwbGljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpbmRpY2F0b3JVVUlEXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFkb3B0ZWRBcHBsaWNhdGlvblwiOiB1dWlkUmVsZWFzZUFkb3B0ZWRBcHBsaWNhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtlciBwcm9jZXNzZXMgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuXG52YXIgYXBwbGljYXRpb24gPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAgIGNyZWF0ZUFwcERlZmluaXRpb246IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImZvbGxvd1wiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgdXVpZEFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ0FwcGxpY2F0aW9uJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVBcHBsaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5ld0FwcGxpY2F0aW9uSWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaW5kaWNhdG9yVVVJRFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJBcHBsaWNhdGlvblwiOiB1dWlkQXBwbGljYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBidWlsZEFwcGxpY2F0aW9uOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJmb2xsb3dcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG4gICAgICAgICAgICAgICAgdmFyIHV1aWRQdWJsaXNoQXBwbGljYXRpb24gPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnUHVibGlzaEFwcGxpY2F0aW9uJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgdXVpZEFwcGxpY2F0aW9uRGVmaW5pdGlvbiA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdBcHBsaWNhdGlvbkRlZmluaXRpb24nXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgdXVpZFJvbGVzID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1JvbGVzJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHV1aWRBcHBsaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdBcHBsaWNhdGlvbiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciB1dWlkQXBwUGVybWlzc2lvbnMgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnQXBwUGVybWlzc2lvbnMnXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiYnVpbGRBcHBsaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaW5kaWNhdG9yVVVJRFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJQdWJsaXNoQXBwbGljYXRpb25cIjogdXVpZFB1Ymxpc2hBcHBsaWNhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkFwcGxpY2F0aW9uRGVmaW5pdGlvblwiOiB1dWlkQXBwbGljYXRpb25EZWZpbml0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiUm9sZXNcIjogdXVpZFJvbGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQXBwbGljYXRpb25cIjogdXVpZEFwcGxpY2F0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQXBwUGVybWlzc2lvbnNcIjogdXVpZEFwcFBlcm1pc3Npb25zXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgYXBwbGljYXRpb25BZG9wdGlvbjogZnVuY3Rpb24oX2RlZiwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJmb2xsb3dcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG4gICAgICAgICAgICAgICAgdmFyIHV1aWRBZG9wdGlvbiA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdBZG9wdGlvbiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHV1aWRQdWJsaXNoQXBwbGljYXRpb24gPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnUHVibGlzaEFwcGxpY2F0aW9uJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHV1aWRBcHBsaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdBcHBsaWNhdGlvbiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJhZG9wdEFwcGxpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpbmRpY2F0b3JVVUlEXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkFkb3B0aW9uXCI6IHV1aWRBZG9wdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlB1Ymxpc2hBcHBsaWNhdGlvblwiOiB1dWlkUHVibGlzaEFwcGxpY2F0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQXBwbGljYXRpb25cIjogdXVpZEFwcGxpY2F0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlVGF4b25vbXk6IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImZvbGxvd1wiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgdGF4b25vbXlVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1RheG9ub215J10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZVRheG9ub215XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGF4b25vbXlVVUlEXCI6IHRheG9ub215VVVJRFxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuXG52YXIgcGVyZm9ybWFuY2UgPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG5cbiAgICAgICAgdW5sb2NrUGVyaW9kOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB2YXIgZW50cnlVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2lkIGVxICdcIiArIFBFUklPRF9TRVRfSUQgKyBcIicgb3IgaWQgZXEgJ1wiICsgQVVESVRfUEVSSU9EX1NFVF9JRCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgc3VicHJvY2Vzc09iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB2YXIgZW5kZGF0ZSA9IHN1YnByb2Nlc3NPYmplY3QuZGF0ZXMudmFsaWQ7XG5cbiAgICAgICAgICAgICAgICBsaWJyYXJ5LnVubG9ja1BlcmlvZChlbnRyeVVVSUQsIGVuZGRhdGUsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdVbmxvY2sgcGVyaW9kLicsIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG5cblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG5cblxuXG5cblxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXRNb2RlbFN0YXR1czogZnVuY3Rpb24oX2RlZiwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgZW50cnlVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2lkIGVxICdcIiArIFBFUklPRF9TRVRfSUQgKyBcIicgb3IgaWQgZXEgJ1wiICsgQVVESVRfUEVSSU9EX1NFVF9JRCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgc3VicHJvY2Vzc09iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB2YXIgZW5kZGF0ZSA9IHN1YnByb2Nlc3NPYmplY3QuZGF0ZXMudmFsaWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RhdHVzaTE4bkxhYmVsID0gSlNPTi54cGF0aChcIi9sYWJlbFwiLCBfZGVmLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHN0YXR1cyA9IGhlbHBlci5nZXRMYW5ndWFnZU1lc3NhZ2Uoc3RhdHVzaTE4bkxhYmVsKTtcblxuXG4gICAgICAgICAgICAgICAgbGlicmFyeS5zZXRQZXJpb2RTdGF0dXMoZW50cnlVVUlELCBlbmRkYXRlLCBzdGF0dXMsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdzZXRNb2RlbFN0YXR1cycsIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG5cblxuXG5cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cblxuICAgICAgICBsb2NrUGVyZm9ybWFuY2VNb2RlbDogZnVuY3Rpb24oX2RlZiwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgZW50cnlVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2lkIGVxICdcIiArIFBFUkZPUk1BTkNFX1NFVF9JRCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgc3VicHJvY2Vzc09iamVjdCwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIGVuZGRhdGUgPSBzdWJwcm9jZXNzT2JqZWN0LmRhdGVzLnZhbGlkO1xuXG4gICAgICAgICAgICAgICAgbGlicmFyeS5sb2NrUGVyZm9ybWFuY2VNb2RlbChlbnRyeVVVSUQsIGVuZGRhdGUsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdMb2NrIHBlcmZvcm1hbmNlIG1vZGVsLicsIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG5cblxuXG5cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgIH1cblxufSkoKTtcblxudmFyIHNkbyA9IChmdW5jdGlvbigpIHtcblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgY3JlYXRlOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJmb2xsb3dcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG4gICAgICAgICAgICAgICAgdmFyIHNkb1VVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnU0RPJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZVNET1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1VVSURcIjogc2RvVVVJRFxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuXG52YXIgdGF4b25vbXkgPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAgIGNyZWF0ZTogZnVuY3Rpb24oX2RlZiwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiZm9sbG93XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuICAgICAgICAgICAgICAgIHZhciB0YXhvbm9teVVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnVGF4b25vbXknXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlVGF4b25vbXlcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0YXhvbm9teVVVSURcIjogdGF4b25vbXlVVUlEXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtlciBwcm9jZXNzZXMgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG5cbiAgICB9XG5cbn0pKCk7XG5cbnZhciBzdWJQcm9jZXNzSW5zdGFuY2UgPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAgIHNldFRpdGxlOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBkYXRhVmFsdWUsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzcFByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NTUE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1t1dWlkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmKHByb2Nlc3NTUE9iamVjdCAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICBwcm9jZXNzU1BPYmplY3QubGFiZWwgPSBkYXRhVmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHNwUHJvY2Vzc09iamVjdC5sYWJlbCA9IGRhdGFWYWx1ZTtcblxuICAgICAgICAgICAgICAgIHZhciBpdGVtc1RvUHJvY2VzcyA9IDE7XG4gICAgICAgICAgICAgICAgdmFyIHN0dWZmID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IHt9O1xuXG4gICAgICAgICAgICAgICAgb2JqLm1vZGVsID0gX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzO1xuICAgICAgICAgICAgICAgIHN0dWZmLnB1c2gob2JqKTtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnU3VicHJvY2VzcyBzZXRUaXRsZSBzdWNjZXNzLicsIF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcyk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0VmFsaWREYXRlOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBkYXRhVmFsdWUsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzcFByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgc3BQcm9jZXNzT2JqZWN0LmRhdGVzLnZhbGlkID0gZGF0YVZhbHVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIGl0ZW1zVG9Qcm9jZXNzID0gMTtcbiAgICAgICAgICAgICAgICB2YXIgc3R1ZmYgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0ge307XG5cbiAgICAgICAgICAgICAgICBvYmoubW9kZWwgPSBzcFByb2Nlc3NPYmplY3Q7XG4gICAgICAgICAgICAgICAgc3R1ZmYucHVzaChvYmopO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ3ZhbGlkIGRhdGUgc2V0LicsIF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcyk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0U1BTdGF0dXM6IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIGRhdGFWYWx1ZSwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHNwUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBhcHAuU0NPUEUud29ya2Zsb3csIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBzcFByb2Nlc3NPYmplY3Quc3BTdGF0dXMgPSBkYXRhVmFsdWU7XG5cbiAgICAgICAgICAgICAgICB2YXIgaXRlbXNUb1Byb2Nlc3MgPSAxO1xuICAgICAgICAgICAgICAgIHZhciBzdHVmZiA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBvYmogPSB7fTtcblxuICAgICAgICAgICAgICAgIG9iai5tb2RlbCA9IF9XRkluc3RhbmNlLnN1YnByb2Nlc3NlcztcbiAgICAgICAgICAgICAgICBzdHVmZi5wdXNoKG9iaik7XG4gICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1N1YnByb2Nlc3Mgc3BTdGF0dXMgc3VjY2Vzcy4nLCBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgfVxuXG59KSgpO1xuXG52YXIgdmFyaWFibGVzID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICBzZXRWYXJpYWJsZTogZnVuY3Rpb24oc2V0VmFyaWFibGUsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUoc2V0VmFyaWFibGUuZGF0YSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YVZhbHVlKSB7XG5cblxuICAgICAgICAgICAgICAgICAgICB2YXIgc2NvcGUgPSBzZXRWYXJpYWJsZS5zY29wZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhcmlhYmxlTmFtZSA9IHNldFZhcmlhYmxlLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YXJpYWJsZVR5cGUgPSBzZXRWYXJpYWJsZS52YXJpYWJsZVR5cGU7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbGlkRGF0ZSA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9kYXRlcy92YWxpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChzY29wZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncHJvZmlsZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUgPSBwcm9maWxlSWQgKyAnOnZhcmlhYmxlcyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR4blBhY2tldCA9IGFwcC5TQ09QRS50eG47XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0KHByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lKS50aGVuKGZ1bmN0aW9uKGZpbGUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVmUGFjayA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYWxQcm9jZXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWFibGVUeXBlID09ICdwZXJpb2RpYycpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IE92ZXJ3cml0ZSB0aGUgZXhpc3RpbmcgdmFyaWFibGUgaW4gY2FzZSB3aGVyZSBzYW1lIHZhcmlhYmxlIGlzIGFzc2lnbmVkIGF0IG11bHRpcGxlIHN0ZXBzLlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy92YXIgcHJvY2Vzc09iaiA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzW3N1YlByb2Nlc3Nlcy91dWlkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy92YXIgc2VxID0gcHJvY2Vzc09iai5zZXE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy92YXIgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJwcm9jZXNzVHlwZSA9IEpTT04ueHBhdGgoXCIvY29uZmlnL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbX2lkIGVxIC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkXS90eXBlXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgKHN1YnByb2Nlc3NUeXBlID09IFBST0NFU1NfVFlQRV9TVUJQUk9GSUxFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWQgYW5kIF9pZCA9IC9zdWJwcm9jZXNzZXNbX2lkID0gXCIgKyBwYXJ0ICsgXCJdL19pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJwcm9jZXNzVHlwZSA9PSBQUk9DRVNTX1RZUEVfU1VCUFJPRklMRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFydCA9IGxpYnJhcnkuZ2V0U3VicHJvZmlsZVN1YnByb2Nlc3NJZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWQgYW5kIHV1aWQgPSBcIisgcGFydCArXCJdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlclwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJOYW1lXCI6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJQcm9maWxlSWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogc2VxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbGlkRGF0ZVwiOiB2YWxpZERhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsdWVcIjogZGF0YVZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVbdmFyaWFibGVOYW1lXSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbmFsVmFsdWUgPSBmaWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aFRvRWxlbWVudCA9IHZhcmlhYmxlTmFtZSA9PSBcIlwiID8gW10gOiB2YXJpYWJsZU5hbWUuc3BsaXQoL1snXCJcXFtcXF0uXSsvKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHBhdGhUb0VsZW1lbnQubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBhdGhUb0VsZW1lbnRba10gPT0gXCJcIikgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlID0gZmluYWxWYWx1ZVtwYXRoVG9FbGVtZW50W2tdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlLnB1c2gob2JqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZVt2YXJpYWJsZU5hbWVdID0gW29ial07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVbdmFyaWFibGVOYW1lXSA9IGRhdGFWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLnNhdmUoZmlsZSkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmUGFjay5yZXYgPSBkYXRhLnJldjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFwiVmFyaWFibGUgc2V0IHN1Y2Nlc3NmdWxseVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiRmFpbGVkIHRvIHNldCBWYXJpYWJsZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdHhuUGFja2V0LmRvY3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lID09IHR4blBhY2tldC5kb2N1bWVudHNbaV0uZG9jdW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZQYWNrID0gIHR4blBhY2tldC5kb2N1bWVudHNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmb3VuZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHhuUGFja2V0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhcHAuU0NPUEUudHhuKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eG5QYWNrZXQuZG9jdW1lbnRzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZQYWNrID0geyBcImRvY3VtZW50XCI6IHByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lLCBcInJldlwiOiAoZmlsZS5fcmV2PT11bmRlZmluZWQgPyBcIjBcIjogZmlsZS5fcmV2KSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHhuUGFja2V0LmRvY3VtZW50cy5wdXNoKHJlZlBhY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwLlNDT1BFLnR4bi5kb2N1bWVudHMucHVzaChyZWZQYWNrKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLnVwZGF0ZVRyYW5zYWN0aW9uKHR4blBhY2tldCkudGhlbihmdW5jdGlvbihzdWNjKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxQcm9jZXNzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVyci5yZXNwb25zZUpTT04gIT0gdW5kZWZpbmVkICYmIGVyci5yZXNwb25zZUpTT04ubWVzc2FnZSAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyLnJlc3BvbnNlSlNPTi5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYoZXJyLnJlc3BvbnNlVGV4dCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVyci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxQcm9jZXNzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIl9pZFwiOiBwcm9maWxlVmFyaWFibGVGaWxlTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUuY2hhbm5lbHMgPSBhcHAucHJvZmlsZS5jaGFubmVscztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWFibGVUeXBlID09ICdwZXJpb2RpYycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFyIHByb2Nlc3NPYmogPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlc1tzdWJQcm9jZXNzZXMvdXVpZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy92YXIgc2VxID0gcHJvY2Vzc09iai5zZXE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy92YXIgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3NUeXBlID0gSlNPTi54cGF0aChcIi9jb25maWcvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tfaWQgZXEgL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWRdL3R5cGVcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgKHN1YnByb2Nlc3NUeXBlID09IFBST0NFU1NfVFlQRV9TVUJQUk9GSUxFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZCBhbmQgX2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgPSBcIiArIHBhcnQgKyBcIl0vX2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB9XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFydCA9IGxpYnJhcnkuZ2V0U3VicHJvZmlsZVN1YnByb2Nlc3NJZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZCBhbmQgdXVpZCA9IFwiKyBwYXJ0ICtcIl0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlW3ZhcmlhYmxlTmFtZV0gPSBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJOYW1lXCI6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlclByb2ZpbGVJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogc2VxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsaWREYXRlXCI6IHZhbGlkRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbHVlXCI6IGRhdGFWYWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlW3ZhcmlhYmxlTmFtZV0gPSBkYXRhVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHhuUGFja2V0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhcHAuU0NPUEUudHhuKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4blBhY2tldC5kb2N1bWVudHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlZlBhY2sgPSB7IFwiZG9jdW1lbnRcIjogcHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUsIFwicmV2XCI6IChmaWxlLl9yZXY9PXVuZGVmaW5lZCA/IFwiMFwiOiBmaWxlLl9yZXYpfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHhuUGFja2V0LmRvY3VtZW50cy5wdXNoKHJlZlBhY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHAuU0NPUEUudHhuLmRvY3VtZW50cy5wdXNoKHJlZlBhY2spO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby51cGRhdGVUcmFuc2FjdGlvbih0eG5QYWNrZXQpLnRoZW4oZnVuY3Rpb24oc3VjYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLnNhdmUoZmlsZSkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmUGFjay5yZXYgPSBkYXRhLnJldjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFwiVmFyaWFibGUgc2V0IHN1Y2Nlc3NmdWxseVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiRmFpbGVkIHRvIHNldCBWYXJpYWJsZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihlcnIucmVzcG9uc2VKU09OICE9IHVuZGVmaW5lZCAmJiBlcnIucmVzcG9uc2VKU09OLm1lc3NhZ2UgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyLnJlc3BvbnNlSlNPTi5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZihlcnIucmVzcG9uc2VUZXh0ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzdWJQcm9jZXNzSW5zdGFuY2UnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShcIm5vdCBpbXBsZW1lbnRlZFwiKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3RlcCc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFwibm90IGltcGxlbWVudGVkXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3ViUHJvZmlsZVN1YlByb2Nlc3NJbnN0YW5jZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9maWxlVmFyaWFibGVGaWxlTmFtZSA9IHN1YlByb2ZpbGVJZCArICc6dmFyaWFibGVzJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3VwZGF0ZSB0cnhuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR4blBhY2tldCA9IGFwcC5TQ09QRS50eG47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLmdldChzdWJQcm9maWxlVmFyaWFibGVGaWxlTmFtZSkudGhlbihmdW5jdGlvbihmaWxlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8vXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWZQYWNrID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhbFByb2Nlc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZVR5cGUgPT0gJ3BlcmlvZGljJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmFyIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWQgYW5kIF9pZCA9IC9zdWJwcm9jZXNzZXNbX2lkID0gXCIgKyBwYXJ0ICsgXCJdL19pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCB1dWlkID0gXCIrIHBhcnQgK1wiXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VyTmFtZVwiOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VyUHJvZmlsZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IHNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWxpZERhdGVcIjogdmFsaWREYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbHVlXCI6IGRhdGFWYWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWxlW3ZhcmlhYmxlTmFtZV0gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaW5hbFZhbHVlID0gZmlsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGhUb0VsZW1lbnQgPSB2YXJpYWJsZU5hbWUgPT0gXCJcIiA/IFtdIDogdmFyaWFibGVOYW1lLnNwbGl0KC9bJ1wiXFxbXFxdLl0rLyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBwYXRoVG9FbGVtZW50Lmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihwYXRoVG9FbGVtZW50W2tdID09IFwiXCIpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IGZpbmFsVmFsdWVbcGF0aFRvRWxlbWVudFtrXV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZS5wdXNoKG9iaik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVbdmFyaWFibGVOYW1lXSA9IFtvYmpdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlW3ZhcmlhYmxlTmFtZV0gPSBkYXRhVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5zYXZlKGZpbGUpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZlBhY2sucmV2ID0gZGF0YS5yZXY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShcIlZhcmlhYmxlIGF0IHN1YnByb2ZpbGUgc2V0IHN1Y2Nlc3NmdWxseVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiRmFpbGVkIHRvIHNldCBWYXJpYWJsZSBhdCBzdWJwcm9maWxlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0eG5QYWNrZXQuZG9jdW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViUHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUgPT0gdHhuUGFja2V0LmRvY3VtZW50c1tpXS5kb2N1bWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZlBhY2sgPSAgdHhuUGFja2V0LmRvY3VtZW50c1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWZvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eG5QYWNrZXQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFwcC5TQ09QRS50eG4pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4blBhY2tldC5kb2N1bWVudHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZlBhY2sgPSB7IFwiZG9jdW1lbnRcIjogc3ViUHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUsIFwicmV2XCI6IChmaWxlLl9yZXY9PXVuZGVmaW5lZCA/IFwiMFwiOiBmaWxlLl9yZXYpIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eG5QYWNrZXQuZG9jdW1lbnRzLnB1c2gocmVmUGFjayk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHAuU0NPUEUudHhuLmRvY3VtZW50cy5wdXNoKHJlZlBhY2spO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8udXBkYXRlVHJhbnNhY3Rpb24odHhuUGFja2V0KS50aGVuKGZ1bmN0aW9uKHN1Y2MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFByb2Nlc3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZXJyLnJlc3BvbnNlSlNPTiAhPSB1bmRlZmluZWQgJiYgZXJyLnJlc3BvbnNlSlNPTi5tZXNzYWdlICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIucmVzcG9uc2VKU09OLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZihlcnIucmVzcG9uc2VUZXh0ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFByb2Nlc3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiX2lkXCI6IHN1YlByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZS5jaGFubmVscyA9IGFwcC5wcm9maWxlLmNoYW5uZWxzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZVR5cGUgPT0gJ3BlcmlvZGljJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy92YXIgcHJvY2Vzc09iaiA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzW3N1YlByb2Nlc3Nlcy91dWlkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBzZXEgPSBwcm9jZXNzT2JqLnNlcTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy92YXIgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZCBhbmQgaWQgPSAvc3VicHJvY2Vzc2VzW19pZCA9IC9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW3N1YnByb2ZpbGVJZCBlcSAnXCIgKyBzdWJQcm9maWxlSWQgKyBcIiddL3V1aWRdL19pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZCBhbmQgX2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgPSBcIiArIHBhcnQgKyBcIl0vX2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlW3ZhcmlhYmxlTmFtZV0gPSBbe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJOYW1lXCI6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlclByb2ZpbGVJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogc2VxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsaWREYXRlXCI6IHZhbGlkRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbHVlXCI6IGRhdGFWYWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlW3ZhcmlhYmxlTmFtZV0gPSBkYXRhVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHhuUGFja2V0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhcHAuU0NPUEUudHhuKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4blBhY2tldC5kb2N1bWVudHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlZlBhY2sgPSB7IFwiZG9jdW1lbnRcIjogc3ViUHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUsIFwicmV2XCI6IChmaWxlLl9yZXY9PXVuZGVmaW5lZCA/IFwiMFwiOiBmaWxlLl9yZXYpIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4blBhY2tldC5kb2N1bWVudHMucHVzaChyZWZQYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwLlNDT1BFLnR4bi5kb2N1bWVudHMucHVzaChyZWZQYWNrKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8udXBkYXRlVHJhbnNhY3Rpb24odHhuUGFja2V0KS50aGVuKGZ1bmN0aW9uKHN1Y2MpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLnNhdmUoZmlsZSkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmUGFjay5yZXYgPSBkYXRhLnJldjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFwiVmFyaWFibGUgYXQgc3VicHJvZmlsZSBzZXQgc3VjY2Vzc2Z1bGx5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJGYWlsZWQgdG8gc2V0IFZhcmlhYmxlIGF0IHN1YnByb2ZpbGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihlcnIucmVzcG9uc2VKU09OICE9IHVuZGVmaW5lZCAmJiBlcnIucmVzcG9uc2VKU09OLm1lc3NhZ2UgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyLnJlc3BvbnNlSlNPTi5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZihlcnIucmVzcG9uc2VUZXh0ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChcImdldE5vZGVWYWx1ZSB2YWx1ZSBub3QgZm91bmQuXCIpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG5cblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuXG52YXIgbm90aWZpY2F0aW9uID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICBzZW5kTm90aWZpY2F0aW9uV29ya2VyOiBmdW5jdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuXG4gICAgICAgICAgICAgICAgdmFyIGdldFJlY2lwaWVudHMgPSBmdW5jdGlvbihub3RpZmljYXRpb24pIHtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjaXBpZW50cyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnJvbGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnJvbGUgPSBub3RpZmljYXRpb24ucmVjaXBpZW50cy5yb2xlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVjaXBpZW50cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm90aWZpY2F0aW9uLnJlY2lwaWVudHMucHJvZmlsZVJvbGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnByb2ZpbGVSb2xlID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5wcm9maWxlUm9sZS5yb2xlID0gbm90aWZpY2F0aW9uLnJlY2lwaWVudHMucHJvZmlsZVJvbGUucm9sZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnByb2ZpbGVSb2xlLnByb2ZpbGUgPSBub3RpZmljYXRpb24ucmVjaXBpZW50cy5wcm9maWxlUm9sZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVjaXBpZW50cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm90aWZpY2F0aW9uLnJlY2lwaWVudHMuc3ViUHJvZmlsZVJvbGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnN1YlByb2ZpbGVSb2xlID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5zdWJQcm9maWxlUm9sZS5yb2xlID0gbm90aWZpY2F0aW9uLnJlY2lwaWVudHMuc3ViUHJvZmlsZVJvbGUucm9sZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnN1YlByb2ZpbGVSb2xlLnN1YlByb2ZpbGVDYXRlZ29yeSA9IG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnN1YlByb2ZpbGVSb2xlLnN1YlByb2ZpbGVDYXRlZ29yeTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnN1YlByb2ZpbGVSb2xlLnByb2ZpbGUgPSBub3RpZmljYXRpb24ucmVjaXBpZW50cy5zdWJQcm9maWxlUm9sZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVjaXBpZW50cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm90aWZpY2F0aW9uLnJlY2lwaWVudHMuZnVuY3Rpb24gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLmZ1bmN0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IHt9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShub3RpZmljYXRpb24ucmVjaXBpZW50cy5mdW5jdGlvbi51c2VycywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YVZhbHVlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IGRhdGFWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZWNpcGllbnRzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm90aWZpY2F0aW9uLnJlY2lwaWVudHMuc3RlcEFzc2lnbmVlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5zdGVwQXNzaWduZWUgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnN0ZXBBc3NpZ25lZS5yb2xlID0gbm90aWZpY2F0aW9uLnJlY2lwaWVudHMuc3RlcEFzc2lnbmVlLnJvbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZWNpcGllbnRzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3RpZmljYXRpb24ucmVjaXBpZW50cy5zdGVwQXNzaWduZWVGcm9tU3RlcCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuc3RlcEFzc2lnbmVlRnJvbVN0ZXAgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcElkID0gbm90aWZpY2F0aW9uLnJlY2lwaWVudHMuc3RlcEFzc2lnbmVlRnJvbVN0ZXAuc3RlcElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuc3RlcEFzc2lnbmVlRnJvbVN0ZXAuc3RlcElkID0gc3RlcElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNhbGN1a2F0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhpc3RvcnlPYmplY3QgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgc3ViUHJvY2Vzc09iamVjdC5oaXN0b3J5Lmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3ViUHJvY2Vzc09iamVjdC5oaXN0b3J5W2ldLmlkID09IHN0ZXBJZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaXN0b3J5T2JqZWN0ID0gc3ViUHJvY2Vzc09iamVjdC5oaXN0b3J5W2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGhpc3RvcnlPYmplY3QuYXNzaWdubWVudEhpc3RvcnkgIT0gdW5kZWZpbmVkICYmIGhpc3RvcnlPYmplY3QuYXNzaWdubWVudEhpc3RvcnkubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBoaXN0b3J5T2JqZWN0LmFzc2lnbm1lbnRIaXN0b3J5W2hpc3RvcnlPYmplY3QuYXNzaWdubWVudEhpc3RvcnkubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuc3RlcEFzc2lnbmVlRnJvbVN0ZXAudXNlcklkID0gb2JqLnVzZXJJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZWNpcGllbnRzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3RpZmljYXRpb24ucmVjaXBpZW50cy5pbmRpY2F0b3IgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLmluZGljYXRvciA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXRJZCA9IG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLmluZGljYXRvci5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudElkID0gbm90aWZpY2F0aW9uLnJlY2lwaWVudHMuaW5kaWNhdG9yLmVsZW1lbnRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIGluZGljYXRvclNldElkICsgXCInXS9pbnN0YW5jZXMvdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy9tb2RlbC9wZW5kaW5nL2RhdGEvJyArIGluZGljYXRvclNldElkICsgJy8nICsgZWxlbWVudElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXRWYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5pbmRpY2F0b3IudXNlcklkID0gcmV0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZWNpcGllbnRzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSBuZXcgTm90aWZpY2F0aW9Xb3JrZXIoYXBwKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvZmlsZUlkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL21ldGEtZGF0YS9zdWJwcm9maWxlSWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciBwYXRoQXJyYXkgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhc2VVUkwgPSBET01BSU4ucmVwbGFjZShcImV4aXN0L3Jlc3RcIixcIlwiKTsgXG4gICAgICAgICAgICAgICAgICAgIC8vd2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3QgKyBcIi9cIiArIHBhdGhBcnJheVsxXTtcblxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VUeXBlXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXRhLWRhdGFcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogX1dGSW5zdGFuY2UuYXBwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IF9XRkluc3RhbmNlLmNvbW11bml0eUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvZmlsZUlkXCI6IHN1YlByb2ZpbGVJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25UeXBlXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJwcm9maWxlSWRcIjogc3VicHJvZmlsZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJpb3JpdHlcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJlY2lwaWVudHNcIjoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVybFwiOiBiYXNlVVJMLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwia2V5c1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3VycmVudFVzZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWxpZERhdGVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZHVlRGF0ZVwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlZERhdGVUaW1lXCI6IG1vbWVudCgpLmZvcm1hdCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0ZXBDcmVhdGVkRGF0ZVRpbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcE5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcElkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub2RlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidGl0bGVcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgICAgICBLZXlzIG1lc3NhZ2UgXG4gICAgICAgICAgICAgICAgICAgICovXG5cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclRpdGxlID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBhcHAucHJvZmlsZS5faWQgKyBcIiddL3RpdGxlXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMucHJvZmlsZS5uYW1lID0gaW5kaWNhdG9yVGl0bGU7XG5cbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnByb2ZpbGUuaWQgPSBhcHAucHJvZmlsZS5faWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmNvbW11bml0eS5uYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoTE9DQUxfU0VUVElOR1MuQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmNvbW11bml0eS5pZCA9IExPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9DT05GSUcuY29tbXVuaXR5SWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9hcHBsaWNhdGlvbnNbYXBwSWQgZXEgJ1wiICsgYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQgKyBcIiddXCIsIExPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9DT05GSUcsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuYXBwbGljYXRpb24ubmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKGFwcGxpY2F0aW9uLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuYXBwbGljYXRpb24uaWQgPSBhcHBsaWNhdGlvbi5hcHBJZDtcblxuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY3VycmVudFVzZXIubmFtZSA9IExPQ0FMX1NFVFRJTkdTLlNFU1NJT04uZmlyc3ROYW1lICsgXCIgXCIgKyBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmxhc3ROYW1lO1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY3VycmVudFVzZXIuaWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MubmFtZSA9IHN1YlByb2Nlc3NPYmplY3QubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLmlkID0gdXVpZDtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MudmFsaWREYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MuZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMuZHVlO1xuXG4gICAgICAgICAgICAgICAgICAgIHRyeXtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBzdWJQcm9jZXNzT2JqZWN0LnN0ZXA7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3RlcC5zdGVwQ3JlYXRlZERhdGVUaW1lID0gc3RlcE9iamVjdC5kYXRlVGltZUNyZWF0ZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3RlcC5zdGVwSWQgPSBzdGVwT2JqZWN0LmlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcENvbmZpZ09iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc09iamVjdC5pZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBPYmplY3QuaWQgKyBcIiddXCIsIGFwcC5TQ09QRS53b3JrZmxvdy5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN0ZXAuc3RlcE5hbWUgPSBhcHAuZ2V0TmFtZUJ5TGFuZyhzdGVwQ29uZmlnT2JqZWN0Lm5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2goZSl7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZVRpdGxlID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBzdWJwcm9maWxlSWQgKyBcIiddL3RpdGxlXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgXG5cblxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZVRpdGxlID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLm5vZGUudGl0bGUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLm5vZGUudGl0bGUgPSBub2RlVGl0bGU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgICAgIFdvcmtlciBtZXNzYWdlIFxuICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UuZGVmYXVsdCA9IG5vdGlmaWNhdGlvbi5tZXNzYWdlLmRlZmF1bHQ7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS50aXRsZSA9IG5vdGlmaWNhdGlvbi5tZXNzYWdlLnRpdGxlO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24ubWVzc2FnZS5ydGYgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UucnRmID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLm1lc3NhZ2UucnRmLnRlbXBsYXRlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5ydGYudGVtcGxhdGUgPSBub3RpZmljYXRpb24ubWVzc2FnZS5ydGYudGVtcGxhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5tZXNzYWdlLnJ0Zi5tYXJrdXAgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLnJ0Zi5tYXJrdXAgPSBub3RpZmljYXRpb24ubWVzc2FnZS5ydGYubWFya3VwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgICAgICBXb3JrZXIgbWVzc2FnZVR5cGUgXG4gICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZVR5cGUgPSBub3RpZmljYXRpb24ubWVzc2FnZVR5cGU7XG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgICAgICBXb3JrZXIgbm90aWZpY2F0aW9uVHlwZSBcbiAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25UeXBlID0gbm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvblR5cGU7XG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgICAgICBXb3JrZXIgcHJpb3JpdHkgXG4gICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucHJpb3JpdHkgPSBub3RpZmljYXRpb24ucHJpb3JpdHk7XG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgICAgICBXb3JrZXIgbm90aWZpY2F0aW9uQWN0aW9uIGlmIGV4aXN0cyBcbiAgICAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbiAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmxhYmVsID0gbm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5sYWJlbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkkgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJID0gbm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG8gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uZ290byA9IG5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG87XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24uc2NoZWR1bGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBleGVjdXRlT2JqZWN0ID0gbm90aWZpY2F0aW9uLnNjaGVkdWxlLmV4ZWN1dGVDb21tYW5kO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgd29ya2VyU2NoZWR1bGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVRpbWU6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pdDogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3I6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4ZWN1dGVPYmplY3Qubm93ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3QuZXhhY3QgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGV4ZWN1dGVPYmplY3QuZXhhY3QuZGF0ZVRpbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5kdWVEYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMuZHVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGR1ZURhdGUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoZHVlRGF0ZSwgXCJZWVlZLU1NLUREXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3QuZHVlRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUudW5pdCA9IGV4ZWN1dGVPYmplY3QuZHVlRGF0ZS51bml0O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3QudmFsaWREYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMudmFsaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWREYXRlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KHZhbGlkRGF0ZSwgXCJZWVlZLU1NLUREXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3QudmFsaWREYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC52YWxpZERhdGUudW5pdDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0ZWREYXRlVGltZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBDcmVhdGVkRGF0ZVRpbWUgPSBzdWJQcm9jZXNzT2JqZWN0LnN0ZXAuZHVlRGF0ZVRpbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RlcENyZWF0ZWREYXRlVGltZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudChzdGVwQ3JlYXRlZERhdGVUaW1lKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUudW5pdCA9IGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlLnVuaXQ7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldFNjaGVkdWxlKHdvcmtlclNjaGVkdWxlKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgcmVjaXBpZW50c1xuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICBnZXRSZWNpcGllbnRzKG5vdGlmaWNhdGlvbikudGhlbihmdW5jdGlvbihyZWNpcGllbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5yZWNpcGllbnRzID0gcmVjaXBpZW50O1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0TWVzc2FnZShcIlRoZSBzZXJ2ZXIgaXMgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuIFBsZWFzZSB3YWl0IGEgZmV3IHNlY29uZHMgYW5kIHRoZW4gY2xpY2sgdGhlIHJlZnJlc2ggYnV0dG9uLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldEFjdGlvbihhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0Q29udGV4dCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGVwOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcERhdGVUaW1lOiBzdWJQcm9jZXNzT2JqZWN0LnN0ZXAuZGF0ZVRpbWVDcmVhdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZCgpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cod29ya2VyT2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdOb3RpZmljYXRpb24gV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vdGlmaWNhdGlvbiAtIGdldFJlY2lwaWVudHMgZmFpbGVkIHdpdGggZXJyb3IgXCIgKyBlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcblxuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cblxuICAgICAgICByZUFzc2lnbm1lbnROb3RpZmljYXRpb246IGZ1bmN0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHV1aWQsIHVzZXIpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgZ2V0UmVjaXBpZW50cyA9IGZ1bmN0aW9uKHVzZXJPYmopIHtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjaXBpZW50cyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IHVzZXJPYmouaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2lwaWVudHMpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSBuZXcgTm90aWZpY2F0aW9Xb3JrZXIoYXBwKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9maWxlSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vbWV0YS1kYXRhL3N1YnByb2ZpbGVJZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIC8vIHZhciBwYXRoQXJyYXkgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKTtcbiAgICAgICAgICAgICAgICB2YXIgYmFzZVVSTCA9IERPTUFJTi5yZXBsYWNlKFwiZXhpc3QvcmVzdFwiLFwiXCIpO1xuICAgICAgICAgICAgICAgIC8vd2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3QgKyBcIi9cIiArIHBhdGhBcnJheVsxXTtcblxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJ0ZlwiOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlVHlwZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXRhLWRhdGFcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBfV0ZJbnN0YW5jZS5hcHAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBfV0ZJbnN0YW5jZS5jb21tdW5pdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2ZpbGVJZFwiOiBzdWJQcm9maWxlSWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvblR5cGVcIjogXCJ3b3JrZmxvd1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcmlvcml0eVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWNpcGllbnRzXCI6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidXJsXCI6IGJhc2VVUkwsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImtleXNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3VycmVudFVzZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbGlkRGF0ZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImR1ZURhdGVcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZWREYXRlVGltZVwiOiBtb21lbnQoKS5mb3JtYXQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwQ3JlYXRlZERhdGVUaW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcE5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwSWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub2RlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aXRsZVwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgS2V5cyBtZXNzYWdlIFxuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVGl0bGUgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGFwcC5wcm9maWxlLl9pZCArIFwiJ10vdGl0bGVcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5wcm9maWxlLm5hbWUgPSBpbmRpY2F0b3JUaXRsZTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMucHJvZmlsZS5pZCA9IGFwcC5wcm9maWxlLl9pZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jb21tdW5pdHkubmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKExPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9DT05GSUcuY29tbXVuaXR5TmFtZSk7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmNvbW11bml0eS5pZCA9IExPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9DT05GSUcuY29tbXVuaXR5SWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgYXBwbGljYXRpb24gPSBKU09OLnhwYXRoKFwiL2FwcGxpY2F0aW9uc1thcHBJZCBlcSAnXCIgKyBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCArIFwiJ11cIiwgTE9DQUxfU0VUVElOR1MuQ09NTVVOSVRZX0NPTkZJRywge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmFwcGxpY2F0aW9uLm5hbWUgPSBhcHAuZ2V0TmFtZUJ5TGFuZyhhcHBsaWNhdGlvbi5uYW1lKTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuYXBwbGljYXRpb24uaWQgPSBhcHBsaWNhdGlvbi5hcHBJZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jdXJyZW50VXNlci5uYW1lID0gTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5maXJzdE5hbWUgKyBcIiBcIiArIExPQ0FMX1NFVFRJTkdTLlNFU1NJT04ubGFzdE5hbWU7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmN1cnJlbnRVc2VyLmlkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQ7XG5cblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLm5hbWUgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vbGFiZWxcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy5pZCA9IHV1aWQ7XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy52YWxpZERhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLnZhbGlkO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLmR1ZURhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLmR1ZTtcblxuICAgICAgICAgICAgICAgIHZhciBzdGVwT2JqZWN0ID0gc3ViUHJvY2Vzc09iamVjdC5zdGVwO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBDcmVhdGVkRGF0ZVRpbWUgPSBzdGVwT2JqZWN0LmRhdGVUaW1lQ3JlYXRlZDtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3RlcC5zdGVwSWQgPSBzdGVwT2JqZWN0LmlkO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN0ZXBDb25maWdPYmplY3QgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NPYmplY3QuaWQgKyBcIiddL3N0ZXBzW19pZCBlcSAnXCIgKyBzdGVwT2JqZWN0LmlkICsgXCInXVwiLCBhcHAuU0NPUEUud29ya2Zsb3cuY29uZmlnLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN0ZXAuc3RlcE5hbWUgPSBhcHAuZ2V0TmFtZUJ5TGFuZyhzdGVwQ29uZmlnT2JqZWN0Lm5hbWUpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVUaXRsZSA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgc3VicHJvZmlsZUlkICsgXCInXS90aXRsZVwiLCBhcHAuU0NPUEUud29ya2Zsb3csIHt9KVswXTtcblxuXG5cblxuICAgICAgICAgICAgICAgIGlmIChub2RlVGl0bGUgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5ub2RlLnRpdGxlID0gXCJcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMubm9kZS50aXRsZSA9IG5vZGVUaXRsZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBtZXNzYWdlIFxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLmRlZmF1bHQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS50aXRsZSA9IG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQudGl0bGU7XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UucnRmLm1hcmt1cCA9IG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQubWVzc2FnZTtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBtZXNzYWdlVHlwZSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZVR5cGUgPSBub3RpZmljYXRpb24ucmVBc3NpZ25tZW50Lm1lc3NhZ2VUeXBlO1xuXG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBwcmlvcml0eSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucHJpb3JpdHkgPSBub3RpZmljYXRpb24ucmVBc3NpZ25tZW50LnByaW9yaXR5O1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIG5vdGlmaWNhdGlvbkFjdGlvbiBpZiBleGlzdHMgXG4gICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24ucmVBc3NpZ25tZW50Lm5vdGlmaWNhdGlvbkFjdGlvbiAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5sYWJlbCA9IG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQubm90aWZpY2F0aW9uQWN0aW9uLmxhYmVsO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLlVSSSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJID0gbm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLlVSSTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvID0gbm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG87XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQuc2NoZWR1bGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGV4ZWN1dGVPYmplY3QgPSBub3RpZmljYXRpb24ucmVBc3NpZ25tZW50LnNjaGVkdWxlLmV4ZWN1dGVDb21tYW5kO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB3b3JrZXJTY2hlZHVsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVUaW1lOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdW5pdDogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcjogXCJcIlxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4ZWN1dGVPYmplY3Qubm93ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LmV4YWN0ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGV4ZWN1dGVPYmplY3QuZXhhY3QuZGF0ZVRpbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LmR1ZURhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0ZWREYXRlVGltZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMuZHVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZHVlRGF0ZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KGR1ZURhdGUsIFwiWVlZWS1NTS1ERFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC5kdWVEYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LmR1ZURhdGUudW5pdDtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3QudmFsaWREYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbGlkRGF0ZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KHZhbGlkRGF0ZSwgXCJZWVlZLU1NLUREXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC52YWxpZERhdGUudW5pdDtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwQ3JlYXRlZERhdGVUaW1lID0gc3ViUHJvY2Vzc09iamVjdC5zdGVwLmR1ZURhdGVUaW1lO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RlcENyZWF0ZWREYXRlVGltZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KHN0ZXBDcmVhdGVkRGF0ZVRpbWUpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUudW5pdDtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRTY2hlZHVsZSh3b3JrZXJTY2hlZHVsZSk7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgcmVjaXBpZW50c1xuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICBnZXRSZWNpcGllbnRzKHVzZXIpLnRoZW4oZnVuY3Rpb24ocmVjaXBpZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucmVjaXBpZW50cyA9IHJlY2lwaWVudDtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldEFjdGlvbihhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0TWVzc2FnZShcIlRoZSBzZXJ2ZXIgaXMgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuIFBsZWFzZSB3YWl0IGEgZmV3IHNlY29uZHMgYW5kIHRoZW4gY2xpY2sgdGhlIHJlZnJlc2ggYnV0dG9uLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmQoKS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ05vdGlmaWNhdGlvbiBXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseSBmb3IgcmVhc3NpZ25tZW50LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOb3RpZmljYXRpb24gLSBnZXRSZWNpcGllbnRzIGZhaWxlZCB3aXRoIGVycm9yIFwiICsgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG5cblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGFzc2lnbm1lbnROb3RpZmljYXRpb246IGZ1bmN0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHV1aWQsIHVzZXIpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgZ2V0UmVjaXBpZW50cyA9IGZ1bmN0aW9uKHVzZXJPYmopIHtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjaXBpZW50cyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IHVzZXJPYmouaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2lwaWVudHMpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gbmV3IE5vdGlmaWNhdGlvV29ya2VyKGFwcCk7XG5cblxuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9maWxlSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vbWV0YS1kYXRhL3N1YnByb2ZpbGVJZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIHZhciBwYXRoQXJyYXkgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKTtcbiAgICAgICAgICAgICAgICB2YXIgYmFzZVVSTCA9IERPTUFJTi5yZXBsYWNlKFwiZXhpc3QvcmVzdFwiLFwiXCIpO1xuICAgICAgICAgICAgICAgIC8vd2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3QgKyBcIi9cIiArIHBhdGhBcnJheVsxXTtcblxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJ0ZlwiOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlVHlwZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXRhLWRhdGFcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBfV0ZJbnN0YW5jZS5hcHAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBfV0ZJbnN0YW5jZS5jb21tdW5pdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2ZpbGVJZFwiOiBzdWJQcm9maWxlSWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvblR5cGVcIjogXCJ3b3JrZmxvd1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcmlvcml0eVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWNpcGllbnRzXCI6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidXJsXCI6IGJhc2VVUkwsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImtleXNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3VycmVudFVzZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbGlkRGF0ZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImR1ZURhdGVcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZWREYXRlVGltZVwiOiBtb21lbnQoKS5mb3JtYXQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwQ3JlYXRlZERhdGVUaW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcE5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwSWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub2RlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aXRsZVwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgS2V5cyBtZXNzYWdlIFxuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVGl0bGUgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGFwcC5wcm9maWxlLl9pZCArIFwiJ10vdGl0bGVcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnByb2ZpbGUubmFtZSA9IGluZGljYXRvclRpdGxlO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5wcm9maWxlLmlkID0gYXBwLnByb2ZpbGUuX2lkO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmNvbW11bml0eS5uYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoTE9DQUxfU0VUVElOR1MuQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlOYW1lKTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY29tbXVuaXR5LmlkID0gTE9DQUxfU0VUVElOR1MuQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlJZDtcblxuICAgICAgICAgICAgICAgIHZhciBhcHBsaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvYXBwbGljYXRpb25zW2FwcElkIGVxICdcIiArIGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkICsgXCInXVwiLCBMT0NBTF9TRVRUSU5HUy5DT01NVU5JVFlfQ09ORklHLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuYXBwbGljYXRpb24ubmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKGFwcGxpY2F0aW9uLm5hbWUpO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5hcHBsaWNhdGlvbi5pZCA9IGFwcGxpY2F0aW9uLmFwcElkO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmN1cnJlbnRVc2VyLm5hbWUgPSBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmZpcnN0TmFtZSArIFwiIFwiICsgTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5sYXN0TmFtZTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY3VycmVudFVzZXIuaWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcblxuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MubmFtZSA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9sYWJlbFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLmlkID0gdXVpZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLnZhbGlkRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMudmFsaWQ7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MuZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMuZHVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBzdWJQcm9jZXNzT2JqZWN0LnN0ZXA7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN0ZXAuc3RlcENyZWF0ZWREYXRlVGltZSA9IHN0ZXBPYmplY3QuZGF0ZVRpbWVDcmVhdGVkO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBJZCA9IHN0ZXBPYmplY3QuaWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RlcENvbmZpZ09iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc09iamVjdC5pZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBPYmplY3QuaWQgKyBcIiddXCIsIGFwcC5TQ09QRS53b3JrZmxvdy5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBOYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoc3RlcENvbmZpZ09iamVjdC5uYW1lKTtcblxuICAgICAgICAgICAgICAgIHZhciBub2RlVGl0bGUgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIHN1YnByb2ZpbGVJZCArIFwiJ10vdGl0bGVcIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgaWYgKG5vZGVUaXRsZSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLm5vZGUudGl0bGUgPSBcIlwiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5ub2RlLnRpdGxlID0gbm9kZVRpdGxlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIG1lc3NhZ2UgXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UuZGVmYXVsdCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLnRpdGxlID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQudGl0bGU7XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UucnRmLm1hcmt1cCA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Lm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbWVzc2FnZVR5cGUgXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2VUeXBlID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQubWVzc2FnZVR5cGU7XG5cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIHByaW9yaXR5IFxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5wcmlvcml0eSA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50LnByaW9yaXR5O1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIG5vdGlmaWNhdGlvbkFjdGlvbiBpZiBleGlzdHMgXG4gICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24uYXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24ubGFiZWwgPSBub3RpZmljYXRpb24uYXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24ubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24uYXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLlVSSSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3RpZmljYXRpb24uYXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG8gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG8gPSBub3RpZmljYXRpb24uYXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG87XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24uYXNzaWdubWVudC5zY2hlZHVsZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZXhlY3V0ZU9iamVjdCA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50LnNjaGVkdWxlLmV4ZWN1dGVDb21tYW5kO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB3b3JrZXJTY2hlZHVsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVUaW1lOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdW5pdDogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcjogXCJcIlxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4ZWN1dGVPYmplY3Qubm93ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LmV4YWN0ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGV4ZWN1dGVPYmplY3QuZXhhY3QuZGF0ZVRpbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LmR1ZURhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR1ZURhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLmR1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGR1ZURhdGUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudChkdWVEYXRlLCBcIllZWVktTU0tRERcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3QuZHVlRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC5kdWVEYXRlLnVuaXQ7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0ZWREYXRlVGltZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMudmFsaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWxpZERhdGUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCh2YWxpZERhdGUsIFwiWVlZWS1NTS1ERFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC52YWxpZERhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUudW5pdCA9IGV4ZWN1dGVPYmplY3QudmFsaWREYXRlLnVuaXQ7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0ZWREYXRlVGltZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcENyZWF0ZWREYXRlVGltZSA9IHN1YlByb2Nlc3NPYmplY3Quc3RlcC5kdWVEYXRlVGltZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0ZXBDcmVhdGVkRGF0ZVRpbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudChzdGVwQ3JlYXRlZERhdGVUaW1lKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUudW5pdCA9IGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlLnVuaXQ7XG5cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0U2NoZWR1bGUod29ya2VyU2NoZWR1bGUpO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgcmVjaXBpZW50c1xuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICBnZXRSZWNpcGllbnRzKHVzZXIpLnRoZW4oZnVuY3Rpb24ocmVjaXBpZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucmVjaXBpZW50cyA9IHJlY2lwaWVudDtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldEFjdGlvbihhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0TWVzc2FnZShcIlRoZSBzZXJ2ZXIgaXMgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuIFBsZWFzZSB3YWl0IGEgZmV3IHNlY29uZHMgYW5kIHRoZW4gY2xpY2sgdGhlIHJlZnJlc2ggYnV0dG9uLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmQoKS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHdvcmtlck9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnTm90aWZpY2F0aW9uIFdvcmtlciBwcm9jZXNzZXMgc3VjY2Vzc2Z1bGx5IGZvciBhc3NpZ25tZW50LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOb3RpZmljYXRpb24gLSBnZXRSZWNpcGllbnRzIGZhaWxlZCB3aXRoIGVycm9yIFwiICsgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG5cblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGFjY2VwdGFuY2VOb3RpZmljYXRpb246IGZ1bmN0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHV1aWQsIHJvbGUpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgZ2V0Um9sZXMgPSBmdW5jdGlvbihyb2xlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlY2lwaWVudHMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMucm9sZSA9IHJvbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2lwaWVudHMpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gbmV3IE5vdGlmaWNhdGlvV29ya2VyKGFwcCk7XG5cblxuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9maWxlSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vbWV0YS1kYXRhL3N1YnByb2ZpbGVJZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gdmFyIHBhdGhBcnJheSA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdCgnLycpO1xuICAgICAgICAgICAgICAgIHZhciBiYXNlVVJMID0gRE9NQUlOLnJlcGxhY2UoXCJleGlzdC9yZXN0XCIsXCJcIik7XG4gICAgICAgICAgICAgICAgLy93aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgKyBcIi8vXCIgKyB3aW5kb3cubG9jYXRpb24uaG9zdCArIFwiL1wiICsgcGF0aEFycmF5WzFdO1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicnRmXCI6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VUeXBlXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1ldGEtZGF0YVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IF9XRkluc3RhbmNlLmFwcCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IF9XRkluc3RhbmNlLmNvbW11bml0eUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvZmlsZUlkXCI6IHN1YlByb2ZpbGVJZFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uVHlwZVwiOiBcIndvcmtmbG93XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByaW9yaXR5XCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlY2lwaWVudHNcIjoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ1cmxcIjogYmFzZVVSTCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwia2V5c1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjdXJyZW50VXNlclwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsaWREYXRlXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZHVlRGF0ZVwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlZERhdGVUaW1lXCI6IG1vbWVudCgpLmZvcm1hdCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0ZXBcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0ZXBDcmVhdGVkRGF0ZVRpbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwTmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0ZXBJZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5vZGVcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRpdGxlXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBLZXlzIG1lc3NhZ2UgXG4gICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JUaXRsZSA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgYXBwLnByb2ZpbGUuX2lkICsgXCInXS90aXRsZVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5wcm9maWxlLm5hbWUgPSBpbmRpY2F0b3JUaXRsZTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMucHJvZmlsZS5pZCA9IGFwcC5wcm9maWxlLl9pZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jb21tdW5pdHkubmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKExPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9DT05GSUcuY29tbXVuaXR5TmFtZSk7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmNvbW11bml0eS5pZCA9IExPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9DT05GSUcuY29tbXVuaXR5SWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgYXBwbGljYXRpb24gPSBKU09OLnhwYXRoKFwiL2FwcGxpY2F0aW9uc1thcHBJZCBlcSAnXCIgKyBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCArIFwiJ11cIiwgTE9DQUxfU0VUVElOR1MuQ09NTVVOSVRZX0NPTkZJRywge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmFwcGxpY2F0aW9uLm5hbWUgPSBhcHAuZ2V0TmFtZUJ5TGFuZyhhcHBsaWNhdGlvbi5uYW1lKTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuYXBwbGljYXRpb24uaWQgPSBhcHBsaWNhdGlvbi5hcHBJZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jdXJyZW50VXNlci5uYW1lID0gTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5maXJzdE5hbWUgKyBcIiBcIiArIExPQ0FMX1NFVFRJTkdTLlNFU1NJT04ubGFzdE5hbWU7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmN1cnJlbnRVc2VyLmlkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLm5hbWUgPSBzdWJQcm9jZXNzT2JqZWN0LmxhYmVsO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLmlkID0gdXVpZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLnZhbGlkRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMudmFsaWQ7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MuZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMuZHVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBzdWJQcm9jZXNzT2JqZWN0LnN0ZXA7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN0ZXAuc3RlcENyZWF0ZWREYXRlVGltZSA9IHN0ZXBPYmplY3QuZGF0ZVRpbWVDcmVhdGVkO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBJZCA9IHN0ZXBPYmplY3QuaWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RlcENvbmZpZ09iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc09iamVjdC5pZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBPYmplY3QuaWQgKyBcIiddXCIsIGFwcC5TQ09QRS53b3JrZmxvdy5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3RlcC5zdGVwTmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKHN0ZXBDb25maWdPYmplY3QubmFtZSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZVRpdGxlID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBzdWJQcm9maWxlSWQgKyBcIiddL3RpdGxlXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgIGlmIChub2RlVGl0bGUgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5ub2RlLnRpdGxlID0gXCJcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMubm9kZS50aXRsZSA9IG5vZGVUaXRsZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBtZXNzYWdlIFxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLmRlZmF1bHQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS50aXRsZSA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS50aXRsZTtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5ydGYubWFya3VwID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbWVzc2FnZVR5cGUgXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2VUeXBlID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm1lc3NhZ2VUeXBlO1xuXG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBwcmlvcml0eSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucHJpb3JpdHkgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2UucHJpb3JpdHk7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbm90aWZpY2F0aW9uQWN0aW9uIGlmIGV4aXN0cyBcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5ub3RpZmljYXRpb25BY3Rpb24gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24ubGFiZWwgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmxhYmVsO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkkgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uZ290bztcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5zY2hlZHVsZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZXhlY3V0ZU9iamVjdCA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5zY2hlZHVsZS5leGVjdXRlQ29tbWFuZDtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgd29ya2VyU2NoZWR1bGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuaXQ6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3I6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChleGVjdXRlT2JqZWN0Lm5vdyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5leGFjdCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBleGVjdXRlT2JqZWN0LmV4YWN0LmRhdGVUaW1lO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5kdWVEYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy5kdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkdWVEYXRlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoZHVlRGF0ZSwgXCJZWVlZLU1NLUREXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LmR1ZURhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUudW5pdCA9IGV4ZWN1dGVPYmplY3QuZHVlRGF0ZS51bml0O1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC52YWxpZERhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR1ZURhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLnZhbGlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWREYXRlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQodmFsaWREYXRlLCBcIllZWVktTU0tRERcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3QudmFsaWREYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZS51bml0O1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBDcmVhdGVkRGF0ZVRpbWUgPSBzdWJQcm9jZXNzT2JqZWN0LnN0ZXAuZHVlRGF0ZVRpbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGVwQ3JlYXRlZERhdGVUaW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoc3RlcENyZWF0ZWREYXRlVGltZSkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZS51bml0O1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldFNjaGVkdWxlKHdvcmtlclNjaGVkdWxlKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIHJlY2lwaWVudHNcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgZ2V0Um9sZXMocm9sZSkudGhlbihmdW5jdGlvbihyZWNpcGllbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5yZWNpcGllbnRzID0gcmVjaXBpZW50O1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0QWN0aW9uKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRNZXNzYWdlKFwiVGhlIHNlcnZlciBpcyBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4gUGxlYXNlIHdhaXQgYSBmZXcgc2Vjb25kcyBhbmQgdGhlbiBjbGljayB0aGUgcmVmcmVzaCBidXR0b24uXCIpO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0Q29udGV4dCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh3b3JrZXJPYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ05vdGlmaWNhdGlvbiBXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseSBmb3IgYXNzaWdubWVudC4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTm90aWZpY2F0aW9uIC0gZ2V0UmVjaXBpZW50cyBmYWlsZWQgd2l0aCBlcnJvciBcIiArIGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuXG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBhY2NlcHRhbmNlTm90aWZpY2F0aW9uRXh0ZXJuYWw6IGZ1bmN0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHV1aWQsIHVzZXJzTGlzdCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblxuICAgICAgICAgICAgICAgIHZhciBnZXRVc2Vyc0xpc3QgPSBmdW5jdGlvbih1TGlzdCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWNpcGllbnRzID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLmZ1bmN0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLmZ1bmN0aW9uLnVzZXJzID0gdUxpc3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2lwaWVudHMpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gbmV3IE5vdGlmaWNhdGlvV29ya2VyKGFwcCk7XG5cblxuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9maWxlSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vbWV0YS1kYXRhL3N1YnByb2ZpbGVJZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIHZhciBwYXRoQXJyYXkgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKTtcbiAgICAgICAgICAgICAgICB2YXIgYmFzZVVSTCA9IERPTUFJTi5yZXBsYWNlKFwiZXhpc3QvcmVzdFwiLFwiXCIpO1xuICAgICAgICAgICAgICAgIC8vd2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3QgKyBcIi9cIiArIHBhdGhBcnJheVsxXTtcblxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJ0ZlwiOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlVHlwZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXRhLWRhdGFcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBfV0ZJbnN0YW5jZS5hcHAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBfV0ZJbnN0YW5jZS5jb21tdW5pdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2ZpbGVJZFwiOiBzdWJQcm9maWxlSWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvblR5cGVcIjogXCJ3b3JrZmxvd1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcmlvcml0eVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWNpcGllbnRzXCI6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidXJsXCI6IGJhc2VVUkwsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImtleXNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3VycmVudFVzZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbGlkRGF0ZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImR1ZURhdGVcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZWREYXRlVGltZVwiOiBtb21lbnQoKS5mb3JtYXQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwQ3JlYXRlZERhdGVUaW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcE5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwSWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub2RlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aXRsZVwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgS2V5cyBtZXNzYWdlIFxuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVGl0bGUgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGFwcC5wcm9maWxlLl9pZCArIFwiJ10vdGl0bGVcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMucHJvZmlsZS5uYW1lID0gaW5kaWNhdG9yVGl0bGU7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnByb2ZpbGUuaWQgPSBhcHAucHJvZmlsZS5faWQ7XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY29tbXVuaXR5Lm5hbWUgPSBhcHAuZ2V0TmFtZUJ5TGFuZyhMT0NBTF9TRVRUSU5HUy5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eU5hbWUpO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jb21tdW5pdHkuaWQgPSBMT0NBTF9TRVRUSU5HUy5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eUlkO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9hcHBsaWNhdGlvbnNbYXBwSWQgZXEgJ1wiICsgYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQgKyBcIiddXCIsIExPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9DT05GSUcsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5hcHBsaWNhdGlvbi5uYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoYXBwbGljYXRpb24ubmFtZSk7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmFwcGxpY2F0aW9uLmlkID0gYXBwbGljYXRpb24uYXBwSWQ7XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY3VycmVudFVzZXIubmFtZSA9IExPQ0FMX1NFVFRJTkdTLlNFU1NJT04uZmlyc3ROYW1lICsgXCIgXCIgKyBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmxhc3ROYW1lO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jdXJyZW50VXNlci5pZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy5uYW1lID0gc3ViUHJvY2Vzc09iamVjdC5sYWJlbDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLmlkID0gdXVpZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLnZhbGlkRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMudmFsaWQ7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MuZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMuZHVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBzdWJQcm9jZXNzT2JqZWN0LnN0ZXA7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN0ZXAuc3RlcENyZWF0ZWREYXRlVGltZSA9IHN0ZXBPYmplY3QuZGF0ZVRpbWVDcmVhdGVkO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBJZCA9IHN0ZXBPYmplY3QuaWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RlcENvbmZpZ09iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc09iamVjdC5pZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBPYmplY3QuaWQgKyBcIiddXCIsIGFwcC5TQ09QRS53b3JrZmxvdy5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3RlcC5zdGVwTmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKHN0ZXBDb25maWdPYmplY3QubmFtZSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZVRpdGxlID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBzdWJQcm9maWxlSWQgKyBcIiddL3RpdGxlXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgIGlmIChub2RlVGl0bGUgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5ub2RlLnRpdGxlID0gXCJcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMubm9kZS50aXRsZSA9IG5vZGVUaXRsZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBtZXNzYWdlIFxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLmRlZmF1bHQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS50aXRsZSA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS50aXRsZTtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5ydGYubWFya3VwID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbWVzc2FnZVR5cGUgXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2VUeXBlID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm1lc3NhZ2VUeXBlO1xuXG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBwcmlvcml0eSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucHJpb3JpdHkgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2UucHJpb3JpdHk7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbm90aWZpY2F0aW9uQWN0aW9uIGlmIGV4aXN0cyBcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5ub3RpZmljYXRpb25BY3Rpb24gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24ubGFiZWwgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmxhYmVsO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkkgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uZ290bztcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5zY2hlZHVsZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZXhlY3V0ZU9iamVjdCA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5zY2hlZHVsZS5leGVjdXRlQ29tbWFuZDtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgd29ya2VyU2NoZWR1bGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuaXQ6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3I6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChleGVjdXRlT2JqZWN0Lm5vdyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5leGFjdCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBleGVjdXRlT2JqZWN0LmV4YWN0LmRhdGVUaW1lO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5kdWVEYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy5kdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkdWVEYXRlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoZHVlRGF0ZSwgXCJZWVlZLU1NLUREXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LmR1ZURhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUudW5pdCA9IGV4ZWN1dGVPYmplY3QuZHVlRGF0ZS51bml0O1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC52YWxpZERhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR1ZURhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLnZhbGlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWREYXRlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQodmFsaWREYXRlLCBcIllZWVktTU0tRERcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3QudmFsaWREYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZS51bml0O1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBDcmVhdGVkRGF0ZVRpbWUgPSBzdWJQcm9jZXNzT2JqZWN0LnN0ZXAuZHVlRGF0ZVRpbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGVwQ3JlYXRlZERhdGVUaW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoc3RlcENyZWF0ZWREYXRlVGltZSkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZS51bml0O1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldFNjaGVkdWxlKHdvcmtlclNjaGVkdWxlKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIHJlY2lwaWVudHNcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICBnZXRVc2Vyc0xpc3QodXNlcnNMaXN0KS50aGVuKGZ1bmN0aW9uKHJlY2lwaWVudCkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLnJlY2lwaWVudHMgPSByZWNpcGllbnQ7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRBY3Rpb24oYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldE1lc3NhZ2UoXCJUaGUgc2VydmVyIGlzIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0LiBQbGVhc2Ugd2FpdCBhIGZldyBzZWNvbmRzIGFuZCB0aGVuIGNsaWNrIHRoZSByZWZyZXNoIGJ1dHRvbi5cIik7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRDb250ZXh0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3M6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHdvcmtlck9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnTm90aWZpY2F0aW9uIFdvcmtlciBwcm9jZXNzZXMgc3VjY2Vzc2Z1bGx5IGZvciBhc3NpZ25tZW50LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOb3RpZmljYXRpb24gLSBnZXRSZWNpcGllbnRzIGZhaWxlZCB3aXRoIGVycm9yIFwiICsgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG5cblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG5cblxuICAgIH1cblxufSkoKTtcblxuXG52YXIgcmVwb3J0ID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuXG5cblxuICAgICAgICBjcmVhdGVQZXJmb3JtYW5jZVJlcG9ydDogZnVuY3Rpb24ocGVyZm9ybWFuY2VSZXBvcnRPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNyZWF0ZVBlcmZvcm1hbmNlUmVwb3J0XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuICAgICAgICAgICAgICAgIHZhciB3b3JrcGxhblNldElkID0gcGVyZm9ybWFuY2VSZXBvcnRPYmplY3Qud29ya3BsYW5TZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgY29uZmlnU2V0SWQgPSBwZXJmb3JtYW5jZVJlcG9ydE9iamVjdC5jb25maWdTZXRJZDtcblxuXG4gICAgICAgICAgICAgICAgLy8gd29ya3BsYW5TZXRJZCBzY29wZSBpcyBwcm9maWxlXG4gICAgICAgICAgICAgICAgLy8gY29uZmlnU2V0SWQgc2NvcGUgaXMgc3VicHJvY2Vzc2VzXG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya3BsYW5VVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgd29ya3BsYW5TZXRJZCArIFwiJ10vX2lkXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBjb25maWdVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgY29uZmlnU2V0SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZVBlcmZvcm1hbmNlUmVwb3J0XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid29ya3BsYW5VVUlEXCI6IHdvcmtwbGFuVVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29uZmlnVVVJRFwiOiBjb25maWdVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrcGxhblJlcG9ydCBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVSZXBvcnQ6IGZ1bmN0aW9uKGNyZWF0ZVJlcG9ydCwgX1dGSW5zdGFuY2UsIHV1aWQpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiZXhlY3V0ZVJlcG9ydFwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciBwZXJmb3JtYW5jZVJlcG9ydERlZmluaXRpb25TZXRJZCA9IGNyZWF0ZVJlcG9ydC5QZXJmb3JtYW5jZVJlcG9ydERlZmluaXRpb25TZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgcmVwb3J0aW5nU0RPU2V0SWQgPSBjcmVhdGVSZXBvcnQucmVwb3J0aW5nU0RPU2V0SWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgcGVyZm9ybWFuY2VSZXBvcnREZWZpbml0aW9uID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgcGVyZm9ybWFuY2VSZXBvcnREZWZpbml0aW9uU2V0SWQgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciByZXBvcnRpbmdTRE8gPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyByZXBvcnRpbmdTRE9TZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVSZXBvcnRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJwZXJmb3JtYW5jZVJlcG9ydERlZmluaXRpb25cIjogcGVyZm9ybWFuY2VSZXBvcnREZWZpbml0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZXBvcnRpbmdTRE9cIjogcmVwb3J0aW5nU0RPLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdSZXByb3QgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cblxuXG5cbiAgICAgICAgc2RvUmVwb3J0OiBmdW5jdGlvbihzZG9SZXBvcnQsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcInNkb1JlcG9ydFwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciBzZXRJZCA9IHNkb1JlcG9ydC5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgc2RvUmVwb3J0VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXBvcnRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXBvcnRVVUlEXCI6IHNkb1JlcG9ydFVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogYXBwLlNDT1BFLndvcmtmbG93LnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ3JlcG9ydCBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBleGVjdXRlUmVwb3J0OiBmdW5jdGlvbihleGVjdXRlUmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJleGVjdXRlUmVwb3J0XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuXG5cblxuICAgICAgICAgICAgICAgIHZhciBTRE9yZXBvcnRTZXRJZCA9IGV4ZWN1dGVSZXBvcnQuU0RPcmVwb3J0U2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIHJlcG9ydGluZ1NET1NldGlkID0gZXhlY3V0ZVJlcG9ydC5yZXBvcnRpbmdTRE9TZXRpZDtcblxuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIFNET3JlcG9ydFVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBTRE9yZXBvcnRTZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgcmVwb3J0aW5nU0RPVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHJlcG9ydGluZ1NET1NldGlkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgaWYgKFNET3JlcG9ydFVVSUQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIFNET3JlcG9ydFVVSUQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyBTRE9yZXBvcnRTZXRJZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImV4ZWN1dGVSZXBvcnRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXBvcnRVVUlEXCI6IFNET3JlcG9ydFVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlcG9ydGluZ1NET1VVSURcIjogcmVwb3J0aW5nU0RPVVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBhcHAuU0NPUEUud29ya2Zsb3cucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygncmVwb3J0IFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGdlbmVyYXRlVmlldzogZnVuY3Rpb24oZ2VuZXJhdGVWaWV3LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJzZG9SZXBvcnRcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG4gICAgICAgICAgICAgICAgdmFyIFZpZXdDb25maWdTZXRJZCA9IGdlbmVyYXRlVmlldy5WaWV3Q29uZmlnU2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIFZpZXdDb25maWdVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgVmlld0NvbmZpZ1NldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiZ2VuZXJhdGVWaWV3XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidmlld0NvbmZpZ1VVSURcIjogVmlld0NvbmZpZ1VVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogYXBwLlNDT1BFLndvcmtmbG93LnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ3JlcG9ydCBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICByZXF1ZXN0UmVwb3J0OiBmdW5jdGlvbihyZXF1ZXN0UmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJleGVjdXRlUmVwb3J0XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNkb1JlcXVlc3RSZXBvcnRTZXRJZCA9IHJlcXVlc3RSZXBvcnQuc2RvUmVxdWVzdFJlcG9ydFNldElkO1xuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRDcmVhdGlvblNldElkID0gcmVxdWVzdFJlcG9ydC5zZG9SZXBvcnRDcmVhdGlvblNldElkO1xuICAgICAgICAgICAgICAgIHZhciBwZXJmb3JtYW5jZVJlcG9ydFNldElkID0gcmVxdWVzdFJlcG9ydC5wZXJmb3JtYW5jZVJlcG9ydFNldElkO1xuICAgICAgICAgICAgICAgIHZhciBzZG9SZXF1ZXN0UmVwb3J0VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNkb1JlcXVlc3RSZXBvcnRTZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgc2RvUmVwb3J0Q3JlYXRpb25VVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgc2RvUmVwb3J0Q3JlYXRpb25TZXRJZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHBlcmZvcm1hbmNlUmVwb3J0VVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIHBlcmZvcm1hbmNlUmVwb3J0U2V0SWQgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJyZXF1ZXN0UmVwb3J0XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicGVyZm9ybWFuY2VSZXBvcnRVVUlEXCI6IHBlcmZvcm1hbmNlUmVwb3J0VVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic2RvUmVxdWVzdFJlcG9ydFVVSURcIjogc2RvUmVxdWVzdFJlcG9ydFVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydENyZWF0aW9uVVVJRFwiOiBzZG9SZXBvcnRDcmVhdGlvblVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogYXBwLlNDT1BFLndvcmtmbG93LnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1JlcXVlc3QgcmVwb3J0IFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG5cbiAgICAgICAgZ2VuZXJhdGVCYXNpY1ZpZXc6IGZ1bmN0aW9uKGdlbmVyYXRlQmFzaWNWaWV3LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJzZG9SZXBvcnRcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2RvRGF0YU9iamVjdFZpZXdTZXRJZCA9IGdlbmVyYXRlQmFzaWNWaWV3LnNkb0RhdGFPYmplY3RWaWV3U2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIHNkb0RhdGFPYmplY3RWaWV3VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNkb0RhdGFPYmplY3RWaWV3U2V0SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImdlbmVyYXRlQmFzaWNWaWV3XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic2RvRGF0YU9iamVjdFZpZXdVVUlEXCI6IHNkb0RhdGFPYmplY3RWaWV3VVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBhcHAuU0NPUEUud29ya2Zsb3cucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnZ2VuZXJhdGVCYXNpY1ZpZXcgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2VuZXJhdGVVbmlvblZpZXc6IGZ1bmN0aW9uKGdlbmVyYXRlVW5pb25WaWV3LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJzZG9SZXBvcnRcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2RvRGF0YU9iamVjdFZpZXdVbmlvblNldElkID0gZ2VuZXJhdGVVbmlvblZpZXcuc2RvRGF0YU9iamVjdFZpZXdVbmlvblNldElkO1xuICAgICAgICAgICAgICAgIHZhciBzZG9EYXRhT2JqZWN0Vmlld1VuaW9uVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNkb0RhdGFPYmplY3RWaWV3VW5pb25TZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiZ2VuZXJhdGVVbmlvblZpZXdcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9EYXRhT2JqZWN0Vmlld1VuaW9uVVVJRFwiOiBzZG9EYXRhT2JqZWN0Vmlld1VuaW9uVVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBhcHAuU0NPUEUud29ya2Zsb3cucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnZ2VuZXJhdGVVbmlvblZpZXcgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgc2RvUmVwb3J0TXVsdGlwbGU6IGZ1bmN0aW9uKHNkb1JlcG9ydE11bHRpcGxlLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJzZG9SZXBvcnRcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2RvUmVwb3J0Q3JlYXRpb25TZXRJZCA9IHNkb1JlcG9ydE11bHRpcGxlLnNkb1JlcG9ydENyZWF0aW9uU2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIHNkb1JlcG9ydFZpZXdzU2V0SWQgPSBzZG9SZXBvcnRNdWx0aXBsZS5zZG9SZXBvcnRWaWV3c1NldElkO1xuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRKb2luc1NldElkID0gc2RvUmVwb3J0TXVsdGlwbGUuc2RvUmVwb3J0Sm9pbnNTZXRJZDtcblxuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRDcmVhdGlvblVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBzZG9SZXBvcnRDcmVhdGlvblNldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRWaWV3c1VVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBzZG9SZXBvcnRWaWV3c1NldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRKb2luc1VVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBzZG9SZXBvcnRKb2luc1NldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwic2RvUmVwb3J0TXVsdGlwbGVcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXBvcnRDcmVhdGlvblVVSURcIjogc2RvUmVwb3J0Q3JlYXRpb25VVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXBvcnRWaWV3c1VVSURcIjogc2RvUmVwb3J0Vmlld3NVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXBvcnRKb2luc1VVSURcIjogc2RvUmVwb3J0Sm9pbnNVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IGFwcC5TQ09QRS53b3JrZmxvdy5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdzZG9SZXBvcnRNdWx0aXBsZSBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBzdWJwcm9maWxlUXVhcnRlcmx5UmVwb3J0OiBmdW5jdGlvbihzdWJwcm9maWxlUXVhcnRlcmx5UmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJleGVjdXRlUmVwb3J0XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNjaGVkdWxlUmVwb3J0SW5kaWNhdG9yID0gc3VicHJvZmlsZVF1YXJ0ZXJseVJlcG9ydC5zY2hlZHVsZVJlcG9ydEluZGljYXRvcjtcbiAgICAgICAgICAgICAgICB2YXIgc2NoZWR1bGVSZXBvcnRJbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgc2NoZWR1bGVSZXBvcnRJbmRpY2F0b3IgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRBcHByb3ZhbEluZGljYXRvciA9IHN1YnByb2ZpbGVRdWFydGVybHlSZXBvcnQuc2RvUmVwb3J0QXBwcm92YWxJbmRpY2F0b3I7XG4gICAgICAgICAgICAgICAgdmFyIHNkb1JlcG9ydEFwcHJvdmFsSW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIHNkb1JlcG9ydEFwcHJvdmFsSW5kaWNhdG9yICsgXCInIGFuZCB3b3JrZmxvd3NbMV0vcHJvY2Vzc2VzWzFdL3N1YlByb2Nlc3NVVUlEIGVxICdcIiArIHV1aWQgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG5cblxuXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcInN1YnByb2ZpbGVRdWFydGVybHlSZXBvcnRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzY2hlZHVsZVJlcG9ydEluZGljYXRvclVVSURcIjogc2NoZWR1bGVSZXBvcnRJbmRpY2F0b3JVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXBvcnRBcHByb3ZhbEluZGljYXRvclVVSURcIjogc2RvUmVwb3J0QXBwcm92YWxJbmRpY2F0b3JVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJwcm9maWxlQ29kZVwiOiBhcHAucHJvZmlsZS5zdWJQcm9maWxlLmNvZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YnByb2ZpbGVUaXRsZVwiOiBhcHAucHJvZmlsZS5zdWJQcm9maWxlLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IGFwcC5TQ09QRS53b3JrZmxvdy5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdRdWFydGVybHlSZXBvcnQgcmVwb3J0IFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuXG4gICAgICAgIH1cblxuXG5cblxuXG4gICAgfVxuXG59KSgpO1xuXG52YXIgcGFydGljaXBhbnRzID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICBsaW5rUGFydGljaXBhbnRzOiBmdW5jdGlvbihsaW5rUGFydGljaXBhbnRzLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJmb2xsb3dcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgRVBXUExpbmtQYXJ0aWNpcGFudHNJbkJ1bGtJZCA9IGxpbmtQYXJ0aWNpcGFudHMuRVBXUExpbmtQYXJ0aWNpcGFudHNJbkJ1bGtJZDtcbiAgICAgICAgICAgICAgICB2YXIgRVBXUExpbmtQYXJ0aWNpcGFudHNJbkJ1bGtJZFVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBFUFdQTGlua1BhcnRpY2lwYW50c0luQnVsa0lkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBFUFdQTG9jYWxpdHlJZCA9IGxpbmtQYXJ0aWNpcGFudHMuRVBXUExvY2FsaXR5SWQ7XG4gICAgICAgICAgICAgICAgdmFyIEVQV1BMb2NhbGl0eUlkVVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIEVQV1BMb2NhbGl0eUlkICsgXCInXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIHZhciBFUFdQQWN0aXZlUGFydGljaXBhbnRzSWQgPSBsaW5rUGFydGljaXBhbnRzLkVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZDtcbiAgICAgICAgICAgICAgICB2YXIgRVBXUEFjdGl2ZVBhcnRpY2lwYW50c0lkVVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIEVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImxpbmtQYXJ0aWNpcGFudHNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJFUFdQTGlua1BhcnRpY2lwYW50c0luQnVsa0lkVVVJRFwiOiBFUFdQTGlua1BhcnRpY2lwYW50c0luQnVsa0lkVVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiRVBXUExvY2FsaXR5SWRVVUlEXCI6IEVQV1BMb2NhbGl0eUlkVVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiRVBXUEFjdGl2ZVBhcnRpY2lwYW50c0lkVVVJRFwiOiBFUFdQQWN0aXZlUGFydGljaXBhbnRzSWRVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRVBXUExpbmtQYXJ0aWNpcGFudHMgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgbW9udGhseUF0dGVuZGFuY2U6IGZ1bmN0aW9uKG1vbnRobHlBdHRlbmRhbmNlLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJmb2xsb3dcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgRVBXUE1vbnRobHlBdHRlbmRhbmNlQnVsa1VwbG9hZElkID0gbW9udGhseUF0dGVuZGFuY2UuRVBXUE1vbnRobHlBdHRlbmRhbmNlQnVsa1VwbG9hZFVVSUQ7XG4gICAgICAgICAgICAgICAgdmFyIEVQV1BNb250aGx5QXR0ZW5kYW5jZUJ1bGtVcGxvYWRVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgRVBXUE1vbnRobHlBdHRlbmRhbmNlQnVsa1VwbG9hZElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIEVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZCA9IG1vbnRobHlBdHRlbmRhbmNlLkVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZFVVSUQ7XG4gICAgICAgICAgICAgICAgdmFyIEVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZFVVSUQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyBFUFdQQWN0aXZlUGFydGljaXBhbnRzSWQgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIEVQV1BNb250aGx5RW1wbG95bWVudFBlckxvY2FsaXR5SWQgPSBtb250aGx5QXR0ZW5kYW5jZS5FUFdQTW9udGhseUVtcGxveW1lbnRQZXJMb2NhbGl0eVVVSUQ7XG4gICAgICAgICAgICAgICAgdmFyIEVQV1BNb250aGx5RW1wbG95bWVudFBlckxvY2FsaXR5VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIEVQV1BNb250aGx5RW1wbG95bWVudFBlckxvY2FsaXR5SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG5cblxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJtb250aGx5QXR0ZW5kYW5jZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIkVQV1BNb250aGx5QXR0ZW5kYW5jZUJ1bGtVcGxvYWRVVUlEXCI6IEVQV1BNb250aGx5QXR0ZW5kYW5jZUJ1bGtVcGxvYWRVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJFUFdQQWN0aXZlUGFydGljaXBhbnRzSWRVVUlEXCI6IEVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZFVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkVQV1BNb250aGx5RW1wbG95bWVudFBlckxvY2FsaXR5VVVJRFwiOiBFUFdQTW9udGhseUVtcGxveW1lbnRQZXJMb2NhbGl0eVVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbElkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdtb250aGx5QXR0ZW5kYW5jZSBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBtb250aGx5UHJvZ3Jlc3NTdW1tYXJ5OiBmdW5jdGlvbihtb250aGx5UHJvZ3Jlc3NTdW1tYXJ5LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJmb2xsb3dcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgRVBXUE1vbnRobHlQcm9ncmVzc1N1bW1hcnlJZCA9IG1vbnRobHlQcm9ncmVzc1N1bW1hcnkuRVBXUE1vbnRobHlQcm9ncmVzc1N1bW1hcnlJZFVVSUQ7XG4gICAgICAgICAgICAgICAgdmFyIEVQV1BNb250aGx5UHJvZ3Jlc3NTdW1tYXJ5SWRVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgRVBXUE1vbnRobHlQcm9ncmVzc1N1bW1hcnlJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcblxuXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcIm1vbnRobHlQcm9ncmVzc1N1bW1hcnlcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJFUFdQTW9udGhseVByb2dyZXNzU3VtbWFyeUlkVVVJRFwiOiBFUFdQTW9udGhseVByb2dyZXNzU3VtbWFyeUlkVVVJRCxcblxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnbW9udGhseUF0dGVuZGFuY2UgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgcGFydGljaXBhbnRDb250cmFjdHM6IGZ1bmN0aW9uKHBhcnRpY2lwYW50Q29udHJhY3RzLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJmb2xsb3dcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgRVBXUFBhcnRpY2lwYW50Q29udHJhY3RzSWQgPSBwYXJ0aWNpcGFudENvbnRyYWN0cy5FUFdQUGFydGljaXBhbnRDb250cmFjdHNJZFVVSUQ7XG4gICAgICAgICAgICAgICAgdmFyIEVQV1BQYXJ0aWNpcGFudENvbnRyYWN0c0lkVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIEVQV1BQYXJ0aWNpcGFudENvbnRyYWN0c0lkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwicGFydGljaXBhbnRDb250cmFjdHNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJFUFdQUGFydGljaXBhbnRDb250cmFjdHNJZFVVSURcIjogRVBXUFBhcnRpY2lwYW50Q29udHJhY3RzSWRVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdwYXJ0aWNpcGFudENvbnRyYWN0cyBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBnZW5lcmljTGlua1BhcnRpY2lwYW50czogZnVuY3Rpb24oZ2VuZXJpY0xpbmtQYXJ0aWNpcGFudHMsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuXG52YXIgd29ya2VyID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICBnZXRXb3JrZXJXcmFwcGVyOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgdmFyIHdyYXBwZXIgPSB7XG4gICAgICAgICAgICAgICAgXCJzb3VyY2VcIjogXCJyZW1vdGVcIixcbiAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJ3b3JrZXJPYmplY3RcIixcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwiY2hhbm5lbHNcIjogW1wid29ya2VyT2JqZWN0XCJdLFxuICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcIm1lc3NhZ2VUeXBlXCI6IFwiaW5mb1wiLFxuICAgICAgICAgICAgICAgIFwiY3JlYXRlZERhdGVUaW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgXCJzZW5kZXJVc2VySWRcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcInN1YlByb2ZpbGVJZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwicGFyZW50VHJhbnNhY3Rpb25JZFwiOiAoYXBwLlNDT1BFLnR4biA9PSB1bmRlZmluZWQgPyBcIlwiIDogYXBwLlNDT1BFLnR4bi50cmFuc2FjdGlvbklkKSxcbiAgICAgICAgICAgICAgICBcImFjdGlvblwiOiB7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybiB3cmFwcGVyO1xuXG4gICAgICAgIH0sXG4gICAgICAgIHNlbmQ6IGZ1bmN0aW9uKHdvcmtlck9iamVjdCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU3VibWl0dGluZyBXb3JrZXIgT2JqZWN0IHRvIHNlcnZlcicpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHdvcmtlck9iamVjdCk7XG4gICAgICAgICAgICAgICAgZGFvLnNhdmUod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUod29ya2VyUmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRXJyb3Igc3VibWl0dGluZyB3b3JrZXIgcmVzcG9uc2UgISEnICsgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBzZW5kV29ya2VyOiBmdW5jdGlvbih3b3JrZXJDb25maWcsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcInNlbmRXb3JrZXJcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG4gICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NHZXROb2RlVmFsdWUgPSBmdW5jdGlvbihwYXJhbUJsb2NrLCBzZXEsIHBhcmFtTmFtZSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXMsIHJlaikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKHBhcmFtQmxvY2ssIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGFWYWx1ZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogc2VxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtTmFtZVwiOiBwYXJhbU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YVZhbHVlXCI6IGRhdGFWYWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzUGFyYW1zID0gZnVuY3Rpb24oY29uZmlnUGFyYW0pIHtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzLCByZWopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbWV0ZXJzQXJyYXkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtc1RvUHJvY2VzcyA9IGNvbmZpZ1BhcmFtLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29uZmlnUGFyYW0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1CbG9jayA9IGNvbmZpZ1BhcmFtW2ldLnBhcmFtZXRlclZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSBjb25maWdQYXJhbVtpXS5zZXE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtTmFtZSA9IGNvbmZpZ1BhcmFtW2ldLnBhcmFtZXRlck5hbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1WYWx1ZSA9IHByb2Nlc3NHZXROb2RlVmFsdWUocGFyYW1CbG9jaywgc2VxLCBwYXJhbU5hbWUpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzQXJyYXkucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiByZXNwb25zZS5zZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtTmFtZVwiOiByZXNwb25zZS5wYXJhbU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtVmFsdWVcIjogcmVzcG9uc2UuZGF0YVZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNUb1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1zVG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBpdGVtc1RvUHJvY2VzcyArIDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogXCJjb21tdW5pdHlJZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1WYWx1ZVwiOiBfV0ZJbnN0YW5jZS5jb21tdW5pdHlJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBpdGVtc1RvUHJvY2VzcyArIDIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogXCJhcHBsaWNhdGlvbklkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbVZhbHVlXCI6IF9XRkluc3RhbmNlLmFwcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBpdGVtc1RvUHJvY2VzcyArIDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogXCJwcm9maWxlSWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtVmFsdWVcIjogX1dGSW5zdGFuY2UucHJvZmlsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBpdGVtc1RvUHJvY2VzcyArIDQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogXCJzdWJQcm9jZXNzVVVJRFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1WYWx1ZVwiOiB1dWlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzKHBhcmFtZXRlcnNBcnJheSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNUb1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1zVG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBpdGVtc1RvUHJvY2VzcyArIDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogXCJjb21tdW5pdHlJZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1WYWx1ZVwiOiBfV0ZJbnN0YW5jZS5jb21tdW5pdHlJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBpdGVtc1RvUHJvY2VzcyArIDIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogXCJhcHBsaWNhdGlvbklkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbVZhbHVlXCI6IF9XRkluc3RhbmNlLmFwcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBpdGVtc1RvUHJvY2VzcyArIDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogXCJwcm9maWxlSWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtVmFsdWVcIjogX1dGSW5zdGFuY2UucHJvZmlsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBpdGVtc1RvUHJvY2VzcyArIDQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogXCJzdWJQcm9jZXNzVVVJRFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1WYWx1ZVwiOiB1dWlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzKHBhcmFtZXRlcnNBcnJheSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHZhciB0eXBlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAod29ya2VyQ29uZmlnLnJlc3QgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbmZpZ1BhcmFtID0gd29ya2VyQ29uZmlnLnJlc3QucGFyYW1ldGVycztcbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc1BhcmFtcyhjb25maWdQYXJhbSkudGhlbihmdW5jdGlvbihwYXJhbXNBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlbmRXb3JrZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJlc3RcIjoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLnNlbmRXb3JrZXIucmVzdC51cmkgPSB3b3JrZXJDb25maWcucmVzdC51cmk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24uc2VuZFdvcmtlci5yZXN0LnByb2ZpbElkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5zZW5kV29ya2VyLnJlc3QucGFyYW1ldGVycyA9IHBhcmFtc0FycmF5O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3BPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3Quc3BTdGF0dXMgPSAnc3VibWl0dGVkJztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzcE9iamVjdC5tZXNzYWdlcyA9PSB1bmRlZmluZWQpIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwT2JqZWN0Lm1lc3NhZ2VzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwZW5kaW5nU3VibWlzc2lvbk9iamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaTE4blwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfaWRcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImVuXCI6IFwiVGhlIHNlcnZlciBpcyBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4gUGxlYXNlIHdhaXQgYSBmZXcgc2Vjb25kcyBhbmQgdGhlbiBjbGljayB0aGUgcmVmcmVzaCBidXR0b24uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwdFwiOiBcIlRoZSBzZXJ2ZXIgaXMgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuIFBsZWFzZSB3YWl0IGEgZmV3IHNlY29uZHMgYW5kIHRoZW4gY2xpY2sgdGhlIHJlZnJlc2ggYnV0dG9uLlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcImluZm9cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3QubWVzc2FnZXMucHVzaChwZW5kaW5nU3VibWlzc2lvbk9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd29ya2VyIGlkIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3BPYmplY3Qud29ya2VycyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3Qud29ya2VycyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcE9iamVjdC53b3JrZXJzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIndvcmtlcklkXCI6IHdvcmtlck9iamVjdC5faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0ZVRpbWVcIjogbW9tZW50KCkuZm9ybWF0KClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3REYXRhKCdzdWJwcm9jZXNzZXMnLCBhcHAuU0NPUEUud29ya2Zsb3csIHV1aWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHNhdmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrZXIgUmVzdCBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihmYWlsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdXb3JrZXIgc3VibWl0dGVkIHN1YnByb2Nlc3MgZmlsZSB1cGRhdGUgZmFpbGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZmFpbGVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdXb3JrZXIgZmFpbGVkICcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJwYXJhbWV0ZXIgY3JlYXRpb24gZmFpbGVkLiBBYm9yZGluZyB3b3JrZXIgb2JqZWN0XCIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAod29ya2VyQ29uZmlnLmZ1bmN0aW9uYWwgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbmZpZ1BhcmFtID0gd29ya2VyQ29uZmlnLmZ1bmN0aW9uYWwucGFyYW1ldGVycztcbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc1BhcmFtcyhjb25maWdQYXJhbSkudGhlbihmdW5jdGlvbihwYXJhbXNBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlbmRXb3JrZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZ1bmN0aW9uYWxcIjoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLnNlbmRXb3JrZXIuZnVuY3Rpb25hbC5tZXRob2ROYW1lID0gd29ya2VyQ29uZmlnLmZ1bmN0aW9uYWwubWV0aG9kTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5zZW5kV29ya2VyLmZ1bmN0aW9uYWwucHJvZmlsSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLnNlbmRXb3JrZXIuZnVuY3Rpb25hbC5wYXJhbWV0ZXJzID0gcGFyYW1zQXJyYXk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwT2JqZWN0LnNwU3RhdHVzID0gJ3N1Ym1pdHRlZCc7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3BPYmplY3QubWVzc2FnZXMgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwT2JqZWN0Lm1lc3NhZ2VzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwZW5kaW5nU3VibWlzc2lvbk9iamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaTE4blwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfaWRcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImVuXCI6IFwiVGhlIHNlcnZlciBpcyBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4gUGxlYXNlIHdhaXQgYSBmZXcgc2Vjb25kcyBhbmQgdGhlbiBjbGljayB0aGUgcmVmcmVzaCBidXR0b24uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwdFwiOiBcIlRoZSBzZXJ2ZXIgaXMgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuIFBsZWFzZSB3YWl0IGEgZmV3IHNlY29uZHMgYW5kIHRoZW4gY2xpY2sgdGhlIHJlZnJlc2ggYnV0dG9uLlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcImluZm9cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3QubWVzc2FnZXMucHVzaChwZW5kaW5nU3VibWlzc2lvbk9iamVjdCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3b3JrZXIgaWQgaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzcE9iamVjdC53b3JrZXJzID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcE9iamVjdC53b3JrZXJzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwT2JqZWN0LndvcmtlcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwid29ya2VySWRcIjogd29ya2VyT2JqZWN0Ll9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRlVGltZVwiOiBtb21lbnQoKS5mb3JtYXQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc2lzdERhdGEoJ3N1YnByb2Nlc3NlcycsIGFwcC5TQ09QRS53b3JrZmxvdywgdXVpZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oc2F2ZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtlciBmdW5jdGlvbmFsIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGZhaWxlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1dvcmtlciBzdWJtaXR0ZWQgc3VicHJvY2VzcyBmaWxlIHVwZGF0ZSBmYWlsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChmYWlsZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnV29ya2VyIGZhaWxlZCAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGFyYW1ldGVyIGNyZWF0aW9uIGZhaWxlZC4gQWJvcmRpbmcgd29ya2VyIG9iamVjdFwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGV4ZWN1dGVMb2NhbDogZnVuY3Rpb24od29ya2VyQ29uZmlnLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblxuXG4gICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NHZXROb2RlVmFsdWUgPSBmdW5jdGlvbihwYXJhbUJsb2NrLCBzZXEsIGRhdGFUeXBlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlcywgcmVqKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUocGFyYW1CbG9jaywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YVZhbHVlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBzZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YVR5cGVcIjogZGF0YVR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YVZhbHVlXCI6IGRhdGFWYWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NQYXJhbXMgPSBmdW5jdGlvbihjb25maWdQYXJhbSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXMsIHJlaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtZXRlcnNBcnJheSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1zVG9Qcm9jZXNzID0gY29uZmlnUGFyYW0ubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb25maWdQYXJhbS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbUJsb2NrID0gY29uZmlnUGFyYW1baV0ucGFyYW1ldGVyVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlcSA9IGNvbmZpZ1BhcmFtW2ldLnNlcTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YVR5cGUgPSBjb25maWdQYXJhbVtpXS5kYXRhVHlwZS5kYXRhVHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1WYWx1ZSA9IHByb2Nlc3NHZXROb2RlVmFsdWUocGFyYW1CbG9jaywgc2VxLCBkYXRhVHlwZSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IHJlc3BvbnNlLnNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YVR5cGVcIjogcmVzcG9uc2UuZGF0YVR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtVmFsdWVcIjogcmVzcG9uc2UuZGF0YVZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNUb1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1zVG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyhwYXJhbWV0ZXJzQXJyYXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zVG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtc1RvUHJvY2VzcyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMocGFyYW1ldGVyc0FycmF5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIGZpeFBhcmFtVHlwZSA9IGZ1bmN0aW9uKHBhcmFtVmFsdWUsIGRhdGFUeXBlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChkYXRhVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInN0cmluZ1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eHQgPSBwYXJhbVZhbHVlLnJlcGxhY2UoLycvZywgXCJcXFxcJ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCInXCIgKyB0eHQgKyBcIidcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJkYXRlXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZGF0ZVRpbWVcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCInXCIgKyBwYXJhbVZhbHVlICsgXCInXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwibnVtYmVyXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZGVjaW1hbFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJhbVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHZhciBtZXRob2ROYW1lID0gd29ya2VyQ29uZmlnLm1ldGhvZE5hbWU7XG4gICAgICAgICAgICAgICAgdmFyIGNvbmZpZ1BhcmFtID0gd29ya2VyQ29uZmlnLnBhcmFtZXRlcnM7XG4gICAgICAgICAgICAgICAgcHJvY2Vzc1BhcmFtcyhjb25maWdQYXJhbSkudGhlbihmdW5jdGlvbihwYXJhbXNBcnJheSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBwTGlzdCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcmFtc0FycmF5Lmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcExpc3QgPSBwTGlzdCArIGZpeFBhcmFtVHlwZShwYXJhbXNBcnJheVtpXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVtpXS5kYXRhVHlwZSkgKyAnLCc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcExpc3QgPSBwTGlzdCArIGZpeFBhcmFtVHlwZShwYXJhbXNBcnJheVtpXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVtpXS5kYXRhVHlwZSlcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY2FsbGJhY2tTdWNjZXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShcIkZ1bmN0aW9uICdcIiArIG1ldGhvZE5hbWUgKyBcIicgZXhlY3V0ZWQuIFJlc3BvbnNlIHN1Y2Nlc3MuXCIpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2FsbGJhY2tGYWlsdXJlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KFwiRnVuY3Rpb24gJ1wiICsgbWV0aG9kTmFtZSArIFwiJyBleGVjdXRlZC4gUmVzcG9uc2UgZmFpbGVkLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNwVVVJRCA9IFwiJ1wiICsgdXVpZCArIFwiJ1wiXG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciBmdW5jID0gbWV0aG9kTmFtZSArICcoJyArIHBMaXN0ICsgJyxjYWxsYmFja1N1Y2Nlc3MsIGNhbGxiYWNrRmFpbHVyZSwnICsgc3BVVUlEICsgJyknO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdvaW5nIHRvIGV4ZWN1dGUgPT0gXCIgKyBtZXRob2ROYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgaWYocGFyYW1zQXJyYXkubGVuZ3RoID09IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgKChldmFsKG1ldGhvZE5hbWUpKShjYWxsYmFja1N1Y2Nlc3MsIGNhbGxiYWNrRmFpbHVyZSwgc3BVVUlEKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihwYXJhbXNBcnJheS5sZW5ndGggPT0gMSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAoKGV2YWwobWV0aG9kTmFtZSkpKHBhcmFtc0FycmF5WzBdLnBhcmFtVmFsdWUsIGNhbGxiYWNrU3VjY2VzcywgY2FsbGJhY2tGYWlsdXJlLCBzcFVVSUQpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHBhcmFtc0FycmF5Lmxlbmd0aCA9PSAyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICgoZXZhbChtZXRob2ROYW1lKSkocGFyYW1zQXJyYXlbMF0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbMV0ucGFyYW1WYWx1ZSwgY2FsbGJhY2tTdWNjZXNzLCBjYWxsYmFja0ZhaWx1cmUsIHNwVVVJRCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYocGFyYW1zQXJyYXkubGVuZ3RoID09IDMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgKChldmFsKG1ldGhvZE5hbWUpKShwYXJhbXNBcnJheVswXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVsxXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVsyXS5wYXJhbVZhbHVlLCBjYWxsYmFja1N1Y2Nlc3MsIGNhbGxiYWNrRmFpbHVyZSwgc3BVVUlEKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihwYXJhbXNBcnJheS5sZW5ndGggPT0gNCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAoKGV2YWwobWV0aG9kTmFtZSkpKHBhcmFtc0FycmF5WzBdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzFdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzJdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzNdLnBhcmFtVmFsdWUsIGNhbGxiYWNrU3VjY2VzcywgY2FsbGJhY2tGYWlsdXJlLCBzcFVVSUQpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHBhcmFtc0FycmF5Lmxlbmd0aCA9PSA1KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICgoZXZhbChtZXRob2ROYW1lKSkocGFyYW1zQXJyYXlbMF0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbMV0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbMl0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbM10ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbNF0ucGFyYW1WYWx1ZSwgY2FsbGJhY2tTdWNjZXNzLCBjYWxsYmFja0ZhaWx1cmUsIHNwVVVJRCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYocGFyYW1zQXJyYXkubGVuZ3RoID09IDYpe1xuICAgICAgICAgICAgICAgICAgICAgICAgKChldmFsKG1ldGhvZE5hbWUpKShwYXJhbXNBcnJheVswXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVsxXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVsyXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVszXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVs0XS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVs1XS5wYXJhbVZhbHVlLCBjYWxsYmFja1N1Y2Nlc3MsIGNhbGxiYWNrRmFpbHVyZSwgc3BVVUlEKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihwYXJhbXNBcnJheS5sZW5ndGggPT0gNyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAoKGV2YWwobWV0aG9kTmFtZSkpKHBhcmFtc0FycmF5WzBdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzFdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzJdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzNdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzRdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzVdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzZdLnBhcmFtVmFsdWUsIGNhbGxiYWNrU3VjY2VzcywgY2FsbGJhY2tGYWlsdXJlLCBzcFVVSUQpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHBhcmFtc0FycmF5Lmxlbmd0aCA9PSA4KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICgoZXZhbChtZXRob2ROYW1lKSkocGFyYW1zQXJyYXlbMF0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbMV0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbMl0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbM10ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbNF0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbNV0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbNl0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbN10ucGFyYW1WYWx1ZSwgY2FsbGJhY2tTdWNjZXNzLCBjYWxsYmFja0ZhaWx1cmUsIHNwVVVJRCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vcmVzb2x2ZShcIkxvY2FsIGZ1bmN0aW9uIGV4ZWN1dGVkXCIpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGFyYW1ldGVyIGNyZWF0aW9uIGZhaWxlZC4gQWJvcmRpbmcgd29ya2VyIG9iamVjdFwiKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG5cblxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHNldFdvcmtlckluZm9JblN1YnByb2Nlc3M6IGZ1bmN0aW9uKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpIHtcblxuICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgcGVuZGluZ1N1Ym1pc3Npb25PYmplY3QgPSB7XG4gICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJpMThuXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiX2lkXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImVuXCI6IFwiVGhlIHNlcnZlciBpcyBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4gUGxlYXNlIHdhaXQgYSBmZXcgc2Vjb25kcyBhbmQgdGhlbiBjbGljayB0aGUgcmVmcmVzaCBidXR0b24uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInB0XCI6IFwiTyBzZXJ2aWRvciBlc3TDoSBwcm9jZXNzYW5kbyBzdWEgc29saWNpdGHDp8Ojby4gUG9yIGZhdm9yIGFndWFyZGUgYWxndW5zIHNlZ3VuZG9zIGUgZGVwb2lzIGNsaXF1ZSBubyBib3TDo28gYXR1YWxpemFyLlwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcImluZm9cIlxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHN1YnByb2Nlc3NPYmplY3QubWVzc2FnZXMgPSBbXTtcbiAgICAgICAgICAgIHN1YnByb2Nlc3NPYmplY3QubWVzc2FnZXMucHVzaChwZW5kaW5nU3VibWlzc2lvbk9iamVjdCk7XG5cbiAgICAgICAgICAgIGlmIChzdWJwcm9jZXNzT2JqZWN0LndvcmtlcnMgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc3VicHJvY2Vzc09iamVjdC53b3JrZXJzID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzdWJwcm9jZXNzT2JqZWN0LndvcmtlcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgXCJ3b3JrZXJJZFwiOiB3b3JrZXJPYmplY3QuX2lkLFxuICAgICAgICAgICAgICAgIFwiZGF0ZVRpbWVcIjogbW9tZW50KCkuZm9ybWF0KClcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgfSxcblxuXG4gICAgICAgIGNyZWF0ZTogZnVuY3Rpb24od29ya2VyQ29uZmlnLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hhbm5lbCA9IHdvcmtlckNvbmZpZy5jaGFubmVsO1xuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJBY3Rpb24gPSB3b3JrZXJDb25maWcuYWN0aW9uO1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKGNoYW5uZWwpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcblxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgYWN0aW9uW3dvcmtlckFjdGlvbl0gPSB7fTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd29ya2VyQ29uZmlnLmluZGljYXRvcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gd29ya2VyQ29uZmlnLmluZGljYXRvcnNbaV0ubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZXRJZCA9IHdvcmtlckNvbmZpZy5pbmRpY2F0b3JzW2ldLnNldElkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IHdvcmtlckNvbmZpZy5pbmRpY2F0b3JzW2ldLmNvbnRleHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gXCJcIjtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoY29udGV4dCA9PSAnc3ViUHJvY2VzcycgfHwgY29udGV4dCA9PSAnY3VycmVudFN1YlByb2Nlc3NJbnN0YW5jZScgfHwgY29udGV4dCA9PSAnY3VycmVudFN1YlByb2Nlc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2lkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgc2V0SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBzZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoaWQgPT0gdW5kZWZpbmVkKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzcG9SZWYgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2p1c3QgdG8gbWFrZSBzdXJlIHRoaXMgaXMgbm90IHRoZSBjYXNlIHdoZXJlIGluZGljYXRvcnMgYXJlIG5vdCBwb3B1bGF0ZWQgZHVlIHRvIHNvbWUgb3RoZXIgcmVhc29uLCBub3cgd2UgY2FuIHNlYXJjaCBpbiBnbG9iYWwgaW5kaWNhdG9yIGFycmF5IGZvciByZWZlcmVuY2UgaW5kaWNhdG9yIGNhc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzcG9SZWYgIT0gdW5kZWZpbmVkICYmIHNwb1JlZi5pbmRpY2F0b3JzLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIHNldElkICsgXCInXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyBzZXRJZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25bd29ya2VyQWN0aW9uXVtsYWJlbF0gPSBpZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhY3Rpb25bd29ya2VyQWN0aW9uXS5wcm9maWxJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG5cbiAgICAgICAgICAgICAgICBpZiAod29ya2VyQ29uZmlnLmZpeGVkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHdvcmtlckNvbmZpZy5maXhlZC5sZW5ndGg7IGkrKykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gd29ya2VyQ29uZmlnLmZpeGVkW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IE9iamVjdC5rZXlzKG9iailbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25bd29ya2VyQWN0aW9uXVtrZXldID0gb2JqW2tleV1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh3b3JrZXJDb25maWcuZGF0YUZpZWxkcyAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uW3dvcmtlckFjdGlvbl0uZGF0YUZpZWxkcyA9IHdvcmtlckNvbmZpZy5kYXRhRmllbGRzO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2Vzcyh3b3JrZXJBY3Rpb24gKyAnIHdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cblxuXG5cblxuXG5cblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgIH1cblxufSkoKTtcblxudmFyIHVzZXIgPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAgIGFkZFRvUm9sZTogZnVuY3Rpb24oYWRkVG9Sb2xlLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShhZGRUb1JvbGUudXNlck5hbWUsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHVzZXJEaXNwbGF5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGFkZFRvUm9sZS51c2VySWQsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHVzZXJJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRleHRUeXBlID0gSlNPTi54cGF0aChcIi9yb2xlc1tpZCBlcSAnXCIgKyBhZGRUb1JvbGUucm9sZUlkICsgXCInXS90eXBlXCIsIGFwcC5TQ09QRS5BUFBfQ09ORklHLCB7fSlbMF1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRleHRUeXBlID09ICdpbnN0YW5jZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb2xlc01hbmFnZXIuZG9Vc2VyUmVnaXN0cmF0aW9uKHVzZXJJZCwgdXNlckRpc3BsYXlOYW1lLCBhZGRUb1JvbGUucm9sZUlkLCAnaW5zdGFuY2UnKS50aGVuKGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1JvbGUgYXNzaWduZWQgdG8gdXNlciBpbiBjb250ZXh0IGluc3RhbmNlJywgcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyb2xlc01hbmFnZXItIGluc3RhbmNlIGZhaWwnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncm9sZSB1cGRhdGUgZmFpbGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHRUeXBlID09ICdzdWJwcm9maWxlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvbGVzTWFuYWdlci5kb1VzZXJSZWdpc3RyYXRpb25fbm9kZSh1c2VySWQsIHVzZXJEaXNwbGF5TmFtZSwgYWRkVG9Sb2xlLnJvbGVJZCwgJ3N1YnByb2ZpbGUnKS50aGVuKGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1JvbGUgYXNzaWduZWQgdG8gdXNlciBpbiBjb250ZXh0IHN1YnByb2ZpbGUnLCBzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JvbGVzTWFuYWdlci0gc3VicHJvZmlsZSBmYWlsJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3JvbGUgdXBkYXRlIGZhaWxlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb250ZXh0VHlwZSA9PSAnYWRvcHRpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9sZXNNYW5hZ2VyLmRvVXNlclJlZ2lzdHJhdGlvbl9hZG9wdGlvbih1c2VySWQsIHVzZXJEaXNwbGF5TmFtZSwgYWRkVG9Sb2xlLnJvbGVJZCwgJ2Fkb3B0aW9uJykudGhlbihmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdSb2xlIGFzc2lnbmVkIHRvIHVzZXIgaW4gY29udGV4dCBhZG9wdGlvbicsIHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncm9sZXNNYW5hZ2VyLSBhZG9wdGlvbiBmYWlsJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3JvbGUgdXBkYXRlIGZhaWxlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnUm9sZSBub3QgZm91bmQgaW4gYW55IGNvbnRleHQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoJ1JvbGUgbm90IGZvdW5kIGluIGFueSBjb250ZXh0JylcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG5cbnZhciBnZW5lcmFsRnVuY3Rpb25zID0gKGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYWRkVG9GYXZvdXJpdGVzOiBmdW5jdGlvbihmYXZCbG9jaywgX1dGSW5zdGFuY2UsIHV1aWQpe1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbnRleHQgPSBmYXZCbG9jay5jb250ZXh0O1xuICAgICAgICAgICAgICAgIGlmKGNvbnRleHQgPT0gXCJwcm9maWxlXCIpe1xuICAgICAgICAgICAgICAgICAgICBsaWJyYXJ5LmFkZFRvRmF2b3VyaXRlc1Byb2ZpbGUoKS50aGVuKGZ1bmN0aW9uKHMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzKTtcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZihjb250ZXh0ID09IFwic3VicHJvZmlsZVwiKXtcbiAgICAgICAgICAgICAgICAgICAgbGlicmFyeS5hZGRUb0Zhdm91cml0ZXNTdWJQcm9maWxlKCkudGhlbihmdW5jdGlvbihzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocyk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoY29udGV4dCA9PSBcInN1YnByb2Nlc3NcIil7XG4gICAgICAgICAgICAgICAgICAgIGxpYnJhcnkuYWRkVG9GYXZvdXJpdGVzU3ViUHJvY2Vzcyh1dWlkKS50aGVuKGZ1bmN0aW9uKHMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzKTtcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgYWRkVG9Vc2VyRmF2b3VyaXRlczogZnVuY3Rpb24oZmF2QmxvY2ssIF9XRkluc3RhbmNlLCB1dWlkKXtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIHZhciBjb250ZXh0ID0gZmF2QmxvY2suY29udGV4dDtcbiAgICAgICAgICAgICAgICB2YXIgdXNlckJsb2NrID0gZmF2QmxvY2sudXNlcjtcbiAgICAgICAgICAgICAgICAvLyBnZXQgdXNlcklkIGZyb20gZ2V0IG5vZGUgdmFsdWUgXG4gICAgICAgICAgICAgICAgLy9wYXNzIHRvIHNvbWUgbmV3IGZ1bmN0aW9uc1xuXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJJZCA9ICcnO1xuICAgICAgICAgICAgICAgIGlmICh1c2VyQmxvY2suc3RlcEFzc2lnbmVlRnJvbVN0ZXAgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBJZCA9IHVzZXJCbG9jay5zdGVwQXNzaWduZWVGcm9tU3RlcC5zdGVwSWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBoaXN0b3J5T2JqZWN0ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBzdWJQcm9jZXNzT2JqZWN0Lmhpc3RvcnkubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3ViUHJvY2Vzc09iamVjdC5oaXN0b3J5W2ldLmlkID09IHN0ZXBJZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlzdG9yeU9iamVjdCA9IHN1YlByb2Nlc3NPYmplY3QuaGlzdG9yeVtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYoaGlzdG9yeU9iamVjdC5hc3NpZ25tZW50SGlzdG9yeSAhPSB1bmRlZmluZWQgJiYgaGlzdG9yeU9iamVjdC5hc3NpZ25tZW50SGlzdG9yeS5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBoaXN0b3J5T2JqZWN0LmFzc2lnbm1lbnRIaXN0b3J5W2hpc3RvcnlPYmplY3QuYXNzaWdubWVudEhpc3RvcnkubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQgPSBvYmoudXNlcklkO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVzZXJCbG9jay5pbmRpY2F0b3IgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXRJZCA9IHVzZXJCbG9jay5pbmRpY2F0b3IuaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50SWQgPSB1c2VyQmxvY2suaW5kaWNhdG9yLmVsZW1lbnRJZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBpbmRpY2F0b3JTZXRJZCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy9tb2RlbC9wZW5kaW5nL2RhdGEvJyArIGluZGljYXRvclNldElkICsgJy8nICsgZWxlbWVudElkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmV0VmFsdWUgPSBKU09OLnhwYXRoKHhwYXRoLCBpbmRPYmplY3QsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICB1c2VySWQgPSByZXRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmKGNvbnRleHQgPT0gXCJwcm9maWxlXCIpe1xuICAgICAgICAgICAgICAgICAgICBsaWJyYXJ5LmFkZFRvRmF2b3VyaXRlc1Byb2ZpbGVGb3JVc2VyKHVzZXJJZCkudGhlbihmdW5jdGlvbihzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiV29ya2Zsb3cgKioqKioqIFByb2ZpbGUgRG9uZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocyk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoY29udGV4dCA9PSBcInN1YnByb2ZpbGVcIil7XG4gICAgICAgICAgICAgICAgICAgIGxpYnJhcnkuYWRkVG9GYXZvdXJpdGVzU3VicHJvZmlsZUZvclVzZXIodXNlcklkKS50aGVuKGZ1bmN0aW9uKHMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJXb3JrZmxvdyAqKioqKiogU3ViUHJvZmlsZSBEb25lXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzKTtcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZihjb250ZXh0ID09IFwic3VicHJvY2Vzc1wiKXtcbiAgICAgICAgICAgICAgICAgICAgbGlicmFyeS5hZGRUb1VzZXJzRmF2b3VyaXRlc1N1YlByb2Nlc3NGb3JVc2VyKHVzZXJJZCwgdXVpZCkudGhlbihmdW5jdGlvbihzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiV29ya2Zsb3cgKioqKioqIFN1YnByb2Nlc3MgRG9uZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocyk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuICAgIGNvbW11bml0eTogY29tbXVuaXR5LFxuICAgIGFwcGxpY2F0aW9uOiBhcHBsaWNhdGlvbixcbiAgICBwZXJmb3JtYW5jZTogcGVyZm9ybWFuY2UsXG4gICAgd29ya2VyOiB3b3JrZXIsXG4gICAgc2RvOiBzZG8sXG4gICAgdGF4b25vbXk6IHRheG9ub215LFxuICAgIHN1YlByb2Nlc3NJbnN0YW5jZTogc3ViUHJvY2Vzc0luc3RhbmNlLFxuICAgIHZhcmlhYmxlczogdmFyaWFibGVzLFxuICAgIG5vdGlmaWNhdGlvbjogbm90aWZpY2F0aW9uLFxuICAgIHJlcG9ydDogcmVwb3J0LFxuICAgIHBhcnRpY2lwYW50czogcGFydGljaXBhbnRzLFxuICAgIHVzZXI6IHVzZXIsXG4gICAgZ2VuZXJhbEZ1bmN0aW9uczogZ2VuZXJhbEZ1bmN0aW9uc1xufSIsIid1c2Ugc3RyaWN0JztcblxuLy92YXIgZ2F0ZWtlZXBlciA9IHJlcXVpcmUoJy4uL2Jvd2VyX2NvbXBvbmVudHMvZ2F0ZWtlZXBlcicpO1xudmFyIHV0aWwgPSByZXF1aXJlKCd1dGlsaXR5Jyk7XG5cbi8vIHZhciB1dWlkID0gcmVxdWlyZSgnbm9kZS11dWlkJyk7XG5cbnZhciBnYXRla2VlcGVyID0gbmV3IEdLKCk7XG5cbi8qKlxuICogRm9ybSBNb2R1bGVcbiAqXG4gKiBAbW9kdWxlIGxpYi9mb3JtXG4gKiBAYXV0aG9yIEJyZW50IEdvcmRvblxuICogQHZlcnNpb24gMi4wLjBcbiAqIEBkZXNjcmlwdGlvbiB0ZXN0IGRlc2NyaXB0aW9uXG4gKiBAY29weXJpZ2h0IEt3YW50dSBMdGQgUlNBIDIwMDktMjAxNS5cbiAqXG4gKi9cblxuZnVuY3Rpb24gY3JlYXRlKGFyZ3MpIHtcblxuICAgIHZhciBwcm9jZXNzSWQgPSBhcmdzWzBdIHx8ICcnO1xuXG4gICAgdmFyIHN1YlByb2Nlc3MgPSBhcmdzWzFdIHx8IHt9O1xuXG4gICAgdmFyIHN0ZXAgPSBhcmdzWzJdIHx8IHt9O1xuXG4gICAgdmFyIGFjdGlvbiA9IGFyZ3NbM10gfHwge307XG5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBhcmdzWzZdIHx8IHt9O1xuXG4gICAgdmFyIGRhdGEgPSBhcmdzWzZdIHx8IHt9O1xuXG4gICAgdmFyIGluZGljYXRvcnMgPSBzdWJQcm9jZXNzLmluZGljYXRvcnMgfHwgW107XG5cbiAgICB2YXIgcmVzdWx0ID0gW107XG5cbiAgICB2YXIgaW5kaWNhdG9yVHlwZSA9IGFjdGlvbi5fdHlwZTtcblxuICAgIHZhciBwcm9jZXNzU2VxID0gYXJnc1s0XSB8fCAnJztcblxuICAgIHZhciBzdWJQcm9jZXNzU2VxID0gYXJnc1s1XSB8fCAnJztcblxuICAgIHZhciBjcmVhdGVUeXBlID0gYXJnc1s3XSB8fCAnJztcblxuICAgIHZhciBzdWJQcm9jZXNzSWQgPSBzdWJQcm9jZXNzLl9pZDtcblxuICAgIHZhciB1dWlkID0gYXJnc1s4XSB8fCAnJztcblxuICAgIHZhciBiYXNlVVVJRCA9IGFyZ3NbOV0gfHwgJyc7XG5cbiAgICB2YXIgcHJvZmlsZSA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG5cbiAgICB2YXIgaW5wdXREYXRhID0gYXJnc1sxMF0gfHwge307XG5cbiAgICB2YXIgZm9ybUNyZWF0ZVR5cGUgPSBhY3Rpb24ubWV0aG9kLmZvcm0uY3JlYXRlO1xuXG4gICAgdmFyIGZvcm1UeXBlID0gYWN0aW9uLm1ldGhvZC5mb3JtLnR5cGU7XG5cbiAgICB2YXIgcGFyYW1PYmplY3QgPSB7XG5cbiAgICAgICAgXCJmb3JtQ3JlYXRlVHlwZVwiOiBmb3JtQ3JlYXRlVHlwZSxcbiAgICAgICAgXCJmb3JtVHlwZVwiOiBmb3JtVHlwZVxuXG4gICAgfVxuICAgIFxuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdmFyIHRvUHJvY2VzcyA9IGluZGljYXRvcnMubGVuZ3RoO1xuICAgICAgICB2YXIgYnJva2UgPSBmYWxzZTtcblxuXG4gICAgICAgIC8vaGFzYW5cblxuICAgICAgICB2YXIgZXJyb3JBcnJheSA9IFtdO1xuXG4gICAgICAgIHZhciByZXNvbHZlQ2FsbGVyID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICBpZiAoYnJva2UgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBjcmVhdGUgaW5kaWNhdG9yIHBlcnNpc3Qgc3VjY2Vzcy4nLCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgIHZhciB0b0FkZFByb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IF9XRkluc3RhbmNlLmluc3RhbmNlLnByb2Nlc3Nlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX1dGSW5zdGFuY2UuaW5zdGFuY2UucHJvY2Vzc2VzW2ldLnN1YlByb2Nlc3Nlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b0FkZFByb2Nlc3MucHVzaChfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMgPSB0b0FkZFByb2Nlc3M7XG5cblxuICAgICAgICAgICAgICAgIHZhciBpbnZvbHZlZFN1YlByb2Nlc3NlcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc0lkID0gc3ViUHJvY2Vzc09iamVjdC5pZDtcbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc0NvbmZpZ09iamVjdCA9IEpTT04ueHBhdGgoXCIvY29uZmlnL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBpZiAoc3ViUHJvY2Vzc0NvbmZpZ09iamVjdC5pbnN0YW5jZVR5cGUubmV3U2VxdWVuY2UgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdWJQcm9jZXNzQ29uZmlnT2JqZWN0LmluZGljYXRvcnMubGVuZ3RoOyBpKyspIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvciA9IHN1YlByb2Nlc3NDb25maWdPYmplY3QuaW5kaWNhdG9yc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXRJZCA9IGluZGljYXRvci5faWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCJkaXN0aW5jdC12YWx1ZXMoL3N1YnByb2Nlc3Nlc1tncm91cEtleSA9ICdcIiArIHN1YlByb2Nlc3NPYmplY3QuZ3JvdXBLZXkgKyBcIiddL2luZGljYXRvcnNbaWQgPSAnXCIgKyBzZXRJZCArIFwiJ10vaW5zdGFuY2VzL3V1aWQpXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXMvaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBzZXRJZCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGljYXRvclVVSUQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvck9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kaWNhdG9yT2JqZWN0ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3JPYmplY3QubW9kZWwucGVuZGluZyA9IGluZGljYXRvck9iamVjdC5tb2RlbC5hcHByb3ZlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kTGlzdE5hbWVzID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3ViUHJvY2Vzc0NvbmZpZ09iamVjdC5pbmRpY2F0b3JzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5kTGlzdE5hbWVzID0gaW5kTGlzdE5hbWVzICsgXCInXCIgKyBzdWJQcm9jZXNzQ29uZmlnT2JqZWN0LmluZGljYXRvcnNbaV0uX2lkICsgXCInLFwiXG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpbmRMaXN0TmFtZXMgPSBpbmRMaXN0TmFtZXMgKyBcIidcIiArIHN1YlByb2Nlc3NDb25maWdPYmplY3QuaW5kaWNhdG9yc1tzdWJQcm9jZXNzQ29uZmlnT2JqZWN0LmluZGljYXRvcnMubGVuZ3RoIC0gMV0uX2lkICsgXCInXCJcbiAgICAgICAgICAgICAgICAgICAgaW52b2x2ZWRTdWJQcm9jZXNzZXMgPSBKU09OLnhwYXRoKFwiZGlzdGluY3QtdmFsdWVzKC9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gPSAoXCIgKyBpbmRMaXN0TmFtZXMgKyBcIildL21vZGVsL2FwcHJvdmVkL3N1YlByb2Nlc3NVVUlEKVwiLCBfV0ZJbnN0YW5jZSwge30pO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBwZXJzaXN0U3ViUHJvY2VzcyA9IGZ1bmN0aW9uIChpbmRleCwgaW52b2x2ZWRTdWJQcm9jZXNzZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PSBpbnZvbHZlZFN1YlByb2Nlc3Nlcy5sZW5ndGgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b0FkZFN1YlByb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzW2ldLmluZGljYXRvcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9BZGRTdWJQcm9jZXNzLnB1c2goX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3NlcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3NlcyA9IHRvQWRkU3ViUHJvY2VzcztcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJ1Byb2Nlc3MgZmFpbGVkJywgZXJyb3JBcnJheSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGZhaWx1cmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3REYXRhKCdpbmRpY2F0b3JzJywgX1dGSW5zdGFuY2UsIGludm9sdmVkU3ViUHJvY2Vzc2VzW2luZGV4XSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0U3ViUHJvY2VzcyhpbmRleCArIDEsIGludm9sdmVkU3ViUHJvY2Vzc2VzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3RTdWJQcm9jZXNzKGluZGV4ICsgMSwgaW52b2x2ZWRTdWJQcm9jZXNzZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBwZXJzaXN0U3ViUHJvY2VzcygwLCBpbnZvbHZlZFN1YlByb2Nlc3Nlcyk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB0b0FkZFN1YlByb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXNbaV0uaW5kaWNhdG9ycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9BZGRTdWJQcm9jZXNzLnB1c2goX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3NlcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMgPSB0b0FkZFN1YlByb2Nlc3M7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCdQcm9jZXNzIGZhaWxlZCcsIGVycm9yQXJyYXkpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZmFpbHVyZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cblxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHN1YnByb2Nlc3NUeXBlID0gSlNPTi54cGF0aChcIi9jb25maWcvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInXS90eXBlXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgdmFyIGZvcm1DcmVhdGVGbiA9IGZ1bmN0aW9uIChpbmRpY2F0b3JUeXBlLCBpbmRpY2F0b3JJZCwgdmFsaWREYXRlLCBpbnN0YW50aWF0ZVNvdXJjZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgZ2F0ZWtlZXBlci5pbnN0YW50aWF0ZShiYXNlVVVJRCwgaW5kaWNhdG9yVHlwZSwgaW5kaWNhdG9ySWQsIF9XRkluc3RhbmNlLnByb2ZpbGUsIHZhbGlkRGF0ZSwgc3ViUHJvY2Vzc0lkLCBzdWJwcm9jZXNzVHlwZSkudGhlbihmdW5jdGlvbiAoZG9jQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBpbmRpY2F0b3Igd29ya2Zsb3cgcHJvY2Vzc2VzIHNlY3Rpb25cblxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRvY0FycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqZWN0ID0gZG9jQXJyYXlbaV07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3IgPSBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzW2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kaWNhdG9yLl9pZCA9PSBvYmplY3QubW9kZWwuX2lkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLnB1c2gob2JqZWN0Lm1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW9iamVjdC5tb2RlbC5faWQuZW5kc1dpdGgoJzphcHByb3ZlZCcpICYmICFvYmplY3QubW9kZWwuX2lkLmVuZHNXaXRoKCc6cmVqZWN0ZWQnKSkge1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QubW9kZWwubW9kZWwucGVuZGluZy52YWxpZERhdGUgPSB2YWxpZERhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0Lm1vZGVsLm1vZGVsLnBlbmRpbmcuc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3b3JrZmxvd09iaiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBfV0ZJbnN0YW5jZS5jb25maWcuX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImluc3RhbmNlXCI6IF9XRkluc3RhbmNlLmluc3RhbmNlLl9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9jZXNzZXNcIjogW3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogcHJvY2Vzc0lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzSWRcIjogc3ViUHJvY2Vzcy5faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0ZXBcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogc3RlcC5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBzdGVwLnNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0YXJ0RGF0ZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RhdHVzXCI6IHN0ZXAuc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZVwiOiBzdGVwLm1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhc3NpZ25lZFRvXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogc3RlcC5hc3NpZ25lZFRvLnVzZXJJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IHN0ZXAuYXNzaWduZWRUby5uYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbW1lbnRcIjogc3RlcC5jb21tZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tcGxldGVcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJlbmREYXRlXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmplY3QubW9kZWwubW9kZWwucGVuZGluZy5zZXEgPT0gMSAmJiBhY3Rpb24uc2V0V29ya2Zsb3dMYWJlbEluVGl0bGUgIT0gdW5kZWZpbmVkICYmIGFjdGlvbi5zZXRXb3JrZmxvd0xhYmVsSW5UaXRsZSAhPSAnJyAmJiBhY3Rpb24uc2V0V29ya2Zsb3dMYWJlbEluVGl0bGUgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QubW9kZWwudGl0bGUgPSBpbnB1dERhdGEubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvbi5zZXREcmFmdCAhPSB1bmRlZmluZWQgJiYgYWN0aW9uLnNldERyYWZ0ICE9ICcnICYmIGFjdGlvbi5zZXREcmFmdCA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdC5tb2RlbC5jb250cm9sLmRyYWZ0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFscmVhZHlFeGlzdHMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JJbmRleCA9IC0xO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdC5tb2RlbC53b3JrZmxvd3MuZm9yRWFjaChmdW5jdGlvbih3b3JrZmxvd0Jsb2NrSW5JbmRpY2F0b3IsIGluZGV4KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodXVpZCA9PSB3b3JrZmxvd0Jsb2NrSW5JbmRpY2F0b3IucHJvY2Vzc2VzWzBdLnN1YlByb2Nlc3NVVUlEKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscmVhZHlFeGlzdHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIWFscmVhZHlFeGlzdHMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QubW9kZWwud29ya2Zsb3dzLnB1c2god29ya2Zsb3dPYmopO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0Lm1vZGVsLndvcmtmbG93c1tvYkluZGV4XSA9IHdvcmtmbG93T2JqO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWFpbklkID0gb2JqZWN0Lm1vZGVsLl9pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwZXJzaXN0IHZpYSBnayBzbyB0aGF0IGl0IGlzIHNhdmUgaW4gY291Y2hcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYXRla2VlcGVyLnBlcnNpc3QoZG9jQXJyYXkpLnRoZW4oZnVuY3Rpb24gKHNhdmVkQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy91c2luZyBzYW1lIGlkIGNhbGwgaW5pdGlhbGlzZURhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jYWxsIGNvZGUgdG8gc2V0IHRvIHNldEluc3RhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5nZXQobWFpbklkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JNb2RlbCA9IGtvLm1hcHBpbmcuZnJvbUpTKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRlZmF1bHRNb2RlbFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2V0SWRcIjogaW5kaWNhdG9ySWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlcXVlbmNlID0gZGF0YS5tb2RlbC5wZW5kaW5nLnNlcTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhdGVrZWVwZXIuaW5zdGFudGlhdGVEYXRhKG1haW5JZCwgaW5zdGFudGlhdGVTb3VyY2UsIGluZGljYXRvck1vZGVsLCBkYXRhLm1vZGVsLnBlbmRpbmcuc2VxLCBwYXJhbU9iamVjdCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhWzBdLnN0YXR1cyA9PSBcIjIwMFwiKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IF9XRkluc3RhbmNlLmluZGljYXRvcnMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yID0gX1dGSW5zdGFuY2UuaW5kaWNhdG9yc1tpbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kaWNhdG9yLl9pZCA9PSBkYXRhWzBdLm1vZGVsLl9pZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLmluZGljYXRvcnMucHVzaChkYXRhWzBdLm1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VxdWVuY2UgPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvbi5zZXRXb3JrZmxvd0xhYmVsSW5GaWVsZCAhPSB1bmRlZmluZWQgJiYgYWN0aW9uLnNldFdvcmtmbG93TGFiZWxJbkZpZWxkICE9ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnRTZXRJZCA9IGFjdGlvbi5zZXRXb3JrZmxvd0xhYmVsSW5GaWVsZC5zcGxpdChcIi5cIilbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFzc2lnbm1lbnRTZXRJZCA9PSBpbmRpY2F0b3JJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR4dCA9IGlucHV0RGF0YS5sYWJlbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNxdW90ZSA9IHR4dC5yZXBsYWNlKC8nL2csIFwiXFxcXCdcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaW5hbFZhbHVlID0gZGF0YVswXS5tb2RlbC5tb2RlbC5wZW5kaW5nLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRoVG9FbGVtZW50ID0gYWN0aW9uLnNldFdvcmtmbG93TGFiZWxJbkZpZWxkID09IFwiXCIgPyBbXSA6IGFjdGlvbi5zZXRXb3JrZmxvd0xhYmVsSW5GaWVsZC5zcGxpdCgvWydcIlxcW1xcXS5dKy8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgayA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBwYXRoVG9FbGVtZW50Lmxlbmd0aCAtIDE7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocGF0aFRvRWxlbWVudFtrXSA9PSBcIlwiKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWVbcGF0aFRvRWxlbWVudFtrXV0gPSBzcXVvdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhdGVrZWVwZXIucGVyc2lzdChkYXRhKS50aGVuKGZ1bmN0aW9uIChzYXZlZEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0KG1haW5JZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLmluZGljYXRvcnMucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b1Byb2Nlc3MgPT0gMCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0RGF0YSgnaW5kaWNhdG9ycycsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBjcmVhdGUgaW5kaWNhdG9yIHBlcnNpc3Qgc3VjY2Vzcy4nLCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckFycmF5LnB1c2goe1wiZXJyb3JcIjogXCJwZXJzaXN0RGF0YSBcIisgdXVpZCwgXCJlcnJvckJsb2NrXCI6IGVycn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnRm9ybSBjcmVhdGUgaW5kaWNhdG9yIHBlcnNpc3QgZmFpbGVkLicsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicm9rZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoe30pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IF9XRkluc3RhbmNlLmluZGljYXRvcnMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yID0gX1dGSW5zdGFuY2UuaW5kaWNhdG9yc1tpbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kaWNhdG9yLl9pZCA9PSBkYXRhLl9pZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgY3VycmVudCBpdGVtIGZyb20gdGhlIGFycmF5IGFuZCBhZGQgdGhlIHVwZGF0ZWQgcHJvY2Vzc01vZGVsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLmluZGljYXRvcnMucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IF9XRkluc3RhbmNlLmluZGljYXRvcnMubGVuZ3RoO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc2lzdERhdGEoJ2luZGljYXRvcnMnLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBjcmVhdGUgaW5kaWNhdG9yIHBlcnNpc3Qgc3VjY2Vzcy4nLCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVDYWxsZXIoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckFycmF5LnB1c2goe1wiZXJyb3JcIjogXCJwZXJzaXN0RGF0YSBcIisgdXVpZCwgXCJlcnJvckJsb2NrXCI6IGVycn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gY3JlYXRlIGluZGljYXRvciBwZXJzaXN0IGZhaWxlZC4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicm9rZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHt9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3VuZCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5wdXNoKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b1Byb2Nlc3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3REYXRhKCdpbmRpY2F0b3JzJywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBjcmVhdGUgaW5kaWNhdG9yIHBlcnNpc3Qgc3VjY2Vzcy4nLCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckFycmF5LnB1c2goe1wiZXJyb3JcIjogXCJwZXJzaXN0RGF0YSBcIisgdXVpZCwgXCJlcnJvckJsb2NrXCI6IGVycn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCdGb3JtIGNyZWF0ZSBpbmRpY2F0b3IgcGVyc2lzdCBmYWlsZWQuJywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicm9rZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVDYWxsZXIoKTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh7fSk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckFycmF5LnB1c2goe1wiZXJyb3JcIjogXCJkYW8uZ2V0KG1haW5JZCkgXCIrIG1haW5JZCwgXCJlcnJvckJsb2NrXCI6IGVycn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnMSBHYXRla2VlcGVyIGluaXRpYWxpc2F0aW9uIGZhaWxlZCB3aXRoIGluaXRpYWxpc2VEYXRhIG1lc3NhZ2UgJywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyb2tlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoe30pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yQXJyYXkucHVzaCh7XCJlcnJvclwiOiBcImdhdGVrZWVwZXIucGVyc2lzdChkYXRhKSAtIFBlcnNpc3RpbmcgYWxsIGRvY3MgXCIsIFwiZXJyb3JCbG9ja1wiOiBlcnJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCcyIEdhdGVrZWVwZXIgaW5pdGlhbGlzYXRpb24gZmFpbGVkIHdpdGggaW5pdGlhbGlzZURhdGEgbWVzc2FnZSAnLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicm9rZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b1Byb2Nlc3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVDYWxsZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh7fSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckFycmF5LnB1c2goe1wiZXJyb3JcIjogXCJnYXRla2VlcGVyLmluc3RhbnRpYXRlRGF0YVwiKyBtYWluSWQgKyBcIiBcIisgZGF0YVswXS5zdGF0dXMgLCBcImVycm9yQmxvY2tcIjoge319KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJzMgR2F0ZWtlZXBlciBpbml0aWFsaXNhdGlvbiBmYWlsZWQgd2l0aCBpbml0aWFsaXNlRGF0YSBtZXNzYWdlICcsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJva2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRvUHJvY2VzcyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHt9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yQXJyYXkucHVzaCh7XCJlcnJvclwiOiBcImdhdGVrZWVwZXIuaW5zdGFudGlhdGVEYXRhXCIrIG1haW5JZCwgXCJlcnJvckJsb2NrXCI6IGVycn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCc0IEdhdGVrZWVwZXIgaW5pdGlhbGlzYXRpb24gZmFpbGVkIHdpdGggaW5pdGlhbGlzZURhdGEgbWVzc2FnZSAnLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJva2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvUHJvY2Vzcy0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b1Byb2Nlc3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh7fSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yQXJyYXkucHVzaCh7XCJlcnJvclwiOiBcImRhby5nZXQobWFpbklkKSBcIisgbWFpbklkLCBcImVycm9yQmxvY2tcIjogZXJyfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnNSBHYXRla2VlcGVyIGluaXRpYWxpc2F0aW9uIGZhaWxlZCB3aXRoIGluaXRpYWxpc2VEYXRhIG1lc3NhZ2UgJywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJva2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoe30pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckFycmF5LnB1c2goe1wiZXJyb3JcIjogXCJnYXRla2VlcGVyLnBlcnNpc3Qgc2F2ZWRBcnJheVwiLCBcImVycm9yQmxvY2tcIjogZXJyfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJzYgR2F0ZWtlZXBlciBpbml0aWFsaXNhdGlvbiBmYWlsZWQgd2l0aCBpbml0aWFsaXNlRGF0YSBtZXNzYWdlICcsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJva2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRvUHJvY2VzcyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHt9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JBcnJheS5wdXNoKHtcImVycm9yXCI6IFwiZ2F0ZWtlZXBlci5pbnN0YW50aWF0ZVwiLCBcImVycm9yQmxvY2tcIjogZXJyfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyb2tlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b1Byb2Nlc3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxlcigpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh7fSk7XG5cblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KTtcblxuXG5cbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgaW5zdGFudGlhdGVTb3VyY2UgPSBGUk9NX0RFRklOSVRJT047XG5cbiAgICAgICAgdmFyIGxvb3BGdW5jdGlvbiA9IGZ1bmN0aW9uIChpbmRpY2F0b3JzLCBjb3VudGVyKSB7XG5cbiAgICAgICAgICAgIGlmIChpbmRpY2F0b3JzLmxlbmd0aCA9PSAwKSB7XG5cbiAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxlcigpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY291bnRlciA8IGluZGljYXRvcnMubGVuZ3RoKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9ySWQgPSBpbmRpY2F0b3JzW2NvdW50ZXJdLl9pZDtcbiAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yTmFtZSA9IHV0aWwuZ2V0TmFtZShpbmRpY2F0b3JzW2NvdW50ZXJdLm5hbWUsICdlbicpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGluZGljYXRvcnNbY291bnRlcl0uaW5pdGlhdGVEYXRhO1xuXG4gICAgICAgICAgICAgICAgdmFyIGluaXRUeXBlID0gJyc7XG4gICAgICAgICAgICAgICAgaWYgKHN1YlByb2Nlc3MuaW5zdGFuY2VUeXBlLm5ld1NlcXVlbmNlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBpbml0VHlwZSA9IElOU1RBTkNFX1RZUEVfTkVXX1NFUTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN1YlByb2Nlc3MuaW5zdGFuY2VUeXBlLm5ld0luc3RhbmNlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBpbml0VHlwZSA9IElOU1RBTkNFX1RZUEVfTkVXX0lOUztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgY3JlYXRlRm9ybSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1DcmVhdGVGbihpbml0VHlwZSwgaW5kaWNhdG9ySWQsIGlucHV0RGF0YS52YWxpZERhdGUsIGluc3RhbnRpYXRlU291cmNlKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9vcEZ1bmN0aW9uKGluZGljYXRvcnMsIChjb3VudGVyICsgMSkpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBicm9rZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b1Byb2Nlc3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVDYWxsZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yRG9jID0ge307XG4gICAgICAgICAgICAgICAgaWYgKGJhc2VVVUlEICE9IHVuZGVmaW5lZCAmJiBiYXNlVVVJRCAhPSAnJyAmJiBiYXNlVVVJRC5sZW5ndGggPiAwKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHNwID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIGJhc2VVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN1YlByb2Nlc3MucGVyaW9kVHlwZS5wZXJpb2RpYyA9PSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJhc2VVVUlEICE9IHV1aWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcC5hY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZihmb3JtQ3JlYXRlVHlwZSA9PSBCTEFOS19NT0RFTCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW50aWF0ZVNvdXJjZSA9IEZST01fREVGSU5JVElPTjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlU291cmNlID0gRlJPTV9BVVRIT1JJU0VEO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVGb3JtKCk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2FyZGluYWxpdHkgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbc2V0SWQgZXEgJ1wiICsgaW5kaWNhdG9ySWQgKyBcIiddL2NhcmRpbmFsaXR5XCIsIGFwcC5TQ09QRS5BUFBfQ09ORklHLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGluaXRUeXBlID09IElOU1RBTkNFX1RZUEVfTkVXX0lOUykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FyZGluYWxpdHkgPT0gSU5ESUNBVE9SX0NBUkRJTkFMSVRZX1NJTkdMRSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlicmFyeS5nZXRTaW5nbGVJbmRpY2F0b3IoaW5kaWNhdG9ySWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZXhpc3RpbmdVVUlEKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdVVUlELmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlU291cmNlID0gRlJPTV9BVVRIT1JJU0VEO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFudGlhdGVTb3VyY2UgPSBGUk9NX0RFRklOSVRJT047XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVGb3JtKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihleGlzdGluZ1VVSUQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW50aWF0ZVNvdXJjZSA9IEZST01fREVGSU5JVElPTjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlRm9ybSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW50aWF0ZVNvdXJjZSA9IEZST01fREVGSU5JVElPTjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVGb3JtKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhcmRpbmFsaXR5ID09IElORElDQVRPUl9DQVJESU5BTElUWV9TSU5HTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnJhcnkuZ2V0U2luZ2xlSW5kaWNhdG9yKGluZGljYXRvcklkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGV4aXN0aW5nVVVJRCl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nVVVJRC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW50aWF0ZVNvdXJjZSA9IEZST01fQVVUSE9SSVNFRDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlU291cmNlID0gRlJPTV9ERUZJTklUSU9OO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlRm9ybSgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXhpc3RpbmdVVUlEKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFudGlhdGVTb3VyY2UgPSBGUk9NX0RFRklOSVRJT047XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZUZvcm0oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NoZWNrIGhlcmVcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRoID0gXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIGluZGljYXRvcklkICsgXCInIGFuZCBpZCA9IC9zdWJwcm9jZXNzZXNbaWQgPSAnXCIgKyBzdWJQcm9jZXNzSWQgKyBcIiddL2luZGljYXRvcnMvaW5zdGFuY2VzL3V1aWRdL19pZFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJwcm9jZXNzVHlwZSA9PSBQUk9DRVNTX1RZUEVfU1VCUFJPRklMRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIGluZGljYXRvcklkICsgXCInIGFuZCBpZCA9IC9zdWJwcm9jZXNzZXNbaWQgPSAnXCIgKyBzdWJQcm9jZXNzSWQgKyBcIicgYW5kIGlkID0gXCIgKyBwYXJ0ICsgXCJdL2luZGljYXRvcnMvaW5zdGFuY2VzL3V1aWRdL19pZFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdVVUlEID0gSlNPTi54cGF0aChwYXRoLCBfV0ZJbnN0YW5jZSwge30pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nVVVJRC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlU291cmNlID0gRlJPTV9BVVRIT1JJU0VEO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlU291cmNlID0gRlJPTV9ERUZJTklUSU9OO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVGb3JtKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgICBsb29wRnVuY3Rpb24oaW5kaWNhdG9ycywgMCk7XG5cbiAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIHNldEluc3RhbmNlVGl0bGUoYXJncykge1xuXG4gICAgdmFyIF9XRkluc3RhbmNlID0gYXJnc1swXSB8fCB7fTtcblxuICAgIHZhciB1dWlkID0gYXJnc1syXSB8fCAnJztcbiAgICB2YXIgZGF0YSA9IGFyZ3NbNF0gfHwge307XG5cbiAgICB2YXIgdGl0bGUgPSBkYXRhLmxhYmVsO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICB2YXIgc3ViUHJvY2Vzc0luc3RhbmNlID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgXG4gICAgICAgIHZhciBpbmRpY2F0b3JJbnN0YW5jZXMgPSBzdWJQcm9jZXNzSW5zdGFuY2UuaW5kaWNhdG9ycztcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluZGljYXRvckluc3RhbmNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBpbmRpY2F0b3JJbnN0YW5jZXNbaV0uaW5zdGFuY2VzWzBdLnV1aWQ7XG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9ySW5zdGFuY2UgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICBpbmRpY2F0b3JJbnN0YW5jZS50aXRsZSA9IGluZGljYXRvckluc3RhbmNlc1tpXS5pZCArICcgJyArIHRpdGxlO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJlc29sdmUoXCJTZXQgVGl0bGUgU3VjY2Vzc1wiLCBpbmRpY2F0b3JJbnN0YW5jZXMpO1xuXG4gICAgfSk7XG5cbn07XG5cbmZ1bmN0aW9uIGRlbGV0ZVByb2ZpbGUoYXJncykge1xuXG4gICAgdmFyIF9XRkluc3RhbmNlID0gYXJnc1swXSB8fCB7fTtcblxuICAgIHZhciBwcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0ge1xuICAgICAgICAgICAgXCJzb3VyY2VcIjogXCJyZW1vdGVcIixcbiAgICAgICAgICAgIFwidHlwZVwiOiBcIndvcmtlck9iamVjdFwiLFxuICAgICAgICAgICAgXCJfaWRcIjogZ2VuZXJhdGVVVUlEKCksXG4gICAgICAgICAgICBcImNoYW5uZWxzXCI6IFtcImRlbGV0ZVByb2ZpbGVcIiwgXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSwgXCJ3b3JrZXJPYmplY3RcIl0sXG4gICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkLFxuICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZSxcbiAgICAgICAgICAgIFwibWVzc2FnZVwiOiBcIlwiLFxuICAgICAgICAgICAgXCJzdWJwcm9maWxlSWRcIjogc3VicHJvZmlsZUlkLFxuICAgICAgICAgICAgXCJtZXNzYWdlVHlwZVwiOiBcImluZm9cIixcbiAgICAgICAgICAgIFwiY3JlYXRlZERhdGVUaW1lXCI6IG1vbWVudCgpLmZvcm1hdCgpLFxuICAgICAgICAgICAgXCJzZW5kZXJVc2VySWRcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQsXG4gICAgICAgICAgICBcInBhcmVudFRyYW5zYWN0aW9uSWRcIjogKGFwcC5TQ09QRS50eG4gPT0gdW5kZWZpbmVkICA/IFwiXCIgOiBhcHAuU0NPUEUudHhuLnRyYW5zYWN0aW9uSWQpLFxuICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJwcm9maWxlXCI6IHtcbiAgICAgICAgICAgICAgICBcImFjdGlvblwiOiBcImRlbGV0ZVByb2ZpbGVcIixcbiAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBwcm9maWxlSWRcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2cod29ya2VyT2JqZWN0KTtcbiAgICAgICAgZGFvLnNhdmUod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIldvcmtlciBPYmplY3Qgc3VibWl0dGVkIGZvciBwcm9maWxlKFwiICsgcHJvZmlsZUlkICsgXCIpIGRlbGV0aW9uLlwiKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgIHJlamVjdChkYXRhKTtcbiAgICAgICAgfSk7XG5cbiAgICB9KTtcblxufTtcblxuZnVuY3Rpb24gY3JlYXRlUHJvZmlsZShhcmdzKSB7XG5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBhcmdzWzFdIHx8IHt9O1xuXG4gICAgdmFyIGNvbW11bml0eUlkID0gX1dGSW5zdGFuY2UuY29tbXVuaXR5SWQ7XG4gICAgdmFyIHByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIGxpYnJhcnkuY3JlYXRlUHJvZmlsZURvY3VtZW50cyhjb21tdW5pdHlJZCwgcHJvZmlsZUlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdGb3JtIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5LicsIGRhdGEpO1xuICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG5cbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCdFUlJPUjogUHJvZmlsZSBjcmVhdGlvbiBmYWlsZWQnLCB7fSk7XG4gICAgICAgICAgICByZWplY3QoZmFpbHVyZSk7XG5cbiAgICAgICAgfSk7XG5cbiAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIHNldERyYWZ0KGFyZ3MpIHtcblxuICAgIHZhciBfV0ZJbnN0YW5jZSA9IGFyZ3NbMF0gfHwge307XG5cbiAgICB2YXIgY29tbXVuaXR5SWQgPSBfV0ZJbnN0YW5jZS5jb21tdW5pdHlJZDtcbiAgICB2YXIgcHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICB2YXIgdXVpZCA9IGFyZ3NbMl0gfHwgJyc7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIHZhciBzdWJQcm9jZXNzSW5zdGFuY2UgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgXG4gICAgICAgIHZhciBpbmRpY2F0b3JJbnN0YW5jZXMgPSBzdWJQcm9jZXNzSW5zdGFuY2UuaW5kaWNhdG9ycztcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluZGljYXRvckluc3RhbmNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBpbmRpY2F0b3JJbnN0YW5jZXNbaV0uaW5zdGFuY2VzWzBdLnV1aWQ7XG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9ySW5zdGFuY2UgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICBpbmRpY2F0b3JJbnN0YW5jZS5jb250cm9sLmRyYWZ0ID0gdHJ1ZTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXNvbHZlKFwiU2V0IERyYWZ0IFN1Y2Nlc3NcIiwgaW5kaWNhdG9ySW5zdGFuY2VzKTtcblxuICAgIH0pO1xufTtcblxuZnVuY3Rpb24gc2V0VW5EcmFmdChhcmdzKSB7XG5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBhcmdzWzBdIHx8IHt9O1xuXG4gICAgdmFyIGNvbW11bml0eUlkID0gX1dGSW5zdGFuY2UuY29tbXVuaXR5SWQ7XG4gICAgdmFyIHByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgdmFyIHV1aWQgPSBhcmdzWzJdIHx8ICcnO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICB2YXIgc3ViUHJvY2Vzc0luc3RhbmNlID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgIFxuICAgICAgICB2YXIgaW5kaWNhdG9ySW5zdGFuY2VzID0gc3ViUHJvY2Vzc0luc3RhbmNlLmluZGljYXRvcnM7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbmRpY2F0b3JJbnN0YW5jZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gaW5kaWNhdG9ySW5zdGFuY2VzW2ldLmluc3RhbmNlc1swXS51dWlkO1xuICAgICAgICAgICAgdmFyIGluZGljYXRvckluc3RhbmNlID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgaW5kaWNhdG9ySW5zdGFuY2UuY29udHJvbC5kcmFmdCA9IGZhbHNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJlc29sdmUoXCJTZXQgRHJhZnQgU3VjY2Vzc1wiLCBpbmRpY2F0b3JJbnN0YW5jZXMpO1xuXG4gICAgfSk7XG59O1xuXG5mdW5jdGlvbiBzYXZlKGluZGljYXRvcikge1xuICAgIHZhciBjb21wbGV0ZWQgPSBbXTtcbiAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgICBjb21wbGV0ZTogdHJ1ZSxcbiAgICAgICAgZGF0YTogW11cbiAgICB9O1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gaW5kaWNhdG9yIHNldCBzYXZlZCBzdWNjZXNzZnVsbHkuJywgcmVzdWx0KTtcbiAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIHN1Ym1pdChmb3JtKSB7XG4gICAgdmFyIGNvbXBsZXRlZCA9IFtdO1xuICAgIHZhciByZXN1bHQgPSB7XG4gICAgICAgIGNvbXBsZXRlOiB0cnVlLFxuICAgICAgICBkYXRhOiBbXVxuICAgIH07XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBzdWJtaXR0ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdCk7XG4gICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgfSk7XG59O1xuXG5mdW5jdGlvbiBhdXRob3Jpc2UoZm9ybSkge1xuICAgIHZhciBjb21wbGV0ZWQgPSBbXTtcbiAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgICBjb21wbGV0ZTogdHJ1ZSxcbiAgICAgICAgZGF0YTogW11cbiAgICB9O1xuXG4gICAgdmFyIHByb2Nlc3NJZCA9IGZvcm1bMF0gfHwgJyc7XG5cbiAgICB2YXIgc3ViUHJvY2VzcyA9IGZvcm1bMV0gfHwge307XG5cbiAgICB2YXIgc3ViUHJvY2Vzc0lkID0gc3ViUHJvY2Vzcy5faWQ7XG5cbiAgICB2YXIgcHJvY2Vzc1NlcSA9IGZvcm1bMl0gfHwgJyc7XG5cbiAgICB2YXIgc3ViUHJvY2Vzc1NlcSA9IGZvcm1bM10gfHwgJyc7XG5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBmb3JtWzRdIHx8IHt9O1xuXG4gICAgdmFyIHN1YlByb2Nlc3NVVUlEID0gZm9ybVs2XSB8fCAnJztcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgdmFyIHNwbyA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzVVVJRCArIFwiJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG5cbiAgICAgICAgLy92YXIgc3ViUHJvY2Vzc1VVSUQgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tpZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIicgYW5kIHNlcSBlcSAnXCIgKyBwcm9jZXNzU2VxICsgXCInXS9zdWJQcm9jZXNzZXNbaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInIGFuZCBzZXEgZXEgJ1wiICsgc3ViUHJvY2Vzc1NlcSArIFwiJ10vdXVpZFwiLCBfV0ZJbnN0YW5jZS5pbnN0YW5jZSwge30pWzBdO1xuICAgICAgICB2YXIgc3BJbmRpY2F0b3JzID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NVVUlEICsgXCInXS9pbmRpY2F0b3JzL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSk7XG4gICAgICAgIHZhciBpdGVtc1RvUHJvY2VzcyA9IHNwSW5kaWNhdG9ycy5sZW5ndGg7XG4gICAgICAgIHZhciB1cGRhdGVkT2JqZWN0c0FycmF5ID0gW107XG4gICAgICAgIHZhciB0ZW1wQXJyYXkgPSBbXTtcblxuICAgICAgICAvL3N0YXJ0IHR4biBvbiBpbmR1dWlkICsgOmFwcHJvdmVkIHRoZW4gY29tbWl0XG5cbiAgICAgICAgdmFyIHByb2Nlc3NTRE8gPSBmdW5jdGlvbihpKXtcblxuICAgICAgICAgICAgZ2F0ZWtlZXBlci5hdXRob3Jpc2Uoc3BJbmRpY2F0b3JzW2ldKS50aGVuKGZ1bmN0aW9uIChhdXRob3Jpc2VkUmV0dXJuKSB7XG5cbiAgICAgICAgICAgICAgICBnYXRla2VlcGVyLnBlcnNpc3QoYXV0aG9yaXNlZFJldHVybikudGhlbihmdW5jdGlvbiAoc2F2ZWRBcnJheSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB1dWlkU2F2ZWRJbmRpY2F0b3IgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCBzYXZlZEFycmF5Lmxlbmd0aDsgYysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNhdmVkQXJyYXlbY10uaWQuZW5kc1dpdGgoJzphcHByb3ZlZCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXVpZFNhdmVkSW5kaWNhdG9yID0gc2F2ZWRBcnJheVtjXS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgZGFvLmdldCh1dWlkU2F2ZWRJbmRpY2F0b3IpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9XRkluc3RhbmNlLmluZGljYXRvcnMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNUb1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbXNUb1Byb2Nlc3MgPT0gMCkge1xuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0RGF0YSgnaW5kaWNhdG9ycycsIF9XRkluc3RhbmNlLCBzdWJQcm9jZXNzVVVJRCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBhdXRob3Jpc2VkIHN1Y2Nlc3NmdWxseS4nLCB1cGRhdGVkT2JqZWN0c0FycmF5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gYXV0aG9yaXNlZCBwZXJzaXN0IGZhaWxlZC4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZmFpbHVyZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKGl0ZW1zVG9Qcm9jZXNzID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NTRE8oaSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yID0gX1dGSW5zdGFuY2UuaW5kaWNhdG9yc1tpbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRpY2F0b3IuX2lkID09IGRhdGEuX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGN1cnJlbnQgaXRlbSBmcm9tIHRoZSBhcnJheSBhbmQgYWRkIHRoZSB1cGRhdGVkIHByb2Nlc3NNb2RlbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcEFycmF5LnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL19XRkluc3RhbmNlLmluZGljYXRvcnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNUb1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtc1RvUHJvY2VzcyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZExlbmd0aCA9IF9XRkluc3RhbmNlLmluZGljYXRvcnMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wTGVuZ3RoID0gdGVtcEFycmF5Lmxlbmd0aDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHAgPSAwOyBwIDwgaW5kTGVuZ3RoOyBwKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBPYmogPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgcSA9IDA7IHEgPCB0ZW1wTGVuZ3RoOyBxKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzW3BdLl9pZCA9PSB0ZW1wQXJyYXlbcV0uX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcE9iaiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0ZW1wT2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wQXJyYXkucHVzaChfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzW3BdKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycyA9IHRlbXBBcnJheTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3VuZCA9PSB0cnVlICYmIGl0ZW1zVG9Qcm9jZXNzID09IDApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0RGF0YSgnaW5kaWNhdG9ycycsIF9XRkluc3RhbmNlLCBzdWJQcm9jZXNzVVVJRCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBhdXRob3Jpc2VkIHN1Y2Nlc3NmdWxseS4nLCB1cGRhdGVkT2JqZWN0c0FycmF5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnRm9ybSBhdXRob3Jpc2VkIHBlcnNpc3QgZmFpbGVkLicsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChmYWlsdXJlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoaXRlbXNUb1Byb2Nlc3MgPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc1NETyhpICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gYXV0aG9yaXNlZCBwZXJzaXN0IGZhaWxlZCAyLicsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChmYWlsdXJlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCdGb3JtIGF1dGhvcmlzZWQgcGVyc2lzdCBmYWlsZWQgMy4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChmYWlsdXJlKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gYXV0aG9yaXNlZCBwZXJzaXN0IGZhaWxlZCA0LicsIHt9KTtcbiAgICAgICAgICAgICAgICByZWplY3QoZmFpbHVyZSk7XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgICAgICBwcm9jZXNzU0RPKDApO1xuXG5cblxuXG4gICAgfSk7XG59O1xuXG5mdW5jdGlvbiBjbG9zZShmb3JtKSB7XG4gICAgdmFyIGNvbXBsZXRlZCA9IFtdO1xuICAgIHZhciByZXN1bHQgPSB7XG4gICAgICAgIGNvbXBsZXRlOiB0cnVlLFxuICAgICAgICBkYXRhOiBbXVxuICAgIH07XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBjbG9zZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdCk7XG4gICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgfSk7XG59O1xuXG5cblxuZnVuY3Rpb24gdXBkYXRlSW5kaWNhdG9yKGFyZ3MpIHtcblxuICAgIHZhciBfV0ZJbnN0YW5jZSA9IGFyZ3NbMF0gfHwge307XG5cbiAgICB2YXIgdXVpZCA9IGFyZ3NbMV0gfHwgJyc7XG4gICAgdmFyIHBhdGggPSBhcmdzWzJdIHx8ICcnO1xuICAgIHZhciBkYXRhVmFsdWUgPSBhcmdzWzNdIHx8ICcnO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICB2YXIgc2V0SWQgPSBwYXRoLnNwbGl0KFwiLlwiLCAxKVswXTtcbiAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1t3b3JrZmxvd3MvcHJvY2Vzc2VzL3N1YlByb2Nlc3NVVUlEID0gJ1wiICsgdXVpZCArIFwiJyBhbmQgY2F0ZWdvcnkvdGVybSA9ICdcIiArIHNldElkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICBpZihpbmRPYmplY3QgPT0gdW5kZWZpbmVkICYmIHNldElkID09IFwiYXBwUHJvZmlsZVwiKXtcbiAgICAgICAgICAgIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1ttb2RlbC9wZW5kaW5nL3N0YXR1cyA9ICdBdXRob3Jpc2VkJyBhbmQgY2F0ZWdvcnkvdGVybSA9ICdcIiArIHNldElkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgaWYoaW5kT2JqZWN0ID09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgdmFyIHN0dWZmID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IHt9O1xuXG4gICAgICAgICAgICAgICAgb2JqLm1vZGVsID0ge307XG4gICAgICAgICAgICAgICAgc3R1ZmYucHVzaChvYmopO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0luZGljYXRvciB1cGRhdGVkIHNraXBwZWQuJywgc3R1ZmYpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHNxdW90ZSA9IChkYXRhVmFsdWUgKyBcIlwiKS5yZXBsYWNlKC8nL2csIFwiXFxcXCdcIik7XG4gICAgICAgIHZhciBzcXVvdGUgPSBzcXVvdGUuc3BsaXQoJ1xcbicpLmpvaW4oJyAnKTtcbiAgICAgICAgdmFyIGZpbmFsVmFsdWUgPSBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhO1xuICAgICAgICB2YXIgcGF0aFRvRWxlbWVudCA9IHBhdGggPT0gXCJcIiA/IFtdIDogcGF0aC5zcGxpdCgvWydcIlxcW1xcXS5dKy8pO1xuICAgICAgICB2YXIgayA9IDA7XG4gICAgICAgIGZvciAoayA9IDA7IGsgPCBwYXRoVG9FbGVtZW50Lmxlbmd0aCAtIDE7IGsrKykge1xuICAgICAgICAgICAgaWYocGF0aFRvRWxlbWVudFtrXSA9PSBcIlwiKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsVmFsdWVbcGF0aFRvRWxlbWVudFtrXV0gPSBzcXVvdGU7XG4gICAgICAgIHZhciBpdGVtc1RvUHJvY2VzcyA9IDE7XG4gICAgICAgIHZhciBzdHVmZiA9IFtdO1xuICAgICAgICB2YXIgb2JqID0ge307XG5cbiAgICAgICAgb2JqLm1vZGVsID0gaW5kT2JqZWN0O1xuICAgICAgICBzdHVmZi5wdXNoKG9iaik7XG5cbiAgICAgICAgdmFyIHR4blBhY2tldCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXBwLlNDT1BFLnR4bikpO1xuICAgICAgICB0eG5QYWNrZXQuZG9jdW1lbnRzID0gW107XG4gICAgICAgIHZhciByZWZQYWNrID0geyBcImRvY3VtZW50XCI6IGluZE9iamVjdC5faWQsIFwicmV2XCI6IGluZE9iamVjdC5fcmV2IH07XG4gICAgICAgIHR4blBhY2tldC5kb2N1bWVudHMucHVzaChyZWZQYWNrKTtcbiAgICAgICAgYXBwLlNDT1BFLnR4bi5kb2N1bWVudHMucHVzaChyZWZQYWNrKTtcblxuICAgICAgICBkYW8udXBkYXRlVHJhbnNhY3Rpb24odHhuUGFja2V0KS50aGVuKGZ1bmN0aW9uKHN1Y2MpIHtcblxuICAgICAgICAgICAgZGFvLnNhdmUoaW5kT2JqZWN0KS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZWZQYWNrLnJldiA9IGRhdGEucmV2O1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZC4nLCBzdHVmZik7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZC4nLCBzdHVmZik7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZC4nLCBzdHVmZik7XG4gICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICB9KTtcblxuXG4gICAgfSk7XG59O1xuXG5cbmZ1bmN0aW9uIHVwZGF0ZUluZGljYXRvcldyYXBwZXIoYXJncykge1xuXG4gICAgdmFyIF9XRkluc3RhbmNlID0gYXJnc1swXSB8fCB7fTtcblxuICAgIHZhciB1dWlkID0gYXJnc1sxXSB8fCAnJztcbiAgICB2YXIgcGF0aCA9IGFyZ3NbMl0gfHwgJyc7XG4gICAgdmFyIGRhdGFWYWx1ZSA9IGFyZ3NbM10gfHwgJyc7XG4gICAgdmFyIGluZGljYXRvclNldElkID0gYXJnc1s0XSB8fCAnJztcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblxuICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW3dvcmtmbG93cy9wcm9jZXNzZXMvc3ViUHJvY2Vzc1VVSUQgPSAnXCIgKyB1dWlkICsgXCInIGFuZCBjYXRlZ29yeS90ZXJtID0gJ1wiICsgaW5kaWNhdG9yU2V0SWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgaWYoaW5kT2JqZWN0ID09IHVuZGVmaW5lZCAmJiBpbmRpY2F0b3JTZXRJZCA9PSBcImFwcFByb2ZpbGVcIil7XG4gICAgICAgICAgICBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbbW9kZWwvcGVuZGluZy9zdGF0dXMgPSAnQXV0aG9yaXNlZCcgYW5kIGNhdGVnb3J5L3Rlcm0gPSAnXCIgKyBpbmRpY2F0b3JTZXRJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIGlmKGluZE9iamVjdCA9PSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgIHZhciBzdHVmZiA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBvYmogPSB7fTtcblxuICAgICAgICAgICAgICAgIG9iai5tb2RlbCA9IHt9O1xuICAgICAgICAgICAgICAgIHN0dWZmLnB1c2gob2JqKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZCBza2lwcGVkLicsIHN0dWZmKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzcXVvdGUgPSBkYXRhVmFsdWUucmVwbGFjZSgvJy9nLCBcIlxcXFwnXCIpO1xuICAgICAgICB2YXIgc3F1b3RlID0gc3F1b3RlLnNwbGl0KCdcXG4nKS5qb2luKCcgJyk7XG4gICAgICAgIHZhciBmaW5hbFZhbHVlID0gaW5kT2JqZWN0O1xuICAgICAgICB2YXIgcGF0aFRvRWxlbWVudCA9IHBhdGggPT0gXCJcIiA/IFtdIDogcGF0aC5zcGxpdCgvWydcIlxcW1xcXS5dKy8pO1xuICAgICAgICB2YXIgayA9IDA7XG4gICAgICAgIGZvciAoayA9IDA7IGsgPCBwYXRoVG9FbGVtZW50Lmxlbmd0aCAtIDE7IGsrKykge1xuICAgICAgICAgICAgaWYocGF0aFRvRWxlbWVudFtrXSA9PSBcIlwiKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsVmFsdWVbcGF0aFRvRWxlbWVudFtrXV0gPSBzcXVvdGU7XG4gICAgICAgIHZhciBpdGVtc1RvUHJvY2VzcyA9IDE7XG4gICAgICAgIHZhciBzdHVmZiA9IFtdO1xuICAgICAgICB2YXIgb2JqID0ge307XG5cbiAgICAgICAgb2JqLm1vZGVsID0gaW5kT2JqZWN0O1xuICAgICAgICBzdHVmZi5wdXNoKG9iaik7XG5cbiAgICAgICAgdmFyIHR4blBhY2tldCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXBwLlNDT1BFLnR4bikpO1xuICAgICAgICB0eG5QYWNrZXQuZG9jdW1lbnRzID0gW107XG4gICAgICAgIHZhciByZWZQYWNrID0geyBcImRvY3VtZW50XCI6IGluZE9iamVjdC5faWQsIFwicmV2XCI6IGluZE9iamVjdC5fcmV2IH07XG4gICAgICAgIHR4blBhY2tldC5kb2N1bWVudHMucHVzaChyZWZQYWNrKTtcbiAgICAgICAgYXBwLlNDT1BFLnR4bi5kb2N1bWVudHMucHVzaChyZWZQYWNrKTtcblxuICAgICAgICBkYW8udXBkYXRlVHJhbnNhY3Rpb24odHhuUGFja2V0KS50aGVuKGZ1bmN0aW9uKHN1Y2MpIHtcblxuICAgICAgICAgICAgZGFvLnNhdmUoaW5kT2JqZWN0KS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZWZQYWNrLnJldiA9IGRhdGEucmV2O1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZC4nLCBzdHVmZik7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZC4nLCBzdHVmZik7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZC4nLCBzdHVmZik7XG4gICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICB9KTtcblxuICAgIH0pO1xufTtcblxuZnVuY3Rpb24gbWFya1VwZGF0ZUluZGljYXRvcihhcmdzKSB7XG5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBhcmdzWzBdIHx8IHt9O1xuXG4gICAgdmFyIHV1aWQgPSBhcmdzWzFdIHx8ICcnO1xuICAgIHZhciBzdGF0dXMgPSBhcmdzWzJdIHx8ICcnO1xuICAgIHZhciBpbmRpY2F0b3JTZXRJZCA9IGFyZ3NbM10gfHwgJyc7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbd29ya2Zsb3dzL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzVVVJRCA9ICdcIiArIHV1aWQgKyBcIicgYW5kIGNhdGVnb3J5L3Rlcm0gPSAnXCIgKyBpbmRpY2F0b3JTZXRJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuc3RhdHVzID0gc3RhdHVzO1xuICAgICAgICB2YXIgaXRlbXNUb1Byb2Nlc3MgPSAxO1xuICAgICAgICB2YXIgc3R1ZmYgPSBbXTtcbiAgICAgICAgdmFyIG9iaiA9IHt9O1xuICAgICAgICBvYmoubW9kZWwgPSBpbmRPYmplY3Q7XG4gICAgICAgIHN0dWZmLnB1c2gob2JqKTtcblxuICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnSW5kaWNhdG9yIHVwZGF0ZWQuJywgc3R1ZmYpO1xuICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgfSk7XG59O1xuXG5cbmZ1bmN0aW9uIHNldFN0YXR1cyhhcmdzKSB7XG5cblxuICAgIC8vIEN1cnJlbnRseSBzZXR0aW5nIHN0YXR1cyB0byBzdWJwcm9jZXNzIGluc3RhbmNlLiBpdCBzaG91bGQgdXBkYXRlIHNvbWUgZmllbGQgaW4gYXBwUHJvZmlsZSBvciB3aGF0ZXZlciBpbmRpY2F0b3IgdGhlIHByb2ZpbGUgaGFzLlxuICAgIHZhciBfV0ZJbnN0YW5jZSA9IGFyZ3NbMF0gfHwge307XG4gICAgdmFyIHV1aWQgPSBhcmdzWzFdIHx8ICcnO1xuICAgIHZhciBzdGF0dXMgPSBhcmdzWzJdIHx8ICcnO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICB2YXIgc3ViUHJvY2Vzc0luc3RhbmNlID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgXG4gICAgICAgIHN1YlByb2Nlc3NJbnN0YW5jZS5zdGVwLm1lc3NhZ2UgPSBzdGF0dXM7XG5cbiAgICAgICAgcmVzb2x2ZShcIlNldCBwcm9maWxlIHN0YXR1cyBTdWNjZXNzXCIsIHN1YlByb2Nlc3NJbnN0YW5jZSk7XG5cbiAgICB9KTtcblxufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG5cbiAgICBjcmVhdGU6IGNyZWF0ZSxcbiAgICBzYXZlOiBzYXZlLFxuICAgIHN1Ym1pdDogc3VibWl0LFxuICAgIGF1dGhvcmlzZTogYXV0aG9yaXNlLFxuICAgIGNsb3NlOiBjbG9zZSxcbiAgICBzZXREcmFmdDogc2V0RHJhZnQsXG4gICAgc2V0VW5EcmFmdDogc2V0VW5EcmFmdCxcbiAgICBjcmVhdGVQcm9maWxlOiBjcmVhdGVQcm9maWxlLFxuICAgIHNldEluc3RhbmNlVGl0bGU6IHNldEluc3RhbmNlVGl0bGUsXG4gICAgZGVsZXRlUHJvZmlsZTogZGVsZXRlUHJvZmlsZSxcbiAgICB1cGRhdGVJbmRpY2F0b3I6IHVwZGF0ZUluZGljYXRvcixcbiAgICBtYXJrVXBkYXRlSW5kaWNhdG9yOiBtYXJrVXBkYXRlSW5kaWNhdG9yLFxuICAgIHVwZGF0ZUluZGljYXRvcldyYXBwZXI6IHVwZGF0ZUluZGljYXRvcldyYXBwZXJcblxufSIsIid1c2Ugc3RyaWN0JztcblxuXG5mdW5jdGlvbiBnZXRMYW5ndWFnZU1lc3NhZ2UobWVzc2FnZSkge1xuXG4gICAgdmFyIGxhbmd1YWdlID0gc2VydmljZS5nZXRMYW5ndWFnZSgpO1xuICAgIHZhciByZXMgPSBtZXNzYWdlLmkxOG5bbGFuZ3VhZ2VdO1xuICAgIHJldHVybiByZXM7XG5cbn07XG5cbmZ1bmN0aW9uIGdldE5vZGVWYWx1ZShkYXRhLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIGlmIChkYXRhLnZhbHVlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICB2YXIgaW5wdXREYXRhVHlwZSA9ICdzdHJpbmcnO1xuXG4gICAgICAgICAgICBpZiAoZGF0YS52YWx1ZS5kYXRhdHlwZS5kYXRhVHlwZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpbnB1dERhdGFUeXBlID0gZGF0YS52YWx1ZS5kYXRhdHlwZS5kYXRhVHlwZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5wdXREYXRhVHlwZSA9IGRhdGEudmFsdWUuZGF0YXR5cGU7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgdmFyIGlucHV0VmFsdWUgPSBkYXRhLnZhbHVlLmRhdGE7XG5cbiAgICAgICAgICAgIGlmIChpbnB1dERhdGFUeXBlID09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShOdW1iZXIoaW5wdXRWYWx1ZSkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGFUeXBlID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShpbnB1dFZhbHVlKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhVHlwZSA9PSAnaW50ZWdlcicpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHBhcnNlSW50KGlucHV0VmFsdWUpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhVHlwZSA9PSAnZGVjaW1hbCcpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHBhcnNlRmxvYXQoaW5wdXRWYWx1ZSkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGFUeXBlID09ICdkYXRlJyB8fCBpbnB1dERhdGFUeXBlID09ICdkYXRlVGltZScpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGlucHV0VmFsdWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBJbiBjYXNlIGRhdGEgdHlwZSBub3QgbWF0Y2hlZFxuICAgICAgICAgICAgICAgIHJlc29sdmUoaW5wdXRWYWx1ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBlbHNlIGlmIChkYXRhLmluZGljYXRvclVVSUQgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgIC8vIEEgY2hhbmdlIGlzIHJlcXVpcmVkIHRvIG1ha2Ugc3VyZSBwcm9wZXIgc2NvcGUgaXMgaWRlbnRpZmllZC5cbiAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gbnVsbDtcblxuICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3MgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHN1YnByb2Nlc3MuaW5kaWNhdG9ycy5sZW5ndGggPT0gMCkge1xuXG4gICAgICAgICAgICAgICAgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIGRhdGEuaW5kaWNhdG9yVVVJRC5pbmRpY2F0b3JTZXRJZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2lkIGVxICdcIiArIGRhdGEuaW5kaWNhdG9yVVVJRC5pbmRpY2F0b3JTZXRJZCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgc3VicHJvY2Vzcywge30pWzBdO1xuICAgICAgICAgICAgICAgIGlmIChpbmRpY2F0b3JVVUlEID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgZGF0YS5pbmRpY2F0b3JVVUlELmluZGljYXRvclNldElkICsgXCInXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cblxuXG4gICAgICAgICAgICByZXNvbHZlKGluZGljYXRvclVVSUQpO1xuXG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YS5pbmRpY2F0b3IgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgZGF0YS5pbmRpY2F0b3IuaW5kaWNhdG9yU2V0SWQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgeHBhdGggPSAnL21vZGVsL3BlbmRpbmcvZGF0YS8nICsgZGF0YS5pbmRpY2F0b3IuaW5kaWNhdG9yU2V0SWQgKyAnLycgKyBkYXRhLmluZGljYXRvci5lbGVtZW50SWQ7XG5cbiAgICAgICAgICAgIC8vdmFyIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgIHZhciBzdWJwcm9jZXNzVHlwZSA9IEpTT04ueHBhdGgoXCIvY29uZmlnL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbX2lkIGVxIC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkXS90eXBlXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAvL3ZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuXG4gICAgICAgICAgICAvLyBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgIC8vICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCBfaWQgPSAvc3VicHJvY2Vzc2VzW19pZCA9IFwiICsgcGFydCArIFwiXS9faWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgIC8vIH1cblxuXG5cblxuICAgICAgICAgICAgdmFyIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFydCA9IGxpYnJhcnkuZ2V0U3VicHJvZmlsZVN1YnByb2Nlc3NJZHMoKTtcbiAgICAgICAgICAgICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZCBhbmQgdXVpZCA9IFwiKyBwYXJ0ICtcIl0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgfVxuXG5cblxuXG5cbiAgICAgICAgICAgIHZhciByZXBsYWNlZFBhdGggPSByZXBsYWNlQWxsKHhwYXRoLCAnI1NFUVVFTkNFIycsIHNlcSk7XG5cbiAgICAgICAgICAgIHZhciB2YWxpZERhdGUgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vZGF0ZXMvdmFsaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIHZhciBjb25jYXRWYWxpZERhdGUgPSBcIidcIiArIHZhbGlkRGF0ZSArIFwiJ1wiO1xuICAgICAgICAgICAgdmFyIG5ld1BhdGggPSByZXBsYWNlQWxsKHJlcGxhY2VkUGF0aCwgJyNFTkRfREFURSMnLCBjb25jYXRWYWxpZERhdGUpO1xuICAgICAgICAgICAgdmFyIGRvdFJlcGxhY2VkID0gcmVwbGFjZUFsbChuZXdQYXRoLCAnWy5dJywgJy8nKTtcbiAgICAgICAgICAgIHZhciByZXRWYWx1ZSA9IEpTT04ueHBhdGgoZG90UmVwbGFjZWQsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgaWYoZGF0YS5pbmRpY2F0b3IuYWRkU3RyaW5nICE9IHVuZGVmaW5lZCAmJiBkYXRhLmluZGljYXRvci5hZGRTdHJpbmcgIT0gXCJcIil7XG4gICAgICAgICAgICAgICAgcmV0VmFsdWUgPSByZXRWYWx1ZSArIGRhdGEuaW5kaWNhdG9yLmFkZFN0cmluZ1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzb2x2ZShyZXRWYWx1ZSk7XG5cbiAgICAgICAgfSBlbHNlIGlmIChkYXRhLnN5c3RlbSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgcmVzb2x2ZShcIkVSUk9SOiBVbmltcGxlbWVudGVkIHN5c3RlbSB0eXBlIGZvdW5kLlwiKTtcblxuICAgICAgICB9IGVsc2UgaWYgKGRhdGEudmFyaWFibGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBUYWtlbiBvdXQgb2Ygc2NoZW1hXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc0luc3RhbmNlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRlc2NyaXB0aW9uXCI6IFwidmFsdWUgb2YgdGhlIHZhcmlhYmxlIHN1YlByb2Nlc3NJbnN0YW5jZSB2YXJpYWJsZSBjdXJyZW50IHN1YnByb2Nlc3NJbnN0YW5jZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRlc2NyaXB0aW9uXCI6IFwidmFsdWUgb2YgdGhlIHZhcmlhYmxlIGluIHRoZSBjdXJyZW50IHN0ZXBcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc0lkXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRlc2NyaXB0aW9uXCI6IFwidmFsdWUgb2YgdGhlIGN1cnJlbnQgYXBwbGljYWl0b24gSURcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAoZGF0YS52YXJpYWJsZS5wcm9maWxlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHZhcmlhYmxlTmFtZSA9IGRhdGEudmFyaWFibGUucHJvZmlsZTtcblxuICAgICAgICAgICAgICAgIHZhciBwcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHZhciBwcm9maWxlVmFyaWFibGVGaWxlTmFtZSA9IHByb2ZpbGVJZCArICc6dmFyaWFibGVzJztcblxuICAgICAgICAgICAgICAgIGRhby5nZXQocHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUpLnRoZW4oZnVuY3Rpb24oZmlsZSkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKGRhdGEudmFyaWFibGUudHlwZSAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoZGF0YS52YXJpYWJsZS50eXBlID09IFwiY291bnRcIil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShmaWxlW2RhdGEudmFyaWFibGUubmFtZV0ubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiRVJST1I6IFByb2ZpbGUgdmFyaWFibGVzIHR5cGUgaW1wbGVtZW50YXRpb24gLSBDYXNlIG5vdCBmb3VuZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmluYWxWYWx1ZSA9IGZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aFRvRWxlbWVudCA9IHZhcmlhYmxlTmFtZSA9PSBcIlwiID8gW10gOiB2YXJpYWJsZU5hbWUuc3BsaXQoL1snXCJcXFtcXF0uXSsvKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBwYXRoVG9FbGVtZW50Lmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocGF0aFRvRWxlbWVudFtrXSA9PSBcIlwiKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlID0gZmluYWxWYWx1ZVtwYXRoVG9FbGVtZW50W2tdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBmaW5hbFZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihvYmogPT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJWYXJpYWJsZSBub3QgZm91bmRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2Ygb2JqID09ICdvYmplY3QnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0U2VxID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlcywgcmVqKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlcSA9IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRhdGEudmFyaWFibGUucGVyaW9kaWMgPT0gdW5kZWZpbmVkIHx8IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEudmFyaWFibGUucGVyaW9kaWMuc2VxID09IHVuZGVmaW5lZCl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy92YXIgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJwcm9jZXNzVHlwZSA9IEpTT04ueHBhdGgoXCIvY29uZmlnL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbX2lkIGVxIC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkXS90eXBlXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWQgYW5kIF9pZCA9IC9zdWJwcm9jZXNzZXNbX2lkID0gXCIgKyBwYXJ0ICsgXCJdL19pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnByb2Nlc3NUeXBlID09IFBST0NFU1NfVFlQRV9TVUJQUk9GSUxFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFydCA9IGxpYnJhcnkuZ2V0U3VicHJvZmlsZVN1YnByb2Nlc3NJZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCB1dWlkID0gXCIrIHBhcnQgK1wiXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMoc2VxKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXROb2RlVmFsdWUoZGF0YS52YXJpYWJsZS5wZXJpb2RpYy5zZXEsIF9XRkluc3RhbmNlLCB1dWlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHNlcVZhcil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyhzZXFWYXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlaihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnZXRWYWwgPSBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXMscmVqKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZQYXJhbSA9IFwidmFsdWVcIjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZGF0YS52YXJpYWJsZS5wZXJpb2RpYyAhPSB1bmRlZmluZWQgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS52YXJpYWJsZS5wZXJpb2RpYy52YWx1ZSAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXROb2RlVmFsdWUoZGF0YS52YXJpYWJsZS5wZXJpb2RpYy52YWx1ZSwgX1dGSW5zdGFuY2UsIHV1aWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHZQYXIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzKHZQYXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlaihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzKHZQYXJhbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldFNlcSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oc2VxKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0VmFsKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24odlBhcmFtKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZVBhdGggPSBcIi9cIiArIHZhcmlhYmxlTmFtZSArIFwiW1wiICsgc2VxICsgXCJdL1wiICsgdlBhcmFtO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJldFZhbHVlID0gSlNPTi54cGF0aCh2YWx1ZVBhdGgsIGZpbGUsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmV0VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICBcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICBcbiAgICBcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIG9iaiA9PSAnc3RyaW5nJykge1xuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob2JqKTtcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkVSUk9SOiBQcm9maWxlIHZhcmlhYmxlcyBub3QgZm91bmRcIik7XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSBlbHNlIGlmKGRhdGEudmFyaWFibGUuc3ViUHJvZmlsZSAhPSB1bmRlZmluZWQpe1xuXG4gICAgICAgICAgICAgICAgdmFyIHZhcmlhYmxlTmFtZSA9IGRhdGEudmFyaWFibGUuc3ViUHJvZmlsZTtcbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkXG4gICAgICAgICAgICAgICAgaWYoZGF0YS52YXJpYWJsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkICYmIGRhdGEudmFyaWFibGUuc3VicHJvZmlsZUlkICE9IFwiXCIpe1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBkYXRhLnZhcmlhYmxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAvLyB2YXIgcHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUgPSAgc3VicHJvZmlsZUlkICsgJzp2YXJpYWJsZXMnO1xuXG4gICAgICAgICAgICAgICAgZGFvLmdldChwcm9maWxlVmFyaWFibGVGaWxlTmFtZSkudGhlbihmdW5jdGlvbihmaWxlKSB7XG5cblxuICAgICAgICAgICAgICAgICAgICB2YXIgZmluYWxWYWx1ZSA9IGZpbGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXRoVG9FbGVtZW50ID0gdmFyaWFibGVOYW1lID09IFwiXCIgPyBbXSA6IHZhcmlhYmxlTmFtZS5zcGxpdCgvWydcIlxcW1xcXS5dKy8pO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcGF0aFRvRWxlbWVudC5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYocGF0aFRvRWxlbWVudFtrXSA9PSBcIlwiKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBmaW5hbFZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKG9iaiA9PSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiVmFyaWFibGUgbm90IGZvdW5kXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBvYmogPT0gJ29iamVjdCcpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlcSA9IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRhdGEudmFyaWFibGUucGVyaW9kaWMgPT0gdW5kZWZpbmVkIHx8IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEudmFyaWFibGUucGVyaW9kaWMuc2VxID09IHVuZGVmaW5lZCl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VicHJvY2Vzc1R5cGUgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0vdHlwZVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZCBhbmQgX2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgPSBcIiArIHBhcnQgKyBcIl0vX2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCB1dWlkID0gXCIrIHBhcnQgK1wiXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXEgPSBnZXROb2RlVmFsdWUoZGF0YS52YXJpYWJsZS5wZXJpb2RpYy5zZXEsIF9XRkluc3RhbmNlLCB1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdlBhcmFtID0gXCJ2YWx1ZVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoZGF0YS52YXJpYWJsZS5wZXJpb2RpYyAhPSB1bmRlZmluZWQgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS52YXJpYWJsZS5wZXJpb2RpYy52YWx1ZSAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2UGFyYW0gPSBnZXROb2RlVmFsdWUoZGF0YS52YXJpYWJsZS5wZXJpb2RpYy52YWx1ZSwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZVBhdGggPSBcIi9cIiArIHZhcmlhYmxlTmFtZSArIFwiW1wiICsgc2VxICsgXCJdL1wiICsgdlBhcmFtO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJldFZhbHVlID0gSlNPTi54cGF0aCh2YWx1ZVBhdGgsIGZpbGUsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmV0VmFsdWUpO1xuXG5cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvYmogPT0gJ3N0cmluZycpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShvYmopO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiRVJST1I6IHN1YiBQcm9maWxlIHZhcmlhYmxlcyBub3QgZm91bmRcIik7XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlamVjdChcIkVSUk9SOiBVbmltcGxlbWVudGVkIHByb2ZpbGUgdHlwZSBmb3VuZC5cIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBlbHNlIGlmIChkYXRhLmluZGljYXRvcldyYXBwZXIgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXQgPSBkYXRhLmluZGljYXRvcldyYXBwZXIuaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIGluZGljYXRvclNldCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIGVsZW1lbnRwYXRoID0gcmVwbGFjZUFsbChkYXRhLmluZGljYXRvcldyYXBwZXIucGF0aCwgXCJbLl1cIiwgXCIvXCIpXG4gICAgICAgICAgICB2YXIgeHBhdGggPSAnLycgKyBlbGVtZW50cGF0aFxuICAgICAgICAgICAgdmFyIHZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICByZXNvbHZlKHZhbHVlKTtcblxuICAgICAgICB9IGVsc2UgaWYgKGRhdGEuY2FsY3VsYXRlZCAhPSB1bmRlZmluZWQpIHtcblxuXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSAnJztcbiAgICAgICAgICAgIHZhciBzZXBhcmF0b3IgPSBkYXRhLmNhbGN1bGF0ZWQuc2VwYXJhdG9yO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEuY2FsY3VsYXRlZC5lbGVtZW50cy5sZW5ndGggLSAxOyBpKyspIHtcblxuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cyA9IGRhdGEuY2FsY3VsYXRlZC5lbGVtZW50cztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVJdGVtcyA9IFtcImZyb21SZXBlYXRcIiwgXCJlbGVtZW50UHJvcGVydHlcIiwgXCJjb25zdGFudFZhbHVlXCIsIFwiZWxlbWVudFdyYXBwZXJcIiwgXCJjdXJyZW50RGF0ZVwiLCBcInJhbmRvbURpZ2l0c1wiLCBcInByb2ZpbGVPYmplY3RFbGVtZW50XCIsIFwicHJvZmlsZU9iamVjdFdyYXBwZXJcIiwgXCJjdXJyZW50RmluYW5jaWFsWWVhclwiLCBcInNjb3BlVmFyaWFibGVcIiwgXCJ4cGF0aFwiXTtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGVsZW1lbnRzW2ldLCBwb3NzaWJsZUl0ZW1zKSkge1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2VsZW1lbnRQcm9wZXJ0eSc6XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZWxlbWVudHNbaV0uZWxlbWVudFByb3BlcnR5LmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBpbmRpY2F0b3JTZXQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cGF0aCA9IHJlcGxhY2VBbGwoZWxlbWVudHNbaV0uZWxlbWVudFByb3BlcnR5LmVsZW1lbnRJZCwgXCJbLl1cIiwgXCIvXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeHBhdGggPSAnL21vZGVsL3BlbmRpbmcvZGF0YS8nICsgaW5kaWNhdG9yU2V0ICsgJy8nICsgZWxlbWVudHBhdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlICsgc2VwYXJhdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cblxuICAgICAgICAgICAgICAgICAgICBjYXNlICdjb25zdGFudFZhbHVlJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IGVsZW1lbnRzW2ldLmNvbnN0YW50VmFsdWUudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlICsgc2VwYXJhdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2NvcGVWYXJpYWJsZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YXJOYW1lID0gZWxlbWVudHNbaV0uc2NvcGVWYXJpYWJsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtVmFsdWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYodmFyTmFtZSA9PSBcIiNVU0VSX0lEXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1WYWx1ZSA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih2YXJOYW1lID09IFwiI1VTRVJOQU1FXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1WYWx1ZSA9IExPQ0FMX1NFVFRJTkdTLlNFU1NJT04udXNlcm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHZhck5hbWUgPT0gXCIjRklSU1ROQU1FXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1WYWx1ZSA9IExPQ0FMX1NFVFRJTkdTLlNFU1NJT04uZmlyc3ROYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih2YXJOYW1lID09IFwiI0xBU1ROQU1FXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1WYWx1ZSA9IExPQ0FMX1NFVFRJTkdTLlNFU1NJT04ubGFzdE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihpdGVtVmFsdWUubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZWxlbWVudFdyYXBwZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldCA9IGVsZW1lbnRzW2ldLmVsZW1lbnRXcmFwcGVyLmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBpbmRpY2F0b3JTZXQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRwYXRoID0gcmVwbGFjZUFsbChlbGVtZW50c1tpXS5lbGVtZW50V3JhcHBlci5lbGVtZW50SWQsIFwiWy5dXCIsIFwiL1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy8nICsgZWxlbWVudHBhdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlICsgc2VwYXJhdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cblxuICAgICAgICAgICAgICAgICAgICBjYXNlICdjdXJyZW50RGF0ZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBmb3JtYXREYXRlKG5ldyBEYXRlKCkpICsgc2VwYXJhdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAncmFuZG9tRGlnaXRzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaWdpdHMgPSBlbGVtZW50c1tpXS5yYW5kb21EaWdpdHMuZGlnaXRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmRvbSA9IE1hdGgucmFuZG9tKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXhwID0gTWF0aC5wb3coMTAsIGRpZ2l0cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW50UGFydCA9IChyYW5kb20gKiBleHApIF4gMFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGludFBhcnQgKyBzZXBhcmF0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBjYXNlICdwcm9maWxlT2JqZWN0RWxlbWVudCc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXQgPSBlbGVtZW50c1tpXS5wcm9maWxlT2JqZWN0RWxlbWVudC5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnYXBwUHJvZmlsZSddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRwYXRoID0gcmVwbGFjZUFsbChlbGVtZW50c1tpXS5wcm9maWxlT2JqZWN0RWxlbWVudC5lbGVtZW50SWQsIFwiWy5dXCIsIFwiL1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy9tb2RlbC9wZW5kaW5nL2RhdGEvJyArIGluZGljYXRvclNldCArICcvJyArIGVsZW1lbnRwYXRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Byb2ZpbGVPYmplY3RXcmFwcGVyJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldCA9IGVsZW1lbnRzW2ldLnByb2ZpbGVPYmplY3RXcmFwcGVyLmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdhcHBQcm9maWxlJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLnByb2ZpbGVPYmplY3RXcmFwcGVyLndyYXBwZXJFbGVtZW50SWQsIFwiWy5dXCIsIFwiL1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy8nICsgZWxlbWVudHBhdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlICsgc2VwYXJhdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2N1cnJlbnRGaW5hbmNpYWxZZWFyJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0RGF0ZSA9IGVsZW1lbnRzW2ldLmN1cnJlbnRGaW5hbmNpYWxZZWFyLnN0YXJ0RGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGFydE1vbnRoID0gZWxlbWVudHNbaV0uY3VycmVudEZpbmFuY2lhbFllYXIuc3RhcnRNb250aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaW5hbmNpYWxZZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpICsgXCItXCIgKyBzdGFydE1vbnRoICsgXCItXCIgKyBzdGFydERhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgZmluYW5jaWFsWWVhciArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdmcm9tUmVwZWF0JzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldCA9IGVsZW1lbnRzW2ldLmZyb21SZXBlYXQuaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIGluZGljYXRvclNldCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cGF0aCA9IHJlcGxhY2VBbGwoZWxlbWVudHNbaV0uZnJvbVJlcGVhdC5wYXRoLCBcIlsuXVwiLCBcIi9cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeHBhdGggPSAnL21vZGVsL3BlbmRpbmcvZGF0YS8nICsgaW5kaWNhdG9yU2V0ICsgJy8nICsgZWxlbWVudHBhdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsdGVyID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoZWxlbWVudHNbaV0uZnJvbVJlcGVhdC5maWx0ZXIgPT0gJ3ZhbGlkRGF0ZScpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzcCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2ZCA9IHNwLmRhdGVzLnZhbGlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlciA9IFwiW2VuZGRhdGUgZXEgJ1wiKyB2ZCArXCInXS9cIlxuICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHhwYXRoID0geHBhdGggKyBmaWx0ZXIgKyByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLmZyb21SZXBlYXQuZWxlbWVudCwgXCJbLl1cIiwgXCIvXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlICsgc2VwYXJhdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICd4cGF0aCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihlbGVtZW50c1tpXS54cGF0aC5pbmRpY2F0b3JTZXRJZCAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXQgPSBlbGVtZW50c1tpXS54cGF0aC5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIGluZGljYXRvclNldCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtVmFsdWUgPSBKU09OLnhwYXRoKGVsZW1lbnRzW2ldLnhwYXRoLmV4cHIsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWUgKyBzZXBhcmF0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtVmFsdWUgPSBKU09OLnhwYXRoKGVsZW1lbnRzW2ldLnhwYXRoLmV4cHIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBpID0gZGF0YS5jYWxjdWxhdGVkLmVsZW1lbnRzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB2YXIgZWxlbWVudHMgPSBkYXRhLmNhbGN1bGF0ZWQuZWxlbWVudHM7XG5cbiAgICAgICAgICAgIHZhciBwb3NzaWJsZUl0ZW1zID0gW1wiZnJvbVJlcGVhdFwiLFwiZWxlbWVudFByb3BlcnR5XCIsIFwiY29uc3RhbnRWYWx1ZVwiLCBcImVsZW1lbnRXcmFwcGVyXCIsIFwiY3VycmVudERhdGVcIiwgXCJyYW5kb21EaWdpdHNcIiwgXCJwcm9maWxlT2JqZWN0RWxlbWVudFwiLCBcInByb2ZpbGVPYmplY3RXcmFwcGVyXCIsIFwiY3VycmVudEZpbmFuY2lhbFllYXJcIiwgXCJzY29wZVZhcmlhYmxlXCJdO1xuICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhlbGVtZW50c1tpXSwgcG9zc2libGVJdGVtcykpIHtcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2VsZW1lbnRQcm9wZXJ0eSc6XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXQgPSBlbGVtZW50c1tpXS5lbGVtZW50UHJvcGVydHkuaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgaW5kaWNhdG9yU2V0ICsgXCInXS9pbnN0YW5jZXMvdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRwYXRoID0gcmVwbGFjZUFsbChlbGVtZW50c1tpXS5lbGVtZW50UHJvcGVydHkuZWxlbWVudElkLCBcIlsuXVwiLCBcIi9cIilcbiAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy9tb2RlbC9wZW5kaW5nL2RhdGEvJyArIGluZGljYXRvclNldCArICcvJyArIGVsZW1lbnRwYXRoO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cbiAgICAgICAgICAgICAgICBjYXNlICdjb25zdGFudFZhbHVlJzpcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gZWxlbWVudHNbaV0uY29uc3RhbnRWYWx1ZS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2NvcGVWYXJpYWJsZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhck5hbWUgPSBlbGVtZW50c1tpXS5zY29wZVZhcmlhYmxlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYodmFyTmFtZSA9PSBcIiNVU0VSX0lEXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVZhbHVlID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih2YXJOYW1lID09IFwiI1VTRVJOQU1FXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVZhbHVlID0gTE9DQUxfU0VUVElOR1MuU0VTU0lPTi51c2VybmFtZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHZhck5hbWUgPT0gXCIjRklSU1ROQU1FXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVZhbHVlID0gTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5maXJzdE5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih2YXJOYW1lID09IFwiI0xBU1ROQU1FXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVZhbHVlID0gTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5sYXN0TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZihpdGVtVmFsdWUubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2VsZW1lbnRXcmFwcGVyJzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldCA9IGVsZW1lbnRzW2ldLmVsZW1lbnRXcmFwcGVyLmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIGluZGljYXRvclNldCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cGF0aCA9IHJlcGxhY2VBbGwoZWxlbWVudHNbaV0uZWxlbWVudFdyYXBwZXIuZWxlbWVudElkLCBcIlsuXVwiLCBcIi9cIilcbiAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy8nICsgZWxlbWVudHBhdGg7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpdGVtVmFsdWUgPSBKU09OLnhwYXRoKHhwYXRoLCBpbmRPYmplY3QsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cblxuICAgICAgICAgICAgICAgIGNhc2UgJ2N1cnJlbnREYXRlJzpcblxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgZm9ybWF0RGF0ZShuZXcgRGF0ZSgpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdyYW5kb21EaWdpdHMnOlxuICAgICAgICAgICAgICAgICAgICB2YXIgZGlnaXRzID0gZWxlbWVudHNbaV0ucmFuZG9tRGlnaXRzLmRpZ2l0cztcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmRvbSA9IE1hdGgucmFuZG9tKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBleHAgPSBNYXRoLnBvdygxMCwgZGlnaXRzKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGludFBhcnQgPSAocmFuZG9tICogZXhwKSBeIDBcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGludFBhcnQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAncHJvZmlsZU9iamVjdEVsZW1lbnQnOlxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXQgPSBlbGVtZW50c1tpXS5wcm9maWxlT2JqZWN0RWxlbWVudC5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdhcHBQcm9maWxlJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cGF0aCA9IHJlcGxhY2VBbGwoZWxlbWVudHNbaV0ucHJvZmlsZU9iamVjdEVsZW1lbnQuZWxlbWVudElkLCBcIlsuXVwiLCBcIi9cIilcbiAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy9tb2RlbC9wZW5kaW5nL2RhdGEvJyArIGluZGljYXRvclNldCArICcvJyArIGVsZW1lbnRwYXRoO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAncHJvZmlsZU9iamVjdFdyYXBwZXInOlxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXQgPSBlbGVtZW50c1tpXS5wcm9maWxlT2JqZWN0V3JhcHBlci5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdhcHBQcm9maWxlJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cGF0aCA9IHJlcGxhY2VBbGwoZWxlbWVudHNbaV0ucHJvZmlsZU9iamVjdFdyYXBwZXIud3JhcHBlckVsZW1lbnRJZCwgXCJbLl1cIiwgXCIvXCIpXG4gICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvJyArIGVsZW1lbnRwYXRoO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnY3VycmVudEZpbmFuY2lhbFllYXInOlxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdGFydERhdGUgPSBlbGVtZW50c1tpXS5jdXJyZW50RmluYW5jaWFsWWVhci5zdGFydERhdGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdGFydE1vbnRoID0gZWxlbWVudHNbaV0uY3VycmVudEZpbmFuY2lhbFllYXIuc3RhcnRNb250aDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbmFuY2lhbFllYXIgPSBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCkgKyBcIi1cIiArIHN0YXJ0TW9udGggKyBcIi1cIiArIHN0YXJ0RGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGZpbmFuY2lhbFllYXI7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNhc2UgJ2Zyb21SZXBlYXQnOlxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXQgPSBlbGVtZW50c1tpXS5mcm9tUmVwZWF0LmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIGluZGljYXRvclNldCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cGF0aCA9IHJlcGxhY2VBbGwoZWxlbWVudHNbaV0uZnJvbVJlcGVhdC5wYXRoLCBcIlsuXVwiLCBcIi9cIik7XG4gICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvbW9kZWwvcGVuZGluZy9kYXRhLycgKyBpbmRpY2F0b3JTZXQgKyAnLycgKyBlbGVtZW50cGF0aDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbHRlciA9ICcnO1xuICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZihlbGVtZW50c1tpXS5mcm9tUmVwZWF0LmZpbHRlciA9PSAndmFsaWREYXRlJyl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3AgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2ZCA9IHNwLmRhdGVzLnZhbGlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyID0gXCJbZW5kZGF0ZSBlcSAnXCIrIHZkICtcIiddL1wiXG4gICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgeHBhdGggPSB4cGF0aCArIGZpbHRlciArIHJlcGxhY2VBbGwoZWxlbWVudHNbaV0uZnJvbVJlcGVhdC5lbGVtZW50LCBcIlsuXVwiLCBcIi9cIik7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG5cblxuXG4gICAgICAgICAgICByZXNvbHZlKHZhbHVlKTtcblxuICAgICAgICB9IGVsc2UgaWYgKGRhdGEuc3ViUHJvY2VzcyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgaWYgKGRhdGEuc3ViUHJvY2Vzcy5wYXRoICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHBhdGggPSBkYXRhLnN1YlByb2Nlc3MucGF0aDtcbiAgICAgICAgICAgICAgICB2YXIgYXJyID0gcGF0aC5zcGxpdChcIi5cIik7XG4gICAgICAgICAgICAgICAgdmFyIHBhdGhJdGVtcyA9IFwiXCI7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgcGF0aEl0ZW1zID0gcGF0aEl0ZW1zICsgXCJbJ1wiICsgYXJyW2ldICsgXCInXVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvY2VzcyA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBmaW5hbFZhbHVlID0gc3VicHJvY2VzcztcbiAgICAgICAgICAgICAgICB2YXIgcGF0aFRvRWxlbWVudCA9IHBhdGhJdGVtcyA9PSBcIlwiID8gW10gOiBwYXRoSXRlbXMuc3BsaXQoL1snXCJcXFtcXF0uXSsvKTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcGF0aFRvRWxlbWVudC5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICBpZihwYXRoVG9FbGVtZW50W2tdID09IFwiXCIpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlID0gZmluYWxWYWx1ZVtwYXRoVG9FbGVtZW50W2tdXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZmluYWxWYWx1ZTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHZhbHVlKVxuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuc3ViUHJvY2Vzcy5zdGVwVXNlciAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICB9XG5cbiAgICB9KTtcblxuXG5cbn07XG5cblxuZnVuY3Rpb24gcmVwbGFjZUFsbCh0eHQsIHJlcGxhY2UsIHdpdGhfdGhpcykge1xuICAgIGlmICh0eXBlb2YgdHh0LnJlcGxhY2UgIT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBjb25zb2xlLmxvZyhyZXBsYWNlICsgJyAnICsgd2l0aF90aGlzKTtcbiAgICAgICAgY29uc29sZS5sb2codHh0KTtcbiAgICB9XG4gICAgcmV0dXJuIHR4dC5yZXBsYWNlKG5ldyBSZWdFeHAocmVwbGFjZSwgJ2cnKSwgd2l0aF90aGlzKTtcbn1cblxuZnVuY3Rpb24gZm9ybWF0RGF0ZShkYXRlKSB7XG5cbiAgICB2YXIgZGF5ID0gZGF0ZS5nZXREYXRlKCk7XG4gICAgdmFyIG1vbnRoSW5kZXggPSBkYXRlLmdldE1vbnRoKCk7XG4gICAgdmFyIHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XG5cbiAgICByZXR1cm4gZGF5ICsgJy0nICsgbW9udGhJbmRleCArICctJyArIHllYXI7XG59XG5cblxuZnVuY3Rpb24gY29tcGFyZShzdWJqZWN0LCBvcGVyYXRvciwgdmFsdWUpIHtcbiAgICBzd2l0Y2ggKG9wZXJhdG9yKSB7XG4gICAgICAgIGNhc2UgJz4nOlxuICAgICAgICAgICAgcmV0dXJuIHN1YmplY3QgPiB2YWx1ZTtcbiAgICAgICAgY2FzZSAnPCc6XG4gICAgICAgICAgICByZXR1cm4gc3ViamVjdCA8IHZhbHVlO1xuICAgICAgICBjYXNlICc+PSc6XG4gICAgICAgICAgICByZXR1cm4gc3ViamVjdCA+PSB2YWx1ZTtcbiAgICAgICAgY2FzZSAnPD0nOlxuICAgICAgICAgICAgcmV0dXJuIHN1YmplY3QgPD0gdmFsdWU7XG4gICAgICAgIGNhc2UgJz09JzpcbiAgICAgICAgICAgIGlmKHN1YmplY3QgPT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICBzdWJqZWN0ID0gXCJcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzdWJqZWN0ID09IHZhbHVlO1xuICAgICAgICBjYXNlICchPSc6XG4gICAgICAgICAgICByZXR1cm4gc3ViamVjdCAhPSB2YWx1ZTtcbiAgICB9XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0ge1xuXG4gICAgZ2V0TGFuZ3VhZ2VNZXNzYWdlOiBnZXRMYW5ndWFnZU1lc3NhZ2UsXG4gICAgZ2V0Tm9kZVZhbHVlOiBnZXROb2RlVmFsdWUsXG4gICAgY29tcGFyZTogY29tcGFyZVxuXG59IiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbCA9IHJlcXVpcmUoJ3V0aWxpdHknKTtcblxuLyoqXG4gKiBVc2VyIEludGVyZmFjZSBNb2R1bGVcbiAqXG4gKiBAbW9kdWxlIGxpYi91aVxuICogQGF1dGhvciBCcmVudCBHb3Jkb25cbiAqIEB2ZXJzaW9uIDAuMS4wXG4gKiBAZGVzY3JpcHRpb24gdGVzdCBkZXNjcmlwdGlvblxuICpcbiAqL1xuXG4gLyoqXG4gICogR2V0IGFsbCBwcm9jZXNzIHN1Yi1wcm9jZXNzZXMgdXNlciBpbnRlcmZhY2UgZGF0YVxuICAqXG4gICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAgKiBAcGFyYW0ge3N0cmluZ30gbGFuZyAtIHRoZSB1c2VyIHByZWZmZXJlZCBsYW5nYXVnZVxuICAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gICpcbiAgKiBAZXhhbXBsZSAnJ1xuICAqXG4gICogQHJldHVybiAnJ1xuICAqXG4gICovXG4gZnVuY3Rpb24gZ2V0UHJvY2Vzcyhwcm9jZXNzSWQsIGxhbmcsIF9XRkluc3RhbmNlKXtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHRyeSB7XG4gICAgICB2YXIgcHJvY2Vzc01vZGVsID0gW107XG4gICAgICB2YXIgcHJvY2Vzc0luc3RhbmNlID0gW107XG4gICAgXHRfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHByb2Nlc3NJdGVtKXtcbiAgICBcdFx0aWYgKHByb2Nlc3NJdGVtLmlkID09IHByb2Nlc3NJZCkge1xuICAgIFx0XHRcdHByb2Nlc3NJbnN0YW5jZSA9IHByb2Nlc3NJdGVtO1xuICAgIFx0XHR9XG4gICAgXHR9KVxuICAgICAgLy8gY29uc29sZS5sb2cocHJvY2Vzc0luc3RhbmNlLnN1YlByb2Nlc3Nlcy5sZW5ndGgpO1xuICAgICAgdXRpbC5zeW5jTG9vcChwcm9jZXNzSW5zdGFuY2Uuc3ViUHJvY2Vzc2VzLmxlbmd0aCwgZnVuY3Rpb24obG9vcCl7XG4gIFx0XHRcdHZhciBjb3VudGVyID0gbG9vcC5pdGVyYXRpb24oKTtcbiAgICAgICAgdmFyIHByb2Nlc3NTZXEgPSBwcm9jZXNzSW5zdGFuY2Uuc2VxO1xuICAgICAgICB2YXIgc3ViUHJvY2Vzc0lkID0gcHJvY2Vzc0luc3RhbmNlLnN1YlByb2Nlc3Nlc1tjb3VudGVyXS5pZDtcbiAgICAgICAgdmFyIHN1YlByb2Nlc3NTZXEgPSBwcm9jZXNzSW5zdGFuY2Uuc3ViUHJvY2Vzc2VzW2NvdW50ZXJdLnNlcTtcbiAgICAgICAgZ2V0U3ViUHJvY2Vzcyhwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgbGFuZywgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24obW9kZWwpe1xuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKG1vZGVsKTtcbiAgICAgICAgICBwcm9jZXNzTW9kZWwucHVzaChtb2RlbCk7XG4gICAgICAgICAgbG9vcC5uZXh0KCk7XG4gICAgICAgICAgLy8gY29uc29sZS5sb2cocHJvY2Vzc01vZGVsKTtcbiAgXHRcdFx0fSwgZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhwcm9jZXNzTW9kZWwpO1xuICBcdFx0XHRcdGxvb3AuYnJlYWsoKTtcbiAgXHRcdFx0XHRyZWplY3QoZXJyKTtcbiAgXHRcdFx0fSk7XG4gIFx0XHR9LCBmdW5jdGlvbigpe1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhwcm9jZXNzTW9kZWwpO1xuICBcdFx0XHRyZXNvbHZlKHByb2Nlc3NNb2RlbCk7XG4gIFx0XHR9KTtcbiAgICB9IGNhdGNoKGVycil7XG4gICAgICByZWplY3QoZXJyKTtcbiAgICB9XG4gIH0pXG59O1xuXG4gLyoqXG4gICogR2V0IFN1YlByb2Nlc3MgdXNlciBpbnRlcmZhY2UgZGF0YVxuICAqXG4gICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAgKiBAcGFyYW0ge251bWJlcn0gcHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBwcm9jZXNzIHNlcVxuICAqIEBwYXJhbSB7c3RyaW5nfSBzdWJQcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdWItcHJvY2VzcyBpZFxuICAqIEBwYXJhbSB7bnVtYmVyfSBzdWJQcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHN1Yi1wcm9jZXNzIHNlcVxuICAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gICpcbiAgKiBAZXhhbXBsZSAnJ1xuICAqXG4gICogQHJldHVybiAnJ1xuICAqXG4gICovXG5mdW5jdGlvbiBnZXRTdWJQcm9jZXNzKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBsYW5nLCBfV0ZJbnN0YW5jZSl7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICB0cnkge1xuICAgICAgdmFyIG1vZGVsID0ge1xuICAgICAgICBpZDogJycsXG4gICAgICAgIHNlcTogJycsXG4gICAgICAgIG5hbWU6ICcnLFxuICAgICAgICBoZWxwOiAnJyxcbiAgICAgICAgZGF0ZXM6ICcnLFxuICAgICAgICBzdGVwOiAnJ1xuICAgICAgfTtcbiAgICAgIHZhciBzdWJQcm9jZXNzID0gW107XG4gICAgXHR2YXIgc3ViUHJvY2Vzc0NvbmYgPSBbXTtcbiAgICBcdF9XRkluc3RhbmNlLmluc3RhbmNlLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ocHJvY2Vzc0l0ZW0pe1xuICAgIFx0XHRpZiAocHJvY2Vzc0l0ZW0uaWQgPT0gcHJvY2Vzc0lkICYmIHByb2Nlc3NJdGVtLnNlcSA9PSBwcm9jZXNzU2VxKSB7XG4gICAgXHRcdFx0dmFyIHNwTGVuZ3RoID0gcHJvY2Vzc0l0ZW0uc3ViUHJvY2Vzc2VzLmxlbmd0aDtcbiAgICBcdFx0XHRwcm9jZXNzSXRlbS5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NJdGVtKXtcbiAgICBcdFx0XHRcdGlmIChzdWJQcm9jZXNzSXRlbS5pZCA9PSBzdWJQcm9jZXNzSWQgJiYgc3ViUHJvY2Vzc0l0ZW0uc2VxID09IHN1YlByb2Nlc3NTZXEgJiYgc3ViUHJvY2Vzc0l0ZW0uY29tcGxldGUgPT0gZmFsc2UpIHtcbiAgICBcdFx0XHRcdFx0c3ViUHJvY2VzcyA9IHN1YlByb2Nlc3NJdGVtO1xuICAgIFx0XHRcdFx0fVxuICAgIFx0XHRcdH0pXG4gICAgXHRcdH1cbiAgICBcdH0pXG4gICAgXHQvLyBHZXQgdGhlIGN1cnJlbnQgc3ViUHJvY2VzcyBjb25maWd1cmF0aW9uXG4gICAgXHRfV0ZJbnN0YW5jZS5jb25maWcucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihwcm9jZXNzQ29uZmlnKXtcbiAgICBcdFx0aWYgKHByb2Nlc3NDb25maWcuX2lkID09IHByb2Nlc3NJZCkge1xuICAgIFx0XHRcdHByb2Nlc3NDb25maWcuc3ViUHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihzdWJQcm9jZXNzQ29uZmlnKXtcbiAgICBcdFx0XHRcdGlmIChzdWJQcm9jZXNzQ29uZmlnLl9pZCA9PSBzdWJQcm9jZXNzSWQpIHtcbiAgICBcdFx0XHRcdFx0c3ViUHJvY2Vzc0NvbmYgPSBzdWJQcm9jZXNzQ29uZmlnO1xuICAgIFx0XHRcdFx0fVxuICAgIFx0XHRcdH0pXG4gICAgXHRcdH1cbiAgICBcdH0pXG4gICAgICAvLyBVcGRhdGUgdGhlIG1vZGVsXG4gICAgICBtb2RlbC5pZCA9IHN1YlByb2Nlc3NDb25mLl9pZDtcbiAgICAgIG1vZGVsLnNlcSA9IHN1YlByb2Nlc3Muc2VxO1xuICAgICAgbW9kZWwubmFtZSA9IHV0aWwuZ2V0TmFtZShzdWJQcm9jZXNzQ29uZi5uYW1lLCBsYW5nKTtcbiAgICAgIG1vZGVsLmhlbHAgPSB1dGlsLmdldE5hbWUoc3ViUHJvY2Vzc0NvbmYuaGVscCwgbGFuZyk7XG4gICAgICBtb2RlbC5kYXRlcyA9IHN1YlByb2Nlc3MuZGF0ZXM7XG4gICAgICBtb2RlbC5zdGVwID0gc3ViUHJvY2Vzcy5zdGVwO1xuICAgICAgcmVzb2x2ZShtb2RlbCk7XG4gICAgfSBjYXRjaChlcnIpIHtcbiAgICAgIHJlamVjdChlcnIpO1xuICAgIH1cbiAgfSlcbn07XG5cblxuXG5cbmZ1bmN0aW9uIHByZXBhcmVOb3RpZmljYXRpb25TY3JlZW4oKXtcblxuICBcIlwiXG59O1xuXG4gbW9kdWxlLmV4cG9ydHMgPSB7XG5cbiAgZ2V0UHJvY2VzczogZ2V0UHJvY2Vzc1xuXG4gfVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5cbmZ1bmN0aW9uIGdldCgpIHtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgIH0pO1xuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuICAgIGdldDogZ2V0XG5cbn0iLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlsID0gcmVxdWlyZSgndXRpbGl0eScpO1xudmFyIGFjdGlvbnNNb2R1bGUgPSByZXF1aXJlKCcuL2FjdGlvbnMnKTtcbnZhciBoZWxwZXIgPSByZXF1aXJlKCcuL2hlbHBlcicpO1xudmFyIGZvcm0gPSByZXF1aXJlKCcuL2Zvcm0nKTtcblxuLyoqXG4gKiBQcm9jZXNzIE1vZHVsZVxuICpcbiAqIEBtb2R1bGUgbGliL3Byb2Nlc3NcbiAqIEBhdXRob3IgSGFzYW4gQWJiYXNcbiAqIEB2ZXJzaW9uIDAuMi4xXG4gKiBAZGVzY3JpcHRpb24gV29ya2Zsb3cgaW1wbGVtZW50YXRpb24gY2hhbmdlZCBhcyBwZXIgbmV3IHNjaGVtYSBpbXBsZW1lbnRhdGlvblxuICpcbiAqL1xuXG4vKipcbiAqIENvdW50IGFuIGFycmF5IG9mIGl0ZW1zXG4gKlxuICogQHBhcmFtIHtBcnJheX0gYXJyIC0gdGhlIGFycmF5IGRhdGFcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIGNvdW50KGFycikge1xuICAgIGlmIChhcnIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gYXJyLmxlbmd0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG5cbn07XG5cbi8qKlxuICogUHJvY2VzcyBwcmUtcmVxdWlzaXRlc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBwcmVyZXF1aXNpdGVzIC0gdGhlIHByZS1yZXF1aXNpdGVzIGNvbmZpZyBkYXRhXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBwcmVSZXF1aXNpdGVzKHByZXJlcXVpc2l0ZXMsIF9XRkluc3RhbmNlLCBzcHV1aWQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIC8vIFVuY29tbWVudCBiZWxvdyBzZWN0aW9uIHdoZW4gcmVhZHkgdG8gaW1wbGVtZW50XG4gICAgICAgIHZhciBjb21wbGV0ZWQgPSBbXTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHV0aWwuc3luY0xvb3AocHJlcmVxdWlzaXRlcy5sZW5ndGgsIGZ1bmN0aW9uKGxvb3ApIHtcbiAgICAgICAgICAgICAgICB2YXIgY291bnRlciA9IGxvb3AuaXRlcmF0aW9uKCk7XG4gICAgICAgICAgICAgICAgcHJlUmVxdWlzaXRlKHByZXJlcXVpc2l0ZXNbY291bnRlcl0sIF9XRkluc3RhbmNlLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBhbGwgcHJlLXJlcXVpc2l0ZXMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS5cbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGVkLnB1c2godHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGxvb3AubmV4dCgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWQucHVzaChmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIGxvb3AuYnJlYWsoKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoY29tcGxldGVkLmV2ZXJ5KEJvb2xlYW4pKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdQcmUtcmVxdWlzaXRlcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywgJ05vdCBhbGwgcHJlLXJlcXVpc2l0ZXMgcGFzc2VkLicpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pO1xufTtcblxuLyoqXG4gKiBQcm9jZXNzIHByZS1yZXF1aXNpdGUsIGV4ZWN1dGUgdGhlIHByZS1yZXF1aXNpdGUgY29uZGl0aW9uLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBwcmVyZXF1aXNpdGUgLSB0aGUgcHJlLXJlcXVpc2l0ZSBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGVcbiAqIFByb2Nlc3MucHJlUmVxdWlzaXRlKGNvbmZpZywgY291bnRlciwgaW5zdGFuY2UsIGRvYyk7XG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gcHJlUmVxdWlzaXRlKHByZXJlcXVpc2l0ZSwgX1dGSW5zdGFuY2UsIHNwdXVpZCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuXG5cbiAgICAgICAgaWYgKHByZXJlcXVpc2l0ZS5jaGVjay5udW1iZXJQcm9jZXNzSW5zdGFuY2VzICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICB2YXIgbnVtYmVyUHJvY2Vzc0luc3RhbmNlcyA9IHByZXJlcXVpc2l0ZS5jaGVjay5udW1iZXJQcm9jZXNzSW5zdGFuY2VzO1xuICAgICAgICAgICAgdmFyIF9maWx0ZXJPcGVyYXRvciA9IG51bWJlclByb2Nlc3NJbnN0YW5jZXMub3BlcmF0b3I7XG4gICAgICAgICAgICB2YXIgeHBhdGhPcGVyYXRvciA9ICcnO1xuICAgICAgICAgICAgc3dpdGNoIChfZmlsdGVyT3BlcmF0b3IpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdncmVhdGVyVGhhbic6XG4gICAgICAgICAgICAgICAgICAgIHhwYXRoT3BlcmF0b3IgPSAnZ3QnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdsZXNzVGhhbic6XG4gICAgICAgICAgICAgICAgICAgIHhwYXRoT3BlcmF0b3IgPSAnbHQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdncmVhdGVyVGhhbkVxdWFsJzpcbiAgICAgICAgICAgICAgICAgICAgeHBhdGhPcGVyYXRvciA9ICdnZSc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2xlc3NUaGFuRXF1YWwnOlxuICAgICAgICAgICAgICAgICAgICB4cGF0aE9wZXJhdG9yID0gJ2xlJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZXF1YWxUbyc6XG4gICAgICAgICAgICAgICAgICAgIHhwYXRoT3BlcmF0b3IgPSAnZXEnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdub3RFcXVhbFRvJzpcbiAgICAgICAgICAgICAgICAgICAgeHBhdGhPcGVyYXRvciA9ICduZSc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgX3N1YnByb2Nlc3NJZCA9IG51bWJlclByb2Nlc3NJbnN0YW5jZXMuc3ViUHJvY2Vzc0lkO1xuXG4gICAgICAgICAgICB2YXIgX2ZpbHRlclZhbHVlID0gbnVtYmVyUHJvY2Vzc0luc3RhbmNlcy50eXBlO1xuXG4gICAgICAgICAgICB2YXIgaW5uZXJYcGF0aCA9ICcnXG5cbiAgICAgICAgICAgIGlmIChfZmlsdGVyVmFsdWUgPT0gXCJhbGxcIikge1xuICAgICAgICAgICAgICAgIGlubmVyWHBhdGggPSAnJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5uZXJYcGF0aCA9IFwiW2NvbXBsZXRlIGVxICd0cnVlJ11cIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGFkZGl0aW9uYWxGaWx0ZXIgPSBcIlwiO1xuXG4gICAgICAgICAgICBpZiAobnVtYmVyUHJvY2Vzc0luc3RhbmNlcy5maWx0ZXIgIT0gdW5kZWZpbmVkICYmIG51bWJlclByb2Nlc3NJbnN0YW5jZXMuZmlsdGVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBhZGRpdGlvbmFsRmlsdGVyID0gXCJbXCIgKyBudW1iZXJQcm9jZXNzSW5zdGFuY2VzLmZpbHRlciArIFwiXVwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZnVsbFBhdGggPSBcImNvdW50KC9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW2lkIGVxICdcIiArIF9zdWJwcm9jZXNzSWQgKyBcIiddXCIgKyBpbm5lclhwYXRoICsgYWRkaXRpb25hbEZpbHRlciArIFwiKVwiO1xuXG4gICAgICAgICAgICB2YXIgcHJlcmVxUHJvY2Vzc1R5cGUgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBfc3VicHJvY2Vzc0lkICsgXCInXS90eXBlXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgcGFydCA9IGxpYnJhcnkuZ2V0U3VicHJvZmlsZVN1YnByb2Nlc3NJZHMoKTtcblxuICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9ICcnICYmIHByZXJlcVByb2Nlc3NUeXBlICE9IHVuZGVmaW5lZCAmJiBwcmVyZXFQcm9jZXNzVHlwZSA9PSBQUk9DRVNTX1RZUEVfU1VCUFJPRklMRSkge1xuICAgICAgICAgICAgICAgIGZ1bGxQYXRoID0gXCJjb3VudCgvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpZCBlcSAnXCIgKyBfc3VicHJvY2Vzc0lkICsgXCInIGFuZCB1dWlkID0gXCIgKyBwYXJ0ICsgXCJdXCIgKyBpbm5lclhwYXRoICsgXCIpXCI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzdWJqZWN0Q291bnQgPSBKU09OLnhwYXRoKGZ1bGxQYXRoLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIGNvdW50VmFsdWUgPSBwcmVyZXF1aXNpdGUuY2hlY2subnVtYmVyUHJvY2Vzc0luc3RhbmNlcy5jb3VudDtcbiAgICAgICAgICAgIHZhciBjb21wYXJlID0gdXRpbC5jb21wYXJlKHN1YmplY3RDb3VudCwgcHJlcmVxdWlzaXRlLmNoZWNrLm51bWJlclByb2Nlc3NJbnN0YW5jZXMub3BlcmF0b3IsIHBhcnNlSW50KGNvdW50VmFsdWUpKTtcblxuXG4gICAgICAgICAgICBpZiAoY29tcGFyZSkge1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdQcmUtcmVxdWlzaXRlcyBwYXNzZWQuJywge30pO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBoZWxwZXIuZ2V0TGFuZ3VhZ2VNZXNzYWdlKHByZXJlcXVpc2l0ZS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywgbWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgIH0gZWxzZSBpZiAocHJlcmVxdWlzaXRlLmNoZWNrLnZhcmlhYmxlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICB2YXIgc2NvcGUgPSBwcmVyZXF1aXNpdGUuY2hlY2sudmFyaWFibGUuc2NvcGU7XG4gICAgICAgICAgICB2YXIgZmlsZU5hbWUgPSAnJztcblxuICAgICAgICAgICAgaWYgKHNjb3BlID09IFwicHJvZmlsZVwiKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICBmaWxlTmFtZSA9IHByb2ZpbGVJZCArICc6dmFyaWFibGVzJztcblxuICAgICAgICAgICAgfSBlbHNlIGlmIChzY29wZSA9PSBcInN1YlByb2ZpbGVTdWJQcm9jZXNzSW5zdGFuY2VcIikge1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YlByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICBmaWxlTmFtZSA9IHN1YlByb2ZpbGVJZCArICc6dmFyaWFibGVzJztcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWplY3QoXCJFUlJPUjogU2NvcGUgJ1wiICsgc2NvcGUgKyBcIicgbm90IGltcGxlbWVudGVkIGluIHByZS1yZXF1aXNpdGVzXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkYW8uZ2V0KGZpbGVOYW1lKS50aGVuKGZ1bmN0aW9uKGZpbGUpIHtcblxuICAgICAgICAgICAgICAgIHZhciB2YXJpYWJsZU5hbWUgPSBwcmVyZXF1aXNpdGUuY2hlY2sudmFyaWFibGUubmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgdmFyaWFibGVUeXBlID0gcHJlcmVxdWlzaXRlLmNoZWNrLnZhcmlhYmxlLnR5cGU7XG4gICAgICAgICAgICAgICAgdmFyIGZpbmFsVmFsdWUgPSBmaWxlO1xuICAgICAgICAgICAgICAgIHZhciBwYXRoVG9FbGVtZW50ID0gdmFyaWFibGVOYW1lID09IFwiXCIgPyBbXSA6IHZhcmlhYmxlTmFtZS5zcGxpdCgvWydcIlxcW1xcXS5dKy8pO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBwYXRoVG9FbGVtZW50Lmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKHBhdGhUb0VsZW1lbnRba10gPT0gXCJcIikgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gZmluYWxWYWx1ZTtcbiAgICAgICAgICAgICAgICB2YXIgc3ViamVjdFZhbHVlQ2FsY3VsYXRlZDtcblxuICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZVR5cGUgIT0gdW5kZWZpbmVkICYmIHZhcmlhYmxlVHlwZSA9PSBcImFycmF5XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgc3ViamVjdFZhbHVlQ2FsY3VsYXRlZCA9IG9iajtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvYmogPT0gJ29iamVjdCcpIHtcblxuICAgICAgICAgICAgICAgICAgICAvL3ZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3VicHJvY2Vzc1R5cGUgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXS90eXBlXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkIGFuZCBfaWQgPSAvc3VicHJvY2Vzc2VzW19pZCA9IFwiICsgcGFydCArIFwiXS9faWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgLy8gfVxuXG5cblxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWJwcm9jZXNzVHlwZSA9PSBQUk9DRVNTX1RZUEVfU1VCUFJPRklMRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkIGFuZCB1dWlkID0gXCIgKyBwYXJ0ICsgXCJdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG5cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlUGF0aCA9IFwiL1wiICsgdmFyaWFibGVOYW1lICsgXCJbXCIgKyBzZXEgKyBcIl0vdmFsdWVcIjtcbiAgICAgICAgICAgICAgICAgICAgc3ViamVjdFZhbHVlQ2FsY3VsYXRlZCA9IEpTT04ueHBhdGgodmFsdWVQYXRoLCBmaWxlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvYmogPT0gJ3N0cmluZycpIHtcblxuICAgICAgICAgICAgICAgICAgICBzdWJqZWN0VmFsdWVDYWxjdWxhdGVkID0gb2JqO1xuXG4gICAgICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICAgICAgICAgIHZhciBpbnB1dFZhbHVlID0gcHJlcmVxdWlzaXRlLmNoZWNrLnZhcmlhYmxlLnZhbHVlLmRhdGE7XG4gICAgICAgICAgICAgICAgdmFyIGlucHV0RGF0YVR5cGUgPSBwcmVyZXF1aXNpdGUuY2hlY2sudmFyaWFibGUudmFsdWUuZGF0YVR5cGUuZGF0YVR5cGU7XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5wdXRWYWx1ZS5pbmRleE9mKFwieHBhdGg6XCIpID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZ1bGxQYXRoID0gaW5wdXRWYWx1ZS5zdWJzdHJpbmcoNik7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBKU09OLnhwYXRoKGZ1bGxQYXRoLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpbnB1dFZhbHVlID09IFwiI1ZBTElEX0RBVEVcIikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3BvID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNwbyAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBzcG8uZGF0ZXMudmFsaWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIHZhciBmaW5hbFZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dERhdGFUeXBlID09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBOdW1iZXIoaW5wdXRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGFUeXBlID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBpbnB1dFZhbHVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhVHlwZSA9PSAnaW50ZWdlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IHBhcnNlSW50KGlucHV0VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWFibGVUeXBlICE9IHVuZGVmaW5lZCAmJiB2YXJpYWJsZVR5cGUgPT0gXCJhcnJheVwiKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJqZWN0VmFsdWVDYWxjdWxhdGVkID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YmplY3RWYWx1ZUNhbGN1bGF0ZWQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJqZWN0VmFsdWVDYWxjdWxhdGVkID0gc3ViamVjdFZhbHVlQ2FsY3VsYXRlZC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhVHlwZSA9PSAnZGVjaW1hbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IHBhcnNlRmxvYXQoaW5wdXRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGFUeXBlID09ICdkYXRlJyB8fCBpbnB1dERhdGFUeXBlID09ICdkYXRlVGltZScpIHtcbiAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IGlucHV0VmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHN1YmplY3RWYWx1ZUNhbGN1bGF0ZWQgPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgIChwcmVyZXF1aXNpdGUuY2hlY2sudmFyaWFibGUuYWxsb3dCbGFuayAhPSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXJlcXVpc2l0ZS5jaGVjay52YXJpYWJsZS5hbGxvd0JsYW5rID09IHRydWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdWYXJpYWJsZSBQcmUtcmVxdWlzaXRlcyBwYXNzZWQuJywge30pO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21wYXJlID0gdXRpbC5jb21wYXJlKHN1YmplY3RWYWx1ZUNhbGN1bGF0ZWQsIHByZXJlcXVpc2l0ZS5jaGVjay52YXJpYWJsZS5vcGVyYXRvciwgZmluYWxWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21wYXJlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnVmFyaWFibGUgUHJlLXJlcXVpc2l0ZXMgcGFzc2VkLicsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gaGVscGVyLmdldExhbmd1YWdlTWVzc2FnZShwcmVyZXF1aXNpdGUubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZS5yZXBsYWNlKFwiI1ZBTElEX0RBVEVcIiwgc3ViamVjdFZhbHVlQ2FsY3VsYXRlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywgbWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKHByZXJlcXVpc2l0ZS5jaGVjay52YXJpYWJsZS5hbGxvd0JsYW5rICE9IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICBwcmVyZXF1aXNpdGUuY2hlY2sudmFyaWFibGUuYWxsb3dCbGFuayA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdWYXJpYWJsZSBQcmUtcmVxdWlzaXRlcyBwYXNzZWQuJywge30pO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gaGVscGVyLmdldExhbmd1YWdlTWVzc2FnZShwcmVyZXF1aXNpdGUubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGUHJlUmVxdWlzaXRlRXJyb3I6JywgbWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywgJ1ByZS1yZXF1aXNpdGUgdHlwZSBub3QgZGVmaW5lZC4nKTtcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG5cbiAgICAgICAgfVxuXG5cblxuICAgIH0pO1xufTtcblxuLyoqXG4gKiBQcm9jZXNzIHByZS1hY3Rpb25zc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBwcmVBY3Rpb25zIC0gdGhlIHByZS1hY3Rpb25zIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgY3VycmVudCB3b3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gcHJlQWN0aW9ucyhwcmVBY3Rpb25zLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB2YXIgY29tcGxldGVkID0gW107XG4gICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgIHZhciBzcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgcHJvY2Vzc0lEID0gc3BPYmplY3RbXCJtZXRhLWRhdGFcIl0ucHJvY2Vzc0NvbmZpZ0lkO1xuICAgICAgICAgICAgdmFyIHByb2Nlc3NJZCA9IHNwT2JqZWN0W1wibWV0YS1kYXRhXCJdLnN1YlByb2Nlc3NDb25maWdJZDtcbiAgICAgICAgICAgIHZhciBwcm9jZXNzU0VRID0gc3BPYmplY3RbXCJtZXRhLWRhdGFcIl0uc3ViUHJvY2Vzc0luc1NlcTtcbiAgICAgICAgICAgIHZhciBwcm9jZXNzU2VxID0gc3BPYmplY3RbXCJtZXRhLWRhdGFcIl0uc3ViUHJvY2Vzc0luc1NlcTtcblxuICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NDb25maWdPYmplY3QgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgcHJvY2Vzc0lEICsgXCInXS9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHByb2Nlc3NJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3N0ZXBcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgdXRpbC5zeW5jTG9vcChwcmVBY3Rpb25zLmxlbmd0aCwgZnVuY3Rpb24obG9vcCkge1xuICAgICAgICAgICAgICAgIHZhciBjb3VudGVyID0gbG9vcC5pdGVyYXRpb24oKTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ocHJlQWN0aW9uc1tjb3VudGVyXSwgcHJvY2Vzc0lELCBwcm9jZXNzU0VRLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NDb25maWdPYmplY3QsIHN0ZXBPYmplY3QsIF9XRkluc3RhbmNlLCB7fSwgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgYWxsIHByZS1yZXF1aXNpdGVzIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuXG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZC5wdXNoKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICBsb29wLm5leHQoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGVkLnB1c2goZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBsb29wLmJyZWFrKCk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbXBsZXRlZC5ldmVyeShCb29sZWFuKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUHJlLWFjdGlvbnMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZQcmVSZXF1aXNpdGVFcnJvcicsICdOb3QgYWxsIHByZS1hY3Rpb25zIHBhc3NlZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgZ2V0IHN1Yi1wcm9jZXNzIGRhdGEuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGlkIC0gdGhlIHN1YlByb2Nlc3MgY29uZmlnIGlkXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgY3VycmVudCB3b3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZVxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbmZ1bmN0aW9uIGdldFN1YlByb2Nlc3MoaWQsIF9XRkluc3RhbmNlKSB7XG4gICAgaWYgKF9XRkluc3RhbmNlLnN1YnByb2Nlc3NlcyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzcykge1xuICAgICAgICAgICAgaWYgKHN1YlByb2Nlc3MuaWQgPT0gaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3ViUHJvY2VzcztcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9KTtcbiAgICB9XG5cbn07XG5cbi8qKlxuICogUHJvY2VzcyBzdWItcHJvY2Vzc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBwcm9jZXNzIC0gdGhlIGN1cnJlbnQgcHJvY2VzcyBpZCBhbmQgc2VxXG4gKiBAcGFyYW0ge29iamVjdH0gc3ViUHJvY2VzcyAtIHRoZSBzdWItcHJvY2VzcyBpZCBhbmQgc2VxXG4gKiBAcGFyYW0ge29iamVjdH0gZGF0YSAtIHRoZSB1c2VyIGlucHV0IGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBzdWJQcm9jZXNzKHV1aWQsIHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdWJwcm9maWxlSWQsIGRhdGEsIF9XRkluc3RhbmNlKSB7XG4gICAgLy8gR2V0IHRoZSBjdXJyZW50IHByb2Nlc3Mgc3ViUHJvY2VzcyBpbnN0YW5jZVxuICAgIC8vIHZhciBzdWJQcm9jZXNzU2VxID0gMTtcbiAgICB2YXIgc3ViUHJvY2VzcyA9IFtdO1xuICAgIHZhciBwcm9jZXNzQ29uZiA9IFtdO1xuICAgIHZhciBzdWJQcm9jZXNzQ29uZiA9IFtdO1xuXG5cbiAgICAvLyBfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialByb2Nlc3MpIHtcbiAgICAvLyAgICAgaWYgKG9ialByb2Nlc3MuaWQgPT0gcHJvY2Vzc0lkICYmIG9ialByb2Nlc3Muc2VxID09IHByb2Nlc3NTZXEpIHtcbiAgICAvLyAgICAgICAgIHZhciBzcExlbmd0aCA9IG9ialByb2Nlc3Muc3ViUHJvY2Vzc2VzLmxlbmd0aDtcbiAgICAvLyAgICAgICAgIG9ialByb2Nlc3Muc3ViUHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpTdWJQcm9jZXNzKSB7XG4gICAgLy8gICAgICAgICAgICAgaWYgKG9ialN1YlByb2Nlc3MuaWQgPT0gc3ViUHJvY2Vzc0lkICYmIG9ialN1YlByb2Nlc3Muc2VxID09IHN1YlByb2Nlc3NTZXEpIHtcbiAgICAvLyAgICAgICAgICAgICAgICAgdmFyIHV1aWQgPSBvYmpTdWJQcm9jZXNzLnV1aWQ7XG4gICAgLy8gICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzc0l0ZW0pIHtcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzSXRlbS5faWQgPT0gdXVpZCkge1xuICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3MgPSBzdWJQcm9jZXNzSXRlbTtcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgIC8vICAgICAgICAgICAgICAgICB9KVxuICAgIC8vICAgICAgICAgICAgIH1cbiAgICAvLyAgICAgICAgIH0pO1xuICAgIC8vICAgICB9XG5cbiAgICAvLyB9KTtcblxuICAgIC8vIE5PVEU6IGluY29taW5nIHV1aWQgd2lsbCBiZSB1c2VkIGluIGNhc2Ugb2YgbmV3IHN1YnByb2Nlc3MgY3JlYXRpb25cbiAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NJdGVtKSB7XG4gICAgICAgIGlmIChzdWJQcm9jZXNzSXRlbS5faWQgPT0gdXVpZCkge1xuICAgICAgICAgICAgc3ViUHJvY2VzcyA9IHN1YlByb2Nlc3NJdGVtO1xuICAgICAgICB9XG4gICAgfSk7XG5cblxuXG5cbiAgICAvLyBHZXQgdGhlIGN1cnJlbnQgc3ViUHJvY2VzcyBjb25maWd1cmF0aW9uXG4gICAgX1dGSW5zdGFuY2UuY29uZmlnLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ocHJvY2Vzc0NvbmZpZykge1xuICAgICAgICBpZiAocHJvY2Vzc0NvbmZpZy5faWQgPT0gcHJvY2Vzc0lkKSB7XG4gICAgICAgICAgICBwcm9jZXNzQ29uZiA9IHByb2Nlc3NDb25maWc7XG4gICAgICAgICAgICBwcm9jZXNzQ29uZmlnLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzc0NvbmZpZykge1xuICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzQ29uZmlnLl9pZCA9PSBzdWJQcm9jZXNzSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0NvbmYgPSBzdWJQcm9jZXNzQ29uZmlnO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgfSk7XG5cbiAgICAvL1RPRE86IENoYW5nZSByZXF1aXJlZCB0byBtb3ZlIGlzQWN0aXZlIHRvIHN1YlByb2Nlc3MgZmlsZS5IZXJlXG4gICAgdmFyIGdyb3VwS2V5ID0gJyc7XG4gICAgdmFyIGJhc2VVVUlEID0gZGF0YS5iYXNlVVVJRDtcbiAgICB2YXIgY291bnRTdWJwcm9jZXNzSW5Db250ZXh0ID0gMDtcblxuICAgIGlmIChiYXNlVVVJRCAhPSB1bmRlZmluZWQgJiYgYmFzZVVVSUQgIT0gJycgJiYgYmFzZVVVSUQubGVuZ3RoID4gMCkge1xuXG4gICAgICAgIHZhciBwcmV2aW91c09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBiYXNlVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICBncm91cEtleSA9IHByZXZpb3VzT2JqZWN0Lmdyb3VwS2V5O1xuICAgICAgICBjb3VudFN1YnByb2Nlc3NJbkNvbnRleHQgPSBwcmV2aW91c09iamVjdFsnbWV0YS1kYXRhJ10uc3ViUHJvY2Vzc0luc1NlcTtcblxuXG4gICAgfSBlbHNlIHtcblxuICAgICAgICB2YXIgY2FyZEluZExpc3QgPSAnJztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdWJQcm9jZXNzQ29uZi5pbmRpY2F0b3JzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgY2FyZEluZExpc3QgPSBjYXJkSW5kTGlzdCArIFwiJ1wiICsgc3ViUHJvY2Vzc0NvbmYuaW5kaWNhdG9yc1tpXS5faWQgKyBcIicsXCI7XG4gICAgICAgIH1cbiAgICAgICAgY2FyZEluZExpc3QgPSBjYXJkSW5kTGlzdCArIFwiJ1wiICsgc3ViUHJvY2Vzc0NvbmYuaW5kaWNhdG9yc1tpXS5faWQgKyBcIidcIjtcbiAgICAgICAgdmFyIHNpbmdsZUNhcmQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbc2V0SWQgPSAoXCIgKyBjYXJkSW5kTGlzdCArIFwiKSBhbmQgY2FyZGluYWxpdHkgZXEgJ3NpbmdsZSddXCIsIGFwcC5TQ09QRS5BUFBfQ09ORklHLCB7fSkubGVuZ3RoO1xuXG4gICAgICAgIGlmIChzdWJQcm9jZXNzQ29uZi5pbnN0YW5jZVR5cGUubmV3U2VxdWVuY2UgIT0gdW5kZWZpbmVkIHx8IHNpbmdsZUNhcmQgPiAwKSB7XG4gICAgICAgICAgICB2YXIgcHJldmlvdXNPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlc1tpZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICBpZiAocHJldmlvdXNPYmplY3QgIT0gdW5kZWZpbmVkICYmIHByZXZpb3VzT2JqZWN0LnN1YlByb2Nlc3Nlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZ3JvdXBLZXkgPSBwcmV2aW91c09iamVjdC5zdWJQcm9jZXNzZXNbMF0uZ3JvdXBLZXk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGdyb3VwS2V5ID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBncm91cEtleSA9IGdlbmVyYXRlVVVJRCgpO1xuXG4gICAgICAgIH1cblxuICAgICAgICBjb3VudFN1YnByb2Nlc3NJbkNvbnRleHQgPSBKU09OLnhwYXRoKFwiY291bnQoL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbZ3JvdXBLZXkgZXEgJ1wiICsgZ3JvdXBLZXkgKyBcIiddKVwiLCBfV0ZJbnN0YW5jZS5pbnN0YW5jZSwge30pWzBdO1xuICAgIH1cblxuICAgIHZhciBsYWJlbCA9IGRhdGEubGFiZWw7XG4gICAgdmFyIHN1YlByb2Nlc3NPYmplY3RJZCA9IHV1aWQ7XG5cblxuXG5cblxuXG4gICAgdmFyIG1vZGVsID0ge1xuICAgICAgICBfaWQ6IHN1YlByb2Nlc3NPYmplY3RJZCxcbiAgICAgICAgaWQ6IHN1YlByb2Nlc3NJZCxcbiAgICAgICAgdHlwZTogJ3dvcmtmbG93SW5zdGFuY2VTdWJQcm9jZXNzJyxcbiAgICAgICAgZGF0ZVRpbWVDcmVhdGVkOiBtb21lbnQoKS5mb3JtYXQoKSxcbiAgICAgICAgZHVlRGF0ZVRpbWU6IG1vbWVudCgpLmZvcm1hdCgpLFxuICAgICAgICBzZXE6IHN1YlByb2Nlc3NTZXEsXG4gICAgICAgIGluaXRpYXRlZDogZmFsc2UsXG4gICAgICAgIGRhdGVzOiB7XG4gICAgICAgICAgICBjcmVhdGVkOiAnJyxcbiAgICAgICAgICAgIHZhbGlkOiAnJyxcbiAgICAgICAgICAgIHN0YXJ0OiAnJyxcbiAgICAgICAgICAgIGR1ZTogJycsXG4gICAgICAgICAgICBjbG9zZWQ6ICcnXG4gICAgICAgIH0sXG4gICAgICAgIGNvbXBsZXRlOiBmYWxzZSxcbiAgICAgICAgaW5kaWNhdG9yczogW10sXG4gICAgICAgIHN0ZXA6IHt9LFxuICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgIGdyb3VwS2V5OiBncm91cEtleSxcbiAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICBjaGFubmVsczogW1xuICAgICAgICAgICAgXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSxcbiAgICAgICAgICAgIFwicHJvZmlsZV9cIiArIGFwcC5TQ09QRS5wcm9maWxlSWQsXG4gICAgICAgICAgICBcImFwcGxpY2F0aW9uX1wiICsgYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICBcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpICsgXCJfYXBwbGljYXRpb25fXCIgKyBhcHAuU0NPUEUuYXBwbGljYXRpb25JZFxuICAgICAgICBdLFxuICAgICAgICBoaXN0b3J5OiBbXSxcbiAgICAgICAgLy9tZXRhIGluZm9ybWF0aW9uIGFkZGVkIGZvciBzZXJ2ZXIgc2lkZSBjb25mbGljdCBtYW5hZ2VtZW50IGFuZCBtZXJnZXJcbiAgICAgICAgXCJtZXRhLWRhdGFcIjoge1xuICAgICAgICAgICAgYXBwbGljYXRpb25JZDogYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICBjb21tdW5pdHlJZDogYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCksXG4gICAgICAgICAgICBwcm9maWxlSWQ6IGFwcC5TQ09QRS5wcm9maWxlSWQsXG4gICAgICAgICAgICBzdWJwcm9maWxlSWQ6IHN1YnByb2ZpbGVJZCA9PSB1bmRlZmluZWQgPyAnJyA6IHN1YnByb2ZpbGVJZCxcbiAgICAgICAgICAgIHByb2Nlc3NDb25maWdJZDogcHJvY2Vzc0lkLFxuICAgICAgICAgICAgc3ViUHJvY2Vzc0NvbmZpZ0lkOiBzdWJQcm9jZXNzSWQsXG4gICAgICAgICAgICBzdWJQcm9jZXNzSW5zU2VxOiBjb3VudFN1YnByb2Nlc3NJbkNvbnRleHQgKyAxXG4gICAgICAgIH0sXG4gICAgICAgIG1lc3NhZ2VzOiBbXSxcbiAgICAgICAgc3BTdGF0dXM6ICcnXG4gICAgfTtcblxuICAgIGlmIChkYXRhLnZhbGlkRGF0ZSAhPSB1bmRlZmluZWQgJiYgZGF0YS52YWxpZERhdGUubGVuZ3RoID4gMCkge1xuICAgICAgICBtb2RlbC5kYXRlcy52YWxpZCA9IGRhdGEudmFsaWREYXRlO1xuICAgIH1cblxuICAgIGlmIChhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSBcIlwiKSB7XG4gICAgICAgIG1vZGVsLmNoYW5uZWxzLnB1c2goXCJwcm9maWxlX1wiICsgYXBwLlNDT1BFLnByb2ZpbGVJZCArIFwiX3N1YnByb2ZpbGVfXCIgKyBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQpO1xuICAgICAgICBtb2RlbC5jaGFubmVscy5wdXNoKFwic3VicHJvZmlsZV9cIiArIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbW9kZWwuY2hhbm5lbHMucHVzaChcInByb2ZpbGVfXCIgKyBhcHAuU0NPUEUucHJvZmlsZUlkICsgXCJfc3VicHJvZmlsZV9cIiArIDApO1xuICAgICAgICBtb2RlbC5jaGFubmVscy5wdXNoKFwic3VicHJvZmlsZV9cIiArIDApO1xuICAgIH1cblxuICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5wdXNoKG1vZGVsKTtcbiAgICAvLyBSZXR1cm4gYSBwcm9taXNlXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAvLyBDYXRjaCBhbGwgdW5jYXVnaHQgZXJyb3JzXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyAxLiBQcm9jZXNzIHRoZSBwcmUtYWN0aW9uc1xuICAgICAgICAgICAgdmFyIHByZUFjdGlvbnNDb25mID0gcHJvY2Vzc0NvbmYucHJlQWN0aW9ucztcbiAgICAgICAgICAgIC8vYWN0aW9uKGFjdGlvbnNbY291bnRlcl0sIHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdWJQcm9jZXNzLCBzdGVwLCBfV0ZJbnN0YW5jZSwgZGF0YSwgdXVpZClcbiAgICAgICAgICAgIHByZUFjdGlvbnMocHJlQWN0aW9uc0NvbmYsIF9XRkluc3RhbmNlLCBzdWJQcm9jZXNzT2JqZWN0SWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy8gMi4gUHJvY2VzcyB0aGUgcHJlLXJlcXVpc2l0ZXNcbiAgICAgICAgICAgICAgICB2YXIgcHJlcmVxdWlzaXRlQ29uZiA9IHByb2Nlc3NDb25mLnByZXJlcXVpc2l0ZXM7XG4gICAgICAgICAgICAgICAgcHJlUmVxdWlzaXRlcyhwcmVyZXF1aXNpdGVDb25mLCBfV0ZJbnN0YW5jZSwgc3ViUHJvY2Vzc09iamVjdElkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAvLyAzLiBJbml0aWF0ZSB0aGUgc3ViUHJvY2Vzc1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5pdGlhdGVDb25mID0gc3ViUHJvY2Vzc0NvbmYuaW5pdGlhdGU7XG4gICAgICAgICAgICAgICAgICAgIGluaXRpYXRlKGluaXRpYXRlQ29uZiwgc3ViUHJvY2VzcywgZGF0YSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vVXBkYXRlIHRoZSBzdWJQcm9jZXNzIG1vZGVsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5pbml0aWF0ZWQgPSByZXN1bHQuZGF0YS5pbml0aWF0ZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5kYXRlcyA9IHJlc3VsdC5kYXRhLmRhdGVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRXhlY3V0ZSB0aGUgZmlyc3Qgc3RlcFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBJZCA9IHN1YlByb2Nlc3NDb25mLnN0ZXBzWzBdLl9pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc2l0aW9uSWQgPSBzdWJQcm9jZXNzQ29uZi5zdGVwc1swXS50cmFuc2l0aW9uWzBdLl9pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwU2VxID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXAocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwgc3RlcFNlcSwgZGF0YSwgX1dGSW5zdGFuY2UsIHN1YlByb2Nlc3NPYmplY3RJZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5zdGVwID0gcmVzdWx0LmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGljYXRvcnMoc3ViUHJvY2Vzc0NvbmYuaW5kaWNhdG9ycywgX1dGSW5zdGFuY2UsIG1vZGVsLl9pZCkudGhlbihmdW5jdGlvbihyZXN1bHQxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5pbmRpY2F0b3JzID0gcmVzdWx0MS5kYXRhO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBFeGVjdXRlIHRoZSB0cmFuc2l0aW9ucywgaWYgYXV0b1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TdWJwcm9jZXNzIHBvc3RBY3Rpb25zIHJlbW92ZWQgZnJvbSBoZXJlIGFzIHRoZXkgc2hvdWxkIGJlIGV4ZWN1dGVkIGF0IHRoZSBlbmQgb2YgdGhlIHN1YlByb2Nlc3MsIG1lYW5zIGF0IGxhc3Qgc3RlcCBhZnRlciB0cmFuc2l0aW9uLCBqdXN0IGJlZm9yZSBmaW5pc2guXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDYW4gYWRkIGhpc3Rvcnkgb2JqZWN0IGhlcmUgaW4gY2FzZSBmb3IgZmlyc3Qgc3RlcCwgaS5lIGluaXRpYWxpc2F0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtb2RlbC5oaXN0b3J5LnB1c2gocmVzdWx0LmRhdGEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcyhyZXN1bHQxLm1lc3NhZ2UsIG1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMgPSBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhKG9iai5faWQgPT0gc3ViUHJvY2Vzc09iamVjdElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3NlcyA9IF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIShvYmouX2lkID09IHN1YlByb2Nlc3NPYmplY3RJZCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzID0gX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICEob2JqLl9pZCA9PSBzdWJQcm9jZXNzT2JqZWN0SWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgaW5pdGlhdGVcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gaW5pdGlhdGUgLSB0aGUgaW5pdGlhdGUgY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gdGhlIHVzZXIgaW5wdXQgZGF0YVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gaW5pdGlhdGUoaW5pdGlhdGUsIHN1YlByb2Nlc3MsIGRhdGEpIHtcbiAgICB2YXIgY29tcGxldGVkID0gW107XG4gICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgICAgaW5pdGlhdGVkOiBmYWxzZSxcbiAgICAgICAgZGF0ZXM6IHtcbiAgICAgICAgICAgIGNyZWF0ZWQ6ICcnLFxuICAgICAgICAgICAgdmFsaWQ6ICcnLFxuICAgICAgICAgICAgc3RhcnQ6ICcnLFxuICAgICAgICAgICAgZHVlOiAnJyxcbiAgICAgICAgICAgIGNsb3NlZDogJydcbiAgICAgICAgfVxuXG4gICAgfTtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgaWYgKGluaXRpYXRlLnVzZXIgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LmRhdGVzLmNyZWF0ZWQgPSBkYXRhLmNyZWF0ZWREYXRlO1xuICAgICAgICAgICAgICAgIGlmIChpbml0aWF0ZS51c2VyLnZhbGlkRGF0ZS5fdHlwZSA9PSAndXNlclNlbGVjdGVkJyB8fCBpbml0aWF0ZS51c2VyLnZhbGlkRGF0ZS5fdHlwZSA9PSAnYXV0b1NlbGVjdGVkJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS52YWxpZERhdGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuZGF0ZXMudmFsaWQgPSBkYXRhLnZhbGlkRGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRlcy52YWxpZCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zdWJzdHJpbmcoMCwgMTApO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5pdGlhdGUudXNlci5kdWVEYXRlLl90eXBlID09ICd1c2VyU2VsZWN0ZWQnIHx8IGluaXRpYXRlLnVzZXIuZHVlRGF0ZS5fdHlwZSA9PSAnYXV0b1NlbGVjdGVkJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5kdWVEYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRlcy5kdWUgPSBkYXRhLmR1ZURhdGU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRlcy5zdGFydCA9IGRhdGEuZmlyc3REYXRlO1xuXG5cblxuICAgICAgICAgICAgICAgIHJlc3VsdC5pbml0aWF0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdWItUHJvY2VzcyBpbml0aWF0ZSBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgfSBlbHNlIGlmIChpbml0aWF0ZS5hdXRvICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICByZXN1bHQuZGF0ZXMuY3JlYXRlZCA9IGRhdGEuY3JlYXRlZERhdGU7XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5pdGlhdGUuZGF0ZXMudmFsaWQuX3R5cGUgPT0gJ3VzZXJTZWxlY3RlZCcgfHwgaW5pdGlhdGUuZGF0ZXMudmFsaWQuX3R5cGUgPT0gJ2F1dG9TZWxlY3RlZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEudmFsaWREYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRlcy52YWxpZCA9IGRhdGEudmFsaWREYXRlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXRpbC53YXJuKCdXRkluaXRpYXRlRXJyb3InLCAnTm8gdmFsaWQgZGF0ZSBwYXNzZWQgaW4gLSB7ZGF0YS52YWxpZERhdGV9Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpbml0aWF0ZS5kYXRlcy5kdWUuX3R5cGUgPT0gJ3VzZXJTZWxlY3RlZCcgfHwgaW5pdGlhdGUuZGF0ZXMuZHVlLl90eXBlID09ICdhdXRvU2VsZWN0ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmR1ZURhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmRhdGVzLmR1ZSA9IGRhdGEuZHVlRGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHV0aWwud2FybignV0ZJbml0aWF0ZUVycm9yJywgJ05vIGR1ZSBkYXRlIHBhc3NlZCBpbiAtIHtkYXRhLmR1ZURhdGV9Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJlc3VsdC5pbml0aWF0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdWItUHJvY2VzcyBpbml0aWF0ZSBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTsqL1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgdmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZJbml0aWF0ZUVycm9yJywgJ0luaXRpYXRlIHR5cGU6ICcgKyBpbml0aWF0ZS5fdHlwZSArICcgbm90IGRlZmluZWQuJyk7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc3ViUHJvY2Vzcy5jb21wbGV0ZSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGluaXQoKTtcbiAgICAgICAgfSBlbHNlIGlmICghc3ViUHJvY2Vzcy5jb21wbGV0ZSkge1xuICAgICAgICAgICAgaWYgKGluaXRpYXRlLnBhcmFsbGVsSW5zdGFuY2VzKSB7XG4gICAgICAgICAgICAgICAgaW5pdCgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRkluaXRpYXRlRXJyb3InLCAnU3ViLXByb2Nlc3M6ICcgKyBzdWJQcm9jZXNzLmlkICsgJyBzdGlsbCBhY3RpdmUgYW5kIHBhcmFsbGVsIGluc3RhbmNlcyBhcmUgbm90IGFsbG93ZWQuJyk7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogUHJvY2VzcyBzdGVwXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBjdXJyZW50IHByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdWJQcm9jZXNzSWQgLSB0aGUgY3VycmVudCBzdWItcHJvY2VzcyBpZFxuICogQHBhcmFtIHtzdHJpbmd9IHN0ZXBJZCAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIHN0ZXAgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdGVwU2VxIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3Mgc3RlcCBpbnN0YW5jZSBjb3VudGVyIC8gc2VxdWVuY2VcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gdGhlIHVzZXIgaW5wdXQgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgX1dGSW5zdGFuY2UgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIHN0ZXAocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwgc3RlcFNlcSwgZGF0YSwgX1dGSW5zdGFuY2UsIHNwdXVpZCkge1xuXG4gICAgLy8gRGVmYXVsdCBzdGVwIG1vZGVsXG4gICAgdmFyIG1vZGVsID0ge1xuICAgICAgICBrZXk6IGdlbmVyYXRlVVVJRCgpLFxuICAgICAgICBpZDogJycsXG4gICAgICAgIHNlcTogJycsXG4gICAgICAgIHN0YXR1czogJycsXG4gICAgICAgIG1lc3NhZ2U6ICcnLFxuICAgICAgICBhc3NpZ25lZFRvOiB7XG4gICAgICAgICAgICB1c2VySWQ6ICcnLFxuICAgICAgICAgICAgbmFtZTogJycsXG4gICAgICAgICAgICBkYXRlVGltZTogJycsXG4gICAgICAgICAgICB0eXBlOiAnJyxcbiAgICAgICAgICAgIGR1ZURhdGVUaW1lOiAnJyxcbiAgICAgICAgICAgIGJ5OiAnJ1xuICAgICAgICB9LFxuICAgICAgICBhc3NpZ25tZW50SGlzdG9yeTogW10sXG4gICAgICAgIGRhdGVUaW1lQ3JlYXRlZDogbW9tZW50KCkuZm9ybWF0KCksXG4gICAgICAgIGR1ZURhdGVUaW1lOiBtb21lbnQoKS5mb3JtYXQoKSxcbiAgICAgICAgdHJhbnNpdGlvbjoge1xuICAgICAgICAgICAgdHJhbnNpdGlvbklkOiAnJyxcbiAgICAgICAgICAgIGRhdGVUaW1lOiAnJyxcbiAgICAgICAgICAgIHVzZXJJZDogJydcbiAgICAgICAgfSxcbiAgICAgICAgYXNzaWdubWVudDoge30sXG4gICAgICAgIGNvbW1lbnQ6ICcnXG4gICAgfTtcblxuICAgIHZhciBzdWJQcm9jZXNzID0ge307XG5cbiAgICB2YXIgdXVpZCA9ICcnO1xuICAgIHZhciBpbnN0U3ViUHJvY2VzcztcbiAgICB2YXIgc3RlcCA9IHt9O1xuXG4gICAgdmFyIHRyYW5zaXRpb25JZCA9ICcnO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vR2V0IHRoZSBjdXJyZW50IHN1YlByb2Nlc3MgaW5zdGFuY2UgZGF0YVxuXG4gICAgICAgICAgICAvLyBfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialByb2Nlc3MpIHtcbiAgICAgICAgICAgIC8vICAgICBpZiAob2JqUHJvY2Vzcy5pZCA9PSBwcm9jZXNzSWQgJiYgb2JqUHJvY2Vzcy5zZXEgPT0gcHJvY2Vzc1NlcSkge1xuICAgICAgICAgICAgLy8gICAgICAgICBvYmpQcm9jZXNzLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqU3ViUHJvY2Vzcykge1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgaWYgKG9ialN1YlByb2Nlc3MuaWQgPT0gc3ViUHJvY2Vzc0lkICYmIG9ialN1YlByb2Nlc3Muc2VxID09IHN1YlByb2Nlc3NTZXEpIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICB1dWlkID0gb2JqU3ViUHJvY2Vzcy51dWlkO1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gICAgICAgICB9KVxuICAgICAgICAgICAgLy8gICAgIH1cbiAgICAgICAgICAgIC8vIH0pO1xuXG4gICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NJdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN1YlByb2Nlc3NJdGVtLl9pZCA9PSBhcHAuU0NPUEUucHJvY2Vzc1VVSUQpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5zdFN1YlByb2Nlc3MgPSBzdWJQcm9jZXNzSXRlbTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBfV0ZJbnN0YW5jZS5jb25maWcucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpQcm9jZXNzKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9ialByb2Nlc3MuX2lkID09IHByb2Nlc3NJZCkge1xuICAgICAgICAgICAgICAgICAgICBvYmpQcm9jZXNzLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqU3ViUHJvY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9ialN1YlByb2Nlc3MuX2lkID09IHN1YlByb2Nlc3NJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3MgPSBvYmpTdWJQcm9jZXNzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ialN1YlByb2Nlc3Muc3RlcHMuZmlsdGVyKGZ1bmN0aW9uKG9ialN0ZXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9ialN0ZXAuX2lkID09IHN0ZXBJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCA9IG9ialN0ZXA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBzdWItcHJvY2VzcyBzdGVwIGRhdGFcbiAgICAgICAgICAgIG1vZGVsLmlkID0gc3RlcElkO1xuICAgICAgICAgICAgbW9kZWwuc2VxID0gc3RlcFNlcTtcblxuICAgICAgICAgICAgdmFyIGluc3RhbmNlU3RhdHVzID0gJyc7XG4gICAgICAgICAgICBpZiAoc3RlcC5zZXRJbnN0YW5jZVN0YXR1c1RvLk5vdFN0YXJ0ZWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VTdGF0dXMgPSBcIk5vdFN0YXJ0ZWRcIjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RlcC5zZXRJbnN0YW5jZVN0YXR1c1RvLkNyZWF0ZWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VTdGF0dXMgPSBcIkNyZWF0ZWRcIjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RlcC5zZXRJbnN0YW5jZVN0YXR1c1RvLkluUHJvZ3Jlc3MgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VTdGF0dXMgPSBcIkluUHJvZ3Jlc3NcIjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RlcC5zZXRJbnN0YW5jZVN0YXR1c1RvLlN1Ym1pdHRlZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZVN0YXR1cyA9IFwiU3VibWl0dGVkXCI7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0ZXAuc2V0SW5zdGFuY2VTdGF0dXNUby5Db21wbGV0ZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZVN0YXR1cyA9IFwiQ29tcGxldGVcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGxhbmd1YWdlID0gc2VydmljZS5nZXRMYW5ndWFnZSgpO1xuXG4gICAgICAgICAgICBtb2RlbC5zdGF0dXMgPSBpbnN0YW5jZVN0YXR1cztcbiAgICAgICAgICAgIG1vZGVsLm1lc3NhZ2UgPSBzdGVwLnNldEluc3RhbmNlU3RhdHVzVG9baW5zdGFuY2VTdGF0dXNdLmxhYmVsLmkxOG5bbGFuZ3VhZ2VdO1xuICAgICAgICAgICAgbW9kZWwuY29tbWVudCA9IGRhdGEuY29tbWVudCAhPT0gdW5kZWZpbmVkID8gZGF0YS5jb21tZW50IDogJyc7XG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9ycyA9IGluc3RTdWJQcm9jZXNzICE9PSB1bmRlZmluZWQgPyBpbnN0U3ViUHJvY2Vzcy5pbmRpY2F0b3JzIDogW107XG5cbiAgICAgICAgICAgIHZhciB1cGRhdGVTUEluZGljYXRvck9iamVjdCA9IGZ1bmN0aW9uKGluZGljYXRvcnMsIF9XRkluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgICAgICAgICBpZiAoaW5kaWNhdG9ycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5kaWNhdG9ycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvck9iamVjdCA9IGluZGljYXRvcnNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXVpZCA9IGluZGljYXRvck9iamVjdC5pbnN0YW5jZXNbMF0udXVpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3IgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3JPYmplY3QuaW5zdGFuY2VzWzBdLnNlcSA9IGluZGljYXRvci5tb2RlbC5wZW5kaW5nLnNlcTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpbmRpY2F0b3Iud29ya2Zsb3dzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGljYXRvci53b3JrZmxvd3Nbal0ucHJvY2Vzc2VzWzBdICE9IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3Iud29ya2Zsb3dzW2pdLnByb2Nlc3Nlc1swXS5zdWJQcm9jZXNzVVVJRCAhPSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yLndvcmtmbG93c1tqXS5wcm9jZXNzZXNbMF0uc3RlcCAhPSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3B1dWlkID09IGluZGljYXRvci53b3JrZmxvd3Nbal0ucHJvY2Vzc2VzWzBdLnN1YlByb2Nlc3NVVUlEKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGljYXRvci53b3JrZmxvd3Nbal0ucHJvY2Vzc2VzWzBdLnN0ZXAuYXNzaWduZWRUbyA9IGFzc2lnbmVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBjbGVhclNQU3RhdHVzID0gZnVuY3Rpb24oc3B1dWlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICBvYmouc3BTdGF0dXMgPSBcIlwiO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaW5kaWNhdG9yRG9jcyhwcm9jZXNzSWQsIGluZGljYXRvcnMsIG1vZGVsLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHV1aWQgPSBzcHV1aWQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RlcC5mdW5jdGlvbi5hY3Rpb25zICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25zKHN0ZXAuZnVuY3Rpb24uYWN0aW9ucywgcHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN1YlByb2Nlc3MsIG1vZGVsLCBfV0ZJbnN0YW5jZSwgZGF0YSwgc3B1dWlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLm5hbWUgPSBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmZpcnN0TmFtZSArIFwiIFwiICsgTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5sYXN0TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS51c2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS50eXBlID0gQVNTSUdOTUVOVF9UWVBFX0FVVE87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuZHVlRGF0ZVRpbWUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5ieSA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVTUEluZGljYXRvck9iamVjdChpbmRpY2F0b3JzLCBfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zaXRpb25JZCA9IHN0ZXAudHJhbnNpdGlvblswXS5faWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCB0cmFuc2l0aW9uSWQsIGRhdGEsIF9XRkluc3RhbmNlLCBzcHV1aWQsIG1vZGVsKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnVHJhbnNpdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdC5kYXRhLnN0ZXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGVwLmZ1bmN0aW9uLnRhc2sgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIE1ha2UgYXNzaWdubWVudHNcbiAgICAgICAgICAgICAgICAgICAgdGFzayhwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN0ZXAuZnVuY3Rpb24udGFzaywgc3B1dWlkLCBtb2RlbCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlU1BJbmRpY2F0b3JPYmplY3QoaW5kaWNhdG9ycywgX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1Rhc2sgYXdhaXRpbmcgdXNlciBhY3Rpb24uJywgbW9kZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0ZXAuZnVuY3Rpb24uc2VydmVyICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBNYWtlIGFzc2lnbm1lbnRzXG4gICAgICAgICAgICAgICAgICAgIGNsZWFyU1BTdGF0dXMoc3B1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgc2VydmVyKHN0ZXAuZnVuY3Rpb24uc2VydmVyLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2VzcywgbW9kZWwsIF9XRkluc3RhbmNlLCBkYXRhLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVNQSW5kaWNhdG9yT2JqZWN0KGluZGljYXRvcnMsIF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTZXJ2ZXIgYXdhaXRpbmcgc2VydmVyIHJlc3BvbnNlLicsIG1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgaW5kaWNhdG9yIHVwZGF0ZXNcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gYWN0aW9ucyAtIHRoZSBhY3Rpb25zIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gc3ViUHJvY2VzcyAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIGZvcm0gY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBpbmRpY2F0b3JzKGluZGljYXRvcnMsIF9XRkluc3RhbmNlLCBzcHV1aWQpIHtcbiAgICB2YXIgbW9kZWwgPSBbXTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgYXJyYXkgPSBKU09OLnhwYXRoKFwiaW5kaWNhdG9yc1tmbjpjb3VudCguL3dvcmtmbG93cy9wcm9jZXNzZXNbc3ViUHJvY2Vzc1VVSUQgZXEgJ1wiICsgc3B1dWlkICsgXCInXSkgZ3QgMF1cIiwgX1dGSW5zdGFuY2UsIHt9KTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBhcnJheS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3IgPSBhcnJheVtqXTtcbiAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yTW9kZWwgPSB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VzOiBbXVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZU1vZGVsID0ge1xuICAgICAgICAgICAgICAgICAgICB1dWlkOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICcnLFxuICAgICAgICAgICAgICAgICAgICBrZXk6ICcnLFxuICAgICAgICAgICAgICAgICAgICBzZXE6IDEsXG4gICAgICAgICAgICAgICAgICAgIHJldjogJydcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpbmRpY2F0b3JNb2RlbC5pZCA9IGluZGljYXRvci5jYXRlZ29yeS50ZXJtO1xuICAgICAgICAgICAgICAgIGluc3RhbmNlTW9kZWwudXVpZCA9IGluZGljYXRvci5faWQ7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VNb2RlbC5yZXYgPSBpbmRpY2F0b3IuX3JldjtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZU1vZGVsLnRpdGxlID0gaW5kaWNhdG9yLnRpdGxlO1xuICAgICAgICAgICAgICAgIGluc3RhbmNlTW9kZWwua2V5ID0gJyc7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VNb2RlbC5zZXEgPSBpbmRpY2F0b3IubW9kZWwucGVuZGluZy5zZXE7IC8vIGluZGljYXRvciBzZXEgbnVtYmVyIGhlcmUgd2hpY2ggaXMgZ2V0dGluZyB1cGRhdGVkLlxuICAgICAgICAgICAgICAgIGluZGljYXRvck1vZGVsLmluc3RhbmNlcy5wdXNoKGluc3RhbmNlTW9kZWwpO1xuICAgICAgICAgICAgICAgIG1vZGVsLnB1c2goaW5kaWNhdG9yTW9kZWwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUHJvY2VzcyBpbmRpY2F0b3IgbW9kZWwgdXBkYXRlZC4nLCBtb2RlbCk7XG4gICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KVxufTtcblxuLyoqXG4gKiBQcm9jZXNzIGFzc2lnbiB1c2VyXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBwcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3ViUHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3ViLXByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdWJQcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHN1Yi1wcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN0ZXBJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN0ZXAgaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0cmFuc2l0aW9uSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiB0cmFuc2l0aW9uIGlkXG4gKiBAcGFyYW0ge29iamVjdH0gdXNlciAtIHRoZSB1c2VyIHRvIGFzc2lnbiB0b1xuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIGFzc2lnblVzZXIocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHVzZXIsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuXG4gICAgICAgICAgICAvLyBHZXQgdGhlIGN1cnJlbnQgc3ViUHJvY2VzcyBpbnN0YW5jZSBkYXRhXG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uIChvYmpQcm9jZXNzKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9ialByb2Nlc3MuaWQgPT0gcHJvY2Vzc0lkICYmIG9ialByb2Nlc3Muc2VxID09IHByb2Nlc3NTZXEpIHtcbiAgICAgICAgICAgICAgICAgICAgb2JqUHJvY2Vzcy5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uIChvYmpTdWJQcm9jZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqU3ViUHJvY2Vzcy5pZCA9PSBzdWJQcm9jZXNzSWQgJiYgb2JqU3ViUHJvY2Vzcy5zZXEgPT0gc3ViUHJvY2Vzc1NlcSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV1aWQgPSBvYmpTdWJQcm9jZXNzLnV1aWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihzdWJQcm9jZXNzSXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzSXRlbS5faWQgPT0gdXVpZCkge1xuICAgICAgICAgICAgICAgICAgICAvL0FkZGVkIHRvIGhzdG9yeVxuICAgICAgICAgICAgICAgICAgICBpZiAoc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25tZW50SGlzdG9yeSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NJdGVtLnN0ZXAuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLnVzZXJJZCAhPSBcIlwiICYmIHN1YlByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUby5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NJdGVtLnN0ZXAuYXNzaWdubWVudEhpc3RvcnkucHVzaChKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHN1YlByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUbykpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSB1c2VyIGRldGFpbHNcbiAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLnVzZXJJZCA9IHVzZXIuaWQ7XG4gICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUby5uYW1lID0gdXNlci5uYW1lO1xuICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8uZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLnR5cGUgPSBBU1NJR05NRU5UX1RZUEVfUkVBU1NJR05NRU5UO1xuICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8uZHVlRGF0ZVRpbWUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLmJ5ID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQgKyBcIlwiO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgaW5kaWNhdG9ycyB1c2VyIGRldGFpbHNcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvcnMgPSBzdWJQcm9jZXNzSXRlbS5pbmRpY2F0b3JzO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluZGljYXRvcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3IgPSBpbmRpY2F0b3JzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpbmRpY2F0b3IuaW5zdGFuY2VzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gaW5kaWNhdG9yLmluc3RhbmNlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IF9XRkluc3RhbmNlLmluZGljYXRvcnMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRvYyA9IF9XRkluc3RhbmNlLmluZGljYXRvcnNba107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS51dWlkID09IGRvYy5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvYy53b3JrZmxvd3MuZmlsdGVyKGZ1bmN0aW9uKHdvcmtmbG93KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2Zsb3cucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihwcm9jZXNzSXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2Vzc0l0ZW0uaWQgPT0gcHJvY2Vzc0lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHVzZXIgaWQgYW5kIG5hbWUgaW4gdGhlIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8udXNlcklkID0gdXNlci5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUby5uYW1lID0gdXNlci5uYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vU2VuZCBhc3NpZ24gdXNlciBub3RpZmljYXRpb24gZnJvbSBoZXJlXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddL25vdGlmaWNhdGlvbnNcIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbiAhPSB1bmRlZmluZWQgJiYgbm90aWZpY2F0aW9uLnJlQXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24ucmVBc3NpZ25tZW50Tm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnVXNlciBhc3NpZ25lZCBzdWNjZXNzZnVsbHkuIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJywgc3ViUHJvY2Vzc0l0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShmYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInLCBzdWJQcm9jZXNzSXRlbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuXG5cblxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogUHJvY2VzcyBpbmRpY2F0b3IgZG9jdW1lbnQgdXBkYXRlc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBhY3Rpb25zIC0gdGhlIGFjdGlvbnMgY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBzdWJQcm9jZXNzIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3MgZm9ybSBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIGluZGljYXRvckRvY3MocHJvY2Vzc0lkLCBpbmRpY2F0b3JzLCBzdGVwLCBfV0ZJbnN0YW5jZSwgY3VycmVudFNQVVVJRCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgaW5kaWNhdG9yIHNlY3Rpb25zIG9mIHRoZSBzdWJQcm9jZXNzXG4gICAgICAgICAgICBpZiAoaW5kaWNhdG9ycyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRkluZGljYXRvcnNVcGRhdGUnLCAnSW5kaWNhdG9ycyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQuIC0gVmFsdWU6ICcgKyBpbmRpY2F0b3JzKVxuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluZGljYXRvcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvciA9IGluZGljYXRvcnNbaV07XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaW5kaWNhdG9yLmluc3RhbmNlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gaW5kaWNhdG9yLmluc3RhbmNlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkb2MgPSBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzW2tdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS51dWlkID09IGRvYy5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jLndvcmtmbG93cy5maWx0ZXIoZnVuY3Rpb24od29ya2Zsb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtmbG93LnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ocHJvY2Vzc0l0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2Vzc0l0ZW0uc3ViUHJvY2Vzc1VVSUQgPT0gY3VycmVudFNQVVVJRCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzSXRlbS5zdGVwLmlkID0gc3RlcC5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3RlcC5zZXEgPSBzdGVwLnNlcTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3RlcC5zdGF0dXMgPSBzdGVwLnN0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3RlcC5tZXNzYWdlID0gc3RlcC5tZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8udXNlcklkID0gc3RlcC5hc3NpZ25lZFRvLnVzZXJJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLm5hbWUgPSBzdGVwLmFzc2lnbmVkVG8ubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3RlcC5jb21tZW50ID0gc3RlcC5jb21tZW50ICE9PSB1bmRlZmluZWQgPyBzdGVwLmNvbW1lbnQgOiAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0luZGljYXRvciBkb2N1bWVudHMgd29ya2Zsb3cgcHJvY2VzcyBtb2RlbCB1cGRhdGVkLicsIF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pXG59O1xuXG4vKipcbiAqIFByb2Nlc3MgYWN0aW9uc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBhY3Rpb25zIC0gdGhlIGFjdGlvbnMgY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBzdWJQcm9jZXNzIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3MgZm9ybSBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cblxuZnVuY3Rpb24gYWN0aW9ucyhhY3Rpb25zLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2Vzcywgc3RlcCwgX1dGSW5zdGFuY2UsIGRhdGEsIHV1aWQpIHtcbiAgICB2YXIgYXJyQWN0aW9ucyA9IFtdO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdXRpbC5zeW5jTG9vcChhY3Rpb25zLmxlbmd0aCwgZnVuY3Rpb24obG9vcCkge1xuICAgICAgICAgICAgdmFyIGNvdW50ZXIgPSBsb29wLml0ZXJhdGlvbigpO1xuICAgICAgICAgICAgYWN0aW9uKGFjdGlvbnNbY291bnRlcl0sIHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdWJQcm9jZXNzLCBzdGVwLCBfV0ZJbnN0YW5jZSwgZGF0YSwgdXVpZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJldEFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBhY3Rpb25zW2NvdW50ZXJdLl9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcTogY291bnRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHJlc3VsdFxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIGFyckFjdGlvbnMucHVzaChyZXRBY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICBsb29wLm5leHQoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9vcC5icmVhaygpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnQWN0aW9ucyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIGFyckFjdGlvbnMpO1xuICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgYWN0aW9uXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IGFjdGlvbiAtIHRoZSBhY3Rpb24gY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBzdWJQcm9jZXNzIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3MgZm9ybSBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIGFjdGlvbihhY3Rpb24sIHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdWJQcm9jZXNzLCBzdGVwLCBfV0ZJbnN0YW5jZSwgZGF0YSwgdXVpZCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICBpZiAoYWN0aW9uLm1ldGhvZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBtZXRob2RQb3NzaWJsZUl0ZW1zID0gW1wiZm9ybVwiLCBcImluZGljYXRvclwiLCBcInByb2ZpbGVcIiwgXCJzdWJQcm9jZXNzSW5zdGFuY2VcIiwgXCJzdGVwXCIsIFwiY29tbXVuaXR5XCIsIFwiYXBwbGljYXRpb25cIiwgXCJ1c2VyXCIsIFwic2RvXCIsIFwicGVyZm9ybWFuY2VcIiwgXCJ0YXhvbm9teVwiLCBcInZhcmlhYmxlc1wiLCBcIm5vdGlmaWNhdGlvblwiLCBcInJlcG9ydFwiLCBcIndvcmtlclwiLCBcInBhcnRpY2lwYW50c1wiLCBcImdlbmVyYWxGdW5jdGlvbnNcIl07XG4gICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2QsIG1ldGhvZFBvc3NpYmxlSXRlbXMpKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnZm9ybSc6XG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpb24ubWV0aG9kLmZvcm0uY3JlYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHByb2Nlc3NJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3RlcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwcm9jZXNzU2VxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChzdWJQcm9jZXNzU2VxKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmNyZWF0ZVR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEuYmFzZVVVSUQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtLmNyZWF0ZShhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5tZXRob2QuZm9ybS5hdXRob3Jpc2UgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc0lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChzdWJQcm9jZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwcm9jZXNzU2VxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChzdWJQcm9jZXNzU2VxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5jcmVhdGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmJhc2VVVUlEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uYXV0aG9yaXNlKGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5mb3JtLnVuZHJhZnQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmNyZWF0ZVR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEuYmFzZVVVSUQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5zZXRVbkRyYWZ0KGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5mb3JtLmRyYWZ0ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5jcmVhdGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmJhc2VVVUlEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uc2V0RHJhZnQoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24ubWV0aG9kLmZvcm0uY2xvc2UgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzcy5pbmRpY2F0b3JzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5jcmVhdGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmJhc2VVVUlEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uY2xvc2UoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24ubWV0aG9kLmZvcm0uYXV0aG9yaXNlQW5kQ3JlYXRlTmV3U2VxICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHByb2Nlc3NJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc1NlcSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzc1NlcSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEuY3JlYXRlVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2godXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5iYXNlVVVJRCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtLmF1dGhvcmlzZShhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIG5ldyBzZXF1ZW5jZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc0lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN0ZXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwcm9jZXNzU2VxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzc1NlcSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmNyZWF0ZVR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2godXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5jcmVhdGUoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vRWQgY3JlYXRpb24gb2YgbmV3IHNlcXVlbmNlXG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5mb3JtLmNyZWF0ZU5ld1NlcSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwcm9jZXNzSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN1YlByb2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN0ZXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc1NlcSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzc1NlcSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5jcmVhdGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5jcmVhdGUoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2luZGljYXRvcic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpb24ubWV0aG9kLmluZGljYXRvci5jcmVhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJOb3QgaW1wbGVtZW50ZWRcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24ubWV0aG9kLmluZGljYXRvci5pbnN0YW50aWF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShcIk5vdCBpbXBsZW1lbnRlZFwiKTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5tZXRob2QuaW5kaWNhdG9yLnNldFZhbHVlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IGFjdGlvbi5tZXRob2QuaW5kaWNhdG9yLnNldFZhbHVlLnBhdGg7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUoYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3Iuc2V0VmFsdWUuZGF0YSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YVZhbHVlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YVZhbHVlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0udXBkYXRlSW5kaWNhdG9yKGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3IudXBkYXRlU3RhdHVzICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0SWQgPSBhY3Rpb24ubWV0aG9kLmluZGljYXRvci5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3IudXBkYXRlU3RhdHVzICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSBhY3Rpb24ubWV0aG9kLmluZGljYXRvci51cGRhdGVTdGF0dXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGluZGljYXRvclNldElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBLZWVwIGluZGljYXRvciBmdW5jdGlvbnMgaW4gaW5kaWF0b3IgZmlsZSBpc3RlYWQgb2YgZm9ybSBmaWxlLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0ubWFya1VwZGF0ZUluZGljYXRvcihhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShcIkFjdGlvbiBpbmRpY2F0b3Igc3ViIHR5cGUgbm90IGZvdW5kLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5tZXRob2QuaW5kaWNhdG9yLnNldFdyYXBwZXJFbGVtZW50ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IGFjdGlvbi5tZXRob2QuaW5kaWNhdG9yLnNldFdyYXBwZXJFbGVtZW50LnBhdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0SWQgPSBhY3Rpb24ubWV0aG9kLmluZGljYXRvci5zZXRXcmFwcGVyRWxlbWVudC5pbmRpY2F0b3JTZXRJZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShhY3Rpb24ubWV0aG9kLmluZGljYXRvci5zZXRXcmFwcGVyRWxlbWVudC5kYXRhLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihkYXRhVmFsdWUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2godXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChpbmRpY2F0b3JTZXRJZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtLnVwZGF0ZUluZGljYXRvcldyYXBwZXIoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3Byb2ZpbGUnOlxuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uLm1ldGhvZC5wcm9maWxlLmNyZWF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwcm9jZXNzSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmNyZWF0ZVR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEuYmFzZVVVSUQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5jcmVhdGVQcm9maWxlKGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5wcm9maWxlLnNldFN0YXR1c1RvICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXR1cyA9IGFjdGlvbi5tZXRob2QucHJvZmlsZS5zZXRTdGF0dXNUbztcblxuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChzdGF0dXMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtLnNldFN0YXR1cyhhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnc3ViUHJvY2Vzc0luc3RhbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNwUG9zc2libGVJdGVtcyA9IFtcImluc3RhbnRpYXRlXCIsIFwiYXV0aG9yaXNlXCIsIFwiY2xvc2VcIiwgXCJzZXRWYXJpYWJsZVwiLCBcInNldFN0YXR1c1RvXCIsIFwic2V0U3RhdHVzTXNnVG9cIiwgXCJzZXRUaXRsZVwiLCBcInNldFZhbGlkRGF0ZVwiLCBcInNldFNQU3RhdHVzXCJdO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2Quc3ViUHJvY2Vzc0luc3RhbmNlLCBzcFBvc3NpYmxlSXRlbXMpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NldFRpdGxlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGFjdGlvbi5tZXRob2Quc3ViUHJvY2Vzc0luc3RhbmNlLnNldFRpdGxlLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihkYXRhVmFsdWUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLnN1YlByb2Nlc3NJbnN0YW5jZS5zZXRUaXRsZShhY3Rpb24ubWV0aG9kLnN1YlByb2Nlc3NJbnN0YW5jZS5zZXRUaXRsZSwgdXVpZCwgZGF0YVZhbHVlLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdXBkYXRlIHN1YnByb2Nlc3MgbGFiZWwgaW4gd29ya2Zsb3cgaW5zdGFuY2UgcHJvY2VzcyBvYmplY3Q6IFRPRE9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2V0VmFsaWREYXRlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGFjdGlvbi5tZXRob2Quc3ViUHJvY2Vzc0luc3RhbmNlLnNldFZhbGlkRGF0ZSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUuc3ViUHJvY2Vzc0luc3RhbmNlLnNldFZhbGlkRGF0ZShhY3Rpb24ubWV0aG9kLnN1YlByb2Nlc3NJbnN0YW5jZS5zZXRWYWxpZERhdGUsIHV1aWQsIGRhdGFWYWx1ZSwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy91cGRhdGUgc3VicHJvY2VzcyBsYWJlbCBpbiB3b3JrZmxvdyBpbnN0YW5jZSBwcm9jZXNzIG9iamVjdDogVE9ET1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NldFNQU3RhdHVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGFjdGlvbi5tZXRob2Quc3ViUHJvY2Vzc0luc3RhbmNlLnNldFNQU3RhdHVzLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihkYXRhVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5zdWJQcm9jZXNzSW5zdGFuY2Uuc2V0U1BTdGF0dXMoYWN0aW9uLm1ldGhvZC5zdWJQcm9jZXNzSW5zdGFuY2Uuc2V0U1BTdGF0dXMsIHV1aWQsIGRhdGFWYWx1ZSwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy91cGRhdGUgc3VicHJvY2VzcyBsYWJlbCBpbiB3b3JrZmxvdyBpbnN0YW5jZSBwcm9jZXNzIG9iamVjdDogVE9ET1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJObyBtZXRob2QgZm91bmQgZnJvbSBpbXBsZW1lbnRlZCBsaXN0IGluIHN1YnByb2Nlc3MgYWN0aW9uLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3N0ZXAnOlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdjb21tdW5pdHknOlxuICAgICAgICAgICAgICAgICAgICB2YXIgY29tbXVuaXR5UG9zc2libGVJdGVtcyA9IFtcImNyZWF0ZUNvbW11bml0eVwiLCBcInJlbGVhc2VBZG9wdGVkQXBwbGljYXRpb25cIiwgXCJ1c2VySm9pbkNvbW11bml0eVwiXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhhY3Rpb24ubWV0aG9kLmNvbW11bml0eSwgY29tbXVuaXR5UG9zc2libGVJdGVtcykpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY3JlYXRlQ29tbXVuaXR5JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5jb21tdW5pdHkuY3JlYXRlQ29tbXVuaXR5KGFjdGlvbi5tZXRob2QuY29tbXVuaXR5LmNyZWF0ZUNvbW11bml0eSwgdXVpZCwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncmVsZWFzZUFkb3B0ZWRBcHBsaWNhdGlvbic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUuY29tbXVuaXR5LnJlbGVhc2VBZG9wdGVkQXBwbGljYXRpb24oYWN0aW9uLm1ldGhvZC5jb21tdW5pdHkucmVsZWFzZUFkb3B0ZWRBcHBsaWNhdGlvbiwgdXVpZCwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAndXNlckpvaW5Db21tdW5pdHknOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLmNvbW11bml0eS51c2VySm9pbkNvbW11bml0eShhY3Rpb24ubWV0aG9kLmNvbW11bml0eS51c2VySm9pbkNvbW11bml0eSwgdXVpZCwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJObyBtZXRob2QgZm91bmQgZnJvbSBpbXBsZW1lbnRlZCBsaXN0LlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2FwcGxpY2F0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFwcGxpY2F0aW9uUG9zc2libGVJdGVtcyA9IFtcImNyZWF0ZUFwcERlZmluaXRpb25cIiwgXCJidWlsZEFwcGxpY2F0aW9uXCIsIFwiYXBwbGljYXRpb25BZG9wdGlvblwiXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhhY3Rpb24ubWV0aG9kLmFwcGxpY2F0aW9uLCBhcHBsaWNhdGlvblBvc3NpYmxlSXRlbXMpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZUFwcERlZmluaXRpb24nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLmFwcGxpY2F0aW9uLmNyZWF0ZUFwcERlZmluaXRpb24oYWN0aW9uLm1ldGhvZC5hcHBsaWNhdGlvbi5jcmVhdGVBcHBEZWZpbml0aW9uLCB1dWlkLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdidWlsZEFwcGxpY2F0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5hcHBsaWNhdGlvbi5idWlsZEFwcGxpY2F0aW9uKGFjdGlvbi5tZXRob2QuYXBwbGljYXRpb24uYnVpbGRBcHBsaWNhdGlvbiwgdXVpZCwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXBwbGljYXRpb25BZG9wdGlvbic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUuYXBwbGljYXRpb24uYXBwbGljYXRpb25BZG9wdGlvbihhY3Rpb24ubWV0aG9kLmFwcGxpY2F0aW9uLmFwcGxpY2F0aW9uQWRvcHRpb24sIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3VzZXInOlxuICAgICAgICAgICAgICAgICAgICB2YXIgdXNlclBvc3NpYmxlSXRlbXMgPSBbXCJhZGRUb1JvbGVcIl07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoYWN0aW9uLm1ldGhvZC51c2VyLCB1c2VyUG9zc2libGVJdGVtcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FkZFRvUm9sZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUudXNlci5hZGRUb1JvbGUoYWN0aW9uLm1ldGhvZC51c2VyLmFkZFRvUm9sZSwgdXVpZCwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdzZG8nOlxuICAgICAgICAgICAgICAgICAgICB2YXIgc2RvUG9zc2libGVJdGVtcyA9IFtcImNyZWF0ZVwiLCBcImVucm9sbENvdXJzZVwiXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhhY3Rpb24ubWV0aG9kLnNkbywgc2RvUG9zc2libGVJdGVtcykpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY3JlYXRlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5zZG8uY3JlYXRlKGFjdGlvbi5tZXRob2Quc2RvLmNyZWF0ZSwgdXVpZCwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Vucm9sbENvdXJzZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUuc2RvLmVucm9sbENvdXJzZShhY3Rpb24ubWV0aG9kLnNkby5lbnJvbGxDb3Vyc2UsIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3BlcmZvcm1hbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBlcmZvcm1hbmNlUG9zc2libGVJdGVtcyA9IFtcInVubG9ja1BlcmlvZFwiLCBcImxvY2tQZXJmb3JtYW5jZU1vZGVsXCIsIFwic2V0TW9kZWxTdGF0dXNcIl07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoYWN0aW9uLm1ldGhvZC5wZXJmb3JtYW5jZSwgcGVyZm9ybWFuY2VQb3NzaWJsZUl0ZW1zKSkge1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3VubG9ja1BlcmlvZCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucGVyZm9ybWFuY2UudW5sb2NrUGVyaW9kKGFjdGlvbi5tZXRob2QucGVyZm9ybWFuY2UudW5sb2NrUGVyaW9kLCB1dWlkLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2V0TW9kZWxTdGF0dXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnBlcmZvcm1hbmNlLnNldE1vZGVsU3RhdHVzKGFjdGlvbi5tZXRob2QucGVyZm9ybWFuY2Uuc2V0TW9kZWxTdGF0dXMsIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdsb2NrUGVyZm9ybWFuY2VNb2RlbCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucGVyZm9ybWFuY2UubG9ja1BlcmZvcm1hbmNlTW9kZWwoYWN0aW9uLm1ldGhvZC5wZXJmb3JtYW5jZS5sb2NrUGVyZm9ybWFuY2VNb2RlbCwgdXVpZCwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICd0YXhvbm9teSc6XG4gICAgICAgICAgICAgICAgICAgIHZhciB0YXhvbm9teVBvc3NpYmxlSXRlbXMgPSBbXCJjcmVhdGVcIl07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoYWN0aW9uLm1ldGhvZC50YXhvbm9teSwgdGF4b25vbXlQb3NzaWJsZUl0ZW1zKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjcmVhdGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnRheG9ub215LmNyZWF0ZShhY3Rpb24ubWV0aG9kLnRheG9ub215LmNyZWF0ZSwgdXVpZCwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJObyBtZXRob2QgZm91bmQgZnJvbSBpbXBsZW1lbnRlZCBsaXN0LlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3ZhcmlhYmxlcyc6XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YXJpYWJsZXNQb3NzaWJsZUl0ZW1zID0gW1wic2V0VmFyaWFibGVcIl07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoYWN0aW9uLm1ldGhvZC52YXJpYWJsZXMsIHZhcmlhYmxlc1Bvc3NpYmxlSXRlbXMpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NldFZhcmlhYmxlJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnZhcmlhYmxlcy5zZXRWYXJpYWJsZShhY3Rpb24ubWV0aG9kLnZhcmlhYmxlcy5zZXRWYXJpYWJsZSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJObyBtZXRob2QgZm91bmQgZnJvbSBpbXBsZW1lbnRlZCBsaXN0LlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ25vdGlmaWNhdGlvbic6XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUubm90aWZpY2F0aW9uLnNlbmROb3RpZmljYXRpb25Xb3JrZXIoYWN0aW9uLm1ldGhvZC5ub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3JlcG9ydCc6XG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXBvcnRQb3NzaWJsZUl0ZW1zID0gW1wiY3JlYXRlUGVyZm9ybWFuY2VSZXBvcnRcIiwgXCJjcmVhdGVSZXBvcnRcIiwgXCJzZG9SZXBvcnRcIiwgXCJleGVjdXRlUmVwb3J0XCIsIFwicmVxdWVzdFJlcG9ydFwiLCBcImdlbmVyYXRlVmlld1wiLCBcImdlbmVyYXRlQmFzaWNWaWV3XCIsIFwiZ2VuZXJhdGVVbmlvblZpZXdcIiwgXCJzZG9SZXBvcnRNdWx0aXBsZVwiLCBcInN1YnByb2ZpbGVRdWFydGVybHlSZXBvcnRcIl07XG5cbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhhY3Rpb24ubWV0aG9kLnJlcG9ydCwgcmVwb3J0UG9zc2libGVJdGVtcykpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY3JlYXRlUGVyZm9ybWFuY2VSZXBvcnQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnJlcG9ydC5jcmVhdGVQZXJmb3JtYW5jZVJlcG9ydChhY3Rpb24ubWV0aG9kLnJlcG9ydC5jcmVhdGVQZXJmb3JtYW5jZVJlcG9ydCwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY3JlYXRlUmVwb3J0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5yZXBvcnQuY3JlYXRlUmVwb3J0KGFjdGlvbi5tZXRob2QucmVwb3J0LmNyZWF0ZVJlcG9ydCwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Nkb1JlcG9ydCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucmVwb3J0LnNkb1JlcG9ydChhY3Rpb24ubWV0aG9kLnJlcG9ydC5zZG9SZXBvcnQsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdleGVjdXRlUmVwb3J0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5yZXBvcnQuZXhlY3V0ZVJlcG9ydChhY3Rpb24ubWV0aG9kLnJlcG9ydC5leGVjdXRlUmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZ2VuZXJhdGVWaWV3JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5yZXBvcnQuZ2VuZXJhdGVWaWV3KGFjdGlvbi5tZXRob2QucmVwb3J0LmdlbmVyYXRlVmlldywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JlcXVlc3RSZXBvcnQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnJlcG9ydC5yZXF1ZXN0UmVwb3J0KGFjdGlvbi5tZXRob2QucmVwb3J0LnJlcXVlc3RSZXBvcnQsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdnZW5lcmF0ZUJhc2ljVmlldyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucmVwb3J0LmdlbmVyYXRlQmFzaWNWaWV3KGFjdGlvbi5tZXRob2QucmVwb3J0LmdlbmVyYXRlQmFzaWNWaWV3LCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZ2VuZXJhdGVVbmlvblZpZXcnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnJlcG9ydC5nZW5lcmF0ZVVuaW9uVmlldyhhY3Rpb24ubWV0aG9kLnJlcG9ydC5nZW5lcmF0ZVVuaW9uVmlldywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2RvUmVwb3J0TXVsdGlwbGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnJlcG9ydC5zZG9SZXBvcnRNdWx0aXBsZShhY3Rpb24ubWV0aG9kLnJlcG9ydC5zZG9SZXBvcnRNdWx0aXBsZSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3N1YnByb2ZpbGVRdWFydGVybHlSZXBvcnQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnJlcG9ydC5zdWJwcm9maWxlUXVhcnRlcmx5UmVwb3J0KGFjdGlvbi5tZXRob2QucmVwb3J0LnN1YnByb2ZpbGVRdWFydGVybHlSZXBvcnQsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJObyBtZXRob2QgZm91bmQgZnJvbSBpbXBsZW1lbnRlZCBsaXN0LlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnd29ya2VyJzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdvcmtlclBvc3NpYmxlSXRlbXMgPSBbXCJzZW5kV29ya2VyXCIsIFwiZXhlY3V0ZUxvY2FsXCIsIFwiY3JlYXRlXCJdO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2Qud29ya2VyLCB3b3JrZXJQb3NzaWJsZUl0ZW1zKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzZW5kV29ya2VyJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLndvcmtlci5zZW5kV29ya2VyKGFjdGlvbi5tZXRob2Qud29ya2VyLnNlbmRXb3JrZXIsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2V4ZWN1dGVMb2NhbCc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS53b3JrZXIuZXhlY3V0ZUxvY2FsKGFjdGlvbi5tZXRob2Qud29ya2VyLmV4ZWN1dGVMb2NhbCwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY3JlYXRlJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLndvcmtlci5jcmVhdGUoYWN0aW9uLm1ldGhvZC53b3JrZXIuY3JlYXRlLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cblxuXG4gICAgICAgICAgICAgICAgY2FzZSAncGFydGljaXBhbnRzJzpcbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnRpY2lwYW50UG9zc2libGVJdGVtcyA9IFtcImxpbmtQYXJ0aWNpcGFudHNcIiwgXCJtb250aGx5QXR0ZW5kYW5jZVwiLCBcIm1vbnRobHlQcm9ncmVzc1N1bW1hcnlcIiwgXCJwYXJ0aWNpcGFudENvbnRyYWN0c1wiXTtcblxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2QucGFydGljaXBhbnRzLCBwYXJ0aWNpcGFudFBvc3NpYmxlSXRlbXMpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2xpbmtQYXJ0aWNpcGFudHMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnBhcnRpY2lwYW50cy5saW5rUGFydGljaXBhbnRzKGFjdGlvbi5tZXRob2QucGFydGljaXBhbnRzLmxpbmtQYXJ0aWNpcGFudHMsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21vbnRobHlBdHRlbmRhbmNlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5wYXJ0aWNpcGFudHMubW9udGhseUF0dGVuZGFuY2UoYWN0aW9uLm1ldGhvZC5wYXJ0aWNpcGFudHMubW9udGhseUF0dGVuZGFuY2UsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21vbnRobHlQcm9ncmVzc1N1bW1hcnknOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnBhcnRpY2lwYW50cy5tb250aGx5UHJvZ3Jlc3NTdW1tYXJ5KGFjdGlvbi5tZXRob2QucGFydGljaXBhbnRzLm1vbnRobHlQcm9ncmVzc1N1bW1hcnksIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwYXJ0aWNpcGFudENvbnRyYWN0cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucGFydGljaXBhbnRzLnBhcnRpY2lwYW50Q29udHJhY3RzKGFjdGlvbi5tZXRob2QucGFydGljaXBhbnRzLnBhcnRpY2lwYW50Q29udHJhY3RzLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiZ2VuZXJhbEZ1bmN0aW9uc1wiOlxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBwb3NzaWJsZUl0ZW1zID0gW1wiYWRkVG9GYXZvdXJpdGVzXCIsIFwiYWRkVG9Vc2VyRmF2b3VyaXRlc1wiXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhhY3Rpb24ubWV0aG9kLmdlbmVyYWxGdW5jdGlvbnMsIHBvc3NpYmxlSXRlbXMpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FkZFRvRmF2b3VyaXRlcyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUuZ2VuZXJhbEZ1bmN0aW9ucy5hZGRUb0Zhdm91cml0ZXMoYWN0aW9uLm1ldGhvZC5nZW5lcmFsRnVuY3Rpb25zLmFkZFRvRmF2b3VyaXRlcywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FkZFRvVXNlckZhdm91cml0ZXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLmdlbmVyYWxGdW5jdGlvbnMuYWRkVG9Vc2VyRmF2b3VyaXRlcyhhY3Rpb24ubWV0aG9kLmdlbmVyYWxGdW5jdGlvbnMuYWRkVG9Vc2VyRmF2b3VyaXRlcywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJObyBtZXRob2QgZm91bmQgZnJvbSBpbXBsZW1lbnRlZCBsaXN0LlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuXG5cblxuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwibWV0aG9kIG5vdCBkZWZpbmVkIGluIGNvbmZpZ3VyYXRpb25cIik7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoXCJObyBtZXRob2QgZm91bmQgZnJvbSBpbXBsZW1lbnRlZCBsaXN0LlwiKTtcblxuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogUHJvY2VzcyB0YXNrc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSB0YXNrIC0gdGhlIHRhc2sgY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBpbnB1dERhdGEgLSB0aGUgdXNlciBpbnB1dCBkYXRhXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiB0YXNrKHN1YnByb2Nlc3NJRCwgc3VicHJvY2Vzc1NFUSwgdGFzaywgc3B1dWlkLCBtb2RlbCkge1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIHZhciBfV0ZJbnN0YW5jZSA9IGFwcC5TQ09QRS53b3JrZmxvdztcbiAgICAgICAgdmFyIHByZUFjdGlvbnNDb25mID0gdGFzay5wcmVBY3Rpb25zO1xuICAgICAgICBwcmVBY3Rpb25zKHByZUFjdGlvbnNDb25mLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHByZUFjdGlvblJlc3VsdCkge1xuXG4gICAgICAgICAgICB2YXIgbGlzdCA9IFtdO1xuXG5cbiAgICAgICAgICAgIGlmICh0YXNrLmFzc2lnbi5yb2xlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHZhciBhc3NpZ25UeXBlID0gJ3Byb2ZpbGVSb2xlJztcbiAgICAgICAgICAgICAgICB2YXIgcHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB2YXIgaWQgPSAnJztcblxuICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzVG9Bc3NpZ25FeHRlcm5hbCA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciByb2xlID0gdGFzay5hc3NpZ24ucm9sZS5yb2xlSWQ7XG4gICAgICAgICAgICAgICAgICAgIGxpYnJhcnkuZ2V0VXNlcnNGcm9tUHJvZmlsZVJvbGUoaWQsIHJvbGUpLnRoZW4oZnVuY3Rpb24obGlzdCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGlzdCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaXN0Lmxlbmd0aCA+IDEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGRpbmcgcm9sZXMgZnJvbSBleHRlcm5hbCBwcm9maWxlXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQ3VycmVudFVzZXJFeGlzdEluR2l2ZW5Sb2xlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVpZCA9IGxpc3RbaV0uaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQgPT0gbGlzdFtpXS5pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQ3VycmVudFVzZXJFeGlzdEluR2l2ZW5Sb2xlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ3VycmVudFVzZXJFeGlzdEluR2l2ZW5Sb2xlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25lZSA9IG1vZGVsLmFzc2lnbmVkVG87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXNzaWduZWUudXNlcklkICE9IFwiXCIgJiYgYXNzaWduZWUubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld09iaiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXNzaWduZWUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeS5wdXNoKG5ld09iaik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUubmFtZSA9IExPQ0FMX1NFVFRJTkdTLlNFU1NJT04uZmlyc3ROYW1lICsgXCIgXCIgKyBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmxhc3ROYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUudXNlcklkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQgKyBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLnR5cGUgPSBBU1NJR05NRU5UX1RZUEVfQVVUTztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmR1ZURhdGVUaW1lID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5ieSA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90aWZpY2F0aW9uIHRoYXQgaXRzIGJlZW4gYXV0b21hdGljYWxseSBhc3NpZ25lZCB0byB5b3VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU2VuZCBhc3NpZ24gdXNlciBub3RpZmljYXRpb24gZnJvbSBoZXJlXG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm90aWZpY2F0aW9uID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YnByb2Nlc3NJRCArIFwiJ10vbm90aWZpY2F0aW9uc1wiLCBfV0ZJbnN0YW5jZS5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24gIT0gdW5kZWZpbmVkICYmIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VyID0geyAnaWQnOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZCwgJ25hbWUnOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJuYW1lIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYXNzaWdubWVudE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2suYXNzaWduLmFzc2lnbm1lbnQgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gbW9kZWwuYXNzaWdubWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY2NlcHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93XCI6IHRhc2suYXNzaWduLmFzc2lnbm1lbnQuYWNjZXB0LnNob3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5hY2NlcHQgPSBhY2NlcHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50Lm1lc3NhZ2UgPSBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50Lm1lc3NhZ2UuaTE4bik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1wiOiB0YXNrLmFzc2lnbi5hc3NpZ25tZW50LnJlamVjdC5zaG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIjogX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3QubGFiZWwuaTE4bilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucmVqZWN0ID0gcmVqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IGlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcInVzZXJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBsaXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnByb2ZpbGVSb2xlSWQgPSBpZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ3VycmVudFVzZXJFeGlzdEluR2l2ZW5Sb2xlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0ZpcmUgUHJlLXdvcmtBY3Rpb25zIGhlcmVcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzW3N1YlByb2Nlc3Nlcy91dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzSWQgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbdXVpZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcElkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vc3RlcC9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcElkICsgXCInXVwiLCBfV0ZJbnN0YW5jZS5jb25maWcsIHt9KVswXTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFzay5wcmVXb3JrQWN0aW9ucyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcmVXb3JrQWN0aW9uc09iaiA9IHRhc2sucHJlV29ya0FjdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlV29ya0FjdGlvbnMocHJlV29ya0FjdGlvbnNPYmosIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnQXNzaWdubWVudCBpcyBtYWRlLiBQcmUgd29yayBhY3Rpb25zIGZvdW5kIGFuZCBleGVjdXRlZCAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnQXNzaWdubWVudCBpcyBtYWRlLiBObyBwcmUgd29yayBhY3Rpb25zIGZvdW5kLiAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RpZmljYXRpb24gdGhhdCBpdHMgYmVlbiByZWxlYXNlZCBmb3IgYWNjZXB0YW5jZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm90aWZpY2F0aW9uID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YnByb2Nlc3NJRCArIFwiJ10vbm90aWZpY2F0aW9uc1wiLCBfV0ZJbnN0YW5jZS5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vaXNzdWUgaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbiAhPSB1bmRlZmluZWQgJiYgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VyID0geyAnaWQnOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZCwgJ25hbWUnOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJuYW1lIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYWNjZXB0YW5jZU5vdGlmaWNhdGlvbkV4dGVybmFsKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHNwdXVpZCwgbGlzdCkudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnTm90aWZpY2F0aW9ucyByZXF1ZXN0IHN1Ym1pdHRlZCBmb3IgYWNjZXB0YW5jZS4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ05vdGlmaWNhdGlvbnMgZmFpbGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25tZW50IG5vdGlmaWNhdGlvbiBmYWlsZWQgdG8gdXNlciBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnTm90aWZpY2F0aW9ucyBub3QgZm91bmQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpc3QubGVuZ3RoID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW1wbGVtZW50IGhlcmUgcHJlV29ya0FjdGlvbiBhcyB0aGlzIGlzIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgaW4gY2FzZSBvZiAxIHVzZXIgYW5kIHdpbGwgbm90IGdvIHRyb3VnaCBhY2NlcHRhbmNlIGZ1bmN0aW9uLlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VySWQgPSBsaXN0WzBdLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlcm5hbWUgPSBsaXN0WzBdLm5hbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25lZSA9IG1vZGVsLmFzc2lnbmVkVG87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhc3NpZ25lZS51c2VySWQgIT0gXCJcIiAmJiBhc3NpZ25lZS5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdPYmogPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFzc2lnbmVlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeS5wdXNoKG5ld09iaik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUubmFtZSA9IHVzZXJuYW1lICsgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUudXNlcklkID0gdXNlcklkICsgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUudHlwZSA9IEFTU0lHTk1FTlRfVFlQRV9BVVRPO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5kdWVEYXRlVGltZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5ieSA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFzay5hc3NpZ24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSBtb2RlbC5hc3NpZ25tZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjY2VwdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5hY2NlcHQuc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCI6IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQuYWNjZXB0LmxhYmVsLmkxOG4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LmFjY2VwdCA9IGFjY2VwdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQubWVzc2FnZSA9IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQubWVzc2FnZS5pMThuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWplY3QgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93XCI6IHRhc2suYXNzaWduLmFzc2lnbm1lbnQucmVqZWN0LnNob3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LnJlamVjdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5yZWplY3QgPSByZWplY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogbGlzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJ1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucHJvZmlsZVJvbGVJZCA9IGlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RpZmljYXRpb24gdGhhdCBpdHMgYmVlbiBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHRvIHlvdVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1NlbmQgYXNzaWduIHVzZXIgbm90aWZpY2F0aW9uIGZyb20gaGVyZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub3RpZmljYXRpb24gPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3VicHJvY2Vzc0lEICsgXCInXS9ub3RpZmljYXRpb25zXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uICE9IHVuZGVmaW5lZCAmJiBub3RpZmljYXRpb24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VyID0geyAnaWQnOiB1c2VySWQsICduYW1lJzogdXNlcm5hbWUgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUubm90aWZpY2F0aW9uLmFzc2lnbm1lbnROb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgc3B1dWlkLCB1c2VyKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWduZWQgc3VjY2Vzc2Z1bGx5LiBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25tZW50IG5vdGlmaWNhdGlvbiBmYWlsZWQgdG8gdXNlciBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0ZpcmUgUHJlLXdvcmtBY3Rpb25zIGhlcmVcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXNbc3ViUHJvY2Vzc2VzL3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcElkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vc3RlcC9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHByb2Nlc3NJZCArIFwiJ10vc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzSWQgKyBcIiddL3N0ZXBzW19pZCBlcSAnXCIgKyBzdGVwSWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLnByZVdvcmtBY3Rpb25zICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJlV29ya0FjdGlvbnNPYmogPSB0YXNrLnByZVdvcmtBY3Rpb25zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlV29ya0FjdGlvbnMocHJlV29ya0FjdGlvbnNPYmosIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdBc3NpZ25lZCB0byB0aGUgb25seSB1c2VyIGluIHJvbGUuIFByZSB3b3JrIGFjdGlvbnMgZXhlY3V0ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ0Fzc2lnbmVkIHRvIHRoZSBvbmx5IHVzZXIgaW4gcm9sZS4gTm8gcHJlIHdvcmsgYWN0aW9ucyBmb3VuZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9DYXNlIHdoZXJlIHVzZXJzIGxpc3QgPSAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25lZSA9IG1vZGVsLmFzc2lnbmVkVG87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLm5hbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS51c2VySWQgPSBcIlwiO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLmFzc2lnbi5hc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudCA9IG1vZGVsLmFzc2lnbm1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWNjZXB0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1wiOiB0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5zaG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIjogX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5hY2NlcHQubGFiZWwuaTE4bilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQuYWNjZXB0ID0gYWNjZXB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5tZXNzYWdlID0gX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5tZXNzYWdlLmkxOG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3Quc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCI6IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQucmVqZWN0LmxhYmVsLmkxOG4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnJlamVjdCA9IHJlamVjdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBsaXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcInVzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5wcm9maWxlUm9sZUlkID0gaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1dpbGwgYmUgZmlyZWQgZnJvbSBUYWtlQXNzaWdubWVudCBwYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJObyB1c2VycyBmb3VuZCBpbiBsaXN0LiBBc3NpZ25pbmcgYmxhbmsgXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCgnRXJyb3IgaW4gZ2V0VXNlcnNGcm9tUHJvZmlsZVJvbGUgJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NUb0Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcm9sZSA9IHRhc2suYXNzaWduLnJvbGUucm9sZUlkO1xuICAgICAgICAgICAgICAgICAgICBsaWJyYXJ5LmdldFVzZXJzTGlzdEJ5Um9sZShpZCwgcm9sZSkudGhlbihmdW5jdGlvbihsaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGlzdCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaXN0Lmxlbmd0aCA+IDEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOZXcgcmVxdWlyZW1lbnQgaGVyZSB3aWxsIGF1dG9tYXRpY2FsbHkgYXNzaWduIHRoZSBzdGVwIHRvIGN1cnJlbnQgdXNlciBpZiB0aGlzIHVzZXIgZmFsbHMgdW5kZXIgdGhlIHByb3ZpZGVkIGdyb3VwLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSVUxFIElOVFJPRFVDRUQgT04gMTYtTUFSQ0gtMjAxN1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBjdXJyZW50IHVzZXIgbGllcyB3aXRoaW4gdGhlIHNwZWNpZmllZCByb2xlLCBpdCB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdG8gdGhhdCB1c2VyLlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc0N1cnJlbnRVc2VyRXhpc3RJbkdpdmVuUm9sZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm9sZXNPYmplY3QgPSBsaWJyYXJ5LmdldEN1cnJlbnRVc2VyUm9sZXMoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNDdXJyZW50VXNlclJvbGUxID0gcm9sZXNPYmplY3QucHJvZmlsZS5pbmRleE9mKHJvbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNDdXJyZW50VXNlclJvbGUyID0gcm9sZXNPYmplY3QuY29tbXVuaXR5LmluZGV4T2Yocm9sZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc0N1cnJlbnRVc2VyUm9sZTMgPSByb2xlc09iamVjdC5pbXBsaWNpdC5pbmRleE9mKHJvbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNDdXJyZW50VXNlclJvbGU0ID0gcm9sZXNPYmplY3QuYWRvcHRpb24uaW5kZXhPZihyb2xlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQ3VycmVudFVzZXJSb2xlNSA9IHJvbGVzT2JqZWN0LnN1YnByb2ZpbGUuaW5kZXhPZihyb2xlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDdXJyZW50VXNlclJvbGUxID4gLTEgfHwgaXNDdXJyZW50VXNlclJvbGUyID4gLTEgfHwgaXNDdXJyZW50VXNlclJvbGUzID4gLTEgfHwgaXNDdXJyZW50VXNlclJvbGU0ID4gLTEgfHwgaXNDdXJyZW50VXNlclJvbGU1ID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQ3VycmVudFVzZXJFeGlzdEluR2l2ZW5Sb2xlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQ3VycmVudFVzZXJFeGlzdEluR2l2ZW5Sb2xlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDdXJyZW50VXNlckV4aXN0SW5HaXZlblJvbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhc3NpZ25lZS51c2VySWQgIT0gXCJcIiAmJiBhc3NpZ25lZS5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3T2JqID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhc3NpZ25lZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5LnB1c2gobmV3T2JqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5uYW1lID0gTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5maXJzdE5hbWUgKyBcIiBcIiArIExPQ0FMX1NFVFRJTkdTLlNFU1NJT04ubGFzdE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS51c2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUudHlwZSA9IEFTU0lHTk1FTlRfVFlQRV9BVVRPO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuZHVlRGF0ZVRpbWUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmJ5ID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQgKyBcIlwiO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RpZmljYXRpb24gdGhhdCBpdHMgYmVlbiBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHRvIHlvdVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TZW5kIGFzc2lnbiB1c2VyIG5vdGlmaWNhdGlvbiBmcm9tIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub3RpZmljYXRpb24gPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3VicHJvY2Vzc0lEICsgXCInXS9ub3RpZmljYXRpb25zXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbiAhPSB1bmRlZmluZWQgJiYgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXIgPSB7ICdpZCc6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkLCAnbmFtZSc6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcm5hbWUgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLm5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Tm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHNwdXVpZCwgdXNlcikudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWduZWQgc3VjY2Vzc2Z1bGx5LiBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5jYXRjaChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWdubWVudCBub3RpZmljYXRpb24gZmFpbGVkIHRvIHVzZXIgVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFzay5hc3NpZ24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSBtb2RlbC5hc3NpZ25tZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjY2VwdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5hY2NlcHQuc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCI6IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQuYWNjZXB0LmxhYmVsLmkxOG4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LmFjY2VwdCA9IGFjY2VwdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQubWVzc2FnZSA9IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQubWVzc2FnZS5pMThuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWplY3QgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93XCI6IHRhc2suYXNzaWduLmFzc2lnbm1lbnQucmVqZWN0LnNob3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LnJlamVjdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5yZWplY3QgPSByZWplY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogcHJvZmlsZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicm9sZUlkXCI6IHJvbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwicm9sZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnByb2ZpbGVSb2xlSWQgPSBpZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0N1cnJlbnRVc2VyRXhpc3RJbkdpdmVuUm9sZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9GaXJlIFByZS13b3JrQWN0aW9ucyBoZXJlXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzSWQgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlc1tzdWJQcm9jZXNzZXMvdXVpZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBJZCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3N0ZXAvaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgcHJvY2Vzc0lkICsgXCInXS9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NJZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2sucHJlV29ya0FjdGlvbnMgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJlV29ya0FjdGlvbnNPYmogPSB0YXNrLnByZVdvcmtBY3Rpb25zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZVdvcmtBY3Rpb25zKHByZVdvcmtBY3Rpb25zT2JqLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ0Fzc2lnbm1lbnQgaXMgbWFkZS4gUHJlIHdvcmsgYWN0aW9ucyBmb3VuZCBhbmQgZXhlY3V0ZWQgJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ0Fzc2lnbm1lbnQgaXMgbWFkZS4gTm8gcHJlIHdvcmsgYWN0aW9ucyBmb3VuZC4gJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90aWZpY2F0aW9uIHRoYXQgaXRzIGJlZW4gcmVsZWFzZWQgZm9yIGFjY2VwdGFuY2VcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJwcm9jZXNzSUQgKyBcIiddL25vdGlmaWNhdGlvbnNcIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2lzc3VlIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24gIT0gdW5kZWZpbmVkICYmIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlciA9IHsgJ2lkJzogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQsICduYW1lJzogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VybmFtZSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUubm90aWZpY2F0aW9uLmFjY2VwdGFuY2VOb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgc3B1dWlkLCByb2xlKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihzdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ05vdGlmaWNhdGlvbnMgcmVxdWVzdCBzdWJtaXR0ZWQgZm9yIGFjY2VwdGFuY2UuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmNhdGNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihmYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdOb3RpZmljYXRpb25zIGZhaWxlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWdubWVudCBub3RpZmljYXRpb24gZmFpbGVkIHRvIHVzZXIgVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ05vdGlmaWNhdGlvbnMgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaXN0Lmxlbmd0aCA9PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEltcGxlbWVudCBoZXJlIHByZVdvcmtBY3Rpb24gYXMgdGhpcyBpcyBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIGluIGNhc2Ugb2YgMSB1c2VyIGFuZCB3aWxsIG5vdCBnbyB0cm91Z2ggYWNjZXB0YW5jZSBmdW5jdGlvbi5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlcklkID0gbGlzdFswXS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJuYW1lID0gbGlzdFswXS5uYW1lO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWduZWUgPSBtb2RlbC5hc3NpZ25lZFRvO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXNzaWduZWUudXNlcklkICE9IFwiXCIgJiYgYXNzaWduZWUubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3T2JqID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhc3NpZ25lZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkucHVzaChuZXdPYmopO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLm5hbWUgPSB1c2VybmFtZSArIFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLnVzZXJJZCA9IHVzZXJJZCArIFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLnR5cGUgPSBBU1NJR05NRU5UX1RZUEVfQVVUTztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuZHVlRGF0ZVRpbWUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuYnkgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2suYXNzaWduLmFzc2lnbm1lbnQgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gbW9kZWwuYXNzaWdubWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY2NlcHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93XCI6IHRhc2suYXNzaWduLmFzc2lnbm1lbnQuYWNjZXB0LnNob3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5hY2NlcHQgPSBhY2NlcHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50Lm1lc3NhZ2UgPSBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50Lm1lc3NhZ2UuaTE4bik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1wiOiB0YXNrLmFzc2lnbi5hc3NpZ25tZW50LnJlamVjdC5zaG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIjogX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3QubGFiZWwuaTE4bilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucmVqZWN0ID0gcmVqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IHByb2ZpbGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJvbGVJZFwiOiByb2xlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcInJvbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5wcm9maWxlUm9sZUlkID0gaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdGlmaWNhdGlvbiB0aGF0IGl0cyBiZWVuIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdG8geW91XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU2VuZCBhc3NpZ24gdXNlciBub3RpZmljYXRpb24gZnJvbSBoZXJlXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJwcm9jZXNzSUQgKyBcIiddL25vdGlmaWNhdGlvbnNcIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24gIT0gdW5kZWZpbmVkICYmIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXIgPSB7ICdpZCc6IHVzZXJJZCwgJ25hbWUnOiB1c2VybmFtZSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYXNzaWdubWVudE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25lZCBzdWNjZXNzZnVsbHkuIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5jYXRjaChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihmYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vRmlyZSBQcmUtd29ya0FjdGlvbnMgaGVyZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzSWQgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlc1tzdWJQcm9jZXNzZXMvdXVpZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzSWQgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbdXVpZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9zdGVwL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgcHJvY2Vzc0lkICsgXCInXS9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NJZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2sucHJlV29ya0FjdGlvbnMgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcmVXb3JrQWN0aW9uc09iaiA9IHRhc2sucHJlV29ya0FjdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVXb3JrQWN0aW9ucyhwcmVXb3JrQWN0aW9uc09iaiwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ0Fzc2lnbmVkIHRvIHRoZSBvbmx5IHVzZXIgaW4gcm9sZS4gUHJlIHdvcmsgYWN0aW9ucyBleGVjdXRlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnQXNzaWduZWQgdG8gdGhlIG9ubHkgdXNlciBpbiByb2xlLiBObyBwcmUgd29yayBhY3Rpb25zIGZvdW5kLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0Nhc2Ugd2hlcmUgdXNlcnMgbGlzdCA9IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUubmFtZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLnVzZXJJZCA9IFwiXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2suYXNzaWduLmFzc2lnbm1lbnQgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gbW9kZWwuYXNzaWdubWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY2NlcHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93XCI6IHRhc2suYXNzaWduLmFzc2lnbm1lbnQuYWNjZXB0LnNob3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5hY2NlcHQgPSBhY2NlcHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50Lm1lc3NhZ2UgPSBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50Lm1lc3NhZ2UuaTE4bik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1wiOiB0YXNrLmFzc2lnbi5hc3NpZ25tZW50LnJlamVjdC5zaG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIjogX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3QubGFiZWwuaTE4bilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucmVqZWN0ID0gcmVqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IHByb2ZpbGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJvbGVJZFwiOiByb2xlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcInJvbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5wcm9maWxlUm9sZUlkID0gaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1dpbGwgYmUgZmlyZWQgZnJvbSBUYWtlQXNzaWdubWVudCBwYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJObyB1c2VycyBmb3VuZCBpbiBsaXN0LiBBc3NpZ25pbmcgYmxhbmsgXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBpZiAodGFzay5hc3NpZ24ucm9sZS5wcm9maWxlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLmFzc2lnbi5yb2xlLnByb2ZpbGUgPT0gJ2N1cnJlbnQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGFzay5hc3NpZ24ucm9sZS5wcm9maWxlID09ICdjb21tdW5pdHknKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NUb0Fzc2lnbigpO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrLmFzc2lnbi5yb2xlLnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKHRhc2suYXNzaWduLnJvbGUucHJvZmlsZUlkLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKGZvcm1Qcm9maWxlSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gZm9ybVByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NUb0Fzc2lnbkV4dGVybmFsKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfVxuXG5cblxuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhc2suYXNzaWduLnVzZXIgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKHRhc2suYXNzaWduLnVzZXIudXNlck5hbWUsIF9XRkluc3RhbmNlLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24odXNlck5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZSh0YXNrLmFzc2lnbi51c2VyLnVzZXJJZCwgX1dGSW5zdGFuY2UsIHNwdXVpZCkudGhlbihmdW5jdGlvbih1c2VySWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJJZCA9IHVzZXJJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VybmFtZSA9IHVzZXJOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhc3NpZ25lZS51c2VySWQgIT0gXCJcIiAmJiBhc3NpZ25lZS5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3T2JqID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhc3NpZ25lZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5LnB1c2gobmV3T2JqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLm5hbWUgPSB1c2VybmFtZSArIFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS51c2VySWQgPSB1c2VySWQgKyBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLnR5cGUgPSBBU1NJR05NRU5UX1RZUEVfQVVUTztcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmR1ZURhdGVUaW1lID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5ieSA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLmFzc2lnbi5hc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSBtb2RlbC5hc3NpZ25tZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY2NlcHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1wiOiB0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5zaG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCI6IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQuYWNjZXB0LmxhYmVsLmkxOG4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQuYWNjZXB0ID0gYWNjZXB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQubWVzc2FnZSA9IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQubWVzc2FnZS5pMThuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3Quc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LnJlamVjdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB1c2VySWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHVzZXJOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QucHVzaChpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucmVqZWN0ID0gcmVqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogcHJvZmlsZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBsaXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJ1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG5cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5wcm9maWxlUm9sZUlkID0gaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdGlmaWNhdGlvbiB0aGF0IGl0cyBiZWVuIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdG8geW91XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1NlbmQgYXNzaWduIHVzZXIgbm90aWZpY2F0aW9uIGZyb20gaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJwcm9jZXNzSUQgKyBcIiddL25vdGlmaWNhdGlvbnNcIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uICE9IHVuZGVmaW5lZCAmJiBub3RpZmljYXRpb24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlciA9IHsgJ2lkJzogdXNlcklkLCAnbmFtZSc6IHVzZXJuYW1lIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYXNzaWdubWVudE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy9GaXJlIFByZS13b3JrQWN0aW9ucyBoZXJlXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXNbc3ViUHJvY2Vzc2VzL3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1t1dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBJZCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3N0ZXAvaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgcHJvY2Vzc0lkICsgXCInXS9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NJZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLnByZVdvcmtBY3Rpb25zICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZVdvcmtBY3Rpb25zT2JqID0gdGFzay5wcmVXb3JrQWN0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVXb3JrQWN0aW9ucyhwcmVXb3JrQWN0aW9uc09iaiwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdBc3NpZ25lZCB0byB0aGUgb25seSB1c2VyIGluIHJvbGUuIFByZSB3b3JrIGFjdGlvbnMgZXhlY3V0ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnQXNzaWduZWQgdG8gdGhlIG9ubHkgdXNlciBpbiByb2xlLiBObyBwcmUgd29yayBhY3Rpb25zIGZvdW5kLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrLmFzc2lnbi5zd2ltbGFuZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzdGVwSWQgPSB0YXNrLmFzc2lnbi5zd2ltbGFuZS5zdGVwSWQ7XG4gICAgICAgICAgICAgICAgdmFyIHNlcXVlbmNlID0gdGFzay5hc3NpZ24uc3dpbWxhbmUuc2VxdWVuY2U7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2VzcyA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB2YXIgaGlzdG9yeUxpc3QgPSBKU09OLnhwYXRoKFwiL2hpc3RvcnlbaWQgZXEgJ1wiICsgc3RlcElkICsgXCInXVwiLCBzdWJQcm9jZXNzLCB7fSk7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGVTZWFyY2ggPSAnJztcbiAgICAgICAgICAgICAgICBpZiAoc2VxdWVuY2UgPT0gJ2xhc3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGVTZWFyY2ggPSBKU09OLnhwYXRoKFwibWF4KGZvciAkcyBpbiAvKiByZXR1cm4geHM6ZGF0ZVRpbWUoJHMvZGF0ZVRpbWVDcmVhdGVkKSlcIiwgaGlzdG9yeUxpc3QsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBkYXRlU2VhcmNoID0gSlNPTi54cGF0aChcIm1pbihmb3IgJHMgaW4gLyogcmV0dXJuIHhzOmRhdGVUaW1lKCRzL2RhdGVUaW1lQ3JlYXRlZCkpXCIsIGhpc3RvcnlMaXN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBoaXN0b3J5T2JqZWN0ID0gSlNPTi54cGF0aChcIi8qW3hzOmRhdGVUaW1lKGRhdGVUaW1lQ3JlYXRlZCkgZXEgeHM6ZGF0ZVRpbWUoJ1wiICsgZGF0ZVNlYXJjaCArIFwiJyldXCIsIGhpc3RvcnlMaXN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2Fzc2lnbm1lbnRIaXN0b3J5W2xhc3QoKV1cIiwgaGlzdG9yeU9iamVjdCwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGFzc2lnbm1lbnRPYmplY3QudXNlcklkO1xuICAgICAgICAgICAgICAgIHZhciB1c2VybmFtZSA9IGFzc2lnbm1lbnRPYmplY3QubmFtZTtcblxuICAgICAgICAgICAgICAgIGlmIChtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgYXNzaWduZWUgPSBtb2RlbC5hc3NpZ25lZFRvO1xuICAgICAgICAgICAgICAgIGlmIChhc3NpZ25lZS51c2VySWQgIT0gXCJcIiAmJiBhc3NpZ25lZS5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld09iaiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXNzaWduZWUpKTtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkucHVzaChuZXdPYmopO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhc3NpZ25lZS5uYW1lID0gdXNlcm5hbWUgKyBcIlwiO1xuICAgICAgICAgICAgICAgIGFzc2lnbmVlLnVzZXJJZCA9IHVzZXJJZCArIFwiXCI7XG4gICAgICAgICAgICAgICAgYXNzaWduZWUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICBhc3NpZ25lZS50eXBlID0gQVNTSUdOTUVOVF9UWVBFX1NXSU1MQU5FO1xuICAgICAgICAgICAgICAgIGFzc2lnbmVlLmR1ZURhdGVUaW1lID0gJyc7XG4gICAgICAgICAgICAgICAgYXNzaWduZWUuYnkgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG5cbiAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudCA9ICcnO1xuXG4gICAgICAgICAgICAgICAgLy8gTm90aWZpY2F0aW9uIHRoYXQgaXRzIGJlZW4gYXV0b21hdGljYWxseSBhc3NpZ25lZCB0byB5b3VcbiAgICAgICAgICAgICAgICAvL1NlbmQgYXNzaWduIHVzZXIgbm90aWZpY2F0aW9uIGZyb20gaGVyZVxuICAgICAgICAgICAgICAgIHZhciBub3RpZmljYXRpb24gPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3VicHJvY2Vzc0lEICsgXCInXS9ub3RpZmljYXRpb25zXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24gIT0gdW5kZWZpbmVkICYmIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXNlciA9IHsgJ2lkJzogdXNlcklkLCAnbmFtZSc6IHVzZXJuYW1lIH07XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUubm90aWZpY2F0aW9uLmFzc2lnbm1lbnROb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgc3B1dWlkLCB1c2VyKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKS5jYXRjaChcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25tZW50IG5vdGlmaWNhdGlvbiBmYWlsZWQgdG8gdXNlciBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL0ZpcmUgUHJlLXdvcmtBY3Rpb25zIGhlcmVcbiAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXNbc3ViUHJvY2Vzc2VzL3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzSWQgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbdXVpZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHN0ZXBJZCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3N0ZXAvaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIHZhciBzdGVwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHByb2Nlc3NJZCArIFwiJ10vc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzSWQgKyBcIiddL3N0ZXBzW19pZCBlcSAnXCIgKyBzdGVwSWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRhc2sucHJlV29ya0FjdGlvbnMgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHByZVdvcmtBY3Rpb25zT2JqID0gdGFzay5wcmVXb3JrQWN0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgcHJlV29ya0FjdGlvbnMocHJlV29ya0FjdGlvbnNPYmosIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ0Fzc2lnbmVkIHRvIHRoZSBvbmx5IHVzZXIgaW4gcm9sZS4gUHJlIHdvcmsgYWN0aW9ucyBleGVjdXRlZCcpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ0Fzc2lnbmVkIHRvIHRoZSBvbmx5IHVzZXIgaW4gcm9sZS4gTm8gcHJlIHdvcmsgYWN0aW9ucyBmb3VuZC4nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufTtcblxuXG5cbi8qKlxuICogUHJvY2VzcyB0YXNrc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSB0YXNrIC0gdGhlIHRhc2sgY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBpbnB1dERhdGEgLSB0aGUgdXNlciBpbnB1dCBkYXRhXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBzZXJ2ZXIoc2VydmVyLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2VzcywgbW9kZWwsIF9XRkluc3RhbmNlLCBkYXRhLCB1dWlkKSB7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgLy92YXIgX1dGSW5zdGFuY2UgPSBhcHAuU0NPUEUud29ya2Zsb3c7XG4gICAgICAgIHZhciBwcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICB2YXIgYWN0aW9uQmxvY2sgPSBzZXJ2ZXIuc2VydmVyQWN0aW9uWzBdO1xuICAgICAgICBpZiAobW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9IFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgaWYgKGFzc2lnbmVlLnVzZXJJZCAhPSBcIlwiICYmIGFzc2lnbmVlLm5hbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgdmFyIG5ld09iaiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXNzaWduZWUpKTtcbiAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5LnB1c2gobmV3T2JqKTtcbiAgICAgICAgfVxuICAgICAgICBhc3NpZ25lZS5uYW1lID0gTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5maXJzdE5hbWUgKyBcIiBcIiArIExPQ0FMX1NFVFRJTkdTLlNFU1NJT04ubGFzdE5hbWU7XG4gICAgICAgIGFzc2lnbmVlLnVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcbiAgICAgICAgYXNzaWduZWUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgYXNzaWduZWUudHlwZSA9IEFTU0lHTk1FTlRfVFlQRV9BVVRPO1xuICAgICAgICBhc3NpZ25lZS5kdWVEYXRlVGltZSA9ICcnO1xuICAgICAgICBhc3NpZ25lZS5ieSA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcblxuICAgICAgICBhY3Rpb24oYWN0aW9uQmxvY2ssIHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdWJQcm9jZXNzLCBtb2RlbCwgX1dGSW5zdGFuY2UsIGRhdGEsIHV1aWQpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKFwiTm8gdXNlcnMgZm91bmQgaW4gbGlzdC4gQXNzaWduaW5nIGJsYW5rIFwiKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgIHJlamVjdChcIlNlcnZlciBhY3Rpb24gZXJyb3IgZm91bmQgcmVqZWN0ZWRcIilcbiAgICAgICAgICAgIH0pO1xuICAgIH0pO1xuXG59O1xuXG4vKipcbiAqIFByb2Nlc3MgdHJhbnNpdGlvblxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBwcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gcHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBwcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN1YlByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN1Yi1wcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gc3ViUHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBzdWItcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGVwSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdGVwIGlkXG4gKiBAcGFyYW0ge3N0cmluZ30gdHJhbnNpdGlvbklkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gdHJhbnNpdGlvbiBpZFxuICogQHBhcmFtIHtvYmplY3R9IGRhdGEgLSBhbnkgYWRkaXRpb25hbCBkYXRhIHBhc3NlZCBpbiBhcyBrZXkgdmFsdWUgcGFpcnNcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiB0cmFuc2l0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHRyYW5zaXRpb25JZCwgZGF0YSwgX1dGSW5zdGFuY2UsIHNwdXVpZCwgbW9kZWwpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgc3RlcFNlcSA9IDA7XG4gICAgICAgICAgICB2YXIgbmV4dFN0ZXBJZCA9ICcnO1xuICAgICAgICAgICAgdmFyIG5leHRTdGVwU2VxID0gMDtcbiAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzID0gW107XG4gICAgICAgICAgICB2YXIgY3VycmVudFByb2Nlc3MgPSBfV0ZJbnN0YW5jZS5jb25maWcucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpQcm9jZXNzKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9ialByb2Nlc3MuX2lkID09IHByb2Nlc3NJZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqUHJvY2VzcztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRTdWJQcm9jZXNzID0gY3VycmVudFByb2Nlc3NbMF0uc3ViUHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpTdWJQcm9jZXNzKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9ialN1YlByb2Nlc3MuX2lkID09IHN1YlByb2Nlc3NJZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqU3ViUHJvY2VzcztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGVwID0gY3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHMuZmlsdGVyKGZ1bmN0aW9uKG9ialN0ZXApIHtcbiAgICAgICAgICAgICAgICBpZiAob2JqU3RlcC5faWQgPT0gc3RlcElkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmpTdGVwO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgdHJhbnNpdGlvbiA9IGN1cnJlbnRTdGVwWzBdLnRyYW5zaXRpb24uZmlsdGVyKGZ1bmN0aW9uKG9ialRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAob2JqVHJhbnNpdGlvbi5faWQgPT0gdHJhbnNpdGlvbklkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmpUcmFuc2l0aW9uO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGN1cnJlbnRTdWJQcm9jZXNzWzBdLnN0ZXBzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdWJQcm9jZXNzWzBdLnN0ZXBzW2ldLl9pZCA9PSBzdGVwSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RlcFNlcSA9IHBhcnNlSW50KGN1cnJlbnRTdWJQcm9jZXNzWzBdLnN0ZXBzW2ldLl9zZXEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjdXJyZW50U3ViUHJvY2Vzc1swXS5zdGVwcy5maWx0ZXIoZnVuY3Rpb24oc3RlcEl0ZW0pIHtcbiAgICAgICAgICAgICAgICBuZXh0U3RlcFNlcSA9IHN0ZXBTZXEgKyAxO1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChzdGVwSXRlbS5fc2VxKSA9PSBuZXh0U3RlcFNlcSkge1xuICAgICAgICAgICAgICAgICAgICBuZXh0U3RlcElkID0gc3RlcEl0ZW0uX2lkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSlcblxuXG5cblxuICAgICAgICAgICAgdmFyIG1heFN0ZXBzID0gY3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHMubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIHNwaW5zdGFuY2VPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIHNwSW5zdGFuY2VTdGVwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vc3RlcFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAvLyBBZGRpbmcgc3RlcCBPYmplY3QgaW4gc3VicHJvY2VzcyBoaXN0b3J5IEZyb20gc2Vjb25kIHN0ZXAuIEFzIGZpcnN0IHN0ZXAgaXMgYWRkZWQgYXQgc3ViUHJvY2VzcygpIGZ1bmN0aW9uIFxuICAgICAgICAgICAgaWYgKHNwaW5zdGFuY2VPYmplY3QuaGlzdG9yeSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBzcGluc3RhbmNlT2JqZWN0Lmhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBwdXNoSW5kaWNhdG9yVG9Nb2RlbCA9IGZ1bmN0aW9uKG1vZGVsKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBJbiBib3RoICB0aGUgY2FzZXMgdGhlIGxpc3QgaXMgZGlmZmVybmV0IHRoYXQgbmVlZHMgdG8gYmUgbWFkZSBzYW1lLlxuXG4gICAgICAgICAgICAgICAgdmFyIGluZGljYXRvckxpc3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pbmRpY2F0b3JzXCIsIF9XRkluc3RhbmNlLCB7fSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgaXNGaXJzdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChpbmRpY2F0b3JMaXN0ID09IHVuZGVmaW5lZCB8fCBpbmRpY2F0b3JMaXN0Lmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzRmlyc3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3JMaXN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW3dvcmtmbG93cy9wcm9jZXNzZXNbc3ViUHJvY2Vzc1VVSUQgZXEgJ1wiICsgc3B1dWlkICsgXCInXV1cIiwgX1dGSW5zdGFuY2UsIHt9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG1vZGVsLmluZGljYXRvcnMgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIG1vZGVsLmluZGljYXRvcnMgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpbmRpY2F0b3JMaXN0Lmxlbmd0aDsgaisrKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzRmlyc3QpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHV1aWQgPSBpbmRpY2F0b3JMaXN0W2pdLl9pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXYgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL19yZXZcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSBpbmRpY2F0b3JMaXN0W2pdLm1vZGVsLnBlbmRpbmcuc2VxO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXR1cyA9IGluZGljYXRvckxpc3Rbal0ubW9kZWwucGVuZGluZy5zdGF0dXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV1aWQ6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2OiByZXYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VxOiBzZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBzdGF0dXNcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmluZGljYXRvcnMucHVzaChpbmRPYmplY3QpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1dWlkID0gaW5kaWNhdG9yTGlzdFtqXS5pbnN0YW5jZXNbMF0udXVpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXYgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL19yZXZcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL21vZGVsL3BlbmRpbmcvc2VxXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhdHVzID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9tb2RlbC9wZW5kaW5nL3N0YXR1c1wiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dWlkOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldjogcmV2LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcTogc2VxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogc3RhdHVzXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5pbmRpY2F0b3JzLnB1c2goaW5kT2JqZWN0KTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRlbGV0ZSBtb2RlbC5hc3NpZ25lZFRvO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBtb2RlbC5hc3NpZ25tZW50O1xuICAgICAgICAgICAgICAgIHJldHVybiBtb2RlbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYWRkIGluZm9ybWF0aW9uIHRvIHRyYW5zdGlvbiBvYmplY3QuXG4gICAgICAgICAgICB2YXIgdHJuT2JqZWN0ID0ge1xuICAgICAgICAgICAgICAgIHRyYW5zaXRpb25JZDogdHJhbnNpdGlvblswXS5faWQsXG4gICAgICAgICAgICAgICAgZGF0ZVRpbWU6IG1vbWVudCgpLmZvcm1hdCgpLFxuICAgICAgICAgICAgICAgIHVzZXJJZDogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQgKyBcIlwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobW9kZWwgIT0gdW5kZWZpbmVkICYmIE9iamVjdC5rZXlzKG1vZGVsKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgbW9kZWwudHJhbnNpdGlvbiA9IHRybk9iamVjdDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc3BJbnN0YW5jZVN0ZXBPYmplY3QudHJhbnNpdGlvbiA9IHRybk9iamVjdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gY29weSBjdXJyZW50IGFzc2lnbmVkVG8gdG8gcmVBc3NpZ25tZW50IG9iamVjdFxuXG4gICAgICAgICAgICBpZiAobW9kZWwgIT0gdW5kZWZpbmVkICYmIE9iamVjdC5rZXlzKG1vZGVsKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgYXNzaWduZWVPYmogPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG1vZGVsLmFzc2lnbmVkVG8pKTtcbiAgICAgICAgICAgICAgICBpZiAoYXNzaWduZWVPYmoudXNlcklkICE9IFwiXCIgJiYgYXNzaWduZWVPYmoubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5LnB1c2goYXNzaWduZWVPYmopO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoc3BJbnN0YW5jZVN0ZXBPYmplY3QuYXNzaWdubWVudEhpc3RvcnkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNwSW5zdGFuY2VTdGVwT2JqZWN0LmFzc2lnbm1lbnRIaXN0b3J5ID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBhc3NpZ25lZU9iaiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc3BJbnN0YW5jZVN0ZXBPYmplY3QuYXNzaWduZWRUbykpO1xuICAgICAgICAgICAgICAgIGlmIChhc3NpZ25lZU9iai51c2VySWQgIT0gXCJcIiAmJiBhc3NpZ25lZU9iai5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgc3BJbnN0YW5jZVN0ZXBPYmplY3QuYXNzaWdubWVudEhpc3RvcnkucHVzaChhc3NpZ25lZU9iaik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaGlzdG9yeU1vZGVsO1xuICAgICAgICAgICAgaWYgKG1vZGVsICE9IHVuZGVmaW5lZCAmJiBPYmplY3Qua2V5cyhtb2RlbCkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGhpc3RvcnlNb2RlbCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkobW9kZWwpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaGlzdG9yeU1vZGVsID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzcEluc3RhbmNlU3RlcE9iamVjdCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGluZE1vZGVsSW5TdGVwID0gcHVzaEluZGljYXRvclRvTW9kZWwoaGlzdG9yeU1vZGVsKTtcbiAgICAgICAgICAgIHNwaW5zdGFuY2VPYmplY3QuaGlzdG9yeS5wdXNoKGluZE1vZGVsSW5TdGVwKTtcblxuICAgICAgICAgICAgaWYgKHRyYW5zaXRpb25bMF0udHJhbnNpdGlvbkFjdGlvbi5nb1RvU3RlcCAhPSB1bmRlZmluZWQpIHtcblxuXG5cbiAgICAgICAgICAgICAgICB2YXIgbmV4dFNlcSA9IHBhcnNlSW50KGN1cnJlbnRTdGVwWzBdLl9zZXEpICsgcGFyc2VJbnQodHJhbnNpdGlvblswXS50cmFuc2l0aW9uQWN0aW9uLmdvVG9TdGVwLmRlZmF1bHQpO1xuICAgICAgICAgICAgICAgIHZhciBuZXh0SWQgPSAnJztcbiAgICAgICAgICAgICAgICBjdXJyZW50U3ViUHJvY2Vzc1swXS5zdGVwcy5maWx0ZXIoZnVuY3Rpb24oc3RlcEl0ZW0pIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQoc3RlcEl0ZW0uX3NlcSkgPT0gbmV4dFN0ZXBTZXEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRJZCA9IHN0ZXBJdGVtLl9pZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBzdGVwKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBuZXh0SWQsIG5leHRTZXEsIGRhdGEsIF9XRkluc3RhbmNlLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXh0U2VxID09IG1heFN0ZXBzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnQWxsIFN0ZXAgdHJhbnNpdGlvbnMgaGF2ZSBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzQ29tcGxldGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcDogcmVzdWx0LmRhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1N0ZXAgdHJhbnNpdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzQ29tcGxldGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXA6IHJlc3VsdC5kYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRyYW5zaXRpb25bMF0udHJhbnNpdGlvbkFjdGlvbi5nb1RvU3RlcElkICE9IHVuZGVmaW5lZCkge1xuXG5cblxuICAgICAgICAgICAgICAgIHZhciBnb1RvU3RlcElkID0gdHJhbnNpdGlvblswXS50cmFuc2l0aW9uQWN0aW9uLmdvVG9TdGVwSWQuc3RlcElkO1xuICAgICAgICAgICAgICAgIHZhciBnb1RvU3RlcFNlcSA9IDE7XG5cbiAgICAgICAgICAgICAgICBjdXJyZW50U3ViUHJvY2Vzc1swXS5zdGVwcy5maWx0ZXIoZnVuY3Rpb24oc3RlcEl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0ZXBJdGVtLl9pZCA9PSBnb1RvU3RlcElkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnb1RvU3RlcFNlcSA9IHBhcnNlSW50KHN0ZXBJdGVtLl9zZXEpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHN0ZXAocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIGdvVG9TdGVwSWQsIGdvVG9TdGVwU2VxLCBkYXRhLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ29Ub1N0ZXBTZXEgPT0gbWF4U3RlcHMgfHwgcmVzdWx0LmRhdGEuc3RhdHVzID09ICdDb21wbGV0ZScpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0FsbCBTdGVwIHRyYW5zaXRpb25zIGhhdmUgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0NvbXBsZXRlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXA6IHJlc3VsdC5kYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1N0ZXAgdHJhbnNpdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzQ29tcGxldGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXA6IHJlc3VsdC5kYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0cmFuc2l0aW9uWzBdLnRyYW5zaXRpb25BY3Rpb24uc3RvcCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgIC8vIEFzIHRoaXMgaXMgdGhlIGxhc3Qgc3RlcCAod2hlcmUgc3RvcCBpcyBkZWZpZWQpICwgc3ViUHJvY2VzcyBwb3N0QWN0aW9ucyBzaG91bGQgY29tZSBoZXJlLlxuXG4gICAgICAgICAgICAgICAgdmFyIHBvc3RBY3Rpb25zQ29uZiA9IGN1cnJlbnRQcm9jZXNzWzBdLnBvc3RBY3Rpb25zO1xuICAgICAgICAgICAgICAgIHBvc3RBY3Rpb25zKHBvc3RBY3Rpb25zQ29uZiwgX1dGSW5zdGFuY2UsIHNwdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnU3RlcCB0cmFuc2l0aW9uIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuV29ya2Zsb3cgc3RvcHBlZC4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzQ29tcGxldGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGVwOiBtb2RlbFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pO1xufTtcblxuLyoqXG4gKiBQcm9jZXNzIHBvc3RBY3Rpb25zXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IHBvc3RBY3Rpb25zIC0gdGhlIHBvc3RBY3Rpb25zIGNvbmZpZyBkYXRhXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBwb3N0QWN0aW9ucyhwb3N0QWN0aW9ucywgX1dGSW5zdGFuY2UsIHNwdXVpZCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdmFyIGNvbXBsZXRlZCA9IFtdO1xuICAgICAgICB0cnkge1xuXG5cbiAgICAgICAgICAgIHZhciBzcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgIHZhciBwcm9jZXNzSUQgPSBzcE9iamVjdFtcIm1ldGEtZGF0YVwiXS5wcm9jZXNzQ29uZmlnSWQ7XG4gICAgICAgICAgICB2YXIgcHJvY2Vzc0lkID0gc3BPYmplY3RbXCJtZXRhLWRhdGFcIl0uc3ViUHJvY2Vzc0NvbmZpZ0lkO1xuICAgICAgICAgICAgdmFyIHByb2Nlc3NTRVEgPSBzcE9iamVjdFtcIm1ldGEtZGF0YVwiXS5zdWJQcm9jZXNzSW5zU2VxO1xuICAgICAgICAgICAgdmFyIHByb2Nlc3NTZXEgPSBzcE9iamVjdFtcIm1ldGEtZGF0YVwiXS5zdWJQcm9jZXNzSW5zU2VxO1xuXG4gICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc0NvbmZpZ09iamVjdCA9IEpTT04ueHBhdGgoXCIvY29uZmlnL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgcHJvY2Vzc0lEICsgXCInXS9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHByb2Nlc3NJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIHZhciBzdGVwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vc3RlcFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG5cbiAgICAgICAgICAgIHV0aWwuc3luY0xvb3AocG9zdEFjdGlvbnMubGVuZ3RoLCBmdW5jdGlvbihsb29wKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvdW50ZXIgPSBsb29wLml0ZXJhdGlvbigpO1xuICAgICAgICAgICAgICAgIGFjdGlvbihwb3N0QWN0aW9uc1tjb3VudGVyXSwgcHJvY2Vzc0lELCBwcm9jZXNzU0VRLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NDb25maWdPYmplY3QsIHN0ZXBPYmplY3QsIF9XRkluc3RhbmNlLCB7fSwgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgYWxsIHByZS1yZXF1aXNpdGVzIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuXG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZC5wdXNoKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICBsb29wLm5leHQoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGVkLnB1c2goZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBsb29wLmJyZWFrKCk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbXBsZXRlZC5ldmVyeShCb29sZWFuKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUG9zdC1hY3Rpb25zIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywge30pO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGUHJlQWN0aW9uc0Vycm9yJywgJ05vdCBhbGwgcG9zdC1hY3Rpb25zIHBhc3NlZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qXG5mdW5jdGlvbiBzZW5kTm90aWZpY2F0aW9ucyh1c2Vyc0xpc3QsIHNwdXVpZCl7XG5cbiAgLy8gZ2V0IHVzZXJzIGxpc3QgXG4gIC8vIHNlbiBub3RpZmljYXRpb25zIHRvIHVzZXJzIHkgYWRkaW5nIGNoYW5uZWxzIHRvIHRoZW1cblxuICB2YXIgY2hhbm5lbEFycmF5ID0gW107XG5cbiAgZm9yKGk9MDtpPHVzZXJzTGlzdC5sZW5ndGg7IGkrKyl7XG4gICAgY2hhbm5lbEFycmF5LnB1c2goXCJ1c2VyX1wiK3VzZXJzTGlzdFtpXS5pZCk7XG4gIH1cblxuICBhc3NpZ25Ub1VzZXJzKHByb2Nlc3NXb3JrZmxvd01lc3NhZ2UoTk9USUZJQ0FUSU9OX1VTRVJfTVNHX0FDQ0VQVCwgc3B1dWlkKSwgY2hhbm5lbEFycmF5KTtcblxufTsqL1xuXG4vKmZ1bmN0aW9uIGFzc2lnblRvVXNlcnMobWVzc2FnZSwgY2hhbm5lbEFycmF5KXtcblxuICAgICB2YXIgY2hhbm5lbHMgPSBjaGFubmVsQXJyYXk7XG5cbiAgICAgdmFyIG5vdGlmaWNhdGlvbiA9ICB7IFxuICAgICAgICAgIFwiX2lkXCI6IGdlbmVyYXRlVVVJRCgpLFxuICAgICAgICAgIFwiY2hhbm5lbHNcIjpjaGFubmVscyxcbiAgICAgICAgICBcIm1lc3NhZ2VcIjogbWVzc2FnZSxcbiAgICAgICAgICBcIm1lc3NhZ2VUeXBlXCI6IFwiaW5mb1wiLFxuICAgICAgICAgIFwiY3JlYXRlZERhdGVUaW1lXCI6IG1vbWVudCgpLmZvcm1hdCgpLFxuICAgICAgICAgIFwicmVhZFwiOiBmYWxzZSxcbiAgICAgICAgICBcInJlYWREYXRlVGltZVwiOiBcIlwiLFxuICAgICAgICAgIFwidHlwZVwiOiBcIm5vdGlmaWNhdGlvblwiLFxuICAgICAgICAgIFwic2VuZGVyVXNlcklkXCI6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkXG4gICAgICAgfTtcblxuICAgICAgIGNvbnNvbGUubG9nKG5vdGlmaWNhdGlvbik7XG4gICAgICAgZGFvLnNhdmUobm90aWZpY2F0aW9uKTtcblxuICB9OyovXG5cbmZ1bmN0aW9uIHByb2Nlc3NXb3JrZmxvd01lc3NhZ2UobWVzc2FnZSwgc3B1dWlkKSB7XG5cbiAgICB2YXIgcmVwbGFjZWRNc2cgPSBtZXNzYWdlO1xuXG4gICAgaWYgKHJlcGxhY2VkTXNnLmluZGV4T2YoJyNJTlNUQU5DRV9MQUJFTCcpICE9PSAtMSkge1xuICAgICAgICB2YXIgdmFsID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9sYWJlbFwiLCBhcHAuU0NPUEUud29ya2Zsb3csIHt9KVswXTtcbiAgICAgICAgcmVwbGFjZWRNc2cgPSByZXBsYWNlZE1zZy5yZXBsYWNlKCcjSU5TVEFOQ0VfTEFCRUwnLCB2YWwpO1xuXG4gICAgfVxuXG4gICAgaWYgKHJlcGxhY2VkTXNnLmluZGV4T2YoJyNVU0VSX05BTUUnKSAhPT0gLTEpIHtcbiAgICAgICAgdmFyIHZhbCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3N0ZXAvYXNzaWduZWRUby9uYW1lXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuXG4gICAgICAgIHJlcGxhY2VkTXNnID0gcmVwbGFjZWRNc2cucmVwbGFjZSgnI1VTRVJfTkFNRScsIHZhbCk7XG5cbiAgICB9XG5cbiAgICBpZiAocmVwbGFjZWRNc2cuaW5kZXhPZignI1BST0ZJTEVfVElUTEUnKSAhPT0gLTEpIHtcbiAgICAgICAgdmFyIHZhbCA9IGFwcC5wcm9maWxlLnRpdGxlO1xuICAgICAgICByZXBsYWNlZE1zZyA9IHJlcGxhY2VkTXNnLnJlcGxhY2UoJyNQUk9GSUxFX1RJVExFJywgdmFsKTtcblxuICAgIH1cblxuICAgIGlmIChyZXBsYWNlZE1zZy5pbmRleE9mKCcjUFJPRklMRV9UWVBFJykgIT09IC0xKSB7XG4gICAgICAgIHZhciB2YWwgPSBhcHAuU0NPUEUuQVBQX0NPTkZJRy5uYW1lO1xuICAgICAgICByZXBsYWNlZE1zZyA9IHJlcGxhY2VkTXNnLnJlcGxhY2UoJyNQUk9GSUxFX1RZUEUnLCB2YWwpO1xuXG4gICAgfVxuXG4gICAgaWYgKHJlcGxhY2VkTXNnLmluZGV4T2YoJyNWQVJfU1BVVUlEJykgIT09IC0xKSB7XG4gICAgICAgIHZhciB2YWwgPSBzcHV1aWQ7XG4gICAgICAgIHJlcGxhY2VkTXNnID0gcmVwbGFjZWRNc2cucmVwbGFjZSgnI1ZBUl9TUFVVSUQnLCB2YWwpO1xuXG4gICAgfVxuXG4gICAgcmV0dXJuIHJlcGxhY2VkTXNnO1xufTtcblxuZnVuY3Rpb24gX2dldE5hbWUoYXJyLCBsYW5nKSB7XG4gICAgaWYgKGFyciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoYXJyW2ldLl9sYW5nID09PSBsYW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFycltpXS52YWx1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICB9XG5cbn07XG5cbmZ1bmN0aW9uIF9nZXROYW1lQnlMYW5nKG9iaikge1xuICAgIHJldHVybiBsaWJyYXJ5LmdldE5hbWVCeUxhbmcob2JqKTtcbn07XG5cblxuXG5cblxuLyoqXG4gKiBQcm9jZXNzIHByZVdvcmtBY3Rpb25zXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IHByZVdvcmtBY3Rpb25zIC0gdGhlIHByZVdvcmtBY3Rpb25zIGNvbmZpZyBkYXRhXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5cbmZ1bmN0aW9uIHByZVdvcmtBY3Rpb25zKHByZVdvcmtBY3Rpb25zLCBfV0ZJbnN0YW5jZSkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdmFyIGNvbXBsZXRlZCA9IFtdO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NDb25maWdPYmplY3QgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXNbX2lkIGVxICdcIiArIGFwcC5TQ09QRS5zcG8ucE9iamVjdC5pZCArIFwiJ10vc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBhcHAuU0NPUEUuc3BvLnNwT2JqZWN0LmlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgYXBwLlNDT1BFLnByb2Nlc3NVVUlEICsgXCInXS9zdGVwXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgIHV0aWwuc3luY0xvb3AocHJlV29ya0FjdGlvbnMubGVuZ3RoLCBmdW5jdGlvbihsb29wKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvdW50ZXIgPSBsb29wLml0ZXJhdGlvbigpO1xuICAgICAgICAgICAgICAgIGFjdGlvbihwcmVXb3JrQWN0aW9uc1tjb3VudGVyXSwgYXBwLlNDT1BFLnNwby5wT2JqZWN0LmlkLCBhcHAuU0NPUEUuc3BvLnBPYmplY3Quc2VxLCBhcHAuU0NPUEUuc3BvLnNwT2JqZWN0LmlkLCBhcHAuU0NPUEUuc3BvLnNwT2JqZWN0LnNlcSwgc3ViUHJvY2Vzc0NvbmZpZ09iamVjdCwgc3RlcE9iamVjdCwgX1dGSW5zdGFuY2UsIHt9LCBhcHAuU0NPUEUucHJvY2Vzc1VVSUQpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBhbGwgcHJlLXJlcXVpc2l0ZXMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS5cbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGVkLnB1c2godHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGxvb3AubmV4dCgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWQucHVzaChmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIGxvb3AuYnJlYWsoKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoY29tcGxldGVkLmV2ZXJ5KEJvb2xlYW4pKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdQcmVXb3JrLWFjdGlvbnMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZQcmVBY3Rpb25zRXJyb3InLCAnTm90IGFsbCBwcmUtd29yay1hY3Rpb25zIHBhc3NlZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSB7XG5cbiAgICBwcmVSZXF1aXNpdGVzOiBwcmVSZXF1aXNpdGVzLFxuICAgIHByZUFjdGlvbnM6IHByZUFjdGlvbnMsXG4gICAgcG9zdEFjdGlvbnM6IHBvc3RBY3Rpb25zLFxuICAgIHByZVdvcmtBY3Rpb25zOiBwcmVXb3JrQWN0aW9ucyxcbiAgICBzdWJQcm9jZXNzOiBzdWJQcm9jZXNzLFxuICAgIGluZGljYXRvckRvY3M6IGluZGljYXRvckRvY3MsXG4gICAgdGFzazogdGFzayxcbiAgICB0cmFuc2l0aW9uOiB0cmFuc2l0aW9uLFxuICAgIGFzc2lnblVzZXI6IGFzc2lnblVzZXJcblxufSIsIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBVdGlsaXR5IE1vZHVsZVxuICpcbiAqIEBtb2R1bGUgbGliL3V0aWxcbiAqXG4gKiBAYXV0aG9yIEJyZW50IEdvcmRvblxuICogQHZlcnNpb24gMC4xLjBcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFdvcmtmbG93IHV0aWxpdHkgbW9kdWxlIHVzZWQgdG8gZm9ybWF0IHRoZSByZXR1cm4gYW5kIGVycm9yIG9iamVjdHMsIGFuZFxuICogY29udGFpbnMgc29tZSBvdGhlciB1dGlsaXR5IGZ1bmN0aW9ucyBzdWNoIGFzIGEgc3luYyBsb29wIGFuZCBjb21wYXJlLlxuICpcbiAqL1xuXG4vKipcbiAqIFN1Y2Nlc3MgYmxvY2sgcmV0dXJuIG9iamVjdCwgY29udGFpbnMgYSBtZXNzYWdlIGFuZCBvcHRpb25hbCBkYXRhIG9iamVjdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSAtIHRoZSBzdWNjZXNzIG1lc3NhZ2VcbiAqIEBwYXJhbSB7c3RyaW5nfE9iamVjdH0gW2RhdGFdIC0gdGhlIHN1Y2Nlc3MgcmV0dXJuZWQgZGF0YVxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBSZXR1cm4gc3VjY2VzcyB3aXRob3V0IGEgZGF0YSBibG9ja1xuICogdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1N1Y2Nlc3MgbWVzc2FnZSBnb2VzIGhlcmUuLi4nKTtcbiAqXG4gKiBAcmV0dXJuIHtPYmplY3R9IC0gd2l0aCBtZXNzYWdlIGFuZCBkYXRhIHByb3BlcnRpZXNcbiAqXG4gKi9cbmZ1bmN0aW9uIHN1Y2Nlc3MobWVzc2FnZSwgZGF0YSl7XG5cdHJldHVybiB7XG5cdFx0bWVzc2FnZTogbWVzc2FnZSxcblx0XHRkYXRhOiBkYXRhXG5cdH07XG59O1xuXG4vKipcbiAqIFdhcm5pbmcgYmxvY2sgcmV0dXJuIG9iamVjdCwgY29udGFpbnMgYSBtZXNzYWdlIGFuZCBvcHRpb25hbCBkYXRhIG9iamVjdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSAtIHRoZSB3YXJuaW5nIG1lc3NhZ2VcbiAqIEBwYXJhbSB7c3RyaW5nfE9iamVjdH0gW2RhdGFdIC0gdGhlIHJldHVybmVkIGRhdGFcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gUmV0dXJuIHN1Y2Nlc3Mgd2l0aG91dCBhIGRhdGEgYmxvY2tcbiAqIHZhciBzdWNjZXNzID0gdXRpbC53YXJuKCdXYXJuaW5nIG1lc3NhZ2UgZ29lcyBoZXJlLi4uJyk7XG4gKlxuICogQHJldHVybiB7T2JqZWN0fSB3aXRoIG1lc3NhZ2UgYW5kIGRhdGEgcHJvcGVydGllcywgYW5kIGxvZ3MgdGhlIHdhcm5pbmcgdG8gdGhlIGNvbnNvbGUuXG4gKlxuICovXG5mdW5jdGlvbiB3YXJuKG1lc3NhZ2UsIGRhdGEpe1xuXHRjb25zb2xlLndhcm4oZGF0YSk7XG5cdHJldHVybiB7XG5cdFx0d2FybmluZzogbWVzc2FnZSxcblx0XHRkYXRhOiBkYXRhXG5cdH07XG59O1xuXG4vKipcbiAqIEVycm9yIGJsb2NrIEpTIGVycm9yIG9iamVjdCwgY29udGFpbnMgYSBjb2RlIGFuZCBtZXNzYWdlIGZvciB0aGUgZXJyb3IuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGNvZGUgLSB0aGUgZXJyb3IgY29kZVxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2UgLSB0aGUgZXJyb3IgbWVzc2FnZVxuICpcbiAqIEBleGFtcGxlXG4gKiB2YXIgc3VjY2VzcyA9IHV0aWwuZXJyb3IoJ0Vycm9yMDAxJywnRXJyb3IgbWVzc2FnZSBnb2VzIGhlcmUuLi4nKTtcbiAqXG4gKiBAcmV0dXJuIHtPYmplY3R9IHdpdGggYSBjb2RlIGFuZCBtZXNzYWdlIHByb3BlcnRpZXMuXG4gKlxuICovXG5mdW5jdGlvbiBlcnJvcihjb2RlLCBtZXNzYWdlKXtcblx0dmFyIGVyciA9IG5ldyBFcnJvcignJyk7XG5cdGVyci5uYW1lID0gY29kZTtcblx0ZXJyLm1lc3NhZ2UgPSBtZXNzYWdlO1xuXHRyZXR1cm4gZXJyO1xufTtcblxuLyoqXG4gKiBBIGxvb3Agd2hpY2ggY2FuIGxvb3AgWCBhbW91bnQgb2YgdGltZXMsIHdoaWNoIGNhcnJpZXMgb3V0XG4gKiBhc3luY2hyb25vdXMgY29kZSwgYnV0IHdhaXRzIGZvciB0aGF0IGNvZGUgdG8gY29tcGxldGUgYmVmb3JlIGxvb3BpbmcuXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IGl0ZXJhdGlvbnMgLSB0aGUgbnVtYmVyIG9mIGl0ZXJhdGlvbnMgdG8gY2Fycnkgb3V0XG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBwcm9jZXNzIC0gdGhlIGNvZGUvZnVuY3Rpb24gd2UncmUgcnVubmluZyBmb3IgZXZlcnlcbiAqIGl0ZXJhdGlvblxuICogQHBhcmFtIHtmdW5jdGlvbn0gZXhpdCAtIGFuIG9wdGlvbmFsIGNhbGxiYWNrIHRvIGNhcnJ5IG91dCBvbmNlIHRoZSBsb29wXG4gKiBoYXMgY29tcGxldGVkXG4gKlxuICogQGV4YW1wbGVcbiAqIHV0aWwuc3luY0xvb3AoNSwgZnVuY3Rpb24obG9vcCl7XG4gKiBcdHZhciBjb3VudGVyID0gbG9vcC5pdGVyYXRpb24oKTtcbiAqIFx0Ly8gQWRkIGFzeW5jIGNhbGxzIGhlcmUuLlxuICpcbiAqIH0sIGZ1bmN0aW9uKCl7XG4gKiBcdC8vIE9uIGNvbXBsZXRlIHBlcmZvcm0gYWN0aW9ucyBoZXJlLi4uXG4gKlxuICogfSk7XG4gKlxuICogQHJldHVybiB7T2JqZWN0fSB0aGUgbG9vcCBjb250cm9sIG9iamVjdC5cbiAqXG4gKi9cbmZ1bmN0aW9uIHN5bmNMb29wKGl0ZXJhdGlvbnMsIHByb2Nlc3MsIGV4aXQpe1xuICAgIHZhciBpbmRleCA9IDAsXG4gICAgICAgIGRvbmUgPSBmYWxzZSxcbiAgICAgICAgc2hvdWxkRXhpdCA9IGZhbHNlO1xuICAgIHZhciBsb29wID0ge1xuICAgICAgICBuZXh0OmZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBpZihkb25lKXtcbiAgICAgICAgICAgICAgICBpZihzaG91bGRFeGl0ICYmIGV4aXQpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXhpdCgpOyAvLyBFeGl0IGlmIHdlJ3JlIGRvbmVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBJZiB3ZSdyZSBub3QgZmluaXNoZWRcbiAgICAgICAgICAgIGlmKGluZGV4IDwgaXRlcmF0aW9ucyl7XG4gICAgICAgICAgICAgICAgaW5kZXgrKzsgLy8gSW5jcmVtZW50IG91ciBpbmRleFxuICAgICAgICAgICAgICAgIHByb2Nlc3MobG9vcCk7IC8vIFJ1biBvdXIgcHJvY2VzcywgcGFzcyBpbiB0aGUgbG9vcFxuICAgICAgICAgICAgLy8gT3RoZXJ3aXNlIHdlJ3JlIGRvbmVcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZG9uZSA9IHRydWU7IC8vIE1ha2Ugc3VyZSB3ZSBzYXkgd2UncmUgZG9uZVxuICAgICAgICAgICAgICAgIGlmKGV4aXQpIGV4aXQoKTsgLy8gQ2FsbCB0aGUgY2FsbGJhY2sgb24gZXhpdFxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBpdGVyYXRpb246ZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHJldHVybiBpbmRleCAtIDE7IC8vIFJldHVybiB0aGUgbG9vcCBudW1iZXIgd2UncmUgb25cbiAgICAgICAgfSxcbiAgICAgICAgYnJlYWs6ZnVuY3Rpb24oZW5kKXtcbiAgICAgICAgICAgIGRvbmUgPSB0cnVlOyAvLyBFbmQgdGhlIGxvb3BcbiAgICAgICAgICAgIHNob3VsZEV4aXQgPSBlbmQ7IC8vIFBhc3NpbmcgZW5kIGFzIHRydWUgbWVhbnMgd2Ugc3RpbGwgY2FsbCB0aGUgZXhpdCBjYWxsYmFja1xuICAgICAgICB9XG4gICAgfTtcbiAgICBsb29wLm5leHQoKTtcbiAgICByZXR1cm4gbG9vcDtcbn07XG5cbmZ1bmN0aW9uIGNvbXBhcmUoc3ViamVjdCwgb3BlcmF0b3IsIHZhbHVlKSB7XG4gIFx0c3dpdGNoIChvcGVyYXRvcikge1xuICBcdFx0Y2FzZSAnZ3JlYXRlclRoYW4nOlxuXHRcdFx0cmV0dXJuIHN1YmplY3QgPiB2YWx1ZTtcblx0XHRjYXNlICdsZXNzVGhhbic6XG5cdFx0XHRyZXR1cm4gc3ViamVjdCA8IHZhbHVlO1xuXHRcdGNhc2UgJ2dyZWF0ZXJUaGFuRXF1YWwnOlxuXHRcdFx0cmV0dXJuIHN1YmplY3QgPj0gdmFsdWU7XG5cdFx0Y2FzZSAnbGVzc1RoYW5FcXVhbCc6XG5cdFx0XHRyZXR1cm4gc3ViamVjdCA8PSB2YWx1ZTtcblx0XHRjYXNlICdlcXVhbFRvJzpcblx0XHRcdHJldHVybiBzdWJqZWN0ID09PSB2YWx1ZTtcblx0XHRjYXNlICdub3RFcXVhbFRvJzpcblx0XHRcdHJldHVybiBzdWJqZWN0ICE9PSB2YWx1ZTtcbiAgXHR9XG59O1xuXG5mdW5jdGlvbiBnZXROYW1lKGFyciwgbGFuZyl7XG5cdGlmIChhcnIgIT09IHVuZGVmaW5lZCkge1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aCA7IGkrKykge1xuXHRcdFx0aWYgKGFycltpXS5pMThuLl9sYW5nID09PSBsYW5nKSB7XG5cdFx0XHRcdHJldHVybiBhcnJbaV0uaTE4bi52YWx1ZTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG5cbiBcdHN1Y2Nlc3M6IHN1Y2Nlc3MsXG4gXHR3YXJuOiB3YXJuLFxuIFx0ZXJyb3I6IGVycm9yLFxuIFx0c3luY0xvb3A6IHN5bmNMb29wLFxuIFx0Y29tcGFyZTogY29tcGFyZSxcblx0Z2V0TmFtZTogZ2V0TmFtZVxuXG4gfVxuIl19
