(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Workflow = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function Workflow(e,r,i,s){var o=this;if(""===e||void 0===e)throw new Error("A profile id is required.");if("string"!=typeof e)throw new Error("The profile id must be a javascript string.");if(o.profile=e||"",""===r||void 0===r)throw new Error("An app id is required.");if("string"!=typeof r)throw new Error("The app id must be a javascript string.");if(o.app=r||"",""===i||void 0===i)throw new Error("A workflow configuration is required.");"object"!=typeof i?o.config=JSON.parse(i):o.config=i,o.instance=s}var Process=require("./lib/process"),util=require("./lib/utility");Workflow.prototype.create=function(){var e=this;return new Promise(function(r,i){try{if(void 0!==e.instance){var s=util.warn("Instance already exists.",e.instance);r(s)}else{var o={_id:"",version:"",type:"workflowInstance",processes:[]};o._id=e.profile+":processes",o.version=e.config.version,e.instance=o;var t=util.success("Workflow processes instance created successfully.",e.instance);r(t)}}catch(n){i(n)}})},Workflow.prototype.initialise=function(e,r){var i=this;return new Promise(function(s,o){try{var t=[];if(""!==e&&void 0!==e){if(t=i.config.processes.filter(function(r){return r._id===e?r:void 0}),void 0===t[0]._id){var n=util.error("WFConfigError","No valid process definition found with process id: "+e);o(n)}}else t.push(i.config.processes[0]),e=i.config.processes[0]._id;var c=[];c=i.instance.processes.filter(function(r){return r.id===e?r:void 0});var f=c.length,u=f+1,a={id:"",seq:"",subProcesses:[]};a.id=e,a.seq=u,i.instance.processes.push(a),Process.preRequisites(t[0].prerequisites,i).then(function(n){Process.preActions(t[0].preActions,i).then(function(n){Process.subProcess(e,t[0].subProcesses[0],1,r,i).then(function(e){i.instance=e.res;var r=util.success("Process: "+i.config.processes[0]._id+" initialized successfully.");s(r)},function(e){o(e)})},function(e){o(e)})},function(e){o(e)})}catch(p){o(p)}})},Workflow.prototype.task=function(e,r){return new Promise(function(e,r){try{e("Success")}catch(i){r(i)}})},Workflow.prototype.transition=function(e,r,i,s,o){var t=this;return new Promise(function(n,c){try{Process.transition(e,r,i,s,o,t).then(function(e){var r=util.success("Workflow transitioned to the next step successfully.",{});n(r)},function(e){c(e)})}catch(f){c(f)}})},module.exports=Workflow;

},{"./lib/process":3,"./lib/utility":4}],2:[function(require,module,exports){
"use strict";function create(e,s){var t=[];return new Promise(function(r,u){util.syncLoop(e.indicators.length,function(r){var u=r.iteration(),c=e.indicators[u]._id,i=e.indicators[u].name.i18n.value,o=s.profile+":"+s.app+":"+c+":0",n={_id:o,category:{term:c,label:i},processes:[]};t.push(n),r.next()},function(){var e=util.success("Form created successfully.",t);r(e)})})}function save(e){var s={complete:!0,data:[]};return new Promise(function(e,t){var r=util.success("Form indicator set saved successfully.",s);e(r)})}function submit(e){var s={complete:!0,data:[]};return new Promise(function(e,t){var r=util.success("Form submitted successfully.",s);e(r)})}function authorise(e){var s={complete:!0,data:[]};return new Promise(function(e,t){var r=util.success("Form authorised successfully.",s);e(r)})}function close(e){var s={complete:!0,data:[]};return new Promise(function(e,t){var r=util.success("Form closed successfully.",s);e(r)})}var util=require("./utility");module.exports={create:create,save:save,submit:submit,authorise:authorise,close:close};

},{"./utility":4}],3:[function(require,module,exports){
"use strict";function preRequisites(e){return new Promise(function(e,t){var s=util.success("Pre-requisites completed successfully.",{});e(s)})}function preRequisite(e,t,s){return new Promise(function(t,s){switch(e._type){case"count":var i={},n=util.success("Mock count successfull.",i);t(n);break;default:var r=util.error("WFPreRequisiteError","Pre-requisite type: "+e._type+" not defined.");s(r)}})}function preActions(e,t){return new Promise(function(e,t){var s=util.success("Pre-actions completed successfully.",{});e(s)})}function subProcess(e,t,s,i,n){return new Promise(function(r,o){var a={id:t._id,seq:s,initiated:!1,dates:{created:"",valid:"",due:"",closed:""},complete:!1,indicators:[],step:{}};try{initiate(t.initiate,i).then(function(s){a.initiated=!0,a.dates.created=s.data.createdDate,a.dates.valid=s.data.validDate,a.dates.due=s.data.dueDate;var c=n.instance.processes.length;n.instance.processes.filter(function(t){t.id===e&&t.seq===c&&t.subProcesses.push(a)});var u={id:t._id,name:t.name.i18n.value,indicators:t.indicators};step(e,t._id,t.steps[0]._id,0,u,i,n).then(function(e){var t=util.success("Sub-Process completed successfully.",n.instance);r(t)},function(e){o(e)})},function(e){o(e)})}catch(c){o(c)}})}function initiate(e,t){var s={complete:!1};return new Promise(function(i,n){switch(e._type){case"user":if(s.createdDate=t.createdDate,"userSelected"===e.dates.valid._type)if(void 0!==t.validDate)s.validDate=t.validDate;else{var r=util.error("WFInitiateError","No valid date passed in - {inputData.validDate}");n(r)}if("userSelected"===e.dates.due._type)if(void 0!==t.dueDate)s.dueDate=t.dueDate;else{var r=util.error("WFInitiateError","No due date passed in - {inputData.dueDate}");n(r)}s.complete=!0;var o=util.success("Sub-Process initiate completed successfully.",s);i(o);break;default:var r=util.error("WFInitiateError","Initiate type: "+e._type+" not defined.");n(r)}})}function step(e,t,s,i,n,r,o){return new Promise(function(a,c){var u={id:"",seq:"",status:"",message:"",assignedTo:{userId:"",name:""}};try{var d={};o.config.processes.filter(function(i){i._id===e&&i.subProcesses.filter(function(e){e._id===t&&e.steps.filter(function(e){e._id===s&&(d=e)})})}),u.id=s,u.seq=i,u.status=d._setInstanceStatusTo,u.message=d._setStatusMsgTo,u.assignedTo.userId=r.userId,u.assignedTo.name=r.name;var l=o.instance.processes.length;if(o.instance.processes.filter(function(s){s.id===e&&s.seq===l&&s.subProcesses.filter(function(e){e.id===t&&(e.step=u)})}),void 0!==d.actions[0])actions(d.actions,n,o).then(function(n){({id:s,seq:i,startDate:r.createdDate,status:d._setInstanceStatusTo,message:d._setStatusMsgTo,assignedTo:{userId:r.userId,name:r.name},comment:r.comment,complete:!1,endDate:""});util.syncLoop(n.res.data[0].form.indicators.length,function(e){var t=e.iteration();({id:n.res.data[0].form.indicators[t].category.term,instances:[{uuid:n.res.data[0].form.indicators[t]._id,key:"",seq:1}]});e.next()},function(){if(0!==d.actions[0].transitions.length)util.syncLoop(d.actions[0].transitions.length,function(i){var n=i.iteration();transition(e,t,s,d.actions[0].transitions[n]._id,r,o).then(function(e){var t=util.success("Transition step completed successfully.",{});a(t)},function(e){c(e),i["break"]()}),i.next()});else{var i=util.success("No transitions specified in this step.",{});a(i)}})},function(e){c(e)});else if(void 0!==d.task){var f=util.success("Task awaiting user action.",{});a(f)}}catch(p){c(p)}})}function actions(e,t,s){var i=[],n={completed:!0,data:[]};return new Promise(function(r,o){util.syncLoop(e.length,function(r){var a=r.iteration();action(e[a],t,s).then(function(e){i.push(e.complete),n.data.push(e.res),r.next()},function(e){o(e),r["break"]()})},function(){if(i.every(Boolean)){n.completed=!0;var e=util.success("Actions completed successfully.",n);r(e)}else{n.completed=!1;util.error("WFActionsError","Action/s for sub-process: "+t.id+" did not complete succeffully.");o(e)}})})}function action(e,t,s){return new Promise(function(i,n){switch(e._id){case"createForm":form.create(t,s).then(function(s){var n={transitions:[],form:{id:t.id,indicators:[]}};n.transitions=e.transitions,n.form.indicators=s.res;var r=util.success(s.message,n);i(r)},function(e){n(e)});break;case"authoriseForm":form.authorise(t,s).then(function(s){var n={transitions:[],form:{id:t.id,indicators:[]}};n.transitions=e.transitions;var r=util.success(s.message,n);i(r)},function(e){n(e)});break;case"closeForm":form.close(t,s).then(function(s){var n={transitions:[],form:{id:t.id,indicators:[]}};n.transitions=e.transitions;var r=util.success(s.message,n);i(r)},function(e){n(e)});break;default:var r=util.error("WFActionError","Action defined with id: "+e._id+" not found.");n(r)}})}function task(e){return"Implementation pending.."}function transition(e,t,s,i,n,r){return new Promise(function(o,a){try{var c=0,u="",d={},l=r.config.processes.filter(function(t){return t._id===e?t:void 0}),f=l[0].subProcesses.filter(function(e){return e._id===t?e:void 0}),p=f[0].steps.filter(function(e){return e._id===s?e:void 0});d=void 0!==p[0].actions[0]?p[0].actions[0].transitions.filter(function(e){return e._id===i?e:void 0}):p[0].task.transitions.filter(function(e){return e._id===i?e:void 0});for(var m=0;m<f[0].steps.length;m++)f[0].steps[m]._id===s&&(c=m);for(var m=0;m<f[0].steps.length;m++){var v=c+1;m===v&&(u=f[0].steps[m]._id)}switch(d[0]._type){case"auto":if("nextStep"===d[0].goTo._type)step(e,t,u,c,{},n,r).then(function(e){var t=util.success("Step transition completed successfully.",e.data);o(t)},function(e){a(e)});else if(d[0]._stop===!0){var h=util.success("All Step transitions have completed successfully.",{});o(h)}break;case"user":if("nextStep"===d[0].goTo._type)step(e,t,u,c,{},n,r).then(function(e){var t=util.success("Step transition completed successfully.",e.data);o(t)},function(e){a(e)});else if("stepId"===d[0].goTo._type){for(var _=d[0].goTo._stepId,y=1,m=0;m<f[0].steps.length;m++)f[0].steps[m]._id===_&&(y=m+1);step(e,t,_,y,{},n,r).then(function(e){var t=util.success("Step transition completed successfully.",e.data);o(t)},function(e){a(e)})}else if(d[0]._stop===!0){var h=util.success("All Step transitions have completed successfully.",{});o(h)}break;default:if(d[0]._stop===!0){var h=util.success("All Step transitions have completed successfully.",{});o(h)}else{var g=util.error("WF005","");a(g)}}}catch(P){a(P)}})}function postActions(e){return"Implementation pending.."}var util=require("./utility"),form=require("./form");module.exports={preRequisites:preRequisites,preActions:preActions,subProcess:subProcess,task:task,transition:transition};

},{"./form":2,"./utility":4}],4:[function(require,module,exports){
"use strict";module.exports={success:function(r,n){var e={message:r,data:n};return e},warn:function(r,n){var e={warning:r,data:n};return console.warn(n),e},error:function(r,n){var e=new Error("");return e.name=r,e.message=n,e},syncLoop:function(r,n,e){var a=0,t=!1,u=!1,s={next:function(){return t&&u&&e?e():void(r>a?(a++,n(s)):(t=!0,e&&e()))},iteration:function(){return a-1},"break":function(r){t=!0,u=r}};return s.next(),s},compare:function(r,n,e){switch(n){case"greaterThan":return r>e;case"lessThan":return e>r;case"greaterThanEqual":return r>=e;case"lessThanEqual":return e>=r;case"equalTo":return r===e;case"notEqualTo":return r!==e}}};

},{}]},{},[1])(1)
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Vzci9sb2NhbC9saWIvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi9Vc2Vycy9icmVudGdvcmRvbjAxL2FwcHMvd29ya2Zsb3cvaW5kZXguanMiLCIvVXNlcnMvYnJlbnRnb3Jkb24wMS9hcHBzL3dvcmtmbG93L2xpYi9mb3JtLmpzIiwiL1VzZXJzL2JyZW50Z29yZG9uMDEvYXBwcy93b3JrZmxvdy9saWIvcHJvY2Vzcy5qcyIsIi9Vc2Vycy9icmVudGdvcmRvbjAxL2FwcHMvd29ya2Zsb3cvbGliL3V0aWxpdHkuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQSxZQStCQSxTQUFTLFVBQVMsRUFBUyxFQUFLLEVBQVEsR0FFdkMsR0FBSSxHQUFRLElBRVosSUFBZ0IsS0FBWixHQUE4QixTQUFaLEVBQ2YsS0FBTSxJQUFJLE9BQU0sNEJBQ2IsSUFBd0IsZ0JBQWQsR0FDaEIsS0FBTSxJQUFJLE9BQU0sOENBS3BCLElBSEksRUFBTSxRQUFVLEdBQVcsR0FHbkIsS0FBUixHQUFzQixTQUFSLEVBQ1gsS0FBTSxJQUFJLE9BQU0seUJBQ2IsSUFBb0IsZ0JBQVYsR0FDaEIsS0FBTSxJQUFJLE9BQU0sMENBS2pCLElBSEMsRUFBTSxJQUFNLEdBQU8sR0FHTCxLQUFYLEdBQTRCLFNBQVgsRUFDcEIsS0FBTSxJQUFJLE9BQU0sd0NBQ2EsaUJBQWIsR0FDYixFQUFNLE9BQVMsS0FBSyxNQUFNLEdBRTdCLEVBQU0sT0FBUyxFQUdoQixFQUFNLFNBQVcsRUF6RHJCLEdBQUksU0FBVSxRQUFRLGlCQUVsQixLQUFPLFFBQVEsZ0JBb0VuQixVQUFTLFVBQVUsT0FBUyxXQUUzQixHQUFJLEdBQVEsSUFDWixPQUFPLElBQUksU0FBUSxTQUFTLEVBQVMsR0FFcEMsSUFDQyxHQUF1QixTQUFuQixFQUFNLFNBQXdCLENBQ2pDLEdBQUksR0FBTyxLQUFLLEtBQUssMkJBQTRC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TUFBTywyQkF4bkJSLEdBQUksTUFBTyxRQUFRLGFBQ2YsS0FBTyxRQUFRLFNBMG5CbkIsUUFBTyxTQUVMLGNBQWUsY0FDZixXQUFZLFdBQ1osV0FBWSxXQUNaLEtBQU0sS0FDTixXQUFZOzs7QUNub0JkLFlBYUMsUUFBTyxTQUVOLFFBQVMsU0FBUyxFQUFTLEdBQzNCLEdBQUksSUFDSCxRQUFTLEVBQ1QsS0FBTSxFQUVQLE9BQU8sSUFHUixLQUFNLFNBQVMsRUFBUyxHQUN2QixHQUFJLElBQ0gsUUFBUyxFQUNULEtBQU0sRUFHUCxPQURBLFNBQVEsS0FBSyxHQUNOLEdBR1IsTUFBTyxTQUFTLEVBQU0sR0FDckIsR0FBSSxHQUFNLEdBQUksT0FBTSxHQUdwQixPQUZBLEdBQUksS0FBTyxFQUNYLEVBQUksUUFBVSxFQUNQLEdBR1AsU0FBVSxTQUFTLEVBQVksRUFBUyxHQUNyQyxHQUFJLEdBQVEsRUFDUixHQUFPLEVBQ1AsR0FBYSxFQUNiLEdBQ0EsS0FBSyxXQUNELE1BQUcsSUFDSSxHQUFjLEVBQ04sU0FJSixFQUFSLEdBQ0MsSUFDQSxFQUFRLEtBR1IsR0FBTyxFQUNKLEdBQU0sT0FHakIsVUFBVSxXQUNOLE1BQU8sR0FBUSxHQUVuQixRQUFNLFNBQVMsR0FDWCxHQUFPLEVBQ1AsRUFBYSxHQUlyQixPQURBLEdBQUssT0FDRSxHQUdYLFFBQVMsU0FBUyxFQUFTLEVBQVUsR0FDbEMsT0FBUSxHQUNQLElBQUssY0FDTixNQUFPLEdBQVUsQ0FDbEIsS0FBSyxXQUNKLE1BQWlCLEdBQVYsQ0FDUixLQUFLLG1CQUNKLE1BQU8sSUFBVyxDQUNuQixLQUFLLGdCQUNKLE1BQWtCLElBQVgsQ0FDUixLQUFLLFVBQ0osTUFBTyxLQUFZLENBQ3BCLEtBQUssYUFDSixNQUFPLEtBQVkiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgUHJvY2VzcyA9IHJlcXVpcmUoJy4vbGliL3Byb2Nlc3MnKTtcblxudmFyIHV0aWwgPSByZXF1aXJlKCcuL2xpYi91dGlsaXR5Jyk7XG5cbi8qZ2xvYmFscyAqL1xuXG4vKiogXG4gKiBLd2FudHUgd29ya2Zsb3cgZW5naW5lXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvZmlsZSAtIFByb2ZpbGUgVVVJRFxuICogQHBhcmFtIHtPYmplY3R9IFtjb25maWddIC0gV29ya2Zsb3cgY29uZmlndXJhdGlvblxuICogXHRAcGFyYW0ge3N0cmluZ30gY29uZmlnLl9pZCBcbiAqXHRXb3JrZmxvdyBjb25maWd1cmF0aW9uIC8gZGVmaW5pdGlvbiBJRFxuICogQHBhcmFtIHtPYmplY3R9IFtpbnN0YW5jZV0gLSBXb3JrZmxvdyBpbnN0YW5jZVxuICogXHRAcGFyYW0ge3N0cmluZ30gaW5zdGFuY2UuX2lkIFxuICpcdFdvcmtmbG93IGluc3RhbmNlIElEXG4gKiBAYXV0aG9yIEJyZW50IEdvcmRvblxuICogQHZlcnNpb24gMC4xLjBcbiAqXG4gKiBAZXhhbXBsZSBuZXcgV29ya2Zsb3coJzEyMzQnLCB7fSlcbiAqIFxuICpcbiAqIEByZXR1cm4ge09iamVjdH0gbmV3IFdvcmtmbG93IG9iamVjdFxuICpcbiAqIEB0aHJvd3MgXCJFUlJPUjogTWVzc2FnZVwiXG4gKlxuICovXG5cbmZ1bmN0aW9uIFdvcmtmbG93KHByb2ZpbGUsIGFwcCwgY29uZmlnLCBpbnN0YW5jZSl7XG5cdC8vXG5cdHZhciBfdGhpcyA9IHRoaXM7XG5cdC8vIFByb2ZpbGUgSUQgdmFsaWRhdGlvbiBjaGVja3Ncblx0aWYgKHByb2ZpbGUgPT09ICcnIHx8IHByb2ZpbGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0EgcHJvZmlsZSBpZCBpcyByZXF1aXJlZC4nKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZihwcm9maWxlKSAhPT0gJ3N0cmluZycpIHtcbiAgICBcdHRocm93IG5ldyBFcnJvcignVGhlIHByb2ZpbGUgaWQgbXVzdCBiZSBhIGphdmFzY3JpcHQgc3RyaW5nLicpO1xuICAgIH0gZWxzZSB7XG4gICAgXHRfdGhpcy5wcm9maWxlID0gcHJvZmlsZSB8fCAnJztcbiAgICB9XG4gICAgLy8gQXBwIElEIHZhbGlkYXRpb24gY2hlY2tzXG5cdGlmIChhcHAgPT09ICcnIHx8IGFwcCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQW4gYXBwIGlkIGlzIHJlcXVpcmVkLicpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mKGFwcCkgIT09ICdzdHJpbmcnKSB7XG4gICAgXHR0aHJvdyBuZXcgRXJyb3IoJ1RoZSBhcHAgaWQgbXVzdCBiZSBhIGphdmFzY3JpcHQgc3RyaW5nLicpO1xuICAgIH0gZWxzZSB7XG4gICAgXHRfdGhpcy5hcHAgPSBhcHAgfHwgJyc7XG4gICAgfVxuICAgIC8vIFdvcmtmbG93IGNvbmZpZ3VyYXRpb24gdmFsaWRhdGlvbiBjaGVja3NcbiAgICBpZiAoY29uZmlnID09PSAnJyB8fCBjb25maWcgPT09IHVuZGVmaW5lZCkge1xuICAgIFx0dGhyb3cgbmV3IEVycm9yKCdBIHdvcmtmbG93IGNvbmZpZ3VyYXRpb24gaXMgcmVxdWlyZWQuJyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YoY29uZmlnKSAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgX3RoaXMuY29uZmlnID0gSlNPTi5wYXJzZShjb25maWcpO1xuICAgIH0gZWxzZSB7XG4gICAgXHRfdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgfVxuICAgIC8vIFdvcmtmbG93IGluc3RhbmNlIHZhbGlkYXRpb24gY2hlY2tzXG4gICAgX3RoaXMuaW5zdGFuY2UgPSBpbnN0YW5jZTtcbn1cblxuLyoqIFxuICogQ3JlYXRlIGEgbmV3IHdvcmtmbG93IHByb2Nlc3MuXG4gKlxuICogQGV4YW1wbGUgXG4gKiBXb3JrZmxvdy5jcmVhdGUoKTtcbiAqXG4gKiBAcmV0dXJuIFN1Y2Nlc3MgLyBlcnJvciBtZXNzYWdlIHdpdGggdGhlIG5ld2x5IGNyZWF0ZWQgd29ya2Zsb3cgcHJvY2Vzc2VzXG4gKiBpbnN0YW5jZSBkYXRhLlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uKCl7XG5cdC8vIFJlLWFzc2lnbiB0aGUgV29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2UgYXMgX3RoaXNcblx0dmFyIF90aGlzID0gdGhpcztcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdC8vIFRyeSB0aGUgYmxvY2sgb2YgY29kZVxuXHRcdHRyeSB7XG5cdFx0XHRpZiAoX3RoaXMuaW5zdGFuY2UgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHR2YXIgd2FybiA9IHV0aWwud2FybignSW5zdGFuY2UgYWxyZWFkeSBleGlzdHMuJywgX3RoaXMuaW5zdGFuY2UpXG5cdFx0XHRcdHJlc29sdmUod2Fybik7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBDcmVhdGUgdGhlIHdvcmtmbG93IHByb2Nlc3NlcyBpbnN0YW5jZSBvYmplY3Rcblx0XHRcdFx0dmFyIG1vZGVsID0ge1xuXHRcdFx0XHQgICAgX2lkOiBcIlwiLFxuXHRcdFx0XHQgICAgdmVyc2lvbjogXCJcIixcblx0XHRcdFx0ICAgIHR5cGU6IFwid29ya2Zsb3dJbnN0YW5jZVwiLFxuXHRcdFx0XHQgICAgcHJvY2Vzc2VzOiBbXVxuXHRcdFx0XHR9O1xuXHRcdFx0XHRtb2RlbC5faWQgPSBfdGhpcy5wcm9maWxlICsgJzpwcm9jZXNzZXMnO1xuXHRcdFx0XHRtb2RlbC52ZXJzaW9uID0gX3RoaXMuY29uZmlnLnZlcnNpb247XG5cdFx0XHRcdF90aGlzLmluc3RhbmNlID0gbW9kZWw7XG5cdFx0XHRcdHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrZmxvdyBwcm9jZXNzZXMgaW5zdGFuY2UgY3JlYXRlZCBzdWNjZXNzZnVsbHkuJywgX3RoaXMuaW5zdGFuY2UpO1xuXHRcdFx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdFx0fVxuXHRcdC8vIENhdGNoIGFueSB1bmZvcnNlZW4gZXJyb3JzXG5cdFx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0XHRyZWplY3QoZXJyKTtcblx0XHR9XG5cdH0pO1xufTtcblxuLyoqIFxuICogV29ya2Zsb3cgaW5pdGlhbGlzZSwgdGhpcyBmdW5jdGlvbiBleGVjdXRlcyBhIHByb2Nlc3Mgd2l0aGluIGEgd29ya2Zsb3dcbiAqIGNvbmZpZ3VyYXRpb24uXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBwcm9jZXNzIGlkIHRvIHByb2Nlc3NcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gdGhlIGlucHV0IGRhdGEgdG8gcHJvY2Vzc1xuICpcbiAqIEBleGFtcGxlIFxuICogV29ya2Zsb3cuaW5pdGlhbGl6ZSgncHJvY2Vzc0lkJywgeyB2YWxpZERhdGU6ICdkYXRlJyB9KTtcbiAqXG4gKiBAcmV0dXJuIFxuICogeyBjb21wbGV0ZTogdHJ1ZSwgbWVzc2FnZTogJ1Byb2Nlc3M6ICdwcm9jZXNzSWQnIGluaXRpYWxpemVkIHN1Y2Nlc3NmdWxseS4nLCByZXM6IHVuZGVmaW5lZCB9XG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuaW5pdGlhbGlzZSA9IGZ1bmN0aW9uKHByb2Nlc3NJZCwgZGF0YSl7XG5cdC8vIFJlLWFzc2lnbiB0aGUgV29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2UgYXMgX3RoaXNcblx0dmFyIF90aGlzID0gdGhpcztcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdHRyeSB7XG5cdFx0XHR2YXIgY29uZmlnUHJvY2VzcyA9IFtdO1xuXHRcdFx0Ly8gQ2hlY2sgdGhlIHBhc3NlZCBpbiBwYXJhbWV0ZXJzXG5cdFx0XHRpZiAocHJvY2Vzc0lkICE9PSAnJyAmJiBwcm9jZXNzSWQgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHQvLyBHZXQgdGhlIGN1cnJlbnQgcHJvY2VzcyBjb25maWdcblx0XHRcdFx0Y29uZmlnUHJvY2VzcyA9IF90aGlzLmNvbmZpZy5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialByb2Nlc3Mpe1xuXHRcdFx0XHRcdGlmIChvYmpQcm9jZXNzLl9pZCA9PT0gcHJvY2Vzc0lkKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gb2JqUHJvY2Vzcztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpZiAoY29uZmlnUHJvY2Vzc1swXS5faWQgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGQ29uZmlnRXJyb3InLCAnTm8gdmFsaWQgcHJvY2VzcyBkZWZpbml0aW9uIGZvdW5kIHdpdGggcHJvY2VzcyBpZDogJyArIHByb2Nlc3NJZCk7XG5cdFx0XHRcdFx0cmVqZWN0KGVycm9yKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uZmlnUHJvY2Vzcy5wdXNoKF90aGlzLmNvbmZpZy5wcm9jZXNzZXNbMF0pO1xuXHRcdFx0XHRwcm9jZXNzSWQgPSBfdGhpcy5jb25maWcucHJvY2Vzc2VzWzBdLl9pZDtcblx0XHRcdH1cblx0XHRcdC8vIEdldCB0aGUgY3VycmVudCBsaXN0IG9mIHByb2Nlc3MgaW5zdGFuY2VzXG5cdFx0XHR2YXIgcHJvY2Vzc1NlcSA9IDE7XG5cdFx0XHR2YXIgY3VycmVudFByb2Nlc3MgPSBbXTtcblx0XHRcdGN1cnJlbnRQcm9jZXNzID0gX3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpQcm9jZXNzKXtcblx0XHRcdFx0aWYgKG9ialByb2Nlc3MuaWQgPT09IHByb2Nlc3NJZCkge1xuXHRcdFx0XHRcdHJldHVybiBvYmpQcm9jZXNzO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdHZhciBjdXJyZW50U2VxID0gY3VycmVudFByb2Nlc3MubGVuZ3RoO1xuXHRcdFx0dmFyIG5leHRTZXEgPSBjdXJyZW50U2VxICsgMTtcblx0XHRcdC8vIFB1c2ggdGhlIHByb2Nlc3Mgb2JqZWN0IGludG8gdGhlIGFycmF5XG5cdFx0XHR2YXIgcHJvY2Vzc01vZGVsID0ge1xuXHRcdFx0XHRcImlkXCI6IFwiXCIsIFxuXHRcdCAgICAgIFx0XCJzZXFcIjogXCJcIiwgXG5cdFx0ICAgICAgXHRcInN1YlByb2Nlc3Nlc1wiOiBbXVxuXHRcdFx0fVxuXHRcdFx0Ly8gMS4gVXBkYXRlIHRoZSBwcm9jZXNzIGlkIGFuZCBzZXFcblx0XHRcdHByb2Nlc3NNb2RlbC5pZCA9IHByb2Nlc3NJZDtcblx0XHRcdHByb2Nlc3NNb2RlbC5zZXEgPSBuZXh0U2VxO1xuXHRcdFx0X3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzLnB1c2gocHJvY2Vzc01vZGVsKTtcblx0XHRcdC8vIDIuIENvbXBsZXRlIGFsbCB0aGUgcHJvY2VzcyBwcmVyZXF1aXNpdGVzXG5cdFx0XHRQcm9jZXNzLnByZVJlcXVpc2l0ZXMoY29uZmlnUHJvY2Vzc1swXS5wcmVyZXF1aXNpdGVzLCBfdGhpcykudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuXHRcdFx0XHQvLyAzLiBDb21wbGV0ZSBhbGwgdGhlIHByb2Nlc3MgcHJlLWFjdGlvbnNcblx0XHRcdFx0UHJvY2Vzcy5wcmVBY3Rpb25zKGNvbmZpZ1Byb2Nlc3NbMF0ucHJlQWN0aW9ucywgX3RoaXMpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcblx0XHRcdFx0XHQvLyA0LiBJbml0aWFsaXNlIHRoZSBmaXJzdCBzdWItcHJvY2Vzc1xuXHRcdFx0XHRcdFByb2Nlc3Muc3ViUHJvY2Vzcyhwcm9jZXNzSWQsIGNvbmZpZ1Byb2Nlc3NbMF0uc3ViUHJvY2Vzc2VzWzBdLCAxLCBkYXRhLCBfdGhpcykudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuXHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coJ3N1YlByb2Nlc3MgY29tcGxldGVkLicpO1xuXHRcdFx0XHRcdFx0X3RoaXMuaW5zdGFuY2UgPSByZXN1bHQucmVzO1xuXHRcdFx0XHRcdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1Byb2Nlc3M6ICcgKyBfdGhpcy5jb25maWcucHJvY2Vzc2VzWzBdLl9pZCArICcgaW5pdGlhbGl6ZWQgc3VjY2Vzc2Z1bGx5LicpO1xuXHRcdFx0XHRcdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0XHRcdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuXHRcdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG5cdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSwgZnVuY3Rpb24oZXJyKXtcblx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHR9KTtcblx0XHR9IGNhdGNoKGVycikge1xuXHRcdFx0cmVqZWN0KGVycik7XG5cdFx0fVxuXHR9KTtcbn07XG5cbi8qKiBcbiAqIFdvcmtmbG93IHRhc2ssIHRoaXMgbWV0aG9kIGV4ZWN1dGVzIGEgc3BlY2lmaWMgdGFzay5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIHByb2Nlc3MgaWQgdG8gcHJvY2Vzc1xuICogQHBhcmFtIHtvYmplY3R9IGlucHV0RGF0YSAtIHRoZSBpbnB1dCBkYXRhIHRvIHByb2Nlc3NcbiAqXG4gKiBAZXhhbXBsZSBcbiAqIFdvcmtmbG93LmluaXRpYWxpemUoJ3Byb2Nlc3NJZCcsIHsgdmFsaWREYXRlOiAnZGF0ZScgfSk7XG4gKlxuICogQHJldHVybiBcbiAqIHsgY29tcGxldGU6IHRydWUsIG1lc3NhZ2U6ICdQcm9jZXNzOiAncHJvY2Vzc0lkJyBpbml0aWFsaXplZCBzdWNjZXNzZnVsbHkuJywgcmVzOiB1bmRlZmluZWQgfVxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLnRhc2sgPSBmdW5jdGlvbih0eXBlLCBwYXJhbXMpe1xuXHQvLyBSZS1hc3NpZ24gdGhlIFdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlIGFzIF90aGlzXG5cdHZhciBfdGhpcyA9IHRoaXM7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHR0cnkge1xuXHRcdFx0cmVzb2x2ZSgnU3VjY2VzcycpO1xuXHRcdH0gY2F0Y2goZXJyKSB7XHRcblx0XHRcdHJlamVjdChlcnIpO1xuXHRcdH1cblx0fSk7XG59O1xuXG4vKiogXG4gKiBXb3JrZmxvdyB0cmFuc2l0aW9uIHRvIHRoZSBuZXh0IHN0ZXAuIFRoaXMgbW92ZXMgdGhlIHdvcmtmbG93IGZyb20gdGhlIGN1cnJlbnQgcHJvY2VzcyxcbiAqIHN1Yi1wcm9jZXNzIHN0ZXAgdG8gdGhlIG5leHQgb25lIGFzIHNwZWNpZmllZC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gcHJvY2VzcyBpZFxuICogQHBhcmFtIHtzdHJpbmd9IHN1YlByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN1Yi1wcm9jZXNzIGlkXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RlcElkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3RlcCBpZFxuICogQHBhcmFtIHtzdHJpbmd9IHRyYW5zaXRpb25JZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHRyYW5zaXRpb24gaWRcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gYW55IGFkZGl0aW9uYWwgZGF0YSBwYXNzZWQgaW4gYXMga2V5IHZhbHVlIHBhaXJzXG4gKlxuICogQGV4YW1wbGUgXG4gKiBXb3JrZmxvdy50cmFuc2l0aW9uKCdwcm9jZXNzSWQnLCAnc3ViUHJvY2Vzc0lkJywgJ3N0ZXBJZCcsICd0cmFuc2l0aW9uSWQnLCB7IGtleTogJycsIHZhbHVlOiAnJyB9KTtcbiAqXG4gKiBAcmV0dXJuIFxuICogeyBjb21wbGV0ZTogdHJ1ZSwgbWVzc2FnZTogJ1dvcmtmbG93IHRyYW5zaXRpb25lZCB0byB0aGUgbmV4dCBzdGVwIHN1Y2Nlc3NmdWxseS4nLCByZXM6IHt9IH1cbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS50cmFuc2l0aW9uID0gZnVuY3Rpb24ocHJvY2Vzc0lkLCBzdWJQcm9jZXNzSWQsIHN0ZXBJZCwgdHJhbnNpdGlvbklkLCBkYXRhKXtcblx0Ly8gUmUtYXNzaWduIHRoaXMgXG5cdHZhciBfdGhpcyA9IHRoaXM7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHR0cnkge1xuXHRcdFx0UHJvY2Vzcy50cmFuc2l0aW9uKHByb2Nlc3NJZCwgc3ViUHJvY2Vzc0lkLCBzdGVwSWQsIHRyYW5zaXRpb25JZCwgZGF0YSwgX3RoaXMpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcblx0XHRcdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtmbG93IHRyYW5zaXRpb25lZCB0byB0aGUgbmV4dCBzdGVwIHN1Y2Nlc3NmdWxseS4nLCB7fSk7XG5cdFx0XHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuXHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdH0pO1xuXHRcdH0gY2F0Y2goZXJyKSB7XHRcblx0XHRcdHJlamVjdChlcnIpO1xuXHRcdH1cblx0fSk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFdvcmtmbG93O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbCA9IHJlcXVpcmUoJy4vdXRpbGl0eScpO1xuXG4vKipcbiAqIEZvcm0gTW9kdWxlXG4gKlxuICogQG1vZHVsZSBsaWIvZm9ybVxuICogQGF1dGhvciBCcmVudCBHb3Jkb25cbiAqIEB2ZXJzaW9uIDIuMC4wXG4gKiBAZGVzY3JpcHRpb24gXG4gKiBAY29weXJpZ2h0IEt3YW50dSBMdGQgUlNBIDIwMDktMjAxNS5cbiAqXG4gKi9cblxuZnVuY3Rpb24gY3JlYXRlKGZvcm1EZWYsIHdvcmtmbG93KXtcblx0dmFyIGluZGljYXRvcnMgPSBbXTtcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdHV0aWwuc3luY0xvb3AoZm9ybURlZi5pbmRpY2F0b3JzLmxlbmd0aCwgZnVuY3Rpb24obG9vcCl7XG5cdFx0XHR2YXIgY291bnRlciA9IGxvb3AuaXRlcmF0aW9uKCk7XG5cdFx0XHR2YXIgaW5kaWNhdG9ySWQgPSBmb3JtRGVmLmluZGljYXRvcnNbY291bnRlcl0uX2lkO1xuXHRcdFx0dmFyIGluZGljYXRvck5hbWUgPSBmb3JtRGVmLmluZGljYXRvcnNbY291bnRlcl0ubmFtZS5pMThuLnZhbHVlO1xuXHRcdFx0Ly8gQ29tbWVudCBvdXQgZm9yIHRlc3Rpbmdcblx0XHRcdC8vIHZhciBpbmRpY2F0b3IgPSB7fTtcblx0XHRcdC8vIGxpYnJhcnkuY3JlYXRlSW5kaWNhdG9ySW5zdGFuY2UoaW5kaWNhdG9ySWQsIHdvcmtmbG93LnByb2ZpbGUpLmRvbmUoZnVuY3Rpb24oZGF0YSl7XG5cdFx0XHQvLyBcdGluZGljYXRvciA9IGRhdGE7XG5cdFx0XHQvLyBcdGluZGljYXRvcnMucHVzaChpbmRpY2F0b3IpO1xuXHRcdFx0Ly8gXHRsb29wLm5leHQoKTtcblx0XHRcdC8vIH0pLmZhaWwoZnVuY3Rpb24oZXJyKXtcblx0XHRcdC8vIFx0Y29uc29sZS5sb2coZXJyKTtcblx0XHRcdC8vIH0pO1xuXHRcdFx0dmFyIHV1aWQgPSB3b3JrZmxvdy5wcm9maWxlICsgJzonICsgd29ya2Zsb3cuYXBwICsgJzonICsgaW5kaWNhdG9ySWQgKyAnOjAnOyAvLyByZXBsYWNlIHRoaXMgd2l0aCBnYXRla2VlcGVyIGNhbGwgYW5kIHJldHVybiB0aGUgdXVpZFxuXHRcdFx0dmFyIGluZGljYXRvciA9IHtcblx0XHRcdFx0X2lkOiB1dWlkLFxuXHRcdFx0XHRjYXRlZ29yeToge1xuXHRcdFx0XHRcdHRlcm06IGluZGljYXRvcklkLFxuXHRcdFx0XHRcdGxhYmVsOiBpbmRpY2F0b3JOYW1lXG5cdFx0XHRcdH0sXG5cdFx0XHRcdFwicHJvY2Vzc2VzXCI6IFtdXG5cdFx0XHR9O1xuXHRcdFx0aW5kaWNhdG9ycy5wdXNoKGluZGljYXRvcik7XG5cdFx0XHRsb29wLm5leHQoKTtcblx0XHR9LCBmdW5jdGlvbigpe1xuXHRcdCAgICAvLyBjb25zb2xlLmxvZygnZG9uZScpO1xuXHRcdCAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBjcmVhdGVkIHN1Y2Nlc3NmdWxseS4nLCBpbmRpY2F0b3JzKTtcblx0XHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdFx0fSk7XG5cdH0pO1xufTtcblxuZnVuY3Rpb24gc2F2ZShpbmRpY2F0b3Ipe1xuXHR2YXIgY29tcGxldGVkID0gW107XG5cdHZhciByZXN1bHQgPSB7XG5cdFx0Y29tcGxldGU6IHRydWUsXG5cdFx0ZGF0YTogW11cblx0fTtcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdGb3JtIGluZGljYXRvciBzZXQgc2F2ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdCk7XG5cdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0fSk7XG59O1xuXG5mdW5jdGlvbiBzdWJtaXQoZm9ybSl7XG5cdHZhciBjb21wbGV0ZWQgPSBbXTtcblx0dmFyIHJlc3VsdCA9IHtcblx0XHRjb21wbGV0ZTogdHJ1ZSxcblx0XHRkYXRhOiBbXVxuXHR9O1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gc3VibWl0dGVkIHN1Y2Nlc3NmdWxseS4nLCByZXN1bHQpO1xuXHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdH0pO1xufTtcblxuZnVuY3Rpb24gYXV0aG9yaXNlKGZvcm0pe1xuXHR2YXIgY29tcGxldGVkID0gW107XG5cdHZhciByZXN1bHQgPSB7XG5cdFx0Y29tcGxldGU6IHRydWUsXG5cdFx0ZGF0YTogW11cblx0fTtcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdGb3JtIGF1dGhvcmlzZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdCk7XG5cdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0fSk7XG59O1xuXG5mdW5jdGlvbiBjbG9zZShmb3JtKXtcblx0dmFyIGNvbXBsZXRlZCA9IFtdO1xuXHR2YXIgcmVzdWx0ID0ge1xuXHRcdGNvbXBsZXRlOiB0cnVlLFxuXHRcdGRhdGE6IFtdXG5cdH07XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBjbG9zZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdCk7XG5cdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0fSk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHsgXG5cbiBcdGNyZWF0ZTogY3JlYXRlLFxuIFx0c2F2ZTogc2F2ZSxcbiBcdHN1Ym1pdDogc3VibWl0LFxuIFx0YXV0aG9yaXNlOiBhdXRob3Jpc2UsXG4gXHRjbG9zZTogY2xvc2VcblxufVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbCA9IHJlcXVpcmUoJy4vdXRpbGl0eScpO1xudmFyIGZvcm0gPSByZXF1aXJlKCcuL2Zvcm0nKTtcblxuLyoqXG4gKiBQcm9jZXNzIE1vZHVsZVxuICpcbiAqIEBtb2R1bGUgbGliL3Byb2Nlc3NcbiAqIEBhdXRob3IgQnJlbnQgR29yZG9uXG4gKiBAdmVyc2lvbiAwLjEuMFxuICogQGRlc2NyaXB0aW9uIFxuICogQGNvcHlyaWdodCBLd2FudHUgTHRkIFJTQSAyMDA5LTIwMTUuXG4gKlxuICovXG5cbi8qKiBcbiAqIFByb2Nlc3MgcHJlLXJlcXVpc2l0ZXNcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gcHJlcmVxdWlzaXRlcyAtIHRoZSBwcmUtcmVxdWlzaXRlcyBjb25maWcgZGF0YVxuICpcbiAqIEBleGFtcGxlIFxuICpcbiAqIEByZXR1cm4gXG4gKlxuICovXG5mdW5jdGlvbiBwcmVSZXF1aXNpdGVzKHByZXJlcXVpc2l0ZXMpIHtcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdC8vIFVuY29tbWVudCBiZWxvdyBzZWN0aW9uIHdoZW4gcmVhZHkgdG8gaW1wbGVtZW50XG5cdFx0Ly8gdXRpbC5zeW5jTG9vcChwcmVyZXF1aXNpdGVzLmxlbmd0aCwgZnVuY3Rpb24obG9vcCl7XG5cdFx0Ly8gXHR2YXIgY291bnRlciA9IGxvb3AuaXRlcmF0aW9uKCk7XG5cdFx0Ly8gXHRwcmVSZXF1aXNpdGUocHJlcmVxdWlzaXRlc1tjb3VudGVyXSwgY291bnRlcikudGhlbihmdW5jdGlvbihkYXRhKXtcdFx0XHRcblx0XHQvLyBcdFx0Ly8gQ2hlY2sgaWYgYWxsIHByZS1yZXF1aXNpdGVzIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuXG5cdFx0Ly8gXHRcdGNvbXBsZXRlZC5wdXNoKGRhdGEuY29tcGxldGUpO1xuXHRcdC8vIFx0XHRyZXN1bHQuZGF0YS5wdXNoKGRhdGEpO1xuXHRcdC8vIFx0XHRpZiAoY29tcGxldGVkLmV2ZXJ5KEJvb2xlYW4pKSB7XG5cdFx0Ly8gXHRcdFx0cmVzdWx0LmNvbXBsZXRlZCA9IHRydWU7XG5cdFx0Ly8gXHRcdFx0bG9vcC5uZXh0KCk7XG5cdFx0Ly8gXHRcdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1ByZS1yZXF1aXNpdGVzIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywgcmVzdWx0KTtcblx0XHQvLyBcdFx0XHRkZWZlcnJlZC5yZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdC8vIFx0XHR9IGVsc2Uge1xuXHRcdC8vIFx0XHRcdGxvb3AuYnJlYWsoKTtcblx0XHQvLyBcdFx0XHR2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRjAwNycpO1xuXHRcdC8vIFx0XHRcdGRlZmVycmVkLnJlamVjdChlcnJvcik7XG5cdFx0Ly8gXHRcdH1cblx0XHQvLyBcdH0sIGZ1bmN0aW9uKGVycil7XG5cdFx0Ly8gXHRcdGxvb3AuYnJlYWsoKTtcblx0XHQvLyBcdFx0ZGVmZXJyZWQucmVqZWN0KGVycik7XG5cdFx0Ly8gXHR9KTtcblx0XHQvLyB9KTtcblx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUHJlLXJlcXVpc2l0ZXMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7fSk7XG5cdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0fSk7XG59O1xuXG4vKiogXG4gKiBQcm9jZXNzIHByZS1yZXF1aXNpdGUsIGV4ZWN1dGUgdGhlIHByZS1yZXF1aXNpdGUgY29uZGl0aW9uLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBwcmVyZXF1aXNpdGUgLSB0aGUgcHJlLXJlcXVpc2l0ZSBjb25maWcgZGF0YVxuICogQHBhcmFtIHtudW1iZXJ9IGNvdW50ZXIgLSB0aGUgcHJlLXJlcXVpc2l0ZSBjb3VudCAvIG51bWJlclxuICogQHBhcmFtIHtvYmplY3R9IHdvcmtmbG93IC0gdGhlIHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgXG4gKiB2YXIgY29uZmlnID0ge1xuICpcdCAgICBcIl9zZXFcIjogXCJcIixcbiAqXHQgICAgXCJfdHlwZVwiOiBcIlwiLFxuICpcdFx0XCJfc3ViamVjdFwiOiBcIlwiLFxuICpcdCAgICBcIl9vcGVyYXRvclwiOiBcIlwiLFxuICpcdCAgICBcIl92YWx1ZVwiOiBcIlwiLFxuICpcdCAgICBcIl9yZWZlcmVuY2VcIjogXCJcIixcbiAqXHQgICAgXCJtZXNzYWdlXCI6IHtcbiAqXHQgICAgXHRcImkxOG5cIjoge1xuICpcdCAgICBcdFx0XCJfbGFuZ1wiOiBcImVuXCIsXG4gKlx0ICAgIFx0XHRcInZhbHVlXCI6IFwiXCJcbiAqXHQgICAgXHR9XG4gKlx0ICAgIH1cbiAqXHR9O1xuICogUHJvY2Vzcy5wcmVSZXF1aXNpdGUoY29uZmlnLCBjb3VudGVyLCBpbnN0YW5jZSwgZG9jKTtcbiAqXG4gKiBAcmV0dXJuIFxuICpcbiAqL1xuZnVuY3Rpb24gcHJlUmVxdWlzaXRlKHByZXJlcXVpc2l0ZSwgY291bnRlciwgd29ya2Zsb3cpe1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0c3dpdGNoKHByZXJlcXVpc2l0ZS5fdHlwZSkge1xuXHRcdFx0Ly8gVE9ETzogQWRkIHRoZSBjYWxsIHRvIHRoZSByZWxldmFudCBtZXRob2RzIGJhc2VkIG9uIHRoZSBfdHlwZSBcblx0XHRcdC8vIGF0dHJpYnV0ZS5cblx0XHRcdGNhc2UgJ2NvdW50Jzpcblx0XHRcdFx0Ly8gVE9ETzogQWRkIGNvZGUgbG9naWMgaGVyZS4uLlxuXHRcdFx0XHR2YXIgZGF0YSA9IHt9O1xuXHRcdFx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnTW9jayBjb3VudCBzdWNjZXNzZnVsbC4nLCBkYXRhKTtcblx0XHRcdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHR2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywnUHJlLXJlcXVpc2l0ZSB0eXBlOiAnICsgcHJlcmVxdWlzaXRlLl90eXBlICsgJyBub3QgZGVmaW5lZC4nKTtcblx0XHRcdFx0cmVqZWN0KGVycm9yKTtcblx0XHR9XG5cdH0pO1xufTtcblxuLyoqIFxuICogUHJvY2VzcyBwcmUtYWN0aW9uc3NcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gcHJlQWN0aW9ucyAtIHRoZSBwcmUtYWN0aW9ucyBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IHdvcmtmbG93IC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSBcbiAqXG4gKiBAcmV0dXJuIFxuICpcbiAqL1xuZnVuY3Rpb24gcHJlQWN0aW9ucyhwcmVBY3Rpb25zLCB3b3JrZmxvdyl7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHQvLyBBZGQgZnVuY3Rpb24gbG9naWMgaGVyZS4uLlxuXG5cdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1ByZS1hY3Rpb25zIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywge30pO1xuXHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdH0pO1xufTtcblxuLyoqIFxuICogUHJvY2VzcyBzdWItcHJvY2Vzc1xuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgY3VycmVudCBwcm9jZXNzIGlkXG4gKiBAcGFyYW0ge29iamVjdH0gc3ViUHJvY2VzcyAtIHRoZSBzdWItcHJvY2VzcyBjb25maWcgZGF0YVxuICogQHBhcmFtIHtudW1iZXJ9IHNlcSAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIGluc3RhbmNlIGNvdW50ZXIgLyBzZXF1ZW5jZVxuICogQHBhcmFtIHtvYmplY3R9IGlucHV0RGF0YSAtIHRoZSB1c2VyIGlucHV0IGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSB3b3JrZmxvdyAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgXG4gKlxuICogQHJldHVybiBcbiAqXG4gKi9cbmZ1bmN0aW9uIHN1YlByb2Nlc3MocHJvY2Vzc0lkLCBzdWJQcm9jZXNzLCBzZXEsIGlucHV0RGF0YSwgd29ya2Zsb3cpe1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0Ly8gVGhlIGRlZmF1bHQgc3ViUHJvY2VzcyBtb2RlbFxuXHRcdHZhciBzdWJQcm9jZXNzTW9kZWwgPSB7XG5cdFx0XHRpZDogc3ViUHJvY2Vzcy5faWQsIFxuXHRcdFx0c2VxOiBzZXEsIFxuXHRcdFx0aW5pdGlhdGVkOiBmYWxzZSxcblx0XHRcdGRhdGVzOiB7XG5cdCAgICAgICAgICAgIGNyZWF0ZWQ6ICcnLFxuXHQgICAgICAgICAgICB2YWxpZDogJycsXG5cdCAgICAgICAgICAgIGR1ZTogJycsXG5cdCAgICAgICAgICAgIGNsb3NlZDogJydcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGNvbXBsZXRlOiBmYWxzZSxcblx0ICAgICAgICBpbmRpY2F0b3JzOiBbXSxcblx0ICAgICAgICBzdGVwOiB7fVxuXHRcdH07XG5cdFx0dHJ5IHtcblx0XHRcdC8vIEluaXRpYXRlIHRoZSBzdWItcHJvY2Vzc1xuXHRcdFx0aW5pdGlhdGUoc3ViUHJvY2Vzcy5pbml0aWF0ZSwgaW5wdXREYXRhKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG5cdFx0XHRcdHN1YlByb2Nlc3NNb2RlbC5pbml0aWF0ZWQgPSB0cnVlO1xuXHRcdFx0XHRzdWJQcm9jZXNzTW9kZWwuZGF0ZXMuY3JlYXRlZCA9IHJlc3VsdC5kYXRhLmNyZWF0ZWREYXRlO1xuXHRcdFx0XHRzdWJQcm9jZXNzTW9kZWwuZGF0ZXMudmFsaWQgPSByZXN1bHQuZGF0YS52YWxpZERhdGU7XG5cdFx0XHRcdHN1YlByb2Nlc3NNb2RlbC5kYXRlcy5kdWUgPSByZXN1bHQuZGF0YS5kdWVEYXRlO1xuXHRcdFx0XHQvLyBVcGRhdGUgdGhlIHdvcmtmbG93IHByb2Nlc3Mgc3ViUHJvY2VzcyBkYXRhXG5cdFx0XHRcdHZhciBwcm9jZXNzU2VxID0gd29ya2Zsb3cuaW5zdGFuY2UucHJvY2Vzc2VzLmxlbmd0aDtcblx0XHRcdFx0d29ya2Zsb3cuaW5zdGFuY2UucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpQcm9jZXNzKXtcblx0XHRcdFx0XHRpZiAob2JqUHJvY2Vzcy5pZCA9PT0gcHJvY2Vzc0lkICYmIG9ialByb2Nlc3Muc2VxID09PSBwcm9jZXNzU2VxKSB7XG5cdFx0XHRcdFx0XHRvYmpQcm9jZXNzLnN1YlByb2Nlc3Nlcy5wdXNoKHN1YlByb2Nlc3NNb2RlbCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0Ly8gUHJvY2VzcyB0aGUgZmlyc3Qgc3RlcCBhbmQgYW55IHN1YnNlcXVlbnQgJ2F1dG8nIHN0ZXBcblx0XHRcdFx0dmFyIGZvcm1EZWYgPSB7XG5cdFx0XHRcdFx0aWQ6IHN1YlByb2Nlc3MuX2lkLFxuXHRcdFx0XHRcdG5hbWU6IHN1YlByb2Nlc3MubmFtZS5pMThuLnZhbHVlLFxuXHRcdFx0XHRcdGluZGljYXRvcnM6IHN1YlByb2Nlc3MuaW5kaWNhdG9yc1xuXHRcdFx0XHR9XG5cdFx0XHRcdHN0ZXAocHJvY2Vzc0lkLCBzdWJQcm9jZXNzLl9pZCwgc3ViUHJvY2Vzcy5zdGVwc1swXS5faWQsIDAsIGZvcm1EZWYsIGlucHV0RGF0YSwgd29ya2Zsb3cpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcblx0XHRcdFx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnU3ViLVByb2Nlc3MgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZmxvdy5pbnN0YW5jZSk7XG5cdFx0XHRcdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0XHRcdFx0fSwgZnVuY3Rpb24oZXJyKXtcblx0XHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuXHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdH0pO1xuXHRcdH0gY2F0Y2goZXJyKXtcblx0XHRcdHJlamVjdChlcnIpO1xuXHRcdH1cblx0fSk7XG59O1xuXG4vKiogXG4gKiBQcm9jZXNzIGluaXRpYXRlXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IGluaXRpYXRlIC0gdGhlIGluaXRpYXRlIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gaW5wdXREYXRhIC0gdGhlIHVzZXIgaW5wdXQgZGF0YVxuICpcbiAqIEBleGFtcGxlIFxuICpcbiAqIEByZXR1cm4gXG4gKlxuICovXG5mdW5jdGlvbiBpbml0aWF0ZShpbml0aWF0ZSwgaW5wdXREYXRhKXtcblx0dmFyIGNvbXBsZXRlZCA9IFtdO1xuXHR2YXIgcmVzdWx0ID0ge1xuXHRcdGNvbXBsZXRlOiBmYWxzZVxuXHR9O1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0c3dpdGNoKGluaXRpYXRlLl90eXBlKSB7XG5cdFx0XHRjYXNlICd1c2VyJzpcblx0XHRcdFx0Ly8gSWYgdGhlIHN1YlByb2Nlc3MgaW5pdGlhdGlvbiBpcyB1c2VyIGRlZmluZWQgdGhlblxuXHRcdFx0XHRyZXN1bHQuY3JlYXRlZERhdGUgPSBpbnB1dERhdGEuY3JlYXRlZERhdGU7XG5cdFx0XHRcdGlmIChpbml0aWF0ZS5kYXRlcy52YWxpZC5fdHlwZSA9PT0gJ3VzZXJTZWxlY3RlZCcpIHtcblx0XHRcdFx0XHRpZiAoaW5wdXREYXRhLnZhbGlkRGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0XHRyZXN1bHQudmFsaWREYXRlID0gaW5wdXREYXRhLnZhbGlkRGF0ZTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZJbml0aWF0ZUVycm9yJywgJ05vIHZhbGlkIGRhdGUgcGFzc2VkIGluIC0ge2lucHV0RGF0YS52YWxpZERhdGV9Jyk7XG5cdFx0XHRcdFx0XHRyZWplY3QoZXJyb3IpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoaW5pdGlhdGUuZGF0ZXMuZHVlLl90eXBlID09PSAndXNlclNlbGVjdGVkJykge1xuXHRcdFx0XHRcdGlmIChpbnB1dERhdGEuZHVlRGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0XHRyZXN1bHQuZHVlRGF0ZSA9IGlucHV0RGF0YS5kdWVEYXRlO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRkluaXRpYXRlRXJyb3InLCAnTm8gZHVlIGRhdGUgcGFzc2VkIGluIC0ge2lucHV0RGF0YS5kdWVEYXRlfScpO1xuXHRcdFx0XHRcdFx0cmVqZWN0KGVycm9yKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmVzdWx0LmNvbXBsZXRlID0gdHJ1ZTtcblx0XHRcdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1N1Yi1Qcm9jZXNzIGluaXRpYXRlIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywgcmVzdWx0KTtcblx0XHRcdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHR2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRkluaXRpYXRlRXJyb3InLCAnSW5pdGlhdGUgdHlwZTogJyArIGluaXRpYXRlLl90eXBlICsgJyBub3QgZGVmaW5lZC4nKTtcblx0XHRcdFx0cmVqZWN0KGVycm9yKTtcblx0XHR9XG5cdH0pO1xufTtcblxuLyoqIFxuICogUHJvY2VzcyBzdGVwXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBjdXJyZW50IHByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdWJQcm9jZXNzSWQgLSB0aGUgY3VycmVudCBzdWItcHJvY2VzcyBpZFxuICogQHBhcmFtIHtzdHJpbmd9IHN0ZXBJZCAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIHN0ZXAgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdGVwU2VxIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3Mgc3RlcCBpbnN0YW5jZSBjb3VudGVyIC8gc2VxdWVuY2VcbiAqIEBwYXJhbSB7b2JqZWN0fSBmb3JtRGVmIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3MgZm9ybSBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IGlucHV0RGF0YSAtIHRoZSB1c2VyIGlucHV0IGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSB3b3JrZmxvdyAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgXG4gKlxuICogQHJldHVybiBcbiAqXG4gKi9cbmZ1bmN0aW9uIHN0ZXAocHJvY2Vzc0lkLCBzdWJQcm9jZXNzSWQsIHN0ZXBJZCwgc3RlcFNlcSwgZm9ybURlZiwgaW5wdXREYXRhLCB3b3JrZmxvdyl7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHQvLyBEZWZhdWx0IHN0ZXAgbW9kZWxcblx0XHR2YXIgc3RlcE1vZGVsID0ge1xuXHQgICAgICAgIGlkOiAnJyxcblx0ICAgICAgICBzZXE6ICcnLFxuXHQgICAgICAgIHN0YXR1czogJycsXG5cdCAgICAgICAgbWVzc2FnZTogJycsXG5cdCAgICAgICAgYXNzaWduZWRUbzoge1xuXHQgICAgICAgICAgICB1c2VySWQ6ICcnLFxuXHQgICAgICAgICAgICBuYW1lOiAnJ1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdFx0dHJ5IHtcblx0XHRcdC8vIEdldCB0aGUgY3VycmVudCBzdGVwXG5cdFx0XHR2YXIgc3RlcCA9IHt9O1xuXHRcdFx0d29ya2Zsb3cuY29uZmlnLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqUHJvY2Vzcyl7XG5cdFx0XHRcdGlmIChvYmpQcm9jZXNzLl9pZCA9PT0gcHJvY2Vzc0lkKSB7XG5cdFx0XHRcdFx0b2JqUHJvY2Vzcy5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialN1YlByb2Nlc3Mpe1xuXHRcdFx0XHRcdFx0aWYgKG9ialN1YlByb2Nlc3MuX2lkID09PSBzdWJQcm9jZXNzSWQpIHtcblx0XHRcdFx0XHRcdFx0b2JqU3ViUHJvY2Vzcy5zdGVwcy5maWx0ZXIoZnVuY3Rpb24ob2JqU3RlcCl7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKG9ialN0ZXAuX2lkID09PSBzdGVwSWQpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHN0ZXAgPSBvYmpTdGVwO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdC8vIFVwZGF0ZSB0aGUgc3ViLXByb2Nlc3Mgc3RlcCBkYXRhXG5cdFx0XHRzdGVwTW9kZWwuaWQgPSBzdGVwSWQ7XG5cdFx0XHRzdGVwTW9kZWwuc2VxID0gc3RlcFNlcTtcblx0XHRcdHN0ZXBNb2RlbC5zdGF0dXMgPSBzdGVwLl9zZXRJbnN0YW5jZVN0YXR1c1RvO1xuXHRcdFx0c3RlcE1vZGVsLm1lc3NhZ2UgPSBzdGVwLl9zZXRTdGF0dXNNc2dUbztcblx0XHRcdHN0ZXBNb2RlbC5hc3NpZ25lZFRvLnVzZXJJZCA9IGlucHV0RGF0YS51c2VySWQ7XG5cdFx0XHRzdGVwTW9kZWwuYXNzaWduZWRUby5uYW1lID0gaW5wdXREYXRhLm5hbWU7XG5cdFx0XHQvLyBVcGRhdGUgdGhlIGN1cnJlbnQgcHJvY2Vzcywgc3ViUHJvY2VzcyBzdGVwIGRhdGFcblx0XHRcdHZhciBwcm9jZXNzU2VxID0gd29ya2Zsb3cuaW5zdGFuY2UucHJvY2Vzc2VzLmxlbmd0aDtcblx0XHRcdHdvcmtmbG93Lmluc3RhbmNlLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqUHJvY2Vzcyl7XG5cdFx0XHRcdGlmIChvYmpQcm9jZXNzLmlkID09PSBwcm9jZXNzSWQgJiYgb2JqUHJvY2Vzcy5zZXEgPT09IHByb2Nlc3NTZXEpIHtcblx0XHRcdFx0XHRvYmpQcm9jZXNzLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqU3ViUHJvY2Vzcyl7XG5cdFx0XHRcdFx0XHRpZiAob2JqU3ViUHJvY2Vzcy5pZCA9PT0gc3ViUHJvY2Vzc0lkKSB7XG5cdFx0XHRcdFx0XHRcdG9ialN1YlByb2Nlc3Muc3RlcCA9IHN0ZXBNb2RlbDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KVxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdC8vIElmIGFjdGlvbnMgYXJlIHNwcmVjaWZpZWQsIGV4ZWN1dGUgdGhlbVxuXHRcdFx0aWYgKHN0ZXAuYWN0aW9uc1swXSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdGFjdGlvbnMoc3RlcC5hY3Rpb25zLCBmb3JtRGVmLCB3b3JrZmxvdykudGhlbihmdW5jdGlvbihkYXRhKXtcblx0XHRcdFx0XHQvLyBUaGUgZG9jdW1lbnQgcHJvY2Vzcy5zdGVwIG1vZGVsXG5cdFx0XHRcdCAgICB2YXIgZG9jdW1lbnRTdGVwTW9kZWwgPSB7XG5cdFx0ICAgICAgICAgICAgICAgIGlkOiBzdGVwSWQsXG5cdFx0ICAgICAgICAgICAgICAgIHNlcTogc3RlcFNlcSxcblx0XHQgICAgICAgICAgICAgICAgc3RhcnREYXRlOiBpbnB1dERhdGEuY3JlYXRlZERhdGUsXG5cdFx0ICAgICAgICAgICAgICAgIHN0YXR1czogc3RlcC5fc2V0SW5zdGFuY2VTdGF0dXNUbyxcblx0XHQgICAgICAgICAgICAgICAgbWVzc2FnZTogc3RlcC5fc2V0U3RhdHVzTXNnVG8sXG5cdFx0ICAgICAgICAgICAgICAgIGFzc2lnbmVkVG86IHtcblx0XHQgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogaW5wdXREYXRhLnVzZXJJZCxcblx0XHQgICAgICAgICAgICBcdFx0bmFtZTogaW5wdXREYXRhLm5hbWVcblx0XHQgICAgICAgICAgICAgICAgfSxcblx0XHQgICAgICAgICAgICAgICAgY29tbWVudDogaW5wdXREYXRhLmNvbW1lbnQsXG5cdFx0ICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBmYWxzZSxcblx0XHQgICAgICAgICAgICAgICAgZW5kRGF0ZTogJydcblx0XHRcdCAgICAgICAgfTtcblx0XHRcdFx0XHR1dGlsLnN5bmNMb29wKGRhdGEucmVzLmRhdGFbMF0uZm9ybS5pbmRpY2F0b3JzLmxlbmd0aCwgZnVuY3Rpb24obG9vcCl7XG5cdFx0XHRcdFx0XHR2YXIgY291bnRlciA9IGxvb3AuaXRlcmF0aW9uKCk7XG5cdFx0XHRcdFx0XHQvLyBVcGRhdGUgdGhlIHByb2Nlc3NlcyBpbnN0YW5jZSBtb2RlbCwgaW5pZGNhdG9ycyBzZWN0aW9uXG5cdFx0XHRcdFx0XHR2YXIgaW5kaWNhdG9yTW9kZWwgPSB7XG5cdFx0XHRcdFx0XHRcdGlkOiBkYXRhLnJlcy5kYXRhWzBdLmZvcm0uaW5kaWNhdG9yc1tjb3VudGVyXS5jYXRlZ29yeS50ZXJtLCBcblx0XHRcdFx0XHRcdFx0aW5zdGFuY2VzOiBbXG5cdFx0XHRcdFx0XHRcdFx0e1xuXHRcdFx0XHRcdFx0XHRcdFx0dXVpZDogZGF0YS5yZXMuZGF0YVswXS5mb3JtLmluZGljYXRvcnNbY291bnRlcl0uX2lkLCBcblx0XHRcdFx0XHRcdFx0XHRcdGtleTogJycsIFxuXHRcdFx0XHRcdFx0XHRcdFx0c2VxOiAxICAgICAgICAgICAgICAgICBcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdF1cblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHQvLyBVcGRhdGUgdGhlIGluZGljYXRvciBzZXQgZG9jdW1lbnRzIHdvcmtmbG93LnByb2Nlc3Nlcy5zdGVwIGRhdGFcblxuXHRcdFx0XHRcdFx0bG9vcC5uZXh0KCk7XG5cdFx0XHRcdFx0fSwgZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRcdC8vIENoZWNrIGlmIGl0IHNob3VsZCBhdXRvbWF0aWNhbGx5IHRyYW5zaXRpb24gdG8gdGhlIG5leHQgc3RlcFxuXHRcdFx0XHRcdFx0aWYgKHN0ZXAuYWN0aW9uc1swXS50cmFuc2l0aW9ucy5sZW5ndGggIT09IDApIHtcblx0XHRcdFx0XHRcdFx0dXRpbC5zeW5jTG9vcChzdGVwLmFjdGlvbnNbMF0udHJhbnNpdGlvbnMubGVuZ3RoLCBmdW5jdGlvbihsb29wKXtcblx0XHRcdFx0XHRcdFx0XHR2YXIgY291bnRlciA9IGxvb3AuaXRlcmF0aW9uKCk7XG5cdFx0XHRcdFx0XHRcdFx0dHJhbnNpdGlvbihwcm9jZXNzSWQsIHN1YlByb2Nlc3NJZCwgc3RlcElkLCBzdGVwLmFjdGlvbnNbMF0udHJhbnNpdGlvbnNbY291bnRlcl0uX2lkLCBpbnB1dERhdGEsIHdvcmtmbG93KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnVHJhbnNpdGlvbiBzdGVwIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywge30pO1xuXHRcdFx0XHRcdFx0XHRcdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0XHRcdFx0XHRcdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuXHRcdFx0XHRcdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdFx0XHRcdFx0XHRsb29wLmJyZWFrKCk7XG5cdFx0XHRcdFx0XHRcdFx0fSk7XHRcblx0XHRcdFx0XHRcdFx0XHRsb29wLm5leHQoKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnTm8gdHJhbnNpdGlvbnMgc3BlY2lmaWVkIGluIHRoaXMgc3RlcC4nLCB7fSk7XG5cdFx0XHRcdFx0XHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG5cdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdH0pOyBcblx0XHRcdH0gZWxzZSBpZiAoc3RlcC50YXNrICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1Rhc2sgYXdhaXRpbmcgdXNlciBhY3Rpb24uJywge30pO1xuXHRcdFx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2goZXJyKSB7XG5cdCAgICBcdHJlamVjdChlcnIpO1xuXHQgICAgfVxuXHR9KTtcbn07XG5cbi8qKiBcbiAqIFByb2Nlc3MgYWN0aW9uc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBhY3Rpb25zIC0gdGhlIGFjdGlvbnMgY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBmb3JtRGVmIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3MgZm9ybSBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IHdvcmtmbG93IC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSBcbiAqXG4gKiBAcmV0dXJuIFxuICpcbiAqL1xuZnVuY3Rpb24gYWN0aW9ucyhhY3Rpb25zLCBmb3JtRGVmLCB3b3JrZmxvdyl7XG5cdHZhciBjb21wbGV0ZWQgPSBbXTtcblx0dmFyIHJlc3VsdCA9IHtcblx0XHRjb21wbGV0ZWQ6IHRydWUsXG5cdFx0ZGF0YTogW11cblx0fTtcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdHV0aWwuc3luY0xvb3AoYWN0aW9ucy5sZW5ndGgsIGZ1bmN0aW9uKGxvb3Ape1xuXHRcdFx0dmFyIGNvdW50ZXIgPSBsb29wLml0ZXJhdGlvbigpO1xuXHRcdFx0YWN0aW9uKGFjdGlvbnNbY291bnRlcl0sIGZvcm1EZWYsIHdvcmtmbG93KS50aGVuKGZ1bmN0aW9uKGRhdGEpe1x0XHRcdFxuXHRcdFx0XHRjb21wbGV0ZWQucHVzaChkYXRhLmNvbXBsZXRlKTtcblx0XHRcdFx0cmVzdWx0LmRhdGEucHVzaChkYXRhLnJlcyk7XG5cdFx0XHRcdGxvb3AubmV4dCgpO1xuXHRcdFx0fSwgZnVuY3Rpb24oZXJyKXtcblx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdGxvb3AuYnJlYWsoKTtcblx0XHRcdH0pO1xuXHRcdH0sIGZ1bmN0aW9uKCl7XG5cdFx0XHRpZiAoY29tcGxldGVkLmV2ZXJ5KEJvb2xlYW4pKSB7XG5cdFx0XHRcdHJlc3VsdC5jb21wbGV0ZWQgPSB0cnVlO1xuXHRcdFx0XHR2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnQWN0aW9ucyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdCk7XG5cdFx0XHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXN1bHQuY29tcGxldGVkID0gZmFsc2U7XG5cdFx0XHRcdHZhciBlcnIgPSB1dGlsLmVycm9yKCdXRkFjdGlvbnNFcnJvcicsJ0FjdGlvbi9zIGZvciBzdWItcHJvY2VzczogJyArIGZvcm1EZWYuaWQgKyAnIGRpZCBub3QgY29tcGxldGUgc3VjY2VmZnVsbHkuJyk7XG5cdFx0XHRcdHJlamVjdChzdWNjZXNzKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSk7XG59O1xuXG4vKiogXG4gKiBQcm9jZXNzIGFjdGlvblxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBhY3Rpb24gLSB0aGUgYWN0aW9uIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gZm9ybURlZiAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIGZvcm0gY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSB3b3JrZmxvdyAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgXG4gKlxuICogQHJldHVybiBcbiAqXG4gKi9cbmZ1bmN0aW9uIGFjdGlvbihhY3Rpb24sIGZvcm1EZWYsIHdvcmtmbG93KXtcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdHN3aXRjaChhY3Rpb24uX2lkKSB7XG5cdFx0XHRjYXNlICdjcmVhdGVGb3JtJzpcblx0XHRcdFx0Zm9ybS5jcmVhdGUoZm9ybURlZiwgd29ya2Zsb3cpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcdFxuXHRcdFx0XHRcdHZhciBkYXRhID0ge1xuXHRcdFx0XHRcdFx0dHJhbnNpdGlvbnM6IFtdLFxuXHRcdFx0XHRcdFx0Zm9ybToge1xuXHRcdFx0XHRcdFx0XHRpZDogZm9ybURlZi5pZCxcblx0XHRcdFx0XHRcdFx0aW5kaWNhdG9yczogW11cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZGF0YS50cmFuc2l0aW9ucyA9IGFjdGlvbi50cmFuc2l0aW9ucztcblx0XHRcdFx0XHRkYXRhLmZvcm0uaW5kaWNhdG9ycyA9IHJlc3VsdC5yZXM7XG5cdFx0XHRcdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MocmVzdWx0Lm1lc3NhZ2UsIGRhdGEpO1xuXHRcdFx0XHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdFx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG5cdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdC8vIGNhc2UgJ3NhdmVJbmRpY2F0b3InOlxuXHRcdFx0XHRcblx0XHRcdC8vIFx0YnJlYWs7XG5cdFx0XHQvLyBjYXNlICdzdWJtaXRGb3JtJzpcblx0XHRcdFx0XG5cdFx0XHQvLyBcdGJyZWFrO1xuXHRcdFx0Y2FzZSAnYXV0aG9yaXNlRm9ybSc6XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKCdDYWxsaW5nIGF1dGhvcmlzZUZvcm0gYWN0aW9uJyk7XG5cdFx0XHRcdGZvcm0uYXV0aG9yaXNlKGZvcm1EZWYsIHdvcmtmbG93KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XHRcblx0XHRcdFx0XHR2YXIgZGF0YSA9IHtcblx0XHRcdFx0XHRcdHRyYW5zaXRpb25zOiBbXSxcblx0XHRcdFx0XHRcdGZvcm06IHtcblx0XHRcdFx0XHRcdFx0aWQ6IGZvcm1EZWYuaWQsXG5cdFx0XHRcdFx0XHRcdGluZGljYXRvcnM6IFtdXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGRhdGEudHJhbnNpdGlvbnMgPSBhY3Rpb24udHJhbnNpdGlvbnM7XG5cdFx0XHRcdFx0Ly8gZGF0YS5mb3JtLmluZGljYXRvcnMgPSByZXN1bHQucmVzO1xuXHRcdFx0XHRcdHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKHJlc3VsdC5tZXNzYWdlLCBkYXRhKTtcblx0XHRcdFx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuXHRcdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlICdjbG9zZUZvcm0nOlxuXHRcdFx0XHQvLyBjb25zb2xlLmxvZygnQ2FsbGluZyBjbG9zZUZvcm0gYWN0aW9uJyk7XG5cdFx0XHRcdGZvcm0uY2xvc2UoZm9ybURlZiwgd29ya2Zsb3cpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcdFxuXHRcdFx0XHRcdHZhciBkYXRhID0ge1xuXHRcdFx0XHRcdFx0dHJhbnNpdGlvbnM6IFtdLFxuXHRcdFx0XHRcdFx0Zm9ybToge1xuXHRcdFx0XHRcdFx0XHRpZDogZm9ybURlZi5pZCxcblx0XHRcdFx0XHRcdFx0aW5kaWNhdG9yczogW11cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZGF0YS50cmFuc2l0aW9ucyA9IGFjdGlvbi50cmFuc2l0aW9ucztcblx0XHRcdFx0XHQvLyBkYXRhLmZvcm0uaW5kaWNhdG9ycyA9IHJlc3VsdC5yZXM7XG5cdFx0XHRcdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MocmVzdWx0Lm1lc3NhZ2UsIGRhdGEpO1xuXHRcdFx0XHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdFx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG5cdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGQWN0aW9uRXJyb3InLCAnQWN0aW9uIGRlZmluZWQgd2l0aCBpZDogJyArIGFjdGlvbi5faWQgKyAnIG5vdCBmb3VuZC4nKTtcblx0XHRcdFx0cmVqZWN0KGVycm9yKTtcblx0XHR9XG5cdH0pO1xufTtcblxuLyoqIFxuICogUHJvY2VzcyB0YXNrXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IHRhc2sgLSB0aGUgdGFzayBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IGlucHV0RGF0YSAtIHRoZSB1c2VyIGlucHV0IGRhdGFcbiAqXG4gKiBAZXhhbXBsZSBcbiAqXG4gKiBAcmV0dXJuIFxuICpcbiAqL1xuZnVuY3Rpb24gdGFzayh0YXNrKXtcblx0cmV0dXJuICdJbXBsZW1lbnRhdGlvbiBwZW5kaW5nLi4nO1xufTtcblxuLyoqIFxuICogUHJvY2VzcyB0cmFuc2l0aW9uXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBjdXJyZW50IHByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdWJQcm9jZXNzSWQgLSB0aGUgY3VycmVudCBzdWItcHJvY2VzcyBpZFxuICogQHBhcmFtIHtzdHJpbmd9IHN0ZXBJZCAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIHN0ZXAgaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGVwSWQgLSB0aGUgY3VycmVudCBzdWItcHJvY2VzcyBzdGVwIHRyYW5zaXRpb24gaWRcbiAqIEBwYXJhbSB7b2JqZWN0fSBzdWJQcm9jZXNzTW9kZWwgLSB0aGUgY3VycmVudCBzdWItcHJvY2VzcyBtb2RlbCBpbnN0YW5jZSBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gZGF0YSAtIHRoZSB1c2VyIGlucHV0IGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSB3b3JrZmxvdyAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgXG4gKlxuICogQHJldHVybiBcbiAqXG4gKi9cbmZ1bmN0aW9uIHRyYW5zaXRpb24ocHJvY2Vzc0lkLCBzdWJQcm9jZXNzSWQsIHN0ZXBJZCwgdHJhbnNpdGlvbklkLCBkYXRhLCB3b3JrZmxvdyl7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHR0cnkge1xuXHRcdFx0dmFyIHN0ZXBTZXEgPSAwO1xuXHRcdFx0dmFyIG5leHRTdGVwSWQgPSAnJztcblx0XHRcdHZhciB0cmFuc2l0aW9uID0ge307XG5cdFx0XHR2YXIgY3VycmVudFByb2Nlc3MgPSB3b3JrZmxvdy5jb25maWcucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpQcm9jZXNzKXtcblx0XHRcdFx0aWYgKG9ialByb2Nlc3MuX2lkID09PSBwcm9jZXNzSWQpIHtcblx0XHRcdFx0XHRyZXR1cm4gb2JqUHJvY2Vzcztcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHR2YXIgY3VycmVudFN1YlByb2Nlc3MgPSBjdXJyZW50UHJvY2Vzc1swXS5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialN1YlByb2Nlc3Mpe1xuXHRcdFx0XHRpZiAob2JqU3ViUHJvY2Vzcy5faWQgPT09IHN1YlByb2Nlc3NJZCkge1xuXHRcdFx0XHRcdHJldHVybiBvYmpTdWJQcm9jZXNzO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdHZhciBjdXJyZW50U3RlcCA9IGN1cnJlbnRTdWJQcm9jZXNzWzBdLnN0ZXBzLmZpbHRlcihmdW5jdGlvbihvYmpTdGVwKXtcblx0XHRcdFx0aWYgKG9ialN0ZXAuX2lkID09PSBzdGVwSWQpIHtcblx0XHRcdFx0XHRyZXR1cm4gb2JqU3RlcDtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRpZiAoY3VycmVudFN0ZXBbMF0uYWN0aW9uc1swXSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdHRyYW5zaXRpb24gPSBjdXJyZW50U3RlcFswXS5hY3Rpb25zWzBdLnRyYW5zaXRpb25zLmZpbHRlcihmdW5jdGlvbihvYmpUcmFuc2l0aW9uKXtcblx0XHRcdFx0XHRpZiAob2JqVHJhbnNpdGlvbi5faWQgPT09IHRyYW5zaXRpb25JZCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIG9ialRyYW5zaXRpb247XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRyYW5zaXRpb24gPSBjdXJyZW50U3RlcFswXS50YXNrLnRyYW5zaXRpb25zLmZpbHRlcihmdW5jdGlvbihvYmpUcmFuc2l0aW9uKXtcblx0XHRcdFx0XHRpZiAob2JqVHJhbnNpdGlvbi5faWQgPT09IHRyYW5zaXRpb25JZCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIG9ialRyYW5zaXRpb247XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgY3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHMubGVuZ3RoOyBpKyspe1xuXHRcdFx0XHRpZiAoY3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHNbaV0uX2lkID09PSBzdGVwSWQpIHtcblx0XHRcdFx0XHRzdGVwU2VxID0gaTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjdXJyZW50U3ViUHJvY2Vzc1swXS5zdGVwcy5sZW5ndGg7IGkrKyl7XG5cdFx0XHRcdHZhciBuZXh0U3RlcFNlcSA9IHN0ZXBTZXEgKyAxO1xuXHRcdFx0XHRpZiAoaSA9PT0gbmV4dFN0ZXBTZXEpIHtcblx0XHRcdFx0XHRuZXh0U3RlcElkID0gY3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHNbaV0uX2lkO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRzd2l0Y2godHJhbnNpdGlvblswXS5fdHlwZSkge1xuXHRcdFx0XHRjYXNlICdhdXRvJzpcblx0XHRcdFx0XHRpZiAodHJhbnNpdGlvblswXS5nb1RvLl90eXBlID09PSAnbmV4dFN0ZXAnKSB7XG5cdFx0XHRcdFx0XHRzdGVwKHByb2Nlc3NJZCwgc3ViUHJvY2Vzc0lkLCBuZXh0U3RlcElkLCBzdGVwU2VxLCB7fSwgZGF0YSwgd29ya2Zsb3cpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcblx0XHRcdFx0XHRcdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1N0ZXAgdHJhbnNpdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdC5kYXRhKTtcblx0XHRcdFx0XHRcdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0XHRcdFx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG5cdFx0XHRcdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGlmICh0cmFuc2l0aW9uWzBdLl9zdG9wID09PSB0cnVlKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdBbGwgU3RlcCB0cmFuc2l0aW9ucyBoYXZlIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywge30pO1xuXHRcdFx0XHRcdFx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAndXNlcic6XG5cdFx0XHRcdFx0aWYgKHRyYW5zaXRpb25bMF0uZ29Uby5fdHlwZSA9PT0gJ25leHRTdGVwJykge1xuXHRcdFx0XHRcdFx0c3RlcChwcm9jZXNzSWQsIHN1YlByb2Nlc3NJZCwgbmV4dFN0ZXBJZCwgc3RlcFNlcSwge30sIGRhdGEsIHdvcmtmbG93KS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG5cdFx0XHRcdFx0XHRcdHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdGVwIHRyYW5zaXRpb24gY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCByZXN1bHQuZGF0YSk7XG5cdFx0XHRcdFx0XHRcdHJlc29sdmUoc3VjY2Vzcyk7XG5cdFx0XHRcdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuXHRcdFx0XHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAodHJhbnNpdGlvblswXS5nb1RvLl90eXBlID09PSAnc3RlcElkJykge1xuXHRcdFx0XHRcdFx0dmFyIGdvVG9TdGVwSWQgPSB0cmFuc2l0aW9uWzBdLmdvVG8uX3N0ZXBJZDtcblx0XHRcdFx0XHRcdHZhciBnb1RvU3RlcFNlcSA9IDE7XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGN1cnJlbnRTdWJQcm9jZXNzWzBdLnN0ZXBzLmxlbmd0aDsgaSsrKXtcblx0XHRcdFx0XHRcdFx0aWYgKGN1cnJlbnRTdWJQcm9jZXNzWzBdLnN0ZXBzW2ldLl9pZCA9PT0gZ29Ub1N0ZXBJZCkge1xuXHRcdFx0XHRcdFx0XHRcdGdvVG9TdGVwU2VxID0gaSArIDE7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHN0ZXAocHJvY2Vzc0lkLCBzdWJQcm9jZXNzSWQsIGdvVG9TdGVwSWQsIGdvVG9TdGVwU2VxLCB7fSwgZGF0YSwgd29ya2Zsb3cpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcblx0XHRcdFx0XHRcdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1N0ZXAgdHJhbnNpdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdC5kYXRhKTtcblx0XHRcdFx0XHRcdFx0cmVzb2x2ZShzdWNjZXNzKTtcblx0XHRcdFx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG5cdFx0XHRcdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGlmICh0cmFuc2l0aW9uWzBdLl9zdG9wID09PSB0cnVlKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdBbGwgU3RlcCB0cmFuc2l0aW9ucyBoYXZlIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywge30pO1xuXHRcdFx0XHRcdFx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRpZiAodHJhbnNpdGlvblswXS5fc3RvcCA9PT0gdHJ1ZSkge1xuXHRcdFx0XHRcdFx0dmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0FsbCBTdGVwIHRyYW5zaXRpb25zIGhhdmUgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7fSk7XG5cdFx0XHRcdFx0XHRyZXNvbHZlKHN1Y2Nlc3MpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRjAwNScsJycpO1xuXHRcdFx0XHRcdFx0cmVqZWN0KGVycm9yKTtcblx0XHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBjYXRjaChlcnIpe1xuXHRcdFx0cmVqZWN0KGVycik7XG5cdFx0fVxuXHR9KTtcbn07XG5cbi8qKiBcbiAqIFByb2Nlc3MgcG9zdEFjdGlvbnNcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gcG9zdEFjdGlvbnMgLSB0aGUgcG9zdEFjdGlvbnMgY29uZmlnIGRhdGFcbiAqXG4gKiBAZXhhbXBsZSBcbiAqXG4gKiBAcmV0dXJuIFxuICpcbiAqL1xuZnVuY3Rpb24gcG9zdEFjdGlvbnMocG9zdEFjdGlvbnMpe1xuXHRyZXR1cm4gJ0ltcGxlbWVudGF0aW9uIHBlbmRpbmcuLic7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHsgXG5cbiBcdHByZVJlcXVpc2l0ZXM6IHByZVJlcXVpc2l0ZXMsXG4gXHRwcmVBY3Rpb25zOiBwcmVBY3Rpb25zLFxuIFx0c3ViUHJvY2Vzczogc3ViUHJvY2VzcyxcbiBcdHRhc2s6IHRhc2ssXG4gXHR0cmFuc2l0aW9uOiB0cmFuc2l0aW9uXG5cbn0iLCIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogVXRpbGl0eSBNb2R1bGVcbiAqXG4gKiBAbW9kdWxlIG1vZHVsZXMvdXRpbFxuICogQGF1dGhvciBCcmVudCBHb3Jkb25cbiAqIEB2ZXJzaW9uIDIuMC4wXG4gKiBAZGVzY3JpcHRpb24gXG4gKiBAY29weXJpZ2h0IEt3YW50dSBMdGQgUlNBIDIwMDktMjAxNS5cbiAqXG4gKi9cblxuIG1vZHVsZS5leHBvcnRzID0geyBcblxuIFx0c3VjY2VzczogZnVuY3Rpb24obWVzc2FnZSwgZGF0YSl7XG5cdFx0dmFyIHJlc3VsdCA9IHtcblx0XHRcdG1lc3NhZ2U6IG1lc3NhZ2UsXG5cdFx0XHRkYXRhOiBkYXRhXG5cdFx0fVxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH0sXG5cblx0d2FybjogZnVuY3Rpb24obWVzc2FnZSwgZGF0YSl7XG5cdFx0dmFyIHJlc3VsdCA9IHtcblx0XHRcdHdhcm5pbmc6IG1lc3NhZ2UsXG5cdFx0XHRkYXRhOiBkYXRhXG5cdFx0fVxuXHRcdGNvbnNvbGUud2FybihkYXRhKTtcblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9LFxuXG5cdGVycm9yOiBmdW5jdGlvbihjb2RlLCBtZXNzYWdlKXtcblx0XHR2YXIgZXJyID0gbmV3IEVycm9yKCcnKTtcblx0XHRlcnIubmFtZSA9IGNvZGU7XG5cdFx0ZXJyLm1lc3NhZ2UgPSBtZXNzYWdlO1xuXHRcdHJldHVybiBlcnI7XG5cdH0sXG5cbiBcdHN5bmNMb29wOiBmdW5jdGlvbihpdGVyYXRpb25zLCBwcm9jZXNzLCBleGl0KXsgIFxuXHQgICAgdmFyIGluZGV4ID0gMCxcblx0ICAgICAgICBkb25lID0gZmFsc2UsXG5cdCAgICAgICAgc2hvdWxkRXhpdCA9IGZhbHNlO1xuXHQgICAgdmFyIGxvb3AgPSB7XG5cdCAgICAgICAgbmV4dDpmdW5jdGlvbigpe1xuXHQgICAgICAgICAgICBpZihkb25lKXtcblx0ICAgICAgICAgICAgICAgIGlmKHNob3VsZEV4aXQgJiYgZXhpdCl7XG5cdCAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGV4aXQoKTsgLy8gRXhpdCBpZiB3ZSdyZSBkb25lXG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgLy8gSWYgd2UncmUgbm90IGZpbmlzaGVkXG5cdCAgICAgICAgICAgIGlmKGluZGV4IDwgaXRlcmF0aW9ucyl7XG5cdCAgICAgICAgICAgICAgICBpbmRleCsrOyAvLyBJbmNyZW1lbnQgb3VyIGluZGV4XG5cdCAgICAgICAgICAgICAgICBwcm9jZXNzKGxvb3ApOyAvLyBSdW4gb3VyIHByb2Nlc3MsIHBhc3MgaW4gdGhlIGxvb3Bcblx0ICAgICAgICAgICAgLy8gT3RoZXJ3aXNlIHdlJ3JlIGRvbmVcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIGRvbmUgPSB0cnVlOyAvLyBNYWtlIHN1cmUgd2Ugc2F5IHdlJ3JlIGRvbmVcblx0ICAgICAgICAgICAgICAgIGlmKGV4aXQpIGV4aXQoKTsgLy8gQ2FsbCB0aGUgY2FsbGJhY2sgb24gZXhpdFxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBpdGVyYXRpb246ZnVuY3Rpb24oKXtcblx0ICAgICAgICAgICAgcmV0dXJuIGluZGV4IC0gMTsgLy8gUmV0dXJuIHRoZSBsb29wIG51bWJlciB3ZSdyZSBvblxuXHQgICAgICAgIH0sXG5cdCAgICAgICAgYnJlYWs6ZnVuY3Rpb24oZW5kKXtcblx0ICAgICAgICAgICAgZG9uZSA9IHRydWU7IC8vIEVuZCB0aGUgbG9vcFxuXHQgICAgICAgICAgICBzaG91bGRFeGl0ID0gZW5kOyAvLyBQYXNzaW5nIGVuZCBhcyB0cnVlIG1lYW5zIHdlIHN0aWxsIGNhbGwgdGhlIGV4aXQgY2FsbGJhY2tcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgbG9vcC5uZXh0KCk7XG5cdCAgICByZXR1cm4gbG9vcDtcblx0fSxcblxuXHRjb21wYXJlOiBmdW5jdGlvbihzdWJqZWN0LCBvcGVyYXRvciwgdmFsdWUpIHtcblx0ICBcdHN3aXRjaCAob3BlcmF0b3IpIHtcblx0ICBcdFx0Y2FzZSAnZ3JlYXRlclRoYW4nOiAgIFx0IFxuXHRcdFx0XHRyZXR1cm4gc3ViamVjdCA+IHZhbHVlO1xuXHRcdFx0Y2FzZSAnbGVzc1RoYW4nOiAgIFx0XHQgXG5cdFx0XHRcdHJldHVybiBzdWJqZWN0IDwgdmFsdWU7XG5cdFx0XHRjYXNlICdncmVhdGVyVGhhbkVxdWFsJzogXG5cdFx0XHRcdHJldHVybiBzdWJqZWN0ID49IHZhbHVlO1xuXHRcdFx0Y2FzZSAnbGVzc1RoYW5FcXVhbCc6ICBcdCBcblx0XHRcdFx0cmV0dXJuIHN1YmplY3QgPD0gdmFsdWU7XG5cdFx0XHRjYXNlICdlcXVhbFRvJzogXHRcdCBcblx0XHRcdFx0cmV0dXJuIHN1YmplY3QgPT09IHZhbHVlO1xuXHRcdFx0Y2FzZSAnbm90RXF1YWxUbyc6IFx0XHQgXG5cdFx0XHRcdHJldHVybiBzdWJqZWN0ICE9PSB2YWx1ZTtcblx0ICBcdH1cblx0fVxuXHRcbiB9Il19
