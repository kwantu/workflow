(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Workflow = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function Workflow(e,s,t,o){var r=this;if(""==s||void 0==s)throw util.error("ParamRequired","A community id is required.");if("string"!=typeof s)throw new Error("The community id must be a javascript string.");if(r.communityId=s||"",""==e||void 0==e)throw util.error("ParamRequired","A profile id is required.");if("string"!=typeof e)throw new Error("The profile id must be a javascript string.");if(r.profile=e||"",""==t||void 0==t)throw util.error("ParamRequired","An app id is required.");if("string"!=typeof t)throw new Error("The app id must be a javascript string.");if(r.app=t||"",""==o||void 0==o)throw util.error("ParamRequired","A workflow configuration is required.");"object"!=typeof o?r.config=JSON.parse(o):r.config=o,r.instance,r.subprocesses=[],r.indicators=[]}var Process=require("./lib/process"),util=require("utility"),userInterface=require("./lib/interface"),helper=require("./lib/helper");Workflow.prototype.getProfile=function(){return this.profile},Workflow.prototype.getApp=function(){return this.app},Workflow.prototype.getConfig=function(){return this.config},Workflow.prototype.getInstance=function(){return this.instance},Workflow.prototype.setInstance=function(e){this.instance=e},Workflow.prototype.getSubProcesses=function(){return this.subprocesses},Workflow.prototype.setSubProcesses=function(e){this.subprocesses=e},Workflow.prototype.getIndicators=function(){return this.indicators},Workflow.prototype.setIndicators=function(e){this.indicators=e},Workflow.prototype.create=function(){var e=this;return new Promise(function(s,t){try{if(void 0!==e.instance){var o=util.warn("Instance already exists.",e);s(o)}else{var r={_id:"",version:"",type:"workflowInstance",processes:[],channels:["community_"+app.SCOPE.getCommunityId(),"profile_"+app.SCOPE.profileId,"application_"+app.SCOPE.applicationId,"community_"+app.SCOPE.getCommunityId()+"_application_"+app.SCOPE.applicationId]};r._id="_local/"+e.profile+":processes",r.version=e.config.version,e.instance=r;var i=util.success("Workflow processes instance created successfully.",e);s(i)}}catch(e){t(e)}})},Workflow.prototype.initialise=function(e,s,t){var o=this;return new Promise(function(r,i){try{var n=[];if(""!==e&&void 0!==e){if(n=o.config.processes.filter(function(s){if(s._id==e)return s}),void 0==n[0]._id){var c=util.error("WFConfigError","No valid process definition found with process id: "+e);i(c)}}else n.push(o.config.processes[0]),e=o.config.processes[0]._id;var a=function(e){for(var s="",t=0;t<e.length-1;t++)s=s+"'"+e[t]+"',";return"("+s+"'"+e[e.length-1]+"')"},u=n[0].subProcesses[0]._id,p=n[0].subProcesses[0].instanceType,f=JSON.xpath("indicators/_id",n[0].subProcesses[0],{}),d=function(e){var s=JSON.xpath("/indicators[setId = "+a(e)+" and cardinality eq 'single' ]/setId",app.SCOPE.APP_CONFIG,{}),t=s.length;if(t>0){var r=JSON.xpath("/processes/subProcesses[indicators/_id = "+a(s)+"]/_id",o.config,{}),i=JSON.xpath("count(/instance/processes/subProcesses[id = "+a(r)+" and complete = false()])",o,{})[0];return 0==i}if(void 0!=p.newSequence){var i=JSON.xpath("count(/instance/processes/subProcesses[id eq '"+u+"' and complete eq 'false'])",o,{})[0];return 0==i}return void 0!=p.newInstance,!0};if(d(f)){var l=[];o.instance.processes.filter(function(s){s.id==e&&l.push(s)});var h=l.length+1,v={id:"",seq:"",subProcesses:[]};v.id=e,v.seq=h,o.instance.processes.push(v);var m=n[0].subProcesses[0]._id,P=1;o.instance.processes.filter(function(s){s.id==e&&s.seq==h&&(P=s.subProcesses.length+1)});var b=generateUUID();void 0!=s.subprocessUUID&&s.subprocessUUID.length>0&&(b=s.subprocessUUID);var g={communityId:app.SCOPE.communityId,uuid:b,userId:_lclx.SUBSCRIPTIONS.userId,transactionType:"subProcess",documents:[{document:b,rev:"0"}]};dao.startTransaction(g).then(function(n){Process.subProcess(b,e,h,m,P,t,s,o).then(function(s){var n=s.data._id,c=s.data.groupKey;void 0==t&&(t="");var a={id:m,subprofileId:t,seq:s.data["meta-data"].subProcessInsSeq,uuid:n,groupKey:c,label:s.data.label};v.subProcesses.push(a);for(var u=0;u<o.instance.processes.length;u++){var p=o.instance.processes[u];p.id==e&&p.seq==h&&o.instance.processes.splice(u,1,v)}var f=s.data.indicators,d=s.data.step;Process.indicatorDocs(e,f,d,o,n).then(function(e){var s=util.success("Process: "+o.config.processes[0]._id+" initialized successfully.",a);r(s)},function(e){i(e)})},function(s){o.instance.processes=o.instance.processes.filter(function(s){return!(s.id==e&&s.seq==h)}),console.log(s),i(s)})}).catch(function(e){console.log(e),i(void 0!=e.responseJSON&&void 0!=e.responseJSON.message?e.responseJSON.message:void 0!=e.responseText?e.responseText:e)})}else i("Cannot create workflow as other process using same SDO is not complete")}catch(e){i(e)}})},Workflow.prototype.transition=function(e,s,t,o,r,i,n,c){var a=this;return new Promise(function(o,u){try{var p=JSON.xpath("/subprocesses[_id eq '"+c+"']/step",app.SCOPE.workflow,{})[0],f=JSON.xpath("/processes[_id eq '"+e+"']/subProcesses[_id eq '"+t+"']/steps[_id eq '"+r+"']",a.config,{})[0],d=JSON.xpath("/subprocesses[_id eq '"+c+"']/meta-data/subProcessInsSeq",app.SCOPE.workflow,{})[0],l=function(r,i){a.instance.processes.filter(function(n){n.id==e&&n.seq==s&&n.subProcesses.filter(function(e){e.id==t&&a.subprocesses.filter(function(e){if(e._id==c)if("step"==r){e.step=i.data.step;var s=util.success(i.message,e);o(s)}else if("stepComplete"==r){e.step=i.data.step,e.complete=!0;var t=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+e._id+"']",app.SCOPE.workflow,{})[0];t.complete=!0;var s=util.success(i.message,e.step);o(s)}})})})},h={};void 0!=f.function.task&&void 0!=f.function.task.postActions?(h=f.function.task.postActions,Process.postActions(h,a,c).then(function(o){Process.transition(e,s,t,d,r,i,n,a,c,p).then(function(e){e.data.subProcessComplete?l("stepComplete",e):l("step",e)},function(e){u(e)})},function(e){u(e)})):void 0!=f.function.server&&void 0!=f.function.server.postActions?(h=f.function.server.postActions,Process.postActions(h,a,c).then(function(o){Process.transition(e,s,t,d,r,i,n,a,c,p).then(function(e){e.data.subProcessComplete?l("stepComplete",e):l("step",e)},function(e){u(e)})},function(e){u(e)})):Process.transition(e,s,t,d,r,i,n,a,c,p).then(function(e){e.data.subProcessComplete?l("stepComplete",e):l("step",e)},function(e){u(e)})}catch(e){u(e)}})},Workflow.prototype.assignUser=function(e,s,t,o,r,i){var n=this;return new Promise(function(c,a){try{var u=JSON.xpath("/subprocesses[_id eq '"+i+"']",app.SCOPE.workflow,{})[0],p=u._rev;({communityId:app.SCOPE.communityId,uuid:i,userId:_lclx.SUBSCRIPTIONS.userId,transactionType:"subProcess",documents:[{document:i,rev:p}]});Process.assignUser(e,s,t,o,r,i,n).then(function(e){c(e)},function(e){a(e)})}catch(e){a(e)}})},Workflow.prototype.ui=function(){var e=this;return{getProcess:function(s,t){return new Promise(function(o,r){try{userInterface.getProcess(s,t,e).then(function(e){o(e)},function(e){r(e)})}catch(e){r(e)}})}}},Workflow.prototype.getNodeValue=function(e,s){var t=this;return new Promise(function(o,r){try{helper.getNodeValue(e,t,s).then(function(e){o(e)},function(e){r(e)})}catch(e){r(e)}})},Workflow.prototype.takeAssignment=function(e){var s=this;return new Promise(function(t,o){try{var r=JSON.xpath("/subprocesses[_id eq '"+e+"']",s,{})[0],i=JSON.xpath("/step/assignedTo",r,{})[0];void 0==r.step.assignmentHistory&&(r.step.assignmentHistory=[]),""!=i.userId&&""!=i.name&&r.step.assignmentHistory.push(JSON.parse(JSON.stringify(i))),i.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,i.userId=_lclx.SUBSCRIPTIONS.userId+"",i.dateTime=moment().format(),i.type=ASSIGNMENT_TYPE_ACCEPTANCE,i.dueDateTime="",i.by=_lclx.SUBSCRIPTIONS.userId+"";var n=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+e+"']/id",s,{})[0],c=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+e+"']/id",s,{})[0],a=JSON.xpath("/subprocesses[_id eq '"+e+"']/step/id",s,{})[0],u=JSON.xpath("/processes[_id eq '"+n+"']/subProcesses[_id eq '"+c+"']/steps[_id eq '"+a+"']",s.config,{})[0];if(void 0!=u.function.task.preWorkActions){var p=u.function.task.preWorkActions;Process.preWorkActions(p,s).then(function(e){t(s)},function(e){o(e)})}else t(s)}catch(e){o(e)}})},Workflow.prototype.condition=function(e,s){var t=this;return new Promise(function(o,r){try{var i=e.operator,n=e.value.data;if(void 0!=e.subject.indicator){var c=e.subject.indicator.setId,a=e.subject.indicator.modelScope,u=e.subject.indicator.elementPath;if("subProcess"==e.subject.indicator.context){for(var p=JSON.xpath("/subprocesses[_id eq '"+s+"']/indicators[id eq '"+c+"']/instances[1]/uuid",t,{})[0],f=JSON.xpath("/indicators[_id eq '"+p+"']",t,{})[0],d=f.model[a].data[c],l=d,h=""==u?[]:u.split(/['"\[\].]+/),v=0;v<h.length;v++)""!=h[v]&&(l=l[h[v]]);var m=l;helper.getNodeValue(n,t,s).then(function(e){var s=helper.compare(m,i,e);o(s)},function(e){r(e)})}else if("subProfile"==e.subject.indicator.context){for(var f=JSON.xpath("/indicators[category/term eq '"+c+"']",t,{})[0],d=f.model[a].data[c],l=d,h=""==u?[]:u.split(/['"\[\].]+/),v=0;v<h.length;v++)""!=h[v]&&(l=l[h[v]]);var m=l;helper.getNodeValue(n,t,s).then(function(e){var s=helper.compare(m,i,e);o(s)},function(e){r(e)})}else r("Not implemented")}else if(void 0!=e.subject.indicatorWrapper)r("Not implemented");else if(void 0!=e.subject.variable)helper.getNodeValue(n,t,s).then(function(n){helper.getNodeValue(e.subject,t,s).then(function(e){var s=helper.compare(e,i,n);o(s)},function(e){r(e)})},function(e){r(e)});else if(void 0!=e.subject.subProcess){for(var u=e.subject.subProcess.elementPath,P=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],l=P,h=""==u?[]:u.split(/['"\[\].]+/),v=0;v<h.length;v++)""!=h[v]&&(l=l[h[v]]);var m=l;helper.getNodeValue(n,t,s).then(function(e){var s=helper.compare(m,i,e);o(s)},function(e){r(e)})}}catch(e){r(e)}})},module.exports=Workflow;

},{"./lib/helper":4,"./lib/interface":5,"./lib/process":7,"utility":8}],2:[function(require,module,exports){
"use strict";var util=require("utility"),nodeValue=require("./nodeValue"),form=require("./form"),helper=require("./helper"),gatekeeper=new GK,community=function(){return{createCommunity:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=_lclx.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/indicators[category/term eq 'Community']/_id",t,{})[0],r={createCommunity:{newCommunityId:t.profile,indicatorUUID:{Community:s}}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processed successfully.",o);e(n)},function(e){o(e)})})},userJoinCommunity:function(e,i,t){return new Promise(function(e,i){})},releaseAdoptedApplication:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=_lclx.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'adoptedApplication']/instances[1]/uuid",t,{})[0],r={releaseAdoptedApplication:{communityId:t.profile,indicatorUUID:{adoptedApplication:s}}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})}}}(),application=function(){return{createAppDefinition:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=_lclx.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/indicators[category/term eq 'Application']/_id",t,{})[0],r={createApplication:{newApplicationId:t.profile,indicatorUUID:{Application:s}}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})},buildApplication:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=_lclx.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'PublishApplication']/instances[1]/uuid",t,{})[0],r=JSON.xpath("/indicators[category/term eq 'ApplicationDefinition']/_id",t,{})[0],c=JSON.xpath("/indicators[category/term eq 'Roles']/_id",t,{})[0],p=JSON.xpath("/indicators[category/term eq 'Application']/_id",t,{})[0],d=JSON.xpath("/indicators[category/term eq 'AppPermissions']/_id",t,{})[0],u={buildApplication:{applicationId:t.profile,indicatorUUID:{PublishApplication:s,ApplicationDefinition:r,Roles:c,Application:p,AppPermissions:d}}};a.action=u,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})},applicationAdoption:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=_lclx.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'Adoption']/instances[1]/uuid",t,{})[0],r=JSON.xpath("/indicators[category/term eq 'PublishApplication']/_id",t,{})[0],c=JSON.xpath("/indicators[category/term eq 'Application']/_id",t,{})[0],p={adoptApplication:{applicationId:t.profile,indicatorUUID:{Adoption:s,PublishApplication:r,Application:c}}};a.action=p,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})},createTaxonomy:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=_lclx.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'Taxonomy']/instances[1]/uuid",t,{})[0],r={createTaxonomy:{taxonomyUUID:s}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})}}}(),performance=function(){return{unlockPeriod:function(e,i,t){return new Promise(function(e,o){var a=JSON.xpath("/subprocesses[_id eq '"+i+"']",t,{})[0],n=JSON.xpath("/indicators[id eq '"+PERIOD_SET_ID+"' or id eq '"+AUDIT_PERIOD_SET_ID+"']/instances/uuid",a,{})[0],s=a.dates.valid;library.unlockPeriod(n,s,i).then(function(i){var t=util.success("Unlock period.",i);e(t)},function(e){o(e)})})},setModelStatus:function(e,i,t){return new Promise(function(o,a){var n=JSON.xpath("/subprocesses[_id eq '"+i+"']",t,{})[0],s=JSON.xpath("/indicators[id eq '"+PERIOD_SET_ID+"' or id eq '"+AUDIT_PERIOD_SET_ID+"']/instances/uuid",n,{})[0],r=n.dates.valid,c=JSON.xpath("/label",e,{})[0],p=helper.getLanguageMessage(c);library.setPeriodStatus(s,r,p,i).then(function(e){var i=util.success("setModelStatus",e);o(i)},function(e){a(e)})})},lockPerformanceModel:function(e,i,t){return new Promise(function(e,o){var a=JSON.xpath("/subprocesses[_id eq '"+i+"']",t,{})[0],n=JSON.xpath("/indicators[id eq '"+PERFORMANCE_SET_ID+"']/instances/uuid",a,{})[0],s=a.dates.valid;library.lockPerformanceModel(n,s,i).then(function(i){var t=util.success("Lock performance model.",i);e(t)},function(e){o(e)})})}}}(),sdo=function(){return{create:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=_lclx.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'SDO']/instances[1]/uuid",t,{})[0],r={createSDO:{sdoUUID:s}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})}}}(),taxonomy=function(){return{create:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=_lclx.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'Taxonomy']/instances[1]/uuid",t,{})[0],r={createTaxonomy:{taxonomyUUID:s}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})}}}(),subProcessInstance=function(){return{setTitle:function(e,i,t,o){return new Promise(function(e,a){var n=JSON.xpath("/subprocesses[_id eq '"+i+"']",app.SCOPE.workflow,{})[0],s=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+i+"']",app.SCOPE.workflow,{})[0];void 0!=s&&(s.label=t),n.label=t;var r=[],c={};c.model=o.subprocesses,r.push(c);var p=util.success("Subprocess setTitle success.",o.subprocesses);e(p)})},setValidDate:function(e,i,t,o){return new Promise(function(e,a){var n=JSON.xpath("/subprocesses[_id eq '"+i+"']",app.SCOPE.workflow,{})[0];n.dates.valid=t;var s=[],r={};r.model=n,s.push(r);var c=util.success("valid date set.",o.subprocesses);e(c)})},setSPStatus:function(e,i,t,o){return new Promise(function(e,a){var n=JSON.xpath("/subprocesses[_id eq '"+i+"']",app.SCOPE.workflow,{})[0];n.spStatus=t;var s=[],r={};r.model=o.subprocesses,s.push(r);var c=util.success("Subprocess spStatus success.",o.subprocesses);e(c)})}}}(),variables=function(){return{setVariable:function(e,i,t){return new Promise(function(o,a){helper.getNodeValue(e.data,i,t).then(function(n){var s=e.scope,r=e.name,c=e.variableType,p=JSON.xpath("/subprocesses[_id eq '"+t+"']/dates/valid",i,{})[0];switch(s){case"profile":var d=i.profile,u=d+":variables",l=app.SCOPE.txn;dao.get(u).then(function(e){for(var s={},d=function(){if("periodic"==c){var d=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+t+"']/id]/type",i,{})[0],u=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id])",i,{})[0]+1;if(d==PROCESS_TYPE_SUBPROFILE){var l=library.getSubprofileSubprocessIds();u=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+l+"])",i,{})[0]+1}var f={subProcessUUID:t,user:{userName:_lclx.SUBSCRIPTIONS.username,userId:_lclx.SUBSCRIPTIONS.userProfileId},seq:u,validDate:p,value:n};if(void 0!=e[r]){for(var m=e,I=""==r?[]:r.split(/['"\[\].]+/),g=0;g<I.length;g++)""!=I[g]&&(m=m[I[g]]);m.push(f)}else e[r]=[f]}else e[r]=n;dao.save(e).then(function(e){s.rev=e.rev,o("Variable set successfully")}).catch(function(e){a("Failed to set Variable")})},f=!1,m=0;m<l.documents.length;m++)u==l.documents[m].document&&(s=l.documents[m],f=!0);f?d():(l=JSON.parse(JSON.stringify(app.SCOPE.txn)),l.documents=[],s={document:u,rev:void 0==e._rev?"0":e._rev},l.documents.push(s),app.SCOPE.txn.documents.push(s),dao.updateTransaction(l).then(function(e){d()}).catch(function(e){console.log(e),a(void 0!=e.responseJSON&&void 0!=e.responseJSON.message?e.responseJSON.message:void 0!=e.responseText?e.responseText:e)}))}).catch(function(e){var s={_id:u};if(s.channels=app.profile.channels,"periodic"==c){var d=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+t+"']/id]/type",i,{})[0],l=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id])",i,{})[0]+1;if(d==PROCESS_TYPE_SUBPROFILE){var f=library.getSubprofileSubprocessIds();l=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+f+"])",i,{})[0]+1}s[r]=[{subProcessUUID:t,user:{userName:_lclx.SUBSCRIPTIONS.username,userId:_lclx.SUBSCRIPTIONS.userProfileId},seq:l,validDate:p,value:n}]}else s[r]=n;var m=JSON.parse(JSON.stringify(app.SCOPE.txn));m.documents=[];var I={document:u,rev:void 0==s._rev?"0":s._rev};m.documents.push(I),app.SCOPE.txn.documents.push(I),dao.updateTransaction(m).then(function(e){dao.save(s).then(function(e){I.rev=e.rev,o("Variable set successfully")}).catch(function(e){a("Failed to set Variable")})}).catch(function(e){console.log(e),a(void 0!=e.responseJSON&&void 0!=e.responseJSON.message?e.responseJSON.message:void 0!=e.responseText?e.responseText:e)})});break;case"subProcessInstance":o("not implemented");break;case"step":o("not implemented");break;case"subProfileSubProcessInstance":var f=app.profile.subprofileId,m=f+":variables",l=app.SCOPE.txn;dao.get(m).then(function(e){for(var s={},d=function(){if("periodic"==c){var d=library.getSubprofileSubprocessIds(),u=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+d+"])",i,{})[0]+1,l={subProcessUUID:t,user:{userName:_lclx.SUBSCRIPTIONS.username,userId:_lclx.SUBSCRIPTIONS.userProfileId},seq:u,validDate:p,value:n};if(void 0!=e[r]){for(var f=e,m=""==r?[]:r.split(/['"\[\].]+/),I=0;I<m.length;I++)""!=m[I]&&(f=f[m[I]]);f.push(l)}else e[r]=[l]}else e[r]=n;dao.save(e).then(function(e){s.rev=e.rev,o("Variable at subprofile set successfully")}).catch(function(e){a("Failed to set Variable at subprofile")})},u=!1,f=0;f<l.documents.length;f++)m==l.documents[f].document&&(s=l.documents[f],u=!0);u?d():(l=JSON.parse(JSON.stringify(app.SCOPE.txn)),l.documents=[],s={document:m,rev:void 0==e._rev?"0":e._rev},l.documents.push(s),app.SCOPE.txn.documents.push(s),dao.updateTransaction(l).then(function(e){d()}).catch(function(e){console.log(e),a(void 0!=e.responseJSON&&void 0!=e.responseJSON.message?e.responseJSON.message:void 0!=e.responseText?e.responseText:e)}))}).catch(function(e){var s={_id:m};if(s.channels=app.profile.channels,"periodic"==c){var d=library.getSubprofileSubprocessIds(),u=JSON.xpath("count(/subprocesses[_id eq '"+t+"']/preceding-sibling::node()[id = /subprocesses[_id eq '"+t+"']/id and _id = /subprocesses[_id = "+d+"]/_id])",i,{})[0]+1;s[r]=[{subProcessUUID:t,user:{userName:_lclx.SUBSCRIPTIONS.username,userId:_lclx.SUBSCRIPTIONS.userProfileId},seq:u,validDate:p,value:n}]}else s[r]=n;var l=JSON.parse(JSON.stringify(app.SCOPE.txn));l.documents=[];var f={document:m,rev:void 0==s._rev?"0":s._rev};l.documents.push(f),app.SCOPE.txn.documents.push(f),dao.updateTransaction(l).then(function(e){dao.save(s).then(function(e){f.rev=e.rev,o("Variable at subprofile set successfully")}).catch(function(e){a("Failed to set Variable at subprofile")})}).catch(function(e){console.log(e),a(void 0!=e.responseJSON&&void 0!=e.responseJSON.message?e.responseJSON.message:void 0!=e.responseText?e.responseText:e)})})}},function(e){a("getNodeValue value not found.")})})}}}(),notification=function(){return{sendNotificationWorker:function(e,i,t){return new Promise(function(o,a){var n=function(e){return new Promise(function(o,a){var n={};if(void 0!=e.recipients.role)n.role=e.recipients.role,o(n);else if(void 0!=e.recipients.profileRole)n.profileRole={},n.profileRole.role=e.recipients.profileRole.role,n.profileRole.profile=e.recipients.profileRole.profile,o(n);else if(void 0!=e.recipients.subProfileRole)n.subProfileRole={},n.subProfileRole.role=e.recipients.subProfileRole.role,n.subProfileRole.subProfileCategory=e.recipients.subProfileRole.subProfileCategory,n.subProfileRole.profile=e.recipients.subProfileRole.profile,o(n);else if(void 0!=e.recipients.function)n.function={},n.function.users={},helper.getNodeValue(e.recipients.function.users,i,t).then(function(e){n.function.users=e,o(n)},function(e){rej(e)});else if(void 0!=e.recipients.stepAssignee)n.stepAssignee={},n.stepAssignee.role=e.recipients.stepAssignee.role,o(n);else if(void 0!=e.recipients.stepAssigneeFromStep){n.stepAssigneeFromStep={};var s=e.recipients.stepAssigneeFromStep.stepId;n.stepAssigneeFromStep.stepId=s;for(var r=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],c={},p=0;p<r.history.length;p++)r.history[p].id==s&&(c=r.history[p]);if(void 0!=c.assignmentHistory&&c.assignmentHistory.length>0){var d=c.assignmentHistory[c.assignmentHistory.length-1];n.stepAssigneeFromStep.userId=d.userId}o(n)}else if(void 0!=e.recipients.indicator){n.indicator={};var u=e.recipients.indicator.indicatorSetId,l=e.recipients.indicator.elementId,f=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+u+"']/instances/uuid",i,{})[0],m=JSON.xpath("/indicators[_id eq '"+f+"']",i,{})[0],I="/model/pending/data/"+u+"/"+l,g=JSON.xpath(I,m,{})[0];n.indicator.userId=g,o(n)}})},s=new NotificatioWorker(app),r=JSON.xpath("/subprocesses[_id eq '"+t+"']/meta-data/subprofileId",i,{})[0],c=DOMAIN.replace("exist/rest",""),p="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(p=app.profile.subprofileId);var d={notification:{message:{},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:t,subProfileId:r},notificationType:"",subprofileId:p,priority:"",recipients:{},url:c,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:"",validDate:"",dueDate:""},notification:{createdDateTime:moment().format()},step:{stepCreatedDateTime:"",stepName:"",stepId:""},node:{title:""},userDefined:[]}}},u=JSON.xpath("/indicators[_id eq '"+app.profile._id+"']/title",i,{})[0];d.notification.keys.profile.name=u,d.notification.keys.profile.id=app.profile._id,d.notification.keys.community.name=app.getNameByLang(_lclx.COMMUNITY_CONFIG.communityName),d.notification.keys.community.id=_lclx.COMMUNITY_CONFIG.communityId;var l=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",_lclx.COMMUNITY_CONFIG,{})[0];d.notification.keys.application.name=app.getNameByLang(l.name),d.notification.keys.application.id=l.appId,d.notification.keys.currentUser.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,d.notification.keys.currentUser.id=_lclx.SUBSCRIPTIONS.userId;var f=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];void 0!=e.sdoKeys&&e.sdoKeys.forEach(function(e){if(""!=e.field&&""!=e.repStr&&""!=e.setId){var t={};i.indicators.forEach(function(i){i.category.term==e.setId&&(t=i)});var o="";void 0!=t.model&&void 0!=t.model.pending&&void 0!=t.model.pending.data&&void 0!=t.model.pending.data[e.setId]&&void 0!=t.model.pending.data[e.setId][e.field]&&(o=t.model.pending.data[e.setId][e.field]),d.notification.keys.userDefined.push({key:"#"+e.repStr+"#",value:o})}}),d.notification.keys.subProcess.name=f.label,d.notification.keys.subProcess.id=t,d.notification.keys.subProcess.validDate=f.dates.valid,d.notification.keys.subProcess.dueDate=f.dates.due;try{var m=f.step;d.notification.keys.step.stepCreatedDateTime=m.dateTimeCreated,d.notification.keys.step.stepId=m.id;var I=JSON.xpath("/processes/subProcesses[_id eq '"+f.id+"']/steps[_id eq '"+m.id+"']",app.SCOPE.workflow.config,{})[0];d.notification.keys.step.stepName=app.getNameByLang(I.name)}catch(e){}var g=JSON.xpath("/indicators[_id eq '"+p+"']/title",app.SCOPE.workflow,{})[0];if(void 0==g?d.notification.keys.node.title="":d.notification.keys.node.title=g,d.notification.message.default=e.message.default,d.notification.message.title=e.message.title,void 0!=e.message.rtf&&(d.notification.message.rtf={},void 0!=e.message.rtf.template?d.notification.message.rtf.template=e.message.rtf.template:void 0!=e.message.rtf.markup&&(d.notification.message.rtf.markup=e.message.rtf.markup)),d.notification.messageType=e.messageType,d.notification.notificationType=e.notificationType,d.notification.priority=e.priority,void 0!=e.notificationAction&&(d.notification.notificationAction={},d.notification.notificationAction.label=e.notificationAction.label,void 0!=e.notificationAction.action.URI?(d.notification.notificationAction.action={},d.notification.notificationAction.action.URI=e.notificationAction.action.URI):void 0!=e.notificationAction.action.goto&&(d.notification.notificationAction.action={},d.notification.notificationAction.action.goto=e.notificationAction.action.goto)),void 0!=e.schedule){var y=e.schedule.executeCommand,S={dateTime:"",unit:"",factor:""};if(void 0!=y.now)S.dateTime=moment().format();else if(void 0!=y.exact)S.dateTime=y.exact.dateTime;else if(void 0!=y.dueDate){var f=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",v=f.dates.due;h=""!=v?moment(v,"YYYY-MM-DD"):moment().format(),S.dateTime=h,S.factor=y.dueDate.factor,S.unit=y.dueDate.unit}else if(void 0!=y.validDate){var f=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",v=f.dates.valid;h=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),S.dateTime=h,S.factor=y.validDate.factor,S.unit=y.validDate.unit}else if(void 0!=y.stepCreatedDate){var f=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",b=f.step.dueDateTime;h=""!=b?moment(b).format():moment().format(),S.dateTime=h,S.factor=y.stepCreatedDate.factor,S.unit=y.stepCreatedDate.unit}else S.dateTime=moment().format();s.setSchedule(S)}"string"==typeof e?dao.getConfig(e).then(function(r){e=assignmentObject,n(e).then(function(e){d.notification.recipients=e,s.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),s.setAction(d);var a=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];s.setContext({step:{stepDateTime:a.step.dateTimeCreated}}),s.send().then(function(e){console.log(s);var i=util.success("Notification Worker processes successfully.",e);o(i)},function(e){o(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),a(e)})}).catch(function(e){o(e)}):n(e).then(function(e){d.notification.recipients=e,s.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),s.setAction(d);var a=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];s.setContext({step:{stepDateTime:a.step.dateTimeCreated}}),s.send().then(function(e){console.log(s);var i=util.success("Notification Worker processes successfully.",e);o(i)},function(e){o(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),a(e)})})},reAssignmentNotification:function(e,i,t,o){return new Promise(function(a,n){var s=function(e){return new Promise(function(i,t){var o={};o.function={},o.function.users={},o.function.users=e.id,i(o)})},r=new NotificatioWorker(app),c=JSON.xpath("/subprocesses[_id eq '"+t+"']/meta-data/subprofileId",i,{})[0],p=DOMAIN.replace("exist/rest",""),d={notification:{message:{rtf:{}},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:t,subProfileId:c},notificationType:"workflow",priority:"",recipients:{},url:p,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:"",validDate:"",dueDate:""},notification:{createdDateTime:moment().format()},step:{stepCreatedDateTime:"",stepName:"",stepId:""},node:{title:""},userDefined:[]}}},u=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];void 0!=e.reAssignment.sdoKeys&&e.reAssignment.sdoKeys.forEach(function(e){if(""!=e.field&&""!=e.repStr&&""!=e.setId){var t={};i.indicators.forEach(function(i){i.category.term==e.setId&&(t=i)});var o="";void 0!=t.model&&void 0!=t.model.pending&&void 0!=t.model.pending.data&&void 0!=t.model.pending.data[e.setId]&&void 0!=t.model.pending.data[e.setId][e.field]&&(o=t.model.pending.data[e.setId][e.field]),d.notification.keys.userDefined.push({key:"#"+e.repStr+"#",value:o})}});var l=JSON.xpath("/indicators[_id eq '"+app.profile._id+"']/title",i,{})[0];d.notification.keys.profile.name=l,d.notification.keys.profile.id=app.profile._id,d.notification.keys.community.name=app.getNameByLang(_lclx.COMMUNITY_CONFIG.communityName),d.notification.keys.community.id=_lclx.COMMUNITY_CONFIG.communityId;var f=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",_lclx.COMMUNITY_CONFIG,{})[0];d.notification.keys.application.name=app.getNameByLang(f.name),d.notification.keys.application.id=f.appId,d.notification.keys.currentUser.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,d.notification.keys.currentUser.id=_lclx.SUBSCRIPTIONS.userId,d.notification.keys.subProcess.name=JSON.xpath("/subprocesses[_id eq '"+t+"']/label",i,{})[0],d.notification.keys.subProcess.id=t,d.notification.keys.subProcess.validDate=u.dates.valid,d.notification.keys.subProcess.dueDate=u.dates.due;var m=u.step;d.notification.keys.step.stepCreatedDateTime=m.dateTimeCreated,d.notification.keys.step.stepId=m.id;var I=JSON.xpath("/processes/subProcesses[_id eq '"+u.id+"']/steps[_id eq '"+m.id+"']",app.SCOPE.workflow.config,{})[0];d.notification.keys.step.stepName=app.getNameByLang(I.name);var g=JSON.xpath("/indicators[_id eq '"+c+"']/title",app.SCOPE.workflow,{})[0];if(void 0==g?d.notification.keys.node.title="":d.notification.keys.node.title=g,d.notification.message.default="",d.notification.message.title=e.reAssignment.title,d.notification.message=e.reAssignment.message,d.notification.messageType=e.reAssignment.messageType,d.notification.priority=e.reAssignment.priority,void 0!=e.reAssignment.notificationAction&&(d.notification.notificationAction={},d.notification.notificationAction.label=e.reAssignment.notificationAction.label,void 0!=e.reAssignment.notificationAction.action.URI?(d.notification.notificationAction.action={},d.notification.notificationAction.action.URI=e.reAssignment.notificationAction.action.URI):void 0!=e.reAssignment.notificationAction.action.goto&&(d.notification.notificationAction.action={},d.notification.notificationAction.action.goto=e.reAssignment.notificationAction.action.goto)),void 0!=e.reAssignment.schedule){var y=e.reAssignment.schedule.executeCommand,S={dateTime:"",unit:"",factor:""};if(void 0!=y.now)S.dateTime=moment().format();else if(void 0!=y.exact)S.dateTime=y.exact.dateTime;else if(void 0!=y.dueDate){var h="",v=u.dates.due;h=""!=v?moment(v,"YYYY-MM-DD"):moment().format(),S.dateTime=h,S.factor=y.dueDate.factor,S.unit=y.dueDate.unit}else if(void 0!=y.validDate){var u=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",v=u.dates.valid;h=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),S.dateTime=h,S.factor=y.validDate.factor,S.unit=y.validDate.unit}else if(void 0!=y.stepCreatedDate){var u=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",b=u.step.dueDateTime;h=""!=b?moment(b).format():moment().format(),S.dateTime=h,S.factor=y.stepCreatedDate.factor,S.unit=y.stepCreatedDate.unit}else S.dateTime=moment().format();r.setSchedule(S)}s(o).then(function(e){d.notification.recipients=e,r.setAction(d),r.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),r.send().then(function(e){var i=util.success("Notification Worker processes successfully for reassignment.",e);a(i)},function(e){a(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),n(e)})})},assignmentNotification:function(e,i,t,o){return new Promise(function(a,n){var s=function(e){return new Promise(function(i,t){var o={};o.function={},o.function.users={},o.function.users=e.id,i(o)})},r=new NotificatioWorker(app),c=JSON.xpath("/subprocesses[_id eq '"+t+"']/meta-data/subprofileId",i,{})[0],p=DOMAIN.replace("exist/rest",""),d={notification:{message:{rtf:{}},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:t,subProfileId:c},notificationType:"workflow",priority:"",recipients:{},url:p,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:"",validDate:"",dueDate:""},notification:{createdDateTime:moment().format()},step:{stepCreatedDateTime:"",stepName:"",stepId:""},node:{title:""},userDefined:[]}}},u=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];void 0!=e.assignment.sdoKeys&&e.assignment.sdoKeys.forEach(function(e){if(""!=e.field&&""!=e.repStr&&""!=e.setId){var t={};i.indicators.forEach(function(i){i.category.term==e.setId&&(t=i)});var o="";void 0!=t.model&&void 0!=t.model.pending&&void 0!=t.model.pending.data&&void 0!=t.model.pending.data[e.setId]&&void 0!=t.model.pending.data[e.setId][e.field]&&(o=t.model.pending.data[e.setId][e.field]),d.notification.keys.userDefined.push({key:"#"+e.repStr+"#",value:o})}});var l=JSON.xpath("/indicators[_id eq '"+app.profile._id+"']/title",i,{})[0];d.notification.keys.profile.name=l,d.notification.keys.profile.id=app.profile._id,d.notification.keys.community.name=app.getNameByLang(_lclx.COMMUNITY_CONFIG.communityName),d.notification.keys.community.id=_lclx.COMMUNITY_CONFIG.communityId;var f=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",_lclx.COMMUNITY_CONFIG,{})[0];d.notification.keys.application.name=app.getNameByLang(f.name),d.notification.keys.application.id=f.appId,d.notification.keys.currentUser.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,d.notification.keys.currentUser.id=_lclx.SUBSCRIPTIONS.userId,d.notification.keys.subProcess.name=JSON.xpath("/subprocesses[_id eq '"+t+"']/label",i,{})[0],d.notification.keys.subProcess.id=t,d.notification.keys.subProcess.validDate=u.dates.valid,d.notification.keys.subProcess.dueDate=u.dates.due;var m=u.step;d.notification.keys.step.stepCreatedDateTime=m.dateTimeCreated,d.notification.keys.step.stepId=m.id;var I=JSON.xpath("/processes/subProcesses[_id eq '"+u.id+"']/steps[_id eq '"+m.id+"']",app.SCOPE.workflow.config,{})[0];d.notification.keys.step.stepName=app.getNameByLang(I.name);var g=JSON.xpath("/indicators[_id eq '"+c+"']/title",app.SCOPE.workflow,{})[0];if(void 0==g?d.notification.keys.node.title="":d.notification.keys.node.title=g,d.notification.message.default="",d.notification.message.title=e.assignment.title,d.notification.message=e.assignment.message,d.notification.messageType=e.assignment.messageType,d.notification.priority=e.assignment.priority,void 0!=e.assignment.notificationAction&&(d.notification.notificationAction={},d.notification.notificationAction.label=e.assignment.notificationAction.label,void 0!=e.assignment.notificationAction.action.URI?(d.notification.notificationAction.action={},d.notification.notificationAction.action.URI=e.assignment.notificationAction.action.URI):void 0!=e.assignment.notificationAction.action.goto&&(d.notification.notificationAction.action={},d.notification.notificationAction.action.goto=e.assignment.notificationAction.action.goto)),void 0!=e.assignment.schedule){var y=e.assignment.schedule.executeCommand,S={dateTime:"",unit:"",factor:""};if(void 0!=y.now)S.dateTime=moment().format();else if(void 0!=y.exact)S.dateTime=y.exact.dateTime;else if(void 0!=y.dueDate){var h="",v=u.dates.due;h=""!=v?moment(v,"YYYY-MM-DD"):moment().format(),S.dateTime=h,S.factor=y.dueDate.factor,S.unit=y.dueDate.unit}else if(void 0!=y.validDate){var u=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",v=u.dates.valid;h=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),S.dateTime=h,S.factor=y.validDate.factor,S.unit=y.validDate.unit}else if(void 0!=y.stepCreatedDate){var u=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",b=u.step.dueDateTime;h=""!=b?moment(b).format():moment().format(),S.dateTime=h,S.factor=y.stepCreatedDate.factor,S.unit=y.stepCreatedDate.unit}else S.dateTime=moment().format();r.setSchedule(S)}s(o).then(function(e){d.notification.recipients=e,r.setAction(d),r.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),r.send().then(function(e){console.log(r);var i=util.success("Notification Worker processes successfully for assignment.",e);a(i)},function(e){a(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),n(e)})})},acceptanceNotification:function(e,i,t,o){return new Promise(function(a,n){var s=function(e){return new Promise(function(i,t){var o={};o.role=e,i(o)})},r=new NotificatioWorker(app),c=JSON.xpath("/subprocesses[_id eq '"+t+"']/meta-data/subprofileId",i,{})[0],p=DOMAIN.replace("exist/rest",""),d={
notification:{message:{rtf:{}},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:t,subProfileId:c},notificationType:"workflow",priority:"",recipients:{},url:p,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:"",validDate:"",dueDate:""},notification:{createdDateTime:moment().format()},step:{stepCreatedDateTime:"",stepName:"",stepId:""},node:{title:""},userDefined:[]}}},u=JSON.xpath("/indicators[_id eq '"+app.profile._id+"']/title",i,{})[0];d.notification.keys.profile.name=u,d.notification.keys.profile.id=app.profile._id,d.notification.keys.community.name=app.getNameByLang(_lclx.COMMUNITY_CONFIG.communityName),d.notification.keys.community.id=_lclx.COMMUNITY_CONFIG.communityId;var l=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",_lclx.COMMUNITY_CONFIG,{})[0];d.notification.keys.application.name=app.getNameByLang(l.name),d.notification.keys.application.id=l.appId,d.notification.keys.currentUser.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,d.notification.keys.currentUser.id=_lclx.SUBSCRIPTIONS.userId;var f=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];void 0!=e.assignmentAcceptance.sdoKeys&&e.assignmentAcceptance.sdoKeys.forEach(function(e){if(""!=e.field&&""!=e.repStr&&""!=e.setId){var t={};i.indicators.forEach(function(i){i.category.term==e.setId&&(t=i)});var o="";void 0!=t.model&&void 0!=t.model.pending&&void 0!=t.model.pending.data&&void 0!=t.model.pending.data[e.setId]&&void 0!=t.model.pending.data[e.setId][e.field]&&(o=t.model.pending.data[e.setId][e.field]),d.notification.keys.userDefined.push({key:"#"+e.repStr+"#",value:o})}}),d.notification.keys.subProcess.name=f.label,d.notification.keys.subProcess.id=t,d.notification.keys.subProcess.validDate=f.dates.valid,d.notification.keys.subProcess.dueDate=f.dates.due;var m=f.step;d.notification.keys.step.stepCreatedDateTime=m.dateTimeCreated,d.notification.keys.step.stepId=m.id;var I=JSON.xpath("/processes/subProcesses[_id eq '"+f.id+"']/steps[_id eq '"+m.id+"']",app.SCOPE.workflow.config,{})[0];d.notification.keys.step.stepName=app.getNameByLang(I.name);var g=JSON.xpath("/indicators[_id eq '"+c+"']/title",app.SCOPE.workflow,{})[0];if(void 0==g?d.notification.keys.node.title="":d.notification.keys.node.title=g,d.notification.message.default="",d.notification.message.title=e.assignmentAcceptance.title,d.notification.message=e.assignmentAcceptance.message,d.notification.messageType=e.assignmentAcceptance.messageType,d.notification.priority=e.assignmentAcceptance.priority,void 0!=e.assignmentAcceptance.notificationAction&&(d.notification.notificationAction={},d.notification.notificationAction.label=e.assignmentAcceptance.notificationAction.label,void 0!=e.assignmentAcceptance.notificationAction.action.URI?(d.notification.notificationAction.action={},d.notification.notificationAction.action.URI=e.assignmentAcceptance.notificationAction.action.URI):void 0!=e.assignmentAcceptance.notificationAction.action.goto&&(d.notification.notificationAction.action={},d.notification.notificationAction.action.goto=e.assignmentAcceptance.notificationAction.action.goto)),void 0!=e.assignmentAcceptance.schedule){var y=e.assignmentAcceptance.schedule.executeCommand,S={dateTime:"",unit:"",factor:""};if(void 0!=y.now)S.dateTime=moment().format();else if(void 0!=y.exact)S.dateTime=y.exact.dateTime;else if(void 0!=y.dueDate){var f=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",v=f.dates.due;h=""!=v?moment(v,"YYYY-MM-DD"):moment().format(),S.dateTime=h,S.factor=y.dueDate.factor,S.unit=y.dueDate.unit}else if(void 0!=y.validDate){var f=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",v=f.dates.valid;h=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),S.dateTime=h,S.factor=y.validDate.factor,S.unit=y.validDate.unit}else if(void 0!=y.stepCreatedDate){var f=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",b=f.step.dueDateTime;h=""!=b?moment(b).format():moment().format(),S.dateTime=h,S.factor=y.stepCreatedDate.factor,S.unit=y.stepCreatedDate.unit}else S.dateTime=moment().format();r.setSchedule(S)}s(o).then(function(e){d.notification.recipients=e,r.setAction(d),r.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),r.setContext({process:{}}),r.send(r).then(function(e){console.log(r);var i=util.success("Notification Worker processes successfully for assignment.",e);a(i)},function(e){a(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),n(e)})})},acceptanceNotificationExternal:function(e,i,t,o){return new Promise(function(a,n){var s=function(e){return new Promise(function(i,t){var o={};o.function={},o.function.users=e,i(o)})},r=new NotificatioWorker(app),c=JSON.xpath("/subprocesses[_id eq '"+t+"']/meta-data/subprofileId",i,{})[0],p=DOMAIN.replace("exist/rest",""),d={notification:{message:{rtf:{}},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:t,subProfileId:c},notificationType:"workflow",priority:"",recipients:{},url:p,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:"",validDate:"",dueDate:""},notification:{createdDateTime:moment().format()},step:{stepCreatedDateTime:"",stepName:"",stepId:""},node:{title:""}}}},u=JSON.xpath("/indicators[_id eq '"+app.profile._id+"']/title",i,{})[0];d.notification.keys.profile.name=u,d.notification.keys.profile.id=app.profile._id,d.notification.keys.community.name=app.getNameByLang(_lclx.COMMUNITY_CONFIG.communityName),d.notification.keys.community.id=_lclx.COMMUNITY_CONFIG.communityId;var l=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",_lclx.COMMUNITY_CONFIG,{})[0];d.notification.keys.application.name=app.getNameByLang(l.name),d.notification.keys.application.id=l.appId,d.notification.keys.currentUser.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,d.notification.keys.currentUser.id=_lclx.SUBSCRIPTIONS.userId;var f=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];d.notification.keys.subProcess.name=f.label,d.notification.keys.subProcess.id=t,d.notification.keys.subProcess.validDate=f.dates.valid,d.notification.keys.subProcess.dueDate=f.dates.due;var m=f.step;d.notification.keys.step.stepCreatedDateTime=m.dateTimeCreated,d.notification.keys.step.stepId=m.id;var I=JSON.xpath("/processes/subProcesses[_id eq '"+f.id+"']/steps[_id eq '"+m.id+"']",app.SCOPE.workflow.config,{})[0];d.notification.keys.step.stepName=app.getNameByLang(I.name);var g=JSON.xpath("/indicators[_id eq '"+c+"']/title",app.SCOPE.workflow,{})[0];if(void 0==g?d.notification.keys.node.title="":d.notification.keys.node.title=g,d.notification.message.default="",d.notification.message.title=e.assignmentAcceptance.title,d.notification.message.rtf.markup=e.assignmentAcceptance.message,d.notification.messageType=e.assignmentAcceptance.messageType,d.notification.priority=e.assignmentAcceptance.priority,void 0!=e.assignmentAcceptance.notificationAction&&(d.notification.notificationAction={},d.notification.notificationAction.label=e.assignmentAcceptance.notificationAction.label,void 0!=e.assignmentAcceptance.notificationAction.action.URI?(d.notification.notificationAction.action={},d.notification.notificationAction.action.URI=e.assignmentAcceptance.notificationAction.action.URI):void 0!=e.assignmentAcceptance.notificationAction.action.goto&&(d.notification.notificationAction.action={},d.notification.notificationAction.action.goto=e.assignmentAcceptance.notificationAction.action.goto)),void 0!=e.assignmentAcceptance.schedule){var y=e.assignmentAcceptance.schedule.executeCommand,S={dateTime:"",unit:"",factor:""};if(void 0!=y.now)S.dateTime=moment().format();else if(void 0!=y.exact)S.dateTime=y.exact.dateTime;else if(void 0!=y.dueDate){var f=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",v=f.dates.due;h=""!=v?moment(v,"YYYY-MM-DD"):moment().format(),S.dateTime=h,S.factor=y.dueDate.factor,S.unit=y.dueDate.unit}else if(void 0!=y.validDate){var f=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",v=f.dates.valid;h=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),S.dateTime=h,S.factor=y.validDate.factor,S.unit=y.validDate.unit}else if(void 0!=y.stepCreatedDate){var f=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],h="",b=f.step.dueDateTime;h=""!=b?moment(b).format():moment().format(),S.dateTime=h,S.factor=y.stepCreatedDate.factor,S.unit=y.stepCreatedDate.unit}else S.dateTime=moment().format();r.setSchedule(S)}s(o).then(function(e){d.notification.recipients=e,r.setAction(d),r.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),r.setContext({process:{}}),r.send(r).then(function(e){console.log(r);var i=util.success("Notification Worker processes successfully for assignment.",e);a(i)},function(e){a(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),n(e)})})}}}(),report=function(){return{createPerformanceReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("createPerformanceReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.workplanSetId,c=e.configSetId,p=JSON.xpath("/indicators[category/term eq '"+r+"']/_id",app.SCOPE.workflow,{})[0],d=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+c+"']/instances[1]/uuid",i,{})[0],u={createPerformanceReport:{workplanUUID:p,configUUID:d,profilId:i.profile}};n.action=u,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("WorkplanReport Worker processed successfully.",e);o(a)},function(e){a(e)})})},createReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("executeReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.PerformanceReportDefinitionSetId,c=e.reportingSDOSetId,p=JSON.xpath("/indicators[category/term eq '"+r+"']/_id",i,{})[0],d=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+c+"']/instances[1]/uuid",i,{})[0],u={createReport:{performanceReportDefinition:p,reportingSDO:d,profilId:i.profile}};n.action=u,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("Reprot Worker processed successfully.",e);o(a)},function(e){a(e)})})},sdoReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sdoReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.indicatorSetId,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={sdoReport:{sdoReportUUID:c,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("report Worker processed successfully.",e);o(a)},function(e){a(e)})})},executeReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("executeReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.SDOreportSetId,c=e.reportingSDOSetid,p=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],d=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+c+"']/instances[1]/uuid",i,{})[0];void 0==p&&(p=JSON.xpath("/indicators[category/term eq '"+r+"']/_id",i,{})[0]);var u={executeReport:{sdoReportUUID:p,reportingSDOUUID:d,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=u,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("report Worker processed successfully.",e);o(a)},function(e){a(e)})})},generateView:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sdoReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.ViewConfigSetId,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={generateView:{viewConfigUUID:c,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("report Worker processed successfully.",e);o(a)},function(e){a(e)})})},requestReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("executeReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.sdoRequestReportSetId,c=e.sdoReportCreationSetId,p=e.performanceReportSetId,d=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],u=JSON.xpath("/indicators[category/term eq '"+c+"']/_id",i,{})[0],l=JSON.xpath("/indicators[category/term eq '"+p+"']/_id",i,{})[0],f={requestReport:{performanceReportUUID:l,sdoRequestReportUUID:d,sdoReportCreationUUID:u,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=f,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("Request report Worker processed successfully.",e);o(a)},function(e){a(e)})})},generateBasicView:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sdoReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.sdoDataObjectViewSetId,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={generateBasicView:{sdoDataObjectViewUUID:c,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("generateBasicView Worker processed successfully.",e);o(a)},function(e){a(e)})})},generateUnionView:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sdoReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.sdoDataObjectViewUnionSetId,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={generateUnionView:{sdoDataObjectViewUnionUUID:c,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("generateUnionView Worker processed successfully.",e);o(a)},function(e){a(e)})})},sdoReportMultiple:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sdoReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.sdoReportCreationSetId,c=e.sdoReportViewsSetId,p=e.sdoReportJoinsSetId,d=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],u=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+c+"']/instances[1]/uuid",i,{})[0],l=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+p+"']/instances[1]/uuid",i,{})[0],f={sdoReportMultiple:{sdoReportCreationUUID:d,sdoReportViewsUUID:u,sdoReportJoinsUUID:l,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=f,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("sdoReportMultiple Worker processed successfully.",e);o(a)},function(e){a(e)})})},subprofileQuarterlyReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("executeReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.scheduleReportIndicator,c=JSON.xpath("/indicators[category/term eq '"+r+"']/_id",i,{})[0],p=e.sdoReportApprovalIndicator,d=JSON.xpath("/indicators[category/term eq '"+p+"' and workflows[1]/processes[1]/subProcessUUID eq '"+t+"']/_id",i,{})[0],u={subprofileQuarterlyReport:{scheduleReportIndicatorUUID:c,sdoReportApprovalIndicatorUUID:d,subprofileCode:app.profile.subProfile.code,subprofileTitle:app.profile.subProfile.title,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=u,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("QuarterlyReport report Worker processed successfully.",e);o(a)},function(e){a(e)})})}}}(),participants=function(){return{linkParticipants:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("follow"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.EPWPLinkParticipantsInBulkId,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p=e.EPWPLocalityId,d=JSON.xpath("/indicators[category/term eq '"+p+"']/_id",i,{})[0],u=e.EPWPActiveParticipantsId,l=JSON.xpath("/indicators[category/term eq '"+u+"']/_id",i,{})[0],f={linkParticipants:{EPWPLinkParticipantsInBulkIdUUID:c,EPWPLocalityIdUUID:d,EPWPActiveParticipantsIdUUID:l,profilId:i.profile}};n.action=f,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("EPWPLinkParticipants Worker processed successfully.",e);o(a)},function(e){a(e)})})},monthlyAttendance:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("follow"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.EPWPMonthlyAttendanceBulkUploadUUID,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p=e.EPWPActiveParticipantsIdUUID,d=JSON.xpath("/indicators[category/term eq '"+p+"']/_id",i,{})[0],u=e.EPWPMonthlyEmploymentPerLocalityUUID,l=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+u+"']/instances[1]/uuid",i,{})[0],f={monthlyAttendance:{EPWPMonthlyAttendanceBulkUploadUUID:c,EPWPActiveParticipantsIdUUID:d,EPWPMonthlyEmploymentPerLocalityUUID:l,profilId:i.profile}};n.action=f,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("monthlyAttendance Worker processed successfully.",e);o(a)},function(e){a(e)})})},monthlyProgressSummary:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("follow"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.EPWPMonthlyProgressSummaryIdUUID,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={monthlyProgressSummary:{EPWPMonthlyProgressSummaryIdUUID:c,profilId:i.profile}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("monthlyAttendance Worker processed successfully.",e);o(a)},function(e){a(e)})})},participantContracts:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("follow"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.EPWPParticipantContractsIdUUID,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={participantContracts:{EPWPParticipantContractsIdUUID:c,profilId:i.profile}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("participantContracts Worker processed successfully.",e);o(a)},function(e){a(e)})})},genericLinkParticipants:function(e,i,t){return new Promise(function(e,i){})}}}(),worker=function(){return{getWorkerWrapper:function(){var e={source:"remote",type:"workerObject",_id:"",channels:["workerObject"],profileId:"",communityId:"",applicationId:"",subProcessUUID:"",message:"",messageType:"info",createdDateTime:"",senderUserId:"",subProfileId:"",parentTransactionId:void 0==app.SCOPE.txn?"":app.SCOPE.txn.transactionId,action:{}};return e},send:function(e){return new Promise(function(i,t){console.log("Submitting Worker Object to server"),console.log(e),dao.save(e).then(function(e){i(e)}).catch(function(e){console.log("Error submitting worker response !!"+e),t(e)})})},sendWorker:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sendWorker"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=function(e,o,a){return new Promise(function(n,s){helper.getNodeValue(e,i,t).then(function(e){n({seq:o,paramName:a,dataValue:e})},function(e){s(e)})})},c=function(e){return new Promise(function(o,a){for(var n=[],s=e.length,c=0;c<e.length;c++){var p=e[c].parameterValue,d=e[c].seq,u=e[c].parameterName;r(p,d,u).then(function(e){n.push({seq:e.seq,paramName:e.paramName,paramValue:e.dataValue}),s--,0==s&&(n.push({seq:s+1,paramName:"communityId",paramValue:i.communityId}),n.push({seq:s+2,paramName:"applicationId",paramValue:i.app}),n.push({seq:s+3,paramName:"profileId",paramValue:i.profile}),n.push({seq:s+4,paramName:"subProcessUUID",paramValue:t}),o(n))},function(e){s--,0==s&&(n.push({seq:s+1,paramName:"communityId",paramValue:i.communityId}),n.push({seq:s+2,paramName:"applicationId",paramValue:i.app}),n.push({seq:s+3,paramName:"profileId",paramValue:i.profile}),n.push({seq:s+4,paramName:"subProcessUUID",paramValue:t}),o(n))})}})};if(void 0!=e.rest){var p=e.rest.parameters;c(p).then(function(s){var r={sendWorker:{rest:{}}};r.sendWorker.rest.uri=e.rest.uri,r.sendWorker.rest.profilId=i.profile,r.sendWorker.rest.parameters=s,n.action=r,worker.send(n).then(function(e){var s=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];s.spStatus="submitted",void 0==s.messages&&(s.messages=[]);var r={message:{i18n:{_id:"",en:"The server is processing your request. Please wait a few seconds and then click the refresh button.",pt:"The server is processing your request. Please wait a few seconds and then click the refresh button."}},type:"info"};s.messages.push(r),void 0==s.workers&&(s.workers=[]),s.workers.push({workerId:n._id,dateTime:moment().format()}),persistData("subprocesses",app.SCOPE.workflow,t).then(function(i){var t=util.success("Worker Rest processed successfully.",e);o(t)}).catch(function(e){console.log("Worker submitted subprocess file update failed"),a(e)})},function(e){console.log("Worker failed "),a(e)})},function(e){console.log("parameter creation failed. Abording worker object")})}else if(void 0!=e.functional){var p=e.functional.parameters;c(p).then(function(s){var r={sendWorker:{functional:{}}};r.sendWorker.functional.methodName=e.functional.methodName,r.sendWorker.functional.profilId=i.profile,r.sendWorker.functional.parameters=s,n.action=r,worker.send(n).then(function(e){var s=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];s.spStatus="submitted",void 0==s.messages&&(s.messages=[]);var r={message:{i18n:{_id:"",en:"The server is processing your request. Please wait a few seconds and then click the refresh button.",pt:"The server is processing your request. Please wait a few seconds and then click the refresh button."}},type:"info"};s.messages.push(r),void 0==s.workers&&(s.workers=[]),s.workers.push({workerId:n._id,dateTime:moment().format()}),persistData("subprocesses",app.SCOPE.workflow,t).then(function(i){var t=util.success("Worker functional processed successfully.",e);o(t)}).catch(function(e){console.log("Worker submitted subprocess file update failed"),a(e)})},function(e){console.log("Worker failed "),a(e)})},function(e){console.log("parameter creation failed. Abording worker object")})}})},executeLocal:function(workerConfig,_WFInstance,uuid){return new Promise(function(resolve,reject){var processGetNodeValue=function(e,i,t){return new Promise(function(o,a){helper.getNodeValue(e,_WFInstance,uuid).then(function(e){o({seq:i,dataType:t,dataValue:e})},function(e){a(e)})})},processParams=function(e){return new Promise(function(i,t){for(var o=[],a=e.length,n=0;n<e.length;n++){var s=e[n].parameterValue,r=e[n].seq,c=e[n].dataType.dataType;processGetNodeValue(s,r,c).then(function(e){o.push({seq:e.seq,dataType:e.dataType,paramValue:e.dataValue}),a--,0==a&&i(o)},function(e){a--,0==a&&i(o)})}})},fixParamType=function(e,i){switch(i){case"string":var t=e.replace(/'/g,"\\'");return""+t;case"date":case"dateTime":return""+e;case"number":case"decimal":return e}},methodName=workerConfig.methodName,configParam=workerConfig.parameters;processParams(configParam).then(function(paramsArray){for(var pList="",i=0;i<paramsArray.length-1;i++)pList=pList+fixParamType(paramsArray[i].paramValue,paramsArray[i].dataType)+",";pList+=fixParamType(paramsArray[i].paramValue,paramsArray[i].dataType);var callbackSuccess=function(){return console.log("S"),resolve("Function '"+methodName+"' executed. Response success.")},callbackFailure=function(){return console.log("E"),reject("Function '"+methodName+"' executed. Response failed.")},spUUID=""+uuid;console.log("Going to execute == "+methodName),0==paramsArray.length?eval(methodName)(callbackSuccess,callbackFailure,spUUID):1==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,callbackSuccess,callbackFailure,spUUID):2==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,callbackSuccess,callbackFailure,spUUID):3==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,callbackSuccess,callbackFailure,spUUID):4==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,paramsArray[3].paramValue,callbackSuccess,callbackFailure,spUUID):5==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,paramsArray[3].paramValue,paramsArray[4].paramValue,callbackSuccess,callbackFailure,spUUID):6==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,paramsArray[3].paramValue,paramsArray[4].paramValue,paramsArray[5].paramValue,callbackSuccess,callbackFailure,spUUID):7==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,paramsArray[3].paramValue,paramsArray[4].paramValue,paramsArray[5].paramValue,paramsArray[6].paramValue,callbackSuccess,callbackFailure,spUUID):8==paramsArray.length&&eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,paramsArray[3].paramValue,paramsArray[4].paramValue,paramsArray[5].paramValue,paramsArray[6].paramValue,paramsArray[7].paramValue,callbackSuccess,callbackFailure,spUUID)},function(e){console.log("parameter creation failed. Abording worker object"),reject(e)})})},setWorkerInfoInSubprocess:function(e,i,t){var o=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],a={message:{i18n:{_id:"",en:"The server is processing your request. Please wait a few seconds and then click the refresh button.",
pt:"O servidor está processando sua solicitação. Por favor aguarde alguns segundos e depois clique no botão atualizar."}},type:"info"};o.messages=[],o.messages.push(a),void 0==o.workers&&(o.workers=[]),o.workers.push({workerId:e._id,dateTime:moment().format()})},create:function(e,i,t){return new Promise(function(o,a){var n=e.channel,s=e.action,r=worker.getWorkerWrapper(),c="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(c=app.profile.subprofileId),r._id=generateUUID(),r.communityId=app.SCOPE.getCommunityId(),r.applicationId=app.SCOPE.applicationId,r.createdDateTime=moment().format(),r.senderUserId=_lclx.SUBSCRIPTIONS.userId,r.profileId=i.profile,r.subProcessUUID=t,r.subprofileId=c,r.channels.push(n),r.channels.push("community_"+app.SCOPE.getCommunityId());var p={};p[s]={};for(var d=0;d<e.indicators.length;d++){var u=e.indicators[d].label,l=e.indicators[d].setId,f=e.indicators[d].context,m="";if("subProcess"==f||"currentSubProcessInstance"==f||"currentSubProcess"==f){if(m=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+l+"']/instances[1]/uuid",i,{})[0],void 0==m){var I=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];void 0!=I&&I.indicators.length>0&&(m=JSON.xpath("/indicators[category/term eq '"+l+"']/_id",i,{})[0])}}else m=JSON.xpath("/indicators[category/term eq '"+l+"']/_id",i,{})[0];p[s][u]=m}if(p[s].profilId=i.profile,void 0!=e.fixed)for(var d=0;d<e.fixed.length;d++){var g=e.fixed[d],y=Object.keys(g)[0];p[s][y]=g[y]}void 0!=e.dataFields&&(p[s].dataFields=e.dataFields),r.action=p,worker.send(r).then(function(e){worker.setWorkerInfoInSubprocess(r,i,t);var a=util.success(s+" worker processed successfully.",e);o(a)},function(e){a(e)})})}}}(),user=function(){return{addToRole:function(e,i,t){return new Promise(function(o,a){helper.getNodeValue(e.userName,t,i).then(function(n){helper.getNodeValue(e.userId,t,i).then(function(s){helper.getNodeValue(e.roleId,t,i).then(function(e){if("string"!=typeof n&&"string"!=typeof s&&Array.isArray([n])&&Array.isArray([s]))if("string"!=typeof e&&Array.isArray([e]))if(n.length!=s.length||s.length!=e.length)a({isError:!0,message:"Config issue in role assignment action."});else{var i=function(t){if(n.length==t){var a=util.success("Role assignment complete",{});o(a)}else if(void 0==e[t]||""==e[t]||void 0==s[t]||""==s[t]||void 0==n[t]||""==n[t])i(t+1);else{var r=JSON.xpath("/roles[id eq '"+e[t]+"']/type",app.SCOPE.APP_CONFIG,{})[0];"instance"==r?rolesManager.doUserRegistration(s[t],n[t],e[t],"instance").then(function(e){i(t+1)}).catch(function(e){i(t+1)}):"subprofile"==r?rolesManager.doUserRegistration_node(s[t],n[t],e[t],"subprofile").then(function(e){i(t+1)}).catch(function(e){i(t+1)}):"adoption"==r?rolesManager.doUserRegistration_adoption(s[t],n[t],e[t],"adoption").then(function(e){i(t+1)}).catch(function(e){i(t+1)}):i(t+1)}};i(0)}else{var i=function(t){if(n.length==t){var a=util.success("Role assignment complete",{});o(a)}else if(void 0==e||""==e||void 0==s[t]||""==s[t]||void 0==n[t]||""==n[t])i(t+1);else{var r=JSON.xpath("/roles[id eq '"+e+"']/type",app.SCOPE.APP_CONFIG,{})[0];"instance"==r?rolesManager.doUserRegistration(s[t],n[t],e,"instance").then(function(e){i(t+1)}).catch(function(e){i(t+1)}):"subprofile"==r?rolesManager.doUserRegistration_node(s[t],n[t],e,"subprofile").then(function(e){i(t+1)}).catch(function(e){i(t+1)}):"adoption"==r?rolesManager.doUserRegistration_adoption(s[t],n[t],e,"adoption").then(function(e){i(t+1)}).catch(function(e){i(t+1)}):i(t+1)}};i(0)}else{var t=JSON.xpath("/roles[id eq '"+e+"']/type",app.SCOPE.APP_CONFIG,{})[0];"instance"==t?rolesManager.doUserRegistration(s,n,e,"instance").then(function(e){var i=util.success("Role assigned to user in context instance",e);o(i)}).catch(function(e){console.log("rolesManager- instance fail"),o("role update failed")}):"subprofile"==t?rolesManager.doUserRegistration_node(s,n,e,"subprofile").then(function(e){var i=util.success("Role assigned to user in context subprofile",e);o(i)}).catch(function(e){console.log("rolesManager- subprofile fail"),o("role update failed")}):"adoption"==t?rolesManager.doUserRegistration_adoption(s,n,e,"adoption").then(function(e){var i=util.success("Role assigned to user in context adoption",e);o(i)}).catch(function(e){console.log("rolesManager- adoption fail"),o("role update failed")}):(console.log("Role not found in any context"),a("Role not found in any context"))}}).catch(function(e){a(e)})}).catch(function(e){a(e)})}).catch(function(e){a(e)})})}}}(),generalFunctions=function(){return{addToFavourites:function(e,i,t){return new Promise(function(i,o){var a=e.context;"profile"==a?library.addToFavouritesProfile().then(function(e){i(e)}).catch(function(e){o(e)}):"subprofile"==a?library.addToFavouritesSubProfile().then(function(e){i(e)}).catch(function(e){o(e)}):"subprocess"==a&&library.addToFavouritesSubProcess(t).then(function(e){i(e)}).catch(function(e){o(e)})})},addToUserFavourites:function(e,i,t){return new Promise(function(o,a){var n=e.context,s=e.user,r="";if(void 0!=s.stepAssigneeFromStep){for(var c=s.stepAssigneeFromStep.stepId,p=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],d={},u=0;u<p.history.length;u++)p.history[u].id==c&&(d=p.history[u]);if(void 0!=d.assignmentHistory&&d.assignmentHistory.length>0){var l=d.assignmentHistory[d.assignmentHistory.length-1];r=l.userId}}else if(void 0!=s.indicator){var f=s.indicator.indicatorSetId,m=s.indicator.elementId,I=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+f+"']/instances/uuid",i,{})[0],g=JSON.xpath("/indicators[_id eq '"+I+"']",i,{})[0],y="/model/pending/data/"+f+"/"+m,S=JSON.xpath(y,g,{})[0];r=S}"profile"==n?library.addToFavouritesProfileForUser(r).then(function(e){console.log("Workflow ****** Profile Done"),o(e)}).catch(function(e){a(e)}):"subprofile"==n?library.addToFavouritesSubprofileForUser(r).then(function(e){console.log("Workflow ****** SubProfile Done"),o(e)}).catch(function(e){a(e)}):"subprocess"==n&&library.addToUsersFavouritesSubProcessForUser(r,t).then(function(e){console.log("Workflow ****** Subprocess Done"),o(e)}).catch(function(e){a(e)})})}}}();module.exports={community:community,application:application,performance:performance,worker:worker,sdo:sdo,taxonomy:taxonomy,subProcessInstance:subProcessInstance,variables:variables,notification:notification,report:report,participants:participants,user:user,generalFunctions:generalFunctions};

},{"./form":3,"./helper":4,"./nodeValue":6,"utility":8}],3:[function(require,module,exports){
"use strict";function create(e){var t=e[0]||"",s=e[1]||{},i=e[2]||{},r=e[3]||{},o=e[6]||{},a=(e[6]||{},s.indicators||[]),n=(r._type,e[4]||"",e[5]||"",e[7]||"",s._id),c=e[8]||"",d=e[9]||"",u=(o.profile,e[10]||{}),l=r.method.form.create;void 0!=r.method.form.authoriseAndCreateNewSeq?l=r.method.form.authoriseAndCreateNewSeq:void 0!=r.method.form.createNewSeq&&(l=r.method.form.createNewSeq);var p=r.method.form.type,f={formCreateType:l,formType:p};return new Promise(function(e,p){var h=a.length,m=!1,v=[],g=function(){if(0==m){var t=util.success("Form create indicator persist success.",o.indicators);e(t)}else{for(var s=[],i=0;i<o.instance.processes.length;i++)o.instance.processes[i].subProcesses.length>0&&s.push(o.instance.processes[i]);o.instance.processes=[],o.instance.processes=s;var r=[],a=JSON.xpath("/subprocesses[_id eq '"+c+"']",o,{})[0],n=a.id,d=JSON.xpath("/config/processes/subProcesses[_id eq '"+n+"']",o,{})[0];if(void 0!=d.instanceType.newSequence){for(var i=0;i<d.indicators.length;i++){var u=d.indicators[i],l=u._id,f=JSON.xpath("distinct-values(/subprocesses[groupKey = '"+a.groupKey+"']/indicators[id = '"+l+"']/instances/uuid)",o,{})[0];if(void 0!=f){var h=JSON.xpath("/indicators[_id eq '"+f+"']",o,{})[0];void 0!=h&&(h.model.pending=h.model.approved)}}for(var g="",i=0;i<d.indicators.length-1;i++)g=g+"'"+d.indicators[i]._id+"',";g=g+"'"+d.indicators[d.indicators.length-1]._id+"'",r=JSON.xpath("distinct-values(/indicators[category/term = ("+g+")]/model/approved/subProcessUUID)",o,{});var I=function(e,t){if(e==t.length){for(var s=[],i=0;i<o.subprocesses.length;i++)o.subprocesses[i].indicators.length>0&&s.push(o.subprocesses[i]);o.subprocesses=[],o.subprocesses=s;var r=util.success("Process failed",v);p(r)}else persistData("indicators",o,t[e]).then(function(s){I(e+1,t)}).catch(function(s){I(e+1,t)})};I(0,r)}else{for(var S=[],i=0;i<o.subprocesses.length;i++)o.subprocesses[i].indicators.length>0&&S.push(o.subprocesses[i]);o.subprocesses=[],o.subprocesses=S;var _=util.success("Process failed",v);p(_)}}},I=JSON.xpath("/config/processes/subProcesses[_id eq '"+n+"']/type",o,{})[0],S=function(e,a,l,p){return new Promise(function(S,_){gatekeeper.instantiate(d,e,a,o.profile,l,n,I).then(function(e){for(var n=0;n<e.length;n++){for(var d=e[n],I=0;I<o.indicators.length;I++){var _=o.indicators[I];if(_._id==d.model._id){o.indicators.splice(I,1),o.indicators.push(d.model);break}}if(!d.model._id.endsWith(":approved")&&!d.model._id.endsWith(":rejected")){d.model.model.pending.validDate=l,d.model.model.pending.subProcessUUID=c;var O={id:o.config._id,instance:o.instance._id,processes:[{id:t,subProcessId:s._id,subProcessUUID:c,step:{id:i.id,seq:i.seq,startDate:"",status:i.status,message:i.message,assignedTo:{userId:i.assignedTo.userId,name:i.assignedTo.name},comment:i.comment,complete:!1,endDate:""}}]};1==d.model.model.pending.seq&&void 0!=r.setWorkflowLabelInTitle&&""!=r.setWorkflowLabelInTitle&&1==r.setWorkflowLabelInTitle&&(d.model.title=u.label),void 0!=r.setDraft&&""!=r.setDraft&&1==r.setDraft&&(d.model.control.draft=!0);var N=!1,b=-1;d.model.workflows.forEach(function(e,t){c==e.processes[0].subProcessUUID&&(N=!0,b=t)}),N?d.model.workflows[b]=O:d.model.workflows.push(O);var D=d.model._id;gatekeeper.persist(e).then(function(e){dao.get(D).then(function(e){var t=ko.mapping.fromJS({defaultModel:{setId:a}}),s=e.model.pending.seq;gatekeeper.instantiateData(D,p,t,e.model.pending.seq,f).then(function(e){if("200"==e[0].status){for(var t=0;t<o.indicators.length;t++){var i=o.indicators[t];if(i._id==e[0].model._id){o.indicators.splice(t,1),o.indicators.push(e[0].model);break}}if(1==s&&void 0!=r.setWorkflowLabelInField&&""!=r.setWorkflowLabelInField){var n=r.setWorkflowLabelInField.split(".")[0];if(n==a){console.log(e[0]);var d=u.label,l=d.replace(/'/g,"\\'"),p=e[0].model.model.pending.data,f=""==r.setWorkflowLabelInField?[]:r.setWorkflowLabelInField.split(/['"\[\].]+/),I=0;for(I=0;I<f.length-1;I++)""!=f[I]&&(p=p[f[I]]);p[f[I]]=l}}gatekeeper.persist(e).then(function(e){dao.get(D).then(function(e){if(0==o.indicators.length)o.indicators.push(e),h--,0==h&&persistData("indicators",o,c).then(function(e){util.success("Form create indicator persist success.",o.indicators);g()}).catch(function(e){v.push({error:"persistData "+c,errorBlock:e}),console.error(e);util.success("Form create indicator persist failed.",{});m=!0,g()}),S({});else{for(var t=!1,s=0;s<o.indicators.length;s++){var i=o.indicators[s];i._id==e._id&&(t=!0,o.indicators.splice(s,1),o.indicators.push(e),s=o.indicators.length,h--,0==h&&persistData("indicators",o,c).then(function(e){util.success("Form create indicator persist success.",o.indicators);g()}).catch(function(e){v.push({error:"persistData "+c,errorBlock:e}),console.error(e);util.success("Form create indicator persist failed.",{});m=!0,g()}),S({}))}0==t&&(o.indicators.push(e),h--,0==h&&persistData("indicators",o,c).then(function(e){util.success("Form create indicator persist success.",o.indicators);g()}).catch(function(e){v.push({error:"persistData "+c,errorBlock:e}),console.error(e);util.success("Form create indicator persist failed.",{});m=!0,g()}),S({}))}}).catch(function(e){v.push({error:"dao.get(mainId) "+D,errorBlock:e}),console.error(e);util.success("1 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),S({})})},function(e){v.push({error:"gatekeeper.persist(data) - Persisting all docs ",errorBlock:e}),console.error(e);util.success("2 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),S({})})}else{v.push({error:"gatekeeper.instantiateData"+D+" "+e[0].status,errorBlock:{}});util.success("3 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),S({})}},function(e){v.push({error:"gatekeeper.instantiateData"+D,errorBlock:e});util.success("4 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),S({})})}).catch(function(e){v.push({error:"dao.get(mainId) "+D,errorBlock:e}),console.error(e);util.success("5 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),S({})})},function(e){v.push({error:"gatekeeper.persist savedArray",errorBlock:e}),console.error(e);util.success("6 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),S({})})}}},function(e){v.push({error:"gatekeeper.instantiate",errorBlock:e}),m=!0,h--,0==h&&g(),S({})})})},_=FROM_DEFINITION,O=function(e,t){if(0==e.length)h--,0==h&&g();else if(t<e.length){var i=e[t]._id,r=(util.getName(e[t].name,"en"),e[t].initiateData,"");void 0!=s.instanceType.newSequence?r=INSTANCE_TYPE_NEW_SEQ:void 0!=s.instanceType.newInstance&&(r=INSTANCE_TYPE_NEW_INS);var a=function(){S(r,i,u.validDate,_).then(function(s){O(e,t+1)}).catch(function(e){m=!0,h--,0==h&&g()})};if(void 0!=d&&""!=d&&d.length>0){var p=JSON.xpath("/subprocesses[_id eq '"+d+"']",o,{})[0];void 0==s.periodType.periodic&&d!=c&&(p.active=!1),_=l==BLANK_MODEL?FROM_DEFINITION:FROM_AUTHORISED,a()}else{var f=JSON.xpath("/indicators[setId eq '"+i+"']/cardinality",app.SCOPE.APP_CONFIG,{})[0];if(r==INSTANCE_TYPE_NEW_INS)f==INDICATOR_CARDINALITY_SINGLE?library.getSingleIndicator(i).then(function(e){_=e.length>0?FROM_AUTHORISED:FROM_DEFINITION,a()}).catch(function(e){_=FROM_DEFINITION,a()}):(_=FROM_DEFINITION,a());else if(f==INDICATOR_CARDINALITY_SINGLE)library.getSingleIndicator(i).then(function(e){_=e.length>0?FROM_AUTHORISED:FROM_DEFINITION,a()}).catch(function(e){_=FROM_DEFINITION,a()});else{var v="/indicators[category/term eq '"+i+"' and id = /subprocesses[id = '"+n+"']/indicators/instances/uuid]/_id",N=library.getSubprofileSubprocessIds();I==PROCESS_TYPE_SUBPROFILE&&(v="/indicators[category/term eq '"+i+"' and id = /subprocesses[id = '"+n+"' and id = "+N+"]/indicators/instances/uuid]/_id");var b=JSON.xpath(v,o,{});_=b.length>0?FROM_AUTHORISED:FROM_DEFINITION,a()}}}};O(a,0)})}function setInstanceTitle(e){var t=e[0]||{},s=e[2]||"",i=e[4]||{},r=i.label;return new Promise(function(e,i){for(var o=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],a=o.indicators,n=0;n<a.length;n++){var c=a[n].instances[0].uuid,d=JSON.xpath("/indicators[_id eq '"+c+"']",t,{})[0];d.title=a[n].id+" "+r}e("Set Title Success",a)})}function deleteProfile(e){var t=e[0]||{},s=t.profile;return new Promise(function(e,i){var r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId);var o={source:"remote",type:"workerObject",_id:generateUUID(),channels:["deleteProfile","community_"+app.SCOPE.getCommunityId(),"workerObject"],communityId:app.SCOPE.getCommunityId(),applicationId:app.SCOPE.applicationId,profileId:t.profile,message:"",subprofileId:r,messageType:"info",createdDateTime:moment().format(),senderUserId:_lclx.SUBSCRIPTIONS.userId,parentTransactionId:void 0==app.SCOPE.txn?"":app.SCOPE.txn.transactionId,notification:{},profile:{action:"deleteProfile",profileId:s}};console.log(o),dao.save(o).then(function(t){console.log("Worker Object submitted for profile("+s+") deletion."),console.log(t),e(t)}).catch(function(e){console.log(e),i(data)})})}function createProfile(e){var t=e[1]||{},s=t.communityId,i=t.profile;return new Promise(function(e,t){library.createProfileDocuments(s,i).then(function(t){var s=util.success("Form created successfully.",t);e(s)}).catch(function(e){console.error(e);var s=util.success("ERROR: Profile creation failed",{});t(s)})})}function setDraft(e){var t=e[0]||{},s=(t.communityId,t.profile,e[2]||"");return new Promise(function(e,i){for(var r=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],o=r.indicators,a=0;a<o.length;a++){var n=o[a].instances[0].uuid,c=JSON.xpath("/indicators[_id eq '"+n+"']",t,{})[0];c.control.draft=!0}e("Set Draft Success",o)})}function setUnDraft(e){var t=e[0]||{},s=(t.communityId,t.profile,e[2]||"");return new Promise(function(e,i){for(var r=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],o=r.indicators,a=0;a<o.length;a++){var n=o[a].instances[0].uuid,c=JSON.xpath("/indicators[_id eq '"+n+"']",t,{})[0];c.control.draft=!1}e("Set Draft Success",o)})}function save(e){var t={complete:!0,data:[]};return new Promise(function(e,s){var i=util.success("Form indicator set saved successfully.",t);e(i)})}function submit(e){var t={complete:!0,data:[]};return new Promise(function(e,s){var i=util.success("Form submitted successfully.",t);e(i)})}function authorise(e){var t=(e[0]||"",e[1]||{}),s=(t._id,e[2]||"",e[3]||"",e[4]||{}),i=e[6]||"";return new Promise(function(e,t){var r=(JSON.xpath("/subprocesses[_id eq '"+i+"']",app.SCOPE.workflow,{})[0],JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators/instances/uuid",s,{})),o=r.length,a=[],n=[],c=function(d){gatekeeper.authorise(r[d]).then(function(r){gatekeeper.persist(r).then(function(r){for(var u="",l=0;l<r.length;l++)r[l].id.endsWith(":approved")||(u=r[l].id);dao.get(u).then(function(r){if(0==s.indicators.length)s.indicators.push(r),o--,0==o?persistData("indicators",s,i).then(function(t){var s=util.success("Form authorised successfully.",a);e(s)}).catch(function(e){console.error(e);var s=util.success("Form authorised persist failed.",{});t(s)}):o>0&&c(d+1);else{for(var u=!1,l=0;l<s.indicators.length;l++){var p=s.indicators[l];if(p._id==r._id&&(u=!0,n.push(r),o--,0==o)){for(var f=s.indicators.length,h=n.length,m=0;m<f;m++){for(var v=!1,g=0;g<h;g++)s.indicators[m]._id==n[g]._id&&(v=!0);v||n.push(s.indicators[m])}s.indicators=n;break}}1==u&&0==o?persistData("indicators",s,i).then(function(t){var s=util.success("Form authorised successfully.",a);e(s)}).catch(function(e){console.error(e);var s=util.success("Form authorised persist failed.",{});t(s)}):o>0&&c(d+1)}}).catch(function(e){console.error(e);var s=util.success("Form authorised persist failed 2.",{});t(s)})},function(e){console.error(e);var s=util.success("Form authorised persist failed 3.",{});t(s)})},function(e){var s=util.success("Form authorised persist failed 4.",{});t(s)})};c(0)})}function close(e){var t={complete:!0,data:[]};return new Promise(function(e,s){var i=util.success("Form closed successfully.",t);e(i)})}function updateIndicator(e){var t=e[0]||{},s=e[1]||"",i=e[2]||"",r=e[3]||"";return new Promise(function(e,o){var a=i.split(".",1)[0],n=JSON.xpath("/indicators[workflows/processes/subProcessUUID = '"+s+"' and category/term = '"+a+"']",t,{})[0];if(void 0==n&&"appProfile"==a&&(n=JSON.xpath("/indicators[model/pending/status = 'Authorised' and category/term = '"+a+"']",t,{})[0],void 0==n)){var c=[],d={};d.model={},c.push(d);var u=util.success("Indicator updated skipped.",c);return void e(u)}var l=(r+"").replace(/'/g,"\\'"),l=l.split("\n").join(" "),p=n.model.pending.data,f=""==i?[]:i.split(/['"\[\].]+/),h=0;for(h=0;h<f.length-1;h++)""!=f[h]&&(p=p[f[h]]);p[f[h]]=l;var c=[],d={};d.model=n,c.push(d);var m=JSON.parse(JSON.stringify(app.SCOPE.txn));m.documents=[];var v={document:n._id,rev:n._rev};m.documents.push(v),app.SCOPE.txn.documents.push(v),dao.updateTransaction(m).then(function(t){dao.save(n).then(function(t){v.rev=t.rev;var s=util.success("Indicator updated.",c);e(s)}).catch(function(t){console.log(t);var s=util.success("Indicator updated.",c);e(s)})}).catch(function(t){console.log(t);var s=util.success("Indicator updated.",c);e(s)})})}function updateIndicatorWrapper(e){var t=e[0]||{},s=e[1]||"",i=e[2]||"",r=e[3]||"",o=e[4]||"";return new Promise(function(e,a){var n=JSON.xpath("/indicators[workflows/processes/subProcessUUID = '"+s+"' and category/term = '"+o+"']",t,{})[0];if(void 0==n&&"appProfile"==o&&(n=JSON.xpath("/indicators[model/pending/status = 'Authorised' and category/term = '"+o+"']",t,{})[0],void 0==n)){var c=[],d={};d.model={},c.push(d);var u=util.success("Indicator updated skipped.",c);return void e(u)}var l=r.replace(/'/g,"\\'"),l=l.split("\n").join(" "),p=n,f=""==i?[]:i.split(/['"\[\].]+/),h=0;for(h=0;h<f.length-1;h++)""!=f[h]&&(p=p[f[h]]);p[f[h]]=l;var c=[],d={};d.model=n,c.push(d);var m=JSON.parse(JSON.stringify(app.SCOPE.txn));m.documents=[];var v={document:n._id,rev:n._rev};m.documents.push(v),app.SCOPE.txn.documents.push(v),dao.updateTransaction(m).then(function(t){dao.save(n).then(function(t){v.rev=t.rev;var s=util.success("Indicator updated.",c);e(s)}).catch(function(t){console.log(t);var s=util.success("Indicator updated.",c);e(s)})}).catch(function(t){console.log(t);var s=util.success("Indicator updated.",c);e(s)})})}function markUpdateIndicator(e){var t=e[0]||{},s=e[1]||"",i=e[2]||"",r=e[3]||"";return new Promise(function(e,o){var a=JSON.xpath("/indicators[workflows/processes/subProcessUUID = '"+s+"' and category/term = '"+r+"']",t,{})[0];a.model.pending.status=i;var n=[],c={};c.model=a,n.push(c);var d=util.success("Indicator updated.",n);e(d)})}function setStatus(e){var t=e[0]||{},s=e[1]||"",i=e[2]||"";return new Promise(function(e,r){var o=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0];o.step.message=i,e("Set profile status Success",o)})}var util=require("utility"),gatekeeper=new GK;module.exports={create:create,save:save,submit:submit,authorise:authorise,close:close,setDraft:setDraft,setUnDraft:setUnDraft,createProfile:createProfile,setInstanceTitle:setInstanceTitle,deleteProfile:deleteProfile,updateIndicator:updateIndicator,markUpdateIndicator:markUpdateIndicator,updateIndicatorWrapper:updateIndicatorWrapper};

},{"utility":8}],4:[function(require,module,exports){
"use strict";function getLanguageMessage(e){var a=service.getLanguage(),t=e.i18n[a];return t}function getNodeValue(e,a,t){return new Promise(function(r,i){if("string"==typeof e)r(e);else if(void 0!=e.value){var s="string";s=void 0!=e.value.datatype.dataType?e.value.datatype.dataType:e.value.datatype;var o=e.value.data;r("number"==s?Number(o):"string"==s?o:"integer"==s?parseInt(o):"decimal"==s?parseFloat(o):"date"==s||"dateTime"==s?o:o)}else if(void 0!=e.indicatorUUID){var n=null,c=JSON.xpath("/subprocesses[_id eq '"+t+"']",a,{})[0];0==c.indicators.length?n=JSON.xpath("/indicators[category/term eq '"+e.indicatorUUID.indicatorSetId+"']/_id",a,{})[0]:(n=JSON.xpath("/indicators[id eq '"+e.indicatorUUID.indicatorSetId+"']/instances/uuid",c,{})[0],void 0==n&&(n=JSON.xpath("/indicators[category/term eq '"+e.indicatorUUID.indicatorSetId+"']/_id",a,{})[0])),r(n)}else if(void 0!=e.indicator){var n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+e.indicator.indicatorSetId+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],p="";void 0!=e.indicator.basepath&&(p=e.indicator.basepath);var l="/model/pending/data/"+e.indicator.indicatorSetId+p+"/"+e.indicator.elementId,u=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+t+"']/id]/type",a,{})[0],v=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id])",a,{})[0]+1;if(u==PROCESS_TYPE_SUBPROFILE){var f=library.getSubprofileSubprocessIds();v=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+f+"])",a,{})[0]+1}var S=replaceAll(l,"#SEQUENCE#",v),b=JSON.xpath("/subprocesses[_id eq '"+t+"']/dates/valid",a,{})[0],h="'"+b+"'",m=replaceAll(S,"#END_DATE#",h),O=replaceAll(m,"[.]","/");if(p.length>0){var x=JSON.xpath(O,d,{});r(x)}else{var x=JSON.xpath(O,d,{})[0];void 0!=e.indicator.addString&&""!=e.indicator.addString&&(x+=e.indicator.addString),r(x)}}else if(void 0!=e.system)r("ERROR: Unimplemented system type found.");else if(void 0!=e.variable)if(void 0!=e.variable.profile){var N=e.variable.profile,g=a.profile,I=g+":variables";dao.get(I).then(function(s){if(void 0!=e.variable.type)"count"==e.variable.type?r(s[e.variable.name].length):i("ERROR: Profile variables type implementation - Case not found");else{for(var o=s,n=""==N?[]:N.split(/['"\[\].]+/),c=0;c<n.length;c++)""!=n[c]&&(o=o[n[c]]);var d=o;if(void 0==d)i("Variable not found");else if("object"==typeof d){var p=function(){return new Promise(function(r,i){var s=0;if(void 0==e.variable.periodic||void 0==e.variable.periodic.seq){var o=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+t+"']/id]/type",a,{})[0];if(s=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id])",a,{})[0]+1,o==PROCESS_TYPE_SUBPROFILE){var n=library.getSubprofileSubprocessIds();s=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+n+"])",a,{})[0]+1}r(s)}else getNodeValue(e.variable.periodic.seq,a,t).then(function(e){r(e)}).catch(function(e){i(e)})})},l=function(){return new Promise(function(r,i){var s="value";void 0!=e.variable.periodic&&void 0!=e.variable.periodic.value?getNodeValue(e.variable.periodic.value,a,t).then(function(e){r(e)}).catch(function(e){i(e)}):r(s)})};p().then(function(e){l().then(function(a){var t="/"+N+"["+e+"]/"+a,i=JSON.xpath(t,s,{})[0];r(i)}).catch(function(e){i(e)})}).catch(function(e){i(e)})}else"string"==typeof d&&r(d)}}).catch(function(e){i("ERROR: Profile variables not found")})}else if(void 0!=e.variable.subProfile){var N=e.variable.subProfile,q=app.profile.subprofileId;void 0!=e.variable.subprofileId&&""!=e.variable.subprofileId&&(q=e.variable.subprofileId);var I=q+":variables";dao.get(I).then(function(s){for(var o=s,n=""==N?[]:N.split(/['"\[\].]+/),c=0;c<n.length;c++)""!=n[c]&&(o=o[n[c]]);var d=o;if(void 0==d)i("Variable not found");else if("object"==typeof d){var p=0;if(void 0==e.variable.periodic||void 0==e.variable.periodic.seq){var l=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+t+"']/id]/type",a,{})[0];if(p=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id])",a,{})[0]+1,l==PROCESS_TYPE_SUBPROFILE){var u=library.getSubprofileSubprocessIds();p=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+u+"])",a,{})[0]+1}}else p=getNodeValue(e.variable.periodic.seq,a,t);var v="value";void 0!=e.variable.periodic&&void 0!=e.variable.periodic.value&&(v=getNodeValue(e.variable.periodic.value,a,t));var f="/"+N+"["+p+"]/"+v,S=JSON.xpath(f,s,{})[0];r(S)}else"string"==typeof d&&r(d)}).catch(function(e){i("ERROR: sub Profile variables not found")})}else i("ERROR: Unimplemented profile type found.");else if(void 0!=e.indicatorWrapper){var J=e.indicatorWrapper.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],_=replaceAll(e.indicatorWrapper.path,"[.]","/"),l="/"+_,E=JSON.xpath(l,d,{})[0];r(E)}else if(void 0!=e.calculated){for(var E="",P=e.calculated.separator,R=0;R<e.calculated.elements.length-1;R++){var y=e.calculated.elements,D=["fromRepeat","elementProperty","constantValue","elementWrapper","currentDate","randomDigits","profileObjectElement","profileObjectWrapper","currentFinancialYear","scopeVariable","xpath"];switch(propertyExists(y[R],D)){case"elementProperty":var J=y[R].elementProperty.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],_=replaceAll(y[R].elementProperty.elementId,"[.]","/"),l="/model/pending/data/"+J+"/"+_,k=JSON.xpath(l,d,{})[0];E=E+k+P;break;case"constantValue":var k=y[R].constantValue.value;E=E+k+P;break;case"scopeVariable":var A=y[R].scopeVariable,k="";"#USER_ID"==A?k=_lclx.SUBSCRIPTIONS.userId:"#USERNAME"==A?k=_lclx.SESSION.username:"#FIRSTNAME"==A?k=_lclx.SESSION.firstName:"#LASTNAME"==A&&(k=_lclx.SESSION.lastName),k.length>0&&(E=E+k+P);break;case"elementWrapper":var J=y[R].elementWrapper.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],_=replaceAll(y[R].elementWrapper.elementId,"[.]","/"),l="/"+_,k=JSON.xpath(l,d,{})[0];E=E+k+P;break;case"currentDate":E=E+formatDate(new Date)+P;break;case"randomDigits":var w=y[R].randomDigits.digits,U=Math.random(),V=Math.pow(10,w),W=U*V^0;E=E+W+P;break;case"profileObjectElement":var J=y[R].profileObjectElement.indicatorSetId,d=JSON.xpath("/indicators[category/term eq 'appProfile']",app.SCOPE.workflow,{})[0],_=replaceAll(y[R].profileObjectElement.elementId,"[.]","/"),l="/model/pending/data/"+J+"/"+_,k=JSON.xpath(l,d,{})[0];E=E+k+P;break;case"profileObjectWrapper":var J=y[R].profileObjectWrapper.indicatorSetId,d=JSON.xpath("/indicators[category/term eq 'appProfile']",app.SCOPE.workflow,{})[0],_=replaceAll(y[R].profileObjectWrapper.wrapperElementId,"[.]","/"),l="/"+_,k=JSON.xpath(l,d,{})[0];E=E+k+P;break;case"currentFinancialYear":var j=y[R].currentFinancialYear.startDate,F=y[R].currentFinancialYear.startMonth,M=(new Date).getFullYear()+"-"+F+"-"+j;E=E+M+P;break;case"fromRepeat":var J=y[R].fromRepeat.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],_=replaceAll(y[R].fromRepeat.path,"[.]","/"),l="/model/pending/data/"+J+"/"+_,Y="";if("validDate"==y[R].fromRepeat.filter){var T=JSON.xpath("/subprocesses[_id eq '"+t+"']",a,{})[0],C=T.dates.valid;Y="[enddate eq '"+C+"']/"}l=l+Y+replaceAll(y[R].fromRepeat.element,"[.]","/");var k=JSON.xpath(l,d,{})[0];E=E+k+P;break;case"xpath":if(void 0!=y[R].xpath.indicatorSetId&&y[R].xpath.indicatorSetId.length>0){var J=y[R].xpath.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],k=JSON.xpath(y[R].xpath.expr,d,{})[0];E=E+k+P;break}var k=JSON.xpath(y[R].xpath.expr,a,{})[0];E=E+k+P;break;default:i("No method found from implemented list.")}}var R=e.calculated.elements.length-1,y=e.calculated.elements,D=["fromRepeat","elementProperty","constantValue","elementWrapper","currentDate","randomDigits","profileObjectElement","profileObjectWrapper","currentFinancialYear","scopeVariable","xpath"];switch(propertyExists(y[R],D)){case"elementProperty":var J=y[R].elementProperty.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],_=replaceAll(y[R].elementProperty.elementId,"[.]","/"),l="/model/pending/data/"+J+"/"+_,k=JSON.xpath(l,d,{})[0];E+=k;break;case"constantValue":var k=y[R].constantValue.value;E+=k;break;case"scopeVariable":var A=y[R].scopeVariable,k="";"#USER_ID"==A?k=_lclx.SUBSCRIPTIONS.userId:"#USERNAME"==A?k=_lclx.SESSION.username:"#FIRSTNAME"==A?k=_lclx.SESSION.firstName:"#LASTNAME"==A&&(k=_lclx.SESSION.lastName),k.length>0&&(E+=k);break;case"elementWrapper":var J=y[R].elementWrapper.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],_=replaceAll(y[R].elementWrapper.elementId,"[.]","/"),l="/"+_,k=JSON.xpath(l,d,{})[0];E+=k;break;case"currentDate":E+=formatDate(new Date);break;case"randomDigits":var w=y[R].randomDigits.digits,U=Math.random(),V=Math.pow(10,w),W=U*V^0;E+=W;break;case"profileObjectElement":var J=y[R].profileObjectElement.indicatorSetId,d=JSON.xpath("/indicators[category/term eq 'appProfile']",app.SCOPE.workflow,{})[0],_=replaceAll(y[R].profileObjectElement.elementId,"[.]","/"),l="/model/pending/data/"+J+"/"+_,k=JSON.xpath(l,d,{})[0];E+=k;break;case"profileObjectWrapper":var J=y[R].profileObjectWrapper.indicatorSetId,d=JSON.xpath("/indicators[category/term eq 'appProfile']",app.SCOPE.workflow,{})[0],_=replaceAll(y[R].profileObjectWrapper.wrapperElementId,"[.]","/"),l="/"+_,k=JSON.xpath(l,d,{})[0];E+=k;break;case"currentFinancialYear":var j=y[R].currentFinancialYear.startDate,F=y[R].currentFinancialYear.startMonth,M=(new Date).getFullYear()+"-"+F+"-"+j;E+=M;break;case"fromRepeat":var J=y[R].fromRepeat.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],_=replaceAll(y[R].fromRepeat.path,"[.]","/"),l="/model/pending/data/"+J+"/"+_,Y="";if("validDate"==y[R].fromRepeat.filter){var T=JSON.xpath("/subprocesses[_id eq '"+t+"']",a,{})[0],C=T.dates.valid;Y="[enddate eq '"+C+"']/"}l=l+Y+replaceAll(y[R].fromRepeat.element,"[.]","/");var k=JSON.xpath(l,d,{})[0];E+=k;break;case"xpath":if(void 0!=y[R].xpath.indicatorSetId&&y[R].xpath.indicatorSetId.length>0){var J=y[R].xpath.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],k=JSON.xpath(y[R].xpath.expr,d,{})[0];E=E+k+P;break}var k=JSON.xpath(y[R].xpath.expr,a,{})[0];E=E+k+P;break;default:i("No method found from implemented list.")}r(E)}else if(void 0!=e.subProcess)if(void 0!=e.subProcess.path){for(var L=e.subProcess.path,B=L.split("."),Q="",R=0;R<B.length;R++)Q=Q+"['"+B[R]+"']";for(var c=JSON.xpath("/subprocesses[_id eq '"+t+"']",a,{})[0],z=c,G=""==Q?[]:Q.split(/['"\[\].]+/),H=0;H<G.length;H++)""!=G[H]&&(z=z[G[H]]);var E=z;r(E)}else void 0!=e.subProcess.stepUser})}function replaceAll(e,a,t){return"function"!=typeof e.replace&&(console.log(a+" "+t),console.log(e)),e.replace(new RegExp(a,"g"),t)}function formatDate(e){var a=e.getDate(),t=e.getMonth(),r=e.getFullYear();return a+"-"+t+"-"+r}function compare(e,a,t){switch(a){case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t;case"==":return void 0==e&&(e=""),e===t;case"!=":return e!==t}}module.exports={getLanguageMessage:getLanguageMessage,getNodeValue:getNodeValue,compare:compare};

},{}],5:[function(require,module,exports){
"use strict";function getProcess(e,s,t){return new Promise(function(n,i){try{var c=[],r=[];t.instance.processes.filter(function(s){s.id==e&&(r=s)}),util.syncLoop(r.subProcesses.length,function(n){var o=n.iteration(),u=r.seq,f=r.subProcesses[o].id,a=r.subProcesses[o].seq;getSubProcess(e,u,f,a,s,t).then(function(e){c.push(e),n.next()},function(e){n.break(),i(e)})},function(){n(c)})}catch(e){i(e)}})}function getSubProcess(e,s,t,n,i,c){return new Promise(function(r,o){try{var u={id:"",seq:"",name:"",help:"",dates:"",step:""},f=[],a=[];c.instance.processes.filter(function(i){if(i.id==e&&i.seq==s){i.subProcesses.length;i.subProcesses.filter(function(e){e.id==t&&e.seq==n&&0==e.complete&&(f=e)})}}),c.config.processes.filter(function(s){s._id==e&&s.subProcesses.filter(function(e){e._id==t&&(a=e)})}),u.id=a._id,u.seq=f.seq,u.name=util.getName(a.name,i),u.help=util.getName(a.help,i),u.dates=f.dates,u.step=f.step,r(u)}catch(e){o(e)}})}function prepareNotificationScreen(){""}var util=require("utility");module.exports={getProcess:getProcess};

},{"utility":8}],6:[function(require,module,exports){
"use strict";function get(){return new Promise(function(e,t){})}module.exports={get:get};

},{}],7:[function(require,module,exports){
"use strict";function count(e){return void 0!==e?e.length:0}function preRequisites(e,s,t){return new Promise(function(n,i){var o=[];try{util.syncLoop(e.length,function(n){var a=n.iteration();preRequisite(e[a],s,t).then(function(e){o.push(!0),n.next()},function(e){o.push(!1),n.break(),i(e)})},function(){if(o.every(Boolean)){var e=util.success("Pre-requisites completed successfully.",{});n(e)}else{var s=util.error("WFPreRequisiteError","Not all pre-requisites passed.");i(s)}})}catch(e){i(e)}})}function preRequisite(e,s,t){return new Promise(function(n,i){if(void 0!=e.check.numberProcessInstances){var o=e.check.numberProcessInstances,a=o.operator,r="";switch(a){case"greaterThan":r="gt";break;case"lessThan":r="lt";break;case"greaterThanEqual":r="ge";break;case"lessThanEqual":r="le";break;case"equalTo":r="eq";break;case"notEqualTo":r="ne"}var c=o.subProcessId,u=o.type,d="";d="all"==u?"":"[complete eq 'true']";var p="";void 0!=o.filter&&o.filter.length>0&&(p="["+o.filter+"]");var l="count(/instance/processes/subProcesses[id eq '"+c+"']"+d+p+")",f=JSON.xpath("/config/processes/subProcesses[_id eq '"+c+"']/type",s,{})[0],m=library.getSubprofileSubprocessIds();void 0!=app.profile.subprofileId&&""!=app.profile.subprofileId&&void 0!=f&&f==PROCESS_TYPE_SUBPROFILE&&(l="count(/instance/processes/subProcesses[id eq '"+c+"' and uuid = "+m+"]"+d+")");var h=JSON.xpath(l,s,{})[0],g=e.check.numberProcessInstances.count,v=util.compare(h,e.check.numberProcessInstances.operator,parseInt(g));if(v){var S=util.success("Pre-requisites passed.",{});n(S)}else{var I=helper.getLanguageMessage(e.message),N=util.error("WFPreRequisiteError",I);i(N)}}else if(void 0!=e.check.variable){var b=e.check.variable.scope,y="";if("profile"==b){var P=s.profile;y=P+":variables"}else if("subProfileSubProcessInstance"==b){var _=app.profile.subprofileId;y=_+":variables"}else i("ERROR: Scope '"+b+"' not implemented in pre-requisites");dao.get(y).then(function(o){for(var a=e.check.variable.name,r=e.check.variable.type,c=o,u=""==a?[]:a.split(/['"\[\].]+/),d=0;d<u.length;d++)""!=u[d]&&(c=c[u[d]]);var p,l=c;if(void 0!=r&&"array"==r)p=l;else if("object"==typeof l){var f=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+t+"']/id]/type",s,{})[0],m=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id])",s,{})[0]+1;if(f==PROCESS_TYPE_SUBPROFILE){var h=library.getSubprofileSubprocessIds();m=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+h+"])",s,{})[0]+1}var g="/"+a+"["+m+"]/value";p=JSON.xpath(g,o,{})[0]}else"string"==typeof l&&(p=l);var v=e.check.variable.value.data,S=e.check.variable.value.dataType.dataType;if(0==v.indexOf("xpath:")){var I=v.substring(6);v=JSON.xpath(I,s,{})[0]}if("#VALID_DATE"==v){var N=JSON.xpath("/subprocesses[_id eq '"+t+"']",s,{})[0];void 0!=N&&(v=N.dates.valid)}var c;if("number"==S?c=Number(v):"string"==S?c=v:"integer"==S?(c=parseInt(v),void 0!=r&&"array"==r&&(p=void 0==p?0:p.length)):"decimal"==S?c=parseFloat(v):"date"!=S&&"dateTime"!=S||(c=v),void 0==p&&void 0!=e.check.variable.allowBlank&&1==e.check.variable.allowBlank){var b=util.success("Variable Pre-requisites passed.",{});n(b)}else{var y=util.compare(p,e.check.variable.operator,c);if(y){var b=util.success("Variable Pre-requisites passed.",{});n(b)}else{var P=helper.getLanguageMessage(e.message);P=P.replace("#VALID_DATE",p);var _=util.error("WFPreRequisiteError",P);i(_)}}}).catch(function(s){if(void 0!=e.check.variable.allowBlank&&1==e.check.variable.allowBlank){var t=util.success("Variable Pre-requisites passed.",{});n(t)}else{var o=helper.getLanguageMessage(e.message),s=util.error("WFPreRequisiteError:",o);i(s)}})}else{var N=util.error("WFPreRequisiteError","Pre-requisite type not defined.");i(N)}})}function preActions(e,s,t){return new Promise(function(n,i){var o=[];try{var a=JSON.xpath("/subprocesses[_id eq '"+t+"']",s,{})[0],r=a["meta-data"].processConfigId,c=a["meta-data"].subProcessConfigId,u=a["meta-data"].subProcessInsSeq,d=a["meta-data"].subProcessInsSeq,p=JSON.xpath("/processes[_id eq '"+r+"']/subProcesses[_id eq '"+c+"']",s.config,{})[0],l=JSON.xpath("/subprocesses[_id eq '"+t+"']/step",s,{})[0];util.syncLoop(e.length,function(n){var a=n.iteration();action(e[a],r,u,c,d,p,l,s,{},t).then(function(e){o.push(!0),n.next()},function(e){o.push(!1),n.break(),i(e)})},function(){if(o.every(Boolean)){var e=util.success("Pre-actions completed successfully.",{});n(e)}else{var s=util.error("WFPreRequisiteError","Not all pre-actions passed.");i(s)}})}catch(e){i(e)}})}function getSubProcess(e,s){return void 0==s.subprocesses?[]:void s.subprocesses.filter(function(s){if(s.id==e)return s})}function subProcess(e,s,t,n,i,o,a,r){var c=[],u=[],d=[];r.subprocesses.filter(function(s){s._id==e&&(c=s)}),r.config.processes.filter(function(e){e._id==s&&(u=e,e.subProcesses.filter(function(e){e._id==n&&(d=e)}))});var p="",l=a.baseUUID,f=0;if(void 0!=l&&""!=l&&l.length>0){var m=JSON.xpath("/subprocesses[_id eq '"+l+"']",r,{})[0];p=m.groupKey,f=m["meta-data"].subProcessInsSeq}else{for(var h="",g=0;g<d.indicators.length-1;g++)h=h+"'"+d.indicators[g]._id+"',";h=h+"'"+d.indicators[g]._id+"'";var v=JSON.xpath("/indicators[setId = ("+h+") and cardinality eq 'single']",app.SCOPE.APP_CONFIG,{}).length;if(void 0!=d.instanceType.newSequence||v>0){var m=JSON.xpath("/instance/processes[id eq '"+s+"']",r,{})[0];p=void 0!=m&&m.subProcesses.length>0?m.subProcesses[0].groupKey:generateUUID()}else p=generateUUID();f=JSON.xpath("count(/processes/subProcesses[groupKey eq '"+p+"'])",r.instance,{})[0]}var S=a.label,I=e,N={_id:I,id:n,type:"workflowInstanceSubProcess",dateTimeCreated:moment().format(),dueDateTime:moment().format(),seq:i,initiated:!1,dates:{created:"",valid:"",start:"",due:"",closed:""},complete:!1,indicators:[],step:{},active:!0,groupKey:p,label:S,channels:["community_"+app.SCOPE.getCommunityId(),"profile_"+app.SCOPE.profileId,"application_"+app.SCOPE.applicationId,"community_"+app.SCOPE.getCommunityId()+"_application_"+app.SCOPE.applicationId],history:[],"meta-data":{applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.profileId,subprofileId:void 0==o?"":o,processConfigId:s,subProcessConfigId:n,subProcessInsSeq:f+1},messages:[],spStatus:""};return void 0!=a.validDate&&a.validDate.length>0&&(void 0!=d.periodType.periodic?N.dates.valid=moment(a.validDate).endOf("month").format("YYYY-MM-DD"):N.dates.valid=a.validDate),void 0!=app.profile.subprofileId&&""!=app.profile.subprofileId?(N.channels.push("profile_"+app.SCOPE.profileId+"_subprofile_"+app.profile.subprofileId),N.channels.push("subprofile_"+app.profile.subprofileId)):(N.channels.push("profile_"+app.SCOPE.profileId+"_subprofile_0"),N.channels.push("subprofile_0")),r.subprocesses.push(N),new Promise(function(e,o){try{var p=u.preActions;preActions(p,r,I).then(function(p){var l=u.prerequisites;preRequisites(l,r,I).then(function(u){var p=d.initiate;initiate(p,c,a).then(function(c){N.initiated=c.data.initiated,N.dates=c.data.dates;var u=d.steps[0]._id,p=(d.steps[0].transition[0]._id,1);step(s,t,n,i,u,p,a,r,I).then(function(s){N.step=s.data,indicators(d.indicators,r,N._id).then(function(s){N.indicators=s.data;var t=util.success(s.message,N);e(t)},function(e){o(e)})},function(e){console.log(e),o(e)})},function(e){r.subprocesses=r.subprocesses.filter(function(e){return!(e._id==I)}),o(e)})},function(e){r.subprocesses=r.subprocesses.filter(function(e){return!(e._id==I)}),o(e)})},function(e){r.subprocesses=r.subprocesses.filter(function(e){return!(e._id==I)}),o(e)})}catch(e){o(e)}})}function initiate(e,s,t){var n={initiated:!1,dates:{created:"",valid:"",start:"",due:"",closed:""}};return new Promise(function(i,o){var a=function(){if(void 0!=e.user){n.dates.created=t.createdDate,"userSelected"!=e.user.validDate._type&&"autoSelected"!=e.user.validDate._type||(void 0!=t.validDate?n.dates.valid=t.validDate:n.dates.valid=(new Date).toISOString().substring(0,10)),"userSelected"!=e.user.dueDate._type&&"autoSelected"!=e.user.dueDate._type||void 0!==t.dueDate&&(n.dates.due=t.dueDate),n.dates.start=t.firstDate,n.initiated=!0;var s=util.success("Sub-Process initiate completed successfully.",n);i(s)}else if(void 0!=e.auto);else{var a=util.error("WFInitiateError","Initiate type: "+e._type+" not defined.");o(a)}};if(void 0==s.complete)a();else if(!s.complete)if(e.parallelInstances)a();else{var r=util.error("WFInitiateError","Sub-process: "+s.id+" still active and parallel instances are not allowed.");o(r)}})}function step(e,s,t,n,i,o,a,r,c){var u,d={key:generateUUID(),id:"",seq:"",status:"",message:"",assignedTo:{userId:"",name:"",dateTime:"",type:"",dueDateTime:"",by:""},assignmentHistory:[],dateTimeCreated:moment().format(),dueDateTime:moment().format(),transition:{transitionId:"",dateTime:"",userId:""},assignment:{},comment:""},p={},l="",f={};return new Promise(function(m,h){try{r.subprocesses.filter(function(e){e._id==app.SCOPE.processUUID&&(u=e)}),r.config.processes.filter(function(s){s._id==e&&s.subProcesses.filter(function(e){e._id==t&&(p=e,e.steps.filter(function(e){e._id==i&&(f=e)}))})}),d.id=i,d.seq=o;var g="";void 0!=f.setInstanceStatusTo.NotStarted?g="NotStarted":void 0!=f.setInstanceStatusTo.Created?g="Created":void 0!=f.setInstanceStatusTo.InProgress?g="InProgress":void 0!=f.setInstanceStatusTo.Submitted?g="Submitted":void 0!=f.setInstanceStatusTo.Complete&&(g="Complete");var v=service.getLanguage();d.status=g,d.message=f.setInstanceStatusTo[g].label.i18n[v],d.comment=void 0!==a.comment?a.comment:"";var S=void 0!==u?u.indicators:[],I=function(e,s){var t=d.assignedTo;if(e.length>0)for(var n=0;n<e.length;n++){var i=e[n],o=i.instances[0].uuid,a=JSON.xpath("/indicators[_id eq '"+o+"']",s,{})[0];i.instances[0].seq=a.model.pending.seq;for(var r=0;r<a.workflows.length;r++)void 0!=a.workflows[r].processes[0]&&void 0!=a.workflows[r].processes[0].subProcessUUID&&void 0!=a.workflows[r].processes[0].step&&c==a.workflows[r].processes[0].subProcessUUID&&(a.workflows[r].processes[0].step.assignedTo=t)}},N=function(e){var s=JSON.xpath("/subprocesses[_id eq '"+e+"']",r,{})[0];s.spStatus=""};indicatorDocs(e,S,d,r,c).then(function(o){l=c,void 0!=f.function.actions?actions(f.function.actions,e,s,t,n,p,d,r,a,c).then(function(o){var u=d.assignedTo;u.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,u.userId=_lclx.SUBSCRIPTIONS.userId+"",u.dateTime=moment().format(),u.type=ASSIGNMENT_TYPE_AUTO,u.dueDateTime="",u.by=_lclx.SUBSCRIPTIONS.userId+"",I(S,r);var p=f.transition[0]._id;transition(e,s,t,n,i,p,a,r,c,d).then(function(e){var s=util.success("Transition completed successfully.",e.data.step);m(s)},function(e){h(e)})},function(e){console.log(e),h(e)}):void 0!=f.function.task?task(e,s,f.function.task,c,d).then(function(e){I(S,r);var s=util.success("Task awaiting user action.",d);m(s)},function(e){h(e)}):void 0!=f.function.server&&(N(c),server(f.function.server,e,s,t,n,p,d,r,a,c).then(function(e){I(S,r);var s=util.success("Server awaiting server response.",d);m(s)},function(e){h(e)}))},function(e){h(e)})}catch(e){h(e)}})}function indicators(e,s,t){var n=[];return new Promise(function(e,i){try{for(var o=JSON.xpath("indicators[fn:count(./workflows/processes[subProcessUUID eq '"+t+"']) gt 0]",s,{}),a=0;a<o.length;a++){var r=o[a],c={id:"",instances:[]},u={uuid:"",title:"",key:"",seq:1,rev:""};c.id=r.category.term,u.uuid=r._id,u.rev=r._rev,u.title=r.title,u.key="",u.seq=r.model.pending.seq,c.instances.push(u),n.push(c)}var d=util.success("Process indicator model updated.",n);e(d)}catch(e){i(e)}})}function assignUser(e,s,t,n,i,o,a){return new Promise(function(s,t){try{a.subprocesses.filter(function(t){if(t._id==o){void 0==t.step.assignmentHistory&&(t.step.assignmentHistory=[]),""!=t.step.assignedTo.userId&&""!=t.step.assignedTo.name&&t.step.assignmentHistory.push(JSON.parse(JSON.stringify(t.step.assignedTo))),t.step.assignedTo.userId=i.id,t.step.assignedTo.name=i.name,t.step.assignedTo.dateTime=moment().format(),t.step.assignedTo.type=ASSIGNMENT_TYPE_REASSIGNMENT,t.step.assignedTo.dueDateTime="",t.step.assignedTo.by=_lclx.SUBSCRIPTIONS.userId+"";for(var n=t.indicators,r=0;r<n.length;r++)for(var c=n[r],u=0;u<c.instances.length;u++)for(var d=c.instances[u],p=0;p<a.indicators.length;p++){var l=a.indicators[p];d.uuid==l._id&&l.workflows.filter(function(s){s.processes.filter(function(s){s.id==e&&(s.step.assignedTo.userId=i.id,s.step.assignedTo.name=i.name)})})}var f=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=f&&void 0!=f.reAssignment)if("string"==typeof f.reAssignment){var m=f.reAssignment;dao.getConfig(m).then(function(e){f.reAssignment=e,actionsModule.notification.reAssignmentNotification(f,a,o,i).then(function(e){var e=util.success('User assigned successfully. UserId: "'+i.id+'", Name: "'+i.name+'"',t);s(e)}).catch(function(e){s(e)})}).catch(function(e){s(e)})}else actionsModule.notification.reAssignmentNotification(f,a,o,i).then(function(e){var e=util.success('User assigned successfully. UserId: "'+i.id+'", Name: "'+i.name+'"',t);s(e)}).catch(function(e){s(e)});else{var h=util.success('User assigned successfully. UserId: "'+i.id+'", Name: "'+i.name+'"',t);s(h)}}})}catch(e){t(e)}})}function indicatorDocs(e,s,t,n,i){return new Promise(function(e,o){try{if(void 0==s){util.error("WFIndicatorsUpdate","Indicators parameter is required. - Value: "+s);o(err)}else{for(var a=0;a<s.length;a++)for(var r=s[a],c=0;c<r.instances.length;c++)for(var u=r.instances[c],d=0;d<n.indicators.length;d++){var p=n.indicators[d];u.uuid==p._id&&p.workflows.filter(function(e){e.processes.filter(function(e){e.subProcessUUID==i&&(e.step.id=t.id,e.step.seq=t.seq,e.step.status=t.status,e.step.message=t.message,e.step.assignedTo.userId=t.assignedTo.userId,e.step.assignedTo.name=t.assignedTo.name,e.step.comment=void 0!==t.comment?t.comment:"")})})}var l=util.success("Indicator documents workflow process model updated.",n);e(l)}}catch(e){o(e)}})}function actions(e,s,t,n,i,o,a,r,c,u){var d=[];return new Promise(function(p,l){util.syncLoop(e.length,function(p){var f=p.iteration();action(e[f],s,t,n,i,o,a,r,c,u).then(function(s){var t={id:e[f]._id,seq:f,data:s};d.push(t),p.next()},function(e){p.break(),l(e)})},function(){var e=util.success("Actions completed successfully.",d);p(e)})})}function action(e,s,t,n,i,o,a,r,c,u){return new Promise(function(n,d){if(void 0!=e.method){var p=["form","indicator","profile","subProcessInstance","step","community","application","user","sdo","performance","taxonomy","variables","notification","report","worker","participants","generalFunctions"];switch(propertyExists(e.method,p)){case"form":if(void 0!=e.method.form.create){var l=[];l.push(s),l.push(o),l.push(a),l.push(e),l.push(t),l.push(i),l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.create(l).then(function(e){n(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.authorise){var l=[];l.push(s),l.push(o),l.push(t),l.push(i),l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.authorise(l).then(function(e){n(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.undraft){var l=[];l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.setUnDraft(l).then(function(e){n(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.draft){var l=[];l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.setDraft(l).then(function(e){n(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.close){var l=[];l.push(o.indicators),l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.close(l).then(function(e){n(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.authoriseAndCreateNewSeq){var l=[];l.push(s),l.push(o),l.push(t),l.push(i),l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.authorise(l).then(function(p){var l=[];l.push(s),l.push(o),l.push(a),l.push(e),l.push(t),l.push(i),l.push(r),l.push(c.createType),l.push(u),l.push(u),l.push(c),form.create(l).then(function(e){n(e.data)},function(e){d(e)})},function(e){d(e)})}else if(void 0!=e.method.form.createNewSeq){var l=[];l.push(s),l.push(o),l.push(a),l.push(e),l.push(t),l.push(i),l.push(r),l.push(c.createType),l.push(u),l.push(u),l.push(c),form.create(l).then(function(e){n(e.data)},function(e){d(e)})}break;case"indicator":if(void 0!=e.method.indicator.create)n("Not implemented");else if(void 0!=e.method.indicator.instantiate)n("Not implemented");else if(void 0!=e.method.indicator.setValue){var f=e.method.indicator.setValue.path;helper.getNodeValue(e.method.indicator.setValue.data,r,u).then(function(e){var s=[];s.push(r),s.push(u),s.push(f),s.push(e),form.updateIndicator(s).then(function(e){n(e.data)},function(e){d(e)})},function(e){d(e)})}else if(void 0!=e.method.indicator.updateStatus){var m=e.method.indicator.indicatorSetId,l=[];if(l.push(r),l.push(u),void 0!=e.method.indicator.updateStatus){var h=e.method.indicator.updateStatus;l.push(h),l.push(m),form.markUpdateIndicator(l).then(function(e){n(e.data)},function(e){d(e)})}else n("Action indicator sub type not found.")}else if(void 0!=e.method.indicator.setWrapperElement){var f=e.method.indicator.setWrapperElement.path,m=e.method.indicator.setWrapperElement.indicatorSetId;helper.getNodeValue(e.method.indicator.setWrapperElement.data,r,u).then(function(e){var s=[];s.push(r),s.push(u),s.push(f),s.push(e),s.push(m),form.updateIndicatorWrapper(s).then(function(e){n(e.data)},function(e){d(e)})},function(e){d(e)})}break;case"profile":if(void 0!=e.method.profile.create){var l=[];l.push(s),l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.createProfile(l).then(function(e){n(e.data)},function(e){d(e)})}else if(void 0!=e.method.profile.setStatusTo){var l=[],h=e.method.profile.setStatusTo;l.push(r),l.push(u),l.push(h),form.setStatus(l).then(function(e){n(e.data)},function(e){d(e)})}break;case"subProcessInstance":var g=["instantiate","authorise","close","setVariable","setStatusTo","setStatusMsgTo","setTitle","setValidDate","setSPStatus"];switch(propertyExists(e.method.subProcessInstance,g)){case"setTitle":helper.getNodeValue(e.method.subProcessInstance.setTitle,r,u).then(function(s){actionsModule.subProcessInstance.setTitle(e.method.subProcessInstance.setTitle,u,s,r).then(function(e){n(e.data)},function(e){d(e)})},function(e){d(e)});break;case"setValidDate":helper.getNodeValue(e.method.subProcessInstance.setValidDate,r,u).then(function(s){actionsModule.subProcessInstance.setValidDate(e.method.subProcessInstance.setValidDate,u,s,r).then(function(e){n(e.data)},function(e){d(e)})},function(e){d(e)});break;case"setSPStatus":helper.getNodeValue(e.method.subProcessInstance.setSPStatus,r,u).then(function(s){actionsModule.subProcessInstance.setSPStatus(e.method.subProcessInstance.setSPStatus,u,s,r).then(function(e){n(e.data)},function(e){d(e)})},function(e){d(e)});break;default:d("No method found from implemented list in subprocess action.")}break;case"step":break;case"community":var v=["createCommunity","releaseAdoptedApplication","userJoinCommunity"];switch(propertyExists(e.method.community,v)){case"createCommunity":return actionsModule.community.createCommunity(e.method.community.createCommunity,u,r).then(function(e){n(e.data)},function(e){d(e)});case"releaseAdoptedApplication":return actionsModule.community.releaseAdoptedApplication(e.method.community.releaseAdoptedApplication,u,r).then(function(e){n(e.data)},function(e){d(e)});case"userJoinCommunity":return actionsModule.community.userJoinCommunity(e.method.community.userJoinCommunity,u,r).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"application":var S=["createAppDefinition","buildApplication","applicationAdoption"];switch(propertyExists(e.method.application,S)){case"createAppDefinition":return actionsModule.application.createAppDefinition(e.method.application.createAppDefinition,u,r).then(function(e){n(e.data)},function(e){d(e)});case"buildApplication":return actionsModule.application.buildApplication(e.method.application.buildApplication,u,r).then(function(e){n(e.data)},function(e){d(e)});case"applicationAdoption":return actionsModule.application.applicationAdoption(e.method.application.applicationAdoption,u,r).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"user":var I=["addToRole"];switch(propertyExists(e.method.user,I)){case"addToRole":return actionsModule.user.addToRole(e.method.user.addToRole,u,r).then(function(e){n(e.data)},function(e){d(e)})}break;case"sdo":var N=["create","enrollCourse"];switch(propertyExists(e.method.sdo,N)){case"create":return actionsModule.sdo.create(e.method.sdo.create,u,r).then(function(e){n(e.data)},function(e){d(e)});case"enrollCourse":return actionsModule.sdo.enrollCourse(e.method.sdo.enrollCourse,u,r).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"performance":var b=["unlockPeriod","lockPerformanceModel","setModelStatus"];switch(propertyExists(e.method.performance,b)){case"unlockPeriod":return actionsModule.performance.unlockPeriod(e.method.performance.unlockPeriod,u,r).then(function(e){n(e.data)},function(e){d(e)});case"setModelStatus":return actionsModule.performance.setModelStatus(e.method.performance.setModelStatus,u,r).then(function(e){n(e.data)},function(e){d(e)});case"lockPerformanceModel":return actionsModule.performance.lockPerformanceModel(e.method.performance.lockPerformanceModel,u,r).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"taxonomy":var y=["create"];switch(propertyExists(e.method.taxonomy,y)){case"create":return actionsModule.taxonomy.create(e.method.taxonomy.create,u,r).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"variables":var P=["setVariable"];switch(propertyExists(e.method.variables,P)){case"setVariable":return actionsModule.variables.setVariable(e.method.variables.setVariable,r,u).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"notification":if("string"==typeof e.method.notification){var _=e.method.notification;dao.getConfig(_).then(function(s){e.method.notification=s,actionsModule.notification.sendNotificationWorker(e.method.notification,r,u).then(function(e){n(e.data)},function(e){d(e)})}).catch(function(e){n(e)})}else actionsModule.notification.sendNotificationWorker(e.method.notification,r,u).then(function(e){n(e.data)},function(e){d(e)});break;case"report":var O=["createPerformanceReport","createReport","sdoReport","executeReport","requestReport","generateView","generateBasicView","generateUnionView","sdoReportMultiple","subprofileQuarterlyReport"];switch(propertyExists(e.method.report,O)){case"createPerformanceReport":return actionsModule.report.createPerformanceReport(e.method.report.createPerformanceReport,r,u).then(function(e){n(e.data)},function(e){d(e)});case"createReport":return actionsModule.report.createReport(e.method.report.createReport,r,u).then(function(e){n(e.data)},function(e){d(e)});case"sdoReport":return actionsModule.report.sdoReport(e.method.report.sdoReport,r,u).then(function(e){n(e.data)},function(e){d(e)});case"executeReport":return actionsModule.report.executeReport(e.method.report.executeReport,r,u).then(function(e){n(e.data)},function(e){d(e)});case"generateView":return actionsModule.report.generateView(e.method.report.generateView,r,u).then(function(e){n(e.data)},function(e){d(e)});case"requestReport":return actionsModule.report.requestReport(e.method.report.requestReport,r,u).then(function(e){n(e.data)},function(e){d(e)});case"generateBasicView":return actionsModule.report.generateBasicView(e.method.report.generateBasicView,r,u).then(function(e){n(e.data)},function(e){d(e)});case"generateUnionView":return actionsModule.report.generateUnionView(e.method.report.generateUnionView,r,u).then(function(e){n(e.data)},function(e){d(e)});case"sdoReportMultiple":return actionsModule.report.sdoReportMultiple(e.method.report.sdoReportMultiple,r,u).then(function(e){n(e.data)},function(e){d(e)});case"subprofileQuarterlyReport":return actionsModule.report.subprofileQuarterlyReport(e.method.report.subprofileQuarterlyReport,r,u).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"worker":var T=["sendWorker","executeLocal","create"];switch(propertyExists(e.method.worker,T)){case"sendWorker":return actionsModule.worker.sendWorker(e.method.worker.sendWorker,r,u).then(function(e){n(e.data)},function(e){d(e)});case"executeLocal":return actionsModule.worker.executeLocal(e.method.worker.executeLocal,r,u).then(function(e){n(e.data)},function(e){d(e)});case"create":return actionsModule.worker.create(e.method.worker.create,r,u).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"participants":var x=["linkParticipants","monthlyAttendance","monthlyProgressSummary","participantContracts"];switch(propertyExists(e.method.participants,x)){case"linkParticipants":return actionsModule.participants.linkParticipants(e.method.participants.linkParticipants,r,u).then(function(e){n(e.data)},function(e){d(e)});case"monthlyAttendance":return actionsModule.participants.monthlyAttendance(e.method.participants.monthlyAttendance,r,u).then(function(e){n(e.data)},function(e){d(e)});case"monthlyProgressSummary":return actionsModule.participants.monthlyProgressSummary(e.method.participants.monthlyProgressSummary,r,u).then(function(e){n(e.data)},function(e){d(e)});case"participantContracts":return actionsModule.participants.participantContracts(e.method.participants.participantContracts,r,u).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"generalFunctions":var q=["addToFavourites","addToUserFavourites"];switch(propertyExists(e.method.generalFunctions,q)){case"addToFavourites":return actionsModule.generalFunctions.addToFavourites(e.method.generalFunctions.addToFavourites,r,u).then(function(e){n(e.data)},function(e){d(e)});case"addToUserFavourites":return actionsModule.generalFunctions.addToUserFavourites(e.method.generalFunctions.addToUserFavourites,r,u).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;default:d("method not defined in configuration")}}else d("No method found from implemented list.")})}function task(e,s,t,n,i){return new Promise(function(s,o){var a=app.SCOPE.workflow,r=t.preActions;preActions(r,a,n).then(function(r){var c=[];if(void 0!=t.assign.role){var u=a.profile,d="",p=function(){var r=t.assign.role.roleId;library.getUsersFromProfileRole(d,r).then(function(o){if(void 0!=o)if(o.length>1){for(var r=!1,c=0;c<o.length;c++){o[c].id;_lclx.SUBSCRIPTIONS.userId==o[c].id&&(r=!0)}if(r){void 0==i.assignmentHistory&&(i.assignmentHistory=[]);var u=i.assignedTo;if(""!=u.userId&&""!=u.name){var p=JSON.parse(JSON.stringify(u));i.assignmentHistory.push(p)}u.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,u.userId=_lclx.SUBSCRIPTIONS.userId+"",u.dateTime=moment().format(),u.type=ASSIGNMENT_TYPE_AUTO,u.dueDateTime="",u.by=_lclx.SUBSCRIPTIONS.userId+"";var l=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=l&&void 0!=l.assignment){var f={id:_lclx.SUBSCRIPTIONS.userId,name:_lclx.SUBSCRIPTIONS.username};if("string"==typeof l.assignment){var m=l.assignment;dao.getConfig(m).then(function(e){l.assignment=e,actionsModule.notification.assignmentNotification(l,a,n,f).then(function(e){console.log('User assigned successfully. UserId: "'+f.id+'", Name: "'+f.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+f.id+'", Name: "'+f.name+'"')})}).catch(function(e){s(e)})}else actionsModule.notification.assignmentNotification(l,a,n,f).then(function(e){console.log('User assigned successfully. UserId: "'+f.id+'", Name: "'+f.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+f.id+'", Name: "'+f.name+'"')})}}var h="";if(void 0!=t.assign.assignment){var h=i.assignment,g={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};h.accept=g,h.message=_getNameByLang(t.assign.assignment.message.i18n);var v={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};h.reject=v;var S={profileId:d,type:"user",userId:o};h.value=S,h.profileRoleId=d}if(r){var I=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+n+"']/id",a,{})[0],N=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+n+"']/id",a,{})[0],b=JSON.xpath("/subprocesses[_id eq '"+n+"']/step/id",a,{})[0];JSON.xpath("/processes[_id eq '"+I+"']/subProcesses[_id eq '"+N+"']/steps[_id eq '"+b+"']",a.config,{})[0];if(void 0!=t.preWorkActions){var y=t.preWorkActions;preWorkActions(y,a).then(function(e){s("Assignment is made. Pre work actions found and executed ")},function(e){v(e)})}else s("Assignment is made. No pre work actions found. ")}else{var l=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=l&&void 0!=l.assignmentAcceptance){var f={id:_lclx.SUBSCRIPTIONS.userId,name:_lclx.SUBSCRIPTIONS.username};actionsModule.notification.acceptanceNotificationExternal(l,a,n,o).then(function(e){s("Notifications request submitted for acceptance.")}).catch(function(e){s("Notifications failed"),console.log('User assignment notification failed to user UserId: "'+f.id+'", Name: "'+f.name+'"')})}else s("Notifications not found")}}else if(1==o.length){var P=o[0].id,_=o[0].name;void 0==i.assignmentHistory&&(i.assignmentHistory=[]);var u=i.assignedTo;if(""!=u.userId&&""!=u.name){var p=JSON.parse(JSON.stringify(u));i.assignmentHistory.push(p)}u.name=_+"",u.userId=P+"",u.dateTime=moment().format(),u.type=ASSIGNMENT_TYPE_AUTO,u.dueDateTime="",u.by=_lclx.SUBSCRIPTIONS.userId+"";var h="";if(void 0!=t.assign.assignment){var h=i.assignment,g={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};h.accept=g,h.message=_getNameByLang(t.assign.assignment.message.i18n);var v={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};h.reject=v;var S={profileId:d,userId:o,type:"user"};h.value=S,h.profileRoleId=d}var l=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=l&&void 0!=l.assignment){var f={id:P,name:_};if("string"==typeof l.assignment){var m=l.assignment;dao.getConfig(m).then(function(e){l.assignment=e,actionsModule.notification.assignmentNotification(l,a,n,f).then(function(e){console.log('User assigned successfully. UserId: "'+f.id+'", Name: "'+f.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+f.id+'", Name: "'+f.name+'"')})}).catch(function(e){s(e)})}else actionsModule.notification.assignmentNotification(l,a,n,f).then(function(e){console.log('User assigned successfully. UserId: "'+f.id+'", Name: "'+f.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+f.id+'", Name: "'+f.name+'"')})}var I=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+n+"']/id",a,{})[0],N=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+n+"']/id",a,{})[0],b=JSON.xpath("/subprocesses[_id eq '"+n+"']/step/id",a,{})[0];JSON.xpath("/processes[_id eq '"+I+"']/subProcesses[_id eq '"+N+"']/steps[_id eq '"+b+"']",a.config,{})[0];if(void 0!=t.preWorkActions){var y=t.preWorkActions;preWorkActions(y,a).then(function(e){s("Assigned to the only user in role. Pre work actions executed")},function(e){v(e)})}else s("Assigned to the only user in role. No pre work actions found.")}else{var u=i.assignedTo;u.name="",u.userId="";var h="";if(void 0!=t.assign.assignment){var h=i.assignment,g={
show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};h.accept=g,h.message=_getNameByLang(t.assign.assignment.message.i18n);var v={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};h.reject=v;var S={profileId:d,userId:o,type:"user"};h.value=S,h.profileRoleId=d}s("No users found in list. Assigning blank ")}else v("Error in getUsersFromProfileRole ")}).catch(function(e){o(e)})},l=function(){var r=t.assign.role.roleId;library.getUsersListByRole(d,r).then(function(o){if(void 0!=o)if(o.length>1){var c=!1,p=library.getCurrentUserRoles(),l=p.profile.indexOf(r),f=p.community.indexOf(r),m=p.implicit.indexOf(r),h=p.adoption.indexOf(r),g=p.subprofile.indexOf(r);if(c=l>-1||f>-1||m>-1||h>-1||g>-1){void 0==i.assignmentHistory&&(i.assignmentHistory=[]);var v=i.assignedTo;if(""!=v.userId&&""!=v.name){var S=JSON.parse(JSON.stringify(v));i.assignmentHistory.push(S)}v.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,v.userId=_lclx.SUBSCRIPTIONS.userId+"",v.dateTime=moment().format(),v.type=ASSIGNMENT_TYPE_AUTO,v.dueDateTime="",v.by=_lclx.SUBSCRIPTIONS.userId+"";var I=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=I&&void 0!=I.assignment){var N={id:_lclx.SUBSCRIPTIONS.userId,name:_lclx.SUBSCRIPTIONS.username};if("string"==typeof I.assignment){var b=I.assignment;dao.getConfig(b).then(function(e){I.assignment=e,actionsModule.notification.assignmentNotification(I,a,n,N).then(function(e){console.log('User assigned successfully. UserId: "'+N.id+'", Name: "'+N.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}).catch(function(e){s(e)})}else actionsModule.notification.assignmentNotification(I,a,n,N).then(function(e){console.log('User assigned successfully. UserId: "'+N.id+'", Name: "'+N.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}}var y="";if(void 0!=t.assign.assignment){var y=i.assignment,P={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};y.accept=P,y.message=_getNameByLang(t.assign.assignment.message.i18n);var _={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};y.reject=_;var O={profileId:u,roleId:r,type:"role"};y.value=O,y.profileRoleId=d}if(c){var T=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+n+"']/id",a,{})[0],x=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+n+"']/id",a,{})[0],q=JSON.xpath("/subprocesses[_id eq '"+n+"']/step/id",a,{})[0];JSON.xpath("/processes[_id eq '"+T+"']/subProcesses[_id eq '"+x+"']/steps[_id eq '"+q+"']",a.config,{})[0];if(void 0!=t.preWorkActions){var U=t.preWorkActions;preWorkActions(U,a).then(function(e){s("Assignment is made. Pre work actions found and executed ")},function(e){_(e)})}else s("Assignment is made. No pre work actions found. ")}else{var I=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=I&&void 0!=I.assignmentAcceptance){var N={id:_lclx.SUBSCRIPTIONS.userId,name:_lclx.SUBSCRIPTIONS.username};if("string"==typeof I.assignmentAcceptance){var b=I.assignmentAcceptance;dao.getConfig(b).then(function(e){I.assignmentAcceptance=e,actionsModule.notification.acceptanceNotification(I,a,n,r).then(function(e){s("Notifications request submitted for acceptance.")}).catch(function(e){s("Notifications failed"),console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}).catch(function(e){s(e)})}else actionsModule.notification.acceptanceNotification(I,a,n,r).then(function(e){s("Notifications request submitted for acceptance.")}).catch(function(e){s("Notifications failed"),console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}else s("Notifications not found")}}else if(1==o.length){var k=o[0].id,w=o[0].name;void 0==i.assignmentHistory&&(i.assignmentHistory=[]);var v=i.assignedTo;if(""!=v.userId&&""!=v.name){var S=JSON.parse(JSON.stringify(v));i.assignmentHistory.push(S)}v.name=w+"",v.userId=k+"",v.dateTime=moment().format(),v.type=ASSIGNMENT_TYPE_AUTO,v.dueDateTime="",v.by=_lclx.SUBSCRIPTIONS.userId+"";var y="";if(void 0!=t.assign.assignment){var y=i.assignment,P={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};y.accept=P,y.message=_getNameByLang(t.assign.assignment.message.i18n);var _={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};y.reject=_;var O={profileId:u,roleId:r,type:"role"};y.value=O,y.profileRoleId=d}var I=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=I&&void 0!=I.assignment){var N={id:k,name:w};if("string"==typeof I.assignment){var b=I.assignment;dao.getConfig(b).then(function(e){I.assignment=e,actionsModule.notification.assignmentNotification(I,a,n,N).then(function(e){console.log('User assigned successfully. UserId: "'+N.id+'", Name: "'+N.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}).catch(function(e){s(e)})}else actionsModule.notification.assignmentNotification(I,a,n,N).then(function(e){console.log('User assigned successfully. UserId: "'+N.id+'", Name: "'+N.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}var T=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+n+"']/id",a,{})[0],x=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+n+"']/id",a,{})[0],q=JSON.xpath("/subprocesses[_id eq '"+n+"']/step/id",a,{})[0];JSON.xpath("/processes[_id eq '"+T+"']/subProcesses[_id eq '"+x+"']/steps[_id eq '"+q+"']",a.config,{})[0];if(void 0!=t.preWorkActions){var U=t.preWorkActions;preWorkActions(U,a).then(function(e){s("Assigned to the only user in role. Pre work actions executed")},function(e){_(e)})}else s("Assigned to the only user in role. No pre work actions found.")}else{var v=i.assignedTo;v.name="",v.userId="";var y="";if(void 0!=t.assign.assignment){var y=i.assignment,P={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};y.accept=P,y.message=_getNameByLang(t.assign.assignment.message.i18n);var _={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};y.reject=_;var O={profileId:u,roleId:r,type:"role"};y.value=O,y.profileRoleId=d}s("No users found in list. Assigning blank ")}else _(err)},function(e){o(e)})};void 0!=t.assign.role.profile?("current"==t.assign.role.profile?d=a.profile:"community"==t.assign.role.profile&&(d=app.SCOPE.getCommunityId()),l()):void 0!=t.assign.role.profileId&&helper.getNodeValue(t.assign.role.profileId,a,n).then(function(e){d=e,p()}).catch(function(e){o(e)})}else if(void 0!=t.assign.user)helper.getNodeValue(t.assign.user.userName,a,n).then(function(r){helper.getNodeValue(t.assign.user.userId,a,n).then(function(o){var o=o,u=r,p=a.profile;void 0==i.assignmentHistory&&(i.assignmentHistory=[]);var l=i.assignedTo;if(""!=l.userId&&""!=l.name){var f=JSON.parse(JSON.stringify(l));i.assignmentHistory.push(f)}l.name=u+"",l.userId=o+"",l.dateTime=moment().format(),l.type=ASSIGNMENT_TYPE_AUTO,l.dueDateTime="",l.by=_lclx.SUBSCRIPTIONS.userId+"";var m="";if(void 0!=t.assign.assignment){var m=i.assignment,h={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};m.accept=h,m.message=_getNameByLang(t.assign.assignment.message.i18n);var g={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)},v={id:o,name:r};c.push(v),m.reject=g;var S={profileId:p,userId:c,type:"user"};m.value=S,m.profileRoleId=d}var I=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=I&&void 0!=I.assignment){var N={id:o,name:u};if("string"==typeof I.assignment){var b=I.assignment;dao.getConfig(b).then(function(e){I.assignment=e,actionsModule.notification.assignmentNotification(I,a,n,N).then(function(e){console.log('User assigned successfully. UserId: "'+N.id+'", Name: "'+N.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}).catch(function(e){s(e)})}else actionsModule.notification.assignmentNotification(I,a,n,N).then(function(e){console.log('User assigned successfully. UserId: "'+N.id+'", Name: "'+N.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}var y=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+n+"']/id",a,{})[0],P=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+n+"']/id",a,{})[0],_=JSON.xpath("/subprocesses[_id eq '"+n+"']/step/id",a,{})[0];JSON.xpath("/processes[_id eq '"+y+"']/subProcesses[_id eq '"+P+"']/steps[_id eq '"+_+"']",a.config,{})[0];if(void 0!=t.preWorkActions){var O=t.preWorkActions;preWorkActions(O,a).then(function(e){s("Assigned to the only user in role. Pre work actions executed")},function(e){g(e)})}else s("Assigned to the only user in role. No pre work actions found.")},function(e){o(e)})},function(e){o(e)});else if(void 0!=t.assign.swimlane){var f=t.assign.swimlane.stepId,m=t.assign.swimlane.sequence,h=JSON.xpath("/subprocesses[_id eq '"+n+"']",a,{})[0],g=JSON.xpath("/history[id eq '"+f+"']",h,{}),v="";v="last"==m?JSON.xpath("max(for $s in /* return xs:dateTime($s/dateTimeCreated))",g,{})[0]:JSON.xpath("min(for $s in /* return xs:dateTime($s/dateTimeCreated))",g,{})[0];var S=JSON.xpath("/*[xs:dateTime(dateTimeCreated) eq xs:dateTime('"+v+"')]",g,{})[0],I=JSON.xpath("/assignmentHistory[last()]",S,{})[0],N=I.userId,b=I.name;void 0==i.assignmentHistory&&(i.assignmentHistory=[]);var y=i.assignedTo;if(""!=y.userId&&""!=y.name){var P=JSON.parse(JSON.stringify(y));i.assignmentHistory.push(P)}y.name=b+"",y.userId=N+"",y.dateTime=moment().format(),y.type=ASSIGNMENT_TYPE_SWIMLANE,y.dueDateTime="",y.by=_lclx.SUBSCRIPTIONS.userId+"";var _=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=_&&void 0!=_.assignment){var O={id:N,name:b};if("string"==typeof _.assignment){var T=_.assignment;dao.getConfig(T).then(function(e){_.assignment=e,actionsModule.notification.assignmentNotification(_,a,n,O).then(function(e){console.log('User assigned successfully. UserId: "'+O.id+'", Name: "'+O.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+O.id+'", Name: "'+O.name+'"')})}).catch(function(e){s(e)})}else actionsModule.notification.assignmentNotification(_,a,n,O).then(function(e){console.log('User assigned successfully. UserId: "'+O.id+'", Name: "'+O.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+O.id+'", Name: "'+O.name+'"')})}var x=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+n+"']/id",a,{})[0],q=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+n+"']/id",a,{})[0],f=JSON.xpath("/subprocesses[_id eq '"+n+"']/step/id",a,{})[0];JSON.xpath("/processes[_id eq '"+x+"']/subProcesses[_id eq '"+q+"']/steps[_id eq '"+f+"']",a.config,{})[0];if(void 0!=t.preWorkActions){var U=t.preWorkActions;preWorkActions(U,a).then(function(e){s("Assigned to the only user in role. Pre work actions executed")},function(e){o(e)})}else s("Assigned to the only user in role. No pre work actions found.")}},function(e){o(e)})})}function server(e,s,t,n,i,o,a,r,c,u){return new Promise(function(d,p){var l=(r.profile,e.serverAction[0]);void 0==a.assignmentHistory&&(a.assignmentHistory=[]);var f=a.assignedTo;if(""!=f.userId&&""!=f.name){var m=JSON.parse(JSON.stringify(f));a.assignmentHistory.push(m)}f.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,f.userId=_lclx.SUBSCRIPTIONS.userId+"",f.dateTime=moment().format(),f.type=ASSIGNMENT_TYPE_AUTO,f.dueDateTime="",f.by=_lclx.SUBSCRIPTIONS.userId+"",action(l,s,t,n,i,o,a,r,c,u).then(function(e){d("No users found in list. Assigning blank ")},function(e){p("Server action error found rejected")})})}function transition(e,s,t,n,i,o,a,r,c,u){return new Promise(function(d,p){try{for(var l=0,f="",m=0,h=r.config.processes.filter(function(s){if(s._id==e)return s}),g=h[0].subProcesses.filter(function(e){if(e._id==t)return e}),v=g[0].steps.filter(function(e){if(e._id==i)return e}),S=v[0].transition.filter(function(e){if(e._id==o)return e}),I=0;I<g[0].steps.length;I++)g[0].steps[I]._id==i&&(l=parseInt(g[0].steps[I]._seq));g[0].steps.filter(function(e){m=l+1,parseInt(e._seq)==m&&(f=e._id)});var N=g[0].steps.length,b=JSON.xpath("/subprocesses[_id eq '"+c+"']",r,{})[0],y=JSON.xpath("/subprocesses[_id eq '"+c+"']/step",r,{})[0];void 0==b.history&&(b.history=[]);var P=function(e){var s=JSON.xpath("/subprocesses[_id eq '"+c+"']/indicators",r,{}),t=!1;void 0!=s&&0!=s.length||(t=!0,s=JSON.xpath("/indicators[workflows/processes[subProcessUUID eq '"+c+"']]",r,{})),void 0==e.indicators&&(e.indicators=[]);for(var n=0;n<s.length;n++)if(t){var i=s[n]._id,o=JSON.xpath("/indicators[_id eq '"+i+"']/_rev",r,{})[0],a=s[n].model.pending.seq,u=s[n].model.pending.status,d={uuid:i,rev:o,seq:a,status:u};e.indicators.push(d)}else{var i=s[n].instances[0].uuid,o=JSON.xpath("/indicators[_id eq '"+i+"']/_rev",r,{})[0],a=JSON.xpath("/indicators[_id eq '"+i+"']/model/pending/seq",r,{})[0],u=JSON.xpath("/indicators[_id eq '"+i+"']/model/pending/status",r,{})[0],d={uuid:i,rev:o,seq:a,status:u};e.indicators.push(d)}return delete e.assignedTo,delete e.assignment,e},_={transitionId:S[0]._id,dateTime:moment().format(),userId:_lclx.SUBSCRIPTIONS.userId+""};if(void 0!=u&&Object.keys(u).length>0?u.transition=_:y.transition=_,void 0!=u&&Object.keys(u).length>0){void 0==u.assignmentHistory&&(u.assignmentHistory=[]);var O=JSON.parse(JSON.stringify(u.assignedTo));""!=O.userId&&""!=O.name&&u.assignmentHistory.push(O)}else{void 0==y.assignmentHistory&&(y.assignmentHistory=[]);var O=JSON.parse(JSON.stringify(y.assignedTo));""!=O.userId&&""!=O.name&&y.assignmentHistory.push(O)}var T;T=void 0!=u&&Object.keys(u).length>0?JSON.parse(JSON.stringify(u)):JSON.parse(JSON.stringify(y));var x=P(T);if(b.history.push(x),void 0!=S[0].transitionAction.goToStep){var q=parseInt(v[0]._seq)+parseInt(S[0].transitionAction.goToStep.default),U="";g[0].steps.filter(function(e){parseInt(e._seq)==m&&(U=e._id)}),step(e,s,t,n,U,q,a,r,c).then(function(e){if(q==N){var s=util.success("All Step transitions have completed successfully.",{subProcessComplete:!0,step:e.data});d(s)}else{var s=util.success("Step transition completed successfully.",{subProcessComplete:!1,step:e.data});d(s)}},function(e){p(e)})}else if(void 0!=S[0].transitionAction.goToStepId){var k=S[0].transitionAction.goToStepId.stepId,w=1;g[0].steps.filter(function(e){e._id==k&&(w=parseInt(e._seq))}),step(e,s,t,n,k,w,a,r,c).then(function(e){if(w==N||"Complete"==e.data.status){var s=util.success("All Step transitions have completed successfully.",{subProcessComplete:!0,step:e.data});d(s)}else{var s=util.success("Step transition completed successfully.",{subProcessComplete:!1,step:e.data});d(s)}},function(e){p(e)})}else if(void 0!=S[0].transitionAction.stop){b.messages=[];var A=h[0].postActions;postActions(A,r,c).then(function(e){var s=util.success("Step transition completed successfully.Workflow stopped.",{subProcessComplete:!0,step:u});d(s)},function(e){p(e)})}}catch(e){p(e)}})}function postActions(e,s,t){return new Promise(function(n,i){var o=[];try{var a=JSON.xpath("/subprocesses[_id eq '"+t+"']",s,{})[0],r=a["meta-data"].processConfigId,c=a["meta-data"].subProcessConfigId,u=a["meta-data"].subProcessInsSeq,d=a["meta-data"].subProcessInsSeq,p=JSON.xpath("/config/processes[_id eq '"+r+"']/subProcesses[_id eq '"+c+"']",s,{})[0],l=JSON.xpath("/subprocesses[_id eq '"+t+"']/step",s,{})[0];util.syncLoop(e.length,function(n){var a=n.iteration();action(e[a],r,u,c,d,p,l,s,{},t).then(function(e){o.push(!0),n.next()},function(e){o.push(!1),n.break(),i(e)})},function(){if(o.every(Boolean)){var e=util.success("Post-actions completed successfully.",{});n(e)}else{var s=util.error("WFPreActionsError","Not all post-actions passed.");i(s)}})}catch(e){i(e)}})}function processWorkflowMessage(e,s){var t=e;if(t.indexOf("#INSTANCE_LABEL")!==-1){var n=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+s+"']/label",app.SCOPE.workflow,{})[0];t=t.replace("#INSTANCE_LABEL",n)}if(t.indexOf("#USER_NAME")!==-1){var n=JSON.xpath("/subprocesses[_id eq '"+s+"']/step/assignedTo/name",app.SCOPE.workflow,{})[0];t=t.replace("#USER_NAME",n)}if(t.indexOf("#PROFILE_TITLE")!==-1){var n=app.profile.title;t=t.replace("#PROFILE_TITLE",n)}if(t.indexOf("#PROFILE_TYPE")!==-1){var n=app.SCOPE.APP_CONFIG.name;t=t.replace("#PROFILE_TYPE",n)}if(t.indexOf("#VAR_SPUUID")!==-1){var n=s;t=t.replace("#VAR_SPUUID",n)}return t}function _getName(e,s){if(void 0!==e)for(var t=0;t<e.length;t++)if(e[t]._lang===s)return e[t].value}function _getNameByLang(e){return library.getNameByLang(e)}function preWorkActions(e,s){return new Promise(function(t,n){var i=[];try{var o=JSON.xpath("/config/processes[_id eq '"+app.SCOPE.spo.pObject.id+"']/subProcesses[_id eq '"+app.SCOPE.spo.spObject.id+"']",s,{})[0],a=JSON.xpath("/subprocesses[_id eq '"+app.SCOPE.processUUID+"']/step",s,{})[0];util.syncLoop(e.length,function(t){var r=t.iteration();action(e[r],app.SCOPE.spo.pObject.id,app.SCOPE.spo.pObject.seq,app.SCOPE.spo.spObject.id,app.SCOPE.spo.spObject.seq,o,a,s,{},app.SCOPE.processUUID).then(function(e){i.push(!0),t.next()},function(e){i.push(!1),t.break(),n(e)})},function(){if(i.every(Boolean)){var e=util.success("PreWork-actions completed successfully.",{});t(e)}else{var s=util.error("WFPreActionsError","Not all pre-work-actions passed.");n(s)}})}catch(e){n(e)}})}var util=require("utility"),actionsModule=require("./actions"),helper=require("./helper"),form=require("./form");module.exports={preRequisites:preRequisites,preActions:preActions,postActions:postActions,preWorkActions:preWorkActions,subProcess:subProcess,indicatorDocs:indicatorDocs,task:task,transition:transition,assignUser:assignUser};

},{"./actions":2,"./form":3,"./helper":4,"utility":8}],8:[function(require,module,exports){
"use strict";function success(r,e){return{message:r,data:e}}function warn(r,e){return console.warn(e),{warning:r,data:e}}function error(r,e){var n=new Error("");return n.name=r,n.message=e,n}function syncLoop(r,e,n){var a=0,t=!1,o=!1,u={next:function(){return t&&o&&n?n():void(a<r?(a++,e(u)):(t=!0,n&&n()))},iteration:function(){return a-1},break:function(r){t=!0,o=r}};return u.next(),u}function compare(r,e,n){switch(e){case"greaterThan":return r>n;case"lessThan":return r<n;case"greaterThanEqual":return r>=n;case"lessThanEqual":return r<=n;case"equalTo":return r===n;case"notEqualTo":return r!==n}}function getName(r,e){if(void 0!==r)for(var n=0;n<r.length;n++)if(r[n].i18n._lang===e)return r[n].i18n.value}module.exports={success:success,warn:warn,error:error,syncLoop:syncLoop,compare:compare,getName:getName};

},{}]},{},[1])(1)
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJpbmRleC5qcyIsImxpYi9hY3Rpb25zLmpzIiwibGliL2Zvcm0uanMiLCJsaWIvaGVscGVyLmpzIiwibGliL2ludGVyZmFjZS5qcyIsImxpYi9ub2RlVmFsdWUuanMiLCJsaWIvcHJvY2Vzcy5qcyIsIm5vZGVfbW9kdWxlcy91dGlsaXR5L2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUEsWUE4Q0EsU0FBUyxVQUFTLEVBQVMsRUFBYSxFQUFLLEdBQ3pDLEdBQUksR0FBUSxJQUdaLElBQW1CLElBQWYsR0FBb0MsUUFBZixFQUNyQixLQUFNLE1BQUssTUFBTSxnQkFBaUIsOEJBQy9CLElBQTRCLGdCQUFsQixHQUNiLEtBQU0sSUFBSSxPQUFNLGdEQU1wQixJQUpJLEVBQU0sWUFBYyxHQUFlLEdBSXhCLElBQVgsR0FBNEIsUUFBWCxFQUNqQixLQUFNLE1BQUssTUFBTSxnQkFBaUIsNEJBQy9CLElBQXdCLGdCQUFkLEdBQ2IsS0FBTSxJQUFJLE9BQU0sOENBTXBCLElBSkksRUFBTSxRQUFVLEdBQVcsR0FJcEIsSUFBUCxHQUFvQixRQUFQLEVBQ2IsS0FBTSxNQUFLLE1BQU0sZ0JBQWlCLHlCQUMvQixJQUFvQixnQkFBVixHQUNiLEtBQU0sSUFBSSxPQUFNLDBDQU1wQixJQUpJLEVBQU0sSUFBTSxHQUFPLEdBSVQsSUFBVixHQUEwQixRQUFWLEVBQ2hCLEtBQU0sTUFBSyxNQUFNLGdCQUFpQix3Q0FDUixpQkFBYixHQUNiLEVBQU0sT0FBUyxLQUFLLE1BQU0sR0FFMUIsRUFBTSxPQUFTLEVBSW5CLEVBQU0sU0FFTixFQUFNLGdCQUVOLEVBQU0sY0F4RlYsR0FBSSxTQUFVLFFBQVEsaUJBQ2xCLEtBQU8sUUFBUSxXQUNmLGNBQWdCLFFBQVEsbUJBQ3hCLE9BQVMsUUFBUSxlQWtHckIsVUFBUyxVQUFVLFdBQWEsV0FDNUIsTUFBTyxNQUFLLFNBV2hCLFNBQVMsVUFB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LCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIndXNlIHN0cmljdCc7XG5cbnZhciBQcm9jZXNzID0gcmVxdWlyZSgnLi9saWIvcHJvY2VzcycpO1xudmFyIHV0aWwgPSByZXF1aXJlKCd1dGlsaXR5Jyk7XG52YXIgdXNlckludGVyZmFjZSA9IHJlcXVpcmUoJy4vbGliL2ludGVyZmFjZScpO1xudmFyIGhlbHBlciA9IHJlcXVpcmUoJy4vbGliL2hlbHBlcicpO1xuXG5cbi8qZ2xvYmFscyAqL1xuXG4vKipcbiAqIEEgbmV3IFdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlIGNvbnRhaW5zIHRoZSByZWZlcmVuY2UgdG8gdGhlIGFwcGxpY2F0aW9uXG4gKiBhbmQgYXNzb2NpYXRlZCBwcm9maWxlIHdoaWNoIGl0IHJlcXVpcmVzIGFzIHRoZSBmaXJzdCB0d28gcGFyYW1ldGVycy4gSXQgYWxzb1xuICogcmVxdWlyZXMgYSB3b3JrZmxvdyBjb25maWd1cmF0aW9uLCBhcyB0aGUgdGhpcmQgcGFyYW1ldGVyLCB3aGljaCBpcyB1c2VkIHRvXG4gKiBkZXNjaWJlIHRoZSB3b3JrZmxvdyBwcm9jZXNzZXMuIElmIGEgd29ya2Zsb3cgaW5zdGFuY2UgZXhpc3RzIHlvdSBjYW4gcGFzcyBpdFxuICogaW4gYXMgdGhlIGZvdXJ0aCBwYXJhbWV0ZXIgd2hpY2ggaXQgd2lsbCB0aGVuIHVzZSwgZWxzZSBjcmVhdGUgYSBuZXcgb25lLlxuICpcbiAqIEBjb25zdHJ1Y3RvclxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9maWxlIC0gVGhlIGN1cnJlbnQgcHJvZmlsZSBpZFxuICogQHBhcmFtIHtzdHJpbmd9IGFwcCAtIFRoZSBhc3NvY2lhdGVkIGFwcGxpY2F0aW9uIGlkXG4gKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIC0gVGhlIGFwcGxpY2F0aW9uIHdvcmtmbG93IGNvbmZpZ3VyYXRpb24gLyBkZWZpbml0aW9uXG4gKiBAcGFyYW0ge09iamVjdH0gW2luc3RhbmNlXSAtIEFuIGV4aXN0aW5nIGFwcGxpY2F0aW9uIHByb2ZpbGUgd29ya2Zsb3cgaW5zdGFuY2UgYmFzZWRcbiAqIG9uIHRoZSBkZWZpbml0aW9uXG4gKlxuICogQGF1dGhvciBCcmVudCBHb3Jkb25cbiAqIEB2ZXJzaW9uIDAuMS4wXG4gKlxuICogQGV4YW1wbGVcbiAqIHZhciBjb25maWcgPSB7ICdfaWQnOiAnYWJjMTIzJyB9O1xuXG4gKiB2YXIgaW5zdGFuY2UgPSB7ICdfaWQnOiAnaW5zdGFuY2VfYWJjMTIzJyB9O1xuXG4gKiAvLyBJZiB0aGVyZSBpc24ndCBhbiBleGlzdGluZyBpbnN0YW5jZVxuICogdmFyIHdvcmtmbG93ID0gbmV3IFdvcmtmbG93KCcxMjM0JywgJzU2NzgnLCBjb25maWcpO1xuICogLy8gSWYgdGhlcmUgaXMgYW4gZXhpc3RpbmcgaW5zdGFuY2VcbiAqIHZhciB3b3JrZmxvdyA9IG5ldyBXb3JrZmxvdygnMTIzNCcsICc1Njc4JywgY29uZmlnLCBpbnN0YW5jZSk7XG4gKlxuICogQHJldHVybiB7T2JqZWN0fSBuZXcgV29ya2Zsb3cgb2JqZWN0XG4gKlxuICogQHRocm93cyBFcnJvcjogQSBwcm9maWxlIGlkIGlzIHJlcXVpcmVkXG4gKiBAdGhyb3dzIEVycm9yOiBBbiBhcHAgaWQgaXMgcmVxdWlyZWRcbiAqIEB0aHJvd3MgRXJyb3I6IEEgd29ya2Zsb3cgY29uZmlndXJhdGlvbiBpcyByZXF1aXJlZFxuICpcbiAqL1xuXG5mdW5jdGlvbiBXb3JrZmxvdyhwcm9maWxlLCBjb21tdW5pdHlJZCwgYXBwLCBjb25maWcpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgLy8gQ29tbXVuaXR5IElEIHZhbGlkYXRpb24gY2hlY2tzXG4gICAgaWYgKGNvbW11bml0eUlkID09ICcnIHx8IGNvbW11bml0eUlkID09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyB1dGlsLmVycm9yKCdQYXJhbVJlcXVpcmVkJywgJ0EgY29tbXVuaXR5IGlkIGlzIHJlcXVpcmVkLicpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mKGNvbW11bml0eUlkKSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgY29tbXVuaXR5IGlkIG11c3QgYmUgYSBqYXZhc2NyaXB0IHN0cmluZy4nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBfdGhpcy5jb21tdW5pdHlJZCA9IGNvbW11bml0eUlkIHx8ICcnO1xuICAgIH1cblxuICAgIC8vIFByb2ZpbGUgSUQgdmFsaWRhdGlvbiBjaGVja3NcbiAgICBpZiAocHJvZmlsZSA9PSAnJyB8fCBwcm9maWxlID09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyB1dGlsLmVycm9yKCdQYXJhbVJlcXVpcmVkJywgJ0EgcHJvZmlsZSBpZCBpcyByZXF1aXJlZC4nKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZihwcm9maWxlKSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgcHJvZmlsZSBpZCBtdXN0IGJlIGEgamF2YXNjcmlwdCBzdHJpbmcuJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgX3RoaXMucHJvZmlsZSA9IHByb2ZpbGUgfHwgJyc7XG4gICAgfVxuXG4gICAgLy8gQXBwIElEIHZhbGlkYXRpb24gY2hlY2tzXG4gICAgaWYgKGFwcCA9PSAnJyB8fCBhcHAgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IHV0aWwuZXJyb3IoJ1BhcmFtUmVxdWlyZWQnLCAnQW4gYXBwIGlkIGlzIHJlcXVpcmVkLicpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mKGFwcCkgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIGFwcCBpZCBtdXN0IGJlIGEgamF2YXNjcmlwdCBzdHJpbmcuJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgX3RoaXMuYXBwID0gYXBwIHx8ICcnO1xuICAgIH1cblxuICAgIC8vIFdvcmtmbG93IGNvbmZpZ3VyYXRpb24gdmFsaWRhdGlvbiBjaGVja3NcbiAgICBpZiAoY29uZmlnID09ICcnIHx8IGNvbmZpZyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgdXRpbC5lcnJvcignUGFyYW1SZXF1aXJlZCcsICdBIHdvcmtmbG93IGNvbmZpZ3VyYXRpb24gaXMgcmVxdWlyZWQuJyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YoY29uZmlnKSAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgX3RoaXMuY29uZmlnID0gSlNPTi5wYXJzZShjb25maWcpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIF90aGlzLmNvbmZpZyA9IGNvbmZpZztcbiAgICB9XG5cbiAgICAvLyBXb3JrZmxvdyBpbnN0YW5jZSB2YWxpZGF0aW9uIGNoZWNrc1xuICAgIF90aGlzLmluc3RhbmNlO1xuICAgIC8vIFdvcmtmbG93IHN1Yi1wcm9jZXNzZXMgdmFsaWRhdGlvbiBjaGVja3NcbiAgICBfdGhpcy5zdWJwcm9jZXNzZXMgPSBbXTtcbiAgICAvLyBXb3JrZmxvdyBpbmRpY2F0b3JzIHBsYWNlIGhvbGRlclxuICAgIF90aGlzLmluZGljYXRvcnMgPSBbXTtcblxuXG59XG5cbi8qKlxuICogV29ya2Zsb3cgZ2V0IHByb2ZpbGUgaWQuXG4gKlxuICogQGV4YW1wbGUgXCJcIlxuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLmdldFByb2ZpbGUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9maWxlO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyBnZXQgYXBwIGlkLlxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5nZXRBcHAgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5hcHA7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IGdldCBjb25maWcuXG4gKlxuICogQGV4YW1wbGUgXCJcIlxuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLmdldENvbmZpZyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmNvbmZpZztcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgZ2V0IGluc3RhbmNlLlxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cblxuV29ya2Zsb3cucHJvdG90eXBlLmdldEluc3RhbmNlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IHNldCB0aGUgaW5zdGFuY2UgZGF0YS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gZGF0YSAtIHRoZSB3b3JrZmxvdyBwcm9jZXNzIGluc3RhbmNlIGRhdGFcbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuc2V0SW5zdGFuY2UgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgdGhpcy5pbnN0YW5jZSA9IGRhdGE7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IGdldCBzdWItcHJvY2Vzc2VzIGRhdGEuXG4gKlxuICogQGV4YW1wbGUgXCJcIlxuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLmdldFN1YlByb2Nlc3NlcyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnN1YnByb2Nlc3Nlcztcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgc2V0IHRoZSBzdWItcHJvY2Vzc2VzIGRhdGEuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGRhdGEgLSB0aGUgd29ya2Zsb3cgcHJvY2VzcyBpbnN0YW5jZSBkYXRhXG4gKlxuICogQGV4YW1wbGUgXCJcIlxuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLnNldFN1YlByb2Nlc3NlcyA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICB0aGlzLnN1YnByb2Nlc3NlcyA9IGRhdGE7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IGdldCBpbmRpY2F0b3Igc2V0IGRhdGEuXG4gKlxuICogQGV4YW1wbGUgXCJcIlxuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLmdldEluZGljYXRvcnMgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5pbmRpY2F0b3JzO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyBzZXQgdGhlIGluZGljYXRvciBzZXQgZGF0YS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gZGF0YSAtIHRoZSB3b3JrZmxvdyBwcm9jZXNzIGluc3RhbmNlIGRhdGFcbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuc2V0SW5kaWNhdG9ycyA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICB0aGlzLmluZGljYXRvcnMgPSBkYXRhO1xufTtcblxuLyoqXG4gKiBTZXQgdGhlIHZhcmlhYmxlIHZhbHVlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBwcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gcHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBwcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN1YlByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN1Yi1wcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gc3ViUHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBzdWItcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGVwSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdGVwIGlkXG4gKiBAcGFyYW0ge09iamVjdH0gdmFyaWFibGUgLSB0aGUgV29ya2Zsb3cgdmFyaWFibGUgb2JqZWN0XG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG4vLyBXb3JrZmxvdy5wcm90b3R5cGUuc2V0VmFyaWFibGUgPSBmdW5jdGlvbihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCB2YXJpYWJsZSl7XG4vLyBcdHZhciBfdGhpcyA9IHRoaXM7XG4vLyBcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbi8vIFx0XHR0cnkge1xuLy8gXHRcdFx0UHJvY2Vzcy5nZXRWYXJpYWJsZShwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCB2YXJpYWJsZSkudGhlbihmdW5jaW9uKHJlc3VsdCl7XG4vLyBcdFx0XHRcdHJlc29sdmUocmVzdWx0LmRhdGEpO1xuLy8gXHRcdFx0fSwgZnVuY3Rpb24oZXJyKXtcbi8vIFx0XHRcdFx0cmVqZWN0KGVycik7XG4vLyBcdFx0XHR9KVxuLy8gXHRcdH0gY2F0Y2ggKGVycikge1xuLy8gXHRcdFx0cmVqZWN0KGVycik7XG4vLyBcdFx0fVxuXG4vLyBcdH0pO1xuLy8gfTtcblxuLyoqXG4gKiBHZXQgdGhlIHZhcmlhYmxlIHZhbHVlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBwcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gcHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBwcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN1YlByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN1Yi1wcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gc3ViUHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBzdWItcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGVwSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdGVwIGlkXG4gKiBAcGFyYW0ge3N0cmluZ30ga2V5IC0gdGhlIFdvcmtmbG93IHZhcmlhYmxlIGlkXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG4vLyBXb3JrZmxvdy5wcm90b3R5cGUuZ2V0VmFyaWFibGUgPSBmdW5jdGlvbihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCBrZXkpe1xuLy8gXHR2YXIgX3RoaXMgPSB0aGlzO1xuLy8gXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4vLyBcdFx0dHJ5IHtcbi8vIFx0XHRcdFByb2Nlc3Muc2V0VmFyaWFibGUocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwga2V5KS50aGVuKGZ1bmNpb24ocmVzdWx0KXtcbi8vIFx0XHRcdFx0cmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4vLyBcdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuLy8gXHRcdFx0XHRyZWplY3QoZXJyKTtcbi8vIFx0XHRcdH0pXG4vLyBcdFx0fSBjYXRjaCAoZXJyKSB7XG4vLyBcdFx0XHRyZWplY3QoZXJyKTtcbi8vIFx0XHR9XG5cbi8vIFx0fSk7XG4vLyB9O1xuXG4vKipcbiAqIFRoaXMgbWV0aG9kIGNyZWF0ZXMgYSBuZXcgd29ya2Zsb3cgcHJvY2VzcyBpLmUuIGl0IGNyZWF0ZXMgYSB3b3JrZmxvdyBwcm9jZXNzZXMgaW5zdGFuY2VcbiAqIG9iamVjdCB3aXRoIHRoZSBtaW5pbXVtIHJlcXVpcmVkIGRhdGEuIFRoaXMgaW5zdGFuY2UgY2FuIGJlIHJlZmVyZW5jZWQgaW4gdGhlIGZvbGxvd2luZ1xuICogd2F5LCBzZWUgZXhhbXBsZSBiZWxvdy5cbiAqXG4gKiBAZXhhbXBsZVxuICogdmFyIGNvbmZpZyA9IHsgJ19pZCc6ICdhYmMxMjMnIH07XG5cbiAqIHZhciB3b3JrZmxvdyA9IG5ldyBXb3JrZmxvdygnMTIzNCcsICc1Njc4JywgY29uZmlnKTtcbiAqIHdvcmtmbG93LmNyZWF0ZSgpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcbiAqXHRjb25zb2xlLmxvZyhyZXN1bHQubWVzc2FnZSk7XG4gKlx0Ly8gVGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzIGNhbiBub3cgYmUgYWNjZXNzZWRcbiAqIFx0dmFyIHByb2ZpbGUgPSB3b3JrZmxvdy5wcm9maWxlO1xuICogXHR2YXIgYXBwID0gd29ya2Zsb3cuYXBwO1xuICogXHR2YXIgY29uZmlnID0gd29ya2Zsb3cuY29uZmlnO1xuICpcdC8vIE9uIHN1Y2Nlc3MgeW91IGNhbiBhY2Nlc3MgdGhlIGluc3RhbmNlIHRoZSBmb2xsb3dpbmcgd2F5XG4gKlx0dmFyIGluc3RhbmNlID0gd29ya2Zsb3cuaW5zdGFuY2U7XG4gKiB9LCBmdW5jdGlvbihlcnJvcil7XG4gKlx0Y29uc29sZS5sb2coZXJyb3IpO1xuICogfSk7XG4gKlxuICogQHJldHVybiB7T2JqZWN0fSBuZXcgV29ya2Zsb3cgaW5zdGFuY2Ugd2l0aCB1cGRhdGVkIGluc3RhbmNlIGRhdGEuXG4gKlxuICovXG5cbldvcmtmbG93LnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChfdGhpcy5pbnN0YW5jZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdmFyIHdhcm4gPSB1dGlsLndhcm4oJ0luc3RhbmNlIGFscmVhZHkgZXhpc3RzLicsIF90aGlzKVxuICAgICAgICAgICAgICAgIHJlc29sdmUod2Fybik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgd29ya2Zsb3cgcHJvY2Vzc2VzIGluc3RhbmNlIG9iamVjdFxuICAgICAgICAgICAgICAgIHZhciBtb2RlbCA9IHtcbiAgICAgICAgICAgICAgICAgICAgX2lkOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogJycsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICd3b3JrZmxvd0luc3RhbmNlJyxcbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc2VzOiBbXSxcbiAgICAgICAgICAgICAgICAgICAgY2hhbm5lbHM6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVfXCIgKyBhcHAuU0NPUEUucHJvZmlsZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbl9cIiArIGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSArIFwiX2FwcGxpY2F0aW9uX1wiICsgYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWRcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBtb2RlbC5faWQgPSBcIl9sb2NhbC9cIiArIF90aGlzLnByb2ZpbGUgKyAnOnByb2Nlc3Nlcyc7XG4gICAgICAgICAgICAgICAgLy9tb2RlbC5faWQgPSBfdGhpcy5wcm9maWxlICsgJzpwcm9jZXNzZXMnO1xuXG4gICAgICAgICAgICAgICAgbW9kZWwudmVyc2lvbiA9IF90aGlzLmNvbmZpZy52ZXJzaW9uO1xuICAgICAgICAgICAgICAgIF90aGlzLmluc3RhbmNlID0gbW9kZWw7XG4gICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtmbG93IHByb2Nlc3NlcyBpbnN0YW5jZSBjcmVhdGVkIHN1Y2Nlc3NmdWxseS4nLCBfdGhpcyk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyBpbml0aWFsaXNlLCB0aGlzIGZ1bmN0aW9uIGV4ZWN1dGVzIGEgcHJvY2VzcyB3aXRoaW4gYSB3b3JrZmxvd1xuICogY29uZmlndXJhdGlvbi5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIHByb2Nlc3MgaWQgdG8gcHJvY2Vzc1xuICogQHBhcmFtIHtvYmplY3R9IFtkYXRhXSAtIHRoZSBpbnB1dCBkYXRhIHRvIHByb2Nlc3NcbiAqXG4gKiBAZXhhbXBsZVxuICogV29ya2Zsb3cuaW5pdGlhbGlzZSgncHJvY2Vzc0lkJywgeyB2YWxpZERhdGU6ICdkYXRlJyB9KTtcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5pbml0aWFsaXNlID0gZnVuY3Rpb24ocHJvY2Vzc0lkLCBkYXRhLCBzdWJwcm9maWxlSWQpIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBjb25maWdQcm9jZXNzID0gW107XG4gICAgICAgICAgICAvLyBDaGVjayB0aGUgcGFzc2VkIGluIHBhcmFtZXRlcnNcbiAgICAgICAgICAgIGlmIChwcm9jZXNzSWQgIT09ICcnICYmIHByb2Nlc3NJZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgLy8gR2V0IHRoZSBjdXJyZW50IHByb2Nlc3MgY29uZmlnXG4gICAgICAgICAgICAgICAgY29uZmlnUHJvY2VzcyA9IF90aGlzLmNvbmZpZy5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialByb2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9ialByb2Nlc3MuX2lkID09IHByb2Nlc3NJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9ialByb2Nlc3M7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChjb25maWdQcm9jZXNzWzBdLl9pZCA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZDb25maWdFcnJvcicsICdObyB2YWxpZCBwcm9jZXNzIGRlZmluaXRpb24gZm91bmQgd2l0aCBwcm9jZXNzIGlkOiAnICsgcHJvY2Vzc0lkKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uZmlnUHJvY2Vzcy5wdXNoKF90aGlzLmNvbmZpZy5wcm9jZXNzZXNbMF0pO1xuICAgICAgICAgICAgICAgIHByb2Nlc3NJZCA9IF90aGlzLmNvbmZpZy5wcm9jZXNzZXNbMF0uX2lkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgYnVpbGRQYXJhbSA9IGZ1bmN0aW9uKGFycmF5KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgaW5kTmFtZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgbCA9IDA7IGwgPCBhcnJheS5sZW5ndGggLSAxOyBsKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaW5kTmFtZSA9IGluZE5hbWUgKyBcIidcIiArIGFycmF5W2xdICsgXCInLFwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gJygnICsgaW5kTmFtZSArIFwiJ1wiICsgYXJyYXlbYXJyYXkubGVuZ3RoIC0gMV0gKyBcIicpXCJcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIHNwSWQgPSBjb25maWdQcm9jZXNzWzBdLnN1YlByb2Nlc3Nlc1swXS5faWQ7XG4gICAgICAgICAgICB2YXIgdG9DaGVja0FycmF5ID0gW107XG4gICAgICAgICAgICB2YXIgaW5zdGFuY2VUeXBlID0gY29uZmlnUHJvY2Vzc1swXS5zdWJQcm9jZXNzZXNbMF0uaW5zdGFuY2VUeXBlO1xuICAgICAgICAgICAgdmFyIHByb2Nlc3NJbmRpY2F0b3JzID0gSlNPTi54cGF0aChcImluZGljYXRvcnMvX2lkXCIsIGNvbmZpZ1Byb2Nlc3NbMF0uc3ViUHJvY2Vzc2VzWzBdLCB7fSk7XG5cbiAgICAgICAgICAgIHZhciBjYW5DcmVhdGVQcm9jZXNzID0gZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvL1NQOlRPRE8gRE9ORVxuICAgICAgICAgICAgICAgIHZhciBjb3VudFNpbmdsZUxpc3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbc2V0SWQgPSBcIiArIGJ1aWxkUGFyYW0oYXJyYXkpICsgXCIgYW5kIGNhcmRpbmFsaXR5IGVxICdzaW5nbGUnIF0vc2V0SWRcIiwgYXBwLlNDT1BFLkFQUF9DT05GSUcsIHt9KTtcbiAgICAgICAgICAgICAgICB2YXIgY291bnRTaW5nbGUgPSBjb3VudFNpbmdsZUxpc3QubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNvdW50U2luZ2xlID4gMCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbnZvbHZlZHByb2Nlc3NlcyA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpbmRpY2F0b3JzL19pZCA9IFwiKyBidWlsZFBhcmFtKGNvdW50U2luZ2xlTGlzdCkgK1wiXS9faWRcIiwgX3RoaXMuY29uZmlnLHt9KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gSlNPTi54cGF0aChcImNvdW50KC9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW2lkID0gXCIrIGJ1aWxkUGFyYW0oaW52b2x2ZWRwcm9jZXNzZXMpICtcIiBhbmQgY29tcGxldGUgPSBmYWxzZSgpXSlcIiwgX3RoaXMse30pWzBdO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGNvdW50ID09IDApXG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlVHlwZS5uZXdTZXF1ZW5jZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gSlNPTi54cGF0aChcImNvdW50KC9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW2lkIGVxICdcIisgc3BJZCArXCInIGFuZCBjb21wbGV0ZSBlcSAnZmFsc2UnXSlcIiwgX3RoaXMgLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKGNvdW50ID09IDApXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGluc3RhbmNlVHlwZS5uZXdJbnN0YW5jZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmIChjYW5DcmVhdGVQcm9jZXNzKHByb2Nlc3NJbmRpY2F0b3JzKSkge1xuXG4gICAgICAgICAgICAgICAgLy8gdmFyIHByb2Nlc3NTZXEgPSAxO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50UHJvY2VzcyA9IFtdO1xuICAgICAgICAgICAgICAgIF90aGlzLmluc3RhbmNlLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ocHJvY2Vzc0l0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2Nlc3NJdGVtLmlkID09IHByb2Nlc3NJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFByb2Nlc3MucHVzaChwcm9jZXNzSXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzU2VxID0gY3VycmVudFByb2Nlc3MubGVuZ3RoICsgMTtcbiAgICAgICAgICAgICAgICAvLyB2YXIgbmV4dFNlcSA9IHByb2Nlc3NTZXEgKyAxO1xuICAgICAgICAgICAgICAgIC8vIFB1c2ggdGhlIHByb2Nlc3Mgb2JqZWN0IGludG8gdGhlIGFycmF5XG4gICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NNb2RlbCA9IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICBzZXE6ICcnLFxuICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzZXM6IFtdXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gMS4gVXBkYXRlIHRoZSBwcm9jZXNzIGlkIGFuZCBzZXFcbiAgICAgICAgICAgICAgICBwcm9jZXNzTW9kZWwuaWQgPSBwcm9jZXNzSWQ7XG4gICAgICAgICAgICAgICAgcHJvY2Vzc01vZGVsLnNlcSA9IHByb2Nlc3NTZXE7XG4gICAgICAgICAgICAgICAgX3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzLnB1c2gocHJvY2Vzc01vZGVsKTtcbiAgICAgICAgICAgICAgICAvLyBQYXJhbWV0ZXJzXG4gICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NJZCA9IGNvbmZpZ1Byb2Nlc3NbMF0uc3ViUHJvY2Vzc2VzWzBdLl9pZDtcbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc1NlcSA9IDE7XG4gICAgICAgICAgICAgICAgX3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihwcm9jZXNzSXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2Vzc0l0ZW0uaWQgPT0gcHJvY2Vzc0lkICYmIHByb2Nlc3NJdGVtLnNlcSA9PSBwcm9jZXNzU2VxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzU2VxID0gcHJvY2Vzc0l0ZW0uc3ViUHJvY2Vzc2VzLmxlbmd0aCArIDFcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gQ2FsbCB0aGUgc3VicHJvY2VzcyBtZXRob2RcbiAgICAgICAgICAgICAgICB2YXIgaW5wdXRVVUlEID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgaWYoZGF0YS5zdWJwcm9jZXNzVVVJRCAhPSB1bmRlZmluZWQgJiYgZGF0YS5zdWJwcm9jZXNzVVVJRC5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRVVUlEID0gZGF0YS5zdWJwcm9jZXNzVVVJRDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9jcmVhdGUgdHhuXG4gICAgICAgICAgICAgICAgdmFyIHR4blBhY2tldCA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBhcHAuU0NPUEUuY29tbXVuaXR5SWQsXG4gICAgICAgICAgICAgICAgICAgIFwidXVpZFwiOiBpbnB1dFVVSUQsXG4gICAgICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkLFxuICAgICAgICAgICAgICAgICAgICBcInRyYW5zYWN0aW9uVHlwZVwiOiBcInN1YlByb2Nlc3NcIixcbiAgICAgICAgICAgICAgICAgICAgXCJkb2N1bWVudHNcIjogW3tcImRvY3VtZW50XCI6IGlucHV0VVVJRCwgXCJyZXZcIjogXCIwXCJ9XVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBkYW8uc3RhcnRUcmFuc2FjdGlvbih0eG5QYWNrZXQpLnRoZW4oZnVuY3Rpb24oc3VjYykge1xuXG4gICAgICAgICAgICAgICAgICAgIFByb2Nlc3Muc3ViUHJvY2VzcyhpbnB1dFVVSUQsIHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdWJwcm9maWxlSWQsIGRhdGEsIF90aGlzKS50aGVuKGZ1bmN0aW9uKHN1YlByb2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdlbmVyYXRlIHRoZSB1dWlkXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1dWlkID0gc3ViUHJvY2Vzcy5kYXRhLl9pZDsgLy9fdGhpcy5wcm9maWxlICsgJzonICsgX3RoaXMuYXBwICsgJzonICsgcHJvY2Vzc0lkICsgJzonICsgcHJvY2Vzc1NlcSArICc6JyArIHN1YlByb2Nlc3NJZCArICc6JyArIHN1YlByb2Nlc3NTZXE7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJ1aWxkIHRoZSBzdWItcHJvY2VzcyByZWZlcmVuY2Ugb2JqZWN0XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncm91cEtleSA9IHN1YlByb2Nlc3MuZGF0YS5ncm91cEtleTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vVE9ETzogQ2hhbmdlIHJlcXVpcmVkIHRvIG1vdmUgaXNBY3RpdmUgdG8gc3ViUHJvY2VzcyBmaWxlLlJlbW92ZSBmcm9tIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJwcm9maWxlSWQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc1JlZiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogc3ViUHJvY2Vzc0lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZDogc3VicHJvZmlsZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcTogc3ViUHJvY2Vzcy5kYXRhW1wibWV0YS1kYXRhXCJdLnN1YlByb2Nlc3NJbnNTZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXVpZDogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm91cEtleTogZ3JvdXBLZXksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHN1YlByb2Nlc3MuZGF0YS5sYWJlbFxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgcmVmZXJlbmNlIHRvIHRoZSBwcm9jZXNzIG1vZGVsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzTW9kZWwuc3ViUHJvY2Vzc2VzLnB1c2goc3ViUHJvY2Vzc1JlZik7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgdGhlIHN1YlByb2Nlc3MgbW9kZWwgdG8gdGhlIHN1YnByb2Nlc3NlcyBhcnJheVxuICAgICAgICAgICAgICAgICAgICAgICAgLy9fdGhpcy5zdWJwcm9jZXNzZXMucHVzaChzdWJQcm9jZXNzLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gX3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzLnB1c2gocHJvY2Vzc01vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NJdGVtID0gX3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzW2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2Vzc0l0ZW0uaWQgPT0gcHJvY2Vzc0lkICYmIHByb2Nlc3NJdGVtLnNlcSA9PSBwcm9jZXNzU2VxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgY3VycmVudCBwcm9jZXNzIGZyb20gdGhlIGFycmF5IGFuZCBhZGQgdGhlIHVwZGF0ZWQgcHJvY2Vzc01vZGVsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmluc3RhbmNlLnByb2Nlc3Nlcy5zcGxpY2UoaW5kZXgsIDEsIHByb2Nlc3NNb2RlbClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUHJvY2VzcyB0aGUgaW5kaWNhdG9yIGRvY3VtZW50cyB3b3JrZmxvdyBwcm9jZXNzZXMgdXBkYXRlc1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvcnMgPSBzdWJQcm9jZXNzLmRhdGEuaW5kaWNhdG9ycztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwID0gc3ViUHJvY2Vzcy5kYXRhLnN0ZXA7XG4gICAgICAgICAgICAgICAgICAgICAgICBQcm9jZXNzLmluZGljYXRvckRvY3MocHJvY2Vzc0lkLCBpbmRpY2F0b3JzLCBzdGVwLCBfdGhpcywgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUHJvY2VzczogJyArIF90aGlzLmNvbmZpZy5wcm9jZXNzZXNbMF0uX2lkICsgJyBpbml0aWFsaXplZCBzdWNjZXNzZnVsbHkuJywgc3ViUHJvY2Vzc1JlZik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29tbWl0IGNhbGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmluc3RhbmNlLnByb2Nlc3NlcyA9IF90aGlzLmluc3RhbmNlLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICEob2JqLmlkID09IHByb2Nlc3NJZCAmJiBvYmouc2VxID09IHByb2Nlc3NTZXEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgIGlmKGVyci5yZXNwb25zZUpTT04gIT0gdW5kZWZpbmVkICYmIGVyci5yZXNwb25zZUpTT04ubWVzc2FnZSAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVyci5yZXNwb25zZUpTT04ubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZihlcnIucmVzcG9uc2VUZXh0ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVyci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIH0pO1xuXG5cblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWplY3QoXCJDYW5ub3QgY3JlYXRlIHdvcmtmbG93IGFzIG90aGVyIHByb2Nlc3MgdXNpbmcgc2FtZSBTRE8gaXMgbm90IGNvbXBsZXRlXCIpXG4gICAgICAgICAgICB9XG5cblxuXG5cblxuXG5cblxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgdHJhbnNpdGlvbiB0byB0aGUgbmV4dCBzdGVwLiBUaGlzIG1vdmVzIHRoZSB3b3JrZmxvdyBmcm9tIHRoZSBjdXJyZW50IHByb2Nlc3MsXG4gKiBzdWItcHJvY2VzcyBzdGVwIHRvIHRoZSBuZXh0IG9uZSBhcyBzcGVjaWZpZWQuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBwcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3ViUHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3ViLXByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdWJQcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHN1Yi1wcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN0ZXBJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN0ZXAgaWQgXG4gKiBAcGFyYW0ge3N0cmluZ30gdHJhbnNpdGlvbklkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gdHJhbnNpdGlvbiBpZFxuICogQHBhcmFtIHtvYmplY3R9IGRhdGEgLSBhbnkgYWRkaXRpb25hbCBkYXRhIHBhc3NlZCBpbiBhcyBrZXkgdmFsdWUgcGFpcnNcbiAqXG4gKiBAZXhhbXBsZVxuICogV29ya2Zsb3cudHJhbnNpdGlvbigncHJvY2Vzc0lkJywgMSwgJ3N1YlByb2Nlc3NJZCcsIDEsICdzdGVwSWQnLCAndHJhbnNpdGlvbklkJywgeyBrZXk6ICcnLCB2YWx1ZTogJycgfSk7XG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUudHJhbnNpdGlvbiA9IGZ1bmN0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHRyYW5zaXRpb25JZCwgZGF0YSwgc3B1dWlkKSB7XG4gICAgLy8gUmUtYXNzaWduIHRoaXNcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBtb2RlbCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3N0ZXBcIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcElkICsgXCInXVwiLCBfdGhpcy5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzU2VxID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vbWV0YS1kYXRhL3N1YlByb2Nlc3NJbnNTZXFcIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciB1cGRhdGUgPSBmdW5jdGlvbih0eXBlLCByZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHByb2Nlc3NJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9jZXNzSXRlbS5pZCA9PSBwcm9jZXNzSWQgJiYgcHJvY2Vzc0l0ZW0uc2VxID09IHByb2Nlc3NTZXEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3ViUHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihzdWJQcm9jZXNzSXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzSXRlbS5pZCA9PSBzdWJQcm9jZXNzSWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NPYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzT2JqLl9pZCA9PSBzcHV1aWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09ICdzdGVwJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NPYmouc3RlcCA9IHJlc3VsdC5kYXRhLnN0ZXA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKHJlc3VsdC5tZXNzYWdlLCBzdWJQcm9jZXNzT2JqKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAnc3RlcENvbXBsZXRlJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NPYmouc3RlcCA9IHJlc3VsdC5kYXRhLnN0ZXA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NPYmouY29tcGxldGUgPSB0cnVlXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluc09iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1t1dWlkIGVxICdcIisgc3ViUHJvY2Vzc09iai5faWQgK1wiJ11cIixhcHAuU0NPUEUud29ya2Zsb3cse30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnNPYmplY3QuY29tcGxldGUgPSB0cnVlO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MocmVzdWx0Lm1lc3NhZ2UsIHN1YlByb2Nlc3NPYmouc3RlcCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHBvc3RBY3Rpb25zID0ge31cblxuICAgICAgICAgICAgaWYoc3RlcE9iamVjdC5mdW5jdGlvbi50YXNrICE9IHVuZGVmaW5lZCAmJiBzdGVwT2JqZWN0LmZ1bmN0aW9uLnRhc2sucG9zdEFjdGlvbnMgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHBvc3RBY3Rpb25zID0gc3RlcE9iamVjdC5mdW5jdGlvbi50YXNrLnBvc3RBY3Rpb25zO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIFByb2Nlc3MucG9zdEFjdGlvbnMocG9zdEFjdGlvbnMsIF90aGlzLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24oc3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIFByb2Nlc3MudHJhbnNpdGlvbihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCB0cmFuc2l0aW9uSWQsIGRhdGEsIF90aGlzLCBzcHV1aWQsIG1vZGVsKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmRhdGEuc3ViUHJvY2Vzc0NvbXBsZXRlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUoJ3N0ZXBDb21wbGV0ZScsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlKCdzdGVwJywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSBlbHNlIGlmKHN0ZXBPYmplY3QuZnVuY3Rpb24uc2VydmVyICE9IHVuZGVmaW5lZCAmJiBzdGVwT2JqZWN0LmZ1bmN0aW9uLnNlcnZlci5wb3N0QWN0aW9ucyAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcG9zdEFjdGlvbnMgPSBzdGVwT2JqZWN0LmZ1bmN0aW9uLnNlcnZlci5wb3N0QWN0aW9ucztcbiAgICAgICAgICAgICAgICBQcm9jZXNzLnBvc3RBY3Rpb25zKHBvc3RBY3Rpb25zLCBfdGhpcywgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICBQcm9jZXNzLnRyYW5zaXRpb24ocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwgdHJhbnNpdGlvbklkLCBkYXRhLCBfdGhpcywgc3B1dWlkLCBtb2RlbCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5kYXRhLnN1YlByb2Nlc3NDb21wbGV0ZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlKCdzdGVwQ29tcGxldGUnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZSgnc3RlcCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIFByb2Nlc3MudHJhbnNpdGlvbihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCB0cmFuc2l0aW9uSWQsIGRhdGEsIF90aGlzLCBzcHV1aWQsIG1vZGVsKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuZGF0YS5zdWJQcm9jZXNzQ29tcGxldGUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlKCdzdGVwQ29tcGxldGUnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUoJ3N0ZXAnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuXG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IGFzc2lnbiB1c2VyLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBwcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gcHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBwcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN1YlByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN1Yi1wcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gc3ViUHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBzdWItcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGVwSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdGVwIGlkXG4gKiBAcGFyYW0ge29iamVjdH0gdXNlciAtIHRoZSB1c2VyIGlkIGFuZCBuYW1lIGRhdGFcbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuYXNzaWduVXNlciA9IGZ1bmN0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCB1c2VyLCB1dWlkKSB7XG4gICAgLy8gUmUtYXNzaWduIHRoZSBXb3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZSBhcyBfdGhpc1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIHNwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgc3BSZXYgPSBzcE9iamVjdC5fcmV2O1xuICAgICAgICAgICAgdmFyIHR4blBhY2tldCA9IHtcbiAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5jb21tdW5pdHlJZCxcbiAgICAgICAgICAgICAgICBcInV1aWRcIjogdXVpZCxcbiAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCxcbiAgICAgICAgICAgICAgICBcInRyYW5zYWN0aW9uVHlwZVwiOiBcInN1YlByb2Nlc3NcIixcbiAgICAgICAgICAgICAgICBcImRvY3VtZW50c1wiOiBbe1xuICAgICAgICAgICAgICAgICAgICBcImRvY3VtZW50XCI6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgIFwicmV2XCI6IHNwUmV2XG4gICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIFByb2Nlc3MuYXNzaWduVXNlcihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgdXNlciwgdXVpZCwgX3RoaXMpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG5cbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgICAgIFxuXG5cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICBcblxuXG5cbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSlcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgdGFzaywgdGhpcyBtZXRob2QgZXhlY3V0ZXMgYSBzcGVjaWZpYyB0YXNrLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgcHJvY2VzcyBpZCB0byBwcm9jZXNzXG4gKiBAcGFyYW0ge29iamVjdH0gaW5wdXREYXRhIC0gdGhlIGlucHV0IGRhdGEgdG8gcHJvY2Vzc1xuICpcbiAqIEBleGFtcGxlXG4gKiBXb3JrZmxvdy5pbml0aWFsaXplKCdwcm9jZXNzSWQnLCB7IHZhbGlkRGF0ZTogJ2RhdGUnIH0pO1xuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLnVpID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gUmUtYXNzaWduIHRoZSBXb3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZSBhcyBfdGhpc1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZ2V0UHJvY2VzczogZnVuY3Rpb24ocHJvY2Vzc0lkLCBsYW5nKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdXNlckludGVyZmFjZS5nZXRQcm9jZXNzKHByb2Nlc3NJZCwgbGFuZywgX3RoaXMpLnRoZW4oZnVuY3Rpb24obW9kZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUobW9kZWwpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgIH1cblxufTtcblxuLyoqXG4gKiBXb3JrZmxvdyB0YXNrLCB0aGlzIG1ldGhvZCBleGVjdXRlcyBhIHNwZWNpZmljIHRhc2suXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IGRhdGEgLSB0aGUgcHJvY2VzcyBpZCB0byBwcm9jZXNzXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgaW5wdXQgZGF0YSB0byBwcm9jZXNzXG4gKiAqIEBwYXJhbSB7c3RyaW5nfSB1dWlkIC0gdGhlIGlucHV0IGRhdGEgdG8gcHJvY2Vzc1xuICpcbiAqIEBleGFtcGxlXG4gKiBXb3JrZmxvdy5nZXROb2RlVmFsdWUoZGF0YSwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuXG5Xb3JrZmxvdy5wcm90b3R5cGUuZ2V0Tm9kZVZhbHVlID0gZnVuY3Rpb24oZGF0YSwgdXVpZCkge1xuICAgIC8vIFJlLWFzc2lnbiB0aGUgV29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2UgYXMgX3RoaXNcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUoZGF0YSwgX3RoaXMsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXMpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSlcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgdGFzaywgdGhpcyBtZXRob2QgZXhlY3V0ZXMgYSBzcGVjaWZpYyB0YXNrLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gdGhlIHByb2Nlc3MgaWQgdG8gcHJvY2Vzc1xuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGlucHV0IGRhdGEgdG8gcHJvY2Vzc1xuICpcbiAqIEBleGFtcGxlXG4gKiBXb3JrZmxvdy50YWtlQXNzaWdubWVudChzcHV1aWQsIF9XRkluc3RhbmNlKTtcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cblxuV29ya2Zsb3cucHJvdG90eXBlLnRha2VBc3NpZ25tZW50ID0gZnVuY3Rpb24oc3B1dWlkKSB7XG4gICAgLy8gUmUtYXNzaWduIHRoZSBXb3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZSBhcyBfdGhpc1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgXG4gICAgICAgICAgIC8vQXNzaWdubWVudCBhcmUgZXhlY3V0aW5nIGhlcmVcblxuICAgICAgICAgICB2YXIgc3BPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXVwiLCBfdGhpcywge30pWzBdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgIHZhciBhc3NpZ25lZSA9IEpTT04ueHBhdGgoXCIvc3RlcC9hc3NpZ25lZFRvXCIsIHNwT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgIC8vUHVzaGluZyBvbGRlciByZWNvcmQgaW4gcmVBc3NpZ24gYXJyYXlcblxuICAgICAgICAgICBpZiAoc3BPYmplY3Quc3RlcC5hc3NpZ25tZW50SGlzdG9yeSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgIHNwT2JqZWN0LnN0ZXAuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgfVxuICAgICAgICAgICBpZiAoYXNzaWduZWUudXNlcklkICE9IFwiXCIgJiYgYXNzaWduZWUubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICBzcE9iamVjdC5zdGVwLmFzc2lnbm1lbnRIaXN0b3J5LnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhc3NpZ25lZSkpKTtcbiAgICAgICAgICAgfVxuXG5cblxuICAgICAgICAgICBhc3NpZ25lZS5uYW1lID0gX2xjbHguU0VTU0lPTi5maXJzdE5hbWUgKyBcIiBcIiArIF9sY2x4LlNFU1NJT04ubGFzdE5hbWU7XG4gICAgICAgICAgIGFzc2lnbmVlLnVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcbiAgICAgICAgICAgYXNzaWduZWUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgYXNzaWduZWUudHlwZSA9IEFTU0lHTk1FTlRfVFlQRV9BQ0NFUFRBTkNFO1xuICAgICAgICAgICBhc3NpZ25lZS5kdWVEYXRlVGltZSA9ICcnO1xuICAgICAgICAgICBhc3NpZ25lZS5ieSA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcblxuXG4gICAgICAgICAgIC8vZmV0Y2ggcHJlV29ya0FjdGlvbnMgaGVyZSBcblxuICAgICAgICAgICB2YXIgcHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXNbc3ViUHJvY2Vzc2VzL3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfdGhpcywge30pWzBdO1xuICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfdGhpcywge30pWzBdO1xuICAgICAgICAgICBcbiAgICAgICAgICAgdmFyIHN0ZXBJZCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3N0ZXAvaWRcIiwgX3RoaXMsIHt9KVswXTtcbiAgICAgICAgIFxuICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcElkICsgXCInXVwiLCBfdGhpcy5jb25maWcsIHt9KVswXTtcblxuICAgICAgICAgICBpZiAoc3RlcE9iamVjdC5mdW5jdGlvbi50YXNrLnByZVdvcmtBY3Rpb25zICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICB2YXIgcHJlV29ya0FjdGlvbnMgPSBzdGVwT2JqZWN0LmZ1bmN0aW9uLnRhc2sucHJlV29ya0FjdGlvbnM7XG4gICAgICAgICAgICAgICBQcm9jZXNzLnByZVdvcmtBY3Rpb25zKHByZVdvcmtBY3Rpb25zLCBfdGhpcykudGhlbihmdW5jdGlvbihzdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICByZXNvbHZlKF90aGlzKTtcblxuICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcblxuICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpcyk7XG5cbiAgICAgICAgICAgfVxuXG5cblxuXG5cbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG5cbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuXG4gICAgICAgIH1cblxuICAgIH0pO1xufTtcblxuXG4vKipcbiAqIFdvcmtmbG93IHRhc2ssIHRoaXMgbWV0aG9kIGV4ZWN1dGVzIGEgc3BlY2lmaWMgdGFzay5cbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gZGF0YSAtIHRoZSBwcm9jZXNzIGlkIHRvIHByb2Nlc3NcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBpbnB1dCBkYXRhIHRvIHByb2Nlc3NcbiAqXG4gKiBAZXhhbXBsZVxuICogV29ya2Zsb3cuY29uZGl0aW9uKGNvbmRpdGlvbiwgc3B1dWlkKTtcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cblxuV29ya2Zsb3cucHJvdG90eXBlLmNvbmRpdGlvbiA9IGZ1bmN0aW9uKGNvbmRpdGlvbiwgc3B1dWlkKSB7XG5cbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICB0cnkge1xuXG4gICAgICAgICAgICB2YXIgb3BlcmF0b3IgPSBjb25kaXRpb24ub3BlcmF0b3I7XG4gICAgICAgICAgICB2YXIgZGF0YUJsb2NrID0gY29uZGl0aW9uLnZhbHVlLmRhdGE7XG5cbiAgICAgICAgICAgIGlmIChjb25kaXRpb24uc3ViamVjdC5pbmRpY2F0b3IgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2V0SWQgPSBjb25kaXRpb24uc3ViamVjdC5pbmRpY2F0b3Iuc2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIG1vZGVsU2NvcGUgPSBjb25kaXRpb24uc3ViamVjdC5pbmRpY2F0b3IubW9kZWxTY29wZTtcbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudFBhdGggPSBjb25kaXRpb24uc3ViamVjdC5pbmRpY2F0b3IuZWxlbWVudFBhdGg7XG4gICAgICAgICAgICAgICAgaWYgKGNvbmRpdGlvbi5zdWJqZWN0LmluZGljYXRvci5jb250ZXh0ID09ICdzdWJQcm9jZXNzJykge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBzZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX3RoaXMsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvck1vZGVsID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfdGhpcywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YUVsZW1lbnQgPSBpbmRpY2F0b3JNb2RlbC5tb2RlbFttb2RlbFNjb3BlXS5kYXRhW3NldElkXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciBmaW5hbFZhbHVlID0gZGF0YUVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXRoVG9FbGVtZW50ID0gZWxlbWVudFBhdGggPT0gXCJcIiA/IFtdIDogZWxlbWVudFBhdGguc3BsaXQoL1snXCJcXFtcXF0uXSsvKTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHBhdGhUb0VsZW1lbnQubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBhdGhUb0VsZW1lbnRba10gPT0gXCJcIikgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlID0gZmluYWxWYWx1ZVtwYXRoVG9FbGVtZW50W2tdXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBmaW5hbFZhbHVlOyBcblxuICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGRhdGFCbG9jaywgX3RoaXMsIHNwdXVpZCkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBoZWxwZXIuY29tcGFyZSh2YWx1ZSwgb3BlcmF0b3IsIHJlcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb25kaXRpb24uc3ViamVjdC5pbmRpY2F0b3IuY29udGV4dCA9PSAnc3ViUHJvZmlsZScpIHtcblxuICAgICAgICAgICAgICAgICAgICAvL1NQOlRPRE8gRE9ORVxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yTW9kZWwgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyBzZXRJZCArIFwiJ11cIiwgX3RoaXMsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhRWxlbWVudCA9IGluZGljYXRvck1vZGVsLm1vZGVsW21vZGVsU2NvcGVdLmRhdGFbc2V0SWRdO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbmFsVmFsdWUgPSBkYXRhRWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGhUb0VsZW1lbnQgPSBlbGVtZW50UGF0aCA9PSBcIlwiID8gW10gOiBlbGVtZW50UGF0aC5zcGxpdCgvWydcIlxcW1xcXS5dKy8pO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcGF0aFRvRWxlbWVudC5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYocGF0aFRvRWxlbWVudFtrXSA9PSBcIlwiKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGZpbmFsVmFsdWU7IFxuXG4gICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUoZGF0YUJsb2NrLCBfdGhpcywgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGhlbHBlci5jb21wYXJlKHZhbHVlLCBvcGVyYXRvciwgcmVzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoJ05vdCBpbXBsZW1lbnRlZCcpXG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZGl0aW9uLnN1YmplY3QuaW5kaWNhdG9yV3JhcHBlciAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgIHJlamVjdCgnTm90IGltcGxlbWVudGVkJyk7XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZGl0aW9uLnN1YmplY3QudmFyaWFibGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAvLyB2YXIgdmFsdWUgPSBkYXRhQmxvY2sudmFsdWUuZGF0YTtcblxuICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUoZGF0YUJsb2NrICwgX3RoaXMsIHNwdXVpZCkudGhlbihmdW5jdGlvbihyaHMpIHtcbiAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShjb25kaXRpb24uc3ViamVjdCwgX3RoaXMsIHNwdXVpZCkudGhlbihmdW5jdGlvbihsaHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBoZWxwZXIuY29tcGFyZShsaHMsIG9wZXJhdG9yLCByaHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgLy8gcmVqZWN0KCdOb3QgaW1wbGVtZW50ZWQnKVxuICAgICAgICAgICAgfSBlbHNlIGlmIChjb25kaXRpb24uc3ViamVjdC5zdWJQcm9jZXNzICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRQYXRoID0gY29uZGl0aW9uLnN1YmplY3Quc3ViUHJvY2Vzcy5lbGVtZW50UGF0aDtcbiAgICAgICAgICAgICAgICB2YXIgc3BPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXVwiLCBfdGhpcywge30pWzBdO1xuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIGZpbmFsVmFsdWUgPSBzcE9iamVjdDtcbiAgICAgICAgICAgICAgICB2YXIgcGF0aFRvRWxlbWVudCA9IGVsZW1lbnRQYXRoID09IFwiXCIgPyBbXSA6IGVsZW1lbnRQYXRoLnNwbGl0KC9bJ1wiXFxbXFxdLl0rLyk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHBhdGhUb0VsZW1lbnQubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYocGF0aFRvRWxlbWVudFtrXSA9PSBcIlwiKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IGZpbmFsVmFsdWVbcGF0aFRvRWxlbWVudFtrXV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGZpbmFsVmFsdWU7IFxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUoZGF0YUJsb2NrLCBfdGhpcywgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gaGVscGVyLmNvbXBhcmUodmFsdWUsIG9wZXJhdG9yLCByZXMpO1xuXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cblxuXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuXG4gICAgICAgICAgICByZWplY3QoZXJyKTtcblxuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gV29ya2Zsb3c7IiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbCA9IHJlcXVpcmUoJ3V0aWxpdHknKTtcbnZhciBub2RlVmFsdWUgPSByZXF1aXJlKCcuL25vZGVWYWx1ZScpO1xudmFyIGZvcm0gPSByZXF1aXJlKCcuL2Zvcm0nKTtcbnZhciBoZWxwZXIgPSByZXF1aXJlKCcuL2hlbHBlcicpO1xuXG52YXIgZ2F0ZWtlZXBlciA9IG5ldyBHSygpO1xuXG4vKipcbiAqIEFjdGlvbnMgTW9kdWxlXG4gKlxuICogQG1vZHVsZSBsaWIvYWN0aW9uc1xuICogQGF1dGhvciBIYXNhbiBBYmJhc1xuICogQHZlcnNpb24gMi4wLjBcbiAqIEBkZXNjcmlwdGlvbiB0ZXN0IGRlc2NyaXB0aW9uXG4gKiBAY29weXJpZ2h0IEt3YW50dSBMdGQgUlNBIDIwMDktMjAxNS5cbiAqXG4gKi9cblxuLyoqXG4gKiAgRm9ybSBNb2R1bGUgYWN0aW9ucyBuZWVkcyB0byBiZSBtb3ZlZCBoZXJlLlxuICogIFRoaXMgYWN0aW9ucyBtb2R1bGUgd2lsbCBiZSBjZW50YWwgcGxhY2UgdG8gaG9sZCBhbGwgZnVuY3Rpb25zLlxuICogIFxuICovXG5cbnZhciBjb21tdW5pdHkgPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAgIGNyZWF0ZUNvbW11bml0eTogZnVuY3Rpb24oX2RlZiwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiZm9sbG93XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHV1aWRDb21tdW5pdHkgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnQ29tbXVuaXR5J10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlQ29tbXVuaXR5XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibmV3Q29tbXVuaXR5SWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaW5kaWNhdG9yVVVJRFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJDb21tdW5pdHlcIjogdXVpZENvbW11bml0eVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICB1c2VySm9pbkNvbW11bml0eTogZnVuY3Rpb24oX2RlZiwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuICAgICAgICByZWxlYXNlQWRvcHRlZEFwcGxpY2F0aW9uOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJmb2xsb3dcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG4gICAgICAgICAgICAgICAgdmFyIHV1aWRSZWxlYXNlQWRvcHRlZEFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ2Fkb3B0ZWRBcHBsaWNhdGlvbiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJyZWxlYXNlQWRvcHRlZEFwcGxpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaW5kaWNhdG9yVVVJRFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhZG9wdGVkQXBwbGljYXRpb25cIjogdXVpZFJlbGVhc2VBZG9wdGVkQXBwbGljYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgIH1cblxufSkoKTtcblxudmFyIGFwcGxpY2F0aW9uID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICBjcmVhdGVBcHBEZWZpbml0aW9uOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJmb2xsb3dcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG4gICAgICAgICAgICAgICAgdmFyIHV1aWRBcHBsaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdBcHBsaWNhdGlvbiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlQXBwbGljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJuZXdBcHBsaWNhdGlvbklkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImluZGljYXRvclVVSURcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQXBwbGljYXRpb25cIjogdXVpZEFwcGxpY2F0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgYnVpbGRBcHBsaWNhdGlvbjogZnVuY3Rpb24oX2RlZiwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiZm9sbG93XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuICAgICAgICAgICAgICAgIHZhciB1dWlkUHVibGlzaEFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1B1Ymxpc2hBcHBsaWNhdGlvbiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHV1aWRBcHBsaWNhdGlvbkRlZmluaXRpb24gPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnQXBwbGljYXRpb25EZWZpbml0aW9uJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHV1aWRSb2xlcyA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdSb2xlcyddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciB1dWlkQXBwbGljYXRpb24gPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnQXBwbGljYXRpb24nXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgdXVpZEFwcFBlcm1pc3Npb25zID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ0FwcFBlcm1pc3Npb25zJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImJ1aWxkQXBwbGljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImluZGljYXRvclVVSURcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiUHVibGlzaEFwcGxpY2F0aW9uXCI6IHV1aWRQdWJsaXNoQXBwbGljYXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJBcHBsaWNhdGlvbkRlZmluaXRpb25cIjogdXVpZEFwcGxpY2F0aW9uRGVmaW5pdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlJvbGVzXCI6IHV1aWRSb2xlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkFwcGxpY2F0aW9uXCI6IHV1aWRBcHBsaWNhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkFwcFBlcm1pc3Npb25zXCI6IHV1aWRBcHBQZXJtaXNzaW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtlciBwcm9jZXNzZXMgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGFwcGxpY2F0aW9uQWRvcHRpb246IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiZm9sbG93XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuICAgICAgICAgICAgICAgIHZhciB1dWlkQWRvcHRpb24gPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnQWRvcHRpb24nXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciB1dWlkUHVibGlzaEFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1B1Ymxpc2hBcHBsaWNhdGlvbiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciB1dWlkQXBwbGljYXRpb24gPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnQXBwbGljYXRpb24nXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiYWRvcHRBcHBsaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaW5kaWNhdG9yVVVJRFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJBZG9wdGlvblwiOiB1dWlkQWRvcHRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJQdWJsaXNoQXBwbGljYXRpb25cIjogdXVpZFB1Ymxpc2hBcHBsaWNhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkFwcGxpY2F0aW9uXCI6IHV1aWRBcHBsaWNhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtlciBwcm9jZXNzZXMgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZVRheG9ub215OiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJmb2xsb3dcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG4gICAgICAgICAgICAgICAgdmFyIHRheG9ub215VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdUYXhvbm9teSddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVUYXhvbm9teVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInRheG9ub215VVVJRFwiOiB0YXhvbm9teVVVSURcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgIH1cblxufSkoKTtcblxudmFyIHBlcmZvcm1hbmNlID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuXG4gICAgICAgIHVubG9ja1BlcmlvZDogZnVuY3Rpb24oX2RlZiwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIGVudHJ5VVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBQRVJJT0RfU0VUX0lEICsgXCInIG9yIGlkIGVxICdcIiArIEFVRElUX1BFUklPRF9TRVRfSUQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIHN1YnByb2Nlc3NPYmplY3QsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIGVuZGRhdGUgPSBzdWJwcm9jZXNzT2JqZWN0LmRhdGVzLnZhbGlkO1xuXG4gICAgICAgICAgICAgICAgbGlicmFyeS51bmxvY2tQZXJpb2QoZW50cnlVVUlELCBlbmRkYXRlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnVW5sb2NrIHBlcmlvZC4nLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuXG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG5cblxuXG5cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0TW9kZWxTdGF0dXM6IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIGVudHJ5VVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBQRVJJT0RfU0VUX0lEICsgXCInIG9yIGlkIGVxICdcIiArIEFVRElUX1BFUklPRF9TRVRfSUQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIHN1YnByb2Nlc3NPYmplY3QsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIGVuZGRhdGUgPSBzdWJwcm9jZXNzT2JqZWN0LmRhdGVzLnZhbGlkO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN0YXR1c2kxOG5MYWJlbCA9IEpTT04ueHBhdGgoXCIvbGFiZWxcIiwgX2RlZiwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSBoZWxwZXIuZ2V0TGFuZ3VhZ2VNZXNzYWdlKHN0YXR1c2kxOG5MYWJlbCk7XG5cblxuICAgICAgICAgICAgICAgIGxpYnJhcnkuc2V0UGVyaW9kU3RhdHVzKGVudHJ5VVVJRCwgZW5kZGF0ZSwgc3RhdHVzLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2Vzcygnc2V0TW9kZWxTdGF0dXMnLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuXG5cblxuXG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG5cbiAgICAgICAgbG9ja1BlcmZvcm1hbmNlTW9kZWw6IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIGVudHJ5VVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBQRVJGT1JNQU5DRV9TRVRfSUQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIHN1YnByb2Nlc3NPYmplY3QsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIHZhciBlbmRkYXRlID0gc3VicHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcblxuICAgICAgICAgICAgICAgIGxpYnJhcnkubG9ja1BlcmZvcm1hbmNlTW9kZWwoZW50cnlVVUlELCBlbmRkYXRlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnTG9jayBwZXJmb3JtYW5jZSBtb2RlbC4nLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuXG5cblxuXG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9XG5cbn0pKCk7XG5cbnZhciBzZG8gPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAgIGNyZWF0ZTogZnVuY3Rpb24oX2RlZiwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiZm9sbG93XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuICAgICAgICAgICAgICAgIHZhciBzZG9VVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1NETyddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVTRE9cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9VVUlEXCI6IHNkb1VVSURcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgIH1cblxufSkoKTtcblxudmFyIHRheG9ub215ID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICBjcmVhdGU6IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImZvbGxvd1wiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgdGF4b25vbXlVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1RheG9ub215J10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZVRheG9ub215XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGF4b25vbXlVVUlEXCI6IHRheG9ub215VVVJRFxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuXG52YXIgc3ViUHJvY2Vzc0luc3RhbmNlID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICBzZXRUaXRsZTogZnVuY3Rpb24oX2RlZiwgdXVpZCwgZGF0YVZhbHVlLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3BQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzU1BPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbdXVpZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBhcHAuU0NPUEUud29ya2Zsb3csIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZihwcm9jZXNzU1BPYmplY3QgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc1NQT2JqZWN0LmxhYmVsID0gZGF0YVZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBzcFByb2Nlc3NPYmplY3QubGFiZWwgPSBkYXRhVmFsdWU7XG5cbiAgICAgICAgICAgICAgICB2YXIgaXRlbXNUb1Byb2Nlc3MgPSAxO1xuICAgICAgICAgICAgICAgIHZhciBzdHVmZiA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBvYmogPSB7fTtcblxuICAgICAgICAgICAgICAgIG9iai5tb2RlbCA9IF9XRkluc3RhbmNlLnN1YnByb2Nlc3NlcztcbiAgICAgICAgICAgICAgICBzdHVmZi5wdXNoKG9iaik7XG4gICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1N1YnByb2Nlc3Mgc2V0VGl0bGUgc3VjY2Vzcy4nLCBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHNldFZhbGlkRGF0ZTogZnVuY3Rpb24oX2RlZiwgdXVpZCwgZGF0YVZhbHVlLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3BQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgIHNwUHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZCA9IGRhdGFWYWx1ZTtcblxuICAgICAgICAgICAgICAgIHZhciBpdGVtc1RvUHJvY2VzcyA9IDE7XG4gICAgICAgICAgICAgICAgdmFyIHN0dWZmID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IHt9O1xuXG4gICAgICAgICAgICAgICAgb2JqLm1vZGVsID0gc3BQcm9jZXNzT2JqZWN0O1xuICAgICAgICAgICAgICAgIHN0dWZmLnB1c2gob2JqKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCd2YWxpZCBkYXRlIHNldC4nLCBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHNldFNQU3RhdHVzOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBkYXRhVmFsdWUsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzcFByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgc3BQcm9jZXNzT2JqZWN0LnNwU3RhdHVzID0gZGF0YVZhbHVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIGl0ZW1zVG9Qcm9jZXNzID0gMTtcbiAgICAgICAgICAgICAgICB2YXIgc3R1ZmYgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0ge307XG5cbiAgICAgICAgICAgICAgICBvYmoubW9kZWwgPSBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXM7XG4gICAgICAgICAgICAgICAgc3R1ZmYucHVzaChvYmopO1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdWJwcm9jZXNzIHNwU3RhdHVzIHN1Y2Nlc3MuJywgX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgIH1cblxufSkoKTtcblxudmFyIHZhcmlhYmxlcyA9IChmdW5jdGlvbigpIHtcblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgc2V0VmFyaWFibGU6IGZ1bmN0aW9uKHNldFZhcmlhYmxlLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKHNldFZhcmlhYmxlLmRhdGEsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGFWYWx1ZSkge1xuXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHNjb3BlID0gc2V0VmFyaWFibGUuc2NvcGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YXJpYWJsZU5hbWUgPSBzZXRWYXJpYWJsZS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdmFyaWFibGVUeXBlID0gc2V0VmFyaWFibGUudmFyaWFibGVUeXBlO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWxpZERhdGUgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vZGF0ZXMvdmFsaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoc2NvcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Byb2ZpbGUnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lID0gcHJvZmlsZUlkICsgJzp2YXJpYWJsZXMnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eG5QYWNrZXQgPSBhcHAuU0NPUEUudHhuO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLmdldChwcm9maWxlVmFyaWFibGVGaWxlTmFtZSkudGhlbihmdW5jdGlvbihmaWxlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlZlBhY2sgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsUHJvY2VzcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhcmlhYmxlVHlwZSA9PSAncGVyaW9kaWMnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBPdmVyd3JpdGUgdGhlIGV4aXN0aW5nIHZhcmlhYmxlIGluIGNhc2Ugd2hlcmUgc2FtZSB2YXJpYWJsZSBpcyBhc3NpZ25lZCBhdCBtdWx0aXBsZSBzdGVwcy5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFyIHByb2Nlc3NPYmogPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlc1tzdWJQcm9jZXNzZXMvdXVpZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFyIHNlcSA9IHByb2Nlc3NPYmouc2VxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFyIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VicHJvY2Vzc1R5cGUgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0vdHlwZVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIChzdWJwcm9jZXNzVHlwZSA9PSBQUk9DRVNTX1RZUEVfU1VCUFJPRklMRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCBfaWQgPSAvc3VicHJvY2Vzc2VzW19pZCA9IFwiICsgcGFydCArIFwiXS9faWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCB1dWlkID0gXCIrIHBhcnQgK1wiXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VyTmFtZVwiOiBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogX2xjbHguU1VCU0NSSVBUSU9OUy51c2VyUHJvZmlsZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IHNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWxpZERhdGVcIjogdmFsaWREYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbHVlXCI6IGRhdGFWYWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWxlW3ZhcmlhYmxlTmFtZV0gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaW5hbFZhbHVlID0gZmlsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGhUb0VsZW1lbnQgPSB2YXJpYWJsZU5hbWUgPT0gXCJcIiA/IFtdIDogdmFyaWFibGVOYW1lLnNwbGl0KC9bJ1wiXFxbXFxdLl0rLyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBwYXRoVG9FbGVtZW50Lmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihwYXRoVG9FbGVtZW50W2tdID09IFwiXCIpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IGZpbmFsVmFsdWVbcGF0aFRvRWxlbWVudFtrXV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZS5wdXNoKG9iaik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVbdmFyaWFibGVOYW1lXSA9IFtvYmpdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlW3ZhcmlhYmxlTmFtZV0gPSBkYXRhVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5zYXZlKGZpbGUpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZlBhY2sucmV2ID0gZGF0YS5yZXY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShcIlZhcmlhYmxlIHNldCBzdWNjZXNzZnVsbHlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkZhaWxlZCB0byBzZXQgVmFyaWFibGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmb3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHR4blBhY2tldC5kb2N1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9maWxlVmFyaWFibGVGaWxlTmFtZSA9PSB0eG5QYWNrZXQuZG9jdW1lbnRzW2ldLmRvY3VtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmUGFjayA9ICB0eG5QYWNrZXQuZG9jdW1lbnRzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZm91bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4blBhY2tldCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXBwLlNDT1BFLnR4bikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHhuUGFja2V0LmRvY3VtZW50cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmUGFjayA9IHsgXCJkb2N1bWVudFwiOiBwcm9maWxlVmFyaWFibGVGaWxlTmFtZSwgXCJyZXZcIjogKGZpbGUuX3Jldj09dW5kZWZpbmVkID8gXCIwXCI6IGZpbGUuX3JldikgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4blBhY2tldC5kb2N1bWVudHMucHVzaChyZWZQYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcC5TQ09QRS50eG4uZG9jdW1lbnRzLnB1c2gocmVmUGFjayk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby51cGRhdGVUcmFuc2FjdGlvbih0eG5QYWNrZXQpLnRoZW4oZnVuY3Rpb24oc3VjYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsUHJvY2VzcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihlcnIucmVzcG9uc2VKU09OICE9IHVuZGVmaW5lZCAmJiBlcnIucmVzcG9uc2VKU09OLm1lc3NhZ2UgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVyci5yZXNwb25zZUpTT04ubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKGVyci5yZXNwb25zZVRleHQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsUHJvY2VzcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWxlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfaWRcIjogcHJvZmlsZVZhcmlhYmxlRmlsZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlLmNoYW5uZWxzID0gYXBwLnByb2ZpbGUuY2hhbm5lbHM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhcmlhYmxlVHlwZSA9PSAncGVyaW9kaWMnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBwcm9jZXNzT2JqID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXNbc3ViUHJvY2Vzc2VzL3V1aWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFyIHNlcSA9IHByb2Nlc3NPYmouc2VxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFyIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJwcm9jZXNzVHlwZSA9IEpTT04ueHBhdGgoXCIvY29uZmlnL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbX2lkIGVxIC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkXS90eXBlXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB2YXIgcGFydCA9IGxpYnJhcnkuZ2V0U3VicHJvZmlsZVN1YnByb2Nlc3NJZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIChzdWJwcm9jZXNzVHlwZSA9PSBQUk9DRVNTX1RZUEVfU1VCUFJPRklMRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWQgYW5kIF9pZCA9IC9zdWJwcm9jZXNzZXNbX2lkID0gXCIgKyBwYXJ0ICsgXCJdL19pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnByb2Nlc3NUeXBlID09IFBST0NFU1NfVFlQRV9TVUJQUk9GSUxFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWQgYW5kIHV1aWQgPSBcIisgcGFydCArXCJdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZVt2YXJpYWJsZU5hbWVdID0gW3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VyTmFtZVwiOiBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJQcm9maWxlSWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IHNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbGlkRGF0ZVwiOiB2YWxpZERhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWx1ZVwiOiBkYXRhVmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZVt2YXJpYWJsZU5hbWVdID0gZGF0YVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR4blBhY2tldCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXBwLlNDT1BFLnR4bikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eG5QYWNrZXQuZG9jdW1lbnRzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWZQYWNrID0geyBcImRvY3VtZW50XCI6IHByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lLCBcInJldlwiOiAoZmlsZS5fcmV2PT11bmRlZmluZWQgPyBcIjBcIjogZmlsZS5fcmV2KX07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4blBhY2tldC5kb2N1bWVudHMucHVzaChyZWZQYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwLlNDT1BFLnR4bi5kb2N1bWVudHMucHVzaChyZWZQYWNrKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8udXBkYXRlVHJhbnNhY3Rpb24odHhuUGFja2V0KS50aGVuKGZ1bmN0aW9uKHN1Y2MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5zYXZlKGZpbGUpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZlBhY2sucmV2ID0gZGF0YS5yZXY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShcIlZhcmlhYmxlIHNldCBzdWNjZXNzZnVsbHlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkZhaWxlZCB0byBzZXQgVmFyaWFibGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZXJyLnJlc3BvbnNlSlNPTiAhPSB1bmRlZmluZWQgJiYgZXJyLnJlc3BvbnNlSlNPTi5tZXNzYWdlICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVyci5yZXNwb25zZUpTT04ubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYoZXJyLnJlc3BvbnNlVGV4dCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3ViUHJvY2Vzc0luc3RhbmNlJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJub3QgaW1wbGVtZW50ZWRcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3N0ZXAnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShcIm5vdCBpbXBsZW1lbnRlZFwiKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3N1YlByb2ZpbGVTdWJQcm9jZXNzSW5zdGFuY2UnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUgPSBzdWJQcm9maWxlSWQgKyAnOnZhcmlhYmxlcyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy91cGRhdGUgdHJ4blxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eG5QYWNrZXQgPSBhcHAuU0NPUEUudHhuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5nZXQoc3ViUHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUpLnRoZW4oZnVuY3Rpb24oZmlsZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVmUGFjayA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYWxQcm9jZXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWFibGVUeXBlID09ICdwZXJpb2RpYycpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCBfaWQgPSAvc3VicHJvY2Vzc2VzW19pZCA9IFwiICsgcGFydCArIFwiXS9faWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZCBhbmQgdXVpZCA9IFwiKyBwYXJ0ICtcIl0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlck5hbWVcIjogX2xjbHguU1VCU0NSSVBUSU9OUy51c2VybmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IF9sY2x4LlNVQlNDUklQVElPTlMudXNlclByb2ZpbGVJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBzZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsaWREYXRlXCI6IHZhbGlkRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWx1ZVwiOiBkYXRhVmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZVt2YXJpYWJsZU5hbWVdICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmluYWxWYWx1ZSA9IGZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRoVG9FbGVtZW50ID0gdmFyaWFibGVOYW1lID09IFwiXCIgPyBbXSA6IHZhcmlhYmxlTmFtZS5zcGxpdCgvWydcIlxcW1xcXS5dKy8pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcGF0aFRvRWxlbWVudC5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocGF0aFRvRWxlbWVudFtrXSA9PSBcIlwiKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUucHVzaChvYmopO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlW3ZhcmlhYmxlTmFtZV0gPSBbb2JqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZVt2YXJpYWJsZU5hbWVdID0gZGF0YVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uc2F2ZShmaWxlKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZQYWNrLnJldiA9IGRhdGEucmV2O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJWYXJpYWJsZSBhdCBzdWJwcm9maWxlIHNldCBzdWNjZXNzZnVsbHlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkZhaWxlZCB0byBzZXQgVmFyaWFibGUgYXQgc3VicHJvZmlsZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdHhuUGFja2V0LmRvY3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YlByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lID09IHR4blBhY2tldC5kb2N1bWVudHNbaV0uZG9jdW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZQYWNrID0gIHR4blBhY2tldC5kb2N1bWVudHNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmb3VuZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHhuUGFja2V0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhcHAuU0NPUEUudHhuKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eG5QYWNrZXQuZG9jdW1lbnRzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZQYWNrID0geyBcImRvY3VtZW50XCI6IHN1YlByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lLCBcInJldlwiOiAoZmlsZS5fcmV2PT11bmRlZmluZWQgPyBcIjBcIjogZmlsZS5fcmV2KSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHhuUGFja2V0LmRvY3VtZW50cy5wdXNoKHJlZlBhY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwLlNDT1BFLnR4bi5kb2N1bWVudHMucHVzaChyZWZQYWNrKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLnVwZGF0ZVRyYW5zYWN0aW9uKHR4blBhY2tldCkudGhlbihmdW5jdGlvbihzdWNjKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxQcm9jZXNzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVyci5yZXNwb25zZUpTT04gIT0gdW5kZWZpbmVkICYmIGVyci5yZXNwb25zZUpTT04ubWVzc2FnZSAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyLnJlc3BvbnNlSlNPTi5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYoZXJyLnJlc3BvbnNlVGV4dCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVyci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxQcm9jZXNzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIl9pZFwiOiBzdWJQcm9maWxlVmFyaWFibGVGaWxlTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUuY2hhbm5lbHMgPSBhcHAucHJvZmlsZS5jaGFubmVscztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWFibGVUeXBlID09ICdwZXJpb2RpYycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFyIHByb2Nlc3NPYmogPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlc1tzdWJQcm9jZXNzZXMvdXVpZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy92YXIgc2VxID0gcHJvY2Vzc09iai5zZXE7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFyIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWQgYW5kIGlkID0gL3N1YnByb2Nlc3Nlc1tfaWQgPSAvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tzdWJwcm9maWxlSWQgZXEgJ1wiICsgc3ViUHJvZmlsZUlkICsgXCInXS91dWlkXS9faWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWQgYW5kIF9pZCA9IC9zdWJwcm9jZXNzZXNbX2lkID0gXCIgKyBwYXJ0ICsgXCJdL19pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZVt2YXJpYWJsZU5hbWVdID0gW3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VyTmFtZVwiOiBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJQcm9maWxlSWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IHNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbGlkRGF0ZVwiOiB2YWxpZERhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWx1ZVwiOiBkYXRhVmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZVt2YXJpYWJsZU5hbWVdID0gZGF0YVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR4blBhY2tldCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXBwLlNDT1BFLnR4bikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eG5QYWNrZXQuZG9jdW1lbnRzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWZQYWNrID0geyBcImRvY3VtZW50XCI6IHN1YlByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lLCBcInJldlwiOiAoZmlsZS5fcmV2PT11bmRlZmluZWQgPyBcIjBcIjogZmlsZS5fcmV2KSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eG5QYWNrZXQuZG9jdW1lbnRzLnB1c2gocmVmUGFjayk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcC5TQ09QRS50eG4uZG9jdW1lbnRzLnB1c2gocmVmUGFjayk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLnVwZGF0ZVRyYW5zYWN0aW9uKHR4blBhY2tldCkudGhlbihmdW5jdGlvbihzdWNjKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5zYXZlKGZpbGUpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZlBhY2sucmV2ID0gZGF0YS5yZXY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShcIlZhcmlhYmxlIGF0IHN1YnByb2ZpbGUgc2V0IHN1Y2Nlc3NmdWxseVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiRmFpbGVkIHRvIHNldCBWYXJpYWJsZSBhdCBzdWJwcm9maWxlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZXJyLnJlc3BvbnNlSlNPTiAhPSB1bmRlZmluZWQgJiYgZXJyLnJlc3BvbnNlSlNPTi5tZXNzYWdlICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVyci5yZXNwb25zZUpTT04ubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYoZXJyLnJlc3BvbnNlVGV4dCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJnZXROb2RlVmFsdWUgdmFsdWUgbm90IGZvdW5kLlwiKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuXG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgIH1cblxufSkoKTtcblxudmFyIG5vdGlmaWNhdGlvbiA9IChmdW5jdGlvbigpIHtcblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgc2VuZE5vdGlmaWNhdGlvbldvcmtlcjogZnVuY3Rpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblxuICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0UmVjaXBpZW50cyA9IGZ1bmN0aW9uKG5vdGlmaWNhdGlvbikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlY2lwaWVudHMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLnJlY2lwaWVudHMucm9sZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnJvbGUgPSBub3RpZmljYXRpb24ucmVjaXBpZW50cy5yb2xlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2lwaWVudHMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3RpZmljYXRpb24ucmVjaXBpZW50cy5wcm9maWxlUm9sZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnByb2ZpbGVSb2xlID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMucHJvZmlsZVJvbGUucm9sZSA9IG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnByb2ZpbGVSb2xlLnJvbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMucHJvZmlsZVJvbGUucHJvZmlsZSA9IG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnByb2ZpbGVSb2xlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVjaXBpZW50cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnN1YlByb2ZpbGVSb2xlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuc3ViUHJvZmlsZVJvbGUgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5zdWJQcm9maWxlUm9sZS5yb2xlID0gbm90aWZpY2F0aW9uLnJlY2lwaWVudHMuc3ViUHJvZmlsZVJvbGUucm9sZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5zdWJQcm9maWxlUm9sZS5zdWJQcm9maWxlQ2F0ZWdvcnkgPSBub3RpZmljYXRpb24ucmVjaXBpZW50cy5zdWJQcm9maWxlUm9sZS5zdWJQcm9maWxlQ2F0ZWdvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuc3ViUHJvZmlsZVJvbGUucHJvZmlsZSA9IG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnN1YlByb2ZpbGVSb2xlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVjaXBpZW50cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLmZ1bmN0aW9uICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuZnVuY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IHt9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUobm90aWZpY2F0aW9uLnJlY2lwaWVudHMuZnVuY3Rpb24udXNlcnMsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGFWYWx1ZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLmZ1bmN0aW9uLnVzZXJzID0gZGF0YVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZWNpcGllbnRzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlaihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnN0ZXBBc3NpZ25lZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnN0ZXBBc3NpZ25lZSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnN0ZXBBc3NpZ25lZS5yb2xlID0gbm90aWZpY2F0aW9uLnJlY2lwaWVudHMuc3RlcEFzc2lnbmVlLnJvbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVjaXBpZW50cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnN0ZXBBc3NpZ25lZUZyb21TdGVwICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuc3RlcEFzc2lnbmVlRnJvbVN0ZXAgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBJZCA9IG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnN0ZXBBc3NpZ25lZUZyb21TdGVwLnN0ZXBJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5zdGVwQXNzaWduZWVGcm9tU3RlcC5zdGVwSWQgPSBzdGVwSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNhbGN1a2F0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGlzdG9yeU9iamVjdCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgc3ViUHJvY2Vzc09iamVjdC5oaXN0b3J5Lmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHN1YlByb2Nlc3NPYmplY3QuaGlzdG9yeVtpXS5pZCA9PSBzdGVwSWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpc3RvcnlPYmplY3QgPSBzdWJQcm9jZXNzT2JqZWN0Lmhpc3RvcnlbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGhpc3RvcnlPYmplY3QuYXNzaWdubWVudEhpc3RvcnkgIT0gdW5kZWZpbmVkICYmIGhpc3RvcnlPYmplY3QuYXNzaWdubWVudEhpc3RvcnkubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gaGlzdG9yeU9iamVjdC5hc3NpZ25tZW50SGlzdG9yeVtoaXN0b3J5T2JqZWN0LmFzc2lnbm1lbnRIaXN0b3J5Lmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5zdGVwQXNzaWduZWVGcm9tU3RlcC51c2VySWQgPSBvYmoudXNlcklkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVjaXBpZW50cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLmluZGljYXRvciAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLmluZGljYXRvciA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldElkID0gbm90aWZpY2F0aW9uLnJlY2lwaWVudHMuaW5kaWNhdG9yLmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudElkID0gbm90aWZpY2F0aW9uLnJlY2lwaWVudHMuaW5kaWNhdG9yLmVsZW1lbnRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBpbmRpY2F0b3JTZXRJZCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy9tb2RlbC9wZW5kaW5nL2RhdGEvJyArIGluZGljYXRvclNldElkICsgJy8nICsgZWxlbWVudElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmV0VmFsdWUgPSBKU09OLnhwYXRoKHhwYXRoLCBpbmRPYmplY3QsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLmluZGljYXRvci51c2VySWQgPSByZXRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZWNpcGllbnRzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSBuZXcgTm90aWZpY2F0aW9Xb3JrZXIoYXBwKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvZmlsZUlkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL21ldGEtZGF0YS9zdWJwcm9maWxlSWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciBwYXRoQXJyYXkgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhc2VVUkwgPSBET01BSU4ucmVwbGFjZShcImV4aXN0L3Jlc3RcIixcIlwiKTsgXG4gICAgICAgICAgICAgICAgICAgIC8vd2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3QgKyBcIi9cIiArIHBhdGhBcnJheVsxXTtcblxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VUeXBlXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXRhLWRhdGFcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogX1dGSW5zdGFuY2UuYXBwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IF9XRkluc3RhbmNlLmNvbW11bml0eUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvZmlsZUlkXCI6IHN1YlByb2ZpbGVJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25UeXBlXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJwcm9maWxlSWRcIjogc3VicHJvZmlsZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJpb3JpdHlcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJlY2lwaWVudHNcIjoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVybFwiOiBiYXNlVVJMLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwia2V5c1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3VycmVudFVzZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWxpZERhdGVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZHVlRGF0ZVwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlZERhdGVUaW1lXCI6IG1vbWVudCgpLmZvcm1hdCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0ZXBDcmVhdGVkRGF0ZVRpbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcE5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcElkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub2RlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidGl0bGVcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJEZWZpbmVkXCI6W11cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgICAgIEtleXMgbWVzc2FnZSBcbiAgICAgICAgICAgICAgICAgICAgKi9cblxuXG5cblxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVGl0bGUgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGFwcC5wcm9maWxlLl9pZCArIFwiJ10vdGl0bGVcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5wcm9maWxlLm5hbWUgPSBpbmRpY2F0b3JUaXRsZTtcblxuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMucHJvZmlsZS5pZCA9IGFwcC5wcm9maWxlLl9pZDtcblxuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY29tbXVuaXR5Lm5hbWUgPSBhcHAuZ2V0TmFtZUJ5TGFuZyhfbGNseC5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eU5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY29tbXVuaXR5LmlkID0gX2xjbHguQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlJZDtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgYXBwbGljYXRpb24gPSBKU09OLnhwYXRoKFwiL2FwcGxpY2F0aW9uc1thcHBJZCBlcSAnXCIgKyBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCArIFwiJ11cIiwgX2xjbHguQ09NTVVOSVRZX0NPTkZJRywge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5hcHBsaWNhdGlvbi5uYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoYXBwbGljYXRpb24ubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5hcHBsaWNhdGlvbi5pZCA9IGFwcGxpY2F0aW9uLmFwcElkO1xuXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jdXJyZW50VXNlci5uYW1lID0gX2xjbHguU0VTU0lPTi5maXJzdE5hbWUgKyBcIiBcIiArIF9sY2x4LlNFU1NJT04ubGFzdE5hbWU7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jdXJyZW50VXNlci5pZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgICAgIGlmKG5vdGlmaWNhdGlvbi5zZG9LZXlzICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uc2RvS2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGspe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoay5maWVsZCAhPVwiXCIgJiYgay5yZXBTdHIgIT0gXCJcIiAmJiBrLnNldElkICE9XCJcIil7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmZvckVhY2goZnVuY3Rpb24oc3BJbmQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3BJbmQuY2F0ZWdvcnkudGVybSA9PSBrLnNldElkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmplY3QgPSBzcEluZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpbmRPYmplY3QubW9kZWwgIT0gdW5kZWZpbmVkICYmIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nICE9IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YSAhPXVuZGVmaW5lZCAmJiBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhW2suc2V0SWRdICE9dW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhW2suc2V0SWRdW2suZmllbGRdIT11bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YVtrLnNldElkXVtrLmZpZWxkXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMudXNlckRlZmluZWQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImtleVwiOlwiI1wiK2sucmVwU3RyK1wiI1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWx1ZVwiOiB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy5uYW1lID0gc3ViUHJvY2Vzc09iamVjdC5sYWJlbDtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MuaWQgPSB1dWlkO1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy52YWxpZERhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLnZhbGlkO1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy5kdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy5kdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgdHJ5e1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IHN1YlByb2Nlc3NPYmplY3Quc3RlcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBDcmVhdGVkRGF0ZVRpbWUgPSBzdGVwT2JqZWN0LmRhdGVUaW1lQ3JlYXRlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBJZCA9IHN0ZXBPYmplY3QuaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwQ29uZmlnT2JqZWN0ID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzT2JqZWN0LmlkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcE9iamVjdC5pZCArIFwiJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3RlcC5zdGVwTmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKHN0ZXBDb25maWdPYmplY3QubmFtZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaChlKXtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBub2RlVGl0bGUgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIHN1YnByb2ZpbGVJZCArIFwiJ10vdGl0bGVcIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICBcblxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChub2RlVGl0bGUgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMubm9kZS50aXRsZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMubm9kZS50aXRsZSA9IG5vZGVUaXRsZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICAgICAgV29ya2VyIG1lc3NhZ2UgXG4gICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5kZWZhdWx0ID0gbm90aWZpY2F0aW9uLm1lc3NhZ2UuZGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLnRpdGxlID0gbm90aWZpY2F0aW9uLm1lc3NhZ2UudGl0bGU7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5tZXNzYWdlLnJ0ZiAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5ydGYgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24ubWVzc2FnZS5ydGYudGVtcGxhdGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLnJ0Zi50ZW1wbGF0ZSA9IG5vdGlmaWNhdGlvbi5tZXNzYWdlLnJ0Zi50ZW1wbGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm90aWZpY2F0aW9uLm1lc3NhZ2UucnRmLm1hcmt1cCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UucnRmLm1hcmt1cCA9IG5vdGlmaWNhdGlvbi5tZXNzYWdlLnJ0Zi5tYXJrdXA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgICAgIFdvcmtlciBtZXNzYWdlVHlwZSBcbiAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlVHlwZSA9IG5vdGlmaWNhdGlvbi5tZXNzYWdlVHlwZTtcbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgICAgIFdvcmtlciBub3RpZmljYXRpb25UeXBlIFxuICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvblR5cGUgPSBub3RpZmljYXRpb24ubm90aWZpY2F0aW9uVHlwZTtcbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgICAgIFdvcmtlciBwcmlvcml0eSBcbiAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5wcmlvcml0eSA9IG5vdGlmaWNhdGlvbi5wcmlvcml0eTtcbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgICAgIFdvcmtlciBub3RpZmljYXRpb25BY3Rpb24gaWYgZXhpc3RzIFxuICAgICAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24ubGFiZWwgPSBub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmxhYmVsO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLlVSSSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkkgPSBub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uZ290byAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvID0gbm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uZ290bztcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5zY2hlZHVsZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4ZWN1dGVPYmplY3QgPSBub3RpZmljYXRpb24uc2NoZWR1bGUuZXhlY3V0ZUNvbW1hbmQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3b3JrZXJTY2hlZHVsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bml0OiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhlY3V0ZU9iamVjdC5ub3cgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5leGFjdCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gZXhlY3V0ZU9iamVjdC5leGFjdC5kYXRlVGltZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LmR1ZURhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy5kdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZHVlRGF0ZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudChkdWVEYXRlLCBcIllZWVktTU0tRERcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC5kdWVEYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC5kdWVEYXRlLnVuaXQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC52YWxpZERhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWxpZERhdGUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQodmFsaWREYXRlLCBcIllZWVktTU0tRERcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC52YWxpZERhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZS51bml0O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcENyZWF0ZWREYXRlVGltZSA9IHN1YlByb2Nlc3NPYmplY3Quc3RlcC5kdWVEYXRlVGltZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGVwQ3JlYXRlZERhdGVUaW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KHN0ZXBDcmVhdGVkRGF0ZVRpbWUpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUudW5pdDtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0U2NoZWR1bGUod29ya2VyU2NoZWR1bGUpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciByZWNpcGllbnRzXG4gICAgICAgICAgICAgICAgKi9cblxuXG4gICAgICAgICAgICAgICAgaWYodHlwZW9mIG5vdGlmaWNhdGlvbiA9PT0gXCJzdHJpbmdcIil7XG5cblxuICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0Q29uZmlnKG5vdGlmaWNhdGlvbikudGhlbihmdW5jdGlvbihub3RpT2JqZWN0KXtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbiA9IGFzc2lnbm1lbnRPYmplY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldFJlY2lwaWVudHMobm90aWZpY2F0aW9uKS50aGVuKGZ1bmN0aW9uKHJlY2lwaWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucmVjaXBpZW50cyA9IHJlY2lwaWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0TWVzc2FnZShcIlRoZSBzZXJ2ZXIgaXMgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuIFBsZWFzZSB3YWl0IGEgZmV3IHNlY29uZHMgYW5kIHRoZW4gY2xpY2sgdGhlIHJlZnJlc2ggYnV0dG9uLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0QWN0aW9uKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRDb250ZXh0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcERhdGVUaW1lOiBzdWJQcm9jZXNzT2JqZWN0LnN0ZXAuZGF0ZVRpbWVDcmVhdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZCgpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh3b3JrZXJPYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnTm90aWZpY2F0aW9uIFdvcmtlciBwcm9jZXNzZXMgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vdGlmaWNhdGlvbiAtIGdldFJlY2lwaWVudHMgZmFpbGVkIHdpdGggZXJyb3IgXCIgKyBlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICBcbiAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZmFpbCl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGZhaWwpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuXG5cblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGdldFJlY2lwaWVudHMobm90aWZpY2F0aW9uKS50aGVuKGZ1bmN0aW9uKHJlY2lwaWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5yZWNpcGllbnRzID0gcmVjaXBpZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldE1lc3NhZ2UoXCJUaGUgc2VydmVyIGlzIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0LiBQbGVhc2Ugd2FpdCBhIGZldyBzZWNvbmRzIGFuZCB0aGVuIGNsaWNrIHRoZSByZWZyZXNoIGJ1dHRvbi5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0QWN0aW9uKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRDb250ZXh0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXBEYXRlVGltZTogc3ViUHJvY2Vzc09iamVjdC5zdGVwLmRhdGVUaW1lQ3JlYXRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmQoKS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh3b3JrZXJPYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdOb3RpZmljYXRpb24gV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgXG4gICAgXG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOb3RpZmljYXRpb24gLSBnZXRSZWNpcGllbnRzIGZhaWxlZCB3aXRoIGVycm9yIFwiICsgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgIFxuICAgIFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cblxuICAgICAgICByZUFzc2lnbm1lbnROb3RpZmljYXRpb246IGZ1bmN0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHV1aWQsIHVzZXIpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgZ2V0UmVjaXBpZW50cyA9IGZ1bmN0aW9uKHVzZXJPYmopIHtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjaXBpZW50cyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IHVzZXJPYmouaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2lwaWVudHMpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSBuZXcgTm90aWZpY2F0aW9Xb3JrZXIoYXBwKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9maWxlSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vbWV0YS1kYXRhL3N1YnByb2ZpbGVJZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIC8vIHZhciBwYXRoQXJyYXkgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKTtcbiAgICAgICAgICAgICAgICB2YXIgYmFzZVVSTCA9IERPTUFJTi5yZXBsYWNlKFwiZXhpc3QvcmVzdFwiLFwiXCIpO1xuICAgICAgICAgICAgICAgIC8vd2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3QgKyBcIi9cIiArIHBhdGhBcnJheVsxXTtcblxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJ0ZlwiOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlVHlwZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXRhLWRhdGFcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBfV0ZJbnN0YW5jZS5hcHAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBfV0ZJbnN0YW5jZS5jb21tdW5pdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2ZpbGVJZFwiOiBzdWJQcm9maWxlSWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvblR5cGVcIjogXCJ3b3JrZmxvd1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcmlvcml0eVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWNpcGllbnRzXCI6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidXJsXCI6IGJhc2VVUkwsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImtleXNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3VycmVudFVzZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbGlkRGF0ZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImR1ZURhdGVcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZWREYXRlVGltZVwiOiBtb21lbnQoKS5mb3JtYXQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwQ3JlYXRlZERhdGVUaW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcE5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwSWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub2RlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aXRsZVwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJEZWZpbmVkXCI6W11cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgS2V5cyBtZXNzYWdlIFxuICAgICAgICAgICAgICAgICovXG5cblxuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIGlmKG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQuc2RvS2V5cyAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24ucmVBc3NpZ25tZW50LnNkb0tleXMuZm9yRWFjaChmdW5jdGlvbihrKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoay5maWVsZCAhPVwiXCIgJiYgay5yZXBTdHIgIT0gXCJcIiAmJiBrLnNldElkICE9XCJcIil7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5mb3JFYWNoKGZ1bmN0aW9uKHNwSW5kKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3BJbmQuY2F0ZWdvcnkudGVybSA9PSBrLnNldElkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdCA9IHNwSW5kXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5kT2JqZWN0Lm1vZGVsICE9IHVuZGVmaW5lZCAmJiBpbmRPYmplY3QubW9kZWwucGVuZGluZyAhPSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YSAhPXVuZGVmaW5lZCAmJiBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhW2suc2V0SWRdICE9dW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGFbay5zZXRJZF1bay5maWVsZF0hPXVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGFbay5zZXRJZF1bay5maWVsZF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnVzZXJEZWZpbmVkLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImtleVwiOlwiI1wiK2sucmVwU3RyK1wiI1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbHVlXCI6IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JUaXRsZSA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgYXBwLnByb2ZpbGUuX2lkICsgXCInXS90aXRsZVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgLy8gYWFkZCBrZXlzIHZhbHVlcyBoZXJlXG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMucHJvZmlsZS5uYW1lID0gaW5kaWNhdG9yVGl0bGU7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnByb2ZpbGUuaWQgPSBhcHAucHJvZmlsZS5faWQ7XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY29tbXVuaXR5Lm5hbWUgPSBhcHAuZ2V0TmFtZUJ5TGFuZyhfbGNseC5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eU5hbWUpO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jb21tdW5pdHkuaWQgPSBfbGNseC5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eUlkO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9hcHBsaWNhdGlvbnNbYXBwSWQgZXEgJ1wiICsgYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQgKyBcIiddXCIsIF9sY2x4LkNPTU1VTklUWV9DT05GSUcsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5hcHBsaWNhdGlvbi5uYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoYXBwbGljYXRpb24ubmFtZSk7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmFwcGxpY2F0aW9uLmlkID0gYXBwbGljYXRpb24uYXBwSWQ7XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY3VycmVudFVzZXIubmFtZSA9IF9sY2x4LlNFU1NJT04uZmlyc3ROYW1lICsgXCIgXCIgKyBfbGNseC5TRVNTSU9OLmxhc3ROYW1lO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jdXJyZW50VXNlci5pZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuXG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy5uYW1lID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2xhYmVsXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MuaWQgPSB1dWlkO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MudmFsaWREYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy5kdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy5kdWU7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IHN1YlByb2Nlc3NPYmplY3Quc3RlcDtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3RlcC5zdGVwQ3JlYXRlZERhdGVUaW1lID0gc3RlcE9iamVjdC5kYXRlVGltZUNyZWF0ZWQ7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN0ZXAuc3RlcElkID0gc3RlcE9iamVjdC5pZDtcblxuICAgICAgICAgICAgICAgIHZhciBzdGVwQ29uZmlnT2JqZWN0ID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzT2JqZWN0LmlkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcE9iamVjdC5pZCArIFwiJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBOYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoc3RlcENvbmZpZ09iamVjdC5uYW1lKTtcblxuICAgICAgICAgICAgICAgIHZhciBub2RlVGl0bGUgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIHN1YlByb2ZpbGVJZCArIFwiJ10vdGl0bGVcIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG5cblxuXG5cbiAgICAgICAgICAgICAgICBpZiAobm9kZVRpdGxlID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMubm9kZS50aXRsZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLm5vZGUudGl0bGUgPSBub2RlVGl0bGU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbWVzc2FnZSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5kZWZhdWx0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UudGl0bGUgPSBub3RpZmljYXRpb24ucmVBc3NpZ25tZW50LnRpdGxlO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlID0gbm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC5tZXNzYWdlO1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIG1lc3NhZ2VUeXBlIFxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlVHlwZSA9IG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQubWVzc2FnZVR5cGU7XG5cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIHByaW9yaXR5IFxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5wcmlvcml0eSA9IG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQucHJpb3JpdHk7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbm90aWZpY2F0aW9uQWN0aW9uIGlmIGV4aXN0cyBcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQubm90aWZpY2F0aW9uQWN0aW9uICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmxhYmVsID0gbm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24ubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24ucmVBc3NpZ25tZW50Lm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkkgPSBub3RpZmljYXRpb24ucmVBc3NpZ25tZW50Lm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG8gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG8gPSBub3RpZmljYXRpb24ucmVBc3NpZ25tZW50Lm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uZ290bztcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC5zY2hlZHVsZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZXhlY3V0ZU9iamVjdCA9IG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQuc2NoZWR1bGUuZXhlY3V0ZUNvbW1hbmQ7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHdvcmtlclNjaGVkdWxlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVRpbWU6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1bml0OiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoZXhlY3V0ZU9iamVjdC5ub3cgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG5cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3QuZXhhY3QgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gZXhlY3V0ZU9iamVjdC5leGFjdC5kYXRlVGltZTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3QuZHVlRGF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0ZWREYXRlVGltZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMuZHVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZHVlRGF0ZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KGR1ZURhdGUsIFwiWVlZWS1NTS1ERFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC5kdWVEYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LmR1ZURhdGUudW5pdDtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3QudmFsaWREYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbGlkRGF0ZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KHZhbGlkRGF0ZSwgXCJZWVlZLU1NLUREXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC52YWxpZERhdGUudW5pdDtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwQ3JlYXRlZERhdGVUaW1lID0gc3ViUHJvY2Vzc09iamVjdC5zdGVwLmR1ZURhdGVUaW1lO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RlcENyZWF0ZWREYXRlVGltZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KHN0ZXBDcmVhdGVkRGF0ZVRpbWUpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUudW5pdDtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRTY2hlZHVsZSh3b3JrZXJTY2hlZHVsZSk7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgcmVjaXBpZW50c1xuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICBnZXRSZWNpcGllbnRzKHVzZXIpLnRoZW4oZnVuY3Rpb24ocmVjaXBpZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucmVjaXBpZW50cyA9IHJlY2lwaWVudDtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldEFjdGlvbihhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0TWVzc2FnZShcIlRoZSBzZXJ2ZXIgaXMgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuIFBsZWFzZSB3YWl0IGEgZmV3IHNlY29uZHMgYW5kIHRoZW4gY2xpY2sgdGhlIHJlZnJlc2ggYnV0dG9uLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmQoKS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ05vdGlmaWNhdGlvbiBXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseSBmb3IgcmVhc3NpZ25tZW50LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOb3RpZmljYXRpb24gLSBnZXRSZWNpcGllbnRzIGZhaWxlZCB3aXRoIGVycm9yIFwiICsgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG5cblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGFzc2lnbm1lbnROb3RpZmljYXRpb246IGZ1bmN0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHV1aWQsIHVzZXIpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgZ2V0UmVjaXBpZW50cyA9IGZ1bmN0aW9uKHVzZXJPYmopIHtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjaXBpZW50cyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IHVzZXJPYmouaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2lwaWVudHMpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gbmV3IE5vdGlmaWNhdGlvV29ya2VyKGFwcCk7XG5cblxuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9maWxlSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vbWV0YS1kYXRhL3N1YnByb2ZpbGVJZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIHZhciBwYXRoQXJyYXkgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKTtcbiAgICAgICAgICAgICAgICB2YXIgYmFzZVVSTCA9IERPTUFJTi5yZXBsYWNlKFwiZXhpc3QvcmVzdFwiLFwiXCIpO1xuICAgICAgICAgICAgICAgIC8vd2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3QgKyBcIi9cIiArIHBhdGhBcnJheVsxXTtcblxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJ0ZlwiOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlVHlwZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXRhLWRhdGFcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBfV0ZJbnN0YW5jZS5hcHAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBfV0ZJbnN0YW5jZS5jb21tdW5pdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2ZpbGVJZFwiOiBzdWJQcm9maWxlSWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvblR5cGVcIjogXCJ3b3JrZmxvd1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcmlvcml0eVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWNpcGllbnRzXCI6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidXJsXCI6IGJhc2VVUkwsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImtleXNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3VycmVudFVzZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbGlkRGF0ZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImR1ZURhdGVcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZWREYXRlVGltZVwiOiBtb21lbnQoKS5mb3JtYXQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwQ3JlYXRlZERhdGVUaW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcE5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwSWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub2RlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aXRsZVwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJEZWZpbmVkXCI6IFtdXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBLZXlzIG1lc3NhZ2UgXG4gICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICBpZihub3RpZmljYXRpb24uYXNzaWdubWVudC5zZG9LZXlzICE9IHVuZGVmaW5lZCl7XG5cbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQuc2RvS2V5cy5mb3JFYWNoKGZ1bmN0aW9uKGspe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihrLmZpZWxkICE9XCJcIiAmJiBrLnJlcFN0ciAhPSBcIlwiICYmIGsuc2V0SWQgIT1cIlwiKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmZvckVhY2goZnVuY3Rpb24oc3BJbmQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzcEluZC5jYXRlZ29yeS50ZXJtID09IGsuc2V0SWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0ID0gc3BJbmRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGluZE9iamVjdC5tb2RlbCAhPSB1bmRlZmluZWQgJiYgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcgIT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGEgIT11bmRlZmluZWQgJiYgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YVtrLnNldElkXSAhPXVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhW2suc2V0SWRdW2suZmllbGRdIT11bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhW2suc2V0SWRdW2suZmllbGRdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnVzZXJEZWZpbmVkLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImtleVwiOlwiI1wiK2sucmVwU3RyK1wiI1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbHVlXCI6IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuXG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVGl0bGUgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGFwcC5wcm9maWxlLl9pZCArIFwiJ10vdGl0bGVcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnByb2ZpbGUubmFtZSA9IGluZGljYXRvclRpdGxlO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5wcm9maWxlLmlkID0gYXBwLnByb2ZpbGUuX2lkO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmNvbW11bml0eS5uYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoX2xjbHguQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlOYW1lKTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY29tbXVuaXR5LmlkID0gX2xjbHguQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlJZDtcblxuICAgICAgICAgICAgICAgIHZhciBhcHBsaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvYXBwbGljYXRpb25zW2FwcElkIGVxICdcIiArIGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkICsgXCInXVwiLCBfbGNseC5DT01NVU5JVFlfQ09ORklHLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuYXBwbGljYXRpb24ubmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKGFwcGxpY2F0aW9uLm5hbWUpO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5hcHBsaWNhdGlvbi5pZCA9IGFwcGxpY2F0aW9uLmFwcElkO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmN1cnJlbnRVc2VyLm5hbWUgPSBfbGNseC5TRVNTSU9OLmZpcnN0TmFtZSArIFwiIFwiICsgX2xjbHguU0VTU0lPTi5sYXN0TmFtZTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY3VycmVudFVzZXIuaWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcblxuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MubmFtZSA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9sYWJlbFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLmlkID0gdXVpZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLnZhbGlkRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMudmFsaWQ7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MuZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMuZHVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBzdWJQcm9jZXNzT2JqZWN0LnN0ZXA7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN0ZXAuc3RlcENyZWF0ZWREYXRlVGltZSA9IHN0ZXBPYmplY3QuZGF0ZVRpbWVDcmVhdGVkO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBJZCA9IHN0ZXBPYmplY3QuaWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RlcENvbmZpZ09iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc09iamVjdC5pZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBPYmplY3QuaWQgKyBcIiddXCIsIGFwcC5TQ09QRS53b3JrZmxvdy5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBOYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoc3RlcENvbmZpZ09iamVjdC5uYW1lKTtcblxuICAgICAgICAgICAgICAgIHZhciBub2RlVGl0bGUgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIHN1YlByb2ZpbGVJZCArIFwiJ10vdGl0bGVcIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgaWYgKG5vZGVUaXRsZSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLm5vZGUudGl0bGUgPSBcIlwiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5ub2RlLnRpdGxlID0gbm9kZVRpdGxlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIG1lc3NhZ2UgXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UuZGVmYXVsdCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLnRpdGxlID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQudGl0bGU7XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UgPSBub3RpZmljYXRpb24uYXNzaWdubWVudC5tZXNzYWdlO1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIG1lc3NhZ2VUeXBlIFxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlVHlwZSA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Lm1lc3NhZ2VUeXBlO1xuXG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBwcmlvcml0eSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucHJpb3JpdHkgPSBub3RpZmljYXRpb24uYXNzaWdubWVudC5wcmlvcml0eTtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBub3RpZmljYXRpb25BY3Rpb24gaWYgZXhpc3RzIFxuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLmFzc2lnbm1lbnQubm90aWZpY2F0aW9uQWN0aW9uICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmxhYmVsID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQubm90aWZpY2F0aW9uQWN0aW9uLmxhYmVsO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLmFzc2lnbm1lbnQubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkkgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLlVSSSA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Lm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm90aWZpY2F0aW9uLmFzc2lnbm1lbnQubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLmFzc2lnbm1lbnQuc2NoZWR1bGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGV4ZWN1dGVPYmplY3QgPSBub3RpZmljYXRpb24uYXNzaWdubWVudC5zY2hlZHVsZS5leGVjdXRlQ29tbWFuZDtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgd29ya2VyU2NoZWR1bGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuaXQ6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3I6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChleGVjdXRlT2JqZWN0Lm5vdyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5leGFjdCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBleGVjdXRlT2JqZWN0LmV4YWN0LmRhdGVUaW1lO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5kdWVEYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0ZWREYXRlVGltZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMuZHVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZHVlRGF0ZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KGR1ZURhdGUsIFwiWVlZWS1NTS1ERFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC5kdWVEYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LmR1ZURhdGUudW5pdDtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3QudmFsaWREYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbGlkRGF0ZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KHZhbGlkRGF0ZSwgXCJZWVlZLU1NLUREXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC52YWxpZERhdGUudW5pdDtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwQ3JlYXRlZERhdGVUaW1lID0gc3ViUHJvY2Vzc09iamVjdC5zdGVwLmR1ZURhdGVUaW1lO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RlcENyZWF0ZWREYXRlVGltZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KHN0ZXBDcmVhdGVkRGF0ZVRpbWUpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUudW5pdDtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRTY2hlZHVsZSh3b3JrZXJTY2hlZHVsZSk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciByZWNpcGllbnRzXG4gICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgIGdldFJlY2lwaWVudHModXNlcikudGhlbihmdW5jdGlvbihyZWNpcGllbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5yZWNpcGllbnRzID0gcmVjaXBpZW50O1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0QWN0aW9uKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRNZXNzYWdlKFwiVGhlIHNlcnZlciBpcyBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4gUGxlYXNlIHdhaXQgYSBmZXcgc2Vjb25kcyBhbmQgdGhlbiBjbGljayB0aGUgcmVmcmVzaCBidXR0b24uXCIpO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZCgpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cod29ya2VyT2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdOb3RpZmljYXRpb24gV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkgZm9yIGFzc2lnbm1lbnQuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vdGlmaWNhdGlvbiAtIGdldFJlY2lwaWVudHMgZmFpbGVkIHdpdGggZXJyb3IgXCIgKyBlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcblxuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgYWNjZXB0YW5jZU5vdGlmaWNhdGlvbjogZnVuY3Rpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgdXVpZCwgcm9sZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblxuICAgICAgICAgICAgICAgIHZhciBnZXRSb2xlcyA9IGZ1bmN0aW9uKHJvbGUpIHtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjaXBpZW50cyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5yb2xlID0gcm9sZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVjaXBpZW50cyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSBuZXcgTm90aWZpY2F0aW9Xb3JrZXIoYXBwKTtcblxuXG4gICAgICAgICAgICAgICAgdmFyIHN1YlByb2ZpbGVJZCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9tZXRhLWRhdGEvc3VicHJvZmlsZUlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyB2YXIgcGF0aEFycmF5ID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLnNwbGl0KCcvJyk7XG4gICAgICAgICAgICAgICAgdmFyIGJhc2VVUkwgPSBET01BSU4ucmVwbGFjZShcImV4aXN0L3Jlc3RcIixcIlwiKTtcbiAgICAgICAgICAgICAgICAvL3dpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCArIFwiLy9cIiArIHdpbmRvdy5sb2NhdGlvbi5ob3N0ICsgXCIvXCIgKyBwYXRoQXJyYXlbMV07XG5cblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJydGZcIjoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZVR5cGVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWV0YS1kYXRhXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogX1dGSW5zdGFuY2UuYXBwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogX1dGSW5zdGFuY2UuY29tbXVuaXR5SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9maWxlSWRcIjogc3ViUHJvZmlsZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25UeXBlXCI6IFwid29ya2Zsb3dcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJpb3JpdHlcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVjaXBpZW50c1wiOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInVybFwiOiBiYXNlVVJMLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJrZXlzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImN1cnJlbnRVc2VyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWxpZERhdGVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkdWVEYXRlXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVkRGF0ZVRpbWVcIjogbW9tZW50KCkuZm9ybWF0KClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcENyZWF0ZWREYXRlVGltZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0ZXBOYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcElkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibm9kZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidGl0bGVcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VyRGVmaW5lZFwiOltdXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBLZXlzIG1lc3NhZ2UgXG4gICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JUaXRsZSA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgYXBwLnByb2ZpbGUuX2lkICsgXCInXS90aXRsZVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5wcm9maWxlLm5hbWUgPSBpbmRpY2F0b3JUaXRsZTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMucHJvZmlsZS5pZCA9IGFwcC5wcm9maWxlLl9pZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jb21tdW5pdHkubmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKF9sY2x4LkNPTU1VTklUWV9DT05GSUcuY29tbXVuaXR5TmFtZSk7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmNvbW11bml0eS5pZCA9IF9sY2x4LkNPTU1VTklUWV9DT05GSUcuY29tbXVuaXR5SWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgYXBwbGljYXRpb24gPSBKU09OLnhwYXRoKFwiL2FwcGxpY2F0aW9uc1thcHBJZCBlcSAnXCIgKyBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCArIFwiJ11cIiwgX2xjbHguQ09NTVVOSVRZX0NPTkZJRywge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmFwcGxpY2F0aW9uLm5hbWUgPSBhcHAuZ2V0TmFtZUJ5TGFuZyhhcHBsaWNhdGlvbi5uYW1lKTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuYXBwbGljYXRpb24uaWQgPSBhcHBsaWNhdGlvbi5hcHBJZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jdXJyZW50VXNlci5uYW1lID0gX2xjbHguU0VTU0lPTi5maXJzdE5hbWUgKyBcIiBcIiArIF9sY2x4LlNFU1NJT04ubGFzdE5hbWU7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmN1cnJlbnRVc2VyLmlkID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5zZG9LZXlzICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5zZG9LZXlzLmZvckVhY2goZnVuY3Rpb24oayl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGsuZmllbGQgIT1cIlwiICYmIGsucmVwU3RyICE9IFwiXCIgJiYgay5zZXRJZCAhPVwiXCIpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLmluZGljYXRvcnMuZm9yRWFjaChmdW5jdGlvbihzcEluZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNwSW5kLmNhdGVnb3J5LnRlcm0gPT0gay5zZXRJZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmplY3QgPSBzcEluZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5kT2JqZWN0Lm1vZGVsICE9IHVuZGVmaW5lZCAmJiBpbmRPYmplY3QubW9kZWwucGVuZGluZyAhPSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YSAhPXVuZGVmaW5lZCAmJiBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhW2suc2V0SWRdICE9dW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGFbay5zZXRJZF1bay5maWVsZF0hPXVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGFbay5zZXRJZF1bay5maWVsZF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMudXNlckRlZmluZWQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwia2V5XCI6XCIjXCIray5yZXBTdHIrXCIjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsdWVcIjogdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLm5hbWUgPSBzdWJQcm9jZXNzT2JqZWN0LmxhYmVsO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLmlkID0gdXVpZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLnZhbGlkRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMudmFsaWQ7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MuZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMuZHVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBzdWJQcm9jZXNzT2JqZWN0LnN0ZXA7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN0ZXAuc3RlcENyZWF0ZWREYXRlVGltZSA9IHN0ZXBPYmplY3QuZGF0ZVRpbWVDcmVhdGVkO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBJZCA9IHN0ZXBPYmplY3QuaWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RlcENvbmZpZ09iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc09iamVjdC5pZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBPYmplY3QuaWQgKyBcIiddXCIsIGFwcC5TQ09QRS53b3JrZmxvdy5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3RlcC5zdGVwTmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKHN0ZXBDb25maWdPYmplY3QubmFtZSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZVRpdGxlID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBzdWJQcm9maWxlSWQgKyBcIiddL3RpdGxlXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgIGlmIChub2RlVGl0bGUgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5ub2RlLnRpdGxlID0gXCJcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMubm9kZS50aXRsZSA9IG5vZGVUaXRsZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBtZXNzYWdlIFxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLmRlZmF1bHQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS50aXRsZSA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS50aXRsZTtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZSA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5tZXNzYWdlO1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIG1lc3NhZ2VUeXBlIFxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlVHlwZSA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5tZXNzYWdlVHlwZTtcblxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgcHJpb3JpdHkgXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLnByaW9yaXR5ID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLnByaW9yaXR5O1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIG5vdGlmaWNhdGlvbkFjdGlvbiBpZiBleGlzdHMgXG4gICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmxhYmVsID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm5vdGlmaWNhdGlvbkFjdGlvbi5sYWJlbDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLlVSSSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uZ290byAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uZ290byA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG87XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uuc2NoZWR1bGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGV4ZWN1dGVPYmplY3QgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uuc2NoZWR1bGUuZXhlY3V0ZUNvbW1hbmQ7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHdvcmtlclNjaGVkdWxlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVRpbWU6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1bml0OiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoZXhlY3V0ZU9iamVjdC5ub3cgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG5cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3QuZXhhY3QgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gZXhlY3V0ZU9iamVjdC5leGFjdC5kYXRlVGltZTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3QuZHVlRGF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0ZWREYXRlVGltZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMuZHVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZHVlRGF0ZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KGR1ZURhdGUsIFwiWVlZWS1NTS1ERFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC5kdWVEYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LmR1ZURhdGUudW5pdDtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3QudmFsaWREYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbGlkRGF0ZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KHZhbGlkRGF0ZSwgXCJZWVlZLU1NLUREXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC52YWxpZERhdGUudW5pdDtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwQ3JlYXRlZERhdGVUaW1lID0gc3ViUHJvY2Vzc09iamVjdC5zdGVwLmR1ZURhdGVUaW1lO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RlcENyZWF0ZWREYXRlVGltZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KHN0ZXBDcmVhdGVkRGF0ZVRpbWUpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUudW5pdDtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRTY2hlZHVsZSh3b3JrZXJTY2hlZHVsZSk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciByZWNpcGllbnRzXG4gICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgIGdldFJvbGVzKHJvbGUpLnRoZW4oZnVuY3Rpb24ocmVjaXBpZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucmVjaXBpZW50cyA9IHJlY2lwaWVudDtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldEFjdGlvbihhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0TWVzc2FnZShcIlRoZSBzZXJ2ZXIgaXMgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuIFBsZWFzZSB3YWl0IGEgZmV3IHNlY29uZHMgYW5kIHRoZW4gY2xpY2sgdGhlIHJlZnJlc2ggYnV0dG9uLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldENvbnRleHQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzczoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cod29ya2VyT2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdOb3RpZmljYXRpb24gV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkgZm9yIGFzc2lnbm1lbnQuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vdGlmaWNhdGlvbiAtIGdldFJlY2lwaWVudHMgZmFpbGVkIHdpdGggZXJyb3IgXCIgKyBlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcblxuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgYWNjZXB0YW5jZU5vdGlmaWNhdGlvbkV4dGVybmFsOiBmdW5jdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCB1dWlkLCB1c2Vyc0xpc3QpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgZ2V0VXNlcnNMaXN0ID0gZnVuY3Rpb24odUxpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlY2lwaWVudHMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuZnVuY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuZnVuY3Rpb24udXNlcnMgPSB1TGlzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVjaXBpZW50cyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSBuZXcgTm90aWZpY2F0aW9Xb3JrZXIoYXBwKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9maWxlSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vbWV0YS1kYXRhL3N1YnByb2ZpbGVJZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIHZhciBwYXRoQXJyYXkgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKTtcbiAgICAgICAgICAgICAgICB2YXIgYmFzZVVSTCA9IERPTUFJTi5yZXBsYWNlKFwiZXhpc3QvcmVzdFwiLFwiXCIpO1xuICAgICAgICAgICAgICAgIC8vd2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3QgKyBcIi9cIiArIHBhdGhBcnJheVsxXTtcblxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJ0ZlwiOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlVHlwZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXRhLWRhdGFcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBfV0ZJbnN0YW5jZS5hcHAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBfV0ZJbnN0YW5jZS5jb21tdW5pdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2ZpbGVJZFwiOiBzdWJQcm9maWxlSWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvblR5cGVcIjogXCJ3b3JrZmxvd1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcmlvcml0eVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWNpcGllbnRzXCI6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidXJsXCI6IGJhc2VVUkwsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImtleXNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3VycmVudFVzZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbGlkRGF0ZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImR1ZURhdGVcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZWREYXRlVGltZVwiOiBtb21lbnQoKS5mb3JtYXQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwQ3JlYXRlZERhdGVUaW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcE5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwSWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub2RlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aXRsZVwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgS2V5cyBtZXNzYWdlIFxuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVGl0bGUgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGFwcC5wcm9maWxlLl9pZCArIFwiJ10vdGl0bGVcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMucHJvZmlsZS5uYW1lID0gaW5kaWNhdG9yVGl0bGU7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnByb2ZpbGUuaWQgPSBhcHAucHJvZmlsZS5faWQ7XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY29tbXVuaXR5Lm5hbWUgPSBhcHAuZ2V0TmFtZUJ5TGFuZyhfbGNseC5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eU5hbWUpO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jb21tdW5pdHkuaWQgPSBfbGNseC5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eUlkO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9hcHBsaWNhdGlvbnNbYXBwSWQgZXEgJ1wiICsgYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQgKyBcIiddXCIsIF9sY2x4LkNPTU1VTklUWV9DT05GSUcsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5hcHBsaWNhdGlvbi5uYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoYXBwbGljYXRpb24ubmFtZSk7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmFwcGxpY2F0aW9uLmlkID0gYXBwbGljYXRpb24uYXBwSWQ7XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY3VycmVudFVzZXIubmFtZSA9IF9sY2x4LlNFU1NJT04uZmlyc3ROYW1lICsgXCIgXCIgKyBfbGNseC5TRVNTSU9OLmxhc3ROYW1lO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jdXJyZW50VXNlci5pZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy5uYW1lID0gc3ViUHJvY2Vzc09iamVjdC5sYWJlbDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLmlkID0gdXVpZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLnZhbGlkRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMudmFsaWQ7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MuZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMuZHVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBzdWJQcm9jZXNzT2JqZWN0LnN0ZXA7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN0ZXAuc3RlcENyZWF0ZWREYXRlVGltZSA9IHN0ZXBPYmplY3QuZGF0ZVRpbWVDcmVhdGVkO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBJZCA9IHN0ZXBPYmplY3QuaWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RlcENvbmZpZ09iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc09iamVjdC5pZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBPYmplY3QuaWQgKyBcIiddXCIsIGFwcC5TQ09QRS53b3JrZmxvdy5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3RlcC5zdGVwTmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKHN0ZXBDb25maWdPYmplY3QubmFtZSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZVRpdGxlID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBzdWJQcm9maWxlSWQgKyBcIiddL3RpdGxlXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgIGlmIChub2RlVGl0bGUgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5ub2RlLnRpdGxlID0gXCJcIjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMubm9kZS50aXRsZSA9IG5vZGVUaXRsZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBtZXNzYWdlIFxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLmRlZmF1bHQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS50aXRsZSA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS50aXRsZTtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5ydGYubWFya3VwID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbWVzc2FnZVR5cGUgXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2VUeXBlID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm1lc3NhZ2VUeXBlO1xuXG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBwcmlvcml0eSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucHJpb3JpdHkgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2UucHJpb3JpdHk7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbm90aWZpY2F0aW9uQWN0aW9uIGlmIGV4aXN0cyBcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5ub3RpZmljYXRpb25BY3Rpb24gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24ubGFiZWwgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmxhYmVsO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkkgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uZ290bztcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5zY2hlZHVsZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZXhlY3V0ZU9iamVjdCA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5zY2hlZHVsZS5leGVjdXRlQ29tbWFuZDtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgd29ya2VyU2NoZWR1bGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuaXQ6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3I6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChleGVjdXRlT2JqZWN0Lm5vdyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5leGFjdCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBleGVjdXRlT2JqZWN0LmV4YWN0LmRhdGVUaW1lO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5kdWVEYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy5kdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkdWVEYXRlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoZHVlRGF0ZSwgXCJZWVlZLU1NLUREXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LmR1ZURhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUudW5pdCA9IGV4ZWN1dGVPYmplY3QuZHVlRGF0ZS51bml0O1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC52YWxpZERhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR1ZURhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLnZhbGlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWREYXRlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQodmFsaWREYXRlLCBcIllZWVktTU0tRERcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3QudmFsaWREYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZS51bml0O1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBDcmVhdGVkRGF0ZVRpbWUgPSBzdWJQcm9jZXNzT2JqZWN0LnN0ZXAuZHVlRGF0ZVRpbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGVwQ3JlYXRlZERhdGVUaW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoc3RlcENyZWF0ZWREYXRlVGltZSkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZS51bml0O1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldFNjaGVkdWxlKHdvcmtlclNjaGVkdWxlKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIHJlY2lwaWVudHNcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICBnZXRVc2Vyc0xpc3QodXNlcnNMaXN0KS50aGVuKGZ1bmN0aW9uKHJlY2lwaWVudCkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLnJlY2lwaWVudHMgPSByZWNpcGllbnQ7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRBY3Rpb24oYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldE1lc3NhZ2UoXCJUaGUgc2VydmVyIGlzIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0LiBQbGVhc2Ugd2FpdCBhIGZldyBzZWNvbmRzIGFuZCB0aGVuIGNsaWNrIHRoZSByZWZyZXNoIGJ1dHRvbi5cIik7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRDb250ZXh0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3M6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHdvcmtlck9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnTm90aWZpY2F0aW9uIFdvcmtlciBwcm9jZXNzZXMgc3VjY2Vzc2Z1bGx5IGZvciBhc3NpZ25tZW50LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOb3RpZmljYXRpb24gLSBnZXRSZWNpcGllbnRzIGZhaWxlZCB3aXRoIGVycm9yIFwiICsgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG5cblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG5cblxuICAgIH1cblxufSkoKTtcblxuXG52YXIgcmVwb3J0ID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuXG5cblxuICAgICAgICBjcmVhdGVQZXJmb3JtYW5jZVJlcG9ydDogZnVuY3Rpb24ocGVyZm9ybWFuY2VSZXBvcnRPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNyZWF0ZVBlcmZvcm1hbmNlUmVwb3J0XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuICAgICAgICAgICAgICAgIHZhciB3b3JrcGxhblNldElkID0gcGVyZm9ybWFuY2VSZXBvcnRPYmplY3Qud29ya3BsYW5TZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgY29uZmlnU2V0SWQgPSBwZXJmb3JtYW5jZVJlcG9ydE9iamVjdC5jb25maWdTZXRJZDtcblxuXG4gICAgICAgICAgICAgICAgLy8gd29ya3BsYW5TZXRJZCBzY29wZSBpcyBwcm9maWxlXG4gICAgICAgICAgICAgICAgLy8gY29uZmlnU2V0SWQgc2NvcGUgaXMgc3VicHJvY2Vzc2VzXG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya3BsYW5VVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgd29ya3BsYW5TZXRJZCArIFwiJ10vX2lkXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBjb25maWdVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgY29uZmlnU2V0SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZVBlcmZvcm1hbmNlUmVwb3J0XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid29ya3BsYW5VVUlEXCI6IHdvcmtwbGFuVVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29uZmlnVVVJRFwiOiBjb25maWdVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrcGxhblJlcG9ydCBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVSZXBvcnQ6IGZ1bmN0aW9uKGNyZWF0ZVJlcG9ydCwgX1dGSW5zdGFuY2UsIHV1aWQpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiZXhlY3V0ZVJlcG9ydFwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciBwZXJmb3JtYW5jZVJlcG9ydERlZmluaXRpb25TZXRJZCA9IGNyZWF0ZVJlcG9ydC5QZXJmb3JtYW5jZVJlcG9ydERlZmluaXRpb25TZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgcmVwb3J0aW5nU0RPU2V0SWQgPSBjcmVhdGVSZXBvcnQucmVwb3J0aW5nU0RPU2V0SWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgcGVyZm9ybWFuY2VSZXBvcnREZWZpbml0aW9uID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgcGVyZm9ybWFuY2VSZXBvcnREZWZpbml0aW9uU2V0SWQgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciByZXBvcnRpbmdTRE8gPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyByZXBvcnRpbmdTRE9TZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVSZXBvcnRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJwZXJmb3JtYW5jZVJlcG9ydERlZmluaXRpb25cIjogcGVyZm9ybWFuY2VSZXBvcnREZWZpbml0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZXBvcnRpbmdTRE9cIjogcmVwb3J0aW5nU0RPLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdSZXByb3QgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cblxuXG5cbiAgICAgICAgc2RvUmVwb3J0OiBmdW5jdGlvbihzZG9SZXBvcnQsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcInNkb1JlcG9ydFwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciBzZXRJZCA9IHNkb1JlcG9ydC5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgc2RvUmVwb3J0VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXBvcnRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXBvcnRVVUlEXCI6IHNkb1JlcG9ydFVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogYXBwLlNDT1BFLndvcmtmbG93LnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ3JlcG9ydCBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBleGVjdXRlUmVwb3J0OiBmdW5jdGlvbihleGVjdXRlUmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJleGVjdXRlUmVwb3J0XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuXG5cblxuICAgICAgICAgICAgICAgIHZhciBTRE9yZXBvcnRTZXRJZCA9IGV4ZWN1dGVSZXBvcnQuU0RPcmVwb3J0U2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIHJlcG9ydGluZ1NET1NldGlkID0gZXhlY3V0ZVJlcG9ydC5yZXBvcnRpbmdTRE9TZXRpZDtcblxuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIFNET3JlcG9ydFVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBTRE9yZXBvcnRTZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgcmVwb3J0aW5nU0RPVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHJlcG9ydGluZ1NET1NldGlkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgaWYgKFNET3JlcG9ydFVVSUQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIFNET3JlcG9ydFVVSUQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyBTRE9yZXBvcnRTZXRJZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImV4ZWN1dGVSZXBvcnRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXBvcnRVVUlEXCI6IFNET3JlcG9ydFVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlcG9ydGluZ1NET1VVSURcIjogcmVwb3J0aW5nU0RPVVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBhcHAuU0NPUEUud29ya2Zsb3cucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygncmVwb3J0IFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGdlbmVyYXRlVmlldzogZnVuY3Rpb24oZ2VuZXJhdGVWaWV3LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJzZG9SZXBvcnRcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG4gICAgICAgICAgICAgICAgdmFyIFZpZXdDb25maWdTZXRJZCA9IGdlbmVyYXRlVmlldy5WaWV3Q29uZmlnU2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIFZpZXdDb25maWdVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgVmlld0NvbmZpZ1NldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiZ2VuZXJhdGVWaWV3XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidmlld0NvbmZpZ1VVSURcIjogVmlld0NvbmZpZ1VVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogYXBwLlNDT1BFLndvcmtmbG93LnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ3JlcG9ydCBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICByZXF1ZXN0UmVwb3J0OiBmdW5jdGlvbihyZXF1ZXN0UmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJleGVjdXRlUmVwb3J0XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNkb1JlcXVlc3RSZXBvcnRTZXRJZCA9IHJlcXVlc3RSZXBvcnQuc2RvUmVxdWVzdFJlcG9ydFNldElkO1xuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRDcmVhdGlvblNldElkID0gcmVxdWVzdFJlcG9ydC5zZG9SZXBvcnRDcmVhdGlvblNldElkO1xuICAgICAgICAgICAgICAgIHZhciBwZXJmb3JtYW5jZVJlcG9ydFNldElkID0gcmVxdWVzdFJlcG9ydC5wZXJmb3JtYW5jZVJlcG9ydFNldElkO1xuICAgICAgICAgICAgICAgIHZhciBzZG9SZXF1ZXN0UmVwb3J0VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNkb1JlcXVlc3RSZXBvcnRTZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgc2RvUmVwb3J0Q3JlYXRpb25VVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgc2RvUmVwb3J0Q3JlYXRpb25TZXRJZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHBlcmZvcm1hbmNlUmVwb3J0VVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIHBlcmZvcm1hbmNlUmVwb3J0U2V0SWQgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJyZXF1ZXN0UmVwb3J0XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicGVyZm9ybWFuY2VSZXBvcnRVVUlEXCI6IHBlcmZvcm1hbmNlUmVwb3J0VVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic2RvUmVxdWVzdFJlcG9ydFVVSURcIjogc2RvUmVxdWVzdFJlcG9ydFVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydENyZWF0aW9uVVVJRFwiOiBzZG9SZXBvcnRDcmVhdGlvblVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogYXBwLlNDT1BFLndvcmtmbG93LnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1JlcXVlc3QgcmVwb3J0IFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG5cbiAgICAgICAgZ2VuZXJhdGVCYXNpY1ZpZXc6IGZ1bmN0aW9uKGdlbmVyYXRlQmFzaWNWaWV3LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJzZG9SZXBvcnRcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2RvRGF0YU9iamVjdFZpZXdTZXRJZCA9IGdlbmVyYXRlQmFzaWNWaWV3LnNkb0RhdGFPYmplY3RWaWV3U2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIHNkb0RhdGFPYmplY3RWaWV3VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNkb0RhdGFPYmplY3RWaWV3U2V0SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImdlbmVyYXRlQmFzaWNWaWV3XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic2RvRGF0YU9iamVjdFZpZXdVVUlEXCI6IHNkb0RhdGFPYmplY3RWaWV3VVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBhcHAuU0NPUEUud29ya2Zsb3cucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnZ2VuZXJhdGVCYXNpY1ZpZXcgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2VuZXJhdGVVbmlvblZpZXc6IGZ1bmN0aW9uKGdlbmVyYXRlVW5pb25WaWV3LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJzZG9SZXBvcnRcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2RvRGF0YU9iamVjdFZpZXdVbmlvblNldElkID0gZ2VuZXJhdGVVbmlvblZpZXcuc2RvRGF0YU9iamVjdFZpZXdVbmlvblNldElkO1xuICAgICAgICAgICAgICAgIHZhciBzZG9EYXRhT2JqZWN0Vmlld1VuaW9uVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNkb0RhdGFPYmplY3RWaWV3VW5pb25TZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiZ2VuZXJhdGVVbmlvblZpZXdcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9EYXRhT2JqZWN0Vmlld1VuaW9uVVVJRFwiOiBzZG9EYXRhT2JqZWN0Vmlld1VuaW9uVVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBhcHAuU0NPUEUud29ya2Zsb3cucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnZ2VuZXJhdGVVbmlvblZpZXcgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgc2RvUmVwb3J0TXVsdGlwbGU6IGZ1bmN0aW9uKHNkb1JlcG9ydE11bHRpcGxlLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJzZG9SZXBvcnRcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2RvUmVwb3J0Q3JlYXRpb25TZXRJZCA9IHNkb1JlcG9ydE11bHRpcGxlLnNkb1JlcG9ydENyZWF0aW9uU2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIHNkb1JlcG9ydFZpZXdzU2V0SWQgPSBzZG9SZXBvcnRNdWx0aXBsZS5zZG9SZXBvcnRWaWV3c1NldElkO1xuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRKb2luc1NldElkID0gc2RvUmVwb3J0TXVsdGlwbGUuc2RvUmVwb3J0Sm9pbnNTZXRJZDtcblxuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRDcmVhdGlvblVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBzZG9SZXBvcnRDcmVhdGlvblNldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRWaWV3c1VVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBzZG9SZXBvcnRWaWV3c1NldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRKb2luc1VVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBzZG9SZXBvcnRKb2luc1NldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwic2RvUmVwb3J0TXVsdGlwbGVcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXBvcnRDcmVhdGlvblVVSURcIjogc2RvUmVwb3J0Q3JlYXRpb25VVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXBvcnRWaWV3c1VVSURcIjogc2RvUmVwb3J0Vmlld3NVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXBvcnRKb2luc1VVSURcIjogc2RvUmVwb3J0Sm9pbnNVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IGFwcC5TQ09QRS53b3JrZmxvdy5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdzZG9SZXBvcnRNdWx0aXBsZSBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBzdWJwcm9maWxlUXVhcnRlcmx5UmVwb3J0OiBmdW5jdGlvbihzdWJwcm9maWxlUXVhcnRlcmx5UmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJleGVjdXRlUmVwb3J0XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNjaGVkdWxlUmVwb3J0SW5kaWNhdG9yID0gc3VicHJvZmlsZVF1YXJ0ZXJseVJlcG9ydC5zY2hlZHVsZVJlcG9ydEluZGljYXRvcjtcbiAgICAgICAgICAgICAgICB2YXIgc2NoZWR1bGVSZXBvcnRJbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgc2NoZWR1bGVSZXBvcnRJbmRpY2F0b3IgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRBcHByb3ZhbEluZGljYXRvciA9IHN1YnByb2ZpbGVRdWFydGVybHlSZXBvcnQuc2RvUmVwb3J0QXBwcm92YWxJbmRpY2F0b3I7XG4gICAgICAgICAgICAgICAgdmFyIHNkb1JlcG9ydEFwcHJvdmFsSW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIHNkb1JlcG9ydEFwcHJvdmFsSW5kaWNhdG9yICsgXCInIGFuZCB3b3JrZmxvd3NbMV0vcHJvY2Vzc2VzWzFdL3N1YlByb2Nlc3NVVUlEIGVxICdcIiArIHV1aWQgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG5cblxuXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcInN1YnByb2ZpbGVRdWFydGVybHlSZXBvcnRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzY2hlZHVsZVJlcG9ydEluZGljYXRvclVVSURcIjogc2NoZWR1bGVSZXBvcnRJbmRpY2F0b3JVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXBvcnRBcHByb3ZhbEluZGljYXRvclVVSURcIjogc2RvUmVwb3J0QXBwcm92YWxJbmRpY2F0b3JVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJwcm9maWxlQ29kZVwiOiBhcHAucHJvZmlsZS5zdWJQcm9maWxlLmNvZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YnByb2ZpbGVUaXRsZVwiOiBhcHAucHJvZmlsZS5zdWJQcm9maWxlLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IGFwcC5TQ09QRS53b3JrZmxvdy5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdRdWFydGVybHlSZXBvcnQgcmVwb3J0IFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuXG4gICAgICAgIH1cblxuXG5cblxuXG4gICAgfVxuXG59KSgpO1xuXG52YXIgcGFydGljaXBhbnRzID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICBsaW5rUGFydGljaXBhbnRzOiBmdW5jdGlvbihsaW5rUGFydGljaXBhbnRzLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJmb2xsb3dcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgRVBXUExpbmtQYXJ0aWNpcGFudHNJbkJ1bGtJZCA9IGxpbmtQYXJ0aWNpcGFudHMuRVBXUExpbmtQYXJ0aWNpcGFudHNJbkJ1bGtJZDtcbiAgICAgICAgICAgICAgICB2YXIgRVBXUExpbmtQYXJ0aWNpcGFudHNJbkJ1bGtJZFVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBFUFdQTGlua1BhcnRpY2lwYW50c0luQnVsa0lkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBFUFdQTG9jYWxpdHlJZCA9IGxpbmtQYXJ0aWNpcGFudHMuRVBXUExvY2FsaXR5SWQ7XG4gICAgICAgICAgICAgICAgdmFyIEVQV1BMb2NhbGl0eUlkVVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIEVQV1BMb2NhbGl0eUlkICsgXCInXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIHZhciBFUFdQQWN0aXZlUGFydGljaXBhbnRzSWQgPSBsaW5rUGFydGljaXBhbnRzLkVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZDtcbiAgICAgICAgICAgICAgICB2YXIgRVBXUEFjdGl2ZVBhcnRpY2lwYW50c0lkVVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIEVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImxpbmtQYXJ0aWNpcGFudHNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJFUFdQTGlua1BhcnRpY2lwYW50c0luQnVsa0lkVVVJRFwiOiBFUFdQTGlua1BhcnRpY2lwYW50c0luQnVsa0lkVVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiRVBXUExvY2FsaXR5SWRVVUlEXCI6IEVQV1BMb2NhbGl0eUlkVVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiRVBXUEFjdGl2ZVBhcnRpY2lwYW50c0lkVVVJRFwiOiBFUFdQQWN0aXZlUGFydGljaXBhbnRzSWRVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRVBXUExpbmtQYXJ0aWNpcGFudHMgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgbW9udGhseUF0dGVuZGFuY2U6IGZ1bmN0aW9uKG1vbnRobHlBdHRlbmRhbmNlLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJmb2xsb3dcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgRVBXUE1vbnRobHlBdHRlbmRhbmNlQnVsa1VwbG9hZElkID0gbW9udGhseUF0dGVuZGFuY2UuRVBXUE1vbnRobHlBdHRlbmRhbmNlQnVsa1VwbG9hZFVVSUQ7XG4gICAgICAgICAgICAgICAgdmFyIEVQV1BNb250aGx5QXR0ZW5kYW5jZUJ1bGtVcGxvYWRVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgRVBXUE1vbnRobHlBdHRlbmRhbmNlQnVsa1VwbG9hZElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIEVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZCA9IG1vbnRobHlBdHRlbmRhbmNlLkVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZFVVSUQ7XG4gICAgICAgICAgICAgICAgdmFyIEVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZFVVSUQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyBFUFdQQWN0aXZlUGFydGljaXBhbnRzSWQgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIEVQV1BNb250aGx5RW1wbG95bWVudFBlckxvY2FsaXR5SWQgPSBtb250aGx5QXR0ZW5kYW5jZS5FUFdQTW9udGhseUVtcGxveW1lbnRQZXJMb2NhbGl0eVVVSUQ7XG4gICAgICAgICAgICAgICAgdmFyIEVQV1BNb250aGx5RW1wbG95bWVudFBlckxvY2FsaXR5VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIEVQV1BNb250aGx5RW1wbG95bWVudFBlckxvY2FsaXR5SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG5cblxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJtb250aGx5QXR0ZW5kYW5jZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIkVQV1BNb250aGx5QXR0ZW5kYW5jZUJ1bGtVcGxvYWRVVUlEXCI6IEVQV1BNb250aGx5QXR0ZW5kYW5jZUJ1bGtVcGxvYWRVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJFUFdQQWN0aXZlUGFydGljaXBhbnRzSWRVVUlEXCI6IEVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZFVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkVQV1BNb250aGx5RW1wbG95bWVudFBlckxvY2FsaXR5VVVJRFwiOiBFUFdQTW9udGhseUVtcGxveW1lbnRQZXJMb2NhbGl0eVVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbElkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdtb250aGx5QXR0ZW5kYW5jZSBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBtb250aGx5UHJvZ3Jlc3NTdW1tYXJ5OiBmdW5jdGlvbihtb250aGx5UHJvZ3Jlc3NTdW1tYXJ5LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJmb2xsb3dcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgRVBXUE1vbnRobHlQcm9ncmVzc1N1bW1hcnlJZCA9IG1vbnRobHlQcm9ncmVzc1N1bW1hcnkuRVBXUE1vbnRobHlQcm9ncmVzc1N1bW1hcnlJZFVVSUQ7XG4gICAgICAgICAgICAgICAgdmFyIEVQV1BNb250aGx5UHJvZ3Jlc3NTdW1tYXJ5SWRVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgRVBXUE1vbnRobHlQcm9ncmVzc1N1bW1hcnlJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcblxuXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcIm1vbnRobHlQcm9ncmVzc1N1bW1hcnlcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJFUFdQTW9udGhseVByb2dyZXNzU3VtbWFyeUlkVVVJRFwiOiBFUFdQTW9udGhseVByb2dyZXNzU3VtbWFyeUlkVVVJRCxcblxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnbW9udGhseUF0dGVuZGFuY2UgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgcGFydGljaXBhbnRDb250cmFjdHM6IGZ1bmN0aW9uKHBhcnRpY2lwYW50Q29udHJhY3RzLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJmb2xsb3dcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgRVBXUFBhcnRpY2lwYW50Q29udHJhY3RzSWQgPSBwYXJ0aWNpcGFudENvbnRyYWN0cy5FUFdQUGFydGljaXBhbnRDb250cmFjdHNJZFVVSUQ7XG4gICAgICAgICAgICAgICAgdmFyIEVQV1BQYXJ0aWNpcGFudENvbnRyYWN0c0lkVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIEVQV1BQYXJ0aWNpcGFudENvbnRyYWN0c0lkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwicGFydGljaXBhbnRDb250cmFjdHNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJFUFdQUGFydGljaXBhbnRDb250cmFjdHNJZFVVSURcIjogRVBXUFBhcnRpY2lwYW50Q29udHJhY3RzSWRVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdwYXJ0aWNpcGFudENvbnRyYWN0cyBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBnZW5lcmljTGlua1BhcnRpY2lwYW50czogZnVuY3Rpb24oZ2VuZXJpY0xpbmtQYXJ0aWNpcGFudHMsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuXG52YXIgd29ya2VyID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICBnZXRXb3JrZXJXcmFwcGVyOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgdmFyIHdyYXBwZXIgPSB7XG4gICAgICAgICAgICAgICAgXCJzb3VyY2VcIjogXCJyZW1vdGVcIixcbiAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJ3b3JrZXJPYmplY3RcIixcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwiY2hhbm5lbHNcIjogW1wid29ya2VyT2JqZWN0XCJdLFxuICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcIm1lc3NhZ2VUeXBlXCI6IFwiaW5mb1wiLFxuICAgICAgICAgICAgICAgIFwiY3JlYXRlZERhdGVUaW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgXCJzZW5kZXJVc2VySWRcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcInN1YlByb2ZpbGVJZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwicGFyZW50VHJhbnNhY3Rpb25JZFwiOiAoYXBwLlNDT1BFLnR4biA9PSB1bmRlZmluZWQgPyBcIlwiIDogYXBwLlNDT1BFLnR4bi50cmFuc2FjdGlvbklkKSxcbiAgICAgICAgICAgICAgICBcImFjdGlvblwiOiB7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHJldHVybiB3cmFwcGVyO1xuXG4gICAgICAgIH0sXG4gICAgICAgIHNlbmQ6IGZ1bmN0aW9uKHdvcmtlck9iamVjdCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU3VibWl0dGluZyBXb3JrZXIgT2JqZWN0IHRvIHNlcnZlcicpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHdvcmtlck9iamVjdCk7XG4gICAgICAgICAgICAgICAgZGFvLnNhdmUod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUod29ya2VyUmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRXJyb3Igc3VibWl0dGluZyB3b3JrZXIgcmVzcG9uc2UgISEnICsgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBzZW5kV29ya2VyOiBmdW5jdGlvbih3b3JrZXJDb25maWcsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcInNlbmRXb3JrZXJcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG4gICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NHZXROb2RlVmFsdWUgPSBmdW5jdGlvbihwYXJhbUJsb2NrLCBzZXEsIHBhcmFtTmFtZSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXMsIHJlaikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKHBhcmFtQmxvY2ssIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGFWYWx1ZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogc2VxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtTmFtZVwiOiBwYXJhbU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YVZhbHVlXCI6IGRhdGFWYWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzUGFyYW1zID0gZnVuY3Rpb24oY29uZmlnUGFyYW0pIHtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzLCByZWopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbWV0ZXJzQXJyYXkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtc1RvUHJvY2VzcyA9IGNvbmZpZ1BhcmFtLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29uZmlnUGFyYW0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1CbG9jayA9IGNvbmZpZ1BhcmFtW2ldLnBhcmFtZXRlclZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSBjb25maWdQYXJhbVtpXS5zZXE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtTmFtZSA9IGNvbmZpZ1BhcmFtW2ldLnBhcmFtZXRlck5hbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1WYWx1ZSA9IHByb2Nlc3NHZXROb2RlVmFsdWUocGFyYW1CbG9jaywgc2VxLCBwYXJhbU5hbWUpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzQXJyYXkucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiByZXNwb25zZS5zZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtTmFtZVwiOiByZXNwb25zZS5wYXJhbU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtVmFsdWVcIjogcmVzcG9uc2UuZGF0YVZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNUb1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1zVG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBpdGVtc1RvUHJvY2VzcyArIDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogXCJjb21tdW5pdHlJZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1WYWx1ZVwiOiBfV0ZJbnN0YW5jZS5jb21tdW5pdHlJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBpdGVtc1RvUHJvY2VzcyArIDIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogXCJhcHBsaWNhdGlvbklkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbVZhbHVlXCI6IF9XRkluc3RhbmNlLmFwcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBpdGVtc1RvUHJvY2VzcyArIDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogXCJwcm9maWxlSWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtVmFsdWVcIjogX1dGSW5zdGFuY2UucHJvZmlsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBpdGVtc1RvUHJvY2VzcyArIDQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogXCJzdWJQcm9jZXNzVVVJRFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1WYWx1ZVwiOiB1dWlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzKHBhcmFtZXRlcnNBcnJheSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNUb1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1zVG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBpdGVtc1RvUHJvY2VzcyArIDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogXCJjb21tdW5pdHlJZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1WYWx1ZVwiOiBfV0ZJbnN0YW5jZS5jb21tdW5pdHlJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBpdGVtc1RvUHJvY2VzcyArIDIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogXCJhcHBsaWNhdGlvbklkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbVZhbHVlXCI6IF9XRkluc3RhbmNlLmFwcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBpdGVtc1RvUHJvY2VzcyArIDMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogXCJwcm9maWxlSWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtVmFsdWVcIjogX1dGSW5zdGFuY2UucHJvZmlsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBpdGVtc1RvUHJvY2VzcyArIDQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogXCJzdWJQcm9jZXNzVVVJRFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1WYWx1ZVwiOiB1dWlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzKHBhcmFtZXRlcnNBcnJheSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHZhciB0eXBlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAod29ya2VyQ29uZmlnLnJlc3QgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbmZpZ1BhcmFtID0gd29ya2VyQ29uZmlnLnJlc3QucGFyYW1ldGVycztcbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc1BhcmFtcyhjb25maWdQYXJhbSkudGhlbihmdW5jdGlvbihwYXJhbXNBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlbmRXb3JrZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJlc3RcIjoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLnNlbmRXb3JrZXIucmVzdC51cmkgPSB3b3JrZXJDb25maWcucmVzdC51cmk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24uc2VuZFdvcmtlci5yZXN0LnByb2ZpbElkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5zZW5kV29ya2VyLnJlc3QucGFyYW1ldGVycyA9IHBhcmFtc0FycmF5O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3BPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3Quc3BTdGF0dXMgPSAnc3VibWl0dGVkJztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzcE9iamVjdC5tZXNzYWdlcyA9PSB1bmRlZmluZWQpIHsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwT2JqZWN0Lm1lc3NhZ2VzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwZW5kaW5nU3VibWlzc2lvbk9iamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaTE4blwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfaWRcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImVuXCI6IFwiVGhlIHNlcnZlciBpcyBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4gUGxlYXNlIHdhaXQgYSBmZXcgc2Vjb25kcyBhbmQgdGhlbiBjbGljayB0aGUgcmVmcmVzaCBidXR0b24uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwdFwiOiBcIlRoZSBzZXJ2ZXIgaXMgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuIFBsZWFzZSB3YWl0IGEgZmV3IHNlY29uZHMgYW5kIHRoZW4gY2xpY2sgdGhlIHJlZnJlc2ggYnV0dG9uLlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcImluZm9cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3QubWVzc2FnZXMucHVzaChwZW5kaW5nU3VibWlzc2lvbk9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd29ya2VyIGlkIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3BPYmplY3Qud29ya2VycyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3Qud29ya2VycyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcE9iamVjdC53b3JrZXJzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIndvcmtlcklkXCI6IHdvcmtlck9iamVjdC5faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0ZVRpbWVcIjogbW9tZW50KCkuZm9ybWF0KClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3REYXRhKCdzdWJwcm9jZXNzZXMnLCBhcHAuU0NPUEUud29ya2Zsb3csIHV1aWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHNhdmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrZXIgUmVzdCBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihmYWlsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdXb3JrZXIgc3VibWl0dGVkIHN1YnByb2Nlc3MgZmlsZSB1cGRhdGUgZmFpbGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZmFpbGVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdXb3JrZXIgZmFpbGVkICcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJwYXJhbWV0ZXIgY3JlYXRpb24gZmFpbGVkLiBBYm9yZGluZyB3b3JrZXIgb2JqZWN0XCIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAod29ya2VyQ29uZmlnLmZ1bmN0aW9uYWwgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbmZpZ1BhcmFtID0gd29ya2VyQ29uZmlnLmZ1bmN0aW9uYWwucGFyYW1ldGVycztcbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc1BhcmFtcyhjb25maWdQYXJhbSkudGhlbihmdW5jdGlvbihwYXJhbXNBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlbmRXb3JrZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZ1bmN0aW9uYWxcIjoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLnNlbmRXb3JrZXIuZnVuY3Rpb25hbC5tZXRob2ROYW1lID0gd29ya2VyQ29uZmlnLmZ1bmN0aW9uYWwubWV0aG9kTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5zZW5kV29ya2VyLmZ1bmN0aW9uYWwucHJvZmlsSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLnNlbmRXb3JrZXIuZnVuY3Rpb25hbC5wYXJhbWV0ZXJzID0gcGFyYW1zQXJyYXk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwT2JqZWN0LnNwU3RhdHVzID0gJ3N1Ym1pdHRlZCc7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3BPYmplY3QubWVzc2FnZXMgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwT2JqZWN0Lm1lc3NhZ2VzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwZW5kaW5nU3VibWlzc2lvbk9iamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaTE4blwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfaWRcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImVuXCI6IFwiVGhlIHNlcnZlciBpcyBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4gUGxlYXNlIHdhaXQgYSBmZXcgc2Vjb25kcyBhbmQgdGhlbiBjbGljayB0aGUgcmVmcmVzaCBidXR0b24uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwdFwiOiBcIlRoZSBzZXJ2ZXIgaXMgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuIFBsZWFzZSB3YWl0IGEgZmV3IHNlY29uZHMgYW5kIHRoZW4gY2xpY2sgdGhlIHJlZnJlc2ggYnV0dG9uLlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcImluZm9cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3QubWVzc2FnZXMucHVzaChwZW5kaW5nU3VibWlzc2lvbk9iamVjdCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3b3JrZXIgaWQgaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzcE9iamVjdC53b3JrZXJzID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcE9iamVjdC53b3JrZXJzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwT2JqZWN0LndvcmtlcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwid29ya2VySWRcIjogd29ya2VyT2JqZWN0Ll9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRlVGltZVwiOiBtb21lbnQoKS5mb3JtYXQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc2lzdERhdGEoJ3N1YnByb2Nlc3NlcycsIGFwcC5TQ09QRS53b3JrZmxvdywgdXVpZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oc2F2ZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtlciBmdW5jdGlvbmFsIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGZhaWxlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1dvcmtlciBzdWJtaXR0ZWQgc3VicHJvY2VzcyBmaWxlIHVwZGF0ZSBmYWlsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChmYWlsZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnV29ya2VyIGZhaWxlZCAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGFyYW1ldGVyIGNyZWF0aW9uIGZhaWxlZC4gQWJvcmRpbmcgd29ya2VyIG9iamVjdFwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGV4ZWN1dGVMb2NhbDogZnVuY3Rpb24od29ya2VyQ29uZmlnLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblxuXG4gICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NHZXROb2RlVmFsdWUgPSBmdW5jdGlvbihwYXJhbUJsb2NrLCBzZXEsIGRhdGFUeXBlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlcywgcmVqKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUocGFyYW1CbG9jaywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YVZhbHVlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBzZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YVR5cGVcIjogZGF0YVR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YVZhbHVlXCI6IGRhdGFWYWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NQYXJhbXMgPSBmdW5jdGlvbihjb25maWdQYXJhbSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXMsIHJlaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtZXRlcnNBcnJheSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1zVG9Qcm9jZXNzID0gY29uZmlnUGFyYW0ubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb25maWdQYXJhbS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbUJsb2NrID0gY29uZmlnUGFyYW1baV0ucGFyYW1ldGVyVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlcSA9IGNvbmZpZ1BhcmFtW2ldLnNlcTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YVR5cGUgPSBjb25maWdQYXJhbVtpXS5kYXRhVHlwZS5kYXRhVHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1WYWx1ZSA9IHByb2Nlc3NHZXROb2RlVmFsdWUocGFyYW1CbG9jaywgc2VxLCBkYXRhVHlwZSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IHJlc3BvbnNlLnNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YVR5cGVcIjogcmVzcG9uc2UuZGF0YVR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtVmFsdWVcIjogcmVzcG9uc2UuZGF0YVZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNUb1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1zVG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyhwYXJhbWV0ZXJzQXJyYXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zVG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtc1RvUHJvY2VzcyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMocGFyYW1ldGVyc0FycmF5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIGZpeFBhcmFtVHlwZSA9IGZ1bmN0aW9uKHBhcmFtVmFsdWUsIGRhdGFUeXBlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChkYXRhVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInN0cmluZ1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eHQgPSBwYXJhbVZhbHVlLnJlcGxhY2UoLycvZywgXCJcXFxcJ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJcIiArIHR4dCArIFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZGF0ZVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImRhdGVUaW1lXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiXCIgKyBwYXJhbVZhbHVlICsgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJudW1iZXJcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJkZWNpbWFsXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcmFtVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIG1ldGhvZE5hbWUgPSB3b3JrZXJDb25maWcubWV0aG9kTmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgY29uZmlnUGFyYW0gPSB3b3JrZXJDb25maWcucGFyYW1ldGVycztcbiAgICAgICAgICAgICAgICBwcm9jZXNzUGFyYW1zKGNvbmZpZ1BhcmFtKS50aGVuKGZ1bmN0aW9uKHBhcmFtc0FycmF5KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHBMaXN0ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFyYW1zQXJyYXkubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwTGlzdCA9IHBMaXN0ICsgZml4UGFyYW1UeXBlKHBhcmFtc0FycmF5W2ldLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5W2ldLmRhdGFUeXBlKSArICcsJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBwTGlzdCA9IHBMaXN0ICsgZml4UGFyYW1UeXBlKHBhcmFtc0FycmF5W2ldLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5W2ldLmRhdGFUeXBlKVxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjYWxsYmFja1N1Y2Nlc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlKFwiRnVuY3Rpb24gJ1wiICsgbWV0aG9kTmFtZSArIFwiJyBleGVjdXRlZC4gUmVzcG9uc2Ugc3VjY2Vzcy5cIik7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZhciBjYWxsYmFja0ZhaWx1cmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QoXCJGdW5jdGlvbiAnXCIgKyBtZXRob2ROYW1lICsgXCInIGV4ZWN1dGVkLiBSZXNwb25zZSBmYWlsZWQuXCIpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3BVVUlEID0gXCJcIiArIHV1aWQgKyBcIlwiXG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciBmdW5jID0gbWV0aG9kTmFtZSArICcoJyArIHBMaXN0ICsgJyxjYWxsYmFja1N1Y2Nlc3MsIGNhbGxiYWNrRmFpbHVyZSwnICsgc3BVVUlEICsgJyknO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkdvaW5nIHRvIGV4ZWN1dGUgPT0gXCIgKyBtZXRob2ROYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgaWYocGFyYW1zQXJyYXkubGVuZ3RoID09IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgKChldmFsKG1ldGhvZE5hbWUpKShjYWxsYmFja1N1Y2Nlc3MsIGNhbGxiYWNrRmFpbHVyZSwgc3BVVUlEKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihwYXJhbXNBcnJheS5sZW5ndGggPT0gMSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAoKGV2YWwobWV0aG9kTmFtZSkpKHBhcmFtc0FycmF5WzBdLnBhcmFtVmFsdWUsIGNhbGxiYWNrU3VjY2VzcywgY2FsbGJhY2tGYWlsdXJlLCBzcFVVSUQpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHBhcmFtc0FycmF5Lmxlbmd0aCA9PSAyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICgoZXZhbChtZXRob2ROYW1lKSkocGFyYW1zQXJyYXlbMF0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbMV0ucGFyYW1WYWx1ZSwgY2FsbGJhY2tTdWNjZXNzLCBjYWxsYmFja0ZhaWx1cmUsIHNwVVVJRCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYocGFyYW1zQXJyYXkubGVuZ3RoID09IDMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgKChldmFsKG1ldGhvZE5hbWUpKShwYXJhbXNBcnJheVswXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVsxXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVsyXS5wYXJhbVZhbHVlLCBjYWxsYmFja1N1Y2Nlc3MsIGNhbGxiYWNrRmFpbHVyZSwgc3BVVUlEKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihwYXJhbXNBcnJheS5sZW5ndGggPT0gNCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAoKGV2YWwobWV0aG9kTmFtZSkpKHBhcmFtc0FycmF5WzBdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzFdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzJdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzNdLnBhcmFtVmFsdWUsIGNhbGxiYWNrU3VjY2VzcywgY2FsbGJhY2tGYWlsdXJlLCBzcFVVSUQpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHBhcmFtc0FycmF5Lmxlbmd0aCA9PSA1KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICgoZXZhbChtZXRob2ROYW1lKSkocGFyYW1zQXJyYXlbMF0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbMV0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbMl0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbM10ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbNF0ucGFyYW1WYWx1ZSwgY2FsbGJhY2tTdWNjZXNzLCBjYWxsYmFja0ZhaWx1cmUsIHNwVVVJRCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYocGFyYW1zQXJyYXkubGVuZ3RoID09IDYpe1xuICAgICAgICAgICAgICAgICAgICAgICAgKChldmFsKG1ldGhvZE5hbWUpKShwYXJhbXNBcnJheVswXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVsxXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVsyXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVszXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVs0XS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVs1XS5wYXJhbVZhbHVlLCBjYWxsYmFja1N1Y2Nlc3MsIGNhbGxiYWNrRmFpbHVyZSwgc3BVVUlEKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihwYXJhbXNBcnJheS5sZW5ndGggPT0gNyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAoKGV2YWwobWV0aG9kTmFtZSkpKHBhcmFtc0FycmF5WzBdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzFdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzJdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzNdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzRdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzVdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzZdLnBhcmFtVmFsdWUsIGNhbGxiYWNrU3VjY2VzcywgY2FsbGJhY2tGYWlsdXJlLCBzcFVVSUQpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHBhcmFtc0FycmF5Lmxlbmd0aCA9PSA4KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICgoZXZhbChtZXRob2ROYW1lKSkocGFyYW1zQXJyYXlbMF0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbMV0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbMl0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbM10ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbNF0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbNV0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbNl0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbN10ucGFyYW1WYWx1ZSwgY2FsbGJhY2tTdWNjZXNzLCBjYWxsYmFja0ZhaWx1cmUsIHNwVVVJRCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vcmVzb2x2ZShcIkxvY2FsIGZ1bmN0aW9uIGV4ZWN1dGVkXCIpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGFyYW1ldGVyIGNyZWF0aW9uIGZhaWxlZC4gQWJvcmRpbmcgd29ya2VyIG9iamVjdFwiKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG5cblxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHNldFdvcmtlckluZm9JblN1YnByb2Nlc3M6IGZ1bmN0aW9uKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpIHtcblxuICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgcGVuZGluZ1N1Ym1pc3Npb25PYmplY3QgPSB7XG4gICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgXCJpMThuXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiX2lkXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImVuXCI6IFwiVGhlIHNlcnZlciBpcyBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4gUGxlYXNlIHdhaXQgYSBmZXcgc2Vjb25kcyBhbmQgdGhlbiBjbGljayB0aGUgcmVmcmVzaCBidXR0b24uXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInB0XCI6IFwiTyBzZXJ2aWRvciBlc3TDoSBwcm9jZXNzYW5kbyBzdWEgc29saWNpdGHDp8Ojby4gUG9yIGZhdm9yIGFndWFyZGUgYWxndW5zIHNlZ3VuZG9zIGUgZGVwb2lzIGNsaXF1ZSBubyBib3TDo28gYXR1YWxpemFyLlwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcImluZm9cIlxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHN1YnByb2Nlc3NPYmplY3QubWVzc2FnZXMgPSBbXTtcbiAgICAgICAgICAgIHN1YnByb2Nlc3NPYmplY3QubWVzc2FnZXMucHVzaChwZW5kaW5nU3VibWlzc2lvbk9iamVjdCk7XG5cbiAgICAgICAgICAgIGlmIChzdWJwcm9jZXNzT2JqZWN0LndvcmtlcnMgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc3VicHJvY2Vzc09iamVjdC53b3JrZXJzID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzdWJwcm9jZXNzT2JqZWN0LndvcmtlcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgXCJ3b3JrZXJJZFwiOiB3b3JrZXJPYmplY3QuX2lkLFxuICAgICAgICAgICAgICAgIFwiZGF0ZVRpbWVcIjogbW9tZW50KCkuZm9ybWF0KClcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgfSxcblxuXG4gICAgICAgIGNyZWF0ZTogZnVuY3Rpb24od29ya2VyQ29uZmlnLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hhbm5lbCA9IHdvcmtlckNvbmZpZy5jaGFubmVsO1xuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJBY3Rpb24gPSB3b3JrZXJDb25maWcuYWN0aW9uO1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKGNoYW5uZWwpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcblxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgYWN0aW9uW3dvcmtlckFjdGlvbl0gPSB7fTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd29ya2VyQ29uZmlnLmluZGljYXRvcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gd29ya2VyQ29uZmlnLmluZGljYXRvcnNbaV0ubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZXRJZCA9IHdvcmtlckNvbmZpZy5pbmRpY2F0b3JzW2ldLnNldElkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IHdvcmtlckNvbmZpZy5pbmRpY2F0b3JzW2ldLmNvbnRleHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gXCJcIjtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoY29udGV4dCA9PSAnc3ViUHJvY2VzcycgfHwgY29udGV4dCA9PSAnY3VycmVudFN1YlByb2Nlc3NJbnN0YW5jZScgfHwgY29udGV4dCA9PSAnY3VycmVudFN1YlByb2Nlc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2lkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgc2V0SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBzZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoaWQgPT0gdW5kZWZpbmVkKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzcG9SZWYgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2p1c3QgdG8gbWFrZSBzdXJlIHRoaXMgaXMgbm90IHRoZSBjYXNlIHdoZXJlIGluZGljYXRvcnMgYXJlIG5vdCBwb3B1bGF0ZWQgZHVlIHRvIHNvbWUgb3RoZXIgcmVhc29uLCBub3cgd2UgY2FuIHNlYXJjaCBpbiBnbG9iYWwgaW5kaWNhdG9yIGFycmF5IGZvciByZWZlcmVuY2UgaW5kaWNhdG9yIGNhc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzcG9SZWYgIT0gdW5kZWZpbmVkICYmIHNwb1JlZi5pbmRpY2F0b3JzLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIHNldElkICsgXCInXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyBzZXRJZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25bd29ya2VyQWN0aW9uXVtsYWJlbF0gPSBpZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhY3Rpb25bd29ya2VyQWN0aW9uXS5wcm9maWxJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG5cbiAgICAgICAgICAgICAgICBpZiAod29ya2VyQ29uZmlnLmZpeGVkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHdvcmtlckNvbmZpZy5maXhlZC5sZW5ndGg7IGkrKykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gd29ya2VyQ29uZmlnLmZpeGVkW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IE9iamVjdC5rZXlzKG9iailbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25bd29ya2VyQWN0aW9uXVtrZXldID0gb2JqW2tleV1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh3b3JrZXJDb25maWcuZGF0YUZpZWxkcyAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uW3dvcmtlckFjdGlvbl0uZGF0YUZpZWxkcyA9IHdvcmtlckNvbmZpZy5kYXRhRmllbGRzO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2Vzcyh3b3JrZXJBY3Rpb24gKyAnIHdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cblxuXG5cblxuXG5cblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgIH1cblxufSkoKTtcblxudmFyIHVzZXIgPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAgIGFkZFRvUm9sZTogZnVuY3Rpb24oYWRkVG9Sb2xlLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShhZGRUb1JvbGUudXNlck5hbWUsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHVzZXJEaXNwbGF5TmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGFkZFRvUm9sZS51c2VySWQsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHVzZXJJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShhZGRUb1JvbGUucm9sZUlkLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyb2xlSWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiB1c2VyRGlzcGxheU5hbWUgIT0gJ3N0cmluZycgJiYgdHlwZW9mIHVzZXJJZCAhPSAnc3RyaW5nJyAmJiBBcnJheS5pc0FycmF5KFt1c2VyRGlzcGxheU5hbWVdKSAmJiBBcnJheS5pc0FycmF5KFt1c2VySWRdKSl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mIHJvbGVJZCAhPSAnc3RyaW5nJyAmJiBBcnJheS5pc0FycmF5KFtyb2xlSWRdKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih1c2VyRGlzcGxheU5hbWUubGVuZ3RoICE9IHVzZXJJZC5sZW5ndGggfHwgdXNlcklkLmxlbmd0aCAhPSByb2xlSWQubGVuZ3RoKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3Qoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlzRXJyb3JcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IFwiQ29uZmlnIGlzc3VlIGluIHJvbGUgYXNzaWdubWVudCBhY3Rpb24uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWduUm9sZSA9IGZ1bmN0aW9uKHUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih1c2VyRGlzcGxheU5hbWUubGVuZ3RoID09IHUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1JvbGUgYXNzaWdubWVudCBjb21wbGV0ZScsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihyb2xlSWRbdV0gPT0gdW5kZWZpbmVkIHx8IHJvbGVJZFt1XSA9PSBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCB1c2VySWRbdV0gPT0gdW5kZWZpbmVkIHx8IHVzZXJJZFt1XSA9PSBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCB1c2VyRGlzcGxheU5hbWVbdV0gPT0gdW5kZWZpbmVkIHx8IHVzZXJEaXNwbGF5TmFtZVt1XSA9PSBcIlwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25Sb2xlKHUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRleHRUeXBlID0gSlNPTi54cGF0aChcIi9yb2xlc1tpZCBlcSAnXCIgKyByb2xlSWRbdV0gKyBcIiddL3R5cGVcIiwgYXBwLlNDT1BFLkFQUF9DT05GSUcsIHt9KVswXVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGV4dFR5cGUgPT0gJ2luc3RhbmNlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvbGVzTWFuYWdlci5kb1VzZXJSZWdpc3RyYXRpb24odXNlcklkW3VdLCB1c2VyRGlzcGxheU5hbWVbdV0sIHJvbGVJZFt1XSwgJ2luc3RhbmNlJykudGhlbihmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnblJvbGUodSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25Sb2xlKHUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGV4dFR5cGUgPT0gJ3N1YnByb2ZpbGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9sZXNNYW5hZ2VyLmRvVXNlclJlZ2lzdHJhdGlvbl9ub2RlKHVzZXJJZFt1XSwgdXNlckRpc3BsYXlOYW1lW3VdLCByb2xlSWRbdV0sICdzdWJwcm9maWxlJykudGhlbihmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnblJvbGUodSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25Sb2xlKHUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGV4dFR5cGUgPT0gJ2Fkb3B0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvbGVzTWFuYWdlci5kb1VzZXJSZWdpc3RyYXRpb25fYWRvcHRpb24odXNlcklkW3VdLCB1c2VyRGlzcGxheU5hbWVbdV0sIHJvbGVJZFt1XSwgJ2Fkb3B0aW9uJykudGhlbihmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnblJvbGUodSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25Sb2xlKHUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduUm9sZSh1ICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduUm9sZSgwKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25Sb2xlID0gZnVuY3Rpb24odSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodXNlckRpc3BsYXlOYW1lLmxlbmd0aCA9PSB1KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1JvbGUgYXNzaWdubWVudCBjb21wbGV0ZScsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihyb2xlSWQgPT0gdW5kZWZpbmVkIHx8IHJvbGVJZCA9PSBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCB1c2VySWRbdV0gPT0gdW5kZWZpbmVkIHx8IHVzZXJJZFt1XSA9PSBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCB1c2VyRGlzcGxheU5hbWVbdV0gPT0gdW5kZWZpbmVkIHx8IHVzZXJEaXNwbGF5TmFtZVt1XSA9PSBcIlwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25Sb2xlKHUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRleHRUeXBlID0gSlNPTi54cGF0aChcIi9yb2xlc1tpZCBlcSAnXCIgKyByb2xlSWQgKyBcIiddL3R5cGVcIiwgYXBwLlNDT1BFLkFQUF9DT05GSUcsIHt9KVswXVxuICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRleHRUeXBlID09ICdpbnN0YW5jZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvbGVzTWFuYWdlci5kb1VzZXJSZWdpc3RyYXRpb24odXNlcklkW3VdLCB1c2VyRGlzcGxheU5hbWVbdV0sIHJvbGVJZCwgJ2luc3RhbmNlJykudGhlbihmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduUm9sZSh1ICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25Sb2xlKHUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHRUeXBlID09ICdzdWJwcm9maWxlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9sZXNNYW5hZ2VyLmRvVXNlclJlZ2lzdHJhdGlvbl9ub2RlKHVzZXJJZFt1XSwgdXNlckRpc3BsYXlOYW1lW3VdLCByb2xlSWQsICdzdWJwcm9maWxlJykudGhlbihmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduUm9sZSh1ICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25Sb2xlKHUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHRUeXBlID09ICdhZG9wdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvbGVzTWFuYWdlci5kb1VzZXJSZWdpc3RyYXRpb25fYWRvcHRpb24odXNlcklkW3VdLCB1c2VyRGlzcGxheU5hbWVbdV0sIHJvbGVJZCwgJ2Fkb3B0aW9uJykudGhlbihmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduUm9sZSh1ICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25Sb2xlKHUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduUm9sZSh1ICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnblJvbGUoMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRleHRUeXBlID0gSlNPTi54cGF0aChcIi9yb2xlc1tpZCBlcSAnXCIgKyByb2xlSWQgKyBcIiddL3R5cGVcIiwgYXBwLlNDT1BFLkFQUF9DT05GSUcsIHt9KVswXVxuICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRleHRUeXBlID09ICdpbnN0YW5jZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvbGVzTWFuYWdlci5kb1VzZXJSZWdpc3RyYXRpb24odXNlcklkLCB1c2VyRGlzcGxheU5hbWUsIHJvbGVJZCwgJ2luc3RhbmNlJykudGhlbihmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1JvbGUgYXNzaWduZWQgdG8gdXNlciBpbiBjb250ZXh0IGluc3RhbmNlJywgcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyb2xlc01hbmFnZXItIGluc3RhbmNlIGZhaWwnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyb2xlIHVwZGF0ZSBmYWlsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHRUeXBlID09ICdzdWJwcm9maWxlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9sZXNNYW5hZ2VyLmRvVXNlclJlZ2lzdHJhdGlvbl9ub2RlKHVzZXJJZCwgdXNlckRpc3BsYXlOYW1lLCByb2xlSWQsICdzdWJwcm9maWxlJykudGhlbihmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1JvbGUgYXNzaWduZWQgdG8gdXNlciBpbiBjb250ZXh0IHN1YnByb2ZpbGUnLCBzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JvbGVzTWFuYWdlci0gc3VicHJvZmlsZSBmYWlsJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncm9sZSB1cGRhdGUgZmFpbGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb250ZXh0VHlwZSA9PSAnYWRvcHRpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb2xlc01hbmFnZXIuZG9Vc2VyUmVnaXN0cmF0aW9uX2Fkb3B0aW9uKHVzZXJJZCwgdXNlckRpc3BsYXlOYW1lLCByb2xlSWQsICdhZG9wdGlvbicpLnRoZW4oZnVuY3Rpb24ocykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdSb2xlIGFzc2lnbmVkIHRvIHVzZXIgaW4gY29udGV4dCBhZG9wdGlvbicsIHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncm9sZXNNYW5hZ2VyLSBhZG9wdGlvbiBmYWlsJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncm9sZSB1cGRhdGUgZmFpbGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSb2xlIG5vdCBmb3VuZCBpbiBhbnkgY29udGV4dCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdSb2xlIG5vdCBmb3VuZCBpbiBhbnkgY29udGV4dCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuXG52YXIgZ2VuZXJhbEZ1bmN0aW9ucyA9IChmdW5jdGlvbigpe1xuICAgIHJldHVybiB7XG4gICAgICAgIGFkZFRvRmF2b3VyaXRlczogZnVuY3Rpb24oZmF2QmxvY2ssIF9XRkluc3RhbmNlLCB1dWlkKXtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIHZhciBjb250ZXh0ID0gZmF2QmxvY2suY29udGV4dDtcbiAgICAgICAgICAgICAgICBpZihjb250ZXh0ID09IFwicHJvZmlsZVwiKXtcbiAgICAgICAgICAgICAgICAgICAgbGlicmFyeS5hZGRUb0Zhdm91cml0ZXNQcm9maWxlKCkudGhlbihmdW5jdGlvbihzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocyk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoY29udGV4dCA9PSBcInN1YnByb2ZpbGVcIil7XG4gICAgICAgICAgICAgICAgICAgIGxpYnJhcnkuYWRkVG9GYXZvdXJpdGVzU3ViUHJvZmlsZSgpLnRoZW4oZnVuY3Rpb24ocyl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHMpO1xuICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmKGNvbnRleHQgPT0gXCJzdWJwcm9jZXNzXCIpe1xuICAgICAgICAgICAgICAgICAgICBsaWJyYXJ5LmFkZFRvRmF2b3VyaXRlc1N1YlByb2Nlc3ModXVpZCkudGhlbihmdW5jdGlvbihzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocyk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGFkZFRvVXNlckZhdm91cml0ZXM6IGZ1bmN0aW9uKGZhdkJsb2NrLCBfV0ZJbnN0YW5jZSwgdXVpZCl7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IGZhdkJsb2NrLmNvbnRleHQ7XG4gICAgICAgICAgICAgICAgdmFyIHVzZXJCbG9jayA9IGZhdkJsb2NrLnVzZXI7XG4gICAgICAgICAgICAgICAgLy8gZ2V0IHVzZXJJZCBmcm9tIGdldCBub2RlIHZhbHVlIFxuICAgICAgICAgICAgICAgIC8vcGFzcyB0byBzb21lIG5ldyBmdW5jdGlvbnNcblxuICAgICAgICAgICAgICAgIHZhciB1c2VySWQgPSAnJztcbiAgICAgICAgICAgICAgICBpZiAodXNlckJsb2NrLnN0ZXBBc3NpZ25lZUZyb21TdGVwICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdGVwSWQgPSB1c2VyQmxvY2suc3RlcEFzc2lnbmVlRnJvbVN0ZXAuc3RlcElkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaGlzdG9yeU9iamVjdCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgc3ViUHJvY2Vzc09iamVjdC5oaXN0b3J5Lmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHN1YlByb2Nlc3NPYmplY3QuaGlzdG9yeVtpXS5pZCA9PSBzdGVwSWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpc3RvcnlPYmplY3QgPSBzdWJQcm9jZXNzT2JqZWN0Lmhpc3RvcnlbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmKGhpc3RvcnlPYmplY3QuYXNzaWdubWVudEhpc3RvcnkgIT0gdW5kZWZpbmVkICYmIGhpc3RvcnlPYmplY3QuYXNzaWdubWVudEhpc3RvcnkubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gaGlzdG9yeU9iamVjdC5hc3NpZ25tZW50SGlzdG9yeVtoaXN0b3J5T2JqZWN0LmFzc2lnbm1lbnRIaXN0b3J5Lmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlcklkID0gb2JqLnVzZXJJZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh1c2VyQmxvY2suaW5kaWNhdG9yICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0SWQgPSB1c2VyQmxvY2suaW5kaWNhdG9yLmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudElkID0gdXNlckJsb2NrLmluZGljYXRvci5lbGVtZW50SWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgaW5kaWNhdG9yU2V0SWQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvbW9kZWwvcGVuZGluZy9kYXRhLycgKyBpbmRpY2F0b3JTZXRJZCArICcvJyArIGVsZW1lbnRJZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJldFZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgdXNlcklkID0gcmV0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZihjb250ZXh0ID09IFwicHJvZmlsZVwiKXtcbiAgICAgICAgICAgICAgICAgICAgbGlicmFyeS5hZGRUb0Zhdm91cml0ZXNQcm9maWxlRm9yVXNlcih1c2VySWQpLnRoZW4oZnVuY3Rpb24ocyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIldvcmtmbG93ICoqKioqKiBQcm9maWxlIERvbmVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHMpO1xuICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmKGNvbnRleHQgPT0gXCJzdWJwcm9maWxlXCIpe1xuICAgICAgICAgICAgICAgICAgICBsaWJyYXJ5LmFkZFRvRmF2b3VyaXRlc1N1YnByb2ZpbGVGb3JVc2VyKHVzZXJJZCkudGhlbihmdW5jdGlvbihzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiV29ya2Zsb3cgKioqKioqIFN1YlByb2ZpbGUgRG9uZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocyk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoY29udGV4dCA9PSBcInN1YnByb2Nlc3NcIil7XG4gICAgICAgICAgICAgICAgICAgIGxpYnJhcnkuYWRkVG9Vc2Vyc0Zhdm91cml0ZXNTdWJQcm9jZXNzRm9yVXNlcih1c2VySWQsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocyl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIldvcmtmbG93ICoqKioqKiBTdWJwcm9jZXNzIERvbmVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHMpO1xuICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufSkoKTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG5cbiAgICBjb21tdW5pdHk6IGNvbW11bml0eSxcbiAgICBhcHBsaWNhdGlvbjogYXBwbGljYXRpb24sXG4gICAgcGVyZm9ybWFuY2U6IHBlcmZvcm1hbmNlLFxuICAgIHdvcmtlcjogd29ya2VyLFxuICAgIHNkbzogc2RvLFxuICAgIHRheG9ub215OiB0YXhvbm9teSxcbiAgICBzdWJQcm9jZXNzSW5zdGFuY2U6IHN1YlByb2Nlc3NJbnN0YW5jZSxcbiAgICB2YXJpYWJsZXM6IHZhcmlhYmxlcyxcbiAgICBub3RpZmljYXRpb246IG5vdGlmaWNhdGlvbixcbiAgICByZXBvcnQ6IHJlcG9ydCxcbiAgICBwYXJ0aWNpcGFudHM6IHBhcnRpY2lwYW50cyxcbiAgICB1c2VyOiB1c2VyLFxuICAgIGdlbmVyYWxGdW5jdGlvbnM6IGdlbmVyYWxGdW5jdGlvbnNcbn0iLCIndXNlIHN0cmljdCc7XG5cbi8vdmFyIGdhdGVrZWVwZXIgPSByZXF1aXJlKCcuLi9ib3dlcl9jb21wb25lbnRzL2dhdGVrZWVwZXInKTtcbnZhciB1dGlsID0gcmVxdWlyZSgndXRpbGl0eScpO1xuXG4vLyB2YXIgdXVpZCA9IHJlcXVpcmUoJ25vZGUtdXVpZCcpO1xuXG52YXIgZ2F0ZWtlZXBlciA9IG5ldyBHSygpO1xuXG4vKipcbiAqIEZvcm0gTW9kdWxlXG4gKlxuICogQG1vZHVsZSBsaWIvZm9ybVxuICogQGF1dGhvciBCcmVudCBHb3Jkb25cbiAqIEB2ZXJzaW9uIDIuMC4wXG4gKiBAZGVzY3JpcHRpb24gdGVzdCBkZXNjcmlwdGlvblxuICogQGNvcHlyaWdodCBLd2FudHUgTHRkIFJTQSAyMDA5LTIwMTUuXG4gKlxuICovXG5cbmZ1bmN0aW9uIGNyZWF0ZShhcmdzKSB7XG5cbiAgICB2YXIgcHJvY2Vzc0lkID0gYXJnc1swXSB8fCAnJztcblxuICAgIHZhciBzdWJQcm9jZXNzID0gYXJnc1sxXSB8fCB7fTtcblxuICAgIHZhciBzdGVwID0gYXJnc1syXSB8fCB7fTtcblxuICAgIHZhciBhY3Rpb24gPSBhcmdzWzNdIHx8IHt9O1xuXG4gICAgdmFyIF9XRkluc3RhbmNlID0gYXJnc1s2XSB8fCB7fTtcblxuICAgIHZhciBkYXRhID0gYXJnc1s2XSB8fCB7fTtcblxuICAgIHZhciBpbmRpY2F0b3JzID0gc3ViUHJvY2Vzcy5pbmRpY2F0b3JzIHx8IFtdO1xuXG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuXG4gICAgdmFyIGluZGljYXRvclR5cGUgPSBhY3Rpb24uX3R5cGU7XG5cbiAgICB2YXIgcHJvY2Vzc1NlcSA9IGFyZ3NbNF0gfHwgJyc7XG5cbiAgICB2YXIgc3ViUHJvY2Vzc1NlcSA9IGFyZ3NbNV0gfHwgJyc7XG5cbiAgICB2YXIgY3JlYXRlVHlwZSA9IGFyZ3NbN10gfHwgJyc7XG5cbiAgICB2YXIgc3ViUHJvY2Vzc0lkID0gc3ViUHJvY2Vzcy5faWQ7XG5cbiAgICB2YXIgdXVpZCA9IGFyZ3NbOF0gfHwgJyc7XG5cbiAgICB2YXIgYmFzZVVVSUQgPSBhcmdzWzldIHx8ICcnO1xuXG4gICAgdmFyIHByb2ZpbGUgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuXG4gICAgdmFyIGlucHV0RGF0YSA9IGFyZ3NbMTBdIHx8IHt9O1xuXG4gICAgdmFyIGZvcm1DcmVhdGVUeXBlID0gYWN0aW9uLm1ldGhvZC5mb3JtLmNyZWF0ZTtcbiAgICBcbiAgICBpZiAoYWN0aW9uLm1ldGhvZC5mb3JtLmF1dGhvcmlzZUFuZENyZWF0ZU5ld1NlcSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgZm9ybUNyZWF0ZVR5cGUgPSBhY3Rpb24ubWV0aG9kLmZvcm0uYXV0aG9yaXNlQW5kQ3JlYXRlTmV3U2VxO1xuICAgIH0gXG4gICAgZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5mb3JtLmNyZWF0ZU5ld1NlcSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgZm9ybUNyZWF0ZVR5cGUgPSBhY3Rpb24ubWV0aG9kLmZvcm0uY3JlYXRlTmV3U2VxO1xuICAgIH1cblxuICAgIHZhciBmb3JtVHlwZSA9IGFjdGlvbi5tZXRob2QuZm9ybS50eXBlO1xuXG4gICAgdmFyIHBhcmFtT2JqZWN0ID0ge1xuXG4gICAgICAgIFwiZm9ybUNyZWF0ZVR5cGVcIjogZm9ybUNyZWF0ZVR5cGUsXG4gICAgICAgIFwiZm9ybVR5cGVcIjogZm9ybVR5cGVcblxuICAgIH1cbiAgICBcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHZhciB0b1Byb2Nlc3MgPSBpbmRpY2F0b3JzLmxlbmd0aDtcbiAgICAgICAgdmFyIGJyb2tlID0gZmFsc2U7XG5cblxuICAgICAgICAvL2hhc2FuXG5cbiAgICAgICAgdmFyIGVycm9yQXJyYXkgPSBbXTtcblxuICAgICAgICB2YXIgcmVzb2x2ZUNhbGxlciA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgaWYgKGJyb2tlID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gY3JlYXRlIGluZGljYXRvciBwZXJzaXN0IHN1Y2Nlc3MuJywgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycyk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgdG9BZGRQcm9jZXNzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9XRkluc3RhbmNlLmluc3RhbmNlLnByb2Nlc3Nlc1tpXS5zdWJQcm9jZXNzZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9BZGRQcm9jZXNzLnB1c2goX1dGSW5zdGFuY2UuaW5zdGFuY2UucHJvY2Vzc2VzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5zdGFuY2UucHJvY2Vzc2VzID0gW107XG4gICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5zdGFuY2UucHJvY2Vzc2VzID0gdG9BZGRQcm9jZXNzO1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgaW52b2x2ZWRTdWJQcm9jZXNzZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NJZCA9IHN1YlByb2Nlc3NPYmplY3QuaWQ7XG4gICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NDb25maWdPYmplY3QgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzSWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgaWYgKHN1YlByb2Nlc3NDb25maWdPYmplY3QuaW5zdGFuY2VUeXBlLm5ld1NlcXVlbmNlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3ViUHJvY2Vzc0NvbmZpZ09iamVjdC5pbmRpY2F0b3JzLmxlbmd0aDsgaSsrKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3IgPSBzdWJQcm9jZXNzQ29uZmlnT2JqZWN0LmluZGljYXRvcnNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2V0SWQgPSBpbmRpY2F0b3IuX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiZGlzdGluY3QtdmFsdWVzKC9zdWJwcm9jZXNzZXNbZ3JvdXBLZXkgPSAnXCIgKyBzdWJQcm9jZXNzT2JqZWN0Lmdyb3VwS2V5ICsgXCInXS9pbmRpY2F0b3JzW2lkID0gJ1wiICsgc2V0SWQgKyBcIiddL2luc3RhbmNlcy91dWlkKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL0pTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgc2V0SWQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRpY2F0b3JVVUlEICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGljYXRvck9iamVjdCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yT2JqZWN0Lm1vZGVsLnBlbmRpbmcgPSBpbmRpY2F0b3JPYmplY3QubW9kZWwuYXBwcm92ZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZExpc3ROYW1lcyA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN1YlByb2Nlc3NDb25maWdPYmplY3QuaW5kaWNhdG9ycy5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZExpc3ROYW1lcyA9IGluZExpc3ROYW1lcyArIFwiJ1wiICsgc3ViUHJvY2Vzc0NvbmZpZ09iamVjdC5pbmRpY2F0b3JzW2ldLl9pZCArIFwiJyxcIlxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaW5kTGlzdE5hbWVzID0gaW5kTGlzdE5hbWVzICsgXCInXCIgKyBzdWJQcm9jZXNzQ29uZmlnT2JqZWN0LmluZGljYXRvcnNbc3ViUHJvY2Vzc0NvbmZpZ09iamVjdC5pbmRpY2F0b3JzLmxlbmd0aCAtIDFdLl9pZCArIFwiJ1wiXG4gICAgICAgICAgICAgICAgICAgIGludm9sdmVkU3ViUHJvY2Vzc2VzID0gSlNPTi54cGF0aChcImRpc3RpbmN0LXZhbHVlcygvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtID0gKFwiICsgaW5kTGlzdE5hbWVzICsgXCIpXS9tb2RlbC9hcHByb3ZlZC9zdWJQcm9jZXNzVVVJRClcIiwgX1dGSW5zdGFuY2UsIHt9KTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgcGVyc2lzdFN1YlByb2Nlc3MgPSBmdW5jdGlvbiAoaW5kZXgsIGludm9sdmVkU3ViUHJvY2Vzc2VzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT0gaW52b2x2ZWRTdWJQcm9jZXNzZXMubGVuZ3RoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9BZGRTdWJQcm9jZXNzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlc1tpXS5pbmRpY2F0b3JzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvQWRkU3ViUHJvY2Vzcy5wdXNoKF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMgPSB0b0FkZFN1YlByb2Nlc3M7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCdQcm9jZXNzIGZhaWxlZCcsIGVycm9yQXJyYXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChmYWlsdXJlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0RGF0YSgnaW5kaWNhdG9ycycsIF9XRkluc3RhbmNlLCBpbnZvbHZlZFN1YlByb2Nlc3Nlc1tpbmRleF0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc2lzdFN1YlByb2Nlc3MoaW5kZXggKyAxLCBpbnZvbHZlZFN1YlByb2Nlc3Nlcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0U3ViUHJvY2VzcyhpbmRleCArIDEsIGludm9sdmVkU3ViUHJvY2Vzc2VzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcGVyc2lzdFN1YlByb2Nlc3MoMCwgaW52b2x2ZWRTdWJQcm9jZXNzZXMpO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgdG9BZGRTdWJQcm9jZXNzID0gW107XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzW2ldLmluZGljYXRvcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvQWRkU3ViUHJvY2Vzcy5wdXNoKF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzID0gdG9BZGRTdWJQcm9jZXNzO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnUHJvY2VzcyBmYWlsZWQnLCBlcnJvckFycmF5KTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGZhaWx1cmUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzdWJwcm9jZXNzVHlwZSA9IEpTT04ueHBhdGgoXCIvY29uZmlnL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NJZCArIFwiJ10vdHlwZVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgIHZhciBmb3JtQ3JlYXRlRm4gPSBmdW5jdGlvbiAoaW5kaWNhdG9yVHlwZSwgaW5kaWNhdG9ySWQsIHZhbGlkRGF0ZSwgaW5zdGFudGlhdGVTb3VyY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIGdhdGVrZWVwZXIuaW5zdGFudGlhdGUoYmFzZVVVSUQsIGluZGljYXRvclR5cGUsIGluZGljYXRvcklkLCBfV0ZJbnN0YW5jZS5wcm9maWxlLCB2YWxpZERhdGUsIHN1YlByb2Nlc3NJZCwgc3VicHJvY2Vzc1R5cGUpLnRoZW4oZnVuY3Rpb24gKGRvY0FycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgaW5kaWNhdG9yIHdvcmtmbG93IHByb2Nlc3NlcyBzZWN0aW9uXG5cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkb2NBcnJheS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9iamVjdCA9IGRvY0FycmF5W2ldO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yID0gX1dGSW5zdGFuY2UuaW5kaWNhdG9yc1tpbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGljYXRvci5faWQgPT0gb2JqZWN0Lm1vZGVsLl9pZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLmluZGljYXRvcnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5wdXNoKG9iamVjdC5tb2RlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFvYmplY3QubW9kZWwuX2lkLmVuZHNXaXRoKCc6YXBwcm92ZWQnKSAmJiAhb2JqZWN0Lm1vZGVsLl9pZC5lbmRzV2l0aCgnOnJlamVjdGVkJykpIHtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0Lm1vZGVsLm1vZGVsLnBlbmRpbmcudmFsaWREYXRlID0gdmFsaWREYXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdC5tb2RlbC5tb2RlbC5wZW5kaW5nLnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgd29ya2Zsb3dPYmogPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogX1dGSW5zdGFuY2UuY29uZmlnLl9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpbnN0YW5jZVwiOiBfV0ZJbnN0YW5jZS5pbnN0YW5jZS5faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvY2Vzc2VzXCI6IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IHByb2Nlc3NJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc0lkXCI6IHN1YlByb2Nlc3MuX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IHN0ZXAuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogc3RlcC5zZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGFydERhdGVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0YXR1c1wiOiBzdGVwLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjogc3RlcC5tZXNzYWdlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXNzaWduZWRUb1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IHN0ZXAuYXNzaWduZWRUby51c2VySWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBzdGVwLmFzc2lnbmVkVG8ubmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tZW50XCI6IHN0ZXAuY29tbWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbXBsZXRlXCI6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZW5kRGF0ZVwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqZWN0Lm1vZGVsLm1vZGVsLnBlbmRpbmcuc2VxID09IDEgJiYgYWN0aW9uLnNldFdvcmtmbG93TGFiZWxJblRpdGxlICE9IHVuZGVmaW5lZCAmJiBhY3Rpb24uc2V0V29ya2Zsb3dMYWJlbEluVGl0bGUgIT0gJycgJiYgYWN0aW9uLnNldFdvcmtmbG93TGFiZWxJblRpdGxlID09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0Lm1vZGVsLnRpdGxlID0gaW5wdXREYXRhLmxhYmVsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpb24uc2V0RHJhZnQgIT0gdW5kZWZpbmVkICYmIGFjdGlvbi5zZXREcmFmdCAhPSAnJyAmJiBhY3Rpb24uc2V0RHJhZnQgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QubW9kZWwuY29udHJvbC5kcmFmdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbHJlYWR5RXhpc3RzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9iSW5kZXggPSAtMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QubW9kZWwud29ya2Zsb3dzLmZvckVhY2goZnVuY3Rpb24od29ya2Zsb3dCbG9ja0luSW5kaWNhdG9yLCBpbmRleCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHV1aWQgPT0gd29ya2Zsb3dCbG9ja0luSW5kaWNhdG9yLnByb2Nlc3Nlc1swXS5zdWJQcm9jZXNzVVVJRCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHJlYWR5RXhpc3RzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iSW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFhbHJlYWR5RXhpc3RzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0Lm1vZGVsLndvcmtmbG93cy5wdXNoKHdvcmtmbG93T2JqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdC5tb2RlbC53b3JrZmxvd3Nbb2JJbmRleF0gPSB3b3JrZmxvd09iajtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1haW5JZCA9IG9iamVjdC5tb2RlbC5faWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGVyc2lzdCB2aWEgZ2sgc28gdGhhdCBpdCBpcyBzYXZlIGluIGNvdWNoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2F0ZWtlZXBlci5wZXJzaXN0KGRvY0FycmF5KS50aGVuKGZ1bmN0aW9uIChzYXZlZEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdXNpbmcgc2FtZSBpZCBjYWxsIGluaXRpYWxpc2VEYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY2FsbCBjb2RlIHRvIHNldCB0byBzZXRJbnN0YW5jZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0KG1haW5JZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yTW9kZWwgPSBrby5tYXBwaW5nLmZyb21KUyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkZWZhdWx0TW9kZWxcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNldElkXCI6IGluZGljYXRvcklkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXF1ZW5jZSA9IGRhdGEubW9kZWwucGVuZGluZy5zZXE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYXRla2VlcGVyLmluc3RhbnRpYXRlRGF0YShtYWluSWQsIGluc3RhbnRpYXRlU291cmNlLCBpbmRpY2F0b3JNb2RlbCwgZGF0YS5tb2RlbC5wZW5kaW5nLnNlcSwgcGFyYW1PYmplY3QpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVswXS5zdGF0dXMgPT0gXCIyMDBcIikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvciA9IF9XRkluc3RhbmNlLmluZGljYXRvcnNbaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGljYXRvci5faWQgPT0gZGF0YVswXS5tb2RlbC5faWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLmluZGljYXRvcnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLnB1c2goZGF0YVswXS5tb2RlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlcXVlbmNlID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpb24uc2V0V29ya2Zsb3dMYWJlbEluRmllbGQgIT0gdW5kZWZpbmVkICYmIGFjdGlvbi5zZXRXb3JrZmxvd0xhYmVsSW5GaWVsZCAhPSAnJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50U2V0SWQgPSBhY3Rpb24uc2V0V29ya2Zsb3dMYWJlbEluRmllbGQuc3BsaXQoXCIuXCIpWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhc3NpZ25tZW50U2V0SWQgPT0gaW5kaWNhdG9ySWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YVswXSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eHQgPSBpbnB1dERhdGEubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzcXVvdGUgPSB0eHQucmVwbGFjZSgvJy9nLCBcIlxcXFwnXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmluYWxWYWx1ZSA9IGRhdGFbMF0ubW9kZWwubW9kZWwucGVuZGluZy5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aFRvRWxlbWVudCA9IGFjdGlvbi5zZXRXb3JrZmxvd0xhYmVsSW5GaWVsZCA9PSBcIlwiID8gW10gOiBhY3Rpb24uc2V0V29ya2Zsb3dMYWJlbEluRmllbGQuc3BsaXQoL1snXCJcXFtcXF0uXSsvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGsgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgcGF0aFRvRWxlbWVudC5sZW5ndGggLSAxOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBhdGhUb0VsZW1lbnRba10gPT0gXCJcIikgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlID0gZmluYWxWYWx1ZVtwYXRoVG9FbGVtZW50W2tdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dID0gc3F1b3RlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYXRla2VlcGVyLnBlcnNpc3QoZGF0YSkudGhlbihmdW5jdGlvbiAoc2F2ZWRBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLmdldChtYWluSWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvUHJvY2Vzcy0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc2lzdERhdGEoJ2luZGljYXRvcnMnLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gY3JlYXRlIGluZGljYXRvciBwZXJzaXN0IHN1Y2Nlc3MuJywgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JBcnJheS5wdXNoKHtcImVycm9yXCI6IFwicGVyc2lzdERhdGEgXCIrIHV1aWQsIFwiZXJyb3JCbG9ja1wiOiBlcnJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gY3JlYXRlIGluZGljYXRvciBwZXJzaXN0IGZhaWxlZC4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJva2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVDYWxsZXIoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHt9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvciA9IF9XRkluc3RhbmNlLmluZGljYXRvcnNbaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGljYXRvci5faWQgPT0gZGF0YS5faWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGN1cnJlbnQgaXRlbSBmcm9tIHRoZSBhcnJheSBhbmQgYWRkIHRoZSB1cGRhdGVkIHByb2Nlc3NNb2RlbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLmluZGljYXRvcnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmxlbmd0aDtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRvUHJvY2VzcyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3REYXRhKCdpbmRpY2F0b3JzJywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gY3JlYXRlIGluZGljYXRvciBwZXJzaXN0IHN1Y2Nlc3MuJywgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JBcnJheS5wdXNoKHtcImVycm9yXCI6IFwicGVyc2lzdERhdGEgXCIrIHV1aWQsIFwiZXJyb3JCbG9ja1wiOiBlcnJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCdGb3JtIGNyZWF0ZSBpbmRpY2F0b3IgcGVyc2lzdCBmYWlsZWQuJywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJva2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh7fSk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm91bmQgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLmluZGljYXRvcnMucHVzaChkYXRhKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0RGF0YSgnaW5kaWNhdG9ycycsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gY3JlYXRlIGluZGljYXRvciBwZXJzaXN0IHN1Y2Nlc3MuJywgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVDYWxsZXIoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JBcnJheS5wdXNoKHtcImVycm9yXCI6IFwicGVyc2lzdERhdGEgXCIrIHV1aWQsIFwiZXJyb3JCbG9ja1wiOiBlcnJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnRm9ybSBjcmVhdGUgaW5kaWNhdG9yIHBlcnNpc3QgZmFpbGVkLicsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJva2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoe30pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JBcnJheS5wdXNoKHtcImVycm9yXCI6IFwiZGFvLmdldChtYWluSWQpIFwiKyBtYWluSWQsIFwiZXJyb3JCbG9ja1wiOiBlcnJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJzEgR2F0ZWtlZXBlciBpbml0aWFsaXNhdGlvbiBmYWlsZWQgd2l0aCBpbml0aWFsaXNlRGF0YSBtZXNzYWdlICcsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicm9rZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRvUHJvY2VzcyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVDYWxsZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHt9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckFycmF5LnB1c2goe1wiZXJyb3JcIjogXCJnYXRla2VlcGVyLnBlcnNpc3QoZGF0YSkgLSBQZXJzaXN0aW5nIGFsbCBkb2NzIFwiLCBcImVycm9yQmxvY2tcIjogZXJyfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnMiBHYXRla2VlcGVyIGluaXRpYWxpc2F0aW9uIGZhaWxlZCB3aXRoIGluaXRpYWxpc2VEYXRhIG1lc3NhZ2UgJywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJva2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoe30pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JBcnJheS5wdXNoKHtcImVycm9yXCI6IFwiZ2F0ZWtlZXBlci5pbnN0YW50aWF0ZURhdGFcIisgbWFpbklkICsgXCIgXCIrIGRhdGFbMF0uc3RhdHVzICwgXCJlcnJvckJsb2NrXCI6IHt9fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCczIEdhdGVrZWVwZXIgaW5pdGlhbGlzYXRpb24gZmFpbGVkIHdpdGggaW5pdGlhbGlzZURhdGEgbWVzc2FnZSAnLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyb2tlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b1Byb2Nlc3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh7fSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckFycmF5LnB1c2goe1wiZXJyb3JcIjogXCJnYXRla2VlcGVyLmluc3RhbnRpYXRlRGF0YVwiKyBtYWluSWQsIFwiZXJyb3JCbG9ja1wiOiBlcnJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnNCBHYXRla2VlcGVyIGluaXRpYWxpc2F0aW9uIGZhaWxlZCB3aXRoIGluaXRpYWxpc2VEYXRhIG1lc3NhZ2UgJywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyb2tlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoe30pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckFycmF5LnB1c2goe1wiZXJyb3JcIjogXCJkYW8uZ2V0KG1haW5JZCkgXCIrIG1haW5JZCwgXCJlcnJvckJsb2NrXCI6IGVycn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJzUgR2F0ZWtlZXBlciBpbml0aWFsaXNhdGlvbiBmYWlsZWQgd2l0aCBpbml0aWFsaXNlRGF0YSBtZXNzYWdlICcsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyb2tlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvUHJvY2Vzcy0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRvUHJvY2VzcyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHt9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JBcnJheS5wdXNoKHtcImVycm9yXCI6IFwiZ2F0ZWtlZXBlci5wZXJzaXN0IHNhdmVkQXJyYXlcIiwgXCJlcnJvckJsb2NrXCI6IGVycn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCc2IEdhdGVrZWVwZXIgaW5pdGlhbGlzYXRpb24gZmFpbGVkIHdpdGggaW5pdGlhbGlzZURhdGEgbWVzc2FnZSAnLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyb2tlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b1Byb2Nlc3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh7fSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yQXJyYXkucHVzaCh7XCJlcnJvclwiOiBcImdhdGVrZWVwZXIuaW5zdGFudGlhdGVcIiwgXCJlcnJvckJsb2NrXCI6IGVycn0pO1xuICAgICAgICAgICAgICAgICAgICBicm9rZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRvUHJvY2Vzcy0tO1xuICAgICAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVDYWxsZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoe30pO1xuXG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSk7XG5cblxuXG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGluc3RhbnRpYXRlU291cmNlID0gRlJPTV9ERUZJTklUSU9OO1xuXG4gICAgICAgIHZhciBsb29wRnVuY3Rpb24gPSBmdW5jdGlvbiAoaW5kaWNhdG9ycywgY291bnRlcikge1xuXG4gICAgICAgICAgICBpZiAoaW5kaWNhdG9ycy5sZW5ndGggPT0gMCkge1xuXG4gICAgICAgICAgICAgICAgdG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgaWYgKHRvUHJvY2VzcyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmVDYWxsZXIoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGNvdW50ZXIgPCBpbmRpY2F0b3JzLmxlbmd0aCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGluZGljYXRvcklkID0gaW5kaWNhdG9yc1tjb3VudGVyXS5faWQ7XG4gICAgICAgICAgICAgICAgdmFyIGluZGljYXRvck5hbWUgPSB1dGlsLmdldE5hbWUoaW5kaWNhdG9yc1tjb3VudGVyXS5uYW1lLCAnZW4nKTtcblxuICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSBpbmRpY2F0b3JzW2NvdW50ZXJdLmluaXRpYXRlRGF0YTtcblxuICAgICAgICAgICAgICAgIHZhciBpbml0VHlwZSA9ICcnO1xuICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzLmluc3RhbmNlVHlwZS5uZXdTZXF1ZW5jZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5pdFR5cGUgPSBJTlNUQU5DRV9UWVBFX05FV19TRVE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdWJQcm9jZXNzLmluc3RhbmNlVHlwZS5uZXdJbnN0YW5jZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5pdFR5cGUgPSBJTlNUQU5DRV9UWVBFX05FV19JTlM7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNyZWF0ZUZvcm0gPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBmb3JtQ3JlYXRlRm4oaW5pdFR5cGUsIGluZGljYXRvcklkLCBpbnB1dERhdGEudmFsaWREYXRlLCBpbnN0YW50aWF0ZVNvdXJjZSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvb3BGdW5jdGlvbihpbmRpY2F0b3JzLCAoY291bnRlciArIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYnJva2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGluZGljYXRvckRvYyA9IHt9O1xuICAgICAgICAgICAgICAgIGlmIChiYXNlVVVJRCAhPSB1bmRlZmluZWQgJiYgYmFzZVVVSUQgIT0gJycgJiYgYmFzZVVVSUQubGVuZ3RoID4gMCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzcCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBiYXNlVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzLnBlcmlvZFR5cGUucGVyaW9kaWMgPT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiYXNlVVVJRCAhPSB1dWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3AuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybUNyZWF0ZVR5cGUgPT0gQkxBTktfTU9ERUwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFudGlhdGVTb3VyY2UgPSBGUk9NX0RFRklOSVRJT047XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW50aWF0ZVNvdXJjZSA9IEZST01fQVVUSE9SSVNFRDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlRm9ybSgpO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhcmRpbmFsaXR5ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW3NldElkIGVxICdcIiArIGluZGljYXRvcklkICsgXCInXS9jYXJkaW5hbGl0eVwiLCBhcHAuU0NPUEUuQVBQX0NPTkZJRywge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbml0VHlwZSA9PSBJTlNUQU5DRV9UWVBFX05FV19JTlMpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhcmRpbmFsaXR5ID09IElORElDQVRPUl9DQVJESU5BTElUWV9TSU5HTEUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnJhcnkuZ2V0U2luZ2xlSW5kaWNhdG9yKGluZGljYXRvcklkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGV4aXN0aW5nVVVJRCl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nVVVJRC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW50aWF0ZVNvdXJjZSA9IEZST01fQVVUSE9SSVNFRDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlU291cmNlID0gRlJPTV9ERUZJTklUSU9OO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlRm9ybSgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXhpc3RpbmdVVUlEKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFudGlhdGVTb3VyY2UgPSBGUk9NX0RFRklOSVRJT047XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZUZvcm0oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFudGlhdGVTb3VyY2UgPSBGUk9NX0RFRklOSVRJT047XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlRm9ybSgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYXJkaW5hbGl0eSA9PSBJTkRJQ0FUT1JfQ0FSRElOQUxJVFlfU0lOR0xFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaWJyYXJ5LmdldFNpbmdsZUluZGljYXRvcihpbmRpY2F0b3JJZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihleGlzdGluZ1VVSUQpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ1VVSUQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFudGlhdGVTb3VyY2UgPSBGUk9NX0FVVEhPUklTRUQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW50aWF0ZVNvdXJjZSA9IEZST01fREVGSU5JVElPTjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZUZvcm0oKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGV4aXN0aW5nVVVJRCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlU291cmNlID0gRlJPTV9ERUZJTklUSU9OO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVGb3JtKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jaGVjayBoZXJlXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyBpbmRpY2F0b3JJZCArIFwiJyBhbmQgaWQgPSAvc3VicHJvY2Vzc2VzW2lkID0gJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInXS9pbmRpY2F0b3JzL2luc3RhbmNlcy91dWlkXS9faWRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFydCA9IGxpYnJhcnkuZ2V0U3VicHJvZmlsZVN1YnByb2Nlc3NJZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyBpbmRpY2F0b3JJZCArIFwiJyBhbmQgaWQgPSAvc3VicHJvY2Vzc2VzW2lkID0gJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInIGFuZCBpZCA9IFwiICsgcGFydCArIFwiXS9pbmRpY2F0b3JzL2luc3RhbmNlcy91dWlkXS9faWRcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nVVVJRCA9IEpTT04ueHBhdGgocGF0aCwgX1dGSW5zdGFuY2UsIHt9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ1VVSUQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW50aWF0ZVNvdXJjZSA9IEZST01fQVVUSE9SSVNFRDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW50aWF0ZVNvdXJjZSA9IEZST01fREVGSU5JVElPTjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlRm9ybSgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgbG9vcEZ1bmN0aW9uKGluZGljYXRvcnMsIDApO1xuXG4gICAgfSk7XG59O1xuXG5mdW5jdGlvbiBzZXRJbnN0YW5jZVRpdGxlKGFyZ3MpIHtcblxuICAgIHZhciBfV0ZJbnN0YW5jZSA9IGFyZ3NbMF0gfHwge307XG5cbiAgICB2YXIgdXVpZCA9IGFyZ3NbMl0gfHwgJyc7XG4gICAgdmFyIGRhdGEgPSBhcmdzWzRdIHx8IHt9O1xuXG4gICAgdmFyIHRpdGxlID0gZGF0YS5sYWJlbDtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgdmFyIHN1YlByb2Nlc3NJbnN0YW5jZSA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgIFxuICAgICAgICB2YXIgaW5kaWNhdG9ySW5zdGFuY2VzID0gc3ViUHJvY2Vzc0luc3RhbmNlLmluZGljYXRvcnM7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbmRpY2F0b3JJbnN0YW5jZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gaW5kaWNhdG9ySW5zdGFuY2VzW2ldLmluc3RhbmNlc1swXS51dWlkO1xuICAgICAgICAgICAgdmFyIGluZGljYXRvckluc3RhbmNlID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgaW5kaWNhdG9ySW5zdGFuY2UudGl0bGUgPSBpbmRpY2F0b3JJbnN0YW5jZXNbaV0uaWQgKyAnICcgKyB0aXRsZTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXNvbHZlKFwiU2V0IFRpdGxlIFN1Y2Nlc3NcIiwgaW5kaWNhdG9ySW5zdGFuY2VzKTtcblxuICAgIH0pO1xuXG59O1xuXG5mdW5jdGlvbiBkZWxldGVQcm9maWxlKGFyZ3MpIHtcblxuICAgIHZhciBfV0ZJbnN0YW5jZSA9IGFyZ3NbMF0gfHwge307XG5cbiAgICB2YXIgcHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHtcbiAgICAgICAgICAgIFwic291cmNlXCI6IFwicmVtb3RlXCIsXG4gICAgICAgICAgICBcInR5cGVcIjogXCJ3b3JrZXJPYmplY3RcIixcbiAgICAgICAgICAgIFwiX2lkXCI6IGdlbmVyYXRlVVVJRCgpLFxuICAgICAgICAgICAgXCJjaGFubmVsc1wiOiBbXCJkZWxldGVQcm9maWxlXCIsIFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCksIFwid29ya2VyT2JqZWN0XCJdLFxuICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSxcbiAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCxcbiAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGUsXG4gICAgICAgICAgICBcIm1lc3NhZ2VcIjogXCJcIixcbiAgICAgICAgICAgIFwic3VicHJvZmlsZUlkXCI6IHN1YnByb2ZpbGVJZCxcbiAgICAgICAgICAgIFwibWVzc2FnZVR5cGVcIjogXCJpbmZvXCIsXG4gICAgICAgICAgICBcImNyZWF0ZWREYXRlVGltZVwiOiBtb21lbnQoKS5mb3JtYXQoKSxcbiAgICAgICAgICAgIFwic2VuZGVyVXNlcklkXCI6IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkLFxuICAgICAgICAgICAgXCJwYXJlbnRUcmFuc2FjdGlvbklkXCI6IChhcHAuU0NPUEUudHhuID09IHVuZGVmaW5lZCAgPyBcIlwiIDogYXBwLlNDT1BFLnR4bi50cmFuc2FjdGlvbklkKSxcbiAgICAgICAgICAgIFwibm90aWZpY2F0aW9uXCI6IHtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFwicHJvZmlsZVwiOiB7XG4gICAgICAgICAgICAgICAgXCJhY3Rpb25cIjogXCJkZWxldGVQcm9maWxlXCIsXG4gICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogcHJvZmlsZUlkXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnNvbGUubG9nKHdvcmtlck9iamVjdCk7XG4gICAgICAgIGRhby5zYXZlKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJXb3JrZXIgT2JqZWN0IHN1Ym1pdHRlZCBmb3IgcHJvZmlsZShcIiArIHByb2ZpbGVJZCArIFwiKSBkZWxldGlvbi5cIik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICByZWplY3QoZGF0YSk7XG4gICAgICAgIH0pO1xuXG4gICAgfSk7XG5cbn07XG5cbmZ1bmN0aW9uIGNyZWF0ZVByb2ZpbGUoYXJncykge1xuXG4gICAgdmFyIF9XRkluc3RhbmNlID0gYXJnc1sxXSB8fCB7fTtcblxuICAgIHZhciBjb21tdW5pdHlJZCA9IF9XRkluc3RhbmNlLmNvbW11bml0eUlkO1xuICAgIHZhciBwcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICBsaWJyYXJ5LmNyZWF0ZVByb2ZpbGVEb2N1bWVudHMoY29tbXVuaXR5SWQsIHByb2ZpbGVJZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBjcmVhdGVkIHN1Y2Nlc3NmdWxseS4nLCBkYXRhKTtcbiAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnRVJST1I6IFByb2ZpbGUgY3JlYXRpb24gZmFpbGVkJywge30pO1xuICAgICAgICAgICAgcmVqZWN0KGZhaWx1cmUpO1xuXG4gICAgICAgIH0pO1xuXG4gICAgfSk7XG59O1xuXG5mdW5jdGlvbiBzZXREcmFmdChhcmdzKSB7XG5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBhcmdzWzBdIHx8IHt9O1xuXG4gICAgdmFyIGNvbW11bml0eUlkID0gX1dGSW5zdGFuY2UuY29tbXVuaXR5SWQ7XG4gICAgdmFyIHByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgdmFyIHV1aWQgPSBhcmdzWzJdIHx8ICcnO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICB2YXIgc3ViUHJvY2Vzc0luc3RhbmNlID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgIFxuICAgICAgICB2YXIgaW5kaWNhdG9ySW5zdGFuY2VzID0gc3ViUHJvY2Vzc0luc3RhbmNlLmluZGljYXRvcnM7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbmRpY2F0b3JJbnN0YW5jZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gaW5kaWNhdG9ySW5zdGFuY2VzW2ldLmluc3RhbmNlc1swXS51dWlkO1xuICAgICAgICAgICAgdmFyIGluZGljYXRvckluc3RhbmNlID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgaW5kaWNhdG9ySW5zdGFuY2UuY29udHJvbC5kcmFmdCA9IHRydWU7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmVzb2x2ZShcIlNldCBEcmFmdCBTdWNjZXNzXCIsIGluZGljYXRvckluc3RhbmNlcyk7XG5cbiAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIHNldFVuRHJhZnQoYXJncykge1xuXG4gICAgdmFyIF9XRkluc3RhbmNlID0gYXJnc1swXSB8fCB7fTtcblxuICAgIHZhciBjb21tdW5pdHlJZCA9IF9XRkluc3RhbmNlLmNvbW11bml0eUlkO1xuICAgIHZhciBwcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgIHZhciB1dWlkID0gYXJnc1syXSB8fCAnJztcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgdmFyIHN1YlByb2Nlc3NJbnN0YW5jZSA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICBcbiAgICAgICAgdmFyIGluZGljYXRvckluc3RhbmNlcyA9IHN1YlByb2Nlc3NJbnN0YW5jZS5pbmRpY2F0b3JzO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5kaWNhdG9ySW5zdGFuY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IGluZGljYXRvckluc3RhbmNlc1tpXS5pbnN0YW5jZXNbMF0udXVpZDtcbiAgICAgICAgICAgIHZhciBpbmRpY2F0b3JJbnN0YW5jZSA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIGluZGljYXRvckluc3RhbmNlLmNvbnRyb2wuZHJhZnQgPSBmYWxzZTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXNvbHZlKFwiU2V0IERyYWZ0IFN1Y2Nlc3NcIiwgaW5kaWNhdG9ySW5zdGFuY2VzKTtcblxuICAgIH0pO1xufTtcblxuZnVuY3Rpb24gc2F2ZShpbmRpY2F0b3IpIHtcbiAgICB2YXIgY29tcGxldGVkID0gW107XG4gICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgICAgY29tcGxldGU6IHRydWUsXG4gICAgICAgIGRhdGE6IFtdXG4gICAgfTtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdGb3JtIGluZGljYXRvciBzZXQgc2F2ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdCk7XG4gICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgfSk7XG59O1xuXG5mdW5jdGlvbiBzdWJtaXQoZm9ybSkge1xuICAgIHZhciBjb21wbGV0ZWQgPSBbXTtcbiAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgICBjb21wbGV0ZTogdHJ1ZSxcbiAgICAgICAgZGF0YTogW11cbiAgICB9O1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gc3VibWl0dGVkIHN1Y2Nlc3NmdWxseS4nLCByZXN1bHQpO1xuICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgIH0pO1xufTtcblxuZnVuY3Rpb24gYXV0aG9yaXNlKGZvcm0pIHtcbiAgICB2YXIgY29tcGxldGVkID0gW107XG4gICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgICAgY29tcGxldGU6IHRydWUsXG4gICAgICAgIGRhdGE6IFtdXG4gICAgfTtcblxuICAgIHZhciBwcm9jZXNzSWQgPSBmb3JtWzBdIHx8ICcnO1xuXG4gICAgdmFyIHN1YlByb2Nlc3MgPSBmb3JtWzFdIHx8IHt9O1xuXG4gICAgdmFyIHN1YlByb2Nlc3NJZCA9IHN1YlByb2Nlc3MuX2lkO1xuXG4gICAgdmFyIHByb2Nlc3NTZXEgPSBmb3JtWzJdIHx8ICcnO1xuXG4gICAgdmFyIHN1YlByb2Nlc3NTZXEgPSBmb3JtWzNdIHx8ICcnO1xuXG4gICAgdmFyIF9XRkluc3RhbmNlID0gZm9ybVs0XSB8fCB7fTtcblxuICAgIHZhciBzdWJQcm9jZXNzVVVJRCA9IGZvcm1bNl0gfHwgJyc7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIHZhciBzcG8gPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc1VVSUQgKyBcIiddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuXG4gICAgICAgIC8vdmFyIHN1YlByb2Nlc3NVVUlEID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbaWQgZXEgJ1wiICsgcHJvY2Vzc0lkICsgXCInIGFuZCBzZXEgZXEgJ1wiICsgcHJvY2Vzc1NlcSArIFwiJ10vc3ViUHJvY2Vzc2VzW2lkIGVxICdcIiArIHN1YlByb2Nlc3NJZCArIFwiJyBhbmQgc2VxIGVxICdcIiArIHN1YlByb2Nlc3NTZXEgKyBcIiddL3V1aWRcIiwgX1dGSW5zdGFuY2UuaW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgdmFyIHNwSW5kaWNhdG9ycyA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzVVVJRCArIFwiJ10vaW5kaWNhdG9ycy9pbnN0YW5jZXMvdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pO1xuICAgICAgICB2YXIgaXRlbXNUb1Byb2Nlc3MgPSBzcEluZGljYXRvcnMubGVuZ3RoO1xuICAgICAgICB2YXIgdXBkYXRlZE9iamVjdHNBcnJheSA9IFtdO1xuICAgICAgICB2YXIgdGVtcEFycmF5ID0gW107XG5cbiAgICAgICAgLy9zdGFydCB0eG4gb24gaW5kdXVpZCArIDphcHByb3ZlZCB0aGVuIGNvbW1pdFxuXG4gICAgICAgIHZhciBwcm9jZXNzU0RPID0gZnVuY3Rpb24oaSl7XG5cbiAgICAgICAgICAgIGdhdGVrZWVwZXIuYXV0aG9yaXNlKHNwSW5kaWNhdG9yc1tpXSkudGhlbihmdW5jdGlvbiAoYXV0aG9yaXNlZFJldHVybikge1xuXG4gICAgICAgICAgICAgICAgZ2F0ZWtlZXBlci5wZXJzaXN0KGF1dGhvcmlzZWRSZXR1cm4pLnRoZW4oZnVuY3Rpb24gKHNhdmVkQXJyYXkpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgdXVpZFNhdmVkSW5kaWNhdG9yID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGMgPSAwOyBjIDwgc2F2ZWRBcnJheS5sZW5ndGg7IGMrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzYXZlZEFycmF5W2NdLmlkLmVuZHNXaXRoKCc6YXBwcm92ZWQnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV1aWRTYXZlZEluZGljYXRvciA9IHNhdmVkQXJyYXlbY10uaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGRhby5nZXQodXVpZFNhdmVkSW5kaWNhdG9yKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zVG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1zVG9Qcm9jZXNzID09IDApIHtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc2lzdERhdGEoJ2luZGljYXRvcnMnLCBfV0ZJbnN0YW5jZSwgc3ViUHJvY2Vzc1VVSUQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gYXV0aG9yaXNlZCBzdWNjZXNzZnVsbHkuJywgdXBkYXRlZE9iamVjdHNBcnJheSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCdGb3JtIGF1dGhvcmlzZWQgcGVyc2lzdCBmYWlsZWQuJywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGZhaWx1cmUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihpdGVtc1RvUHJvY2VzcyA+IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzU0RPKGkgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZvdW5kID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvciA9IF9XRkluc3RhbmNlLmluZGljYXRvcnNbaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kaWNhdG9yLl9pZCA9PSBkYXRhLl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBjdXJyZW50IGl0ZW0gZnJvbSB0aGUgYXJyYXkgYW5kIGFkZCB0aGUgdXBkYXRlZCBwcm9jZXNzTW9kZWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBBcnJheS5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9fV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL19XRkluc3RhbmNlLmluZGljYXRvcnMucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zVG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbXNUb1Byb2Nlc3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRMZW5ndGggPSBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcExlbmd0aCA9IHRlbXBBcnJheS5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBwID0gMDsgcCA8IGluZExlbmd0aDsgcCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wT2JqID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHEgPSAwOyBxIDwgdGVtcExlbmd0aDsgcSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX1dGSW5zdGFuY2UuaW5kaWNhdG9yc1twXS5faWQgPT0gdGVtcEFycmF5W3FdLl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBPYmogPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGVtcE9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcEFycmF5LnB1c2goX1dGSW5zdGFuY2UuaW5kaWNhdG9yc1twXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLmluZGljYXRvcnMgPSB0ZW1wQXJyYXk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm91bmQgPT0gdHJ1ZSAmJiBpdGVtc1RvUHJvY2VzcyA9PSAwKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc2lzdERhdGEoJ2luZGljYXRvcnMnLCBfV0ZJbnN0YW5jZSwgc3ViUHJvY2Vzc1VVSUQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gYXV0aG9yaXNlZCBzdWNjZXNzZnVsbHkuJywgdXBkYXRlZE9iamVjdHNBcnJheSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gYXV0aG9yaXNlZCBwZXJzaXN0IGZhaWxlZC4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZmFpbHVyZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKGl0ZW1zVG9Qcm9jZXNzID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NTRE8oaSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCdGb3JtIGF1dGhvcmlzZWQgcGVyc2lzdCBmYWlsZWQgMi4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZmFpbHVyZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnRm9ybSBhdXRob3Jpc2VkIHBlcnNpc3QgZmFpbGVkIDMuJywge30pO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZmFpbHVyZSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCdGb3JtIGF1dGhvcmlzZWQgcGVyc2lzdCBmYWlsZWQgNC4nLCB7fSk7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGZhaWx1cmUpO1xuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG5cbiAgICAgICAgcHJvY2Vzc1NETygwKTtcblxuXG5cblxuICAgIH0pO1xufTtcblxuZnVuY3Rpb24gY2xvc2UoZm9ybSkge1xuICAgIHZhciBjb21wbGV0ZWQgPSBbXTtcbiAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgICBjb21wbGV0ZTogdHJ1ZSxcbiAgICAgICAgZGF0YTogW11cbiAgICB9O1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gY2xvc2VkIHN1Y2Nlc3NmdWxseS4nLCByZXN1bHQpO1xuICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgIH0pO1xufTtcblxuXG5cbmZ1bmN0aW9uIHVwZGF0ZUluZGljYXRvcihhcmdzKSB7XG5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBhcmdzWzBdIHx8IHt9O1xuXG4gICAgdmFyIHV1aWQgPSBhcmdzWzFdIHx8ICcnO1xuICAgIHZhciBwYXRoID0gYXJnc1syXSB8fCAnJztcbiAgICB2YXIgZGF0YVZhbHVlID0gYXJnc1szXSB8fCAnJztcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgdmFyIHNldElkID0gcGF0aC5zcGxpdChcIi5cIiwgMSlbMF07XG4gICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbd29ya2Zsb3dzL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzVVVJRCA9ICdcIiArIHV1aWQgKyBcIicgYW5kIGNhdGVnb3J5L3Rlcm0gPSAnXCIgKyBzZXRJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgaWYoaW5kT2JqZWN0ID09IHVuZGVmaW5lZCAmJiBzZXRJZCA9PSBcImFwcFByb2ZpbGVcIil7XG4gICAgICAgICAgICBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbbW9kZWwvcGVuZGluZy9zdGF0dXMgPSAnQXV0aG9yaXNlZCcgYW5kIGNhdGVnb3J5L3Rlcm0gPSAnXCIgKyBzZXRJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIGlmKGluZE9iamVjdCA9PSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgIHZhciBzdHVmZiA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBvYmogPSB7fTtcblxuICAgICAgICAgICAgICAgIG9iai5tb2RlbCA9IHt9O1xuICAgICAgICAgICAgICAgIHN0dWZmLnB1c2gob2JqKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZCBza2lwcGVkLicsIHN0dWZmKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzcXVvdGUgPSAoZGF0YVZhbHVlICsgXCJcIikucmVwbGFjZSgvJy9nLCBcIlxcXFwnXCIpO1xuICAgICAgICB2YXIgc3F1b3RlID0gc3F1b3RlLnNwbGl0KCdcXG4nKS5qb2luKCcgJyk7XG4gICAgICAgIHZhciBmaW5hbFZhbHVlID0gaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YTtcbiAgICAgICAgdmFyIHBhdGhUb0VsZW1lbnQgPSBwYXRoID09IFwiXCIgPyBbXSA6IHBhdGguc3BsaXQoL1snXCJcXFtcXF0uXSsvKTtcbiAgICAgICAgdmFyIGsgPSAwO1xuICAgICAgICBmb3IgKGsgPSAwOyBrIDwgcGF0aFRvRWxlbWVudC5sZW5ndGggLSAxOyBrKyspIHtcbiAgICAgICAgICAgIGlmKHBhdGhUb0VsZW1lbnRba10gPT0gXCJcIikgY29udGludWU7XG4gICAgICAgICAgICBmaW5hbFZhbHVlID0gZmluYWxWYWx1ZVtwYXRoVG9FbGVtZW50W2tdXTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dID0gc3F1b3RlO1xuICAgICAgICB2YXIgaXRlbXNUb1Byb2Nlc3MgPSAxO1xuICAgICAgICB2YXIgc3R1ZmYgPSBbXTtcbiAgICAgICAgdmFyIG9iaiA9IHt9O1xuXG4gICAgICAgIG9iai5tb2RlbCA9IGluZE9iamVjdDtcbiAgICAgICAgc3R1ZmYucHVzaChvYmopO1xuXG4gICAgICAgIHZhciB0eG5QYWNrZXQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFwcC5TQ09QRS50eG4pKTtcbiAgICAgICAgdHhuUGFja2V0LmRvY3VtZW50cyA9IFtdO1xuICAgICAgICB2YXIgcmVmUGFjayA9IHsgXCJkb2N1bWVudFwiOiBpbmRPYmplY3QuX2lkLCBcInJldlwiOiBpbmRPYmplY3QuX3JldiB9O1xuICAgICAgICB0eG5QYWNrZXQuZG9jdW1lbnRzLnB1c2gocmVmUGFjayk7XG4gICAgICAgIGFwcC5TQ09QRS50eG4uZG9jdW1lbnRzLnB1c2gocmVmUGFjayk7XG5cbiAgICAgICAgZGFvLnVwZGF0ZVRyYW5zYWN0aW9uKHR4blBhY2tldCkudGhlbihmdW5jdGlvbihzdWNjKSB7XG5cbiAgICAgICAgICAgIGRhby5zYXZlKGluZE9iamVjdCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmVmUGFjay5yZXYgPSBkYXRhLnJldjtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnSW5kaWNhdG9yIHVwZGF0ZWQuJywgc3R1ZmYpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnSW5kaWNhdG9yIHVwZGF0ZWQuJywgc3R1ZmYpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnSW5kaWNhdG9yIHVwZGF0ZWQuJywgc3R1ZmYpO1xuICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgfSk7XG5cblxuICAgIH0pO1xufTtcblxuXG5mdW5jdGlvbiB1cGRhdGVJbmRpY2F0b3JXcmFwcGVyKGFyZ3MpIHtcblxuICAgIHZhciBfV0ZJbnN0YW5jZSA9IGFyZ3NbMF0gfHwge307XG5cbiAgICB2YXIgdXVpZCA9IGFyZ3NbMV0gfHwgJyc7XG4gICAgdmFyIHBhdGggPSBhcmdzWzJdIHx8ICcnO1xuICAgIHZhciBkYXRhVmFsdWUgPSBhcmdzWzNdIHx8ICcnO1xuICAgIHZhciBpbmRpY2F0b3JTZXRJZCA9IGFyZ3NbNF0gfHwgJyc7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXG5cbiAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1t3b3JrZmxvd3MvcHJvY2Vzc2VzL3N1YlByb2Nlc3NVVUlEID0gJ1wiICsgdXVpZCArIFwiJyBhbmQgY2F0ZWdvcnkvdGVybSA9ICdcIiArIGluZGljYXRvclNldElkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgIGlmKGluZE9iamVjdCA9PSB1bmRlZmluZWQgJiYgaW5kaWNhdG9yU2V0SWQgPT0gXCJhcHBQcm9maWxlXCIpe1xuICAgICAgICAgICAgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW21vZGVsL3BlbmRpbmcvc3RhdHVzID0gJ0F1dGhvcmlzZWQnIGFuZCBjYXRlZ29yeS90ZXJtID0gJ1wiICsgaW5kaWNhdG9yU2V0SWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICBpZihpbmRPYmplY3QgPT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICB2YXIgc3R1ZmYgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0ge307XG5cbiAgICAgICAgICAgICAgICBvYmoubW9kZWwgPSB7fTtcbiAgICAgICAgICAgICAgICBzdHVmZi5wdXNoKG9iaik7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnSW5kaWNhdG9yIHVwZGF0ZWQgc2tpcHBlZC4nLCBzdHVmZik7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc3F1b3RlID0gZGF0YVZhbHVlLnJlcGxhY2UoLycvZywgXCJcXFxcJ1wiKTtcbiAgICAgICAgdmFyIHNxdW90ZSA9IHNxdW90ZS5zcGxpdCgnXFxuJykuam9pbignICcpO1xuICAgICAgICB2YXIgZmluYWxWYWx1ZSA9IGluZE9iamVjdDtcbiAgICAgICAgdmFyIHBhdGhUb0VsZW1lbnQgPSBwYXRoID09IFwiXCIgPyBbXSA6IHBhdGguc3BsaXQoL1snXCJcXFtcXF0uXSsvKTtcbiAgICAgICAgdmFyIGsgPSAwO1xuICAgICAgICBmb3IgKGsgPSAwOyBrIDwgcGF0aFRvRWxlbWVudC5sZW5ndGggLSAxOyBrKyspIHtcbiAgICAgICAgICAgIGlmKHBhdGhUb0VsZW1lbnRba10gPT0gXCJcIikgY29udGludWU7XG4gICAgICAgICAgICBmaW5hbFZhbHVlID0gZmluYWxWYWx1ZVtwYXRoVG9FbGVtZW50W2tdXTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dID0gc3F1b3RlO1xuICAgICAgICB2YXIgaXRlbXNUb1Byb2Nlc3MgPSAxO1xuICAgICAgICB2YXIgc3R1ZmYgPSBbXTtcbiAgICAgICAgdmFyIG9iaiA9IHt9O1xuXG4gICAgICAgIG9iai5tb2RlbCA9IGluZE9iamVjdDtcbiAgICAgICAgc3R1ZmYucHVzaChvYmopO1xuXG4gICAgICAgIHZhciB0eG5QYWNrZXQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFwcC5TQ09QRS50eG4pKTtcbiAgICAgICAgdHhuUGFja2V0LmRvY3VtZW50cyA9IFtdO1xuICAgICAgICB2YXIgcmVmUGFjayA9IHsgXCJkb2N1bWVudFwiOiBpbmRPYmplY3QuX2lkLCBcInJldlwiOiBpbmRPYmplY3QuX3JldiB9O1xuICAgICAgICB0eG5QYWNrZXQuZG9jdW1lbnRzLnB1c2gocmVmUGFjayk7XG4gICAgICAgIGFwcC5TQ09QRS50eG4uZG9jdW1lbnRzLnB1c2gocmVmUGFjayk7XG5cbiAgICAgICAgZGFvLnVwZGF0ZVRyYW5zYWN0aW9uKHR4blBhY2tldCkudGhlbihmdW5jdGlvbihzdWNjKSB7XG5cbiAgICAgICAgICAgIGRhby5zYXZlKGluZE9iamVjdCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgcmVmUGFjay5yZXYgPSBkYXRhLnJldjtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnSW5kaWNhdG9yIHVwZGF0ZWQuJywgc3R1ZmYpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnSW5kaWNhdG9yIHVwZGF0ZWQuJywgc3R1ZmYpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnSW5kaWNhdG9yIHVwZGF0ZWQuJywgc3R1ZmYpO1xuICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgfSk7XG5cbiAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIG1hcmtVcGRhdGVJbmRpY2F0b3IoYXJncykge1xuXG4gICAgdmFyIF9XRkluc3RhbmNlID0gYXJnc1swXSB8fCB7fTtcblxuICAgIHZhciB1dWlkID0gYXJnc1sxXSB8fCAnJztcbiAgICB2YXIgc3RhdHVzID0gYXJnc1syXSB8fCAnJztcbiAgICB2YXIgaW5kaWNhdG9yU2V0SWQgPSBhcmdzWzNdIHx8ICcnO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW3dvcmtmbG93cy9wcm9jZXNzZXMvc3ViUHJvY2Vzc1VVSUQgPSAnXCIgKyB1dWlkICsgXCInIGFuZCBjYXRlZ29yeS90ZXJtID0gJ1wiICsgaW5kaWNhdG9yU2V0SWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLnN0YXR1cyA9IHN0YXR1cztcbiAgICAgICAgdmFyIGl0ZW1zVG9Qcm9jZXNzID0gMTtcbiAgICAgICAgdmFyIHN0dWZmID0gW107XG4gICAgICAgIHZhciBvYmogPSB7fTtcbiAgICAgICAgb2JqLm1vZGVsID0gaW5kT2JqZWN0O1xuICAgICAgICBzdHVmZi5wdXNoKG9iaik7XG5cbiAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0luZGljYXRvciB1cGRhdGVkLicsIHN0dWZmKTtcbiAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgIH0pO1xufTtcblxuXG5mdW5jdGlvbiBzZXRTdGF0dXMoYXJncykge1xuXG5cbiAgICAvLyBDdXJyZW50bHkgc2V0dGluZyBzdGF0dXMgdG8gc3VicHJvY2VzcyBpbnN0YW5jZS4gaXQgc2hvdWxkIHVwZGF0ZSBzb21lIGZpZWxkIGluIGFwcFByb2ZpbGUgb3Igd2hhdGV2ZXIgaW5kaWNhdG9yIHRoZSBwcm9maWxlIGhhcy5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBhcmdzWzBdIHx8IHt9O1xuICAgIHZhciB1dWlkID0gYXJnc1sxXSB8fCAnJztcbiAgICB2YXIgc3RhdHVzID0gYXJnc1syXSB8fCAnJztcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgdmFyIHN1YlByb2Nlc3NJbnN0YW5jZSA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgIFxuICAgICAgICBzdWJQcm9jZXNzSW5zdGFuY2Uuc3RlcC5tZXNzYWdlID0gc3RhdHVzO1xuXG4gICAgICAgIHJlc29sdmUoXCJTZXQgcHJvZmlsZSBzdGF0dXMgU3VjY2Vzc1wiLCBzdWJQcm9jZXNzSW5zdGFuY2UpO1xuXG4gICAgfSk7XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuXG4gICAgY3JlYXRlOiBjcmVhdGUsXG4gICAgc2F2ZTogc2F2ZSxcbiAgICBzdWJtaXQ6IHN1Ym1pdCxcbiAgICBhdXRob3Jpc2U6IGF1dGhvcmlzZSxcbiAgICBjbG9zZTogY2xvc2UsXG4gICAgc2V0RHJhZnQ6IHNldERyYWZ0LFxuICAgIHNldFVuRHJhZnQ6IHNldFVuRHJhZnQsXG4gICAgY3JlYXRlUHJvZmlsZTogY3JlYXRlUHJvZmlsZSxcbiAgICBzZXRJbnN0YW5jZVRpdGxlOiBzZXRJbnN0YW5jZVRpdGxlLFxuICAgIGRlbGV0ZVByb2ZpbGU6IGRlbGV0ZVByb2ZpbGUsXG4gICAgdXBkYXRlSW5kaWNhdG9yOiB1cGRhdGVJbmRpY2F0b3IsXG4gICAgbWFya1VwZGF0ZUluZGljYXRvcjogbWFya1VwZGF0ZUluZGljYXRvcixcbiAgICB1cGRhdGVJbmRpY2F0b3JXcmFwcGVyOiB1cGRhdGVJbmRpY2F0b3JXcmFwcGVyXG5cbn0iLCIndXNlIHN0cmljdCc7XG5cblxuZnVuY3Rpb24gZ2V0TGFuZ3VhZ2VNZXNzYWdlKG1lc3NhZ2UpIHtcblxuICAgIHZhciBsYW5ndWFnZSA9IHNlcnZpY2UuZ2V0TGFuZ3VhZ2UoKTtcbiAgICB2YXIgcmVzID0gbWVzc2FnZS5pMThuW2xhbmd1YWdlXTtcbiAgICByZXR1cm4gcmVzO1xuXG59O1xuXG5mdW5jdGlvbiBnZXROb2RlVmFsdWUoZGF0YSwgX1dGSW5zdGFuY2UsIHV1aWQpIHtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgXG4gICAgICAgIGlmKHR5cGVvZiBkYXRhID09ICdzdHJpbmcnKXtcbiAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGF0YS52YWx1ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgdmFyIGlucHV0RGF0YVR5cGUgPSAnc3RyaW5nJztcblxuICAgICAgICAgICAgaWYgKGRhdGEudmFsdWUuZGF0YXR5cGUuZGF0YVR5cGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaW5wdXREYXRhVHlwZSA9IGRhdGEudmFsdWUuZGF0YXR5cGUuZGF0YVR5cGU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlucHV0RGF0YVR5cGUgPSBkYXRhLnZhbHVlLmRhdGF0eXBlO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIHZhciBpbnB1dFZhbHVlID0gZGF0YS52YWx1ZS5kYXRhO1xuXG4gICAgICAgICAgICBpZiAoaW5wdXREYXRhVHlwZSA9PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoTnVtYmVyKGlucHV0VmFsdWUpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhVHlwZSA9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoaW5wdXRWYWx1ZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YVR5cGUgPT0gJ2ludGVnZXInKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShwYXJzZUludChpbnB1dFZhbHVlKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YVR5cGUgPT0gJ2RlY2ltYWwnKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShwYXJzZUZsb2F0KGlucHV0VmFsdWUpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhVHlwZSA9PSAnZGF0ZScgfHwgaW5wdXREYXRhVHlwZSA9PSAnZGF0ZVRpbWUnKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShpbnB1dFZhbHVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gSW4gY2FzZSBkYXRhIHR5cGUgbm90IG1hdGNoZWRcbiAgICAgICAgICAgICAgICByZXNvbHZlKGlucHV0VmFsdWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YS5pbmRpY2F0b3JVVUlEICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAvLyBBIGNoYW5nZSBpcyByZXF1aXJlZCB0byBtYWtlIHN1cmUgcHJvcGVyIHNjb3BlIGlzIGlkZW50aWZpZWQuXG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IG51bGw7XG5cbiAgICAgICAgICAgIHZhciBzdWJwcm9jZXNzID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChzdWJwcm9jZXNzLmluZGljYXRvcnMubGVuZ3RoID09IDApIHtcblxuICAgICAgICAgICAgICAgIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyBkYXRhLmluZGljYXRvclVVSUQuaW5kaWNhdG9yU2V0SWQgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBkYXRhLmluZGljYXRvclVVSUQuaW5kaWNhdG9yU2V0SWQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIHN1YnByb2Nlc3MsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBpZiAoaW5kaWNhdG9yVVVJRCA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIGRhdGEuaW5kaWNhdG9yVVVJRC5pbmRpY2F0b3JTZXRJZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICAgICAgcmVzb2x2ZShpbmRpY2F0b3JVVUlEKTtcblxuICAgICAgICB9IGVsc2UgaWYgKGRhdGEuaW5kaWNhdG9yICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIGRhdGEuaW5kaWNhdG9yLmluZGljYXRvclNldElkICsgXCInXS9pbnN0YW5jZXMvdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIGJhc2VwYXRoID0gXCJcIjtcbiAgICAgICAgICAgIGlmKGRhdGEuaW5kaWNhdG9yLmJhc2VwYXRoICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgYmFzZXBhdGggPSBkYXRhLmluZGljYXRvci5iYXNlcGF0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvbW9kZWwvcGVuZGluZy9kYXRhLycgKyBkYXRhLmluZGljYXRvci5pbmRpY2F0b3JTZXRJZCArIGJhc2VwYXRoICsgJy8nICsgZGF0YS5pbmRpY2F0b3IuZWxlbWVudElkO1xuXG4gICAgICAgICAgICAvL3ZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICB2YXIgc3VicHJvY2Vzc1R5cGUgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0vdHlwZVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgLy92YXIgcGFydCA9IGxpYnJhcnkuZ2V0U3VicHJvZmlsZVN1YnByb2Nlc3NJZHMoKTtcblxuICAgICAgICAgICAgLy8gaWYgKHN1YnByb2Nlc3NUeXBlID09IFBST0NFU1NfVFlQRV9TVUJQUk9GSUxFKSB7XG4gICAgICAgICAgICAvLyAgICAgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZCBhbmQgX2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgPSBcIiArIHBhcnQgKyBcIl0vX2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgIHZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgaWYgKHN1YnByb2Nlc3NUeXBlID09IFBST0NFU1NfVFlQRV9TVUJQUk9GSUxFKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG4gICAgICAgICAgICAgICAgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWQgYW5kIHV1aWQgPSBcIisgcGFydCArXCJdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHJlcGxhY2VkUGF0aCA9IHJlcGxhY2VBbGwoeHBhdGgsICcjU0VRVUVOQ0UjJywgc2VxKTtcblxuICAgICAgICAgICAgdmFyIHZhbGlkRGF0ZSA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9kYXRlcy92YWxpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIGNvbmNhdFZhbGlkRGF0ZSA9IFwiJ1wiICsgdmFsaWREYXRlICsgXCInXCI7XG4gICAgICAgICAgICB2YXIgbmV3UGF0aCA9IHJlcGxhY2VBbGwocmVwbGFjZWRQYXRoLCAnI0VORF9EQVRFIycsIGNvbmNhdFZhbGlkRGF0ZSk7XG4gICAgICAgICAgICB2YXIgZG90UmVwbGFjZWQgPSByZXBsYWNlQWxsKG5ld1BhdGgsICdbLl0nLCAnLycpO1xuICAgICAgICAgICAgaWYoYmFzZXBhdGgubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgdmFyIHJldFZhbHVlID0gSlNPTi54cGF0aChkb3RSZXBsYWNlZCwgaW5kT2JqZWN0LCB7fSk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXRWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIHZhciByZXRWYWx1ZSA9IEpTT04ueHBhdGgoZG90UmVwbGFjZWQsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgIGlmKGRhdGEuaW5kaWNhdG9yLmFkZFN0cmluZyAhPSB1bmRlZmluZWQgJiYgZGF0YS5pbmRpY2F0b3IuYWRkU3RyaW5nICE9IFwiXCIpe1xuICAgICAgICAgICAgICAgICAgICByZXRWYWx1ZSA9IHJldFZhbHVlICsgZGF0YS5pbmRpY2F0b3IuYWRkU3RyaW5nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlc29sdmUocmV0VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YS5zeXN0ZW0gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgIHJlc29sdmUoXCJFUlJPUjogVW5pbXBsZW1lbnRlZCBzeXN0ZW0gdHlwZSBmb3VuZC5cIik7XG5cbiAgICAgICAgfSBlbHNlIGlmIChkYXRhLnZhcmlhYmxlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogVGFrZW4gb3V0IG9mIHNjaGVtYVxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NJbnN0YW5jZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkZXNjcmlwdGlvblwiOiBcInZhbHVlIG9mIHRoZSB2YXJpYWJsZSBzdWJQcm9jZXNzSW5zdGFuY2UgdmFyaWFibGUgY3VycmVudCBzdWJwcm9jZXNzSW5zdGFuY2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkZXNjcmlwdGlvblwiOiBcInZhbHVlIG9mIHRoZSB2YXJpYWJsZSBpbiB0aGUgY3VycmVudCBzdGVwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NJZFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkZXNjcmlwdGlvblwiOiBcInZhbHVlIG9mIHRoZSBjdXJyZW50IGFwcGxpY2FpdG9uIElEXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKGRhdGEudmFyaWFibGUucHJvZmlsZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgIHZhciB2YXJpYWJsZU5hbWUgPSBkYXRhLnZhcmlhYmxlLnByb2ZpbGU7XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUgPSBwcm9maWxlSWQgKyAnOnZhcmlhYmxlcyc7XG5cbiAgICAgICAgICAgICAgICBkYW8uZ2V0KHByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lKS50aGVuKGZ1bmN0aW9uKGZpbGUpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZihkYXRhLnZhcmlhYmxlLnR5cGUgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRhdGEudmFyaWFibGUudHlwZSA9PSBcImNvdW50XCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZmlsZVtkYXRhLnZhcmlhYmxlLm5hbWVdLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkVSUk9SOiBQcm9maWxlIHZhcmlhYmxlcyB0eXBlIGltcGxlbWVudGF0aW9uIC0gQ2FzZSBub3QgZm91bmRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbmFsVmFsdWUgPSBmaWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGhUb0VsZW1lbnQgPSB2YXJpYWJsZU5hbWUgPT0gXCJcIiA/IFtdIDogdmFyaWFibGVOYW1lLnNwbGl0KC9bJ1wiXFxbXFxdLl0rLyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcGF0aFRvRWxlbWVudC5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBhdGhUb0VsZW1lbnRba10gPT0gXCJcIikgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IGZpbmFsVmFsdWVbcGF0aFRvRWxlbWVudFtrXV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gZmluYWxWYWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYob2JqID09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiVmFyaWFibGUgbm90IGZvdW5kXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIG9iaiA9PSAnb2JqZWN0Jykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdldFNlcSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXMsIHJlail7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihkYXRhLnZhcmlhYmxlLnBlcmlvZGljID09IHVuZGVmaW5lZCB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnZhcmlhYmxlLnBlcmlvZGljLnNlcSA9PSB1bmRlZmluZWQpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFyIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VicHJvY2Vzc1R5cGUgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0vdHlwZVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgKHN1YnByb2Nlc3NUeXBlID09IFBST0NFU1NfVFlQRV9TVUJQUk9GSUxFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCBfaWQgPSAvc3VicHJvY2Vzc2VzW19pZCA9IFwiICsgcGFydCArIFwiXS9faWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJwcm9jZXNzVHlwZSA9PSBQUk9DRVNTX1RZUEVfU1VCUFJPRklMRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZCBhbmQgdXVpZCA9IFwiKyBwYXJ0ICtcIl0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzKHNlcSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Tm9kZVZhbHVlKGRhdGEudmFyaWFibGUucGVyaW9kaWMuc2VxLCBfV0ZJbnN0YW5jZSwgdXVpZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihzZXFWYXIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMoc2VxVmFyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0VmFsID0gZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzLHJlail7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2UGFyYW0gPSBcInZhbHVlXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRhdGEudmFyaWFibGUucGVyaW9kaWMgIT0gdW5kZWZpbmVkICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEudmFyaWFibGUucGVyaW9kaWMudmFsdWUgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Tm9kZVZhbHVlKGRhdGEudmFyaWFibGUucGVyaW9kaWMudmFsdWUsIF9XRkluc3RhbmNlLCB1dWlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbih2UGFyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyh2UGFyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyh2UGFyYW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRTZXEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHNlcSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldFZhbCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHZQYXJhbSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVQYXRoID0gXCIvXCIgKyB2YXJpYWJsZU5hbWUgKyBcIltcIiArIHNlcSArIFwiXS9cIiArIHZQYXJhbTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXRWYWx1ZSA9IEpTT04ueHBhdGgodmFsdWVQYXRoLCBmaWxlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJldFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgXG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgXG4gICAgXG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvYmogPT0gJ3N0cmluZycpIHtcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG9iaik7XG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcblxuICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJFUlJPUjogUHJvZmlsZSB2YXJpYWJsZXMgbm90IGZvdW5kXCIpO1xuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZihkYXRhLnZhcmlhYmxlLnN1YlByb2ZpbGUgIT0gdW5kZWZpbmVkKXtcblxuICAgICAgICAgICAgICAgIHZhciB2YXJpYWJsZU5hbWUgPSBkYXRhLnZhcmlhYmxlLnN1YlByb2ZpbGU7XG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZFxuICAgICAgICAgICAgICAgIGlmKGRhdGEudmFyaWFibGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCAmJiBkYXRhLnZhcmlhYmxlLnN1YnByb2ZpbGVJZCAhPSBcIlwiKXtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gZGF0YS52YXJpYWJsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgLy8gdmFyIHByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgdmFyIHByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lID0gIHN1YnByb2ZpbGVJZCArICc6dmFyaWFibGVzJztcblxuICAgICAgICAgICAgICAgIGRhby5nZXQocHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUpLnRoZW4oZnVuY3Rpb24oZmlsZSkge1xuXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbmFsVmFsdWUgPSBmaWxlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aFRvRWxlbWVudCA9IHZhcmlhYmxlTmFtZSA9PSBcIlwiID8gW10gOiB2YXJpYWJsZU5hbWUuc3BsaXQoL1snXCJcXFtcXF0uXSsvKTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHBhdGhUb0VsZW1lbnQubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBhdGhUb0VsZW1lbnRba10gPT0gXCJcIikgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlID0gZmluYWxWYWx1ZVtwYXRoVG9FbGVtZW50W2tdXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gZmluYWxWYWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICBpZihvYmogPT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIlZhcmlhYmxlIG5vdCBmb3VuZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2Ygb2JqID09ICdvYmplY3QnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihkYXRhLnZhcmlhYmxlLnBlcmlvZGljID09IHVuZGVmaW5lZCB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnZhcmlhYmxlLnBlcmlvZGljLnNlcSA9PSB1bmRlZmluZWQpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy92YXIgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3NUeXBlID0gSlNPTi54cGF0aChcIi9jb25maWcvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tfaWQgZXEgL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWRdL3R5cGVcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgKHN1YnByb2Nlc3NUeXBlID09IFBST0NFU1NfVFlQRV9TVUJQUk9GSUxFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWQgYW5kIF9pZCA9IC9zdWJwcm9jZXNzZXNbX2lkID0gXCIgKyBwYXJ0ICsgXCJdL19pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnByb2Nlc3NUeXBlID09IFBST0NFU1NfVFlQRV9TVUJQUk9GSUxFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZCBhbmQgdXVpZCA9IFwiKyBwYXJ0ICtcIl0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VxID0gZ2V0Tm9kZVZhbHVlKGRhdGEudmFyaWFibGUucGVyaW9kaWMuc2VxLCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZQYXJhbSA9IFwidmFsdWVcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRhdGEudmFyaWFibGUucGVyaW9kaWMgIT0gdW5kZWZpbmVkICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEudmFyaWFibGUucGVyaW9kaWMudmFsdWUgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdlBhcmFtID0gZ2V0Tm9kZVZhbHVlKGRhdGEudmFyaWFibGUucGVyaW9kaWMudmFsdWUsIF9XRkluc3RhbmNlLCB1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVQYXRoID0gXCIvXCIgKyB2YXJpYWJsZU5hbWUgKyBcIltcIiArIHNlcSArIFwiXS9cIiArIHZQYXJhbTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXRWYWx1ZSA9IEpTT04ueHBhdGgodmFsdWVQYXRoLCBmaWxlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJldFZhbHVlKTtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygb2JqID09ICdzdHJpbmcnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob2JqKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkVSUk9SOiBzdWIgUHJvZmlsZSB2YXJpYWJsZXMgbm90IGZvdW5kXCIpO1xuXG4gICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWplY3QoXCJFUlJPUjogVW5pbXBsZW1lbnRlZCBwcm9maWxlIHR5cGUgZm91bmQuXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YS5pbmRpY2F0b3JXcmFwcGVyICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZGF0YS5pbmRpY2F0b3JXcmFwcGVyLmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBpbmRpY2F0b3JTZXQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIHZhciBlbGVtZW50cGF0aCA9IHJlcGxhY2VBbGwoZGF0YS5pbmRpY2F0b3JXcmFwcGVyLnBhdGgsIFwiWy5dXCIsIFwiL1wiKVxuICAgICAgICAgICAgdmFyIHhwYXRoID0gJy8nICsgZWxlbWVudHBhdGhcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG5cbiAgICAgICAgfSBlbHNlIGlmIChkYXRhLmNhbGN1bGF0ZWQgIT0gdW5kZWZpbmVkKSB7XG5cblxuICAgICAgICAgICAgdmFyIHZhbHVlID0gJyc7XG4gICAgICAgICAgICB2YXIgc2VwYXJhdG9yID0gZGF0YS5jYWxjdWxhdGVkLnNlcGFyYXRvcjtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmNhbGN1bGF0ZWQuZWxlbWVudHMubGVuZ3RoIC0gMTsgaSsrKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHMgPSBkYXRhLmNhbGN1bGF0ZWQuZWxlbWVudHM7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHBvc3NpYmxlSXRlbXMgPSBbXCJmcm9tUmVwZWF0XCIsIFwiZWxlbWVudFByb3BlcnR5XCIsIFwiY29uc3RhbnRWYWx1ZVwiLCBcImVsZW1lbnRXcmFwcGVyXCIsIFwiY3VycmVudERhdGVcIiwgXCJyYW5kb21EaWdpdHNcIiwgXCJwcm9maWxlT2JqZWN0RWxlbWVudFwiLCBcInByb2ZpbGVPYmplY3RXcmFwcGVyXCIsIFwiY3VycmVudEZpbmFuY2lhbFllYXJcIiwgXCJzY29wZVZhcmlhYmxlXCIsIFwieHBhdGhcIl07XG4gICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhlbGVtZW50c1tpXSwgcG9zc2libGVJdGVtcykpIHtcblxuICAgICAgICAgICAgICAgICAgICBjYXNlICdlbGVtZW50UHJvcGVydHknOlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldCA9IGVsZW1lbnRzW2ldLmVsZW1lbnRQcm9wZXJ0eS5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgaW5kaWNhdG9yU2V0ICsgXCInXS9pbnN0YW5jZXMvdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLmVsZW1lbnRQcm9wZXJ0eS5lbGVtZW50SWQsIFwiWy5dXCIsIFwiL1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy9tb2RlbC9wZW5kaW5nL2RhdGEvJyArIGluZGljYXRvclNldCArICcvJyArIGVsZW1lbnRwYXRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY29uc3RhbnRWYWx1ZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtVmFsdWUgPSBlbGVtZW50c1tpXS5jb25zdGFudFZhbHVlLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Njb3BlVmFyaWFibGUnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFyTmFtZSA9IGVsZW1lbnRzW2ldLnNjb3BlVmFyaWFibGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHZhck5hbWUgPT0gXCIjVVNFUl9JRFwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtVmFsdWUgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodmFyTmFtZSA9PSBcIiNVU0VSTkFNRVwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtVmFsdWUgPSBfbGNseC5TRVNTSU9OLnVzZXJuYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih2YXJOYW1lID09IFwiI0ZJUlNUTkFNRVwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtVmFsdWUgPSBfbGNseC5TRVNTSU9OLmZpcnN0TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodmFyTmFtZSA9PSBcIiNMQVNUTkFNRVwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtVmFsdWUgPSBfbGNseC5TRVNTSU9OLmxhc3ROYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoaXRlbVZhbHVlLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWUgKyBzZXBhcmF0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2VsZW1lbnRXcmFwcGVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXQgPSBlbGVtZW50c1tpXS5lbGVtZW50V3JhcHBlci5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgaW5kaWNhdG9yU2V0ICsgXCInXS9pbnN0YW5jZXMvdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cGF0aCA9IHJlcGxhY2VBbGwoZWxlbWVudHNbaV0uZWxlbWVudFdyYXBwZXIuZWxlbWVudElkLCBcIlsuXVwiLCBcIi9cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvJyArIGVsZW1lbnRwYXRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY3VycmVudERhdGUnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgZm9ybWF0RGF0ZShuZXcgRGF0ZSgpKSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JhbmRvbURpZ2l0cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGlnaXRzID0gZWxlbWVudHNbaV0ucmFuZG9tRGlnaXRzLmRpZ2l0cztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByYW5kb20gPSBNYXRoLnJhbmRvbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4cCA9IE1hdGgucG93KDEwLCBkaWdpdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGludFBhcnQgPSAocmFuZG9tICogZXhwKSBeIDBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpbnRQYXJ0ICsgc2VwYXJhdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAncHJvZmlsZU9iamVjdEVsZW1lbnQnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZWxlbWVudHNbaV0ucHJvZmlsZU9iamVjdEVsZW1lbnQuaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ2FwcFByb2ZpbGUnXVwiLCBhcHAuU0NPUEUud29ya2Zsb3csIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cGF0aCA9IHJlcGxhY2VBbGwoZWxlbWVudHNbaV0ucHJvZmlsZU9iamVjdEVsZW1lbnQuZWxlbWVudElkLCBcIlsuXVwiLCBcIi9cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvbW9kZWwvcGVuZGluZy9kYXRhLycgKyBpbmRpY2F0b3JTZXQgKyAnLycgKyBlbGVtZW50cGF0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtVmFsdWUgPSBKU09OLnhwYXRoKHhwYXRoLCBpbmRPYmplY3QsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWUgKyBzZXBhcmF0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBjYXNlICdwcm9maWxlT2JqZWN0V3JhcHBlcic6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXQgPSBlbGVtZW50c1tpXS5wcm9maWxlT2JqZWN0V3JhcHBlci5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnYXBwUHJvZmlsZSddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRwYXRoID0gcmVwbGFjZUFsbChlbGVtZW50c1tpXS5wcm9maWxlT2JqZWN0V3JhcHBlci53cmFwcGVyRWxlbWVudElkLCBcIlsuXVwiLCBcIi9cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvJyArIGVsZW1lbnRwYXRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdjdXJyZW50RmluYW5jaWFsWWVhcic6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGFydERhdGUgPSBlbGVtZW50c1tpXS5jdXJyZW50RmluYW5jaWFsWWVhci5zdGFydERhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnRNb250aCA9IGVsZW1lbnRzW2ldLmN1cnJlbnRGaW5hbmNpYWxZZWFyLnN0YXJ0TW9udGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmluYW5jaWFsWWVhciA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKSArIFwiLVwiICsgc3RhcnRNb250aCArIFwiLVwiICsgc3RhcnREYXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGZpbmFuY2lhbFllYXIgKyBzZXBhcmF0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZnJvbVJlcGVhdCc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXQgPSBlbGVtZW50c1tpXS5mcm9tUmVwZWF0LmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBpbmRpY2F0b3JTZXQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLmZyb21SZXBlYXQucGF0aCwgXCJbLl1cIiwgXCIvXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy9tb2RlbC9wZW5kaW5nL2RhdGEvJyArIGluZGljYXRvclNldCArICcvJyArIGVsZW1lbnRwYXRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbHRlciA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVsZW1lbnRzW2ldLmZyb21SZXBlYXQuZmlsdGVyID09ICd2YWxpZERhdGUnKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3AgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmQgPSBzcC5kYXRlcy52YWxpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXIgPSBcIltlbmRkYXRlIGVxICdcIisgdmQgK1wiJ10vXCJcbiAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB4cGF0aCA9IHhwYXRoICsgZmlsdGVyICsgcmVwbGFjZUFsbChlbGVtZW50c1tpXS5mcm9tUmVwZWF0LmVsZW1lbnQsIFwiWy5dXCIsIFwiL1wiKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAneHBhdGgnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoZWxlbWVudHNbaV0ueHBhdGguaW5kaWNhdG9yU2V0SWQgIT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgZWxlbWVudHNbaV0ueHBhdGguaW5kaWNhdG9yU2V0SWQubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldCA9IGVsZW1lbnRzW2ldLnhwYXRoLmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgaW5kaWNhdG9yU2V0ICsgXCInXS9pbnN0YW5jZXMvdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoZWxlbWVudHNbaV0ueHBhdGguZXhwciwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoZWxlbWVudHNbaV0ueHBhdGguZXhwciwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlICsgc2VwYXJhdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGkgPSBkYXRhLmNhbGN1bGF0ZWQuZWxlbWVudHMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIHZhciBlbGVtZW50cyA9IGRhdGEuY2FsY3VsYXRlZC5lbGVtZW50cztcblxuICAgICAgICAgICAgdmFyIHBvc3NpYmxlSXRlbXMgPSBbXCJmcm9tUmVwZWF0XCIsXCJlbGVtZW50UHJvcGVydHlcIiwgXCJjb25zdGFudFZhbHVlXCIsIFwiZWxlbWVudFdyYXBwZXJcIiwgXCJjdXJyZW50RGF0ZVwiLCBcInJhbmRvbURpZ2l0c1wiLCBcInByb2ZpbGVPYmplY3RFbGVtZW50XCIsIFwicHJvZmlsZU9iamVjdFdyYXBwZXJcIiwgXCJjdXJyZW50RmluYW5jaWFsWWVhclwiLCBcInNjb3BlVmFyaWFibGVcIiwgXCJ4cGF0aFwiXTtcbiAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoZWxlbWVudHNbaV0sIHBvc3NpYmxlSXRlbXMpKSB7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdlbGVtZW50UHJvcGVydHknOlxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZWxlbWVudHNbaV0uZWxlbWVudFByb3BlcnR5LmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIGluZGljYXRvclNldCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cGF0aCA9IHJlcGxhY2VBbGwoZWxlbWVudHNbaV0uZWxlbWVudFByb3BlcnR5LmVsZW1lbnRJZCwgXCJbLl1cIiwgXCIvXCIpXG4gICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvbW9kZWwvcGVuZGluZy9kYXRhLycgKyBpbmRpY2F0b3JTZXQgKyAnLycgKyBlbGVtZW50cGF0aDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuXG4gICAgICAgICAgICAgICAgY2FzZSAnY29uc3RhbnRWYWx1ZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IGVsZW1lbnRzW2ldLmNvbnN0YW50VmFsdWUudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3Njb3BlVmFyaWFibGUnOlxuXG4gICAgICAgICAgICAgICAgICAgIHZhciB2YXJOYW1lID0gZWxlbWVudHNbaV0uc2NvcGVWYXJpYWJsZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmKHZhck5hbWUgPT0gXCIjVVNFUl9JRFwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1WYWx1ZSA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodmFyTmFtZSA9PSBcIiNVU0VSTkFNRVwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1WYWx1ZSA9IF9sY2x4LlNFU1NJT04udXNlcm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih2YXJOYW1lID09IFwiI0ZJUlNUTkFNRVwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1WYWx1ZSA9IF9sY2x4LlNFU1NJT04uZmlyc3ROYW1lO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodmFyTmFtZSA9PSBcIiNMQVNUTkFNRVwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1WYWx1ZSA9IF9sY2x4LlNFU1NJT04ubGFzdE5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYoaXRlbVZhbHVlLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdlbGVtZW50V3JhcHBlcic6XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXQgPSBlbGVtZW50c1tpXS5lbGVtZW50V3JhcHBlci5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBpbmRpY2F0b3JTZXQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLmVsZW1lbnRXcmFwcGVyLmVsZW1lbnRJZCwgXCJbLl1cIiwgXCIvXCIpXG4gICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvJyArIGVsZW1lbnRwYXRoO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cbiAgICAgICAgICAgICAgICBjYXNlICdjdXJyZW50RGF0ZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGZvcm1hdERhdGUobmV3IERhdGUoKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAncmFuZG9tRGlnaXRzJzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRpZ2l0cyA9IGVsZW1lbnRzW2ldLnJhbmRvbURpZ2l0cy5kaWdpdHM7XG4gICAgICAgICAgICAgICAgICAgIHZhciByYW5kb20gPSBNYXRoLnJhbmRvbSgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXhwID0gTWF0aC5wb3coMTAsIGRpZ2l0cyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbnRQYXJ0ID0gKHJhbmRvbSAqIGV4cCkgXiAwXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpbnRQYXJ0O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3Byb2ZpbGVPYmplY3RFbGVtZW50JzpcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZWxlbWVudHNbaV0ucHJvZmlsZU9iamVjdEVsZW1lbnQuaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnYXBwUHJvZmlsZSddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLnByb2ZpbGVPYmplY3RFbGVtZW50LmVsZW1lbnRJZCwgXCJbLl1cIiwgXCIvXCIpXG4gICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvbW9kZWwvcGVuZGluZy9kYXRhLycgKyBpbmRpY2F0b3JTZXQgKyAnLycgKyBlbGVtZW50cGF0aDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3Byb2ZpbGVPYmplY3RXcmFwcGVyJzpcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZWxlbWVudHNbaV0ucHJvZmlsZU9iamVjdFdyYXBwZXIuaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnYXBwUHJvZmlsZSddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLnByb2ZpbGVPYmplY3RXcmFwcGVyLndyYXBwZXJFbGVtZW50SWQsIFwiWy5dXCIsIFwiL1wiKVxuICAgICAgICAgICAgICAgICAgICB2YXIgeHBhdGggPSAnLycgKyBlbGVtZW50cGF0aDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2N1cnJlbnRGaW5hbmNpYWxZZWFyJzpcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnREYXRlID0gZWxlbWVudHNbaV0uY3VycmVudEZpbmFuY2lhbFllYXIuc3RhcnREYXRlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnRNb250aCA9IGVsZW1lbnRzW2ldLmN1cnJlbnRGaW5hbmNpYWxZZWFyLnN0YXJ0TW9udGg7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmaW5hbmNpYWxZZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpICsgXCItXCIgKyBzdGFydE1vbnRoICsgXCItXCIgKyBzdGFydERhdGU7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBmaW5hbmNpYWxZZWFyO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjYXNlICdmcm9tUmVwZWF0JzpcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZWxlbWVudHNbaV0uZnJvbVJlcGVhdC5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBpbmRpY2F0b3JTZXQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLmZyb21SZXBlYXQucGF0aCwgXCJbLl1cIiwgXCIvXCIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgeHBhdGggPSAnL21vZGVsL3BlbmRpbmcvZGF0YS8nICsgaW5kaWNhdG9yU2V0ICsgJy8nICsgZWxlbWVudHBhdGg7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmaWx0ZXIgPSAnJztcbiAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYoZWxlbWVudHNbaV0uZnJvbVJlcGVhdC5maWx0ZXIgPT0gJ3ZhbGlkRGF0ZScpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNwID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmQgPSBzcC5kYXRlcy52YWxpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlciA9IFwiW2VuZGRhdGUgZXEgJ1wiKyB2ZCArXCInXS9cIlxuICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHhwYXRoID0geHBhdGggKyBmaWx0ZXIgKyByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLmZyb21SZXBlYXQuZWxlbWVudCwgXCJbLl1cIiwgXCIvXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBpdGVtVmFsdWUgPSBKU09OLnhwYXRoKHhwYXRoLCBpbmRPYmplY3QsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICd4cGF0aCc6XG4gICAgICAgICAgICAgICAgICAgIGlmKGVsZW1lbnRzW2ldLnhwYXRoLmluZGljYXRvclNldElkICE9IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgZWxlbWVudHNbaV0ueHBhdGguaW5kaWNhdG9yU2V0SWQubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZWxlbWVudHNbaV0ueHBhdGguaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIGluZGljYXRvclNldCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gSlNPTi54cGF0aChlbGVtZW50c1tpXS54cGF0aC5leHByLCBpbmRPYmplY3QsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWUgKyBzZXBhcmF0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoZWxlbWVudHNbaV0ueHBhdGguZXhwciwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWUgKyBzZXBhcmF0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuXG5cblxuICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG5cbiAgICAgICAgfSBlbHNlIGlmIChkYXRhLnN1YlByb2Nlc3MgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgIGlmIChkYXRhLnN1YlByb2Nlc3MucGF0aCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgIHZhciBwYXRoID0gZGF0YS5zdWJQcm9jZXNzLnBhdGg7XG4gICAgICAgICAgICAgICAgdmFyIGFyciA9IHBhdGguc3BsaXQoXCIuXCIpO1xuICAgICAgICAgICAgICAgIHZhciBwYXRoSXRlbXMgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhdGhJdGVtcyA9IHBhdGhJdGVtcyArIFwiWydcIiArIGFycltpXSArIFwiJ11cIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3MgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgZmluYWxWYWx1ZSA9IHN1YnByb2Nlc3M7XG4gICAgICAgICAgICAgICAgdmFyIHBhdGhUb0VsZW1lbnQgPSBwYXRoSXRlbXMgPT0gXCJcIiA/IFtdIDogcGF0aEl0ZW1zLnNwbGl0KC9bJ1wiXFxbXFxdLl0rLyk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHBhdGhUb0VsZW1lbnQubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYocGF0aFRvRWxlbWVudFtrXSA9PSBcIlwiKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IGZpbmFsVmFsdWVbcGF0aFRvRWxlbWVudFtrXV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGZpbmFsVmFsdWU7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSlcblxuICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLnN1YlByb2Nlc3Muc3RlcFVzZXIgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgfVxuXG4gICAgfSk7XG5cblxuXG59O1xuXG5cbmZ1bmN0aW9uIHJlcGxhY2VBbGwodHh0LCByZXBsYWNlLCB3aXRoX3RoaXMpIHtcbiAgICBpZiAodHlwZW9mIHR4dC5yZXBsYWNlICE9ICdmdW5jdGlvbicpIHtcbiAgICAgICAgY29uc29sZS5sb2cocmVwbGFjZSArICcgJyArIHdpdGhfdGhpcyk7XG4gICAgICAgIGNvbnNvbGUubG9nKHR4dCk7XG4gICAgfVxuICAgIHJldHVybiB0eHQucmVwbGFjZShuZXcgUmVnRXhwKHJlcGxhY2UsICdnJyksIHdpdGhfdGhpcyk7XG59XG5cbmZ1bmN0aW9uIGZvcm1hdERhdGUoZGF0ZSkge1xuXG4gICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF0ZSgpO1xuICAgIHZhciBtb250aEluZGV4ID0gZGF0ZS5nZXRNb250aCgpO1xuICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xuXG4gICAgcmV0dXJuIGRheSArICctJyArIG1vbnRoSW5kZXggKyAnLScgKyB5ZWFyO1xufVxuXG5cbmZ1bmN0aW9uIGNvbXBhcmUoc3ViamVjdCwgb3BlcmF0b3IsIHZhbHVlKSB7XG4gICAgc3dpdGNoIChvcGVyYXRvcikge1xuICAgICAgICBjYXNlICc+JzpcbiAgICAgICAgICAgIHJldHVybiBzdWJqZWN0ID4gdmFsdWU7XG4gICAgICAgIGNhc2UgJzwnOlxuICAgICAgICAgICAgcmV0dXJuIHN1YmplY3QgPCB2YWx1ZTtcbiAgICAgICAgY2FzZSAnPj0nOlxuICAgICAgICAgICAgcmV0dXJuIHN1YmplY3QgPj0gdmFsdWU7XG4gICAgICAgIGNhc2UgJzw9JzpcbiAgICAgICAgICAgIHJldHVybiBzdWJqZWN0IDw9IHZhbHVlO1xuICAgICAgICBjYXNlICc9PSc6XG4gICAgICAgICAgICBpZihzdWJqZWN0ID09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgc3ViamVjdCA9IFwiXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gc3ViamVjdCA9PT0gdmFsdWU7XG4gICAgICAgIGNhc2UgJyE9JzpcbiAgICAgICAgICAgIHJldHVybiBzdWJqZWN0ICE9PSB2YWx1ZTtcbiAgICB9XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0ge1xuXG4gICAgZ2V0TGFuZ3VhZ2VNZXNzYWdlOiBnZXRMYW5ndWFnZU1lc3NhZ2UsXG4gICAgZ2V0Tm9kZVZhbHVlOiBnZXROb2RlVmFsdWUsXG4gICAgY29tcGFyZTogY29tcGFyZVxuXG59IiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbCA9IHJlcXVpcmUoJ3V0aWxpdHknKTtcblxuLyoqXG4gKiBVc2VyIEludGVyZmFjZSBNb2R1bGVcbiAqXG4gKiBAbW9kdWxlIGxpYi91aVxuICogQGF1dGhvciBCcmVudCBHb3Jkb25cbiAqIEB2ZXJzaW9uIDAuMS4wXG4gKiBAZGVzY3JpcHRpb24gdGVzdCBkZXNjcmlwdGlvblxuICpcbiAqL1xuXG4gLyoqXG4gICogR2V0IGFsbCBwcm9jZXNzIHN1Yi1wcm9jZXNzZXMgdXNlciBpbnRlcmZhY2UgZGF0YVxuICAqXG4gICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAgKiBAcGFyYW0ge3N0cmluZ30gbGFuZyAtIHRoZSB1c2VyIHByZWZmZXJlZCBsYW5nYXVnZVxuICAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gICpcbiAgKiBAZXhhbXBsZSAnJ1xuICAqXG4gICogQHJldHVybiAnJ1xuICAqXG4gICovXG4gZnVuY3Rpb24gZ2V0UHJvY2Vzcyhwcm9jZXNzSWQsIGxhbmcsIF9XRkluc3RhbmNlKXtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHRyeSB7XG4gICAgICB2YXIgcHJvY2Vzc01vZGVsID0gW107XG4gICAgICB2YXIgcHJvY2Vzc0luc3RhbmNlID0gW107XG4gICAgXHRfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHByb2Nlc3NJdGVtKXtcbiAgICBcdFx0aWYgKHByb2Nlc3NJdGVtLmlkID09IHByb2Nlc3NJZCkge1xuICAgIFx0XHRcdHByb2Nlc3NJbnN0YW5jZSA9IHByb2Nlc3NJdGVtO1xuICAgIFx0XHR9XG4gICAgXHR9KVxuICAgICAgLy8gY29uc29sZS5sb2cocHJvY2Vzc0luc3RhbmNlLnN1YlByb2Nlc3Nlcy5sZW5ndGgpO1xuICAgICAgdXRpbC5zeW5jTG9vcChwcm9jZXNzSW5zdGFuY2Uuc3ViUHJvY2Vzc2VzLmxlbmd0aCwgZnVuY3Rpb24obG9vcCl7XG4gIFx0XHRcdHZhciBjb3VudGVyID0gbG9vcC5pdGVyYXRpb24oKTtcbiAgICAgICAgdmFyIHByb2Nlc3NTZXEgPSBwcm9jZXNzSW5zdGFuY2Uuc2VxO1xuICAgICAgICB2YXIgc3ViUHJvY2Vzc0lkID0gcHJvY2Vzc0luc3RhbmNlLnN1YlByb2Nlc3Nlc1tjb3VudGVyXS5pZDtcbiAgICAgICAgdmFyIHN1YlByb2Nlc3NTZXEgPSBwcm9jZXNzSW5zdGFuY2Uuc3ViUHJvY2Vzc2VzW2NvdW50ZXJdLnNlcTtcbiAgICAgICAgZ2V0U3ViUHJvY2Vzcyhwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgbGFuZywgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24obW9kZWwpe1xuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKG1vZGVsKTtcbiAgICAgICAgICBwcm9jZXNzTW9kZWwucHVzaChtb2RlbCk7XG4gICAgICAgICAgbG9vcC5uZXh0KCk7XG4gICAgICAgICAgLy8gY29uc29sZS5sb2cocHJvY2Vzc01vZGVsKTtcbiAgXHRcdFx0fSwgZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhwcm9jZXNzTW9kZWwpO1xuICBcdFx0XHRcdGxvb3AuYnJlYWsoKTtcbiAgXHRcdFx0XHRyZWplY3QoZXJyKTtcbiAgXHRcdFx0fSk7XG4gIFx0XHR9LCBmdW5jdGlvbigpe1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhwcm9jZXNzTW9kZWwpO1xuICBcdFx0XHRyZXNvbHZlKHByb2Nlc3NNb2RlbCk7XG4gIFx0XHR9KTtcbiAgICB9IGNhdGNoKGVycil7XG4gICAgICByZWplY3QoZXJyKTtcbiAgICB9XG4gIH0pXG59O1xuXG4gLyoqXG4gICogR2V0IFN1YlByb2Nlc3MgdXNlciBpbnRlcmZhY2UgZGF0YVxuICAqXG4gICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAgKiBAcGFyYW0ge251bWJlcn0gcHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBwcm9jZXNzIHNlcVxuICAqIEBwYXJhbSB7c3RyaW5nfSBzdWJQcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdWItcHJvY2VzcyBpZFxuICAqIEBwYXJhbSB7bnVtYmVyfSBzdWJQcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHN1Yi1wcm9jZXNzIHNlcVxuICAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gICpcbiAgKiBAZXhhbXBsZSAnJ1xuICAqXG4gICogQHJldHVybiAnJ1xuICAqXG4gICovXG5mdW5jdGlvbiBnZXRTdWJQcm9jZXNzKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBsYW5nLCBfV0ZJbnN0YW5jZSl7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICB0cnkge1xuICAgICAgdmFyIG1vZGVsID0ge1xuICAgICAgICBpZDogJycsXG4gICAgICAgIHNlcTogJycsXG4gICAgICAgIG5hbWU6ICcnLFxuICAgICAgICBoZWxwOiAnJyxcbiAgICAgICAgZGF0ZXM6ICcnLFxuICAgICAgICBzdGVwOiAnJ1xuICAgICAgfTtcbiAgICAgIHZhciBzdWJQcm9jZXNzID0gW107XG4gICAgXHR2YXIgc3ViUHJvY2Vzc0NvbmYgPSBbXTtcbiAgICBcdF9XRkluc3RhbmNlLmluc3RhbmNlLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ocHJvY2Vzc0l0ZW0pe1xuICAgIFx0XHRpZiAocHJvY2Vzc0l0ZW0uaWQgPT0gcHJvY2Vzc0lkICYmIHByb2Nlc3NJdGVtLnNlcSA9PSBwcm9jZXNzU2VxKSB7XG4gICAgXHRcdFx0dmFyIHNwTGVuZ3RoID0gcHJvY2Vzc0l0ZW0uc3ViUHJvY2Vzc2VzLmxlbmd0aDtcbiAgICBcdFx0XHRwcm9jZXNzSXRlbS5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NJdGVtKXtcbiAgICBcdFx0XHRcdGlmIChzdWJQcm9jZXNzSXRlbS5pZCA9PSBzdWJQcm9jZXNzSWQgJiYgc3ViUHJvY2Vzc0l0ZW0uc2VxID09IHN1YlByb2Nlc3NTZXEgJiYgc3ViUHJvY2Vzc0l0ZW0uY29tcGxldGUgPT0gZmFsc2UpIHtcbiAgICBcdFx0XHRcdFx0c3ViUHJvY2VzcyA9IHN1YlByb2Nlc3NJdGVtO1xuICAgIFx0XHRcdFx0fVxuICAgIFx0XHRcdH0pXG4gICAgXHRcdH1cbiAgICBcdH0pXG4gICAgXHQvLyBHZXQgdGhlIGN1cnJlbnQgc3ViUHJvY2VzcyBjb25maWd1cmF0aW9uXG4gICAgXHRfV0ZJbnN0YW5jZS5jb25maWcucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihwcm9jZXNzQ29uZmlnKXtcbiAgICBcdFx0aWYgKHByb2Nlc3NDb25maWcuX2lkID09IHByb2Nlc3NJZCkge1xuICAgIFx0XHRcdHByb2Nlc3NDb25maWcuc3ViUHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihzdWJQcm9jZXNzQ29uZmlnKXtcbiAgICBcdFx0XHRcdGlmIChzdWJQcm9jZXNzQ29uZmlnLl9pZCA9PSBzdWJQcm9jZXNzSWQpIHtcbiAgICBcdFx0XHRcdFx0c3ViUHJvY2Vzc0NvbmYgPSBzdWJQcm9jZXNzQ29uZmlnO1xuICAgIFx0XHRcdFx0fVxuICAgIFx0XHRcdH0pXG4gICAgXHRcdH1cbiAgICBcdH0pXG4gICAgICAvLyBVcGRhdGUgdGhlIG1vZGVsXG4gICAgICBtb2RlbC5pZCA9IHN1YlByb2Nlc3NDb25mLl9pZDtcbiAgICAgIG1vZGVsLnNlcSA9IHN1YlByb2Nlc3Muc2VxO1xuICAgICAgbW9kZWwubmFtZSA9IHV0aWwuZ2V0TmFtZShzdWJQcm9jZXNzQ29uZi5uYW1lLCBsYW5nKTtcbiAgICAgIG1vZGVsLmhlbHAgPSB1dGlsLmdldE5hbWUoc3ViUHJvY2Vzc0NvbmYuaGVscCwgbGFuZyk7XG4gICAgICBtb2RlbC5kYXRlcyA9IHN1YlByb2Nlc3MuZGF0ZXM7XG4gICAgICBtb2RlbC5zdGVwID0gc3ViUHJvY2Vzcy5zdGVwO1xuICAgICAgcmVzb2x2ZShtb2RlbCk7XG4gICAgfSBjYXRjaChlcnIpIHtcbiAgICAgIHJlamVjdChlcnIpO1xuICAgIH1cbiAgfSlcbn07XG5cblxuXG5cbmZ1bmN0aW9uIHByZXBhcmVOb3RpZmljYXRpb25TY3JlZW4oKXtcblxuICBcIlwiXG59O1xuXG4gbW9kdWxlLmV4cG9ydHMgPSB7XG5cbiAgZ2V0UHJvY2VzczogZ2V0UHJvY2Vzc1xuXG4gfVxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5cbmZ1bmN0aW9uIGdldCgpIHtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgIH0pO1xuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuICAgIGdldDogZ2V0XG5cbn0iLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlsID0gcmVxdWlyZSgndXRpbGl0eScpO1xudmFyIGFjdGlvbnNNb2R1bGUgPSByZXF1aXJlKCcuL2FjdGlvbnMnKTtcbnZhciBoZWxwZXIgPSByZXF1aXJlKCcuL2hlbHBlcicpO1xudmFyIGZvcm0gPSByZXF1aXJlKCcuL2Zvcm0nKTtcblxuLyoqXG4gKiBQcm9jZXNzIE1vZHVsZVxuICpcbiAqIEBtb2R1bGUgbGliL3Byb2Nlc3NcbiAqIEBhdXRob3IgSGFzYW4gQWJiYXNcbiAqIEB2ZXJzaW9uIDAuMi4xXG4gKiBAZGVzY3JpcHRpb24gV29ya2Zsb3cgaW1wbGVtZW50YXRpb24gY2hhbmdlZCBhcyBwZXIgbmV3IHNjaGVtYSBpbXBsZW1lbnRhdGlvblxuICpcbiAqL1xuXG4vKipcbiAqIENvdW50IGFuIGFycmF5IG9mIGl0ZW1zXG4gKlxuICogQHBhcmFtIHtBcnJheX0gYXJyIC0gdGhlIGFycmF5IGRhdGFcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIGNvdW50KGFycikge1xuICAgIGlmIChhcnIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gYXJyLmxlbmd0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG5cbn07XG5cbi8qKlxuICogUHJvY2VzcyBwcmUtcmVxdWlzaXRlc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBwcmVyZXF1aXNpdGVzIC0gdGhlIHByZS1yZXF1aXNpdGVzIGNvbmZpZyBkYXRhXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBwcmVSZXF1aXNpdGVzKHByZXJlcXVpc2l0ZXMsIF9XRkluc3RhbmNlLCBzcHV1aWQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIC8vIFVuY29tbWVudCBiZWxvdyBzZWN0aW9uIHdoZW4gcmVhZHkgdG8gaW1wbGVtZW50XG4gICAgICAgIHZhciBjb21wbGV0ZWQgPSBbXTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHV0aWwuc3luY0xvb3AocHJlcmVxdWlzaXRlcy5sZW5ndGgsIGZ1bmN0aW9uKGxvb3ApIHtcbiAgICAgICAgICAgICAgICB2YXIgY291bnRlciA9IGxvb3AuaXRlcmF0aW9uKCk7XG4gICAgICAgICAgICAgICAgcHJlUmVxdWlzaXRlKHByZXJlcXVpc2l0ZXNbY291bnRlcl0sIF9XRkluc3RhbmNlLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBhbGwgcHJlLXJlcXVpc2l0ZXMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS5cbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGVkLnB1c2godHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGxvb3AubmV4dCgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWQucHVzaChmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIGxvb3AuYnJlYWsoKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoY29tcGxldGVkLmV2ZXJ5KEJvb2xlYW4pKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdQcmUtcmVxdWlzaXRlcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywgJ05vdCBhbGwgcHJlLXJlcXVpc2l0ZXMgcGFzc2VkLicpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pO1xufTtcblxuLyoqXG4gKiBQcm9jZXNzIHByZS1yZXF1aXNpdGUsIGV4ZWN1dGUgdGhlIHByZS1yZXF1aXNpdGUgY29uZGl0aW9uLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBwcmVyZXF1aXNpdGUgLSB0aGUgcHJlLXJlcXVpc2l0ZSBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGVcbiAqIFByb2Nlc3MucHJlUmVxdWlzaXRlKGNvbmZpZywgY291bnRlciwgaW5zdGFuY2UsIGRvYyk7XG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gcHJlUmVxdWlzaXRlKHByZXJlcXVpc2l0ZSwgX1dGSW5zdGFuY2UsIHNwdXVpZCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuXG5cbiAgICAgICAgaWYgKHByZXJlcXVpc2l0ZS5jaGVjay5udW1iZXJQcm9jZXNzSW5zdGFuY2VzICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICB2YXIgbnVtYmVyUHJvY2Vzc0luc3RhbmNlcyA9IHByZXJlcXVpc2l0ZS5jaGVjay5udW1iZXJQcm9jZXNzSW5zdGFuY2VzO1xuICAgICAgICAgICAgdmFyIF9maWx0ZXJPcGVyYXRvciA9IG51bWJlclByb2Nlc3NJbnN0YW5jZXMub3BlcmF0b3I7XG4gICAgICAgICAgICB2YXIgeHBhdGhPcGVyYXRvciA9ICcnO1xuICAgICAgICAgICAgc3dpdGNoIChfZmlsdGVyT3BlcmF0b3IpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdncmVhdGVyVGhhbic6XG4gICAgICAgICAgICAgICAgICAgIHhwYXRoT3BlcmF0b3IgPSAnZ3QnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdsZXNzVGhhbic6XG4gICAgICAgICAgICAgICAgICAgIHhwYXRoT3BlcmF0b3IgPSAnbHQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdncmVhdGVyVGhhbkVxdWFsJzpcbiAgICAgICAgICAgICAgICAgICAgeHBhdGhPcGVyYXRvciA9ICdnZSc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2xlc3NUaGFuRXF1YWwnOlxuICAgICAgICAgICAgICAgICAgICB4cGF0aE9wZXJhdG9yID0gJ2xlJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZXF1YWxUbyc6XG4gICAgICAgICAgICAgICAgICAgIHhwYXRoT3BlcmF0b3IgPSAnZXEnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdub3RFcXVhbFRvJzpcbiAgICAgICAgICAgICAgICAgICAgeHBhdGhPcGVyYXRvciA9ICduZSc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgX3N1YnByb2Nlc3NJZCA9IG51bWJlclByb2Nlc3NJbnN0YW5jZXMuc3ViUHJvY2Vzc0lkO1xuXG4gICAgICAgICAgICB2YXIgX2ZpbHRlclZhbHVlID0gbnVtYmVyUHJvY2Vzc0luc3RhbmNlcy50eXBlO1xuXG4gICAgICAgICAgICB2YXIgaW5uZXJYcGF0aCA9ICcnXG5cbiAgICAgICAgICAgIGlmIChfZmlsdGVyVmFsdWUgPT0gXCJhbGxcIikge1xuICAgICAgICAgICAgICAgIGlubmVyWHBhdGggPSAnJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5uZXJYcGF0aCA9IFwiW2NvbXBsZXRlIGVxICd0cnVlJ11cIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGFkZGl0aW9uYWxGaWx0ZXIgPSBcIlwiO1xuXG4gICAgICAgICAgICBpZiAobnVtYmVyUHJvY2Vzc0luc3RhbmNlcy5maWx0ZXIgIT0gdW5kZWZpbmVkICYmIG51bWJlclByb2Nlc3NJbnN0YW5jZXMuZmlsdGVyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBhZGRpdGlvbmFsRmlsdGVyID0gXCJbXCIgKyBudW1iZXJQcm9jZXNzSW5zdGFuY2VzLmZpbHRlciArIFwiXVwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZnVsbFBhdGggPSBcImNvdW50KC9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW2lkIGVxICdcIiArIF9zdWJwcm9jZXNzSWQgKyBcIiddXCIgKyBpbm5lclhwYXRoICsgYWRkaXRpb25hbEZpbHRlciArIFwiKVwiO1xuXG4gICAgICAgICAgICB2YXIgcHJlcmVxUHJvY2Vzc1R5cGUgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBfc3VicHJvY2Vzc0lkICsgXCInXS90eXBlXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgcGFydCA9IGxpYnJhcnkuZ2V0U3VicHJvZmlsZVN1YnByb2Nlc3NJZHMoKTtcblxuICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9ICcnICYmIHByZXJlcVByb2Nlc3NUeXBlICE9IHVuZGVmaW5lZCAmJiBwcmVyZXFQcm9jZXNzVHlwZSA9PSBQUk9DRVNTX1RZUEVfU1VCUFJPRklMRSkge1xuICAgICAgICAgICAgICAgIGZ1bGxQYXRoID0gXCJjb3VudCgvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpZCBlcSAnXCIgKyBfc3VicHJvY2Vzc0lkICsgXCInIGFuZCB1dWlkID0gXCIgKyBwYXJ0ICsgXCJdXCIgKyBpbm5lclhwYXRoICsgXCIpXCI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzdWJqZWN0Q291bnQgPSBKU09OLnhwYXRoKGZ1bGxQYXRoLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIGNvdW50VmFsdWUgPSBwcmVyZXF1aXNpdGUuY2hlY2subnVtYmVyUHJvY2Vzc0luc3RhbmNlcy5jb3VudDtcbiAgICAgICAgICAgIHZhciBjb21wYXJlID0gdXRpbC5jb21wYXJlKHN1YmplY3RDb3VudCwgcHJlcmVxdWlzaXRlLmNoZWNrLm51bWJlclByb2Nlc3NJbnN0YW5jZXMub3BlcmF0b3IsIHBhcnNlSW50KGNvdW50VmFsdWUpKTtcblxuXG4gICAgICAgICAgICBpZiAoY29tcGFyZSkge1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdQcmUtcmVxdWlzaXRlcyBwYXNzZWQuJywge30pO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBoZWxwZXIuZ2V0TGFuZ3VhZ2VNZXNzYWdlKHByZXJlcXVpc2l0ZS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywgbWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgIH0gZWxzZSBpZiAocHJlcmVxdWlzaXRlLmNoZWNrLnZhcmlhYmxlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICB2YXIgc2NvcGUgPSBwcmVyZXF1aXNpdGUuY2hlY2sudmFyaWFibGUuc2NvcGU7XG4gICAgICAgICAgICB2YXIgZmlsZU5hbWUgPSAnJztcblxuICAgICAgICAgICAgaWYgKHNjb3BlID09IFwicHJvZmlsZVwiKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICBmaWxlTmFtZSA9IHByb2ZpbGVJZCArICc6dmFyaWFibGVzJztcblxuICAgICAgICAgICAgfSBlbHNlIGlmIChzY29wZSA9PSBcInN1YlByb2ZpbGVTdWJQcm9jZXNzSW5zdGFuY2VcIikge1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YlByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICBmaWxlTmFtZSA9IHN1YlByb2ZpbGVJZCArICc6dmFyaWFibGVzJztcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWplY3QoXCJFUlJPUjogU2NvcGUgJ1wiICsgc2NvcGUgKyBcIicgbm90IGltcGxlbWVudGVkIGluIHByZS1yZXF1aXNpdGVzXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkYW8uZ2V0KGZpbGVOYW1lKS50aGVuKGZ1bmN0aW9uKGZpbGUpIHtcblxuICAgICAgICAgICAgICAgIHZhciB2YXJpYWJsZU5hbWUgPSBwcmVyZXF1aXNpdGUuY2hlY2sudmFyaWFibGUubmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgdmFyaWFibGVUeXBlID0gcHJlcmVxdWlzaXRlLmNoZWNrLnZhcmlhYmxlLnR5cGU7XG4gICAgICAgICAgICAgICAgdmFyIGZpbmFsVmFsdWUgPSBmaWxlO1xuICAgICAgICAgICAgICAgIHZhciBwYXRoVG9FbGVtZW50ID0gdmFyaWFibGVOYW1lID09IFwiXCIgPyBbXSA6IHZhcmlhYmxlTmFtZS5zcGxpdCgvWydcIlxcW1xcXS5dKy8pO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBwYXRoVG9FbGVtZW50Lmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKHBhdGhUb0VsZW1lbnRba10gPT0gXCJcIikgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gZmluYWxWYWx1ZTtcbiAgICAgICAgICAgICAgICB2YXIgc3ViamVjdFZhbHVlQ2FsY3VsYXRlZDtcblxuICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZVR5cGUgIT0gdW5kZWZpbmVkICYmIHZhcmlhYmxlVHlwZSA9PSBcImFycmF5XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgc3ViamVjdFZhbHVlQ2FsY3VsYXRlZCA9IG9iajtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvYmogPT0gJ29iamVjdCcpIHtcblxuICAgICAgICAgICAgICAgICAgICAvL3ZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3VicHJvY2Vzc1R5cGUgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXS90eXBlXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkIGFuZCBfaWQgPSAvc3VicHJvY2Vzc2VzW19pZCA9IFwiICsgcGFydCArIFwiXS9faWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgLy8gfVxuXG5cblxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWJwcm9jZXNzVHlwZSA9PSBQUk9DRVNTX1RZUEVfU1VCUFJPRklMRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkIGFuZCB1dWlkID0gXCIgKyBwYXJ0ICsgXCJdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG5cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlUGF0aCA9IFwiL1wiICsgdmFyaWFibGVOYW1lICsgXCJbXCIgKyBzZXEgKyBcIl0vdmFsdWVcIjtcbiAgICAgICAgICAgICAgICAgICAgc3ViamVjdFZhbHVlQ2FsY3VsYXRlZCA9IEpTT04ueHBhdGgodmFsdWVQYXRoLCBmaWxlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvYmogPT0gJ3N0cmluZycpIHtcblxuICAgICAgICAgICAgICAgICAgICBzdWJqZWN0VmFsdWVDYWxjdWxhdGVkID0gb2JqO1xuXG4gICAgICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICAgICAgICAgIHZhciBpbnB1dFZhbHVlID0gcHJlcmVxdWlzaXRlLmNoZWNrLnZhcmlhYmxlLnZhbHVlLmRhdGE7XG4gICAgICAgICAgICAgICAgdmFyIGlucHV0RGF0YVR5cGUgPSBwcmVyZXF1aXNpdGUuY2hlY2sudmFyaWFibGUudmFsdWUuZGF0YVR5cGUuZGF0YVR5cGU7XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5wdXRWYWx1ZS5pbmRleE9mKFwieHBhdGg6XCIpID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZ1bGxQYXRoID0gaW5wdXRWYWx1ZS5zdWJzdHJpbmcoNik7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBKU09OLnhwYXRoKGZ1bGxQYXRoLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpbnB1dFZhbHVlID09IFwiI1ZBTElEX0RBVEVcIikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3BvID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNwbyAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSBzcG8uZGF0ZXMudmFsaWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIHZhciBmaW5hbFZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dERhdGFUeXBlID09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBOdW1iZXIoaW5wdXRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGFUeXBlID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBpbnB1dFZhbHVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhVHlwZSA9PSAnaW50ZWdlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IHBhcnNlSW50KGlucHV0VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWFibGVUeXBlICE9IHVuZGVmaW5lZCAmJiB2YXJpYWJsZVR5cGUgPT0gXCJhcnJheVwiKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJqZWN0VmFsdWVDYWxjdWxhdGVkID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YmplY3RWYWx1ZUNhbGN1bGF0ZWQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJqZWN0VmFsdWVDYWxjdWxhdGVkID0gc3ViamVjdFZhbHVlQ2FsY3VsYXRlZC5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhVHlwZSA9PSAnZGVjaW1hbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IHBhcnNlRmxvYXQoaW5wdXRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGFUeXBlID09ICdkYXRlJyB8fCBpbnB1dERhdGFUeXBlID09ICdkYXRlVGltZScpIHtcbiAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IGlucHV0VmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHN1YmplY3RWYWx1ZUNhbGN1bGF0ZWQgPT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgIChwcmVyZXF1aXNpdGUuY2hlY2sudmFyaWFibGUuYWxsb3dCbGFuayAhPSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXJlcXVpc2l0ZS5jaGVjay52YXJpYWJsZS5hbGxvd0JsYW5rID09IHRydWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdWYXJpYWJsZSBQcmUtcmVxdWlzaXRlcyBwYXNzZWQuJywge30pO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21wYXJlID0gdXRpbC5jb21wYXJlKHN1YmplY3RWYWx1ZUNhbGN1bGF0ZWQsIHByZXJlcXVpc2l0ZS5jaGVjay52YXJpYWJsZS5vcGVyYXRvciwgZmluYWxWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb21wYXJlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnVmFyaWFibGUgUHJlLXJlcXVpc2l0ZXMgcGFzc2VkLicsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gaGVscGVyLmdldExhbmd1YWdlTWVzc2FnZShwcmVyZXF1aXNpdGUubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZS5yZXBsYWNlKFwiI1ZBTElEX0RBVEVcIiwgc3ViamVjdFZhbHVlQ2FsY3VsYXRlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywgbWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKHByZXJlcXVpc2l0ZS5jaGVjay52YXJpYWJsZS5hbGxvd0JsYW5rICE9IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICBwcmVyZXF1aXNpdGUuY2hlY2sudmFyaWFibGUuYWxsb3dCbGFuayA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdWYXJpYWJsZSBQcmUtcmVxdWlzaXRlcyBwYXNzZWQuJywge30pO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gaGVscGVyLmdldExhbmd1YWdlTWVzc2FnZShwcmVyZXF1aXNpdGUubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGUHJlUmVxdWlzaXRlRXJyb3I6JywgbWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywgJ1ByZS1yZXF1aXNpdGUgdHlwZSBub3QgZGVmaW5lZC4nKTtcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG5cbiAgICAgICAgfVxuXG5cblxuICAgIH0pO1xufTtcblxuLyoqXG4gKiBQcm9jZXNzIHByZS1hY3Rpb25zc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBwcmVBY3Rpb25zIC0gdGhlIHByZS1hY3Rpb25zIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgY3VycmVudCB3b3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gcHJlQWN0aW9ucyhwcmVBY3Rpb25zLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB2YXIgY29tcGxldGVkID0gW107XG4gICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgIHZhciBzcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgcHJvY2Vzc0lEID0gc3BPYmplY3RbXCJtZXRhLWRhdGFcIl0ucHJvY2Vzc0NvbmZpZ0lkO1xuICAgICAgICAgICAgdmFyIHByb2Nlc3NJZCA9IHNwT2JqZWN0W1wibWV0YS1kYXRhXCJdLnN1YlByb2Nlc3NDb25maWdJZDtcbiAgICAgICAgICAgIHZhciBwcm9jZXNzU0VRID0gc3BPYmplY3RbXCJtZXRhLWRhdGFcIl0uc3ViUHJvY2Vzc0luc1NlcTtcbiAgICAgICAgICAgIHZhciBwcm9jZXNzU2VxID0gc3BPYmplY3RbXCJtZXRhLWRhdGFcIl0uc3ViUHJvY2Vzc0luc1NlcTtcblxuICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NDb25maWdPYmplY3QgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgcHJvY2Vzc0lEICsgXCInXS9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHByb2Nlc3NJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3N0ZXBcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgdXRpbC5zeW5jTG9vcChwcmVBY3Rpb25zLmxlbmd0aCwgZnVuY3Rpb24obG9vcCkge1xuICAgICAgICAgICAgICAgIHZhciBjb3VudGVyID0gbG9vcC5pdGVyYXRpb24oKTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ocHJlQWN0aW9uc1tjb3VudGVyXSwgcHJvY2Vzc0lELCBwcm9jZXNzU0VRLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NDb25maWdPYmplY3QsIHN0ZXBPYmplY3QsIF9XRkluc3RhbmNlLCB7fSwgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgYWxsIHByZS1yZXF1aXNpdGVzIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuXG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZC5wdXNoKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICBsb29wLm5leHQoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGVkLnB1c2goZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBsb29wLmJyZWFrKCk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbXBsZXRlZC5ldmVyeShCb29sZWFuKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUHJlLWFjdGlvbnMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZQcmVSZXF1aXNpdGVFcnJvcicsICdOb3QgYWxsIHByZS1hY3Rpb25zIHBhc3NlZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgZ2V0IHN1Yi1wcm9jZXNzIGRhdGEuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGlkIC0gdGhlIHN1YlByb2Nlc3MgY29uZmlnIGlkXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgY3VycmVudCB3b3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZVxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbmZ1bmN0aW9uIGdldFN1YlByb2Nlc3MoaWQsIF9XRkluc3RhbmNlKSB7XG4gICAgaWYgKF9XRkluc3RhbmNlLnN1YnByb2Nlc3NlcyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzcykge1xuICAgICAgICAgICAgaWYgKHN1YlByb2Nlc3MuaWQgPT0gaWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3ViUHJvY2VzcztcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9KTtcbiAgICB9XG5cbn07XG5cbi8qKlxuICogUHJvY2VzcyBzdWItcHJvY2Vzc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBwcm9jZXNzIC0gdGhlIGN1cnJlbnQgcHJvY2VzcyBpZCBhbmQgc2VxXG4gKiBAcGFyYW0ge29iamVjdH0gc3ViUHJvY2VzcyAtIHRoZSBzdWItcHJvY2VzcyBpZCBhbmQgc2VxXG4gKiBAcGFyYW0ge29iamVjdH0gZGF0YSAtIHRoZSB1c2VyIGlucHV0IGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBzdWJQcm9jZXNzKHV1aWQsIHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdWJwcm9maWxlSWQsIGRhdGEsIF9XRkluc3RhbmNlKSB7XG4gICAgLy8gR2V0IHRoZSBjdXJyZW50IHByb2Nlc3Mgc3ViUHJvY2VzcyBpbnN0YW5jZVxuICAgIC8vIHZhciBzdWJQcm9jZXNzU2VxID0gMTtcbiAgICB2YXIgc3ViUHJvY2VzcyA9IFtdO1xuICAgIHZhciBwcm9jZXNzQ29uZiA9IFtdO1xuICAgIHZhciBzdWJQcm9jZXNzQ29uZiA9IFtdO1xuXG5cbiAgICAvLyBfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialByb2Nlc3MpIHtcbiAgICAvLyAgICAgaWYgKG9ialByb2Nlc3MuaWQgPT0gcHJvY2Vzc0lkICYmIG9ialByb2Nlc3Muc2VxID09IHByb2Nlc3NTZXEpIHtcbiAgICAvLyAgICAgICAgIHZhciBzcExlbmd0aCA9IG9ialByb2Nlc3Muc3ViUHJvY2Vzc2VzLmxlbmd0aDtcbiAgICAvLyAgICAgICAgIG9ialByb2Nlc3Muc3ViUHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpTdWJQcm9jZXNzKSB7XG4gICAgLy8gICAgICAgICAgICAgaWYgKG9ialN1YlByb2Nlc3MuaWQgPT0gc3ViUHJvY2Vzc0lkICYmIG9ialN1YlByb2Nlc3Muc2VxID09IHN1YlByb2Nlc3NTZXEpIHtcbiAgICAvLyAgICAgICAgICAgICAgICAgdmFyIHV1aWQgPSBvYmpTdWJQcm9jZXNzLnV1aWQ7XG4gICAgLy8gICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzc0l0ZW0pIHtcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzSXRlbS5faWQgPT0gdXVpZCkge1xuICAgIC8vICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3MgPSBzdWJQcm9jZXNzSXRlbTtcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgIC8vICAgICAgICAgICAgICAgICB9KVxuICAgIC8vICAgICAgICAgICAgIH1cbiAgICAvLyAgICAgICAgIH0pO1xuICAgIC8vICAgICB9XG5cbiAgICAvLyB9KTtcblxuICAgIC8vIE5PVEU6IGluY29taW5nIHV1aWQgd2lsbCBiZSB1c2VkIGluIGNhc2Ugb2YgbmV3IHN1YnByb2Nlc3MgY3JlYXRpb25cbiAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NJdGVtKSB7XG4gICAgICAgIGlmIChzdWJQcm9jZXNzSXRlbS5faWQgPT0gdXVpZCkge1xuICAgICAgICAgICAgc3ViUHJvY2VzcyA9IHN1YlByb2Nlc3NJdGVtO1xuICAgICAgICB9XG4gICAgfSk7XG5cblxuXG5cbiAgICAvLyBHZXQgdGhlIGN1cnJlbnQgc3ViUHJvY2VzcyBjb25maWd1cmF0aW9uXG4gICAgX1dGSW5zdGFuY2UuY29uZmlnLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ocHJvY2Vzc0NvbmZpZykge1xuICAgICAgICBpZiAocHJvY2Vzc0NvbmZpZy5faWQgPT0gcHJvY2Vzc0lkKSB7XG4gICAgICAgICAgICBwcm9jZXNzQ29uZiA9IHByb2Nlc3NDb25maWc7XG4gICAgICAgICAgICBwcm9jZXNzQ29uZmlnLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzc0NvbmZpZykge1xuICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzQ29uZmlnLl9pZCA9PSBzdWJQcm9jZXNzSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0NvbmYgPSBzdWJQcm9jZXNzQ29uZmlnO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgfSk7XG5cbiAgICAvL1RPRE86IENoYW5nZSByZXF1aXJlZCB0byBtb3ZlIGlzQWN0aXZlIHRvIHN1YlByb2Nlc3MgZmlsZS5IZXJlXG4gICAgdmFyIGdyb3VwS2V5ID0gJyc7XG4gICAgdmFyIGJhc2VVVUlEID0gZGF0YS5iYXNlVVVJRDtcbiAgICB2YXIgY291bnRTdWJwcm9jZXNzSW5Db250ZXh0ID0gMDtcblxuICAgIGlmIChiYXNlVVVJRCAhPSB1bmRlZmluZWQgJiYgYmFzZVVVSUQgIT0gJycgJiYgYmFzZVVVSUQubGVuZ3RoID4gMCkge1xuXG4gICAgICAgIHZhciBwcmV2aW91c09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBiYXNlVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICBncm91cEtleSA9IHByZXZpb3VzT2JqZWN0Lmdyb3VwS2V5O1xuICAgICAgICBjb3VudFN1YnByb2Nlc3NJbkNvbnRleHQgPSBwcmV2aW91c09iamVjdFsnbWV0YS1kYXRhJ10uc3ViUHJvY2Vzc0luc1NlcTtcblxuXG4gICAgfSBlbHNlIHtcblxuICAgICAgICB2YXIgY2FyZEluZExpc3QgPSAnJztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdWJQcm9jZXNzQ29uZi5pbmRpY2F0b3JzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgY2FyZEluZExpc3QgPSBjYXJkSW5kTGlzdCArIFwiJ1wiICsgc3ViUHJvY2Vzc0NvbmYuaW5kaWNhdG9yc1tpXS5faWQgKyBcIicsXCI7XG4gICAgICAgIH1cbiAgICAgICAgY2FyZEluZExpc3QgPSBjYXJkSW5kTGlzdCArIFwiJ1wiICsgc3ViUHJvY2Vzc0NvbmYuaW5kaWNhdG9yc1tpXS5faWQgKyBcIidcIjtcbiAgICAgICAgdmFyIHNpbmdsZUNhcmQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbc2V0SWQgPSAoXCIgKyBjYXJkSW5kTGlzdCArIFwiKSBhbmQgY2FyZGluYWxpdHkgZXEgJ3NpbmdsZSddXCIsIGFwcC5TQ09QRS5BUFBfQ09ORklHLCB7fSkubGVuZ3RoO1xuXG4gICAgICAgIGlmIChzdWJQcm9jZXNzQ29uZi5pbnN0YW5jZVR5cGUubmV3U2VxdWVuY2UgIT0gdW5kZWZpbmVkIHx8IHNpbmdsZUNhcmQgPiAwKSB7XG4gICAgICAgICAgICB2YXIgcHJldmlvdXNPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlc1tpZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICBpZiAocHJldmlvdXNPYmplY3QgIT0gdW5kZWZpbmVkICYmIHByZXZpb3VzT2JqZWN0LnN1YlByb2Nlc3Nlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZ3JvdXBLZXkgPSBwcmV2aW91c09iamVjdC5zdWJQcm9jZXNzZXNbMF0uZ3JvdXBLZXk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGdyb3VwS2V5ID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBncm91cEtleSA9IGdlbmVyYXRlVVVJRCgpO1xuXG4gICAgICAgIH1cblxuICAgICAgICBjb3VudFN1YnByb2Nlc3NJbkNvbnRleHQgPSBKU09OLnhwYXRoKFwiY291bnQoL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbZ3JvdXBLZXkgZXEgJ1wiICsgZ3JvdXBLZXkgKyBcIiddKVwiLCBfV0ZJbnN0YW5jZS5pbnN0YW5jZSwge30pWzBdO1xuICAgIH1cblxuICAgIHZhciBsYWJlbCA9IGRhdGEubGFiZWw7XG4gICAgdmFyIHN1YlByb2Nlc3NPYmplY3RJZCA9IHV1aWQ7XG5cblxuXG5cblxuXG4gICAgdmFyIG1vZGVsID0ge1xuICAgICAgICBfaWQ6IHN1YlByb2Nlc3NPYmplY3RJZCxcbiAgICAgICAgaWQ6IHN1YlByb2Nlc3NJZCxcbiAgICAgICAgdHlwZTogJ3dvcmtmbG93SW5zdGFuY2VTdWJQcm9jZXNzJyxcbiAgICAgICAgZGF0ZVRpbWVDcmVhdGVkOiBtb21lbnQoKS5mb3JtYXQoKSxcbiAgICAgICAgZHVlRGF0ZVRpbWU6IG1vbWVudCgpLmZvcm1hdCgpLFxuICAgICAgICBzZXE6IHN1YlByb2Nlc3NTZXEsXG4gICAgICAgIGluaXRpYXRlZDogZmFsc2UsXG4gICAgICAgIGRhdGVzOiB7XG4gICAgICAgICAgICBjcmVhdGVkOiAnJyxcbiAgICAgICAgICAgIHZhbGlkOiAnJyxcbiAgICAgICAgICAgIHN0YXJ0OiAnJyxcbiAgICAgICAgICAgIGR1ZTogJycsXG4gICAgICAgICAgICBjbG9zZWQ6ICcnXG4gICAgICAgIH0sXG4gICAgICAgIGNvbXBsZXRlOiBmYWxzZSxcbiAgICAgICAgaW5kaWNhdG9yczogW10sXG4gICAgICAgIHN0ZXA6IHt9LFxuICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgIGdyb3VwS2V5OiBncm91cEtleSxcbiAgICAgICAgbGFiZWw6IGxhYmVsLFxuICAgICAgICBjaGFubmVsczogW1xuICAgICAgICAgICAgXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSxcbiAgICAgICAgICAgIFwicHJvZmlsZV9cIiArIGFwcC5TQ09QRS5wcm9maWxlSWQsXG4gICAgICAgICAgICBcImFwcGxpY2F0aW9uX1wiICsgYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICBcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpICsgXCJfYXBwbGljYXRpb25fXCIgKyBhcHAuU0NPUEUuYXBwbGljYXRpb25JZFxuICAgICAgICBdLFxuICAgICAgICBoaXN0b3J5OiBbXSxcbiAgICAgICAgLy9tZXRhIGluZm9ybWF0aW9uIGFkZGVkIGZvciBzZXJ2ZXIgc2lkZSBjb25mbGljdCBtYW5hZ2VtZW50IGFuZCBtZXJnZXJcbiAgICAgICAgXCJtZXRhLWRhdGFcIjoge1xuICAgICAgICAgICAgYXBwbGljYXRpb25JZDogYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICBjb21tdW5pdHlJZDogYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCksXG4gICAgICAgICAgICBwcm9maWxlSWQ6IGFwcC5TQ09QRS5wcm9maWxlSWQsXG4gICAgICAgICAgICBzdWJwcm9maWxlSWQ6IHN1YnByb2ZpbGVJZCA9PSB1bmRlZmluZWQgPyAnJyA6IHN1YnByb2ZpbGVJZCxcbiAgICAgICAgICAgIHByb2Nlc3NDb25maWdJZDogcHJvY2Vzc0lkLFxuICAgICAgICAgICAgc3ViUHJvY2Vzc0NvbmZpZ0lkOiBzdWJQcm9jZXNzSWQsXG4gICAgICAgICAgICBzdWJQcm9jZXNzSW5zU2VxOiBjb3VudFN1YnByb2Nlc3NJbkNvbnRleHQgKyAxXG4gICAgICAgIH0sXG4gICAgICAgIG1lc3NhZ2VzOiBbXSxcbiAgICAgICAgc3BTdGF0dXM6ICcnXG4gICAgfTtcblxuICAgIGlmIChkYXRhLnZhbGlkRGF0ZSAhPSB1bmRlZmluZWQgJiYgZGF0YS52YWxpZERhdGUubGVuZ3RoID4gMCkge1xuICAgICAgICBpZihzdWJQcm9jZXNzQ29uZi5wZXJpb2RUeXBlLnBlcmlvZGljICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICBtb2RlbC5kYXRlcy52YWxpZCA9IG1vbWVudChkYXRhLnZhbGlkRGF0ZSkuZW5kT2YoXCJtb250aFwiKS5mb3JtYXQoXCJZWVlZLU1NLUREXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgICBtb2RlbC5kYXRlcy52YWxpZCA9IGRhdGEudmFsaWREYXRlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgIH1cblxuICAgIGlmIChhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSBcIlwiKSB7XG4gICAgICAgIG1vZGVsLmNoYW5uZWxzLnB1c2goXCJwcm9maWxlX1wiICsgYXBwLlNDT1BFLnByb2ZpbGVJZCArIFwiX3N1YnByb2ZpbGVfXCIgKyBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQpO1xuICAgICAgICBtb2RlbC5jaGFubmVscy5wdXNoKFwic3VicHJvZmlsZV9cIiArIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbW9kZWwuY2hhbm5lbHMucHVzaChcInByb2ZpbGVfXCIgKyBhcHAuU0NPUEUucHJvZmlsZUlkICsgXCJfc3VicHJvZmlsZV9cIiArIDApO1xuICAgICAgICBtb2RlbC5jaGFubmVscy5wdXNoKFwic3VicHJvZmlsZV9cIiArIDApO1xuICAgIH1cblxuICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5wdXNoKG1vZGVsKTtcbiAgICAvLyBSZXR1cm4gYSBwcm9taXNlXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAvLyBDYXRjaCBhbGwgdW5jYXVnaHQgZXJyb3JzXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyAxLiBQcm9jZXNzIHRoZSBwcmUtYWN0aW9uc1xuICAgICAgICAgICAgdmFyIHByZUFjdGlvbnNDb25mID0gcHJvY2Vzc0NvbmYucHJlQWN0aW9ucztcbiAgICAgICAgICAgIC8vYWN0aW9uKGFjdGlvbnNbY291bnRlcl0sIHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdWJQcm9jZXNzLCBzdGVwLCBfV0ZJbnN0YW5jZSwgZGF0YSwgdXVpZClcbiAgICAgICAgICAgIHByZUFjdGlvbnMocHJlQWN0aW9uc0NvbmYsIF9XRkluc3RhbmNlLCBzdWJQcm9jZXNzT2JqZWN0SWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgLy8gMi4gUHJvY2VzcyB0aGUgcHJlLXJlcXVpc2l0ZXNcbiAgICAgICAgICAgICAgICB2YXIgcHJlcmVxdWlzaXRlQ29uZiA9IHByb2Nlc3NDb25mLnByZXJlcXVpc2l0ZXM7XG4gICAgICAgICAgICAgICAgcHJlUmVxdWlzaXRlcyhwcmVyZXF1aXNpdGVDb25mLCBfV0ZJbnN0YW5jZSwgc3ViUHJvY2Vzc09iamVjdElkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAvLyAzLiBJbml0aWF0ZSB0aGUgc3ViUHJvY2Vzc1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5pdGlhdGVDb25mID0gc3ViUHJvY2Vzc0NvbmYuaW5pdGlhdGU7XG4gICAgICAgICAgICAgICAgICAgIGluaXRpYXRlKGluaXRpYXRlQ29uZiwgc3ViUHJvY2VzcywgZGF0YSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vVXBkYXRlIHRoZSBzdWJQcm9jZXNzIG1vZGVsXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5pbml0aWF0ZWQgPSByZXN1bHQuZGF0YS5pbml0aWF0ZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5kYXRlcyA9IHJlc3VsdC5kYXRhLmRhdGVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRXhlY3V0ZSB0aGUgZmlyc3Qgc3RlcFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBJZCA9IHN1YlByb2Nlc3NDb25mLnN0ZXBzWzBdLl9pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc2l0aW9uSWQgPSBzdWJQcm9jZXNzQ29uZi5zdGVwc1swXS50cmFuc2l0aW9uWzBdLl9pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwU2VxID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXAocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwgc3RlcFNlcSwgZGF0YSwgX1dGSW5zdGFuY2UsIHN1YlByb2Nlc3NPYmplY3RJZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5zdGVwID0gcmVzdWx0LmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGljYXRvcnMoc3ViUHJvY2Vzc0NvbmYuaW5kaWNhdG9ycywgX1dGSW5zdGFuY2UsIG1vZGVsLl9pZCkudGhlbihmdW5jdGlvbihyZXN1bHQxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5pbmRpY2F0b3JzID0gcmVzdWx0MS5kYXRhO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBFeGVjdXRlIHRoZSB0cmFuc2l0aW9ucywgaWYgYXV0b1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TdWJwcm9jZXNzIHBvc3RBY3Rpb25zIHJlbW92ZWQgZnJvbSBoZXJlIGFzIHRoZXkgc2hvdWxkIGJlIGV4ZWN1dGVkIGF0IHRoZSBlbmQgb2YgdGhlIHN1YlByb2Nlc3MsIG1lYW5zIGF0IGxhc3Qgc3RlcCBhZnRlciB0cmFuc2l0aW9uLCBqdXN0IGJlZm9yZSBmaW5pc2guXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDYW4gYWRkIGhpc3Rvcnkgb2JqZWN0IGhlcmUgaW4gY2FzZSBmb3IgZmlyc3Qgc3RlcCwgaS5lIGluaXRpYWxpc2F0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtb2RlbC5oaXN0b3J5LnB1c2gocmVzdWx0LmRhdGEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcyhyZXN1bHQxLm1lc3NhZ2UsIG1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMgPSBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhKG9iai5faWQgPT0gc3ViUHJvY2Vzc09iamVjdElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3NlcyA9IF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIShvYmouX2lkID09IHN1YlByb2Nlc3NPYmplY3RJZCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzID0gX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICEob2JqLl9pZCA9PSBzdWJQcm9jZXNzT2JqZWN0SWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgaW5pdGlhdGVcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gaW5pdGlhdGUgLSB0aGUgaW5pdGlhdGUgY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gdGhlIHVzZXIgaW5wdXQgZGF0YVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gaW5pdGlhdGUoaW5pdGlhdGUsIHN1YlByb2Nlc3MsIGRhdGEpIHtcbiAgICB2YXIgY29tcGxldGVkID0gW107XG4gICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgICAgaW5pdGlhdGVkOiBmYWxzZSxcbiAgICAgICAgZGF0ZXM6IHtcbiAgICAgICAgICAgIGNyZWF0ZWQ6ICcnLFxuICAgICAgICAgICAgdmFsaWQ6ICcnLFxuICAgICAgICAgICAgc3RhcnQ6ICcnLFxuICAgICAgICAgICAgZHVlOiAnJyxcbiAgICAgICAgICAgIGNsb3NlZDogJydcbiAgICAgICAgfVxuXG4gICAgfTtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgaWYgKGluaXRpYXRlLnVzZXIgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LmRhdGVzLmNyZWF0ZWQgPSBkYXRhLmNyZWF0ZWREYXRlO1xuICAgICAgICAgICAgICAgIGlmIChpbml0aWF0ZS51c2VyLnZhbGlkRGF0ZS5fdHlwZSA9PSAndXNlclNlbGVjdGVkJyB8fCBpbml0aWF0ZS51c2VyLnZhbGlkRGF0ZS5fdHlwZSA9PSAnYXV0b1NlbGVjdGVkJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS52YWxpZERhdGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuZGF0ZXMudmFsaWQgPSBkYXRhLnZhbGlkRGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRlcy52YWxpZCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zdWJzdHJpbmcoMCwgMTApO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5pdGlhdGUudXNlci5kdWVEYXRlLl90eXBlID09ICd1c2VyU2VsZWN0ZWQnIHx8IGluaXRpYXRlLnVzZXIuZHVlRGF0ZS5fdHlwZSA9PSAnYXV0b1NlbGVjdGVkJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5kdWVEYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRlcy5kdWUgPSBkYXRhLmR1ZURhdGU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRlcy5zdGFydCA9IGRhdGEuZmlyc3REYXRlO1xuXG5cblxuICAgICAgICAgICAgICAgIHJlc3VsdC5pbml0aWF0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdWItUHJvY2VzcyBpbml0aWF0ZSBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgfSBlbHNlIGlmIChpbml0aWF0ZS5hdXRvICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICByZXN1bHQuZGF0ZXMuY3JlYXRlZCA9IGRhdGEuY3JlYXRlZERhdGU7XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5pdGlhdGUuZGF0ZXMudmFsaWQuX3R5cGUgPT0gJ3VzZXJTZWxlY3RlZCcgfHwgaW5pdGlhdGUuZGF0ZXMudmFsaWQuX3R5cGUgPT0gJ2F1dG9TZWxlY3RlZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEudmFsaWREYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRlcy52YWxpZCA9IGRhdGEudmFsaWREYXRlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXRpbC53YXJuKCdXRkluaXRpYXRlRXJyb3InLCAnTm8gdmFsaWQgZGF0ZSBwYXNzZWQgaW4gLSB7ZGF0YS52YWxpZERhdGV9Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpbml0aWF0ZS5kYXRlcy5kdWUuX3R5cGUgPT0gJ3VzZXJTZWxlY3RlZCcgfHwgaW5pdGlhdGUuZGF0ZXMuZHVlLl90eXBlID09ICdhdXRvU2VsZWN0ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmR1ZURhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmRhdGVzLmR1ZSA9IGRhdGEuZHVlRGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHV0aWwud2FybignV0ZJbml0aWF0ZUVycm9yJywgJ05vIGR1ZSBkYXRlIHBhc3NlZCBpbiAtIHtkYXRhLmR1ZURhdGV9Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJlc3VsdC5pbml0aWF0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdWItUHJvY2VzcyBpbml0aWF0ZSBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTsqL1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgdmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZJbml0aWF0ZUVycm9yJywgJ0luaXRpYXRlIHR5cGU6ICcgKyBpbml0aWF0ZS5fdHlwZSArICcgbm90IGRlZmluZWQuJyk7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc3ViUHJvY2Vzcy5jb21wbGV0ZSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGluaXQoKTtcbiAgICAgICAgfSBlbHNlIGlmICghc3ViUHJvY2Vzcy5jb21wbGV0ZSkge1xuICAgICAgICAgICAgaWYgKGluaXRpYXRlLnBhcmFsbGVsSW5zdGFuY2VzKSB7XG4gICAgICAgICAgICAgICAgaW5pdCgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRkluaXRpYXRlRXJyb3InLCAnU3ViLXByb2Nlc3M6ICcgKyBzdWJQcm9jZXNzLmlkICsgJyBzdGlsbCBhY3RpdmUgYW5kIHBhcmFsbGVsIGluc3RhbmNlcyBhcmUgbm90IGFsbG93ZWQuJyk7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogUHJvY2VzcyBzdGVwXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBjdXJyZW50IHByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdWJQcm9jZXNzSWQgLSB0aGUgY3VycmVudCBzdWItcHJvY2VzcyBpZFxuICogQHBhcmFtIHtzdHJpbmd9IHN0ZXBJZCAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIHN0ZXAgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdGVwU2VxIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3Mgc3RlcCBpbnN0YW5jZSBjb3VudGVyIC8gc2VxdWVuY2VcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gdGhlIHVzZXIgaW5wdXQgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgX1dGSW5zdGFuY2UgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIHN0ZXAocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwgc3RlcFNlcSwgZGF0YSwgX1dGSW5zdGFuY2UsIHNwdXVpZCkge1xuXG4gICAgLy8gRGVmYXVsdCBzdGVwIG1vZGVsXG4gICAgdmFyIG1vZGVsID0ge1xuICAgICAgICBrZXk6IGdlbmVyYXRlVVVJRCgpLFxuICAgICAgICBpZDogJycsXG4gICAgICAgIHNlcTogJycsXG4gICAgICAgIHN0YXR1czogJycsXG4gICAgICAgIG1lc3NhZ2U6ICcnLFxuICAgICAgICBhc3NpZ25lZFRvOiB7XG4gICAgICAgICAgICB1c2VySWQ6ICcnLFxuICAgICAgICAgICAgbmFtZTogJycsXG4gICAgICAgICAgICBkYXRlVGltZTogJycsXG4gICAgICAgICAgICB0eXBlOiAnJyxcbiAgICAgICAgICAgIGR1ZURhdGVUaW1lOiAnJyxcbiAgICAgICAgICAgIGJ5OiAnJ1xuICAgICAgICB9LFxuICAgICAgICBhc3NpZ25tZW50SGlzdG9yeTogW10sXG4gICAgICAgIGRhdGVUaW1lQ3JlYXRlZDogbW9tZW50KCkuZm9ybWF0KCksXG4gICAgICAgIGR1ZURhdGVUaW1lOiBtb21lbnQoKS5mb3JtYXQoKSxcbiAgICAgICAgdHJhbnNpdGlvbjoge1xuICAgICAgICAgICAgdHJhbnNpdGlvbklkOiAnJyxcbiAgICAgICAgICAgIGRhdGVUaW1lOiAnJyxcbiAgICAgICAgICAgIHVzZXJJZDogJydcbiAgICAgICAgfSxcbiAgICAgICAgYXNzaWdubWVudDoge30sXG4gICAgICAgIGNvbW1lbnQ6ICcnXG4gICAgfTtcblxuICAgIHZhciBzdWJQcm9jZXNzID0ge307XG5cbiAgICB2YXIgdXVpZCA9ICcnO1xuICAgIHZhciBpbnN0U3ViUHJvY2VzcztcbiAgICB2YXIgc3RlcCA9IHt9O1xuXG4gICAgdmFyIHRyYW5zaXRpb25JZCA9ICcnO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vR2V0IHRoZSBjdXJyZW50IHN1YlByb2Nlc3MgaW5zdGFuY2UgZGF0YVxuXG4gICAgICAgICAgICAvLyBfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialByb2Nlc3MpIHtcbiAgICAgICAgICAgIC8vICAgICBpZiAob2JqUHJvY2Vzcy5pZCA9PSBwcm9jZXNzSWQgJiYgb2JqUHJvY2Vzcy5zZXEgPT0gcHJvY2Vzc1NlcSkge1xuICAgICAgICAgICAgLy8gICAgICAgICBvYmpQcm9jZXNzLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqU3ViUHJvY2Vzcykge1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgaWYgKG9ialN1YlByb2Nlc3MuaWQgPT0gc3ViUHJvY2Vzc0lkICYmIG9ialN1YlByb2Nlc3Muc2VxID09IHN1YlByb2Nlc3NTZXEpIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgICAgICB1dWlkID0gb2JqU3ViUHJvY2Vzcy51dWlkO1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gICAgICAgICB9KVxuICAgICAgICAgICAgLy8gICAgIH1cbiAgICAgICAgICAgIC8vIH0pO1xuXG4gICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NJdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN1YlByb2Nlc3NJdGVtLl9pZCA9PSBhcHAuU0NPUEUucHJvY2Vzc1VVSUQpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5zdFN1YlByb2Nlc3MgPSBzdWJQcm9jZXNzSXRlbTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBfV0ZJbnN0YW5jZS5jb25maWcucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpQcm9jZXNzKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9ialByb2Nlc3MuX2lkID09IHByb2Nlc3NJZCkge1xuICAgICAgICAgICAgICAgICAgICBvYmpQcm9jZXNzLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqU3ViUHJvY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9ialN1YlByb2Nlc3MuX2lkID09IHN1YlByb2Nlc3NJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3MgPSBvYmpTdWJQcm9jZXNzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ialN1YlByb2Nlc3Muc3RlcHMuZmlsdGVyKGZ1bmN0aW9uKG9ialN0ZXApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9ialN0ZXAuX2lkID09IHN0ZXBJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcCA9IG9ialN0ZXA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBzdWItcHJvY2VzcyBzdGVwIGRhdGFcbiAgICAgICAgICAgIG1vZGVsLmlkID0gc3RlcElkO1xuICAgICAgICAgICAgbW9kZWwuc2VxID0gc3RlcFNlcTtcblxuICAgICAgICAgICAgdmFyIGluc3RhbmNlU3RhdHVzID0gJyc7XG4gICAgICAgICAgICBpZiAoc3RlcC5zZXRJbnN0YW5jZVN0YXR1c1RvLk5vdFN0YXJ0ZWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VTdGF0dXMgPSBcIk5vdFN0YXJ0ZWRcIjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RlcC5zZXRJbnN0YW5jZVN0YXR1c1RvLkNyZWF0ZWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VTdGF0dXMgPSBcIkNyZWF0ZWRcIjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RlcC5zZXRJbnN0YW5jZVN0YXR1c1RvLkluUHJvZ3Jlc3MgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VTdGF0dXMgPSBcIkluUHJvZ3Jlc3NcIjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RlcC5zZXRJbnN0YW5jZVN0YXR1c1RvLlN1Ym1pdHRlZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZVN0YXR1cyA9IFwiU3VibWl0dGVkXCI7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0ZXAuc2V0SW5zdGFuY2VTdGF0dXNUby5Db21wbGV0ZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZVN0YXR1cyA9IFwiQ29tcGxldGVcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGxhbmd1YWdlID0gc2VydmljZS5nZXRMYW5ndWFnZSgpO1xuXG4gICAgICAgICAgICBtb2RlbC5zdGF0dXMgPSBpbnN0YW5jZVN0YXR1cztcbiAgICAgICAgICAgIG1vZGVsLm1lc3NhZ2UgPSBzdGVwLnNldEluc3RhbmNlU3RhdHVzVG9baW5zdGFuY2VTdGF0dXNdLmxhYmVsLmkxOG5bbGFuZ3VhZ2VdO1xuICAgICAgICAgICAgbW9kZWwuY29tbWVudCA9IGRhdGEuY29tbWVudCAhPT0gdW5kZWZpbmVkID8gZGF0YS5jb21tZW50IDogJyc7XG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9ycyA9IGluc3RTdWJQcm9jZXNzICE9PSB1bmRlZmluZWQgPyBpbnN0U3ViUHJvY2Vzcy5pbmRpY2F0b3JzIDogW107XG5cbiAgICAgICAgICAgIHZhciB1cGRhdGVTUEluZGljYXRvck9iamVjdCA9IGZ1bmN0aW9uKGluZGljYXRvcnMsIF9XRkluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgICAgICAgICBpZiAoaW5kaWNhdG9ycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5kaWNhdG9ycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvck9iamVjdCA9IGluZGljYXRvcnNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXVpZCA9IGluZGljYXRvck9iamVjdC5pbnN0YW5jZXNbMF0udXVpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3IgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3JPYmplY3QuaW5zdGFuY2VzWzBdLnNlcSA9IGluZGljYXRvci5tb2RlbC5wZW5kaW5nLnNlcTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpbmRpY2F0b3Iud29ya2Zsb3dzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGljYXRvci53b3JrZmxvd3Nbal0ucHJvY2Vzc2VzWzBdICE9IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3Iud29ya2Zsb3dzW2pdLnByb2Nlc3Nlc1swXS5zdWJQcm9jZXNzVVVJRCAhPSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yLndvcmtmbG93c1tqXS5wcm9jZXNzZXNbMF0uc3RlcCAhPSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3B1dWlkID09IGluZGljYXRvci53b3JrZmxvd3Nbal0ucHJvY2Vzc2VzWzBdLnN1YlByb2Nlc3NVVUlEKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGljYXRvci53b3JrZmxvd3Nbal0ucHJvY2Vzc2VzWzBdLnN0ZXAuYXNzaWduZWRUbyA9IGFzc2lnbmVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBjbGVhclNQU3RhdHVzID0gZnVuY3Rpb24oc3B1dWlkKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICBvYmouc3BTdGF0dXMgPSBcIlwiO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaW5kaWNhdG9yRG9jcyhwcm9jZXNzSWQsIGluZGljYXRvcnMsIG1vZGVsLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHV1aWQgPSBzcHV1aWQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoc3RlcC5mdW5jdGlvbi5hY3Rpb25zICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25zKHN0ZXAuZnVuY3Rpb24uYWN0aW9ucywgcHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN1YlByb2Nlc3MsIG1vZGVsLCBfV0ZJbnN0YW5jZSwgZGF0YSwgc3B1dWlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLm5hbWUgPSBfbGNseC5TRVNTSU9OLmZpcnN0TmFtZSArIFwiIFwiICsgX2xjbHguU0VTU0lPTi5sYXN0TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS51c2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS50eXBlID0gQVNTSUdOTUVOVF9UWVBFX0FVVE87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuZHVlRGF0ZVRpbWUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5ieSA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVTUEluZGljYXRvck9iamVjdChpbmRpY2F0b3JzLCBfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zaXRpb25JZCA9IHN0ZXAudHJhbnNpdGlvblswXS5faWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCB0cmFuc2l0aW9uSWQsIGRhdGEsIF9XRkluc3RhbmNlLCBzcHV1aWQsIG1vZGVsKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnVHJhbnNpdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdC5kYXRhLnN0ZXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGVwLmZ1bmN0aW9uLnRhc2sgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIE1ha2UgYXNzaWdubWVudHNcbiAgICAgICAgICAgICAgICAgICAgdGFzayhwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN0ZXAuZnVuY3Rpb24udGFzaywgc3B1dWlkLCBtb2RlbCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlU1BJbmRpY2F0b3JPYmplY3QoaW5kaWNhdG9ycywgX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1Rhc2sgYXdhaXRpbmcgdXNlciBhY3Rpb24uJywgbW9kZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0ZXAuZnVuY3Rpb24uc2VydmVyICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBNYWtlIGFzc2lnbm1lbnRzXG4gICAgICAgICAgICAgICAgICAgIGNsZWFyU1BTdGF0dXMoc3B1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgc2VydmVyKHN0ZXAuZnVuY3Rpb24uc2VydmVyLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2VzcywgbW9kZWwsIF9XRkluc3RhbmNlLCBkYXRhLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVNQSW5kaWNhdG9yT2JqZWN0KGluZGljYXRvcnMsIF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTZXJ2ZXIgYXdhaXRpbmcgc2VydmVyIHJlc3BvbnNlLicsIG1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgaW5kaWNhdG9yIHVwZGF0ZXNcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gYWN0aW9ucyAtIHRoZSBhY3Rpb25zIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gc3ViUHJvY2VzcyAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIGZvcm0gY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBpbmRpY2F0b3JzKGluZGljYXRvcnMsIF9XRkluc3RhbmNlLCBzcHV1aWQpIHtcbiAgICB2YXIgbW9kZWwgPSBbXTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgYXJyYXkgPSBKU09OLnhwYXRoKFwiaW5kaWNhdG9yc1tmbjpjb3VudCguL3dvcmtmbG93cy9wcm9jZXNzZXNbc3ViUHJvY2Vzc1VVSUQgZXEgJ1wiICsgc3B1dWlkICsgXCInXSkgZ3QgMF1cIiwgX1dGSW5zdGFuY2UsIHt9KTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBhcnJheS5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3IgPSBhcnJheVtqXTtcbiAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yTW9kZWwgPSB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VzOiBbXVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZU1vZGVsID0ge1xuICAgICAgICAgICAgICAgICAgICB1dWlkOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICcnLFxuICAgICAgICAgICAgICAgICAgICBrZXk6ICcnLFxuICAgICAgICAgICAgICAgICAgICBzZXE6IDEsXG4gICAgICAgICAgICAgICAgICAgIHJldjogJydcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpbmRpY2F0b3JNb2RlbC5pZCA9IGluZGljYXRvci5jYXRlZ29yeS50ZXJtO1xuICAgICAgICAgICAgICAgIGluc3RhbmNlTW9kZWwudXVpZCA9IGluZGljYXRvci5faWQ7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VNb2RlbC5yZXYgPSBpbmRpY2F0b3IuX3JldjtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZU1vZGVsLnRpdGxlID0gaW5kaWNhdG9yLnRpdGxlO1xuICAgICAgICAgICAgICAgIGluc3RhbmNlTW9kZWwua2V5ID0gJyc7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VNb2RlbC5zZXEgPSBpbmRpY2F0b3IubW9kZWwucGVuZGluZy5zZXE7IC8vIGluZGljYXRvciBzZXEgbnVtYmVyIGhlcmUgd2hpY2ggaXMgZ2V0dGluZyB1cGRhdGVkLlxuICAgICAgICAgICAgICAgIGluZGljYXRvck1vZGVsLmluc3RhbmNlcy5wdXNoKGluc3RhbmNlTW9kZWwpO1xuICAgICAgICAgICAgICAgIG1vZGVsLnB1c2goaW5kaWNhdG9yTW9kZWwpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUHJvY2VzcyBpbmRpY2F0b3IgbW9kZWwgdXBkYXRlZC4nLCBtb2RlbCk7XG4gICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KVxufTtcblxuLyoqXG4gKiBQcm9jZXNzIGFzc2lnbiB1c2VyXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBwcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3ViUHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3ViLXByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdWJQcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHN1Yi1wcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN0ZXBJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN0ZXAgaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0cmFuc2l0aW9uSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiB0cmFuc2l0aW9uIGlkXG4gKiBAcGFyYW0ge29iamVjdH0gdXNlciAtIHRoZSB1c2VyIHRvIGFzc2lnbiB0b1xuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIGFzc2lnblVzZXIocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHVzZXIsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuXG4gICAgICAgICAgICAvLyBHZXQgdGhlIGN1cnJlbnQgc3ViUHJvY2VzcyBpbnN0YW5jZSBkYXRhXG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uIChvYmpQcm9jZXNzKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9ialByb2Nlc3MuaWQgPT0gcHJvY2Vzc0lkICYmIG9ialByb2Nlc3Muc2VxID09IHByb2Nlc3NTZXEpIHtcbiAgICAgICAgICAgICAgICAgICAgb2JqUHJvY2Vzcy5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uIChvYmpTdWJQcm9jZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqU3ViUHJvY2Vzcy5pZCA9PSBzdWJQcm9jZXNzSWQgJiYgb2JqU3ViUHJvY2Vzcy5zZXEgPT0gc3ViUHJvY2Vzc1NlcSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV1aWQgPSBvYmpTdWJQcm9jZXNzLnV1aWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihzdWJQcm9jZXNzSXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzSXRlbS5faWQgPT0gdXVpZCkge1xuICAgICAgICAgICAgICAgICAgICAvL0FkZGVkIHRvIGhzdG9yeVxuICAgICAgICAgICAgICAgICAgICBpZiAoc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25tZW50SGlzdG9yeSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NJdGVtLnN0ZXAuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLnVzZXJJZCAhPSBcIlwiICYmIHN1YlByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUby5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NJdGVtLnN0ZXAuYXNzaWdubWVudEhpc3RvcnkucHVzaChKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHN1YlByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUbykpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSB1c2VyIGRldGFpbHNcbiAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLnVzZXJJZCA9IHVzZXIuaWQ7XG4gICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUby5uYW1lID0gdXNlci5uYW1lO1xuICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8uZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLnR5cGUgPSBBU1NJR05NRU5UX1RZUEVfUkVBU1NJR05NRU5UO1xuICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8uZHVlRGF0ZVRpbWUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLmJ5ID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQgKyBcIlwiO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgaW5kaWNhdG9ycyB1c2VyIGRldGFpbHNcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvcnMgPSBzdWJQcm9jZXNzSXRlbS5pbmRpY2F0b3JzO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluZGljYXRvcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3IgPSBpbmRpY2F0b3JzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBpbmRpY2F0b3IuaW5zdGFuY2VzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gaW5kaWNhdG9yLmluc3RhbmNlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IF9XRkluc3RhbmNlLmluZGljYXRvcnMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRvYyA9IF9XRkluc3RhbmNlLmluZGljYXRvcnNba107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS51dWlkID09IGRvYy5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvYy53b3JrZmxvd3MuZmlsdGVyKGZ1bmN0aW9uKHdvcmtmbG93KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2Zsb3cucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihwcm9jZXNzSXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2Vzc0l0ZW0uaWQgPT0gcHJvY2Vzc0lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHVzZXIgaWQgYW5kIG5hbWUgaW4gdGhlIGRvY3VtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8udXNlcklkID0gdXNlci5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUby5uYW1lID0gdXNlci5uYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vU2VuZCBhc3NpZ24gdXNlciBub3RpZmljYXRpb24gZnJvbSBoZXJlXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddL25vdGlmaWNhdGlvbnNcIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbiAhPSB1bmRlZmluZWQgJiYgbm90aWZpY2F0aW9uLnJlQXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mIG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQgPT09IFwic3RyaW5nXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVBc3NpZ25tZW50TklkID0gbm90aWZpY2F0aW9uLnJlQXNzaWdubWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0Q29uZmlnKHJlQXNzaWdubWVudE5JZCkudGhlbihmdW5jdGlvbihyZUFzc2lnbm1lbnRPYmplY3Qpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24ucmVBc3NpZ25tZW50ID0gcmVBc3NpZ25tZW50T2JqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24ucmVBc3NpZ25tZW50Tm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1VzZXIgYXNzaWduZWQgc3VjY2Vzc2Z1bGx5LiBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicsIHN1YlByb2Nlc3NJdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihmYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShmYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihmYWlsKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShmYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24ucmVBc3NpZ25tZW50Tm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInLCBzdWJQcm9jZXNzSXRlbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShmYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgXG5cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnVXNlciBhc3NpZ25lZCBzdWNjZXNzZnVsbHkuIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJywgc3ViUHJvY2Vzc0l0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cblxuXG5cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgaW5kaWNhdG9yIGRvY3VtZW50IHVwZGF0ZXNcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gYWN0aW9ucyAtIHRoZSBhY3Rpb25zIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gc3ViUHJvY2VzcyAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIGZvcm0gY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBpbmRpY2F0b3JEb2NzKHByb2Nlc3NJZCwgaW5kaWNhdG9ycywgc3RlcCwgX1dGSW5zdGFuY2UsIGN1cnJlbnRTUFVVSUQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIGluZGljYXRvciBzZWN0aW9ucyBvZiB0aGUgc3ViUHJvY2Vzc1xuICAgICAgICAgICAgaWYgKGluZGljYXRvcnMgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZJbmRpY2F0b3JzVXBkYXRlJywgJ0luZGljYXRvcnMgcGFyYW1ldGVyIGlzIHJlcXVpcmVkLiAtIFZhbHVlOiAnICsgaW5kaWNhdG9ycylcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbmRpY2F0b3JzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3IgPSBpbmRpY2F0b3JzW2ldO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGluZGljYXRvci5pbnN0YW5jZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbnN0YW5jZSA9IGluZGljYXRvci5pbnN0YW5jZXNbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IF9XRkluc3RhbmNlLmluZGljYXRvcnMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZG9jID0gX1dGSW5zdGFuY2UuaW5kaWNhdG9yc1trXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5zdGFuY2UudXVpZCA9PSBkb2MuX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvYy53b3JrZmxvd3MuZmlsdGVyKGZ1bmN0aW9uKHdvcmtmbG93KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZmxvdy5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHByb2Nlc3NJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByb2Nlc3NJdGVtLnN1YlByb2Nlc3NVVUlEID09IGN1cnJlbnRTUFVVSUQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3RlcC5pZCA9IHN0ZXAuaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NJdGVtLnN0ZXAuc2VxID0gc3RlcC5zZXE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NJdGVtLnN0ZXAuc3RhdHVzID0gc3RlcC5zdGF0dXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NJdGVtLnN0ZXAubWVzc2FnZSA9IHN0ZXAubWVzc2FnZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLnVzZXJJZCA9IHN0ZXAuYXNzaWduZWRUby51c2VySWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUby5uYW1lID0gc3RlcC5hc3NpZ25lZFRvLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NJdGVtLnN0ZXAuY29tbWVudCA9IHN0ZXAuY29tbWVudCAhPT0gdW5kZWZpbmVkID8gc3RlcC5jb21tZW50IDogJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgZG9jdW1lbnRzIHdvcmtmbG93IHByb2Nlc3MgbW9kZWwgdXBkYXRlZC4nLCBfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KVxufTtcblxuLyoqXG4gKiBQcm9jZXNzIGFjdGlvbnNcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gYWN0aW9ucyAtIHRoZSBhY3Rpb25zIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gc3ViUHJvY2VzcyAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIGZvcm0gY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5cbmZ1bmN0aW9uIGFjdGlvbnMoYWN0aW9ucywgcHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN1YlByb2Nlc3MsIHN0ZXAsIF9XRkluc3RhbmNlLCBkYXRhLCB1dWlkKSB7XG4gICAgdmFyIGFyckFjdGlvbnMgPSBbXTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHV0aWwuc3luY0xvb3AoYWN0aW9ucy5sZW5ndGgsIGZ1bmN0aW9uKGxvb3ApIHtcbiAgICAgICAgICAgIHZhciBjb3VudGVyID0gbG9vcC5pdGVyYXRpb24oKTtcbiAgICAgICAgICAgIGFjdGlvbihhY3Rpb25zW2NvdW50ZXJdLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2Vzcywgc3RlcCwgX1dGSW5zdGFuY2UsIGRhdGEsIHV1aWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXRBY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogYWN0aW9uc1tjb3VudGVyXS5faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXE6IGNvdW50ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiByZXN1bHRcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICBhcnJBY3Rpb25zLnB1c2gocmV0QWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgbG9vcC5uZXh0KCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvb3AuYnJlYWsoKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0FjdGlvbnMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCBhcnJBY3Rpb25zKTtcbiAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufTtcblxuLyoqXG4gKiBQcm9jZXNzIGFjdGlvblxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBhY3Rpb24gLSB0aGUgYWN0aW9uIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gc3ViUHJvY2VzcyAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIGZvcm0gY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBhY3Rpb24oYWN0aW9uLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2Vzcywgc3RlcCwgX1dGSW5zdGFuY2UsIGRhdGEsIHV1aWQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgaWYgKGFjdGlvbi5tZXRob2QgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgbWV0aG9kUG9zc2libGVJdGVtcyA9IFtcImZvcm1cIiwgXCJpbmRpY2F0b3JcIiwgXCJwcm9maWxlXCIsIFwic3ViUHJvY2Vzc0luc3RhbmNlXCIsIFwic3RlcFwiLCBcImNvbW11bml0eVwiLCBcImFwcGxpY2F0aW9uXCIsIFwidXNlclwiLCBcInNkb1wiLCBcInBlcmZvcm1hbmNlXCIsIFwidGF4b25vbXlcIiwgXCJ2YXJpYWJsZXNcIiwgXCJub3RpZmljYXRpb25cIiwgXCJyZXBvcnRcIiwgXCJ3b3JrZXJcIiwgXCJwYXJ0aWNpcGFudHNcIiwgXCJnZW5lcmFsRnVuY3Rpb25zXCJdO1xuICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhhY3Rpb24ubWV0aG9kLCBtZXRob2RQb3NzaWJsZUl0ZW1zKSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2Zvcm0nOlxuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uLm1ldGhvZC5mb3JtLmNyZWF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwcm9jZXNzSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN1YlByb2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN0ZXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc1NlcSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzc1NlcSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5jcmVhdGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmJhc2VVVUlEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5jcmVhdGUoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24ubWV0aG9kLmZvcm0uYXV0aG9yaXNlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHByb2Nlc3NJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc1NlcSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzc1NlcSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEuY3JlYXRlVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2godXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5iYXNlVVVJRCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtLmF1dGhvcmlzZShhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5tZXRob2QuZm9ybS51bmRyYWZ0ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5jcmVhdGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmJhc2VVVUlEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uc2V0VW5EcmFmdChhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5tZXRob2QuZm9ybS5kcmFmdCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEuY3JlYXRlVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2godXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5iYXNlVVVJRCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtLnNldERyYWZ0KGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5mb3JtLmNsb3NlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN1YlByb2Nlc3MuaW5kaWNhdG9ycyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEuY3JlYXRlVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2godXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5iYXNlVVVJRCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtLmNsb3NlKGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5mb3JtLmF1dGhvcmlzZUFuZENyZWF0ZU5ld1NlcSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwcm9jZXNzSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN1YlByb2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHByb2Nlc3NTZXEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN1YlByb2Nlc3NTZXEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmNyZWF0ZVR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEuYmFzZVVVSUQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5hdXRob3Jpc2UoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBuZXcgc2VxdWVuY2VcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHByb2Nlc3NJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN1YlByb2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChzdGVwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc1NlcSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN1YlByb2Nlc3NTZXEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5jcmVhdGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2godXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uY3JlYXRlKGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0VkIGNyZWF0aW9uIG9mIG5ldyBzZXF1ZW5jZVxuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5tZXRob2QuZm9ybS5jcmVhdGVOZXdTZXEgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc0lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChzdWJQcm9jZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChzdGVwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHByb2Nlc3NTZXEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN1YlByb2Nlc3NTZXEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEuY3JlYXRlVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2godXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2godXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uY3JlYXRlKGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cblxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdpbmRpY2F0b3InOlxuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3IuY3JlYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFwiTm90IGltcGxlbWVudGVkXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3IuaW5zdGFudGlhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJOb3QgaW1wbGVtZW50ZWRcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24ubWV0aG9kLmluZGljYXRvci5zZXRWYWx1ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGggPSBhY3Rpb24ubWV0aG9kLmluZGljYXRvci5zZXRWYWx1ZS5wYXRoO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGFjdGlvbi5tZXRob2QuaW5kaWNhdG9yLnNldFZhbHVlLmRhdGEsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGFWYWx1ZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGFWYWx1ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtLnVwZGF0ZUluZGljYXRvcihhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5tZXRob2QuaW5kaWNhdG9yLnVwZGF0ZVN0YXR1cyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldElkID0gYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3IuaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvbi5tZXRob2QuaW5kaWNhdG9yLnVwZGF0ZVN0YXR1cyAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhdHVzID0gYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3IudXBkYXRlU3RhdHVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChzdGF0dXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChpbmRpY2F0b3JTZXRJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gS2VlcCBpbmRpY2F0b3IgZnVuY3Rpb25zIGluIGluZGlhdG9yIGZpbGUgaXN0ZWFkIG9mIGZvcm0gZmlsZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtLm1hcmtVcGRhdGVJbmRpY2F0b3IoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJBY3Rpb24gaW5kaWNhdG9yIHN1YiB0eXBlIG5vdCBmb3VuZC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24ubWV0aG9kLmluZGljYXRvci5zZXRXcmFwcGVyRWxlbWVudCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGggPSBhY3Rpb24ubWV0aG9kLmluZGljYXRvci5zZXRXcmFwcGVyRWxlbWVudC5wYXRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldElkID0gYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3Iuc2V0V3JhcHBlckVsZW1lbnQuaW5kaWNhdG9yU2V0SWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUoYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3Iuc2V0V3JhcHBlckVsZW1lbnQuZGF0YSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YVZhbHVlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YVZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goaW5kaWNhdG9yU2V0SWQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS51cGRhdGVJbmRpY2F0b3JXcmFwcGVyKGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdwcm9maWxlJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvbi5tZXRob2QucHJvZmlsZS5jcmVhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc0lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5jcmVhdGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmJhc2VVVUlEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uY3JlYXRlUHJvZmlsZShhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5tZXRob2QucHJvZmlsZS5zZXRTdGF0dXNUbyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSBhY3Rpb24ubWV0aG9kLnByb2ZpbGUuc2V0U3RhdHVzVG87XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2godXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3RhdHVzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5zZXRTdGF0dXMoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3N1YlByb2Nlc3NJbnN0YW5jZSc6XG4gICAgICAgICAgICAgICAgICAgIHZhciBzcFBvc3NpYmxlSXRlbXMgPSBbXCJpbnN0YW50aWF0ZVwiLCBcImF1dGhvcmlzZVwiLCBcImNsb3NlXCIsIFwic2V0VmFyaWFibGVcIiwgXCJzZXRTdGF0dXNUb1wiLCBcInNldFN0YXR1c01zZ1RvXCIsIFwic2V0VGl0bGVcIiwgXCJzZXRWYWxpZERhdGVcIiwgXCJzZXRTUFN0YXR1c1wiXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhhY3Rpb24ubWV0aG9kLnN1YlByb2Nlc3NJbnN0YW5jZSwgc3BQb3NzaWJsZUl0ZW1zKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzZXRUaXRsZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShhY3Rpb24ubWV0aG9kLnN1YlByb2Nlc3NJbnN0YW5jZS5zZXRUaXRsZSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YVZhbHVlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5zdWJQcm9jZXNzSW5zdGFuY2Uuc2V0VGl0bGUoYWN0aW9uLm1ldGhvZC5zdWJQcm9jZXNzSW5zdGFuY2Uuc2V0VGl0bGUsIHV1aWQsIGRhdGFWYWx1ZSwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3VwZGF0ZSBzdWJwcm9jZXNzIGxhYmVsIGluIHdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgb2JqZWN0OiBUT0RPXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NldFZhbGlkRGF0ZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShhY3Rpb24ubWV0aG9kLnN1YlByb2Nlc3NJbnN0YW5jZS5zZXRWYWxpZERhdGUsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGFWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLnN1YlByb2Nlc3NJbnN0YW5jZS5zZXRWYWxpZERhdGUoYWN0aW9uLm1ldGhvZC5zdWJQcm9jZXNzSW5zdGFuY2Uuc2V0VmFsaWREYXRlLCB1dWlkLCBkYXRhVmFsdWUsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdXBkYXRlIHN1YnByb2Nlc3MgbGFiZWwgaW4gd29ya2Zsb3cgaW5zdGFuY2UgcHJvY2VzcyBvYmplY3Q6IFRPRE9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzZXRTUFN0YXR1cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShhY3Rpb24ubWV0aG9kLnN1YlByb2Nlc3NJbnN0YW5jZS5zZXRTUFN0YXR1cywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUuc3ViUHJvY2Vzc0luc3RhbmNlLnNldFNQU3RhdHVzKGFjdGlvbi5tZXRob2Quc3ViUHJvY2Vzc0luc3RhbmNlLnNldFNQU3RhdHVzLCB1dWlkLCBkYXRhVmFsdWUsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdXBkYXRlIHN1YnByb2Nlc3MgbGFiZWwgaW4gd29ya2Zsb3cgaW5zdGFuY2UgcHJvY2VzcyBvYmplY3Q6IFRPRE9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdCBpbiBzdWJwcm9jZXNzIGFjdGlvbi5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdzdGVwJzpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnY29tbXVuaXR5JzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbW11bml0eVBvc3NpYmxlSXRlbXMgPSBbXCJjcmVhdGVDb21tdW5pdHlcIiwgXCJyZWxlYXNlQWRvcHRlZEFwcGxpY2F0aW9uXCIsIFwidXNlckpvaW5Db21tdW5pdHlcIl07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoYWN0aW9uLm1ldGhvZC5jb21tdW5pdHksIGNvbW11bml0eVBvc3NpYmxlSXRlbXMpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZUNvbW11bml0eSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUuY29tbXVuaXR5LmNyZWF0ZUNvbW11bml0eShhY3Rpb24ubWV0aG9kLmNvbW11bml0eS5jcmVhdGVDb21tdW5pdHksIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JlbGVhc2VBZG9wdGVkQXBwbGljYXRpb24nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLmNvbW11bml0eS5yZWxlYXNlQWRvcHRlZEFwcGxpY2F0aW9uKGFjdGlvbi5tZXRob2QuY29tbXVuaXR5LnJlbGVhc2VBZG9wdGVkQXBwbGljYXRpb24sIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3VzZXJKb2luQ29tbXVuaXR5JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5jb21tdW5pdHkudXNlckpvaW5Db21tdW5pdHkoYWN0aW9uLm1ldGhvZC5jb21tdW5pdHkudXNlckpvaW5Db21tdW5pdHksIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdhcHBsaWNhdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIHZhciBhcHBsaWNhdGlvblBvc3NpYmxlSXRlbXMgPSBbXCJjcmVhdGVBcHBEZWZpbml0aW9uXCIsIFwiYnVpbGRBcHBsaWNhdGlvblwiLCBcImFwcGxpY2F0aW9uQWRvcHRpb25cIl07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoYWN0aW9uLm1ldGhvZC5hcHBsaWNhdGlvbiwgYXBwbGljYXRpb25Qb3NzaWJsZUl0ZW1zKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjcmVhdGVBcHBEZWZpbml0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5hcHBsaWNhdGlvbi5jcmVhdGVBcHBEZWZpbml0aW9uKGFjdGlvbi5tZXRob2QuYXBwbGljYXRpb24uY3JlYXRlQXBwRGVmaW5pdGlvbiwgdXVpZCwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnVpbGRBcHBsaWNhdGlvbic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUuYXBwbGljYXRpb24uYnVpbGRBcHBsaWNhdGlvbihhY3Rpb24ubWV0aG9kLmFwcGxpY2F0aW9uLmJ1aWxkQXBwbGljYXRpb24sIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FwcGxpY2F0aW9uQWRvcHRpb24nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLmFwcGxpY2F0aW9uLmFwcGxpY2F0aW9uQWRvcHRpb24oYWN0aW9uLm1ldGhvZC5hcHBsaWNhdGlvbi5hcHBsaWNhdGlvbkFkb3B0aW9uLCB1dWlkLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICd1c2VyJzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJQb3NzaWJsZUl0ZW1zID0gW1wiYWRkVG9Sb2xlXCJdO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2QudXNlciwgdXNlclBvc3NpYmxlSXRlbXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhZGRUb1JvbGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnVzZXIuYWRkVG9Sb2xlKGFjdGlvbi5tZXRob2QudXNlci5hZGRUb1JvbGUsIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2RvJzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNkb1Bvc3NpYmxlSXRlbXMgPSBbXCJjcmVhdGVcIiwgXCJlbnJvbGxDb3Vyc2VcIl07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoYWN0aW9uLm1ldGhvZC5zZG8sIHNkb1Bvc3NpYmxlSXRlbXMpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUuc2RvLmNyZWF0ZShhY3Rpb24ubWV0aG9kLnNkby5jcmVhdGUsIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdlbnJvbGxDb3Vyc2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnNkby5lbnJvbGxDb3Vyc2UoYWN0aW9uLm1ldGhvZC5zZG8uZW5yb2xsQ291cnNlLCB1dWlkLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdwZXJmb3JtYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgIHZhciBwZXJmb3JtYW5jZVBvc3NpYmxlSXRlbXMgPSBbXCJ1bmxvY2tQZXJpb2RcIiwgXCJsb2NrUGVyZm9ybWFuY2VNb2RlbFwiLCBcInNldE1vZGVsU3RhdHVzXCJdO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2QucGVyZm9ybWFuY2UsIHBlcmZvcm1hbmNlUG9zc2libGVJdGVtcykpIHtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd1bmxvY2tQZXJpb2QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnBlcmZvcm1hbmNlLnVubG9ja1BlcmlvZChhY3Rpb24ubWV0aG9kLnBlcmZvcm1hbmNlLnVubG9ja1BlcmlvZCwgdXVpZCwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NldE1vZGVsU3RhdHVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5wZXJmb3JtYW5jZS5zZXRNb2RlbFN0YXR1cyhhY3Rpb24ubWV0aG9kLnBlcmZvcm1hbmNlLnNldE1vZGVsU3RhdHVzLCB1dWlkLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbG9ja1BlcmZvcm1hbmNlTW9kZWwnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnBlcmZvcm1hbmNlLmxvY2tQZXJmb3JtYW5jZU1vZGVsKGFjdGlvbi5tZXRob2QucGVyZm9ybWFuY2UubG9ja1BlcmZvcm1hbmNlTW9kZWwsIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJObyBtZXRob2QgZm91bmQgZnJvbSBpbXBsZW1lbnRlZCBsaXN0LlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAndGF4b25vbXknOlxuICAgICAgICAgICAgICAgICAgICB2YXIgdGF4b25vbXlQb3NzaWJsZUl0ZW1zID0gW1wiY3JlYXRlXCJdO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2QudGF4b25vbXksIHRheG9ub215UG9zc2libGVJdGVtcykpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY3JlYXRlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS50YXhvbm9teS5jcmVhdGUoYWN0aW9uLm1ldGhvZC50YXhvbm9teS5jcmVhdGUsIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICd2YXJpYWJsZXMnOlxuICAgICAgICAgICAgICAgICAgICB2YXIgdmFyaWFibGVzUG9zc2libGVJdGVtcyA9IFtcInNldFZhcmlhYmxlXCJdO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2QudmFyaWFibGVzLCB2YXJpYWJsZXNQb3NzaWJsZUl0ZW1zKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzZXRWYXJpYWJsZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS52YXJpYWJsZXMuc2V0VmFyaWFibGUoYWN0aW9uLm1ldGhvZC52YXJpYWJsZXMuc2V0VmFyaWFibGUsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdub3RpZmljYXRpb24nOlxuXG5cbiAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mIGFjdGlvbi5tZXRob2Qubm90aWZpY2F0aW9uID09PSBcInN0cmluZ1wiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVBc3NpZ25tZW50TklkID0gYWN0aW9uLm1ldGhvZC5ub3RpZmljYXRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhby5nZXRDb25maWcocmVBc3NpZ25tZW50TklkKS50aGVuKGZ1bmN0aW9uKHJlQXNzaWdubWVudE9iamVjdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm1ldGhvZC5ub3RpZmljYXRpb24gPSByZUFzc2lnbm1lbnRPYmplY3Q7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLm5vdGlmaWNhdGlvbi5zZW5kTm90aWZpY2F0aW9uV29ya2VyKGFjdGlvbi5tZXRob2Qubm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOyBcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZmFpbCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShmYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUubm90aWZpY2F0aW9uLnNlbmROb3RpZmljYXRpb25Xb3JrZXIoYWN0aW9uLm1ldGhvZC5ub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICBjYXNlICdyZXBvcnQnOlxuICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVwb3J0UG9zc2libGVJdGVtcyA9IFtcImNyZWF0ZVBlcmZvcm1hbmNlUmVwb3J0XCIsIFwiY3JlYXRlUmVwb3J0XCIsIFwic2RvUmVwb3J0XCIsIFwiZXhlY3V0ZVJlcG9ydFwiLCBcInJlcXVlc3RSZXBvcnRcIiwgXCJnZW5lcmF0ZVZpZXdcIiwgXCJnZW5lcmF0ZUJhc2ljVmlld1wiLCBcImdlbmVyYXRlVW5pb25WaWV3XCIsIFwic2RvUmVwb3J0TXVsdGlwbGVcIiwgXCJzdWJwcm9maWxlUXVhcnRlcmx5UmVwb3J0XCJdO1xuXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoYWN0aW9uLm1ldGhvZC5yZXBvcnQsIHJlcG9ydFBvc3NpYmxlSXRlbXMpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZVBlcmZvcm1hbmNlUmVwb3J0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5yZXBvcnQuY3JlYXRlUGVyZm9ybWFuY2VSZXBvcnQoYWN0aW9uLm1ldGhvZC5yZXBvcnQuY3JlYXRlUGVyZm9ybWFuY2VSZXBvcnQsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZVJlcG9ydCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucmVwb3J0LmNyZWF0ZVJlcG9ydChhY3Rpb24ubWV0aG9kLnJlcG9ydC5jcmVhdGVSZXBvcnQsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzZG9SZXBvcnQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnJlcG9ydC5zZG9SZXBvcnQoYWN0aW9uLm1ldGhvZC5yZXBvcnQuc2RvUmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZXhlY3V0ZVJlcG9ydCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucmVwb3J0LmV4ZWN1dGVSZXBvcnQoYWN0aW9uLm1ldGhvZC5yZXBvcnQuZXhlY3V0ZVJlcG9ydCwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2dlbmVyYXRlVmlldyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucmVwb3J0LmdlbmVyYXRlVmlldyhhY3Rpb24ubWV0aG9kLnJlcG9ydC5nZW5lcmF0ZVZpZXcsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdyZXF1ZXN0UmVwb3J0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5yZXBvcnQucmVxdWVzdFJlcG9ydChhY3Rpb24ubWV0aG9kLnJlcG9ydC5yZXF1ZXN0UmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZ2VuZXJhdGVCYXNpY1ZpZXcnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnJlcG9ydC5nZW5lcmF0ZUJhc2ljVmlldyhhY3Rpb24ubWV0aG9kLnJlcG9ydC5nZW5lcmF0ZUJhc2ljVmlldywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2dlbmVyYXRlVW5pb25WaWV3JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5yZXBvcnQuZ2VuZXJhdGVVbmlvblZpZXcoYWN0aW9uLm1ldGhvZC5yZXBvcnQuZ2VuZXJhdGVVbmlvblZpZXcsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Nkb1JlcG9ydE11bHRpcGxlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5yZXBvcnQuc2RvUmVwb3J0TXVsdGlwbGUoYWN0aW9uLm1ldGhvZC5yZXBvcnQuc2RvUmVwb3J0TXVsdGlwbGUsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzdWJwcm9maWxlUXVhcnRlcmx5UmVwb3J0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5yZXBvcnQuc3VicHJvZmlsZVF1YXJ0ZXJseVJlcG9ydChhY3Rpb24ubWV0aG9kLnJlcG9ydC5zdWJwcm9maWxlUXVhcnRlcmx5UmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3dvcmtlcic6XG4gICAgICAgICAgICAgICAgICAgIHZhciB3b3JrZXJQb3NzaWJsZUl0ZW1zID0gW1wic2VuZFdvcmtlclwiLCBcImV4ZWN1dGVMb2NhbFwiLCBcImNyZWF0ZVwiXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhhY3Rpb24ubWV0aG9kLndvcmtlciwgd29ya2VyUG9zc2libGVJdGVtcykpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2VuZFdvcmtlcic6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS53b3JrZXIuc2VuZFdvcmtlcihhY3Rpb24ubWV0aG9kLndvcmtlci5zZW5kV29ya2VyLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdleGVjdXRlTG9jYWwnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUud29ya2VyLmV4ZWN1dGVMb2NhbChhY3Rpb24ubWV0aG9kLndvcmtlci5leGVjdXRlTG9jYWwsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS53b3JrZXIuY3JlYXRlKGFjdGlvbi5tZXRob2Qud29ya2VyLmNyZWF0ZSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJObyBtZXRob2QgZm91bmQgZnJvbSBpbXBsZW1lbnRlZCBsaXN0LlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cblxuICAgICAgICAgICAgICAgIGNhc2UgJ3BhcnRpY2lwYW50cyc6XG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0aWNpcGFudFBvc3NpYmxlSXRlbXMgPSBbXCJsaW5rUGFydGljaXBhbnRzXCIsIFwibW9udGhseUF0dGVuZGFuY2VcIiwgXCJtb250aGx5UHJvZ3Jlc3NTdW1tYXJ5XCIsIFwicGFydGljaXBhbnRDb250cmFjdHNcIl07XG5cbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhhY3Rpb24ubWV0aG9kLnBhcnRpY2lwYW50cywgcGFydGljaXBhbnRQb3NzaWJsZUl0ZW1zKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdsaW5rUGFydGljaXBhbnRzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5wYXJ0aWNpcGFudHMubGlua1BhcnRpY2lwYW50cyhhY3Rpb24ubWV0aG9kLnBhcnRpY2lwYW50cy5saW5rUGFydGljaXBhbnRzLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtb250aGx5QXR0ZW5kYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucGFydGljaXBhbnRzLm1vbnRobHlBdHRlbmRhbmNlKGFjdGlvbi5tZXRob2QucGFydGljaXBhbnRzLm1vbnRobHlBdHRlbmRhbmNlLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtb250aGx5UHJvZ3Jlc3NTdW1tYXJ5JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5wYXJ0aWNpcGFudHMubW9udGhseVByb2dyZXNzU3VtbWFyeShhY3Rpb24ubWV0aG9kLnBhcnRpY2lwYW50cy5tb250aGx5UHJvZ3Jlc3NTdW1tYXJ5LCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncGFydGljaXBhbnRDb250cmFjdHMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnBhcnRpY2lwYW50cy5wYXJ0aWNpcGFudENvbnRyYWN0cyhhY3Rpb24ubWV0aG9kLnBhcnRpY2lwYW50cy5wYXJ0aWNpcGFudENvbnRyYWN0cywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcImdlbmVyYWxGdW5jdGlvbnNcIjpcblxuICAgICAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVJdGVtcyA9IFtcImFkZFRvRmF2b3VyaXRlc1wiLCBcImFkZFRvVXNlckZhdm91cml0ZXNcIl07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoYWN0aW9uLm1ldGhvZC5nZW5lcmFsRnVuY3Rpb25zLCBwb3NzaWJsZUl0ZW1zKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhZGRUb0Zhdm91cml0ZXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLmdlbmVyYWxGdW5jdGlvbnMuYWRkVG9GYXZvdXJpdGVzKGFjdGlvbi5tZXRob2QuZ2VuZXJhbEZ1bmN0aW9ucy5hZGRUb0Zhdm91cml0ZXMsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhZGRUb1VzZXJGYXZvdXJpdGVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5nZW5lcmFsRnVuY3Rpb25zLmFkZFRvVXNlckZhdm91cml0ZXMoYWN0aW9uLm1ldGhvZC5nZW5lcmFsRnVuY3Rpb25zLmFkZFRvVXNlckZhdm91cml0ZXMsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cblxuXG5cblxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChcIm1ldGhvZCBub3QgZGVmaW5lZCBpbiBjb25maWd1cmF0aW9uXCIpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG5cbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgdGFza3NcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gdGFzayAtIHRoZSB0YXNrIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gaW5wdXREYXRhIC0gdGhlIHVzZXIgaW5wdXQgZGF0YVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gdGFzayhzdWJwcm9jZXNzSUQsIHN1YnByb2Nlc3NTRVEsIHRhc2ssIHNwdXVpZCwgbW9kZWwpIHtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICB2YXIgX1dGSW5zdGFuY2UgPSBhcHAuU0NPUEUud29ya2Zsb3c7XG4gICAgICAgIHZhciBwcmVBY3Rpb25zQ29uZiA9IHRhc2sucHJlQWN0aW9ucztcbiAgICAgICAgcHJlQWN0aW9ucyhwcmVBY3Rpb25zQ29uZiwgX1dGSW5zdGFuY2UsIHNwdXVpZCkudGhlbihmdW5jdGlvbihwcmVBY3Rpb25SZXN1bHQpIHtcblxuICAgICAgICAgICAgdmFyIGxpc3QgPSBbXTtcblxuXG4gICAgICAgICAgICBpZiAodGFzay5hc3NpZ24ucm9sZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgYXNzaWduVHlwZSA9ICdwcm9maWxlUm9sZSc7XG4gICAgICAgICAgICAgICAgdmFyIHByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgdmFyIGlkID0gJyc7XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc1RvQXNzaWduRXh0ZXJuYWwgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgcm9sZSA9IHRhc2suYXNzaWduLnJvbGUucm9sZUlkO1xuICAgICAgICAgICAgICAgICAgICBsaWJyYXJ5LmdldFVzZXJzRnJvbVByb2ZpbGVSb2xlKGlkLCByb2xlKS50aGVuKGZ1bmN0aW9uKGxpc3QpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpc3QgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGlzdC5sZW5ndGggPiAxKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkaW5nIHJvbGVzIGZyb20gZXh0ZXJuYWwgcHJvZmlsZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc0N1cnJlbnRVc2VyRXhpc3RJbkdpdmVuUm9sZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1aWQgPSBsaXN0W2ldLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkID09IGxpc3RbaV0uaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0N1cnJlbnRVc2VyRXhpc3RJbkdpdmVuUm9sZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0N1cnJlbnRVc2VyRXhpc3RJbkdpdmVuUm9sZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWduZWUgPSBtb2RlbC5hc3NpZ25lZFRvO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFzc2lnbmVlLnVzZXJJZCAhPSBcIlwiICYmIGFzc2lnbmVlLm5hbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdPYmogPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFzc2lnbmVlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkucHVzaChuZXdPYmopO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLm5hbWUgPSBfbGNseC5TRVNTSU9OLmZpcnN0TmFtZSArIFwiIFwiICsgX2xjbHguU0VTU0lPTi5sYXN0TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLnVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS50eXBlID0gQVNTSUdOTUVOVF9UWVBFX0FVVE87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5kdWVEYXRlVGltZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuYnkgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdGlmaWNhdGlvbiB0aGF0IGl0cyBiZWVuIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdG8geW91XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1NlbmQgYXNzaWduIHVzZXIgbm90aWZpY2F0aW9uIGZyb20gaGVyZVxuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJwcm9jZXNzSUQgKyBcIiddL25vdGlmaWNhdGlvbnNcIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uICE9IHVuZGVmaW5lZCAmJiBub3RpZmljYXRpb24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlciA9IHsgJ2lkJzogX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQsICduYW1lJzogX2xjbHguU1VCU0NSSVBUSU9OUy51c2VybmFtZSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBub3RpZmljYXRpb24uYXNzaWdubWVudCA9PT0gXCJzdHJpbmdcIil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudE5JZCA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLmdldENvbmZpZyhhc3NpZ25tZW50TklkKS50aGVuKGZ1bmN0aW9uKGFzc2lnbm1lbnRPYmplY3Qpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQgPSBhc3NpZ25tZW50T2JqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLm5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Tm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHNwdXVpZCwgdXNlcikudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmNhdGNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWdubWVudCBub3RpZmljYXRpb24gZmFpbGVkIHRvIHVzZXIgVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihmYWlsKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZmFpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLm5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Tm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHNwdXVpZCwgdXNlcikudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25lZCBzdWNjZXNzZnVsbHkuIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihmYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWdubWVudCBub3RpZmljYXRpb24gZmFpbGVkIHRvIHVzZXIgVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFzay5hc3NpZ24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSBtb2RlbC5hc3NpZ25tZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjY2VwdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5hY2NlcHQuc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCI6IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQuYWNjZXB0LmxhYmVsLmkxOG4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LmFjY2VwdCA9IGFjY2VwdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQubWVzc2FnZSA9IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQubWVzc2FnZS5pMThuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWplY3QgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93XCI6IHRhc2suYXNzaWduLmFzc2lnbm1lbnQucmVqZWN0LnNob3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LnJlamVjdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5yZWplY3QgPSByZWplY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwidXNlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IGxpc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucHJvZmlsZVJvbGVJZCA9IGlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDdXJyZW50VXNlckV4aXN0SW5HaXZlblJvbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vRmlyZSBQcmUtd29ya0FjdGlvbnMgaGVyZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXNbc3ViUHJvY2Vzc2VzL3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1t1dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9zdGVwL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHByb2Nlc3NJZCArIFwiJ10vc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzSWQgKyBcIiddL3N0ZXBzW19pZCBlcSAnXCIgKyBzdGVwSWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLnByZVdvcmtBY3Rpb25zICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZVdvcmtBY3Rpb25zT2JqID0gdGFzay5wcmVXb3JrQWN0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVXb3JrQWN0aW9ucyhwcmVXb3JrQWN0aW9uc09iaiwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdBc3NpZ25tZW50IGlzIG1hZGUuIFByZSB3b3JrIGFjdGlvbnMgZm91bmQgYW5kIGV4ZWN1dGVkICcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdBc3NpZ25tZW50IGlzIG1hZGUuIE5vIHByZSB3b3JrIGFjdGlvbnMgZm91bmQuICcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdGlmaWNhdGlvbiB0aGF0IGl0cyBiZWVuIHJlbGVhc2VkIGZvciBhY2NlcHRhbmNlXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub3RpZmljYXRpb24gPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3VicHJvY2Vzc0lEICsgXCInXS9ub3RpZmljYXRpb25zXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9pc3N1ZSBoZXJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uICE9IHVuZGVmaW5lZCAmJiBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2UgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXIgPSB7ICdpZCc6IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkLCAnbmFtZSc6IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcm5hbWUgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLm5vdGlmaWNhdGlvbi5hY2NlcHRhbmNlTm90aWZpY2F0aW9uRXh0ZXJuYWwobm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgc3B1dWlkLCBsaXN0KS50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdOb3RpZmljYXRpb25zIHJlcXVlc3Qgc3VibWl0dGVkIGZvciBhY2NlcHRhbmNlLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5jYXRjaChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnTm90aWZpY2F0aW9ucyBmYWlsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdOb3RpZmljYXRpb25zIG5vdCBmb3VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGlzdC5sZW5ndGggPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbXBsZW1lbnQgaGVyZSBwcmVXb3JrQWN0aW9uIGFzIHRoaXMgaXMgYXV0b21hdGljYWxseSBhc3NpZ25lZCBpbiBjYXNlIG9mIDEgdXNlciBhbmQgd2lsbCBub3QgZ28gdHJvdWdoIGFjY2VwdGFuY2UgZnVuY3Rpb24uXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGxpc3RbMF0uaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VybmFtZSA9IGxpc3RbMF0ubmFtZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFzc2lnbmVlLnVzZXJJZCAhPSBcIlwiICYmIGFzc2lnbmVlLm5hbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld09iaiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXNzaWduZWUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5LnB1c2gobmV3T2JqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5uYW1lID0gdXNlcm5hbWUgKyBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS51c2VySWQgPSB1c2VySWQgKyBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS50eXBlID0gQVNTSUdOTUVOVF9UWVBFX0FVVE87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmR1ZURhdGVUaW1lID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmJ5ID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQgKyBcIlwiO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLmFzc2lnbi5hc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudCA9IG1vZGVsLmFzc2lnbm1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWNjZXB0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1wiOiB0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5zaG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIjogX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5hY2NlcHQubGFiZWwuaTE4bilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQuYWNjZXB0ID0gYWNjZXB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5tZXNzYWdlID0gX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5tZXNzYWdlLmkxOG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3Quc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCI6IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQucmVqZWN0LmxhYmVsLmkxOG4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnJlamVjdCA9IHJlamVjdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBsaXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcInVzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5wcm9maWxlUm9sZUlkID0gaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdGlmaWNhdGlvbiB0aGF0IGl0cyBiZWVuIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdG8geW91XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU2VuZCBhc3NpZ24gdXNlciBub3RpZmljYXRpb24gZnJvbSBoZXJlXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJwcm9jZXNzSUQgKyBcIiddL25vdGlmaWNhdGlvbnNcIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24gIT0gdW5kZWZpbmVkICYmIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXIgPSB7ICdpZCc6IHVzZXJJZCwgJ25hbWUnOiB1c2VybmFtZSB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2Ygbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQgPT09IFwic3RyaW5nXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudE5JZCA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5nZXRDb25maWcoYXNzaWdubWVudE5JZCkudGhlbihmdW5jdGlvbihhc3NpZ25tZW50T2JqZWN0KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQgPSBhc3NpZ25tZW50T2JqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYXNzaWdubWVudE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWduZWQgc3VjY2Vzc2Z1bGx5LiBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmNhdGNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGZhaWwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGZhaWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYXNzaWdubWVudE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0ZpcmUgUHJlLXdvcmtBY3Rpb25zIGhlcmVcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXNbc3ViUHJvY2Vzc2VzL3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcElkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vc3RlcC9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHByb2Nlc3NJZCArIFwiJ10vc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzSWQgKyBcIiddL3N0ZXBzW19pZCBlcSAnXCIgKyBzdGVwSWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLnByZVdvcmtBY3Rpb25zICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJlV29ya0FjdGlvbnNPYmogPSB0YXNrLnByZVdvcmtBY3Rpb25zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlV29ya0FjdGlvbnMocHJlV29ya0FjdGlvbnNPYmosIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdBc3NpZ25lZCB0byB0aGUgb25seSB1c2VyIGluIHJvbGUuIFByZSB3b3JrIGFjdGlvbnMgZXhlY3V0ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ0Fzc2lnbmVkIHRvIHRoZSBvbmx5IHVzZXIgaW4gcm9sZS4gTm8gcHJlIHdvcmsgYWN0aW9ucyBmb3VuZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9DYXNlIHdoZXJlIHVzZXJzIGxpc3QgPSAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25lZSA9IG1vZGVsLmFzc2lnbmVkVG87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLm5hbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS51c2VySWQgPSBcIlwiO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLmFzc2lnbi5hc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudCA9IG1vZGVsLmFzc2lnbm1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWNjZXB0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1wiOiB0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5zaG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIjogX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5hY2NlcHQubGFiZWwuaTE4bilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQuYWNjZXB0ID0gYWNjZXB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5tZXNzYWdlID0gX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5tZXNzYWdlLmkxOG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3Quc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCI6IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQucmVqZWN0LmxhYmVsLmkxOG4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnJlamVjdCA9IHJlamVjdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBsaXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcInVzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5wcm9maWxlUm9sZUlkID0gaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1dpbGwgYmUgZmlyZWQgZnJvbSBUYWtlQXNzaWdubWVudCBwYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJObyB1c2VycyBmb3VuZCBpbiBsaXN0LiBBc3NpZ25pbmcgYmxhbmsgXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCgnRXJyb3IgaW4gZ2V0VXNlcnNGcm9tUHJvZmlsZVJvbGUgJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NUb0Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcm9sZSA9IHRhc2suYXNzaWduLnJvbGUucm9sZUlkO1xuICAgICAgICAgICAgICAgICAgICBsaWJyYXJ5LmdldFVzZXJzTGlzdEJ5Um9sZShpZCwgcm9sZSkudGhlbihmdW5jdGlvbihsaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGlzdCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaXN0Lmxlbmd0aCA+IDEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOZXcgcmVxdWlyZW1lbnQgaGVyZSB3aWxsIGF1dG9tYXRpY2FsbHkgYXNzaWduIHRoZSBzdGVwIHRvIGN1cnJlbnQgdXNlciBpZiB0aGlzIHVzZXIgZmFsbHMgdW5kZXIgdGhlIHByb3ZpZGVkIGdyb3VwLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSVUxFIElOVFJPRFVDRUQgT04gMTYtTUFSQ0gtMjAxN1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiBjdXJyZW50IHVzZXIgbGllcyB3aXRoaW4gdGhlIHNwZWNpZmllZCByb2xlLCBpdCB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdG8gdGhhdCB1c2VyLlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc0N1cnJlbnRVc2VyRXhpc3RJbkdpdmVuUm9sZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm9sZXNPYmplY3QgPSBsaWJyYXJ5LmdldEN1cnJlbnRVc2VyUm9sZXMoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNDdXJyZW50VXNlclJvbGUxID0gcm9sZXNPYmplY3QucHJvZmlsZS5pbmRleE9mKHJvbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNDdXJyZW50VXNlclJvbGUyID0gcm9sZXNPYmplY3QuY29tbXVuaXR5LmluZGV4T2Yocm9sZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc0N1cnJlbnRVc2VyUm9sZTMgPSByb2xlc09iamVjdC5pbXBsaWNpdC5pbmRleE9mKHJvbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNDdXJyZW50VXNlclJvbGU0ID0gcm9sZXNPYmplY3QuYWRvcHRpb24uaW5kZXhPZihyb2xlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQ3VycmVudFVzZXJSb2xlNSA9IHJvbGVzT2JqZWN0LnN1YnByb2ZpbGUuaW5kZXhPZihyb2xlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDdXJyZW50VXNlclJvbGUxID4gLTEgfHwgaXNDdXJyZW50VXNlclJvbGUyID4gLTEgfHwgaXNDdXJyZW50VXNlclJvbGUzID4gLTEgfHwgaXNDdXJyZW50VXNlclJvbGU0ID4gLTEgfHwgaXNDdXJyZW50VXNlclJvbGU1ID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQ3VycmVudFVzZXJFeGlzdEluR2l2ZW5Sb2xlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQ3VycmVudFVzZXJFeGlzdEluR2l2ZW5Sb2xlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDdXJyZW50VXNlckV4aXN0SW5HaXZlblJvbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhc3NpZ25lZS51c2VySWQgIT0gXCJcIiAmJiBhc3NpZ25lZS5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3T2JqID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhc3NpZ25lZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5LnB1c2gobmV3T2JqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5uYW1lID0gX2xjbHguU0VTU0lPTi5maXJzdE5hbWUgKyBcIiBcIiArIF9sY2x4LlNFU1NJT04ubGFzdE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS51c2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUudHlwZSA9IEFTU0lHTk1FTlRfVFlQRV9BVVRPO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuZHVlRGF0ZVRpbWUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmJ5ID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQgKyBcIlwiO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RpZmljYXRpb24gdGhhdCBpdHMgYmVlbiBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHRvIHlvdVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TZW5kIGFzc2lnbiB1c2VyIG5vdGlmaWNhdGlvbiBmcm9tIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub3RpZmljYXRpb24gPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3VicHJvY2Vzc0lEICsgXCInXS9ub3RpZmljYXRpb25zXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbiAhPSB1bmRlZmluZWQgJiYgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXIgPSB7ICdpZCc6IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkLCAnbmFtZSc6IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcm5hbWUgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2Ygbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQgPT09IFwic3RyaW5nXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnROSWQgPSBub3RpZmljYXRpb24uYXNzaWdubWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5nZXRDb25maWcoYXNzaWdubWVudE5JZCkudGhlbihmdW5jdGlvbihhc3NpZ25tZW50T2JqZWN0KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50ID0gYXNzaWdubWVudE9iamVjdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYXNzaWdubWVudE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25lZCBzdWNjZXNzZnVsbHkuIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5jYXRjaChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihmYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZmFpbCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGZhaWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYXNzaWdubWVudE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWduZWQgc3VjY2Vzc2Z1bGx5LiBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmNhdGNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLmFzc2lnbi5hc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudCA9IG1vZGVsLmFzc2lnbm1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWNjZXB0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1wiOiB0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5zaG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIjogX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5hY2NlcHQubGFiZWwuaTE4bilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQuYWNjZXB0ID0gYWNjZXB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5tZXNzYWdlID0gX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5tZXNzYWdlLmkxOG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3Quc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCI6IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQucmVqZWN0LmxhYmVsLmkxOG4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnJlamVjdCA9IHJlamVjdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBwcm9maWxlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJyb2xlSWRcIjogcm9sZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJyb2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucHJvZmlsZVJvbGVJZCA9IGlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ3VycmVudFVzZXJFeGlzdEluR2l2ZW5Sb2xlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0ZpcmUgUHJlLXdvcmtBY3Rpb25zIGhlcmVcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzW3N1YlByb2Nlc3Nlcy91dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzSWQgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbdXVpZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcElkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vc3RlcC9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcElkICsgXCInXVwiLCBfV0ZJbnN0YW5jZS5jb25maWcsIHt9KVswXTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFzay5wcmVXb3JrQWN0aW9ucyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcmVXb3JrQWN0aW9uc09iaiA9IHRhc2sucHJlV29ya0FjdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlV29ya0FjdGlvbnMocHJlV29ya0FjdGlvbnNPYmosIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnQXNzaWdubWVudCBpcyBtYWRlLiBQcmUgd29yayBhY3Rpb25zIGZvdW5kIGFuZCBleGVjdXRlZCAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnQXNzaWdubWVudCBpcyBtYWRlLiBObyBwcmUgd29yayBhY3Rpb25zIGZvdW5kLiAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RpZmljYXRpb24gdGhhdCBpdHMgYmVlbiByZWxlYXNlZCBmb3IgYWNjZXB0YW5jZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm90aWZpY2F0aW9uID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YnByb2Nlc3NJRCArIFwiJ10vbm90aWZpY2F0aW9uc1wiLCBfV0ZJbnN0YW5jZS5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vaXNzdWUgaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbiAhPSB1bmRlZmluZWQgJiYgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VyID0geyAnaWQnOiBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCwgJ25hbWUnOiBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJuYW1lIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2UgPT09IFwic3RyaW5nXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnROSWQgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0Q29uZmlnKGFzc2lnbm1lbnROSWQpLnRoZW4oZnVuY3Rpb24oYXNzaWdubWVudE9iamVjdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2UgPSBhc3NpZ25tZW50T2JqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLm5vdGlmaWNhdGlvbi5hY2NlcHRhbmNlTm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHNwdXVpZCwgcm9sZSkudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdOb3RpZmljYXRpb25zIHJlcXVlc3Qgc3VibWl0dGVkIGZvciBhY2NlcHRhbmNlLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdOb3RpZmljYXRpb25zIGZhaWxlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25tZW50IG5vdGlmaWNhdGlvbiBmYWlsZWQgdG8gdXNlciBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihmYWlsKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZmFpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYWNjZXB0YW5jZU5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHJvbGUpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnTm90aWZpY2F0aW9ucyByZXF1ZXN0IHN1Ym1pdHRlZCBmb3IgYWNjZXB0YW5jZS4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5jYXRjaChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdOb3RpZmljYXRpb25zIGZhaWxlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ05vdGlmaWNhdGlvbnMgbm90IGZvdW5kJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaXN0Lmxlbmd0aCA9PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEltcGxlbWVudCBoZXJlIHByZVdvcmtBY3Rpb24gYXMgdGhpcyBpcyBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIGluIGNhc2Ugb2YgMSB1c2VyIGFuZCB3aWxsIG5vdCBnbyB0cm91Z2ggYWNjZXB0YW5jZSBmdW5jdGlvbi5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlcklkID0gbGlzdFswXS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJuYW1lID0gbGlzdFswXS5uYW1lO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWduZWUgPSBtb2RlbC5hc3NpZ25lZFRvO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXNzaWduZWUudXNlcklkICE9IFwiXCIgJiYgYXNzaWduZWUubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3T2JqID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhc3NpZ25lZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkucHVzaChuZXdPYmopO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLm5hbWUgPSB1c2VybmFtZSArIFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLnVzZXJJZCA9IHVzZXJJZCArIFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLnR5cGUgPSBBU1NJR05NRU5UX1RZUEVfQVVUTztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuZHVlRGF0ZVRpbWUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuYnkgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2suYXNzaWduLmFzc2lnbm1lbnQgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gbW9kZWwuYXNzaWdubWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY2NlcHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93XCI6IHRhc2suYXNzaWduLmFzc2lnbm1lbnQuYWNjZXB0LnNob3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5hY2NlcHQgPSBhY2NlcHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50Lm1lc3NhZ2UgPSBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50Lm1lc3NhZ2UuaTE4bik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1wiOiB0YXNrLmFzc2lnbi5hc3NpZ25tZW50LnJlamVjdC5zaG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIjogX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3QubGFiZWwuaTE4bilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucmVqZWN0ID0gcmVqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IHByb2ZpbGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJvbGVJZFwiOiByb2xlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcInJvbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5wcm9maWxlUm9sZUlkID0gaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdGlmaWNhdGlvbiB0aGF0IGl0cyBiZWVuIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdG8geW91XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU2VuZCBhc3NpZ24gdXNlciBub3RpZmljYXRpb24gZnJvbSBoZXJlXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJwcm9jZXNzSUQgKyBcIiddL25vdGlmaWNhdGlvbnNcIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24gIT0gdW5kZWZpbmVkICYmIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXIgPSB7ICdpZCc6IHVzZXJJZCwgJ25hbWUnOiB1c2VybmFtZSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBub3RpZmljYXRpb24uYXNzaWdubWVudCA9PT0gXCJzdHJpbmdcIil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50TklkID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLmdldENvbmZpZyhhc3NpZ25tZW50TklkKS50aGVuKGZ1bmN0aW9uKGFzc2lnbm1lbnRPYmplY3Qpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uYXNzaWdubWVudCA9IGFzc2lnbm1lbnRPYmplY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLm5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Tm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHNwdXVpZCwgdXNlcikudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25lZCBzdWNjZXNzZnVsbHkuIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihmYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWdubWVudCBub3RpZmljYXRpb24gZmFpbGVkIHRvIHVzZXIgVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZmFpbCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZmFpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLm5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Tm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHNwdXVpZCwgdXNlcikudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWduZWQgc3VjY2Vzc2Z1bGx5LiBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5jYXRjaChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWdubWVudCBub3RpZmljYXRpb24gZmFpbGVkIHRvIHVzZXIgVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vRmlyZSBQcmUtd29ya0FjdGlvbnMgaGVyZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzSWQgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlc1tzdWJQcm9jZXNzZXMvdXVpZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzSWQgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbdXVpZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9zdGVwL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgcHJvY2Vzc0lkICsgXCInXS9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NJZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2sucHJlV29ya0FjdGlvbnMgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcmVXb3JrQWN0aW9uc09iaiA9IHRhc2sucHJlV29ya0FjdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVXb3JrQWN0aW9ucyhwcmVXb3JrQWN0aW9uc09iaiwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ0Fzc2lnbmVkIHRvIHRoZSBvbmx5IHVzZXIgaW4gcm9sZS4gUHJlIHdvcmsgYWN0aW9ucyBleGVjdXRlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnQXNzaWduZWQgdG8gdGhlIG9ubHkgdXNlciBpbiByb2xlLiBObyBwcmUgd29yayBhY3Rpb25zIGZvdW5kLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0Nhc2Ugd2hlcmUgdXNlcnMgbGlzdCA9IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUubmFtZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLnVzZXJJZCA9IFwiXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2suYXNzaWduLmFzc2lnbm1lbnQgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gbW9kZWwuYXNzaWdubWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY2NlcHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93XCI6IHRhc2suYXNzaWduLmFzc2lnbm1lbnQuYWNjZXB0LnNob3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5hY2NlcHQgPSBhY2NlcHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50Lm1lc3NhZ2UgPSBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50Lm1lc3NhZ2UuaTE4bik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1wiOiB0YXNrLmFzc2lnbi5hc3NpZ25tZW50LnJlamVjdC5zaG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIjogX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3QubGFiZWwuaTE4bilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucmVqZWN0ID0gcmVqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IHByb2ZpbGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJvbGVJZFwiOiByb2xlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcInJvbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5wcm9maWxlUm9sZUlkID0gaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1dpbGwgYmUgZmlyZWQgZnJvbSBUYWtlQXNzaWdubWVudCBwYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJObyB1c2VycyBmb3VuZCBpbiBsaXN0LiBBc3NpZ25pbmcgYmxhbmsgXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBpZiAodGFzay5hc3NpZ24ucm9sZS5wcm9maWxlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLmFzc2lnbi5yb2xlLnByb2ZpbGUgPT0gJ2N1cnJlbnQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGFzay5hc3NpZ24ucm9sZS5wcm9maWxlID09ICdjb21tdW5pdHknKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NUb0Fzc2lnbigpO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrLmFzc2lnbi5yb2xlLnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKHRhc2suYXNzaWduLnJvbGUucHJvZmlsZUlkLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKGZvcm1Qcm9maWxlSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gZm9ybVByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NUb0Fzc2lnbkV4dGVybmFsKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfVxuXG5cblxuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhc2suYXNzaWduLnVzZXIgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKHRhc2suYXNzaWduLnVzZXIudXNlck5hbWUsIF9XRkluc3RhbmNlLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24odXNlck5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZSh0YXNrLmFzc2lnbi51c2VyLnVzZXJJZCwgX1dGSW5zdGFuY2UsIHNwdXVpZCkudGhlbihmdW5jdGlvbih1c2VySWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJJZCA9IHVzZXJJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VybmFtZSA9IHVzZXJOYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhc3NpZ25lZS51c2VySWQgIT0gXCJcIiAmJiBhc3NpZ25lZS5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3T2JqID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhc3NpZ25lZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5LnB1c2gobmV3T2JqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLm5hbWUgPSB1c2VybmFtZSArIFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS51c2VySWQgPSB1c2VySWQgKyBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLnR5cGUgPSBBU1NJR05NRU5UX1RZUEVfQVVUTztcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmR1ZURhdGVUaW1lID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5ieSA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLmFzc2lnbi5hc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSBtb2RlbC5hc3NpZ25tZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY2NlcHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1wiOiB0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5zaG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCI6IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQuYWNjZXB0LmxhYmVsLmkxOG4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQuYWNjZXB0ID0gYWNjZXB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQubWVzc2FnZSA9IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQubWVzc2FnZS5pMThuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3Quc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LnJlamVjdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB1c2VySWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHVzZXJOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QucHVzaChpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucmVqZWN0ID0gcmVqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogcHJvZmlsZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBsaXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJ1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG5cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5wcm9maWxlUm9sZUlkID0gaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdGlmaWNhdGlvbiB0aGF0IGl0cyBiZWVuIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdG8geW91XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1NlbmQgYXNzaWduIHVzZXIgbm90aWZpY2F0aW9uIGZyb20gaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJwcm9jZXNzSUQgKyBcIiddL25vdGlmaWNhdGlvbnNcIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uICE9IHVuZGVmaW5lZCAmJiBub3RpZmljYXRpb24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlciA9IHsgJ2lkJzogdXNlcklkLCAnbmFtZSc6IHVzZXJuYW1lIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50ID09PSBcInN0cmluZ1wiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50TklkID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0Q29uZmlnKGFzc2lnbm1lbnROSWQpLnRoZW4oZnVuY3Rpb24oYXNzaWdubWVudE9iamVjdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uYXNzaWdubWVudCA9IGFzc2lnbm1lbnRPYmplY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUubm90aWZpY2F0aW9uLmFzc2lnbm1lbnROb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgc3B1dWlkLCB1c2VyKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWduZWQgc3VjY2Vzc2Z1bGx5LiBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25tZW50IG5vdGlmaWNhdGlvbiBmYWlsZWQgdG8gdXNlciBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGZhaWwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShmYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUubm90aWZpY2F0aW9uLmFzc2lnbm1lbnROb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgc3B1dWlkLCB1c2VyKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5jYXRjaChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25tZW50IG5vdGlmaWNhdGlvbiBmYWlsZWQgdG8gdXNlciBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvL0ZpcmUgUHJlLXdvcmtBY3Rpb25zIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzSWQgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlc1tzdWJQcm9jZXNzZXMvdXVpZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcElkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vc3RlcC9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcElkICsgXCInXVwiLCBfV0ZJbnN0YW5jZS5jb25maWcsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2sucHJlV29ya0FjdGlvbnMgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJlV29ya0FjdGlvbnNPYmogPSB0YXNrLnByZVdvcmtBY3Rpb25zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZVdvcmtBY3Rpb25zKHByZVdvcmtBY3Rpb25zT2JqLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ0Fzc2lnbmVkIHRvIHRoZSBvbmx5IHVzZXIgaW4gcm9sZS4gUHJlIHdvcmsgYWN0aW9ucyBleGVjdXRlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdBc3NpZ25lZCB0byB0aGUgb25seSB1c2VyIGluIHJvbGUuIE5vIHByZSB3b3JrIGFjdGlvbnMgZm91bmQuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhc2suYXNzaWduLnN3aW1sYW5lICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHN0ZXBJZCA9IHRhc2suYXNzaWduLnN3aW1sYW5lLnN0ZXBJZDtcbiAgICAgICAgICAgICAgICB2YXIgc2VxdWVuY2UgPSB0YXNrLmFzc2lnbi5zd2ltbGFuZS5zZXF1ZW5jZTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIHZhciBoaXN0b3J5TGlzdCA9IEpTT04ueHBhdGgoXCIvaGlzdG9yeVtpZCBlcSAnXCIgKyBzdGVwSWQgKyBcIiddXCIsIHN1YlByb2Nlc3MsIHt9KTtcbiAgICAgICAgICAgICAgICB2YXIgZGF0ZVNlYXJjaCA9ICcnO1xuICAgICAgICAgICAgICAgIGlmIChzZXF1ZW5jZSA9PSAnbGFzdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZVNlYXJjaCA9IEpTT04ueHBhdGgoXCJtYXgoZm9yICRzIGluIC8qIHJldHVybiB4czpkYXRlVGltZSgkcy9kYXRlVGltZUNyZWF0ZWQpKVwiLCBoaXN0b3J5TGlzdCwge30pWzBdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGVTZWFyY2ggPSBKU09OLnhwYXRoKFwibWluKGZvciAkcyBpbiAvKiByZXR1cm4geHM6ZGF0ZVRpbWUoJHMvZGF0ZVRpbWVDcmVhdGVkKSlcIiwgaGlzdG9yeUxpc3QsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGhpc3RvcnlPYmplY3QgPSBKU09OLnhwYXRoKFwiLypbeHM6ZGF0ZVRpbWUoZGF0ZVRpbWVDcmVhdGVkKSBlcSB4czpkYXRlVGltZSgnXCIgKyBkYXRlU2VhcmNoICsgXCInKV1cIiwgaGlzdG9yeUxpc3QsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudE9iamVjdCA9IEpTT04ueHBhdGgoXCIvYXNzaWdubWVudEhpc3RvcnlbbGFzdCgpXVwiLCBoaXN0b3J5T2JqZWN0LCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB2YXIgdXNlcklkID0gYXNzaWdubWVudE9iamVjdC51c2VySWQ7XG4gICAgICAgICAgICAgICAgdmFyIHVzZXJuYW1lID0gYXNzaWdubWVudE9iamVjdC5uYW1lO1xuXG4gICAgICAgICAgICAgICAgaWYgKG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9IFtdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBhc3NpZ25lZSA9IG1vZGVsLmFzc2lnbmVkVG87XG4gICAgICAgICAgICAgICAgaWYgKGFzc2lnbmVlLnVzZXJJZCAhPSBcIlwiICYmIGFzc2lnbmVlLm5hbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3T2JqID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhc3NpZ25lZSkpO1xuICAgICAgICAgICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeS5wdXNoKG5ld09iaik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFzc2lnbmVlLm5hbWUgPSB1c2VybmFtZSArIFwiXCI7XG4gICAgICAgICAgICAgICAgYXNzaWduZWUudXNlcklkID0gdXNlcklkICsgXCJcIjtcbiAgICAgICAgICAgICAgICBhc3NpZ25lZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIGFzc2lnbmVlLnR5cGUgPSBBU1NJR05NRU5UX1RZUEVfU1dJTUxBTkU7XG4gICAgICAgICAgICAgICAgYXNzaWduZWUuZHVlRGF0ZVRpbWUgPSAnJztcbiAgICAgICAgICAgICAgICBhc3NpZ25lZS5ieSA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcblxuICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gJyc7XG5cbiAgICAgICAgICAgICAgICAvLyBOb3RpZmljYXRpb24gdGhhdCBpdHMgYmVlbiBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHRvIHlvdVxuICAgICAgICAgICAgICAgIC8vU2VuZCBhc3NpZ24gdXNlciBub3RpZmljYXRpb24gZnJvbSBoZXJlXG4gICAgICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJwcm9jZXNzSUQgKyBcIiddL25vdGlmaWNhdGlvbnNcIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbiAhPSB1bmRlZmluZWQgJiYgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1c2VyID0geyAnaWQnOiB1c2VySWQsICduYW1lJzogdXNlcm5hbWUgfTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2Ygbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQgPT09IFwic3RyaW5nXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50TklkID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhby5nZXRDb25maWcoYXNzaWdubWVudE5JZCkudGhlbihmdW5jdGlvbihhc3NpZ25tZW50T2JqZWN0KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uYXNzaWdubWVudCA9IGFzc2lnbm1lbnRPYmplY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYXNzaWdubWVudE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihmYWlsKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGZhaWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYXNzaWdubWVudE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25lZCBzdWNjZXNzZnVsbHkuIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgKS5jYXRjaChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihmYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy9GaXJlIFByZS13b3JrQWN0aW9ucyBoZXJlXG4gICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzW3N1YlByb2Nlc3Nlcy91dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBzdGVwSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9zdGVwL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcElkICsgXCInXVwiLCBfV0ZJbnN0YW5jZS5jb25maWcsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIGlmICh0YXNrLnByZVdvcmtBY3Rpb25zICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmVXb3JrQWN0aW9uc09iaiA9IHRhc2sucHJlV29ya0FjdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgIHByZVdvcmtBY3Rpb25zKHByZVdvcmtBY3Rpb25zT2JqLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdBc3NpZ25lZCB0byB0aGUgb25seSB1c2VyIGluIHJvbGUuIFByZSB3b3JrIGFjdGlvbnMgZXhlY3V0ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdBc3NpZ25lZCB0byB0aGUgb25seSB1c2VyIGluIHJvbGUuIE5vIHByZSB3b3JrIGFjdGlvbnMgZm91bmQuJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn07XG5cblxuXG4vKipcbiAqIFByb2Nlc3MgdGFza3NcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gdGFzayAtIHRoZSB0YXNrIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gaW5wdXREYXRhIC0gdGhlIHVzZXIgaW5wdXQgZGF0YVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gc2VydmVyKHNlcnZlciwgcHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN1YlByb2Nlc3MsIG1vZGVsLCBfV0ZJbnN0YW5jZSwgZGF0YSwgdXVpZCkge1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIC8vdmFyIF9XRkluc3RhbmNlID0gYXBwLlNDT1BFLndvcmtmbG93O1xuICAgICAgICB2YXIgcHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgdmFyIGFjdGlvbkJsb2NrID0gc2VydmVyLnNlcnZlckFjdGlvblswXTtcbiAgICAgICAgaWYgKG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBhc3NpZ25lZSA9IG1vZGVsLmFzc2lnbmVkVG87XG4gICAgICAgIGlmIChhc3NpZ25lZS51c2VySWQgIT0gXCJcIiAmJiBhc3NpZ25lZS5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgIHZhciBuZXdPYmogPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFzc2lnbmVlKSk7XG4gICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeS5wdXNoKG5ld09iaik7XG4gICAgICAgIH1cbiAgICAgICAgYXNzaWduZWUubmFtZSA9IF9sY2x4LlNFU1NJT04uZmlyc3ROYW1lICsgXCIgXCIgKyBfbGNseC5TRVNTSU9OLmxhc3ROYW1lO1xuICAgICAgICBhc3NpZ25lZS51c2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG4gICAgICAgIGFzc2lnbmVlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgIGFzc2lnbmVlLnR5cGUgPSBBU1NJR05NRU5UX1RZUEVfQVVUTztcbiAgICAgICAgYXNzaWduZWUuZHVlRGF0ZVRpbWUgPSAnJztcbiAgICAgICAgYXNzaWduZWUuYnkgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG5cbiAgICAgICAgYWN0aW9uKGFjdGlvbkJsb2NrLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2VzcywgbW9kZWwsIF9XRkluc3RhbmNlLCBkYXRhLCB1dWlkKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShcIk5vIHVzZXJzIGZvdW5kIGluIGxpc3QuIEFzc2lnbmluZyBibGFuayBcIik7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoXCJTZXJ2ZXIgYWN0aW9uIGVycm9yIGZvdW5kIHJlamVjdGVkXCIpXG4gICAgICAgICAgICB9KTtcbiAgICB9KTtcblxufTtcblxuLyoqXG4gKiBQcm9jZXNzIHRyYW5zaXRpb25cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2UgcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdWJQcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdWItcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHN1YlByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2Ugc3ViLXByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RlcElkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3RlcCBpZFxuICogQHBhcmFtIHtzdHJpbmd9IHRyYW5zaXRpb25JZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHRyYW5zaXRpb24gaWRcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gYW55IGFkZGl0aW9uYWwgZGF0YSBwYXNzZWQgaW4gYXMga2V5IHZhbHVlIHBhaXJzXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgY3VycmVudCB3b3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gdHJhbnNpdGlvbihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCB0cmFuc2l0aW9uSWQsIGRhdGEsIF9XRkluc3RhbmNlLCBzcHV1aWQsIG1vZGVsKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIHN0ZXBTZXEgPSAwO1xuICAgICAgICAgICAgdmFyIG5leHRTdGVwSWQgPSAnJztcbiAgICAgICAgICAgIHZhciBuZXh0U3RlcFNlcSA9IDA7XG4gICAgICAgICAgICB2YXIgc3ViUHJvY2VzcyA9IFtdO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRQcm9jZXNzID0gX1dGSW5zdGFuY2UuY29uZmlnLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqUHJvY2Vzcykge1xuICAgICAgICAgICAgICAgIGlmIChvYmpQcm9jZXNzLl9pZCA9PSBwcm9jZXNzSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9ialByb2Nlc3M7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50U3ViUHJvY2VzcyA9IGN1cnJlbnRQcm9jZXNzWzBdLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqU3ViUHJvY2Vzcykge1xuICAgICAgICAgICAgICAgIGlmIChvYmpTdWJQcm9jZXNzLl9pZCA9PSBzdWJQcm9jZXNzSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9ialN1YlByb2Nlc3M7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50U3RlcCA9IGN1cnJlbnRTdWJQcm9jZXNzWzBdLnN0ZXBzLmZpbHRlcihmdW5jdGlvbihvYmpTdGVwKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9ialN0ZXAuX2lkID09IHN0ZXBJZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqU3RlcDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIHRyYW5zaXRpb24gPSBjdXJyZW50U3RlcFswXS50cmFuc2l0aW9uLmZpbHRlcihmdW5jdGlvbihvYmpUcmFuc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9ialRyYW5zaXRpb24uX2lkID09IHRyYW5zaXRpb25JZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqVHJhbnNpdGlvbjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjdXJyZW50U3ViUHJvY2Vzc1swXS5zdGVwcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3ViUHJvY2Vzc1swXS5zdGVwc1tpXS5faWQgPT0gc3RlcElkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0ZXBTZXEgPSBwYXJzZUludChjdXJyZW50U3ViUHJvY2Vzc1swXS5zdGVwc1tpXS5fc2VxKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHMuZmlsdGVyKGZ1bmN0aW9uKHN0ZXBJdGVtKSB7XG4gICAgICAgICAgICAgICAgbmV4dFN0ZXBTZXEgPSBzdGVwU2VxICsgMTtcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQoc3RlcEl0ZW0uX3NlcSkgPT0gbmV4dFN0ZXBTZXEpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV4dFN0ZXBJZCA9IHN0ZXBJdGVtLl9pZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pXG5cblxuXG5cbiAgICAgICAgICAgIHZhciBtYXhTdGVwcyA9IGN1cnJlbnRTdWJQcm9jZXNzWzBdLnN0ZXBzLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBzcGluc3RhbmNlT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIHZhciBzcEluc3RhbmNlU3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3N0ZXBcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgLy8gQWRkaW5nIHN0ZXAgT2JqZWN0IGluIHN1YnByb2Nlc3MgaGlzdG9yeSBGcm9tIHNlY29uZCBzdGVwLiBBcyBmaXJzdCBzdGVwIGlzIGFkZGVkIGF0IHN1YlByb2Nlc3MoKSBmdW5jdGlvbiBcbiAgICAgICAgICAgIGlmIChzcGluc3RhbmNlT2JqZWN0Lmhpc3RvcnkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc3BpbnN0YW5jZU9iamVjdC5oaXN0b3J5ID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcHVzaEluZGljYXRvclRvTW9kZWwgPSBmdW5jdGlvbihtb2RlbCkge1xuXG4gICAgICAgICAgICAgICAgLy8gSW4gYm90aCAgdGhlIGNhc2VzIHRoZSBsaXN0IGlzIGRpZmZlcm5ldCB0aGF0IG5lZWRzIHRvIGJlIG1hZGUgc2FtZS5cblxuICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JMaXN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaW5kaWNhdG9yc1wiLCBfV0ZJbnN0YW5jZSwge30pO1xuXG4gICAgICAgICAgICAgICAgdmFyIGlzRmlyc3QgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoaW5kaWNhdG9yTGlzdCA9PSB1bmRlZmluZWQgfHwgaW5kaWNhdG9yTGlzdC5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBpc0ZpcnN0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yTGlzdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1t3b3JrZmxvd3MvcHJvY2Vzc2VzW3N1YlByb2Nlc3NVVUlEIGVxICdcIiArIHNwdXVpZCArIFwiJ11dXCIsIF9XRkluc3RhbmNlLCB7fSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChtb2RlbC5pbmRpY2F0b3JzID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBtb2RlbC5pbmRpY2F0b3JzID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaW5kaWNhdG9yTGlzdC5sZW5ndGg7IGorKykge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0ZpcnN0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1dWlkID0gaW5kaWNhdG9yTGlzdFtqXS5faWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmV2ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9fcmV2XCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VxID0gaW5kaWNhdG9yTGlzdFtqXS5tb2RlbC5wZW5kaW5nLnNlcTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSBpbmRpY2F0b3JMaXN0W2pdLm1vZGVsLnBlbmRpbmcuc3RhdHVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dWlkOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldjogcmV2LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcTogc2VxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogc3RhdHVzXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5pbmRpY2F0b3JzLnB1c2goaW5kT2JqZWN0KTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXVpZCA9IGluZGljYXRvckxpc3Rbal0uaW5zdGFuY2VzWzBdLnV1aWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmV2ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9fcmV2XCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VxID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9tb2RlbC9wZW5kaW5nL3NlcVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXR1cyA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vbW9kZWwvcGVuZGluZy9zdGF0dXNcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXVpZDogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXY6IHJldixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXE6IHNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHN0YXR1c1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuaW5kaWNhdG9ycy5wdXNoKGluZE9iamVjdCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkZWxldGUgbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgICAgICAgICBkZWxldGUgbW9kZWwuYXNzaWdubWVudDtcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9kZWw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFkZCBpbmZvcm1hdGlvbiB0byB0cmFuc3Rpb24gb2JqZWN0LlxuICAgICAgICAgICAgdmFyIHRybk9iamVjdCA9IHtcbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uSWQ6IHRyYW5zaXRpb25bMF0uX2lkLFxuICAgICAgICAgICAgICAgIGRhdGVUaW1lOiBtb21lbnQoKS5mb3JtYXQoKSxcbiAgICAgICAgICAgICAgICB1c2VySWQ6IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG1vZGVsICE9IHVuZGVmaW5lZCAmJiBPYmplY3Qua2V5cyhtb2RlbCkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIG1vZGVsLnRyYW5zaXRpb24gPSB0cm5PYmplY3Q7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNwSW5zdGFuY2VTdGVwT2JqZWN0LnRyYW5zaXRpb24gPSB0cm5PYmplY3Q7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGNvcHkgY3VycmVudCBhc3NpZ25lZFRvIHRvIHJlQXNzaWdubWVudCBvYmplY3RcblxuICAgICAgICAgICAgaWYgKG1vZGVsICE9IHVuZGVmaW5lZCAmJiBPYmplY3Qua2V5cyhtb2RlbCkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGlmIChtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlT2JqID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShtb2RlbC5hc3NpZ25lZFRvKSk7XG4gICAgICAgICAgICAgICAgaWYgKGFzc2lnbmVlT2JqLnVzZXJJZCAhPSBcIlwiICYmIGFzc2lnbmVlT2JqLm5hbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeS5wdXNoKGFzc2lnbmVlT2JqKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHNwSW5zdGFuY2VTdGVwT2JqZWN0LmFzc2lnbm1lbnRIaXN0b3J5ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzcEluc3RhbmNlU3RlcE9iamVjdC5hc3NpZ25tZW50SGlzdG9yeSA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgYXNzaWduZWVPYmogPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNwSW5zdGFuY2VTdGVwT2JqZWN0LmFzc2lnbmVkVG8pKTtcbiAgICAgICAgICAgICAgICBpZiAoYXNzaWduZWVPYmoudXNlcklkICE9IFwiXCIgJiYgYXNzaWduZWVPYmoubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHNwSW5zdGFuY2VTdGVwT2JqZWN0LmFzc2lnbm1lbnRIaXN0b3J5LnB1c2goYXNzaWduZWVPYmopO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGhpc3RvcnlNb2RlbDtcbiAgICAgICAgICAgIGlmIChtb2RlbCAhPSB1bmRlZmluZWQgJiYgT2JqZWN0LmtleXMobW9kZWwpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBoaXN0b3J5TW9kZWwgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG1vZGVsKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGhpc3RvcnlNb2RlbCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc3BJbnN0YW5jZVN0ZXBPYmplY3QpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBpbmRNb2RlbEluU3RlcCA9IHB1c2hJbmRpY2F0b3JUb01vZGVsKGhpc3RvcnlNb2RlbCk7XG4gICAgICAgICAgICBzcGluc3RhbmNlT2JqZWN0Lmhpc3RvcnkucHVzaChpbmRNb2RlbEluU3RlcCk7XG5cbiAgICAgICAgICAgIGlmICh0cmFuc2l0aW9uWzBdLnRyYW5zaXRpb25BY3Rpb24uZ29Ub1N0ZXAgIT0gdW5kZWZpbmVkKSB7XG5cblxuXG4gICAgICAgICAgICAgICAgdmFyIG5leHRTZXEgPSBwYXJzZUludChjdXJyZW50U3RlcFswXS5fc2VxKSArIHBhcnNlSW50KHRyYW5zaXRpb25bMF0udHJhbnNpdGlvbkFjdGlvbi5nb1RvU3RlcC5kZWZhdWx0KTtcbiAgICAgICAgICAgICAgICB2YXIgbmV4dElkID0gJyc7XG4gICAgICAgICAgICAgICAgY3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHMuZmlsdGVyKGZ1bmN0aW9uKHN0ZXBJdGVtKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KHN0ZXBJdGVtLl9zZXEpID09IG5leHRTdGVwU2VxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0SWQgPSBzdGVwSXRlbS5faWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgc3RlcChwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgbmV4dElkLCBuZXh0U2VxLCBkYXRhLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobmV4dFNlcSA9PSBtYXhTdGVwcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0FsbCBTdGVwIHRyYW5zaXRpb25zIGhhdmUgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0NvbXBsZXRlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXA6IHJlc3VsdC5kYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdGVwIHRyYW5zaXRpb24gY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0NvbXBsZXRlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwOiByZXN1bHQuZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSBlbHNlIGlmICh0cmFuc2l0aW9uWzBdLnRyYW5zaXRpb25BY3Rpb24uZ29Ub1N0ZXBJZCAhPSB1bmRlZmluZWQpIHtcblxuXG5cbiAgICAgICAgICAgICAgICB2YXIgZ29Ub1N0ZXBJZCA9IHRyYW5zaXRpb25bMF0udHJhbnNpdGlvbkFjdGlvbi5nb1RvU3RlcElkLnN0ZXBJZDtcbiAgICAgICAgICAgICAgICB2YXIgZ29Ub1N0ZXBTZXEgPSAxO1xuXG4gICAgICAgICAgICAgICAgY3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHMuZmlsdGVyKGZ1bmN0aW9uKHN0ZXBJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGVwSXRlbS5faWQgPT0gZ29Ub1N0ZXBJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ29Ub1N0ZXBTZXEgPSBwYXJzZUludChzdGVwSXRlbS5fc2VxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBzdGVwKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBnb1RvU3RlcElkLCBnb1RvU3RlcFNlcSwgZGF0YSwgX1dGSW5zdGFuY2UsIHNwdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdvVG9TdGVwU2VxID09IG1heFN0ZXBzIHx8IHJlc3VsdC5kYXRhLnN0YXR1cyA9PSAnQ29tcGxldGUnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdBbGwgU3RlcCB0cmFuc2l0aW9ucyBoYXZlIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NDb21wbGV0ZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwOiByZXN1bHQuZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdGVwIHRyYW5zaXRpb24gY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0NvbXBsZXRlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwOiByZXN1bHQuZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHJhbnNpdGlvblswXS50cmFuc2l0aW9uQWN0aW9uLnN0b3AgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc3BpbnN0YW5jZU9iamVjdC5tZXNzYWdlcyA9IFtdO1xuICAgICAgICAgICAgICAgIC8vIEFzIHRoaXMgaXMgdGhlIGxhc3Qgc3RlcCAod2hlcmUgc3RvcCBpcyBkZWZpZWQpICwgc3ViUHJvY2VzcyBwb3N0QWN0aW9ucyBzaG91bGQgY29tZSBoZXJlLlxuICAgICAgICAgICAgICAgIHZhciBwb3N0QWN0aW9uc0NvbmYgPSBjdXJyZW50UHJvY2Vzc1swXS5wb3N0QWN0aW9ucztcbiAgICAgICAgICAgICAgICBwb3N0QWN0aW9ucyhwb3N0QWN0aW9uc0NvbmYsIF9XRkluc3RhbmNlLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1N0ZXAgdHJhbnNpdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LldvcmtmbG93IHN0b3BwZWQuJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0NvbXBsZXRlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RlcDogbW9kZWxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogUHJvY2VzcyBwb3N0QWN0aW9uc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBwb3N0QWN0aW9ucyAtIHRoZSBwb3N0QWN0aW9ucyBjb25maWcgZGF0YVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gcG9zdEFjdGlvbnMocG9zdEFjdGlvbnMsIF9XRkluc3RhbmNlLCBzcHV1aWQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHZhciBjb21wbGV0ZWQgPSBbXTtcbiAgICAgICAgdHJ5IHtcblxuXG4gICAgICAgICAgICB2YXIgc3BPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICB2YXIgcHJvY2Vzc0lEID0gc3BPYmplY3RbXCJtZXRhLWRhdGFcIl0ucHJvY2Vzc0NvbmZpZ0lkO1xuICAgICAgICAgICAgdmFyIHByb2Nlc3NJZCA9IHNwT2JqZWN0W1wibWV0YS1kYXRhXCJdLnN1YlByb2Nlc3NDb25maWdJZDtcbiAgICAgICAgICAgIHZhciBwcm9jZXNzU0VRID0gc3BPYmplY3RbXCJtZXRhLWRhdGFcIl0uc3ViUHJvY2Vzc0luc1NlcTtcbiAgICAgICAgICAgIHZhciBwcm9jZXNzU2VxID0gc3BPYmplY3RbXCJtZXRhLWRhdGFcIl0uc3ViUHJvY2Vzc0luc1NlcTtcblxuICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NDb25maWdPYmplY3QgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHByb2Nlc3NJRCArIFwiJ10vc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3N0ZXBcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuXG4gICAgICAgICAgICB1dGlsLnN5bmNMb29wKHBvc3RBY3Rpb25zLmxlbmd0aCwgZnVuY3Rpb24obG9vcCkge1xuICAgICAgICAgICAgICAgIHZhciBjb3VudGVyID0gbG9vcC5pdGVyYXRpb24oKTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ocG9zdEFjdGlvbnNbY291bnRlcl0sIHByb2Nlc3NJRCwgcHJvY2Vzc1NFUSwgcHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzQ29uZmlnT2JqZWN0LCBzdGVwT2JqZWN0LCBfV0ZJbnN0YW5jZSwge30sIHNwdXVpZCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGFsbCBwcmUtcmVxdWlzaXRlcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LlxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWQucHVzaCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgbG9vcC5uZXh0KCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZC5wdXNoKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgbG9vcC5icmVhaygpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChjb21wbGV0ZWQuZXZlcnkoQm9vbGVhbikpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1Bvc3QtYWN0aW9ucyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZUFjdGlvbnNFcnJvcicsICdOb3QgYWxsIHBvc3QtYWN0aW9ucyBwYXNzZWQuJyk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKlxuZnVuY3Rpb24gc2VuZE5vdGlmaWNhdGlvbnModXNlcnNMaXN0LCBzcHV1aWQpe1xuXG4gIC8vIGdldCB1c2VycyBsaXN0IFxuICAvLyBzZW4gbm90aWZpY2F0aW9ucyB0byB1c2VycyB5IGFkZGluZyBjaGFubmVscyB0byB0aGVtXG5cbiAgdmFyIGNoYW5uZWxBcnJheSA9IFtdO1xuXG4gIGZvcihpPTA7aTx1c2Vyc0xpc3QubGVuZ3RoOyBpKyspe1xuICAgIGNoYW5uZWxBcnJheS5wdXNoKFwidXNlcl9cIit1c2Vyc0xpc3RbaV0uaWQpO1xuICB9XG5cbiAgYXNzaWduVG9Vc2Vycyhwcm9jZXNzV29ya2Zsb3dNZXNzYWdlKE5PVElGSUNBVElPTl9VU0VSX01TR19BQ0NFUFQsIHNwdXVpZCksIGNoYW5uZWxBcnJheSk7XG5cbn07Ki9cblxuLypmdW5jdGlvbiBhc3NpZ25Ub1VzZXJzKG1lc3NhZ2UsIGNoYW5uZWxBcnJheSl7XG5cbiAgICAgdmFyIGNoYW5uZWxzID0gY2hhbm5lbEFycmF5O1xuXG4gICAgIHZhciBub3RpZmljYXRpb24gPSAgeyBcbiAgICAgICAgICBcIl9pZFwiOiBnZW5lcmF0ZVVVSUQoKSxcbiAgICAgICAgICBcImNoYW5uZWxzXCI6Y2hhbm5lbHMsXG4gICAgICAgICAgXCJtZXNzYWdlXCI6IG1lc3NhZ2UsXG4gICAgICAgICAgXCJtZXNzYWdlVHlwZVwiOiBcImluZm9cIixcbiAgICAgICAgICBcImNyZWF0ZWREYXRlVGltZVwiOiBtb21lbnQoKS5mb3JtYXQoKSxcbiAgICAgICAgICBcInJlYWRcIjogZmFsc2UsXG4gICAgICAgICAgXCJyZWFkRGF0ZVRpbWVcIjogXCJcIixcbiAgICAgICAgICBcInR5cGVcIjogXCJub3RpZmljYXRpb25cIixcbiAgICAgICAgICBcInNlbmRlclVzZXJJZFwiOiBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZFxuICAgICAgIH07XG5cbiAgICAgICBjb25zb2xlLmxvZyhub3RpZmljYXRpb24pO1xuICAgICAgIGRhby5zYXZlKG5vdGlmaWNhdGlvbik7XG5cbiAgfTsqL1xuXG5mdW5jdGlvbiBwcm9jZXNzV29ya2Zsb3dNZXNzYWdlKG1lc3NhZ2UsIHNwdXVpZCkge1xuXG4gICAgdmFyIHJlcGxhY2VkTXNnID0gbWVzc2FnZTtcblxuICAgIGlmIChyZXBsYWNlZE1zZy5pbmRleE9mKCcjSU5TVEFOQ0VfTEFCRUwnKSAhPT0gLTEpIHtcbiAgICAgICAgdmFyIHZhbCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1t1dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vbGFiZWxcIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgIHJlcGxhY2VkTXNnID0gcmVwbGFjZWRNc2cucmVwbGFjZSgnI0lOU1RBTkNFX0xBQkVMJywgdmFsKTtcblxuICAgIH1cblxuICAgIGlmIChyZXBsYWNlZE1zZy5pbmRleE9mKCcjVVNFUl9OQU1FJykgIT09IC0xKSB7XG4gICAgICAgIHZhciB2YWwgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9zdGVwL2Fzc2lnbmVkVG8vbmFtZVwiLCBhcHAuU0NPUEUud29ya2Zsb3csIHt9KVswXTtcblxuICAgICAgICByZXBsYWNlZE1zZyA9IHJlcGxhY2VkTXNnLnJlcGxhY2UoJyNVU0VSX05BTUUnLCB2YWwpO1xuXG4gICAgfVxuXG4gICAgaWYgKHJlcGxhY2VkTXNnLmluZGV4T2YoJyNQUk9GSUxFX1RJVExFJykgIT09IC0xKSB7XG4gICAgICAgIHZhciB2YWwgPSBhcHAucHJvZmlsZS50aXRsZTtcbiAgICAgICAgcmVwbGFjZWRNc2cgPSByZXBsYWNlZE1zZy5yZXBsYWNlKCcjUFJPRklMRV9USVRMRScsIHZhbCk7XG5cbiAgICB9XG5cbiAgICBpZiAocmVwbGFjZWRNc2cuaW5kZXhPZignI1BST0ZJTEVfVFlQRScpICE9PSAtMSkge1xuICAgICAgICB2YXIgdmFsID0gYXBwLlNDT1BFLkFQUF9DT05GSUcubmFtZTtcbiAgICAgICAgcmVwbGFjZWRNc2cgPSByZXBsYWNlZE1zZy5yZXBsYWNlKCcjUFJPRklMRV9UWVBFJywgdmFsKTtcblxuICAgIH1cblxuICAgIGlmIChyZXBsYWNlZE1zZy5pbmRleE9mKCcjVkFSX1NQVVVJRCcpICE9PSAtMSkge1xuICAgICAgICB2YXIgdmFsID0gc3B1dWlkO1xuICAgICAgICByZXBsYWNlZE1zZyA9IHJlcGxhY2VkTXNnLnJlcGxhY2UoJyNWQVJfU1BVVUlEJywgdmFsKTtcblxuICAgIH1cblxuICAgIHJldHVybiByZXBsYWNlZE1zZztcbn07XG5cbmZ1bmN0aW9uIF9nZXROYW1lKGFyciwgbGFuZykge1xuICAgIGlmIChhcnIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGFycltpXS5fbGFuZyA9PT0gbGFuZykge1xuICAgICAgICAgICAgICAgIHJldHVybiBhcnJbaV0udmFsdWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgfVxuXG59O1xuXG5mdW5jdGlvbiBfZ2V0TmFtZUJ5TGFuZyhvYmopIHtcbiAgICByZXR1cm4gbGlicmFyeS5nZXROYW1lQnlMYW5nKG9iaik7XG59O1xuXG5cblxuXG5cbi8qKlxuICogUHJvY2VzcyBwcmVXb3JrQWN0aW9uc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBwcmVXb3JrQWN0aW9ucyAtIHRoZSBwcmVXb3JrQWN0aW9ucyBjb25maWcgZGF0YVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuXG5mdW5jdGlvbiBwcmVXb3JrQWN0aW9ucyhwcmVXb3JrQWN0aW9ucywgX1dGSW5zdGFuY2UpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHZhciBjb21wbGV0ZWQgPSBbXTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzQ29uZmlnT2JqZWN0ID0gSlNPTi54cGF0aChcIi9jb25maWcvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBhcHAuU0NPUEUuc3BvLnBPYmplY3QuaWQgKyBcIiddL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgYXBwLlNDT1BFLnNwby5zcE9iamVjdC5pZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIHZhciBzdGVwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIGFwcC5TQ09QRS5wcm9jZXNzVVVJRCArIFwiJ10vc3RlcFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICB1dGlsLnN5bmNMb29wKHByZVdvcmtBY3Rpb25zLmxlbmd0aCwgZnVuY3Rpb24obG9vcCkge1xuICAgICAgICAgICAgICAgIHZhciBjb3VudGVyID0gbG9vcC5pdGVyYXRpb24oKTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ocHJlV29ya0FjdGlvbnNbY291bnRlcl0sIGFwcC5TQ09QRS5zcG8ucE9iamVjdC5pZCwgYXBwLlNDT1BFLnNwby5wT2JqZWN0LnNlcSwgYXBwLlNDT1BFLnNwby5zcE9iamVjdC5pZCwgYXBwLlNDT1BFLnNwby5zcE9iamVjdC5zZXEsIHN1YlByb2Nlc3NDb25maWdPYmplY3QsIHN0ZXBPYmplY3QsIF9XRkluc3RhbmNlLCB7fSwgYXBwLlNDT1BFLnByb2Nlc3NVVUlEKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgYWxsIHByZS1yZXF1aXNpdGVzIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuXG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZC5wdXNoKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICBsb29wLm5leHQoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGVkLnB1c2goZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBsb29wLmJyZWFrKCk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbXBsZXRlZC5ldmVyeShCb29sZWFuKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUHJlV29yay1hY3Rpb25zIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywge30pO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGUHJlQWN0aW9uc0Vycm9yJywgJ05vdCBhbGwgcHJlLXdvcmstYWN0aW9ucyBwYXNzZWQuJyk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG5cbm1vZHVsZS5leHBvcnRzID0ge1xuXG4gICAgcHJlUmVxdWlzaXRlczogcHJlUmVxdWlzaXRlcyxcbiAgICBwcmVBY3Rpb25zOiBwcmVBY3Rpb25zLFxuICAgIHBvc3RBY3Rpb25zOiBwb3N0QWN0aW9ucyxcbiAgICBwcmVXb3JrQWN0aW9uczogcHJlV29ya0FjdGlvbnMsXG4gICAgc3ViUHJvY2Vzczogc3ViUHJvY2VzcyxcbiAgICBpbmRpY2F0b3JEb2NzOiBpbmRpY2F0b3JEb2NzLFxuICAgIHRhc2s6IHRhc2ssXG4gICAgdHJhbnNpdGlvbjogdHJhbnNpdGlvbixcbiAgICBhc3NpZ25Vc2VyOiBhc3NpZ25Vc2VyXG5cbn0iLCIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogVXRpbGl0eSBNb2R1bGVcbiAqXG4gKiBAbW9kdWxlIGxpYi91dGlsXG4gKlxuICogQGF1dGhvciBCcmVudCBHb3Jkb25cbiAqIEB2ZXJzaW9uIDAuMS4wXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBXb3JrZmxvdyB1dGlsaXR5IG1vZHVsZSB1c2VkIHRvIGZvcm1hdCB0aGUgcmV0dXJuIGFuZCBlcnJvciBvYmplY3RzLCBhbmRcbiAqIGNvbnRhaW5zIHNvbWUgb3RoZXIgdXRpbGl0eSBmdW5jdGlvbnMgc3VjaCBhcyBhIHN5bmMgbG9vcCBhbmQgY29tcGFyZS5cbiAqXG4gKi9cblxuLyoqXG4gKiBTdWNjZXNzIGJsb2NrIHJldHVybiBvYmplY3QsIGNvbnRhaW5zIGEgbWVzc2FnZSBhbmQgb3B0aW9uYWwgZGF0YSBvYmplY3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2UgLSB0aGUgc3VjY2VzcyBtZXNzYWdlXG4gKiBAcGFyYW0ge3N0cmluZ3xPYmplY3R9IFtkYXRhXSAtIHRoZSBzdWNjZXNzIHJldHVybmVkIGRhdGFcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gUmV0dXJuIHN1Y2Nlc3Mgd2l0aG91dCBhIGRhdGEgYmxvY2tcbiAqIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdWNjZXNzIG1lc3NhZ2UgZ29lcyBoZXJlLi4uJyk7XG4gKlxuICogQHJldHVybiB7T2JqZWN0fSAtIHdpdGggbWVzc2FnZSBhbmQgZGF0YSBwcm9wZXJ0aWVzXG4gKlxuICovXG5mdW5jdGlvbiBzdWNjZXNzKG1lc3NhZ2UsIGRhdGEpe1xuXHRyZXR1cm4ge1xuXHRcdG1lc3NhZ2U6IG1lc3NhZ2UsXG5cdFx0ZGF0YTogZGF0YVxuXHR9O1xufTtcblxuLyoqXG4gKiBXYXJuaW5nIGJsb2NrIHJldHVybiBvYmplY3QsIGNvbnRhaW5zIGEgbWVzc2FnZSBhbmQgb3B0aW9uYWwgZGF0YSBvYmplY3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2UgLSB0aGUgd2FybmluZyBtZXNzYWdlXG4gKiBAcGFyYW0ge3N0cmluZ3xPYmplY3R9IFtkYXRhXSAtIHRoZSByZXR1cm5lZCBkYXRhXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIFJldHVybiBzdWNjZXNzIHdpdGhvdXQgYSBkYXRhIGJsb2NrXG4gKiB2YXIgc3VjY2VzcyA9IHV0aWwud2FybignV2FybmluZyBtZXNzYWdlIGdvZXMgaGVyZS4uLicpO1xuICpcbiAqIEByZXR1cm4ge09iamVjdH0gd2l0aCBtZXNzYWdlIGFuZCBkYXRhIHByb3BlcnRpZXMsIGFuZCBsb2dzIHRoZSB3YXJuaW5nIHRvIHRoZSBjb25zb2xlLlxuICpcbiAqL1xuZnVuY3Rpb24gd2FybihtZXNzYWdlLCBkYXRhKXtcblx0Y29uc29sZS53YXJuKGRhdGEpO1xuXHRyZXR1cm4ge1xuXHRcdHdhcm5pbmc6IG1lc3NhZ2UsXG5cdFx0ZGF0YTogZGF0YVxuXHR9O1xufTtcblxuLyoqXG4gKiBFcnJvciBibG9jayBKUyBlcnJvciBvYmplY3QsIGNvbnRhaW5zIGEgY29kZSBhbmQgbWVzc2FnZSBmb3IgdGhlIGVycm9yLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBjb2RlIC0gdGhlIGVycm9yIGNvZGVcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlIC0gdGhlIGVycm9yIG1lc3NhZ2VcbiAqXG4gKiBAZXhhbXBsZVxuICogdmFyIHN1Y2Nlc3MgPSB1dGlsLmVycm9yKCdFcnJvcjAwMScsJ0Vycm9yIG1lc3NhZ2UgZ29lcyBoZXJlLi4uJyk7XG4gKlxuICogQHJldHVybiB7T2JqZWN0fSB3aXRoIGEgY29kZSBhbmQgbWVzc2FnZSBwcm9wZXJ0aWVzLlxuICpcbiAqL1xuZnVuY3Rpb24gZXJyb3IoY29kZSwgbWVzc2FnZSl7XG5cdHZhciBlcnIgPSBuZXcgRXJyb3IoJycpO1xuXHRlcnIubmFtZSA9IGNvZGU7XG5cdGVyci5tZXNzYWdlID0gbWVzc2FnZTtcblx0cmV0dXJuIGVycjtcbn07XG5cbi8qKlxuICogQSBsb29wIHdoaWNoIGNhbiBsb29wIFggYW1vdW50IG9mIHRpbWVzLCB3aGljaCBjYXJyaWVzIG91dFxuICogYXN5bmNocm9ub3VzIGNvZGUsIGJ1dCB3YWl0cyBmb3IgdGhhdCBjb2RlIHRvIGNvbXBsZXRlIGJlZm9yZSBsb29waW5nLlxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSBpdGVyYXRpb25zIC0gdGhlIG51bWJlciBvZiBpdGVyYXRpb25zIHRvIGNhcnJ5IG91dFxuICogQHBhcmFtIHtmdW5jdGlvbn0gcHJvY2VzcyAtIHRoZSBjb2RlL2Z1bmN0aW9uIHdlJ3JlIHJ1bm5pbmcgZm9yIGV2ZXJ5XG4gKiBpdGVyYXRpb25cbiAqIEBwYXJhbSB7ZnVuY3Rpb259IGV4aXQgLSBhbiBvcHRpb25hbCBjYWxsYmFjayB0byBjYXJyeSBvdXQgb25jZSB0aGUgbG9vcFxuICogaGFzIGNvbXBsZXRlZFxuICpcbiAqIEBleGFtcGxlXG4gKiB1dGlsLnN5bmNMb29wKDUsIGZ1bmN0aW9uKGxvb3Ape1xuICogXHR2YXIgY291bnRlciA9IGxvb3AuaXRlcmF0aW9uKCk7XG4gKiBcdC8vIEFkZCBhc3luYyBjYWxscyBoZXJlLi5cbiAqXG4gKiB9LCBmdW5jdGlvbigpe1xuICogXHQvLyBPbiBjb21wbGV0ZSBwZXJmb3JtIGFjdGlvbnMgaGVyZS4uLlxuICpcbiAqIH0pO1xuICpcbiAqIEByZXR1cm4ge09iamVjdH0gdGhlIGxvb3AgY29udHJvbCBvYmplY3QuXG4gKlxuICovXG5mdW5jdGlvbiBzeW5jTG9vcChpdGVyYXRpb25zLCBwcm9jZXNzLCBleGl0KXtcbiAgICB2YXIgaW5kZXggPSAwLFxuICAgICAgICBkb25lID0gZmFsc2UsXG4gICAgICAgIHNob3VsZEV4aXQgPSBmYWxzZTtcbiAgICB2YXIgbG9vcCA9IHtcbiAgICAgICAgbmV4dDpmdW5jdGlvbigpe1xuICAgICAgICAgICAgaWYoZG9uZSl7XG4gICAgICAgICAgICAgICAgaWYoc2hvdWxkRXhpdCAmJiBleGl0KXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGV4aXQoKTsgLy8gRXhpdCBpZiB3ZSdyZSBkb25lXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gSWYgd2UncmUgbm90IGZpbmlzaGVkXG4gICAgICAgICAgICBpZihpbmRleCA8IGl0ZXJhdGlvbnMpe1xuICAgICAgICAgICAgICAgIGluZGV4Kys7IC8vIEluY3JlbWVudCBvdXIgaW5kZXhcbiAgICAgICAgICAgICAgICBwcm9jZXNzKGxvb3ApOyAvLyBSdW4gb3VyIHByb2Nlc3MsIHBhc3MgaW4gdGhlIGxvb3BcbiAgICAgICAgICAgIC8vIE90aGVyd2lzZSB3ZSdyZSBkb25lXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRvbmUgPSB0cnVlOyAvLyBNYWtlIHN1cmUgd2Ugc2F5IHdlJ3JlIGRvbmVcbiAgICAgICAgICAgICAgICBpZihleGl0KSBleGl0KCk7IC8vIENhbGwgdGhlIGNhbGxiYWNrIG9uIGV4aXRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgaXRlcmF0aW9uOmZ1bmN0aW9uKCl7XG4gICAgICAgICAgICByZXR1cm4gaW5kZXggLSAxOyAvLyBSZXR1cm4gdGhlIGxvb3AgbnVtYmVyIHdlJ3JlIG9uXG4gICAgICAgIH0sXG4gICAgICAgIGJyZWFrOmZ1bmN0aW9uKGVuZCl7XG4gICAgICAgICAgICBkb25lID0gdHJ1ZTsgLy8gRW5kIHRoZSBsb29wXG4gICAgICAgICAgICBzaG91bGRFeGl0ID0gZW5kOyAvLyBQYXNzaW5nIGVuZCBhcyB0cnVlIG1lYW5zIHdlIHN0aWxsIGNhbGwgdGhlIGV4aXQgY2FsbGJhY2tcbiAgICAgICAgfVxuICAgIH07XG4gICAgbG9vcC5uZXh0KCk7XG4gICAgcmV0dXJuIGxvb3A7XG59O1xuXG5mdW5jdGlvbiBjb21wYXJlKHN1YmplY3QsIG9wZXJhdG9yLCB2YWx1ZSkge1xuICBcdHN3aXRjaCAob3BlcmF0b3IpIHtcbiAgXHRcdGNhc2UgJ2dyZWF0ZXJUaGFuJzpcblx0XHRcdHJldHVybiBzdWJqZWN0ID4gdmFsdWU7XG5cdFx0Y2FzZSAnbGVzc1RoYW4nOlxuXHRcdFx0cmV0dXJuIHN1YmplY3QgPCB2YWx1ZTtcblx0XHRjYXNlICdncmVhdGVyVGhhbkVxdWFsJzpcblx0XHRcdHJldHVybiBzdWJqZWN0ID49IHZhbHVlO1xuXHRcdGNhc2UgJ2xlc3NUaGFuRXF1YWwnOlxuXHRcdFx0cmV0dXJuIHN1YmplY3QgPD0gdmFsdWU7XG5cdFx0Y2FzZSAnZXF1YWxUbyc6XG5cdFx0XHRyZXR1cm4gc3ViamVjdCA9PT0gdmFsdWU7XG5cdFx0Y2FzZSAnbm90RXF1YWxUbyc6XG5cdFx0XHRyZXR1cm4gc3ViamVjdCAhPT0gdmFsdWU7XG4gIFx0fVxufTtcblxuZnVuY3Rpb24gZ2V0TmFtZShhcnIsIGxhbmcpe1xuXHRpZiAoYXJyICE9PSB1bmRlZmluZWQpIHtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGggOyBpKyspIHtcblx0XHRcdGlmIChhcnJbaV0uaTE4bi5fbGFuZyA9PT0gbGFuZykge1xuXHRcdFx0XHRyZXR1cm4gYXJyW2ldLmkxOG4udmFsdWU7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuXG4gXHRzdWNjZXNzOiBzdWNjZXNzLFxuIFx0d2Fybjogd2FybixcbiBcdGVycm9yOiBlcnJvcixcbiBcdHN5bmNMb29wOiBzeW5jTG9vcCxcbiBcdGNvbXBhcmU6IGNvbXBhcmUsXG5cdGdldE5hbWU6IGdldE5hbWVcblxuIH1cbiJdfQ==
