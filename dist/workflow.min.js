(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Workflow = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";function Workflow(e,s,t,o){var r=this;if(""==s||void 0==s)throw util.error("ParamRequired","A community id is required.");if("string"!=typeof s)throw new Error("The community id must be a javascript string.");if(r.communityId=s||"",""==e||void 0==e)throw util.error("ParamRequired","A profile id is required.");if("string"!=typeof e)throw new Error("The profile id must be a javascript string.");if(r.profile=e||"",""==t||void 0==t)throw util.error("ParamRequired","An app id is required.");if("string"!=typeof t)throw new Error("The app id must be a javascript string.");if(r.app=t||"",""==o||void 0==o)throw util.error("ParamRequired","A workflow configuration is required.");r.config="object"!=typeof o?JSON.parse(o):o,r.instance,r.subprocesses=[],r.indicators=[]}var Process=require("./lib/process"),util=require("utility"),userInterface=require("./lib/interface"),helper=require("./lib/helper");Workflow.prototype.getProfile=function(){return this.profile},Workflow.prototype.getApp=function(){return this.app},Workflow.prototype.getConfig=function(){return this.config},Workflow.prototype.getInstance=function(){return this.instance},Workflow.prototype.setInstance=function(e){this.instance=e},Workflow.prototype.getSubProcesses=function(){return this.subprocesses},Workflow.prototype.setSubProcesses=function(e){this.subprocesses=e},Workflow.prototype.getIndicators=function(){return this.indicators},Workflow.prototype.setIndicators=function(e){this.indicators=e},Workflow.prototype.create=function(){var e=this;return new Promise(function(s,t){try{if(void 0!==e.instance){s(util.warn("Instance already exists.",e))}else{var o={_id:"",version:"",type:"workflowInstance",processes:[],channels:["community_"+app.SCOPE.getCommunityId(),"profile_"+app.SCOPE.profileId,"application_"+app.SCOPE.applicationId,"community_"+app.SCOPE.getCommunityId()+"_application_"+app.SCOPE.applicationId]};o._id="_local/"+e.profile+":processes",o.version=e.config.version,e.instance=o;s(util.success("Workflow processes instance created successfully.",e))}}catch(e){t(e)}})},Workflow.prototype.initialise=function(e,s,t){var o=this;return new Promise(function(r,i){try{var n=[];if(""!==e&&void 0!==e){if(n=o.config.processes.filter(function(s){if(s._id==e)return s}),void 0==n[0]._id){var c=util.error("WFConfigError","No valid process definition found with process id: "+e);i(c)}}else n.push(o.config.processes[0]),e=o.config.processes[0]._id;var a=function(e){for(var s="",t=0;t<e.length-1;t++)s=s+"'"+e[t]+"',";return"("+s+"'"+e[e.length-1]+"')"},u=n[0].subProcesses[0]._id,p=n[0].subProcesses[0].instanceType,f=JSON.xpath("indicators/_id",n[0].subProcesses[0],{});if(function(e){var s=JSON.xpath("/indicators[setId = "+a(e)+" and cardinality eq 'single' ]/setId",app.SCOPE.APP_CONFIG,{});if(s.length>0){var t=JSON.xpath("/processes/subProcesses[indicators/_id = "+a(s)+"]/_id",o.config,{}),r=JSON.xpath("count(/instance/processes/subProcesses[id = "+a(t)+" and complete = false()])",o,{})[0];return 0==r}if(void 0!=p.newSequence){var r=JSON.xpath("count(/instance/processes/subProcesses[id eq '"+u+"' and complete eq 'false'])",o,{})[0];return 0==r}return p.newInstance,!0}(f)){var d=[];o.instance.processes.filter(function(s){s.id==e&&d.push(s)});var l=d.length+1,h={id:"",seq:"",subProcesses:[]};h.id=e,h.seq=l,o.instance.processes.push(h);var v=n[0].subProcesses[0]._id,m=1;o.instance.processes.filter(function(s){s.id==e&&s.seq==l&&(m=s.subProcesses.length+1)});var P=generateUUID();void 0!=s.subprocessUUID&&s.subprocessUUID.length>0&&(P=s.subprocessUUID);var b={communityId:app.SCOPE.communityId,uuid:P,userId:_lclx.SUBSCRIPTIONS.userId,transactionType:"subProcess",documents:[{document:P,rev:"0"}]};dao.startTransaction(b).then(function(n){Process.subProcess(P,e,l,v,m,t,s,o).then(function(s){var n=s.data._id,c=s.data.groupKey;void 0==t&&(t="");var a={id:v,subprofileId:t,seq:s.data["meta-data"].subProcessInsSeq,uuid:n,groupKey:c,label:s.data.label};h.subProcesses.push(a);for(var u=0;u<o.instance.processes.length;u++){var p=o.instance.processes[u];p.id==e&&p.seq==l&&o.instance.processes.splice(u,1,h)}var f=s.data.indicators,d=s.data.step;Process.indicatorDocs(e,f,d,o,n).then(function(e){var s=util.success("Process: "+o.config.processes[0]._id+" initialized successfully.",a);r(s)},function(e){i(e)})},function(s){o.instance.processes=o.instance.processes.filter(function(s){return!(s.id==e&&s.seq==l)}),console.log(s),i(s)})}).catch(function(e){console.log(e),i(void 0!=e.responseJSON&&void 0!=e.responseJSON.message?e.responseJSON.message:void 0!=e.responseText?e.responseText:e)})}else i("Cannot create workflow as other process using same SDO is not complete")}catch(e){i(e)}})},Workflow.prototype.transition=function(e,s,t,o,r,i,n,c){var a=this;return new Promise(function(o,u){try{var p=JSON.xpath("/subprocesses[_id eq '"+c+"']/step",app.SCOPE.workflow,{})[0],f=JSON.xpath("/processes[_id eq '"+e+"']/subProcesses[_id eq '"+t+"']/steps[_id eq '"+r+"']",a.config,{})[0],d=JSON.xpath("/subprocesses[_id eq '"+c+"']/meta-data/subProcessInsSeq",app.SCOPE.workflow,{})[0],l=function(r,i){a.instance.processes.filter(function(n){n.id==e&&n.seq==s&&n.subProcesses.filter(function(e){e.id==t&&a.subprocesses.filter(function(e){if(e._id==c)if("step"==r){e.step=i.data.step;var s=util.success(i.message,e);o(s)}else if("stepComplete"==r){e.step=i.data.step,e.complete=!0;var t=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+e._id+"']",app.SCOPE.workflow,{})[0];t.complete=!0;var s=util.success(i.message,e.step);o(s)}})})})},h={};void 0!=f.function.task&&void 0!=f.function.task.postActions?(h=f.function.task.postActions,Process.postActions(h,a,c).then(function(o){Process.transition(e,s,t,d,r,i,n,a,c,p).then(function(e){e.data.subProcessComplete?l("stepComplete",e):l("step",e)},function(e){u(e)})},function(e){u(e)})):void 0!=f.function.server&&void 0!=f.function.server.postActions?(h=f.function.server.postActions,Process.postActions(h,a,c).then(function(o){Process.transition(e,s,t,d,r,i,n,a,c,p).then(function(e){e.data.subProcessComplete?l("stepComplete",e):l("step",e)},function(e){u(e)})},function(e){u(e)})):Process.transition(e,s,t,d,r,i,n,a,c,p).then(function(e){e.data.subProcessComplete?l("stepComplete",e):l("step",e)},function(e){u(e)})}catch(e){u(e)}})},Workflow.prototype.assignUser=function(e,s,t,o,r,i){var n=this;return new Promise(function(c,a){try{var u=JSON.xpath("/subprocesses[_id eq '"+i+"']",app.SCOPE.workflow,{})[0],p=u._rev;app.SCOPE.communityId,_lclx.SUBSCRIPTIONS.userId;Process.assignUser(e,s,t,o,r,i,n).then(function(e){c(e)},function(e){a(e)})}catch(e){a(e)}})},Workflow.prototype.ui=function(){var e=this;return{getProcess:function(s,t){return new Promise(function(o,r){try{userInterface.getProcess(s,t,e).then(function(e){o(e)},function(e){r(e)})}catch(e){r(e)}})}}},Workflow.prototype.getNodeValue=function(e,s){var t=this;return new Promise(function(o,r){try{helper.getNodeValue(e,t,s).then(function(e){o(e)},function(e){r(e)})}catch(e){r(e)}})},Workflow.prototype.takeAssignment=function(e){var s=this;return new Promise(function(t,o){try{var r=JSON.xpath("/subprocesses[_id eq '"+e+"']",s,{})[0],i=JSON.xpath("/step/assignedTo",r,{})[0];void 0==r.step.assignmentHistory&&(r.step.assignmentHistory=[]),""!=i.userId&&""!=i.name&&r.step.assignmentHistory.push(JSON.parse(JSON.stringify(i))),i.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,i.userId=_lclx.SUBSCRIPTIONS.userId+"",i.dateTime=moment().format(),i.type=ASSIGNMENT_TYPE_ACCEPTANCE,i.dueDateTime="",i.by=_lclx.SUBSCRIPTIONS.userId+"";var n=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+e+"']/id",s,{})[0],c=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+e+"']/id",s,{})[0],a=JSON.xpath("/subprocesses[_id eq '"+e+"']/step/id",s,{})[0],u=JSON.xpath("/processes[_id eq '"+n+"']/subProcesses[_id eq '"+c+"']/steps[_id eq '"+a+"']",s.config,{})[0];if(void 0!=u.function.task.preWorkActions){var p=u.function.task.preWorkActions;Process.preWorkActions(p,s).then(function(e){t(s)},function(e){o(e)})}else t(s)}catch(e){o(e)}})},Workflow.prototype.condition=function(e,s){var t=this;return new Promise(function(o,r){try{var i=e.operator,n=e.value.data;if(void 0!=e.subject.indicator){var c=e.subject.indicator.setId,a=e.subject.indicator.modelScope,u=e.subject.indicator.elementPath;if("subProcess"==e.subject.indicator.context){for(var p=JSON.xpath("/subprocesses[_id eq '"+s+"']/indicators[id eq '"+c+"']/instances[1]/uuid",t,{})[0],f=JSON.xpath("/indicators[_id eq '"+p+"']",t,{})[0],d=f.model[a].data[c],l=d,h=""==u?[]:u.split(/['"\[\].]+/),v=0;v<h.length;v++)""!=h[v]&&(l=l[h[v]]);var m=l;helper.getNodeValue(n,t,s).then(function(e){var s=helper.compare(m,i,e);o(s)},function(e){r(e)})}else if("subProfile"==e.subject.indicator.context){for(var f=JSON.xpath("/indicators[category/term eq '"+c+"']",t,{})[0],d=f.model[a].data[c],l=d,h=""==u?[]:u.split(/['"\[\].]+/),v=0;v<h.length;v++)""!=h[v]&&(l=l[h[v]]);var m=l;helper.getNodeValue(n,t,s).then(function(e){var s=helper.compare(m,i,e);o(s)},function(e){r(e)})}else r("Not implemented")}else if(void 0!=e.subject.indicatorWrapper)r("Not implemented");else if(void 0!=e.subject.variable)helper.getNodeValue(n,t,s).then(function(n){helper.getNodeValue(e.subject,t,s).then(function(e){var s=helper.compare(e,i,n);o(s)},function(e){r(e)})},function(e){r(e)});else if(void 0!=e.subject.subProcess){for(var u=e.subject.subProcess.elementPath,P=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],l=P,h=""==u?[]:u.split(/['"\[\].]+/),v=0;v<h.length;v++)""!=h[v]&&(l=l[h[v]]);var m=l;helper.getNodeValue(n,t,s).then(function(e){var s=helper.compare(m,i,e);o(s)},function(e){r(e)})}}catch(e){r(e)}})},module.exports=Workflow;

},{"./lib/helper":4,"./lib/interface":5,"./lib/process":7,"utility":8}],2:[function(require,module,exports){
"use strict";var util=require("utility"),nodeValue=require("./nodeValue"),form=require("./form"),helper=require("./helper"),gatekeeper=new GK,community=function(){return{createCommunity:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=_lclx.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/indicators[category/term eq 'Community']/_id",t,{})[0],r={createCommunity:{newCommunityId:t.profile,indicatorUUID:{Community:s}}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processed successfully.",o);e(n)},function(e){o(e)})})},userJoinCommunity:function(e,i,t){return new Promise(function(e,i){})},releaseAdoptedApplication:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=_lclx.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'adoptedApplication']/instances[1]/uuid",t,{})[0],r={releaseAdoptedApplication:{communityId:t.profile,indicatorUUID:{adoptedApplication:s}}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})}}}(),application=function(){return{createAppDefinition:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=_lclx.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/indicators[category/term eq 'Application']/_id",t,{})[0],r={createApplication:{newApplicationId:t.profile,indicatorUUID:{Application:s}}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})},buildApplication:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=_lclx.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'PublishApplication']/instances[1]/uuid",t,{})[0],r=JSON.xpath("/indicators[category/term eq 'ApplicationDefinition']/_id",t,{})[0],c=JSON.xpath("/indicators[category/term eq 'Roles']/_id",t,{})[0],p=JSON.xpath("/indicators[category/term eq 'Application']/_id",t,{})[0],d=JSON.xpath("/indicators[category/term eq 'AppPermissions']/_id",t,{})[0],u={buildApplication:{applicationId:t.profile,indicatorUUID:{PublishApplication:s,ApplicationDefinition:r,Roles:c,Application:p,AppPermissions:d}}};a.action=u,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})},applicationAdoption:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=_lclx.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'Adoption']/instances[1]/uuid",t,{})[0],r=JSON.xpath("/indicators[category/term eq 'PublishApplication']/_id",t,{})[0],c=JSON.xpath("/indicators[category/term eq 'Application']/_id",t,{})[0],p={adoptApplication:{applicationId:t.profile,indicatorUUID:{Adoption:s,PublishApplication:r,Application:c}}};a.action=p,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})},createTaxonomy:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=_lclx.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'Taxonomy']/instances[1]/uuid",t,{})[0],r={createTaxonomy:{taxonomyUUID:s}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})}}}(),performance=function(){return{unlockPeriod:function(e,i,t){return new Promise(function(e,o){var a=JSON.xpath("/subprocesses[_id eq '"+i+"']",t,{})[0],n=JSON.xpath("/indicators[id eq '"+PERIOD_SET_ID+"' or id eq '"+AUDIT_PERIOD_SET_ID+"']/instances/uuid",a,{})[0],s=a.dates.valid;library.unlockPeriod(n,s,i).then(function(i){var t=util.success("Unlock period.",i);e(t)},function(e){o(e)})})},setModelStatus:function(e,i,t){return new Promise(function(o,a){var n=JSON.xpath("/subprocesses[_id eq '"+i+"']",t,{})[0],s=JSON.xpath("/indicators[id eq '"+PERIOD_SET_ID+"' or id eq '"+AUDIT_PERIOD_SET_ID+"']/instances/uuid",n,{})[0],r=n.dates.valid,c=JSON.xpath("/label",e,{})[0],p=helper.getLanguageMessage(c);library.setPeriodStatus(s,r,p,i).then(function(e){var i=util.success("setModelStatus",e);o(i)},function(e){a(e)})})},lockPerformanceModel:function(e,i,t){return new Promise(function(e,o){var a=JSON.xpath("/subprocesses[_id eq '"+i+"']",t,{})[0],n=JSON.xpath("/indicators[id eq '"+PERFORMANCE_SET_ID+"']/instances/uuid",a,{})[0],s=a.dates.valid;library.lockPerformanceModel(n,s,i).then(function(i){var t=util.success("Lock performance model.",i);e(t)},function(e){o(e)})})}}}(),sdo=function(){return{create:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=_lclx.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'SDO']/instances[1]/uuid",t,{})[0],r={createSDO:{sdoUUID:s}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})}}}(),taxonomy=function(){return{create:function(e,i,t){return new Promise(function(e,o){var a=worker.getWorkerWrapper(),n="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(n=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=_lclx.SUBSCRIPTIONS.userId,a.profileId=t.profile,a.subProcessUUID=i,a.subprofileId=n,a.channels.push("follow"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'Taxonomy']/instances[1]/uuid",t,{})[0],r={createTaxonomy:{taxonomyUUID:s}};a.action=r,worker.send(a).then(function(o){worker.setWorkerInfoInSubprocess(a,t,i);var n=util.success("Worker processes successfully.",o);e(n)},function(e){o(e)})})}}}(),subProcessInstance=function(){return{setTitle:function(e,i,t,o){return new Promise(function(e,a){var n=JSON.xpath("/subprocesses[_id eq '"+i+"']",app.SCOPE.workflow,{})[0],s=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+i+"']",app.SCOPE.workflow,{})[0];void 0!=s&&(s.label=t),n.label=t;var r=[],c={};c.model=o.subprocesses,r.push(c),e(util.success("Subprocess setTitle success.",o.subprocesses))})},setValidDate:function(e,i,t,o){return new Promise(function(e,a){var n=JSON.xpath("/subprocesses[_id eq '"+i+"']",app.SCOPE.workflow,{})[0];n.dates.valid=t;var s=[],r={};r.model=n,s.push(r),e(util.success("valid date set.",o.subprocesses))})},setSPStatus:function(e,i,t,o){return new Promise(function(e,a){JSON.xpath("/subprocesses[_id eq '"+i+"']",app.SCOPE.workflow,{})[0].spStatus=t;var n=[],s={};s.model=o.subprocesses,n.push(s),e(util.success("Subprocess spStatus success.",o.subprocesses))})}}}(),variables=function(){return{setVariable:function(e,i,t){return new Promise(function(o,a){helper.getNodeValue(e.data,i,t).then(function(n){var s=e.scope,r=e.name,c=e.variableType,p=JSON.xpath("/subprocesses[_id eq '"+t+"']/dates/valid",i,{})[0];switch(s){case"profile":var d=i.profile,u=d+":variables",l=app.SCOPE.txn;dao.get(u).then(function(e){for(var s={},d=function(){if("periodic"==c){var d=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+t+"']/id]/type",i,{})[0],u=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id])",i,{})[0]+1;if(d==PROCESS_TYPE_SUBPROFILE){var l=library.getSubprofileSubprocessIds();u=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+l+"])",i,{})[0]+1}var f={subProcessUUID:t,user:{userName:_lclx.SUBSCRIPTIONS.username,userId:_lclx.SUBSCRIPTIONS.userProfileId},seq:u,validDate:p,value:n};if(void 0!=e[r]){for(var m=e,I=""==r?[]:r.split(/['"\[\].]+/),g=0;g<I.length;g++)""!=I[g]&&(m=m[I[g]]);m.push(f)}else e[r]=[f]}else e[r]=n;dao.save(e).then(function(e){s.rev=e.rev,o("Variable set successfully")}).catch(function(e){a("Failed to set Variable")})},f=!1,m=0;m<l.documents.length;m++)u==l.documents[m].document&&(s=l.documents[m],f=!0);f?d():(l=JSON.parse(JSON.stringify(app.SCOPE.txn)),l.documents=[],s={document:u,rev:void 0==e._rev?"0":e._rev},l.documents.push(s),app.SCOPE.txn.documents.push(s),dao.updateTransaction(l).then(function(e){d()}).catch(function(e){console.log(e),a(void 0!=e.responseJSON&&void 0!=e.responseJSON.message?e.responseJSON.message:void 0!=e.responseText?e.responseText:e)}))}).catch(function(e){var s={_id:u};if(s.channels=app.profile.channels,"periodic"==c){var d=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+t+"']/id]/type",i,{})[0],l=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id])",i,{})[0]+1;if(d==PROCESS_TYPE_SUBPROFILE){var f=library.getSubprofileSubprocessIds();l=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+f+"])",i,{})[0]+1}s[r]=[{subProcessUUID:t,user:{userName:_lclx.SUBSCRIPTIONS.username,userId:_lclx.SUBSCRIPTIONS.userProfileId},seq:l,validDate:p,value:n}]}else s[r]=n;var m=JSON.parse(JSON.stringify(app.SCOPE.txn));m.documents=[];var I={document:u,rev:void 0==s._rev?"0":s._rev};m.documents.push(I),app.SCOPE.txn.documents.push(I),dao.updateTransaction(m).then(function(e){dao.save(s).then(function(e){I.rev=e.rev,o("Variable set successfully")}).catch(function(e){a("Failed to set Variable")})}).catch(function(e){console.log(e),a(void 0!=e.responseJSON&&void 0!=e.responseJSON.message?e.responseJSON.message:void 0!=e.responseText?e.responseText:e)})});break;case"subProcessInstance":case"step":o("not implemented");break;case"subProfileSubProcessInstance":var f=app.profile.subprofileId,m=f+":variables",l=app.SCOPE.txn;dao.get(m).then(function(e){for(var s={},d=function(){if("periodic"==c){var d=library.getSubprofileSubprocessIds(),u=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+d+"])",i,{})[0]+1,l={subProcessUUID:t,user:{userName:_lclx.SUBSCRIPTIONS.username,userId:_lclx.SUBSCRIPTIONS.userProfileId},seq:u,validDate:p,value:n};if(void 0!=e[r]){for(var f=e,m=""==r?[]:r.split(/['"\[\].]+/),I=0;I<m.length;I++)""!=m[I]&&(f=f[m[I]]);f.push(l)}else e[r]=[l]}else e[r]=n;dao.save(e).then(function(e){s.rev=e.rev,o("Variable at subprofile set successfully")}).catch(function(e){a("Failed to set Variable at subprofile")})},u=!1,f=0;f<l.documents.length;f++)m==l.documents[f].document&&(s=l.documents[f],u=!0);u?d():(l=JSON.parse(JSON.stringify(app.SCOPE.txn)),l.documents=[],s={document:m,rev:void 0==e._rev?"0":e._rev},l.documents.push(s),app.SCOPE.txn.documents.push(s),dao.updateTransaction(l).then(function(e){d()}).catch(function(e){console.log(e),a(void 0!=e.responseJSON&&void 0!=e.responseJSON.message?e.responseJSON.message:void 0!=e.responseText?e.responseText:e)}))}).catch(function(e){var s={_id:m};if(s.channels=app.profile.channels,"periodic"==c){var d=library.getSubprofileSubprocessIds(),u=JSON.xpath("count(/subprocesses[_id eq '"+t+"']/preceding-sibling::node()[id = /subprocesses[_id eq '"+t+"']/id and _id = /subprocesses[_id = "+d+"]/_id])",i,{})[0]+1;s[r]=[{subProcessUUID:t,user:{userName:_lclx.SUBSCRIPTIONS.username,userId:_lclx.SUBSCRIPTIONS.userProfileId},seq:u,validDate:p,value:n}]}else s[r]=n;var l=JSON.parse(JSON.stringify(app.SCOPE.txn));l.documents=[];var f={document:m,rev:void 0==s._rev?"0":s._rev};l.documents.push(f),app.SCOPE.txn.documents.push(f),dao.updateTransaction(l).then(function(e){dao.save(s).then(function(e){f.rev=e.rev,o("Variable at subprofile set successfully")}).catch(function(e){a("Failed to set Variable at subprofile")})}).catch(function(e){console.log(e),a(void 0!=e.responseJSON&&void 0!=e.responseJSON.message?e.responseJSON.message:void 0!=e.responseText?e.responseText:e)})})}},function(e){a("getNodeValue value not found.")})})}}}(),notification=function(){return{sendNotificationWorker:function(e,i,t){return new Promise(function(o,a){var n=function(e){return new Promise(function(o,a){var n={};if(void 0!=e.recipients.role)n.role=e.recipients.role,o(n);else if(void 0!=e.recipients.profileRole)n.profileRole={},n.profileRole.role=e.recipients.profileRole.role,n.profileRole.profile=e.recipients.profileRole.profile,o(n);else if(void 0!=e.recipients.subProfileRole)n.subProfileRole={},n.subProfileRole.role=e.recipients.subProfileRole.role,n.subProfileRole.subProfileCategory=e.recipients.subProfileRole.subProfileCategory,n.subProfileRole.profile=e.recipients.subProfileRole.profile,o(n);else if(void 0!=e.recipients.function)n.function={},n.function.users={},helper.getNodeValue(e.recipients.function.users,i,t).then(function(e){n.function.users=e,o(n)},function(e){rej(e)});else if(void 0!=e.recipients.stepAssignee)n.stepAssignee={},n.stepAssignee.role=e.recipients.stepAssignee.role,o(n);else if(void 0!=e.recipients.stepAssigneeFromStep){n.stepAssigneeFromStep={};var s=e.recipients.stepAssigneeFromStep.stepId;n.stepAssigneeFromStep.stepId=s;for(var r=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],c={},p=0;p<r.history.length;p++)r.history[p].id==s&&(c=r.history[p]);if(void 0!=c.assignmentHistory&&c.assignmentHistory.length>0){var d=c.assignmentHistory[c.assignmentHistory.length-1];n.stepAssigneeFromStep.userId=d.userId}o(n)}else if(void 0!=e.recipients.indicator){n.indicator={};var u=e.recipients.indicator.indicatorSetId,l=e.recipients.indicator.elementId,f=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+u+"']/instances/uuid",i,{})[0],m=JSON.xpath("/indicators[_id eq '"+f+"']",i,{})[0],I="/model/pending/data/"+u+"/"+l,g=JSON.xpath(I,m,{})[0];n.indicator.userId=g,o(n)}})},s=function(s,r){l.notification.keys.subProcess.name=s.label,l.notification.keys.subProcess.id=t,l.notification.keys.subProcess.validDate=s.dates.valid,l.notification.keys.subProcess.dueDate=s.dates.due;try{var p=s.step;l.notification.keys.step.stepCreatedDateTime=p.dateTimeCreated,l.notification.keys.step.stepId=p.id;var d=JSON.xpath("/processes/subProcesses[_id eq '"+s.id+"']/steps[_id eq '"+p.id+"']",app.SCOPE.workflow.config,{})[0];l.notification.keys.step.stepName=app.getNameByLang(d.name)}catch(e){}var u=JSON.xpath("/indicators[_id eq '"+r+"']/title",app.SCOPE.workflow,{})[0];if(l.notification.keys.node.title=void 0==u?"":u,l.notification.message.default=e.message.default,l.notification.message.title=e.message.title,void 0!=e.message.rtf&&(l.notification.message.rtf={},void 0!=e.message.rtf.template?l.notification.message.rtf.template=e.message.rtf.template:void 0!=e.message.rtf.markup&&(l.notification.message.rtf.markup=e.message.rtf.markup)),l.notification.messageType=e.messageType,l.notification.notificationType=e.notificationType,l.notification.priority=e.priority,void 0!=e.notificationAction&&(l.notification.notificationAction={},l.notification.notificationAction.label=e.notificationAction.label,void 0!=e.notificationAction.action.URI?(l.notification.notificationAction.action={},l.notification.notificationAction.action.URI=e.notificationAction.action.URI):void 0!=e.notificationAction.action.goto&&(l.notification.notificationAction.action={},l.notification.notificationAction.action.goto=e.notificationAction.action.goto)),void 0!=e.schedule){var f=e.schedule.executeCommand,m={dateTime:"",unit:"",factor:""};if(void 0!=f.now)m.dateTime=moment().format();else if(void 0!=f.exact)m.dateTime=f.exact.dateTime;else if(void 0!=f.dueDate){var s=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],I="",g=s.dates.due;I=""!=g?moment(g,"YYYY-MM-DD"):moment().format(),m.dateTime=I,m.factor=f.dueDate.factor,m.unit=f.dueDate.unit}else if(void 0!=f.validDate){var s=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],I="",g=s.dates.valid;I=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),m.dateTime=I,m.factor=f.validDate.factor,m.unit=f.validDate.unit}else if(void 0!=f.stepCreatedDate){var s=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],I="",v=s.step.dueDateTime;I=""!=v?moment(v).format():moment().format(),m.dateTime=I,m.factor=f.stepCreatedDate.factor,m.unit=f.stepCreatedDate.unit}else m.dateTime=moment().format();c.setSchedule(m)}"string"==typeof e?dao.getConfig(e).then(function(s){e=assignmentObject,n(e).then(function(e){l.notification.recipients=e,c.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),c.setAction(l);var a=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];c.setContext({step:{stepDateTime:a.step.dateTimeCreated}}),c.send().then(function(e){console.log(c);var i=util.success("Notification Worker processes successfully.",e);o(i)},function(e){o(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),a(e)})}).catch(function(e){o(e)}):n(e).then(function(e){l.notification.recipients=e,c.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),c.setAction(l);var a=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];c.setContext({step:{stepDateTime:a.step.dateTimeCreated}}),c.send().then(function(e){console.log(c);var i=util.success("Notification Worker processes successfully.",e);o(i)},function(e){o(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),a(e)})},r=function(e,t,o,a){if(e.length==t)s(o,a);else{var n=e[t];if(""!=n.field&&""!=n.repStr&&""!=n.setId){var c="1";app.SCOPE.APP_CONFIG.indicators.forEach(function(e){e.setId==n.setId&&(c=e.version)}),dao.getTaxonomy("Field_Indicator_"+n.setId+":"+c).then(function(s){var c={},p=n.field;s.data.items.item.forEach(function(e){e.code==p&&(c=e)});var d={};i.indicators.forEach(function(e){e.category.term==n.setId&&(d=e)});var u="";if(n.field.indexOf(".")>-1){var f=n.field.split(".")[0],m=n.field.split(".")[1];void 0!=d.model&&void 0!=d.model.pending&&void 0!=d.model.pending.data&&void 0!=d.model.pending.data[n.setId]&&void 0!=d.model.pending.data[n.setId][f]&&void 0!=d.model.pending.data[n.setId][f][m]&&(u=d.model.pending.data[n.setId][f][m])}else void 0!=d.model&&void 0!=d.model.pending&&void 0!=d.model.pending.data&&void 0!=d.model.pending.data[n.setId]&&void 0!=d.model.pending.data[n.setId][n.field]&&(u=d.model.pending.data[n.setId][n.field]);null!=c.datatype&&void 0!=c.datatype&&""!=c.datatype&&"currency"==c.datatype&&(u=g+" "+numberWithCommas(u)),l.notification.keys.userDefined.push({key:"#"+n.repStr+"#",value:u}),r(e,t+1,o,a)}).catch(function(e){console.log("Notification error: Error fetching Field Indicator taxonomy")})}}},c=new NotificatioWorker(app),p=JSON.xpath("/subprocesses[_id eq '"+t+"']/meta-data/subprofileId",i,{})[0],d=DOMAIN.replace("exist/rest",""),u="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(u=app.profile.subprofileId);var l={notification:{message:{},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:t,subProfileId:p},notificationType:"",subprofileId:u,priority:"",recipients:{},url:d,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:"",validDate:"",dueDate:""},notification:{createdDateTime:moment().format()},step:{stepCreatedDateTime:"",stepName:"",stepId:""},node:{title:""},userDefined:[]}}},f=JSON.xpath("/indicators[_id eq '"+app.profile._id+"']/title",i,{})[0];l.notification.keys.profile.name=f,l.notification.keys.profile.id=app.profile._id,l.notification.keys.community.name=app.getNameByLang(_lclx.COMMUNITY_CONFIG.communityName),l.notification.keys.community.id=_lclx.COMMUNITY_CONFIG.communityId;var m=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",_lclx.COMMUNITY_CONFIG,{})[0];l.notification.keys.application.name=app.getNameByLang(m.name),l.notification.keys.application.id=m.appId,l.notification.keys.currentUser.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,l.notification.keys.currentUser.id=_lclx.SUBSCRIPTIONS.userId;var I=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],g="";if(g=void 0!=_lclx.COMMUNITY_CONFIG.settings&&void 0!=_lclx.COMMUNITY_CONFIG.settings.currencySymbol?_lclx.COMMUNITY_CONFIG.settings.currencySymbol:"",void 0==e.sdoKeys&&(e.sdoKeys=[]),void 0!=e.sdoKeys)r(e.sdoKeys,0,I,u);else{var v=util.success("Notification Worker processes with no sdo keys.","success");o(v)}})},reAssignmentNotification:function(e,i,t,o){return new Promise(function(a,n){var s=new NotificatioWorker(app),r=JSON.xpath("/subprocesses[_id eq '"+t+"']/meta-data/subprofileId",i,{})[0],c=DOMAIN.replace("exist/rest",""),p={notification:{message:{rtf:{}},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:t,subProfileId:r},notificationType:"workflow",priority:"",recipients:{},url:c,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:"",validDate:"",dueDate:""},notification:{createdDateTime:moment().format()},step:{stepCreatedDateTime:"",stepName:"",stepId:""},node:{title:""},userDefined:[]}}},d=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];void 0!=e.reAssignment.sdoKeys&&e.reAssignment.sdoKeys.forEach(function(e){if(""!=e.field&&""!=e.repStr&&""!=e.setId){var t={};i.indicators.forEach(function(i){i.category.term==e.setId&&(t=i)});var o="";if(e.field.indexOf(".")>-1){var a=e.field.split(".")[0],n=e.field.split(".")[1];void 0!=t.model&&void 0!=t.model.pending&&void 0!=t.model.pending.data&&void 0!=t.model.pending.data[e.setId]&&void 0!=t.model.pending.data[e.setId][a]&&void 0!=t.model.pending.data[e.setId][a][n]&&(o=t.model.pending.data[e.setId][a][n])}else void 0!=t.model&&void 0!=t.model.pending&&void 0!=t.model.pending.data&&void 0!=t.model.pending.data[e.setId]&&void 0!=t.model.pending.data[e.setId][e.field]&&(o=t.model.pending.data[e.setId][e.field]);p.notification.keys.userDefined.push({key:"#"+e.repStr+"#",value:o})}});var u=JSON.xpath("/indicators[_id eq '"+app.profile._id+"']/title",i,{})[0];p.notification.keys.profile.name=u,p.notification.keys.profile.id=app.profile._id,p.notification.keys.community.name=app.getNameByLang(_lclx.COMMUNITY_CONFIG.communityName),p.notification.keys.community.id=_lclx.COMMUNITY_CONFIG.communityId;var l=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",_lclx.COMMUNITY_CONFIG,{})[0];p.notification.keys.application.name=app.getNameByLang(l.name),p.notification.keys.application.id=l.appId,p.notification.keys.currentUser.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,p.notification.keys.currentUser.id=_lclx.SUBSCRIPTIONS.userId,p.notification.keys.subProcess.name=JSON.xpath("/subprocesses[_id eq '"+t+"']/label",i,{})[0],p.notification.keys.subProcess.id=t,p.notification.keys.subProcess.validDate=d.dates.valid,p.notification.keys.subProcess.dueDate=d.dates.due;var f=d.step;p.notification.keys.step.stepCreatedDateTime=f.dateTimeCreated,p.notification.keys.step.stepId=f.id;var m=JSON.xpath("/processes/subProcesses[_id eq '"+d.id+"']/steps[_id eq '"+f.id+"']",app.SCOPE.workflow.config,{})[0];p.notification.keys.step.stepName=app.getNameByLang(m.name);var I=JSON.xpath("/indicators[_id eq '"+r+"']/title",app.SCOPE.workflow,{})[0];if(p.notification.keys.node.title=void 0==I?"":I,p.notification.message.default="",p.notification.message.title=e.reAssignment.title,p.notification.message=e.reAssignment.message,p.notification.messageType=e.reAssignment.messageType,p.notification.priority=e.reAssignment.priority,void 0!=e.reAssignment.notificationAction&&(p.notification.notificationAction={},p.notification.notificationAction.label=e.reAssignment.notificationAction.label,void 0!=e.reAssignment.notificationAction.action.URI?(p.notification.notificationAction.action={},p.notification.notificationAction.action.URI=e.reAssignment.notificationAction.action.URI):void 0!=e.reAssignment.notificationAction.action.goto&&(p.notification.notificationAction.action={},p.notification.notificationAction.action.goto=e.reAssignment.notificationAction.action.goto)),void 0!=e.reAssignment.schedule){var g=e.reAssignment.schedule.executeCommand,v={dateTime:"",unit:"",factor:""};if(void 0!=g.now)v.dateTime=moment().format();else if(void 0!=g.exact)v.dateTime=g.exact.dateTime;else if(void 0!=g.dueDate){var y="",S=d.dates.due;y=""!=S?moment(S,"YYYY-MM-DD"):moment().format(),v.dateTime=y,v.factor=g.dueDate.factor,v.unit=g.dueDate.unit}else if(void 0!=g.validDate){var d=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],y="",S=d.dates.valid;y=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),v.dateTime=y,v.factor=g.validDate.factor,v.unit=g.validDate.unit}else if(void 0!=g.stepCreatedDate){var d=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],y="",h=d.step.dueDateTime;y=""!=h?moment(h).format():moment().format(),v.dateTime=y,v.factor=g.stepCreatedDate.factor,v.unit=g.stepCreatedDate.unit}else v.dateTime=moment().format();s.setSchedule(v)}(function(e){return new Promise(function(i,t){var o={};o.function={},o.function.users={},o.function.users=e.id,i(o)})})(o).then(function(e){p.notification.recipients=e,s.setAction(p),s.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),s.send().then(function(e){var i=util.success("Notification Worker processes successfully for reassignment.",e);a(i)},function(e){a(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),n(e)})})},assignmentNotification:function(e,i,t,o){return new Promise(function(a,n){var s=new NotificatioWorker(app),r=JSON.xpath("/subprocesses[_id eq '"+t+"']/meta-data/subprofileId",i,{})[0],c=DOMAIN.replace("exist/rest",""),p={notification:{message:{rtf:{}},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:t,subProfileId:r},notificationType:"workflow",priority:"",recipients:{},url:c,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:"",validDate:"",dueDate:""},notification:{createdDateTime:moment().format()},step:{stepCreatedDateTime:"",stepName:"",stepId:""},node:{title:""},userDefined:[]}}},d=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];void 0!=e.assignment.sdoKeys&&e.assignment.sdoKeys.forEach(function(e){if(""!=e.field&&""!=e.repStr&&""!=e.setId){var t={};i.indicators.forEach(function(i){i.category.term==e.setId&&(t=i)});var o="";if(e.field.indexOf(".")>-1){var a=e.field.split(".")[0],n=e.field.split(".")[1];void 0!=t.model&&void 0!=t.model.pending&&void 0!=t.model.pending.data&&void 0!=t.model.pending.data[e.setId]&&void 0!=t.model.pending.data[e.setId][a]&&void 0!=t.model.pending.data[e.setId][a][n]&&(o=t.model.pending.data[e.setId][a][n])}else void 0!=t.model&&void 0!=t.model.pending&&void 0!=t.model.pending.data&&void 0!=t.model.pending.data[e.setId]&&void 0!=t.model.pending.data[e.setId][e.field]&&(o=t.model.pending.data[e.setId][e.field]);p.notification.keys.userDefined.push({key:"#"+e.repStr+"#",value:o})}});var u=JSON.xpath("/indicators[_id eq '"+app.profile._id+"']/title",i,{})[0];p.notification.keys.profile.name=u,p.notification.keys.profile.id=app.profile._id,p.notification.keys.community.name=app.getNameByLang(_lclx.COMMUNITY_CONFIG.communityName),p.notification.keys.community.id=_lclx.COMMUNITY_CONFIG.communityId;var l=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",_lclx.COMMUNITY_CONFIG,{})[0];p.notification.keys.application.name=app.getNameByLang(l.name),p.notification.keys.application.id=l.appId,p.notification.keys.currentUser.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,p.notification.keys.currentUser.id=_lclx.SUBSCRIPTIONS.userId,p.notification.keys.subProcess.name=JSON.xpath("/subprocesses[_id eq '"+t+"']/label",i,{})[0],p.notification.keys.subProcess.id=t,p.notification.keys.subProcess.validDate=d.dates.valid,p.notification.keys.subProcess.dueDate=d.dates.due;var f=d.step;p.notification.keys.step.stepCreatedDateTime=f.dateTimeCreated,p.notification.keys.step.stepId=f.id;var m=JSON.xpath("/processes/subProcesses[_id eq '"+d.id+"']/steps[_id eq '"+f.id+"']",app.SCOPE.workflow.config,{})[0];p.notification.keys.step.stepName=app.getNameByLang(m.name);var I=JSON.xpath("/indicators[_id eq '"+r+"']/title",app.SCOPE.workflow,{})[0];if(p.notification.keys.node.title=void 0==I?"":I,p.notification.message.default="",p.notification.message.title=e.assignment.title,p.notification.message=e.assignment.message,p.notification.messageType=e.assignment.messageType,p.notification.priority=e.assignment.priority,void 0!=e.assignment.notificationAction&&(p.notification.notificationAction={},p.notification.notificationAction.label=e.assignment.notificationAction.label,void 0!=e.assignment.notificationAction.action.URI?(p.notification.notificationAction.action={},p.notification.notificationAction.action.URI=e.assignment.notificationAction.action.URI):void 0!=e.assignment.notificationAction.action.goto&&(p.notification.notificationAction.action={},p.notification.notificationAction.action.goto=e.assignment.notificationAction.action.goto)),
void 0!=e.assignment.schedule){var g=e.assignment.schedule.executeCommand,v={dateTime:"",unit:"",factor:""};if(void 0!=g.now)v.dateTime=moment().format();else if(void 0!=g.exact)v.dateTime=g.exact.dateTime;else if(void 0!=g.dueDate){var y="",S=d.dates.due;y=""!=S?moment(S,"YYYY-MM-DD"):moment().format(),v.dateTime=y,v.factor=g.dueDate.factor,v.unit=g.dueDate.unit}else if(void 0!=g.validDate){var d=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],y="",S=d.dates.valid;y=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),v.dateTime=y,v.factor=g.validDate.factor,v.unit=g.validDate.unit}else if(void 0!=g.stepCreatedDate){var d=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],y="",h=d.step.dueDateTime;y=""!=h?moment(h).format():moment().format(),v.dateTime=y,v.factor=g.stepCreatedDate.factor,v.unit=g.stepCreatedDate.unit}else v.dateTime=moment().format();s.setSchedule(v)}(function(e){return new Promise(function(i,t){var o={};o.function={},o.function.users={},o.function.users=e.id,i(o)})})(o).then(function(e){p.notification.recipients=e,s.setAction(p),s.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),s.send().then(function(e){console.log(s);var i=util.success("Notification Worker processes successfully for assignment.",e);a(i)},function(e){a(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),n(e)})})},acceptanceNotification:function(e,i,t,o){return new Promise(function(a,n){var s=new NotificatioWorker(app),r=JSON.xpath("/subprocesses[_id eq '"+t+"']/meta-data/subprofileId",i,{})[0],c=DOMAIN.replace("exist/rest",""),p={notification:{message:{rtf:{}},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:t,subProfileId:r},notificationType:"workflow",priority:"",recipients:{},url:c,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:"",validDate:"",dueDate:""},notification:{createdDateTime:moment().format()},step:{stepCreatedDateTime:"",stepName:"",stepId:""},node:{title:""},userDefined:[]}}},d=JSON.xpath("/indicators[_id eq '"+app.profile._id+"']/title",i,{})[0];p.notification.keys.profile.name=d,p.notification.keys.profile.id=app.profile._id,p.notification.keys.community.name=app.getNameByLang(_lclx.COMMUNITY_CONFIG.communityName),p.notification.keys.community.id=_lclx.COMMUNITY_CONFIG.communityId;var u=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",_lclx.COMMUNITY_CONFIG,{})[0];p.notification.keys.application.name=app.getNameByLang(u.name),p.notification.keys.application.id=u.appId,p.notification.keys.currentUser.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,p.notification.keys.currentUser.id=_lclx.SUBSCRIPTIONS.userId;var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];void 0!=e.assignmentAcceptance.sdoKeys&&e.assignmentAcceptance.sdoKeys.forEach(function(e){if(""!=e.field&&""!=e.repStr&&""!=e.setId){var t={};i.indicators.forEach(function(i){i.category.term==e.setId&&(t=i)});var o="";if(e.field.indexOf(".")>-1){var a=e.field.split(".")[0],n=e.field.split(".")[1];void 0!=t.model&&void 0!=t.model.pending&&void 0!=t.model.pending.data&&void 0!=t.model.pending.data[e.setId]&&void 0!=t.model.pending.data[e.setId][a]&&void 0!=t.model.pending.data[e.setId][a][n]&&(o=t.model.pending.data[e.setId][a][n])}else void 0!=t.model&&void 0!=t.model.pending&&void 0!=t.model.pending.data&&void 0!=t.model.pending.data[e.setId]&&void 0!=t.model.pending.data[e.setId][e.field]&&(o=t.model.pending.data[e.setId][e.field]);p.notification.keys.userDefined.push({key:"#"+e.repStr+"#",value:o})}}),p.notification.keys.subProcess.name=l.label,p.notification.keys.subProcess.id=t,p.notification.keys.subProcess.validDate=l.dates.valid,p.notification.keys.subProcess.dueDate=l.dates.due;var f=l.step;p.notification.keys.step.stepCreatedDateTime=f.dateTimeCreated,p.notification.keys.step.stepId=f.id;var m=JSON.xpath("/processes/subProcesses[_id eq '"+l.id+"']/steps[_id eq '"+f.id+"']",app.SCOPE.workflow.config,{})[0];p.notification.keys.step.stepName=app.getNameByLang(m.name);var I=JSON.xpath("/indicators[_id eq '"+r+"']/title",app.SCOPE.workflow,{})[0];if(p.notification.keys.node.title=void 0==I?"":I,p.notification.message.default="",p.notification.message.title=e.assignmentAcceptance.title,p.notification.message=e.assignmentAcceptance.message,p.notification.messageType=e.assignmentAcceptance.messageType,p.notification.priority=e.assignmentAcceptance.priority,void 0!=e.assignmentAcceptance.notificationAction&&(p.notification.notificationAction={},p.notification.notificationAction.label=e.assignmentAcceptance.notificationAction.label,void 0!=e.assignmentAcceptance.notificationAction.action.URI?(p.notification.notificationAction.action={},p.notification.notificationAction.action.URI=e.assignmentAcceptance.notificationAction.action.URI):void 0!=e.assignmentAcceptance.notificationAction.action.goto&&(p.notification.notificationAction.action={},p.notification.notificationAction.action.goto=e.assignmentAcceptance.notificationAction.action.goto)),void 0!=e.assignmentAcceptance.schedule){var g=e.assignmentAcceptance.schedule.executeCommand,v={dateTime:"",unit:"",factor:""};if(void 0!=g.now)v.dateTime=moment().format();else if(void 0!=g.exact)v.dateTime=g.exact.dateTime;else if(void 0!=g.dueDate){var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],y="",S=l.dates.due;y=""!=S?moment(S,"YYYY-MM-DD"):moment().format(),v.dateTime=y,v.factor=g.dueDate.factor,v.unit=g.dueDate.unit}else if(void 0!=g.validDate){var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],y="",S=l.dates.valid;y=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),v.dateTime=y,v.factor=g.validDate.factor,v.unit=g.validDate.unit}else if(void 0!=g.stepCreatedDate){var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],y="",h=l.step.dueDateTime;y=""!=h?moment(h).format():moment().format(),v.dateTime=y,v.factor=g.stepCreatedDate.factor,v.unit=g.stepCreatedDate.unit}else v.dateTime=moment().format();s.setSchedule(v)}(function(e){return new Promise(function(i,t){var o={};o.role=e,i(o)})})(o).then(function(e){p.notification.recipients=e,s.setAction(p),s.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),s.setContext({process:{}}),s.send(s).then(function(e){console.log(s);var i=util.success("Notification Worker processes successfully for assignment.",e);a(i)},function(e){a(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),n(e)})})},acceptanceNotificationExternal:function(e,i,t,o){return new Promise(function(a,n){var s=new NotificatioWorker(app),r=JSON.xpath("/subprocesses[_id eq '"+t+"']/meta-data/subprofileId",i,{})[0],c=DOMAIN.replace("exist/rest",""),p={notification:{message:{rtf:{}},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:t,subProfileId:r},notificationType:"workflow",priority:"",recipients:{},url:c,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:"",validDate:"",dueDate:""},notification:{createdDateTime:moment().format()},step:{stepCreatedDateTime:"",stepName:"",stepId:""},node:{title:""}}}},d=JSON.xpath("/indicators[_id eq '"+app.profile._id+"']/title",i,{})[0];p.notification.keys.profile.name=d,p.notification.keys.profile.id=app.profile._id,p.notification.keys.community.name=app.getNameByLang(_lclx.COMMUNITY_CONFIG.communityName),p.notification.keys.community.id=_lclx.COMMUNITY_CONFIG.communityId;var u=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",_lclx.COMMUNITY_CONFIG,{})[0];p.notification.keys.application.name=app.getNameByLang(u.name),p.notification.keys.application.id=u.appId,p.notification.keys.currentUser.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,p.notification.keys.currentUser.id=_lclx.SUBSCRIPTIONS.userId;var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];p.notification.keys.subProcess.name=l.label,p.notification.keys.subProcess.id=t,p.notification.keys.subProcess.validDate=l.dates.valid,p.notification.keys.subProcess.dueDate=l.dates.due;var f=l.step;p.notification.keys.step.stepCreatedDateTime=f.dateTimeCreated,p.notification.keys.step.stepId=f.id;var m=JSON.xpath("/processes/subProcesses[_id eq '"+l.id+"']/steps[_id eq '"+f.id+"']",app.SCOPE.workflow.config,{})[0];p.notification.keys.step.stepName=app.getNameByLang(m.name);var I=JSON.xpath("/indicators[_id eq '"+r+"']/title",app.SCOPE.workflow,{})[0];if(p.notification.keys.node.title=void 0==I?"":I,p.notification.message.default="",p.notification.message.title=e.assignmentAcceptance.title,p.notification.message.rtf.markup=e.assignmentAcceptance.message,p.notification.messageType=e.assignmentAcceptance.messageType,p.notification.priority=e.assignmentAcceptance.priority,void 0!=e.assignmentAcceptance.notificationAction&&(p.notification.notificationAction={},p.notification.notificationAction.label=e.assignmentAcceptance.notificationAction.label,void 0!=e.assignmentAcceptance.notificationAction.action.URI?(p.notification.notificationAction.action={},p.notification.notificationAction.action.URI=e.assignmentAcceptance.notificationAction.action.URI):void 0!=e.assignmentAcceptance.notificationAction.action.goto&&(p.notification.notificationAction.action={},p.notification.notificationAction.action.goto=e.assignmentAcceptance.notificationAction.action.goto)),void 0!=e.assignmentAcceptance.schedule){var g=e.assignmentAcceptance.schedule.executeCommand,v={dateTime:"",unit:"",factor:""};if(void 0!=g.now)v.dateTime=moment().format();else if(void 0!=g.exact)v.dateTime=g.exact.dateTime;else if(void 0!=g.dueDate){var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],y="",S=l.dates.due;y=""!=S?moment(S,"YYYY-MM-DD"):moment().format(),v.dateTime=y,v.factor=g.dueDate.factor,v.unit=g.dueDate.unit}else if(void 0!=g.validDate){var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],y="",S=l.dates.valid;y=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),v.dateTime=y,v.factor=g.validDate.factor,v.unit=g.validDate.unit}else if(void 0!=g.stepCreatedDate){var l=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],y="",h=l.step.dueDateTime;y=""!=h?moment(h).format():moment().format(),v.dateTime=y,v.factor=g.stepCreatedDate.factor,v.unit=g.stepCreatedDate.unit}else v.dateTime=moment().format();s.setSchedule(v)}(function(e){return new Promise(function(i,t){var o={};o.function={},o.function.users=e,i(o)})})(o).then(function(e){p.notification.recipients=e,s.setAction(p),s.setMessage("The server is processing your request. Please wait a few seconds and then click the refresh button."),s.setContext({process:{}}),s.send(s).then(function(e){console.log(s);var i=util.success("Notification Worker processes successfully for assignment.",e);a(i)},function(e){a(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),n(e)})})}}}(),report=function(){return{createPerformanceReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("createPerformanceReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.workplanSetId,c=e.configSetId,p=JSON.xpath("/indicators[category/term eq '"+r+"']/_id",app.SCOPE.workflow,{})[0],d=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+c+"']/instances[1]/uuid",i,{})[0],u={createPerformanceReport:{workplanUUID:p,configUUID:d,profilId:i.profile}};n.action=u,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("WorkplanReport Worker processed successfully.",e);o(a)},function(e){a(e)})})},createReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("executeReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.PerformanceReportDefinitionSetId,c=e.reportingSDOSetId,p=JSON.xpath("/indicators[category/term eq '"+r+"']/_id",i,{})[0],d=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+c+"']/instances[1]/uuid",i,{})[0],u={createReport:{performanceReportDefinition:p,reportingSDO:d,profilId:i.profile}};n.action=u,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("Reprot Worker processed successfully.",e);o(a)},function(e){a(e)})})},sdoReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sdoReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.indicatorSetId,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={sdoReport:{sdoReportUUID:c,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("report Worker processed successfully.",e);o(a)},function(e){a(e)})})},executeReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("executeReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.SDOreportSetId,c=e.reportingSDOSetid,p=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],d=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+c+"']/instances[1]/uuid",i,{})[0];void 0==p&&(p=JSON.xpath("/indicators[category/term eq '"+r+"']/_id",i,{})[0]);var u={executeReport:{sdoReportUUID:p,reportingSDOUUID:d,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=u,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("report Worker processed successfully.",e);o(a)},function(e){a(e)})})},generateView:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sdoReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.ViewConfigSetId,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={generateView:{viewConfigUUID:c,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("report Worker processed successfully.",e);o(a)},function(e){a(e)})})},requestReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("executeReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.sdoRequestReportSetId,c=e.sdoReportCreationSetId,p=e.performanceReportSetId,d=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],u=JSON.xpath("/indicators[category/term eq '"+c+"']/_id",i,{})[0],l=JSON.xpath("/indicators[category/term eq '"+p+"']/_id",i,{})[0],f={requestReport:{performanceReportUUID:l,sdoRequestReportUUID:d,sdoReportCreationUUID:u,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=f,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("Request report Worker processed successfully.",e);o(a)},function(e){a(e)})})},generateBasicView:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sdoReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.sdoDataObjectViewSetId,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={generateBasicView:{sdoDataObjectViewUUID:c,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("generateBasicView Worker processed successfully.",e);o(a)},function(e){a(e)})})},generateUnionView:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sdoReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.sdoDataObjectViewUnionSetId,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={generateUnionView:{sdoDataObjectViewUnionUUID:c,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("generateUnionView Worker processed successfully.",e);o(a)},function(e){a(e)})})},sdoReportMultiple:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sdoReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.sdoReportCreationSetId,c=e.sdoReportViewsSetId,p=e.sdoReportJoinsSetId,d=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],u=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+c+"']/instances[1]/uuid",i,{})[0],l=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+p+"']/instances[1]/uuid",i,{})[0],f={sdoReportMultiple:{sdoReportCreationUUID:d,sdoReportViewsUUID:u,sdoReportJoinsUUID:l,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=f,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("sdoReportMultiple Worker processed successfully.",e);o(a)},function(e){a(e)})})},subprofileQuarterlyReport:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("executeReport"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.scheduleReportIndicator,c=JSON.xpath("/indicators[category/term eq '"+r+"']/_id",i,{})[0],p=e.sdoReportApprovalIndicator,d=JSON.xpath("/indicators[category/term eq '"+p+"' and workflows[1]/processes[1]/subProcessUUID eq '"+t+"']/_id",i,{})[0],u={subprofileQuarterlyReport:{scheduleReportIndicatorUUID:c,sdoReportApprovalIndicatorUUID:d,subprofileCode:app.profile.subProfile.code,subprofileTitle:app.profile.subProfile.title,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:t}};n.action=u,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("QuarterlyReport report Worker processed successfully.",e);o(a)},function(e){a(e)})})}}}(),participants=function(){return{linkParticipants:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("follow"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.EPWPLinkParticipantsInBulkId,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p=e.EPWPLocalityId,d=JSON.xpath("/indicators[category/term eq '"+p+"']/_id",i,{})[0],u=e.EPWPActiveParticipantsId,l=JSON.xpath("/indicators[category/term eq '"+u+"']/_id",i,{})[0],f={linkParticipants:{EPWPLinkParticipantsInBulkIdUUID:c,EPWPLocalityIdUUID:d,EPWPActiveParticipantsIdUUID:l,profilId:i.profile}};n.action=f,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("EPWPLinkParticipants Worker processed successfully.",e);o(a)},function(e){a(e)})})},monthlyAttendance:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("follow"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.EPWPMonthlyAttendanceBulkUploadUUID,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p=e.EPWPActiveParticipantsIdUUID,d=JSON.xpath("/indicators[category/term eq '"+p+"']/_id",i,{})[0],u=e.EPWPMonthlyEmploymentPerLocalityUUID,l=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+u+"']/instances[1]/uuid",i,{})[0],f={monthlyAttendance:{EPWPMonthlyAttendanceBulkUploadUUID:c,EPWPActiveParticipantsIdUUID:d,EPWPMonthlyEmploymentPerLocalityUUID:l,profilId:i.profile}};n.action=f,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("monthlyAttendance Worker processed successfully.",e);o(a)},function(e){a(e)})})},monthlyProgressSummary:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("follow"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.EPWPMonthlyProgressSummaryIdUUID,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={monthlyProgressSummary:{EPWPMonthlyProgressSummaryIdUUID:c,profilId:i.profile}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("monthlyAttendance Worker processed successfully.",e);o(a)},function(e){a(e)})})},participantContracts:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("follow"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=e.EPWPParticipantContractsIdUUID,c=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+r+"']/instances[1]/uuid",i,{})[0],p={participantContracts:{EPWPParticipantContractsIdUUID:c,profilId:i.profile}};n.action=p,worker.send(n).then(function(e){worker.setWorkerInfoInSubprocess(n,i,t);var a=util.success("participantContracts Worker processed successfully.",e);o(a)},function(e){a(e)})})},genericLinkParticipants:function(e,i,t){return new Promise(function(e,i){})}}}(),worker=function(){return{getWorkerWrapper:function(){return{source:"remote",type:"workerObject",_id:"",channels:["workerObject"],profileId:"",communityId:"",applicationId:"",subProcessUUID:"",message:"",messageType:"info",createdDateTime:"",senderUserId:"",subProfileId:"",parentTransactionId:void 0==app.SCOPE.txn?"":app.SCOPE.txn.transactionId,action:{}}},send:function(e){return new Promise(function(i,t){console.log("Submitting Worker Object to server"),console.log(e),dao.save(e).then(function(e){i(e)}).catch(function(e){console.log("Error submitting worker response !!"+e),t(e)})})},sendWorker:function(e,i,t){return new Promise(function(o,a){var n=worker.getWorkerWrapper(),s="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(s=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=_lclx.SUBSCRIPTIONS.userId,n.profileId=i.profile,n.subProcessUUID=t,n.subprofileId=s,n.channels.push("sendWorker"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=function(e,o,a){return new Promise(function(n,s){helper.getNodeValue(e,i,t).then(function(e){n({seq:o,paramName:a,dataValue:e})},function(e){s(e)})})},c=function(e){return new Promise(function(o,a){for(var n=[],s=e.length,c=0;c<e.length;c++){var p=e[c].parameterValue,d=e[c].seq,u=e[c].parameterName;r(p,d,u).then(function(e){n.push({seq:e.seq,paramName:e.paramName,paramValue:e.dataValue}),0==--s&&(n.push({seq:s+1,paramName:"communityId",paramValue:i.communityId}),n.push({seq:s+2,paramName:"applicationId",paramValue:i.app}),n.push({seq:s+3,paramName:"profileId",paramValue:i.profile}),n.push({seq:s+4,paramName:"subProcessUUID",paramValue:t}),o(n))},function(e){0==--s&&(n.push({seq:s+1,paramName:"communityId",paramValue:i.communityId}),n.push({seq:s+2,paramName:"applicationId",paramValue:i.app}),n.push({seq:s+3,paramName:"profileId",paramValue:i.profile}),n.push({seq:s+4,paramName:"subProcessUUID",paramValue:t}),o(n))})}})};if(void 0!=e.rest){var p=e.rest.parameters;c(p).then(function(s){var r={sendWorker:{rest:{}}};r.sendWorker.rest.uri=e.rest.uri,r.sendWorker.rest.profilId=i.profile,r.sendWorker.rest.parameters=s,n.action=r,worker.send(n).then(function(e){var s=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];s.spStatus="submitted",void 0==s.messages&&(s.messages=[]);var r={message:{i18n:{_id:"",en:"The server is processing your request. Please wait a few seconds and then click the refresh button.",pt:"The server is processing your request. Please wait a few seconds and then click the refresh button."}},type:"info"};s.messages.push(r),void 0==s.workers&&(s.workers=[]),s.workers.push({workerId:n._id,dateTime:moment().format()}),persistData("subprocesses",app.SCOPE.workflow,t).then(function(i){var t=util.success("Worker Rest processed successfully.",e);o(t)}).catch(function(e){console.log("Worker submitted subprocess file update failed"),a(e)})},function(e){console.log("Worker failed "),a(e)})},function(e){console.log("parameter creation failed. Abording worker object")})}else if(void 0!=e.functional){var p=e.functional.parameters;c(p).then(function(s){var r={sendWorker:{functional:{}}};r.sendWorker.functional.methodName=e.functional.methodName,r.sendWorker.functional.profilId=i.profile,r.sendWorker.functional.parameters=s,n.action=r,worker.send(n).then(function(e){var s=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];s.spStatus="submitted",void 0==s.messages&&(s.messages=[]);var r={message:{i18n:{_id:"",en:"The server is processing your request. Please wait a few seconds and then click the refresh button.",pt:"The server is processing your request. Please wait a few seconds and then click the refresh button."}},type:"info"};s.messages.push(r),void 0==s.workers&&(s.workers=[]),s.workers.push({workerId:n._id,dateTime:moment().format()}),persistData("subprocesses",app.SCOPE.workflow,t).then(function(i){var t=util.success("Worker functional processed successfully.",e);o(t)}).catch(function(e){console.log("Worker submitted subprocess file update failed"),a(e)})},function(e){console.log("Worker failed "),a(e)})},function(e){console.log("parameter creation failed. Abording worker object")})}})},executeLocal:function(workerConfig,_WFInstance,uuid){return new Promise(function(resolve,reject){var processGetNodeValue=function(e,i,t){return new Promise(function(o,a){helper.getNodeValue(e,_WFInstance,uuid).then(function(e){o({seq:i,dataType:t,dataValue:e})},function(e){a(e)})})},processParams=function(e){return new Promise(function(i,t){for(var o=[],a=e.length,n=0;n<e.length;n++){var s=e[n].parameterValue,r=e[n].seq,c=e[n].dataType.dataType;processGetNodeValue(s,r,c).then(function(e){o.push({seq:e.seq,dataType:e.dataType,paramValue:e.dataValue}),0==--a&&i(o)},function(e){0==--a&&i(o)})}})},fixParamType=function(e,i){switch(i){case"string":return""+e.replace(/'/g,"\\'");case"date":case"dateTime":return""+e;case"number":case"decimal":return e}},methodName=workerConfig.methodName,configParam=workerConfig.parameters;processParams(configParam).then(function(paramsArray){for(var pList="",i=0;i<paramsArray.length-1;i++)pList=pList+fixParamType(paramsArray[i].paramValue,paramsArray[i].dataType)+",";pList+=fixParamType(paramsArray[i].paramValue,paramsArray[i].dataType);var callbackSuccess=function(){return console.log("S"),resolve("Function '"+methodName+"' executed. Response success.")},callbackFailure=function(){return console.log("E"),reject("Function '"+methodName+"' executed. Response failed.")},spUUID=""+uuid
;console.log("Going to execute == "+methodName),0==paramsArray.length?eval(methodName)(callbackSuccess,callbackFailure,spUUID):1==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,callbackSuccess,callbackFailure,spUUID):2==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,callbackSuccess,callbackFailure,spUUID):3==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,callbackSuccess,callbackFailure,spUUID):4==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,paramsArray[3].paramValue,callbackSuccess,callbackFailure,spUUID):5==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,paramsArray[3].paramValue,paramsArray[4].paramValue,callbackSuccess,callbackFailure,spUUID):6==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,paramsArray[3].paramValue,paramsArray[4].paramValue,paramsArray[5].paramValue,callbackSuccess,callbackFailure,spUUID):7==paramsArray.length?eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,paramsArray[3].paramValue,paramsArray[4].paramValue,paramsArray[5].paramValue,paramsArray[6].paramValue,callbackSuccess,callbackFailure,spUUID):8==paramsArray.length&&eval(methodName)(paramsArray[0].paramValue,paramsArray[1].paramValue,paramsArray[2].paramValue,paramsArray[3].paramValue,paramsArray[4].paramValue,paramsArray[5].paramValue,paramsArray[6].paramValue,paramsArray[7].paramValue,callbackSuccess,callbackFailure,spUUID)},function(e){console.log("parameter creation failed. Abording worker object"),reject(e)})})},setWorkerInfoInSubprocess:function(e,i,t){var o=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],a={message:{i18n:{_id:"",en:"The server is processing your request. Please wait a few seconds and then click the refresh button.",pt:"O servidor está processando sua solicitação. Por favor aguarde alguns segundos e depois clique no botão atualizar."}},type:"info"};o.messages=[],o.messages.push(a),void 0==o.workers&&(o.workers=[]),o.workers.push({workerId:e._id,dateTime:moment().format()})},create:function(e,i,t){return new Promise(function(o,a){var n=e.channel,s=e.action,r=worker.getWorkerWrapper(),c="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(c=app.profile.subprofileId),r._id=generateUUID(),r.communityId=app.SCOPE.getCommunityId(),r.applicationId=app.SCOPE.applicationId,r.createdDateTime=moment().format(),r.senderUserId=_lclx.SUBSCRIPTIONS.userId,r.profileId=i.profile,r.subProcessUUID=t,r.subprofileId=c,r.channels.push(n),r.channels.push("community_"+app.SCOPE.getCommunityId());var p={};p[s]={};for(var d=0;d<e.indicators.length;d++){var u=e.indicators[d].label,l=e.indicators[d].setId,f=e.indicators[d].context,m="";if("subProcess"==f||"currentSubProcessInstance"==f||"currentSubProcess"==f){if(void 0==(m=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+l+"']/instances[1]/uuid",i,{})[0])){var I=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0];void 0!=I&&I.indicators.length>0&&(m=JSON.xpath("/indicators[category/term eq '"+l+"']/_id",i,{})[0])}}else m=JSON.xpath("/indicators[category/term eq '"+l+"']/_id",i,{})[0];p[s][u]=m}if(p[s].profilId=i.profile,void 0!=e.fixed)for(var d=0;d<e.fixed.length;d++){var g=e.fixed[d],v=Object.keys(g)[0];p[s][v]=g[v]}void 0!=e.dataFields&&(p[s].dataFields=e.dataFields),p[s].applicationId=app.SCOPE.applicationId,p[s].communityId=app.SCOPE.getCommunityId(),p[s].profileId=app.SCOPE.workflow.profile,p[s].subProcessUUID=t,r.action=p,worker.send(r).then(function(e){worker.setWorkerInfoInSubprocess(r,i,t);var a=util.success(s+" worker processed successfully.",e);o(a)},function(e){a(e)})})}}}(),user=function(){return{addToRole:function(e,i,t){return new Promise(function(o,a){helper.getNodeValue(e.userName,t,i).then(function(n){helper.getNodeValue(e.userId,t,i).then(function(s){helper.getNodeValue(e.roleId,t,i).then(function(e){if("string"!=typeof n&&"string"!=typeof s&&Array.isArray([n])&&Array.isArray([s]))if("string"!=typeof e&&Array.isArray([e]))if(n.length!=s.length||s.length!=e.length)a({isError:!0,message:"Config issue in role assignment action."});else{var i=function(t){if(n.length==t){var a=util.success("Role assignment complete",{});o(a)}else if(void 0==e[t]||""==e[t]||void 0==s[t]||""==s[t]||void 0==n[t]||""==n[t])i(t+1);else{var r=JSON.xpath("/roles[id eq '"+e[t]+"']/type",app.SCOPE.APP_CONFIG,{})[0];"instance"==r?rolesManager.doUserRegistration(s[t],n[t],e[t],"instance").then(function(e){i(t+1)}).catch(function(e){i(t+1)}):"subprofile"==r?rolesManager.doUserRegistration_node(s[t],n[t],e[t],"subprofile").then(function(e){i(t+1)}).catch(function(e){i(t+1)}):"adoption"==r?rolesManager.doUserRegistration_adoption(s[t],n[t],e[t],"adoption").then(function(e){i(t+1)}).catch(function(e){i(t+1)}):i(t+1)}};i(0)}else{var i=function(t){if(n.length==t){var a=util.success("Role assignment complete",{});o(a)}else if(void 0==e||""==e||void 0==s[t]||""==s[t]||void 0==n[t]||""==n[t])i(t+1);else{var r=JSON.xpath("/roles[id eq '"+e+"']/type",app.SCOPE.APP_CONFIG,{})[0];"instance"==r?rolesManager.doUserRegistration(s[t],n[t],e,"instance").then(function(e){i(t+1)}).catch(function(e){i(t+1)}):"subprofile"==r?rolesManager.doUserRegistration_node(s[t],n[t],e,"subprofile").then(function(e){i(t+1)}).catch(function(e){i(t+1)}):"adoption"==r?rolesManager.doUserRegistration_adoption(s[t],n[t],e,"adoption").then(function(e){i(t+1)}).catch(function(e){i(t+1)}):i(t+1)}};i(0)}else{var t=JSON.xpath("/roles[id eq '"+e+"']/type",app.SCOPE.APP_CONFIG,{})[0];"instance"==t?rolesManager.doUserRegistration(s,n,e,"instance").then(function(e){var i=util.success("Role assigned to user in context instance",e);o(i)}).catch(function(e){console.log("rolesManager- instance fail"),o("role update failed")}):"subprofile"==t?rolesManager.doUserRegistration_node(s,n,e,"subprofile").then(function(e){var i=util.success("Role assigned to user in context subprofile",e);o(i)}).catch(function(e){console.log("rolesManager- subprofile fail"),o("role update failed")}):"adoption"==t?rolesManager.doUserRegistration_adoption(s,n,e,"adoption").then(function(e){var i=util.success("Role assigned to user in context adoption",e);o(i)}).catch(function(e){console.log("rolesManager- adoption fail"),o("role update failed")}):(console.log("Role not found in any context"),a("Role not found in any context"))}}).catch(function(e){a(e)})}).catch(function(e){a(e)})}).catch(function(e){a(e)})})}}}(),generalFunctions=function(){return{addToFavourites:function(e,i,t){return new Promise(function(i,o){var a=e.context;"profile"==a?library.addToFavouritesProfile().then(function(e){i(e)}).catch(function(e){o(e)}):"subprofile"==a?library.addToFavouritesSubProfile().then(function(e){i(e)}).catch(function(e){o(e)}):"subprocess"==a&&library.addToFavouritesSubProcess(t).then(function(e){i(e)}).catch(function(e){o(e)})})},addToUserFavourites:function(e,i,t){return new Promise(function(o,a){var n=e.context,s=e.user,r="";if(void 0!=s.stepAssigneeFromStep){for(var c=s.stepAssigneeFromStep.stepId,p=JSON.xpath("/subprocesses[_id eq '"+t+"']",i,{})[0],d={},u=0;u<p.history.length;u++)p.history[u].id==c&&(d=p.history[u]);if(void 0!=d.assignmentHistory&&d.assignmentHistory.length>0){r=d.assignmentHistory[d.assignmentHistory.length-1].userId}}else if(void 0!=s.indicator){var l=s.indicator.indicatorSetId,f=s.indicator.elementId,m=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+l+"']/instances/uuid",i,{})[0],I=JSON.xpath("/indicators[_id eq '"+m+"']",i,{})[0],g="/model/pending/data/"+l+"/"+f,v=JSON.xpath(g,I,{})[0];r=v}"profile"==n?library.addToFavouritesProfileForUser(r).then(function(e){console.log("Workflow ****** Profile Done"),o(e)}).catch(function(e){a(e)}):"subprofile"==n?library.addToFavouritesSubprofileForUser(r).then(function(e){console.log("Workflow ****** SubProfile Done"),o(e)}).catch(function(e){a(e)}):"subprocess"==n&&library.addToUsersFavouritesSubProcessForUser(r,t).then(function(e){console.log("Workflow ****** Subprocess Done"),o(e)}).catch(function(e){a(e)})})}}}();module.exports={community:community,application:application,performance:performance,worker:worker,sdo:sdo,taxonomy:taxonomy,subProcessInstance:subProcessInstance,variables:variables,notification:notification,report:report,participants:participants,user:user,generalFunctions:generalFunctions};

},{"./form":3,"./helper":4,"./nodeValue":6,"utility":8}],3:[function(require,module,exports){
"use strict";function create(e){var t=e[0]||"",s=e[1]||{},i=e[2]||{},r=e[3]||{},o=e[6]||{},a=(e[6],s.indicators||[]),n=(r._type,e[4],e[5],e[7],s._id),c=e[8]||"",d=e[9]||"",u=(o.profile,e[10]||{}),l=r.method.form.create;void 0!=r.method.form.authoriseAndCreateNewSeq?l=r.method.form.authoriseAndCreateNewSeq:void 0!=r.method.form.createNewSeq&&(l=r.method.form.createNewSeq);var p=r.method.form.type,f={formCreateType:l,formType:p};return new Promise(function(e,p){var h=a.length,m=!1,v=[],g=function(){if(0==m){var t=util.success("Form create indicator persist success.",o.indicators);e(t)}else{for(var s=[],i=0;i<o.instance.processes.length;i++)o.instance.processes[i].subProcesses.length>0&&s.push(o.instance.processes[i]);o.instance.processes=[],o.instance.processes=s;var r=[],a=JSON.xpath("/subprocesses[_id eq '"+c+"']",o,{})[0],n=a.id,d=JSON.xpath("/config/processes/subProcesses[_id eq '"+n+"']",o,{})[0];if(void 0!=d.instanceType.newSequence){for(var i=0;i<d.indicators.length;i++){var u=d.indicators[i],l=u._id,f=JSON.xpath("distinct-values(/subprocesses[groupKey = '"+a.groupKey+"']/indicators[id = '"+l+"']/instances/uuid)",o,{})[0];if(void 0!=f){var h=JSON.xpath("/indicators[_id eq '"+f+"']",o,{})[0];void 0!=h&&(h.model.pending=h.model.approved)}}for(var g="",i=0;i<d.indicators.length-1;i++)g=g+"'"+d.indicators[i]._id+"',";g=g+"'"+d.indicators[d.indicators.length-1]._id+"'",r=JSON.xpath("distinct-values(/indicators[category/term = ("+g+")]/model/approved/subProcessUUID)",o,{});var I=function(e,t){if(e==t.length){for(var s=[],i=0;i<o.subprocesses.length;i++)o.subprocesses[i].indicators.length>0&&s.push(o.subprocesses[i]);o.subprocesses=[],o.subprocesses=s;var r=util.success("Process failed",v);p(r)}else persistData("indicators",o,t[e]).then(function(s){I(e+1,t)}).catch(function(s){I(e+1,t)})};I(0,r)}else{for(var S=[],i=0;i<o.subprocesses.length;i++)o.subprocesses[i].indicators.length>0&&S.push(o.subprocesses[i]);o.subprocesses=[],o.subprocesses=S;var _=util.success("Process failed",v);p(_)}}},I=JSON.xpath("/config/processes/subProcesses[_id eq '"+n+"']/type",o,{})[0],S=function(e,a,l,p){return new Promise(function(S,_){gatekeeper.instantiate(d,e,a,o.profile,l,n,I).then(function(e){for(var n=0;n<e.length;n++){for(var d=e[n],I=0;I<o.indicators.length;I++){if(o.indicators[I]._id==d.model._id){o.indicators.splice(I,1),o.indicators.push(d.model);break}}if(!d.model._id.endsWith(":approved")&&!d.model._id.endsWith(":rejected")){d.model.model.pending.validDate=l,d.model.model.pending.subProcessUUID=c;var _={id:o.config._id,instance:o.instance._id,processes:[{id:t,subProcessId:s._id,subProcessUUID:c,step:{id:i.id,seq:i.seq,startDate:"",status:i.status,message:i.message,assignedTo:{userId:i.assignedTo.userId,name:i.assignedTo.name},comment:i.comment,complete:!1,endDate:""}}]};1==d.model.model.pending.seq&&void 0!=r.setWorkflowLabelInTitle&&""!=r.setWorkflowLabelInTitle&&1==r.setWorkflowLabelInTitle&&(d.model.title=u.label),void 0!=r.setDraft&&""!=r.setDraft&&1==r.setDraft&&(d.model.control.draft=!0);var O=!1,N=-1;d.model.workflows.forEach(function(e,t){c==e.processes[0].subProcessUUID&&(O=!0,N=t)}),O?d.model.workflows[N]=_:d.model.workflows.push(_);var b=d.model._id;gatekeeper.persist(e).then(function(e){dao.get(b).then(function(e){var t=ko.mapping.fromJS({defaultModel:{setId:a}}),s=e.model.pending.seq;gatekeeper.instantiateData(b,p,t,e.model.pending.seq,f).then(function(e){if("200"==e[0].status){for(var t=0;t<o.indicators.length;t++){if(o.indicators[t]._id==e[0].model._id){o.indicators.splice(t,1),o.indicators.push(e[0].model);break}}if(1==s&&void 0!=r.setWorkflowLabelInField&&""!=r.setWorkflowLabelInField){if(r.setWorkflowLabelInField.split(".")[0]==a){console.log(e[0]);var i=u.label,n=i.replace(/'/g,"\\'"),d=e[0].model.model.pending.data,l=""==r.setWorkflowLabelInField?[]:r.setWorkflowLabelInField.split(/['"\[\].]+/),p=0;for(p=0;p<l.length-1;p++)""!=l[p]&&(d=d[l[p]]);d[l[p]]=n}}gatekeeper.persist(e).then(function(e){dao.get(b).then(function(e){if(0==o.indicators.length)o.indicators.push(e),h--,0==h&&persistData("indicators",o,c).then(function(e){util.success("Form create indicator persist success.",o.indicators);g()}).catch(function(e){v.push({error:"persistData "+c,errorBlock:e}),console.error(e);util.success("Form create indicator persist failed.",{});m=!0,g()}),S({});else{for(var t=!1,s=0;s<o.indicators.length;s++){o.indicators[s]._id==e._id&&(t=!0,o.indicators.splice(s,1),o.indicators.push(e),s=o.indicators.length,h--,0==h&&persistData("indicators",o,c).then(function(e){util.success("Form create indicator persist success.",o.indicators);g()}).catch(function(e){v.push({error:"persistData "+c,errorBlock:e}),console.error(e);util.success("Form create indicator persist failed.",{});m=!0,g()}),S({}))}0==t&&(o.indicators.push(e),h--,0==h&&persistData("indicators",o,c).then(function(e){util.success("Form create indicator persist success.",o.indicators);g()}).catch(function(e){v.push({error:"persistData "+c,errorBlock:e}),console.error(e);util.success("Form create indicator persist failed.",{});m=!0,g()}),S({}))}}).catch(function(e){v.push({error:"dao.get(mainId) "+b,errorBlock:e}),console.error(e);util.success("1 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),S({})})},function(e){v.push({error:"gatekeeper.persist(data) - Persisting all docs ",errorBlock:e}),console.error(e);util.success("2 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),S({})})}else{v.push({error:"gatekeeper.instantiateData"+b+" "+e[0].status,errorBlock:{}});util.success("3 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),S({})}},function(e){v.push({error:"gatekeeper.instantiateData"+b,errorBlock:e});util.success("4 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),S({})})}).catch(function(e){v.push({error:"dao.get(mainId) "+b,errorBlock:e}),console.error(e);util.success("5 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),S({})})},function(e){v.push({error:"gatekeeper.persist savedArray",errorBlock:e}),console.error(e);util.success("6 Gatekeeper initialisation failed with initialiseData message ",{});m=!0,h--,0==h&&g(),S({})})}}},function(e){v.push({error:"gatekeeper.instantiate",errorBlock:e}),m=!0,h--,0==h&&g(),S({})})})},_=FROM_DEFINITION,O=function(e,t){if(0==e.length)0==--h&&g();else if(t<e.length){var i=e[t]._id,r=(util.getName(e[t].name,"en"),e[t].sequenceCreation);void 0==r&&(r="");var a=(e[t].initiateData,"");void 0!=s.instanceType.newSequence?a=INSTANCE_TYPE_NEW_SEQ:void 0!=s.instanceType.newInstance&&(a=INSTANCE_TYPE_NEW_INS);var p=function(){S(a,i,u.validDate,_).then(function(s){O(e,t+1)}).catch(function(e){m=!0,0==--h&&g()})};if(void 0!=d&&""!=d&&d.length>0){var f=JSON.xpath("/subprocesses[_id eq '"+d+"']",o,{})[0];void 0==s.periodType.periodic&&d!=c&&(f.active=!1),_=l==BLANK_MODEL||r==BLANK_MODEL?FROM_DEFINITION:FROM_AUTHORISED,p()}else{var v=JSON.xpath("/indicators[setId eq '"+i+"']/cardinality",app.SCOPE.APP_CONFIG,{})[0];if(a==INSTANCE_TYPE_NEW_INS)v==INDICATOR_CARDINALITY_SINGLE?library.getSingleIndicator(i).then(function(e){_=e.length>0?FROM_AUTHORISED:FROM_DEFINITION,p()}).catch(function(e){_=FROM_DEFINITION,p()}):(_=FROM_DEFINITION,p());else if(v==INDICATOR_CARDINALITY_SINGLE)library.getSingleIndicator(i).then(function(e){_=e.length>0?FROM_AUTHORISED:FROM_DEFINITION,p()}).catch(function(e){_=FROM_DEFINITION,p()});else{var N="/indicators[category/term eq '"+i+"' and id = /subprocesses[id = '"+n+"']/indicators/instances/uuid]/_id",b=library.getSubprofileSubprocessIds();I==PROCESS_TYPE_SUBPROFILE&&(N="/indicators[category/term eq '"+i+"' and id = /subprocesses[id = '"+n+"' and id = "+b+"]/indicators/instances/uuid]/_id");var D=JSON.xpath(N,o,{});_=D.length>0?FROM_AUTHORISED:FROM_DEFINITION,p()}}}};O(a,0)})}function setInstanceTitle(e){var t=e[0]||{},s=e[2]||"",i=e[4]||{},r=i.label;return new Promise(function(e,i){for(var o=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],a=o.indicators,n=0;n<a.length;n++){var c=a[n].instances[0].uuid;JSON.xpath("/indicators[_id eq '"+c+"']",t,{})[0].title=a[n].id+" "+r}e("Set Title Success",a)})}function deleteProfile(e){var t=e[0]||{},s=t.profile;return new Promise(function(e,i){var r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId);var o={source:"remote",type:"workerObject",_id:generateUUID(),channels:["deleteProfile","community_"+app.SCOPE.getCommunityId(),"workerObject"],communityId:app.SCOPE.getCommunityId(),applicationId:app.SCOPE.applicationId,profileId:t.profile,message:"",subprofileId:r,messageType:"info",createdDateTime:moment().format(),senderUserId:_lclx.SUBSCRIPTIONS.userId,parentTransactionId:void 0==app.SCOPE.txn?"":app.SCOPE.txn.transactionId,notification:{},profile:{action:"deleteProfile",profileId:s}};console.log(o),dao.save(o).then(function(t){console.log("Worker Object submitted for profile("+s+") deletion."),console.log(t),e(t)}).catch(function(e){console.log(e),i(data)})})}function createProfile(e){var t=e[1]||{},s=t.communityId,i=t.profile;return new Promise(function(e,t){library.createProfileDocuments(s,i).then(function(t){var s=util.success("Form created successfully.",t);e(s)}).catch(function(e){console.error(e);var s=util.success("ERROR: Profile creation failed",{});t(s)})})}function setDraft(e){var t=e[0]||{},s=e[2]||"";return new Promise(function(e,i){for(var r=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],o=r.indicators,a=0;a<o.length;a++){var n=o[a].instances[0].uuid;JSON.xpath("/indicators[_id eq '"+n+"']",t,{})[0].control.draft=!0}e("Set Draft Success",o)})}function setUnDraft(e){var t=e[0]||{},s=e[2]||"";return new Promise(function(e,i){for(var r=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],o=r.indicators,a=0;a<o.length;a++){var n=o[a].instances[0].uuid;JSON.xpath("/indicators[_id eq '"+n+"']",t,{})[0].control.draft=!1}e("Set Draft Success",o)})}function save(e){var t={complete:!0,data:[]};return new Promise(function(e,s){e(util.success("Form indicator set saved successfully.",t))})}function submit(e){var t={complete:!0,data:[]};return new Promise(function(e,s){e(util.success("Form submitted successfully.",t))})}function authorise(e){var t=(e[0],e[1],e[2],e[3],e[4]||{}),s=e[6]||"";return new Promise(function(e,i){var r=(JSON.xpath("/subprocesses[_id eq '"+s+"']",app.SCOPE.workflow,{})[0],JSON.xpath("/subprocesses[_id eq '"+s+"']/indicators/instances/uuid",t,{})),o=r.length,a=[],n=[],c=function(d){gatekeeper.authorise(r[d]).then(function(r){gatekeeper.persist(r).then(function(r){for(var u="",l=0;l<r.length;l++)r[l].id.endsWith(":approved")||(u=r[l].id);dao.get(u).then(function(r){if(0==t.indicators.length)t.indicators.push(r),o--,0==o?persistData("indicators",t,s).then(function(t){var s=util.success("Form authorised successfully.",a);e(s)}).catch(function(e){console.error(e);var t=util.success("Form authorised persist failed.",{});i(t)}):o>0&&c(d+1);else{for(var u=!1,l=0;l<t.indicators.length;l++){if(t.indicators[l]._id==r._id&&(u=!0,n.push(r),0==--o)){for(var p=t.indicators.length,f=n.length,h=0;h<p;h++){for(var m=!1,v=0;v<f;v++)t.indicators[h]._id==n[v]._id&&(m=!0);m||n.push(t.indicators[h])}t.indicators=n;break}}1==u&&0==o?persistData("indicators",t,s).then(function(t){var s=util.success("Form authorised successfully.",a);e(s)}).catch(function(e){console.error(e);var t=util.success("Form authorised persist failed.",{});i(t)}):o>0&&c(d+1)}}).catch(function(e){console.error(e);var t=util.success("Form authorised persist failed 2.",{});i(t)})},function(e){console.error(e);var t=util.success("Form authorised persist failed 3.",{});i(t)})},function(e){var t=util.success("Form authorised persist failed 4.",{});i(t)})};c(0)})}function close(e){var t={complete:!0,data:[]};return new Promise(function(e,s){e(util.success("Form closed successfully.",t))})}function updateIndicator(e){var t=e[0]||{},s=e[1]||"",i=e[2]||"",r=e[3]||"";return new Promise(function(e,o){var a=i.split(".",1)[0],n=JSON.xpath("/indicators[workflows/processes/subProcessUUID = '"+s+"' and category/term = '"+a+"']",t,{})[0];if(void 0==n&&"appProfile"==a&&void 0==(n=JSON.xpath("/indicators[model/pending/status = 'Authorised' and category/term = '"+a+"']",t,{})[0])){var c=[],d={};d.model={},c.push(d);var u=util.success("Indicator updated skipped.",c);return void e(u)}var l=(r+"").replace(/'/g,"\\'"),l=l.split("\n").join(" "),p=n.model.pending.data,f=""==i?[]:i.split(/['"\[\].]+/),h=0;for(h=0;h<f.length-1;h++)""!=f[h]&&(p=p[f[h]]);p[f[h]]=l;var c=[],d={};d.model=n,c.push(d);var m=JSON.parse(JSON.stringify(app.SCOPE.txn));m.documents=[];var v={document:n._id,rev:n._rev};m.documents.push(v),app.SCOPE.txn.documents.push(v),dao.updateTransaction(m).then(function(t){dao.save(n).then(function(t){v.rev=t.rev;var s=util.success("Indicator updated.",c);e(s)}).catch(function(t){console.log(t);var s=util.success("Indicator updated.",c);e(s)})}).catch(function(t){console.log(t);var s=util.success("Indicator updated.",c);e(s)})})}function updateIndicatorWrapper(e){var t=e[0]||{},s=e[1]||"",i=e[2]||"",r=e[3]||"",o=e[4]||"";return new Promise(function(e,a){var n=JSON.xpath("/indicators[workflows/processes/subProcessUUID = '"+s+"' and category/term = '"+o+"']",t,{})[0];if(void 0==n&&"appProfile"==o&&void 0==(n=JSON.xpath("/indicators[model/pending/status = 'Authorised' and category/term = '"+o+"']",t,{})[0])){var c=[],d={};d.model={},c.push(d);var u=util.success("Indicator updated skipped.",c);return void e(u)}var l=r.replace(/'/g,"\\'"),l=l.split("\n").join(" "),p=n,f=""==i?[]:i.split(/['"\[\].]+/),h=0;for(h=0;h<f.length-1;h++)""!=f[h]&&(p=p[f[h]]);p[f[h]]=l;var c=[],d={};d.model=n,c.push(d);var m=JSON.parse(JSON.stringify(app.SCOPE.txn));m.documents=[];var v={document:n._id,rev:n._rev};m.documents.push(v),app.SCOPE.txn.documents.push(v),dao.updateTransaction(m).then(function(t){dao.save(n).then(function(t){v.rev=t.rev;var s=util.success("Indicator updated.",c);e(s)}).catch(function(t){console.log(t);var s=util.success("Indicator updated.",c);e(s)})}).catch(function(t){console.log(t);var s=util.success("Indicator updated.",c);e(s)})})}function markUpdateIndicator(e){var t=e[0]||{},s=e[1]||"",i=e[2]||"",r=e[3]||"";return new Promise(function(e,o){var a=JSON.xpath("/indicators[workflows/processes/subProcessUUID = '"+s+"' and category/term = '"+r+"']",t,{})[0];a.model.pending.status=i;var n=[],c={};c.model=a,n.push(c),e(util.success("Indicator updated.",n))})}function setStatus(e){var t=e[0]||{},s=e[1]||"",i=e[2]||"";return new Promise(function(e,r){var o=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0];o.step.message=i,e("Set profile status Success",o)})}var util=require("utility"),gatekeeper=new GK;module.exports={create:create,save:save,submit:submit,authorise:authorise,close:close,setDraft:setDraft,setUnDraft:setUnDraft,createProfile:createProfile,setInstanceTitle:setInstanceTitle,deleteProfile:deleteProfile,updateIndicator:updateIndicator,markUpdateIndicator:markUpdateIndicator,updateIndicatorWrapper:updateIndicatorWrapper};

},{"utility":8}],4:[function(require,module,exports){
"use strict";function getLanguageMessage(e){var a=service.getLanguage(),t=e.i18n[a];return void 0==t&&(t=e.i18n.en),t}function numberWithCommas(e){return e.toString().startsWith("<")?e.toString():e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function getNodeValue(e,a,t){return new Promise(function(r,i){if("string"==typeof e)r(e);else if(void 0!=e.value){var s="string";s=void 0!=e.value.datatype.dataType?e.value.datatype.dataType:e.value.datatype;var o=e.value.data;r("number"==s?Number(o):"string"==s?o:"integer"==s?parseInt(o):"decimal"==s?parseFloat(o):"date"==s||"dateTime"==s?o:o)}else if(void 0!=e.indicatorUUID){var n=null,c=JSON.xpath("/subprocesses[_id eq '"+t+"']",a,{})[0];0==c.indicators.length?n=JSON.xpath("/indicators[category/term eq '"+e.indicatorUUID.indicatorSetId+"']/_id",a,{})[0]:void 0==(n=JSON.xpath("/indicators[id eq '"+e.indicatorUUID.indicatorSetId+"']/instances/uuid",c,{})[0])&&(n=JSON.xpath("/indicators[category/term eq '"+e.indicatorUUID.indicatorSetId+"']/_id",a,{})[0]),r(n)}else if(void 0!=e.indicator){var n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+e.indicator.indicatorSetId+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],p="";void 0!=e.indicator.basepath&&(p=e.indicator.basepath);var l="/model/pending/data/"+e.indicator.indicatorSetId+p+"/"+e.indicator.elementId,u=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+t+"']/id]/type",a,{})[0],S=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id])",a,{})[0]+1;if(u==PROCESS_TYPE_SUBPROFILE){var f=library.getSubprofileSubprocessIds();S=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+f+"])",a,{})[0]+1}var v=replaceAll(l,"#SEQUENCE#",S),b=JSON.xpath("/subprocesses[_id eq '"+t+"']/dates/valid",a,{})[0],h="'"+b+"'",m=replaceAll(v,"#END_DATE#",h),O=replaceAll(m,"[.]","/");if(p.length>0){var x=JSON.xpath(O,d,{});r(x)}else{var x=JSON.xpath(O,d,{})[0];void 0!=e.indicator.addString&&""!=e.indicator.addString&&(x+=e.indicator.addString),r(x)}}else if(void 0!=e.system)r("ERROR: Unimplemented system type found.");else if(void 0!=e.variable)if(void 0!=e.variable.profile){var N=e.variable.profile,g=a.profile,I=g+":variables";dao.get(I).then(function(s){if(void 0!=e.variable.type)"count"==e.variable.type?r(s[e.variable.name].length):i("ERROR: Profile variables type implementation - Case not found");else{for(var o=s,n=""==N?[]:N.split(/['"\[\].]+/),c=0;c<n.length;c++)""!=n[c]&&(o=o[n[c]]);var d=o;if(void 0==d)i("Variable not found");else if("object"==typeof d){var p=function(){return new Promise(function(r,i){void 0!=e.variable.periodic&&void 0!=e.variable.periodic.value?getNodeValue(e.variable.periodic.value,a,t).then(function(e){r(e)}).catch(function(e){i(e)}):r("value")})};(function(){return new Promise(function(r,i){var s=0;if(void 0==e.variable.periodic||void 0==e.variable.periodic.seq){var o=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+t+"']/id]/type",a,{})[0];if(s=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id])",a,{})[0]+1,o==PROCESS_TYPE_SUBPROFILE){var n=library.getSubprofileSubprocessIds();s=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+n+"])",a,{})[0]+1}r(s)}else getNodeValue(e.variable.periodic.seq,a,t).then(function(e){r(e)}).catch(function(e){i(e)})})})().then(function(e){p().then(function(a){var t="/"+N+"["+e+"]/"+a,i=JSON.xpath(t,s,{})[0];r(i)}).catch(function(e){i(e)})}).catch(function(e){i(e)})}else"string"==typeof d&&r(d)}}).catch(function(e){i("ERROR: Profile variables not found")})}else if(void 0!=e.variable.subProfile){var N=e.variable.subProfile,q=app.profile.subprofileId;void 0!=e.variable.subprofileId&&""!=e.variable.subprofileId&&(q=e.variable.subprofileId);var I=q+":variables";dao.get(I).then(function(s){for(var o=s,n=""==N?[]:N.split(/['"\[\].]+/),c=0;c<n.length;c++)""!=n[c]&&(o=o[n[c]]);var d=o;if(void 0==d)i("Variable not found");else if("object"==typeof d){var p=0;if(void 0==e.variable.periodic||void 0==e.variable.periodic.seq){var l=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+t+"']/id]/type",a,{})[0];if(p=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id])",a,{})[0]+1,l==PROCESS_TYPE_SUBPROFILE){var u=library.getSubprofileSubprocessIds();p=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+u+"])",a,{})[0]+1}}else p=getNodeValue(e.variable.periodic.seq,a,t);var S="value";void 0!=e.variable.periodic&&void 0!=e.variable.periodic.value&&(S=getNodeValue(e.variable.periodic.value,a,t));var f="/"+N+"["+p+"]/"+S,v=JSON.xpath(f,s,{})[0];r(v)}else"string"==typeof d&&r(d)}).catch(function(e){i("ERROR: sub Profile variables not found")})}else i("ERROR: Unimplemented profile type found.");else if(void 0!=e.indicatorWrapper){var J=e.indicatorWrapper.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],_=replaceAll(e.indicatorWrapper.path,"[.]","/"),l="/"+_,E=JSON.xpath(l,d,{})[0];r(E)}else if(void 0!=e.calculated){for(var E="",P=e.calculated.separator,R=0;R<e.calculated.elements.length-1;R++){var y=e.calculated.elements,D=["fromRepeat","elementProperty","constantValue","elementWrapper","currentDate","randomDigits","profileObjectElement","profileObjectWrapper","currentFinancialYear","scopeVariable","xpath"];switch(propertyExists(y[R],D)){case"elementProperty":var J=y[R].elementProperty.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],_=replaceAll(y[R].elementProperty.elementId,"[.]","/"),l="/model/pending/data/"+J+"/"+_,k=JSON.xpath(l,d,{})[0];E=E+k+P;break;case"constantValue":var k=y[R].constantValue.value;E=E+k+P;break;case"scopeVariable":var A=y[R].scopeVariable,k="";"#USER_ID"==A?k=_lclx.SUBSCRIPTIONS.userId:"#USERNAME"==A?k=_lclx.SESSION.username:"#FIRSTNAME"==A?k=_lclx.SESSION.firstName:"#LASTNAME"==A&&(k=_lclx.SESSION.lastName),k.length>0&&(E=E+k+P);break;case"elementWrapper":var J=y[R].elementWrapper.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],_=replaceAll(y[R].elementWrapper.elementId,"[.]","/"),l="/"+_,k=JSON.xpath(l,d,{})[0];E=E+k+P;break;case"currentDate":E=E+formatDate(new Date)+P;break;case"randomDigits":var w=y[R].randomDigits.digits,U=Math.random(),V=Math.pow(10,w),W=U*V^0;E=E+W+P;break;case"profileObjectElement":var J=y[R].profileObjectElement.indicatorSetId,d=JSON.xpath("/indicators[category/term eq 'appProfile']",app.SCOPE.workflow,{})[0],_=replaceAll(y[R].profileObjectElement.elementId,"[.]","/"),l="/model/pending/data/"+J+"/"+_,k=JSON.xpath(l,d,{})[0];E=E+k+P;break;case"profileObjectWrapper":var J=y[R].profileObjectWrapper.indicatorSetId,d=JSON.xpath("/indicators[category/term eq 'appProfile']",app.SCOPE.workflow,{})[0],_=replaceAll(y[R].profileObjectWrapper.wrapperElementId,"[.]","/"),l="/"+_,k=JSON.xpath(l,d,{})[0];E=E+k+P;break;case"currentFinancialYear":var j=y[R].currentFinancialYear.startDate,F=y[R].currentFinancialYear.startMonth,M=(new Date).getFullYear()+"-"+F+"-"+j;E=E+M+P;break;case"fromRepeat":var J=y[R].fromRepeat.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],_=replaceAll(y[R].fromRepeat.path,"[.]","/"),l="/model/pending/data/"+J+"/"+_,Y="";if("validDate"==y[R].fromRepeat.filter){var T=JSON.xpath("/subprocesses[_id eq '"+t+"']",a,{})[0],C=T.dates.valid;Y="[enddate eq '"+C+"']/"}l=l+Y+replaceAll(y[R].fromRepeat.element,"[.]","/");var k=JSON.xpath(l,d,{})[0];E=E+k+P;break;case"xpath":if(void 0!=y[R].xpath.indicatorSetId&&y[R].xpath.indicatorSetId.length>0){var J=y[R].xpath.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],k=JSON.xpath(y[R].xpath.expr,d,{})[0];E=E+k+P;break}var k=JSON.xpath(y[R].xpath.expr,a,{})[0];E=E+k+P;break;default:i("No method found from implemented list.")}}var R=e.calculated.elements.length-1,y=e.calculated.elements,D=["fromRepeat","elementProperty","constantValue","elementWrapper","currentDate","randomDigits","profileObjectElement","profileObjectWrapper","currentFinancialYear","scopeVariable","xpath"];switch(propertyExists(y[R],D)){case"elementProperty":var J=y[R].elementProperty.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],_=replaceAll(y[R].elementProperty.elementId,"[.]","/"),l="/model/pending/data/"+J+"/"+_,k=JSON.xpath(l,d,{})[0];E+=k;break;case"constantValue":var k=y[R].constantValue.value;E+=k;break;case"scopeVariable":var A=y[R].scopeVariable,k="";"#USER_ID"==A?k=_lclx.SUBSCRIPTIONS.userId:"#USERNAME"==A?k=_lclx.SESSION.username:"#FIRSTNAME"==A?k=_lclx.SESSION.firstName:"#LASTNAME"==A&&(k=_lclx.SESSION.lastName),k.length>0&&(E+=k);break;case"elementWrapper":var J=y[R].elementWrapper.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],_=replaceAll(y[R].elementWrapper.elementId,"[.]","/"),l="/"+_,k=JSON.xpath(l,d,{})[0];E+=k;break;case"currentDate":E+=formatDate(new Date);break;case"randomDigits":var w=y[R].randomDigits.digits,U=Math.random(),V=Math.pow(10,w),W=U*V^0;E+=W;break;case"profileObjectElement":var J=y[R].profileObjectElement.indicatorSetId,d=JSON.xpath("/indicators[category/term eq 'appProfile']",app.SCOPE.workflow,{})[0],_=replaceAll(y[R].profileObjectElement.elementId,"[.]","/"),l="/model/pending/data/"+J+"/"+_,k=JSON.xpath(l,d,{})[0];E+=k;break;case"profileObjectWrapper":var J=y[R].profileObjectWrapper.indicatorSetId,d=JSON.xpath("/indicators[category/term eq 'appProfile']",app.SCOPE.workflow,{})[0],_=replaceAll(y[R].profileObjectWrapper.wrapperElementId,"[.]","/"),l="/"+_,k=JSON.xpath(l,d,{})[0];E+=k;break;case"currentFinancialYear":var j=y[R].currentFinancialYear.startDate,F=y[R].currentFinancialYear.startMonth,M=(new Date).getFullYear()+"-"+F+"-"+j;E+=M;break;case"fromRepeat":var J=y[R].fromRepeat.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],_=replaceAll(y[R].fromRepeat.path,"[.]","/"),l="/model/pending/data/"+J+"/"+_,Y="";if("validDate"==y[R].fromRepeat.filter){var T=JSON.xpath("/subprocesses[_id eq '"+t+"']",a,{})[0],C=T.dates.valid;Y="[enddate eq '"+C+"']/"}l=l+Y+replaceAll(y[R].fromRepeat.element,"[.]","/");var k=JSON.xpath(l,d,{})[0];E+=k;break;case"xpath":if(void 0!=y[R].xpath.indicatorSetId&&y[R].xpath.indicatorSetId.length>0){var J=y[R].xpath.indicatorSetId,n=JSON.xpath("/subprocesses[_id eq '"+t+"']/indicators[id eq '"+J+"']/instances/uuid",a,{})[0],d=JSON.xpath("/indicators[_id eq '"+n+"']",a,{})[0],k=JSON.xpath(y[R].xpath.expr,d,{})[0];E=E+k+P;break}var k=JSON.xpath(y[R].xpath.expr,a,{})[0];E=E+k+P;break;default:i("No method found from implemented list.")}r(E)}else if(void 0!=e.subProcess)if(void 0!=e.subProcess.path){for(var L=e.subProcess.path,B=L.split("."),Q="",R=0;R<B.length;R++)Q=Q+"['"+B[R]+"']";for(var c=JSON.xpath("/subprocesses[_id eq '"+t+"']",a,{})[0],z=c,G=""==Q?[]:Q.split(/['"\[\].]+/),H=0;H<G.length;H++)""!=G[H]&&(z=z[G[H]]);var E=z;r(E)}else e.subProcess.stepUser})}function replaceAll(e,a,t){return"function"!=typeof e.replace&&(console.log(a+" "+t),console.log(e)),e.replace(new RegExp(a,"g"),t)}function formatDate(e){return e.getDate()+"-"+(e.getMonth()+1)+"-"+e.getFullYear()}function compare(e,a,t){switch(a){case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t;case"==":return void 0==e&&(e=""),e===t;case"!=":return e!==t}}module.exports={getLanguageMessage:getLanguageMessage,getNodeValue:getNodeValue,compare:compare};

},{}],5:[function(require,module,exports){
"use strict";function getProcess(e,s,t){return new Promise(function(n,i){try{var c=[],r=[];t.instance.processes.filter(function(s){s.id==e&&(r=s)}),util.syncLoop(r.subProcesses.length,function(n){var o=n.iteration(),u=r.seq,f=r.subProcesses[o].id,a=r.subProcesses[o].seq;getSubProcess(e,u,f,a,s,t).then(function(e){c.push(e),n.next()},function(e){n.break(),i(e)})},function(){n(c)})}catch(e){i(e)}})}function getSubProcess(e,s,t,n,i,c){return new Promise(function(r,o){try{var u={id:"",seq:"",name:"",help:"",dates:"",step:""},f=[],a=[];c.instance.processes.filter(function(i){if(i.id==e&&i.seq==s){i.subProcesses.length;i.subProcesses.filter(function(e){e.id==t&&e.seq==n&&0==e.complete&&(f=e)})}}),c.config.processes.filter(function(s){s._id==e&&s.subProcesses.filter(function(e){e._id==t&&(a=e)})}),u.id=a._id,u.seq=f.seq,u.name=util.getName(a.name,i),u.help=util.getName(a.help,i),u.dates=f.dates,u.step=f.step,r(u)}catch(e){o(e)}})}function prepareNotificationScreen(){""}var util=require("utility");module.exports={getProcess:getProcess};

},{"utility":8}],6:[function(require,module,exports){
"use strict";function get(){return new Promise(function(e,t){})}module.exports={get:get};

},{}],7:[function(require,module,exports){
"use strict";function count(e){return void 0!==e?e.length:0}function preRequisites(e,s,t){return new Promise(function(i,n){var o=[];try{util.syncLoop(e.length,function(i){var a=i.iteration();preRequisite(e[a],s,t).then(function(e){o.push(!0),i.next()},function(e){o.push(!1),i.break(),n(e)})},function(){if(o.every(Boolean)){var e=util.success("Pre-requisites completed successfully.",{});i(e)}else{var s=util.error("WFPreRequisiteError","Not all pre-requisites passed.");n(s)}})}catch(e){n(e)}})}function preRequisite(e,s,t){return new Promise(function(i,n){if(void 0!=e.check.numberProcessInstances){var o=e.check.numberProcessInstances,a=o.operator;switch(a){case"greaterThan":"gt";break;case"lessThan":"lt";break;case"greaterThanEqual":"ge";break;case"lessThanEqual":"le";break;case"equalTo":"eq";break;case"notEqualTo":"ne"}var r=o.subProcessId,c=o.type,u="";u="all"==c?"":"[complete eq 'true']";var d="";void 0!=o.filter&&o.filter.length>0&&(d="["+o.filter+"]");var l="count(/instance/processes/subProcesses[id eq '"+r+"']"+u+d+")",p=JSON.xpath("/config/processes/subProcesses[_id eq '"+r+"']/type",s,{})[0],f=library.getSubprofileSubprocessIds();void 0!=app.profile.subprofileId&&""!=app.profile.subprofileId&&void 0!=p&&p==PROCESS_TYPE_SUBPROFILE&&(l="count(/instance/processes/subProcesses[id eq '"+r+"' and uuid = "+f+"]"+u+")");var m=JSON.xpath(l,s,{})[0],h=e.check.numberProcessInstances.count;if(util.compare(m,e.check.numberProcessInstances.operator,parseInt(h))){var g=util.success("Pre-requisites passed.",{});i(g)}else{var v=helper.getLanguageMessage(e.message),S=util.error("WFPreRequisiteError",v);n(S)}}else if(void 0!=e.check.variable){var I=e.check.variable.scope,N="";if("profile"==I){var b=s.profile;N=b+":variables"}else if("subProfileSubProcessInstance"==I){var y=app.profile.subprofileId;N=y+":variables"}else n("ERROR: Scope '"+I+"' not implemented in pre-requisites");dao.get(N).then(function(o){for(var a=e.check.variable.name,r=e.check.variable.type,c=o,u=""==a?[]:a.split(/['"\[\].]+/),d=0;d<u.length;d++)""!=u[d]&&(c=c[u[d]]);var l,p=c,f=e.check.variable.value.data,m=e.check.variable.value.dataType.dataType;if(void 0==p&&(p="date"==m?"2000-01-01":""),void 0!=r&&"array"==r)l=p;else if("object"==typeof p){var h=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+t+"']/id]/type",s,{})[0],g=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id])",s,{})[0]+1;if(h==PROCESS_TYPE_SUBPROFILE){var v=library.getSubprofileSubprocessIds();g=JSON.xpath("count(/instance/processes/subProcesses[id = /subprocesses[_id eq '"+t+"']/id and uuid = "+v+"])",s,{})[0]+1}var S="/"+a+"["+g+"]/value";l=JSON.xpath(S,o,{})[0]}else"string"==typeof p&&(l=p);if("#VALID_DATE"==f){var I=JSON.xpath("/subprocesses[_id eq '"+t+"']",s,{})[0];void 0!=I&&(f=I.dates.valid)}if(0==f.indexOf("xpath:")){var N=f.substring(6);f=JSON.xpath(N,s,{})[0]}if("#VALID_DATE"==f){var I=JSON.xpath("/subprocesses[_id eq '"+t+"']",s,{})[0];void 0!=I&&(f=I.dates.valid)}var c;if("number"==m?c=Number(f):"string"==m?c=f:"integer"==m?(c=parseInt(f),void 0!=r&&"array"==r&&(l=void 0==l?0:l.length)):"decimal"==m?c=parseFloat(f):"date"!=m&&"dateTime"!=m||(c=f),void 0==l&&void 0!=e.check.variable.allowBlank&&1==e.check.variable.allowBlank){var b=util.success("Variable Pre-requisites passed.",{});i(b)}else{if(util.compare(l,e.check.variable.operator,c)){var b=util.success("Variable Pre-requisites passed.",{});i(b)}else{var y=helper.getLanguageMessage(e.message);y=y.replace("#VALID_DATE",l);var P=util.error("WFPreRequisiteError",y);n(P)}}}).catch(function(s){if(void 0!=e.check.variable.allowBlank&&1==e.check.variable.allowBlank){var t=util.success("Variable Pre-requisites passed.",{});i(t)}else{var o=helper.getLanguageMessage(e.message);o=o.replace("#VALID_DATE",w);var s=util.error("WFPreRequisiteError",o);n(s)}}).catch(function(s){var t=helper.getLanguageMessage(e.message);t=t.replace("#VALID_DATE",w);var s=util.error("WFPreRequisiteError:",t);n(s)})}else if(void 0!=e.check.indicator){var P=(e.check.indicator.operator,e.check.indicator.setId),_=e.check.indicator.field,I=e.check.indicator.scope,O={};if("profile"==I)s.indicators.forEach(function(e){e.category.term==P&&(O=e)});else if("subProcess"==I){var T={};s.subprocesses.forEach(function(e){e._id==t&&(T=e)});var q="";T.indicators.forEach(function(e){e.id==P&&(q=e.instances[0].uuid)}),s.indicators.forEach(function(e){e._id==q&&(O=e)})}else n("ERROR: Scope '"+I+"' not implemented in pre-requisites");var x=_.split("."),k=function(e,s,t){if(s.length==t)return e;var i=s[t];return k(e[i],s,t+1)},U=O.model.pending.data[P],w=k(U,x,0);helper.getNodeValue(e.check.indicator.data,s,t).then(function(s){if(util.compare(w,e.check.indicator.operator,s)){var t=util.success("Variable Pre-requisites passed.",{});i(t)}else{var o=helper.getLanguageMessage(e.message);o=o.replace("#VALID_DATE",w);var a=util.error("WFPreRequisiteError",o);n(a)}},function(e){n("ERROR: getNodeValue returned error")})}else{var S=util.error("WFPreRequisiteError","Pre-requisite type not defined.");n(S)}})}function preActions(e,s,t){return new Promise(function(i,n){var o=[];try{var a=JSON.xpath("/subprocesses[_id eq '"+t+"']",s,{})[0],r=a["meta-data"].processConfigId,c=a["meta-data"].subProcessConfigId,u=a["meta-data"].subProcessInsSeq,d=a["meta-data"].subProcessInsSeq,l=JSON.xpath("/processes[_id eq '"+r+"']/subProcesses[_id eq '"+c+"']",s.config,{})[0],p=JSON.xpath("/subprocesses[_id eq '"+t+"']/step",s,{})[0];util.syncLoop(e.length,function(i){var a=i.iteration();action(e[a],r,u,c,d,l,p,s,{},t).then(function(e){o.push(!0),i.next()},function(e){o.push(!1),i.break(),n(e)})},function(){if(o.every(Boolean)){var e=util.success("Pre-actions completed successfully.",{});i(e)}else{var s=util.error("WFPreRequisiteError","Not all pre-actions passed.");n(s)}})}catch(e){n(e)}})}function getSubProcess(e,s){if(void 0==s.subprocesses)return[];s.subprocesses.filter(function(s){if(s.id==e)return s})}function subProcess(e,s,t,i,n,o,a,r){var c=[],u=[],d=[];r.subprocesses.filter(function(s){s._id==e&&(c=s)}),r.config.processes.filter(function(e){e._id==s&&(u=e,e.subProcesses.filter(function(e){e._id==i&&(d=e)}))});var l="",p=a.baseUUID,f=0;if(void 0!=p&&""!=p&&p.length>0){var m=JSON.xpath("/subprocesses[_id eq '"+p+"']",r,{})[0];l=m.groupKey,f=m["meta-data"].subProcessInsSeq}else{for(var h="",g=0;g<d.indicators.length-1;g++)h=h+"'"+d.indicators[g]._id+"',";h=h+"'"+d.indicators[g]._id+"'";var v=JSON.xpath("/indicators[setId = ("+h+") and cardinality eq 'single']",app.SCOPE.APP_CONFIG,{}).length;if(void 0!=d.instanceType.newSequence||v>0){var m=JSON.xpath("/instance/processes[id eq '"+s+"']",r,{})[0];l=void 0!=m&&m.subProcesses.length>0?m.subProcesses[0].groupKey:generateUUID()}else l=generateUUID();f=JSON.xpath("count(/processes/subProcesses[groupKey eq '"+l+"'])",r.instance,{})[0]}var S=a.label,I=e,N={_id:I,id:i,type:"workflowInstanceSubProcess",dateTimeCreated:moment().format(),dueDateTime:moment().format(),seq:n,initiated:!1,dates:{created:"",valid:"",start:"",due:"",closed:""},complete:!1,indicators:[],step:{},active:!0,groupKey:l,label:S,channels:["community_"+app.SCOPE.getCommunityId(),"profile_"+app.SCOPE.profileId,"application_"+app.SCOPE.applicationId,"community_"+app.SCOPE.getCommunityId()+"_application_"+app.SCOPE.applicationId],history:[],"meta-data":{applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.profileId,subprofileId:void 0==o?"":o,processConfigId:s,subProcessConfigId:i,subProcessInsSeq:f+1},messages:[],spStatus:""};return void 0!=a.validDate&&a.validDate.length>0&&(void 0!=d.periodType.periodic?N.dates.valid=moment(a.validDate).endOf("month").format("YYYY-MM-DD"):N.dates.valid=a.validDate),void 0!=app.profile.subprofileId&&""!=app.profile.subprofileId?(N.channels.push("profile_"+app.SCOPE.profileId+"_subprofile_"+app.profile.subprofileId),N.channels.push("subprofile_"+app.profile.subprofileId)):(N.channels.push("profile_"+app.SCOPE.profileId+"_subprofile_0"),N.channels.push("subprofile_0")),r.subprocesses.push(N),new Promise(function(e,o){try{preActions(u.preActions,r,I).then(function(l){preRequisites(u.prerequisites,r,I).then(function(u){initiate(d.initiate,c,a).then(function(c){N.initiated=c.data.initiated,N.dates=c.data.dates;var u=d.steps[0]._id;d.steps[0].transition[0]._id,step(s,t,i,n,u,1,a,r,I).then(function(s){N.step=s.data,indicators(d.indicators,r,N._id).then(function(s){N.indicators=s.data;var t=util.success(s.message,N);e(t)},function(e){o(e)})},function(e){console.log(e),o(e)})},function(e){r.subprocesses=r.subprocesses.filter(function(e){return!(e._id==I)}),o(e)})},function(e){r.subprocesses=r.subprocesses.filter(function(e){return!(e._id==I)}),o(e)})},function(e){r.subprocesses=r.subprocesses.filter(function(e){return!(e._id==I)}),o(e)})}catch(e){o(e)}})}function initiate(e,s,t){var i={initiated:!1,dates:{created:"",valid:"",start:"",due:"",closed:""}};return new Promise(function(n,o){var a=function(){if(void 0!=e.user){i.dates.created=t.createdDate,"userSelected"!=e.user.validDate._type&&"autoSelected"!=e.user.validDate._type||(void 0!=t.validDate?i.dates.valid=t.validDate:i.dates.valid=(new Date).toISOString().substring(0,10)),"userSelected"!=e.user.dueDate._type&&"autoSelected"!=e.user.dueDate._type||void 0!==t.dueDate&&(i.dates.due=t.dueDate),i.dates.start=t.firstDate,i.initiated=!0;var s=util.success("Sub-Process initiate completed successfully.",i);n(s)}else if(void 0!=e.auto);else{var a=util.error("WFInitiateError","Initiate type: "+e._type+" not defined.");o(a)}};if(void 0==s.complete)a();else if(!s.complete)if(e.parallelInstances)a();else{var r=util.error("WFInitiateError","Sub-process: "+s.id+" still active and parallel instances are not allowed.");o(r)}})}function step(e,s,t,i,n,o,a,r,c){var u,d={key:generateUUID(),id:"",seq:"",status:"",message:"",assignedTo:{userId:"",name:"",dateTime:"",type:"",dueDateTime:"",by:""},assignmentHistory:[],dateTimeCreated:moment().format(),dueDateTime:moment().format(),transition:{transitionId:"",dateTime:"",userId:""},assignment:{},comment:""},l={},p="",f={};return new Promise(function(m,h){try{r.subprocesses.filter(function(e){e._id==app.SCOPE.processUUID&&(u=e)}),r.config.processes.filter(function(s){s._id==e&&s.subProcesses.filter(function(e){e._id==t&&(l=e,e.steps.filter(function(e){e._id==n&&(f=e)}))})}),d.id=n,d.seq=o;var g="";void 0!=f.setInstanceStatusTo.NotStarted?g="NotStarted":void 0!=f.setInstanceStatusTo.Created?g="Created":void 0!=f.setInstanceStatusTo.InProgress?g="InProgress":void 0!=f.setInstanceStatusTo.Submitted?g="Submitted":void 0!=f.setInstanceStatusTo.Complete&&(g="Complete");var v=service.getLanguage();d.status=g,d.message=f.setInstanceStatusTo[g].label.i18n[v],void 0==d.message&&(d.message=f.setInstanceStatusTo[g].label.i18n.en),d.comment=void 0!==a.comment?a.comment:"";var S=void 0!==u?u.indicators:[],I=function(e,s){var t=d.assignedTo;if(e.length>0)for(var i=0;i<e.length;i++){var n=e[i],o=n.instances[0].uuid,a=JSON.xpath("/indicators[_id eq '"+o+"']",s,{})[0];n.instances[0].seq=a.model.pending.seq;for(var r=0;r<a.workflows.length;r++)void 0!=a.workflows[r].processes[0]&&void 0!=a.workflows[r].processes[0].subProcessUUID&&void 0!=a.workflows[r].processes[0].step&&c==a.workflows[r].processes[0].subProcessUUID&&(a.workflows[r].processes[0].step.assignedTo=t)}},N=function(e){JSON.xpath("/subprocesses[_id eq '"+e+"']",r,{})[0].spStatus=""};indicatorDocs(e,S,d,r,c).then(function(o){p=c,void 0!=f.function.actions?actions(f.function.actions,e,s,t,i,l,d,r,a,c).then(function(o){var u=d.assignedTo;u.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,u.userId=_lclx.SUBSCRIPTIONS.userId+"",u.dateTime=moment().format(),u.type=ASSIGNMENT_TYPE_AUTO,u.dueDateTime="",u.by=_lclx.SUBSCRIPTIONS.userId+"",I(S,r);var l=f.transition[0]._id;transition(e,s,t,i,n,l,a,r,c,d).then(function(e){var s=util.success("Transition completed successfully.",e.data.step);m(s)},function(e){h(e)})},function(e){console.log(e),h(e)}):void 0!=f.function.task?task(e,s,f.function.task,c,d).then(function(e){I(S,r);var s=util.success("Task awaiting user action.",d);m(s)},function(e){h(e)}):void 0!=f.function.server&&(N(c),server(f.function.server,e,s,t,i,l,d,r,a,c).then(function(e){I(S,r);var s=util.success("Server awaiting server response.",d);m(s)},function(e){h(e)}))},function(e){h(e)})}catch(e){h(e)}})}function indicators(e,s,t){var i=[];return new Promise(function(e,n){try{for(var o=JSON.xpath("indicators[fn:count(./workflows/processes[subProcessUUID eq '"+t+"']) gt 0]",s,{}),a=0;a<o.length;a++){var r=o[a],c={id:"",instances:[]},u={uuid:"",title:"",key:"",seq:1,rev:""};c.id=r.category.term,u.uuid=r._id,u.rev=r._rev,u.title=r.title,u.key="",u.seq=r.model.pending.seq,c.instances.push(u),i.push(c)}e(util.success("Process indicator model updated.",i))}catch(e){n(e)}})}function assignUser(e,s,t,i,n,o,a){return new Promise(function(s,t){try{a.subprocesses.filter(function(t){if(t._id==o){void 0==t.step.assignmentHistory&&(t.step.assignmentHistory=[]),""!=t.step.assignedTo.userId&&""!=t.step.assignedTo.name&&t.step.assignmentHistory.push(JSON.parse(JSON.stringify(t.step.assignedTo))),t.step.assignedTo.userId=n.id,t.step.assignedTo.name=n.name,t.step.assignedTo.dateTime=moment().format(),t.step.assignedTo.type=ASSIGNMENT_TYPE_REASSIGNMENT,t.step.assignedTo.dueDateTime="",t.step.assignedTo.by=_lclx.SUBSCRIPTIONS.userId+"";for(var i=t.indicators,r=0;r<i.length;r++)for(var c=i[r],u=0;u<c.instances.length;u++)for(var d=c.instances[u],l=0;l<a.indicators.length;l++){var p=a.indicators[l];d.uuid==p._id&&p.workflows.filter(function(s){s.processes.filter(function(s){s.id==e&&(s.step.assignedTo.userId=n.id,s.step.assignedTo.name=n.name)})})}var f=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=f&&void 0!=f.reAssignment)if("string"==typeof f.reAssignment){var m=f.reAssignment;dao.getConfig(m).then(function(e){f.reAssignment=e,actionsModule.notification.reAssignmentNotification(f,a,o,n).then(function(e){var e=util.success('User assigned successfully. UserId: "'+n.id+'", Name: "'+n.name+'"',t);s(e)}).catch(function(e){s(e)})}).catch(function(e){s(e)})}else actionsModule.notification.reAssignmentNotification(f,a,o,n).then(function(e){var e=util.success('User assigned successfully. UserId: "'+n.id+'", Name: "'+n.name+'"',t);s(e)}).catch(function(e){s(e)});else{var h=util.success('User assigned successfully. UserId: "'+n.id+'", Name: "'+n.name+'"',t);s(h)}}})}catch(e){t(e)}})}function indicatorDocs(e,s,t,i,n){return new Promise(function(e,o){try{if(void 0==s){util.error("WFIndicatorsUpdate","Indicators parameter is required. - Value: "+s);o(err)}else{for(var a=0;a<s.length;a++)for(var r=s[a],c=0;c<r.instances.length;c++)for(var u=r.instances[c],d=0;d<i.indicators.length;d++){var l=i.indicators[d];u.uuid==l._id&&l.workflows.filter(function(e){e.processes.filter(function(e){e.subProcessUUID==n&&(e.step.id=t.id,e.step.seq=t.seq,e.step.status=t.status,e.step.message=t.message,e.step.assignedTo.userId=t.assignedTo.userId,e.step.assignedTo.name=t.assignedTo.name,e.step.comment=void 0!==t.comment?t.comment:"")})})}e(util.success("Indicator documents workflow process model updated.",i))}}catch(e){o(e)}})}function actions(e,s,t,i,n,o,a,r,c,u){var d=[];return new Promise(function(l,p){util.syncLoop(e.length,function(l){var f=l.iteration();action(e[f],s,t,i,n,o,a,r,c,u).then(function(s){var t={id:e[f]._id,seq:f,data:s};d.push(t),l.next()},function(e){l.break(),p(e)})},function(){var e=util.success("Actions completed successfully.",d);l(e)})})}function action(e,s,t,i,n,o,a,r,c,u){return new Promise(function(i,d){if(void 0!=e.method){var l=["form","indicator","profile","subProcessInstance","step","community","application","user","sdo","performance","taxonomy","variables","notification","report","worker","participants","generalFunctions"];switch(propertyExists(e.method,l)){case"form":if(void 0!=e.method.form.create){var p=[];p.push(s),p.push(o),p.push(a),p.push(e),p.push(t),p.push(n),p.push(r),p.push(c.createType),p.push(u),p.push(c.baseUUID),p.push(c),form.create(p).then(function(e){i(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.authorise){var p=[];p.push(s),p.push(o),p.push(t),p.push(n),p.push(r),p.push(c.createType),p.push(u),p.push(c.baseUUID),p.push(c),form.authorise(p).then(function(e){i(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.undraft){var p=[];p.push(r),p.push(c.createType),p.push(u),p.push(c.baseUUID),p.push(c),form.setUnDraft(p).then(function(e){i(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.draft){var p=[];p.push(r),p.push(c.createType),p.push(u),p.push(c.baseUUID),p.push(c),form.setDraft(p).then(function(e){i(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.close){var p=[];p.push(o.indicators),p.push(r),p.push(c.createType),p.push(u),p.push(c.baseUUID),p.push(c),form.close(p).then(function(e){i(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.authoriseAndCreateNewSeq){var p=[];p.push(s),p.push(o),p.push(t),p.push(n),p.push(r),p.push(c.createType),p.push(u),p.push(c.baseUUID),p.push(c),form.authorise(p).then(function(l){var p=[];p.push(s),p.push(o),p.push(a),p.push(e),p.push(t),p.push(n),p.push(r),p.push(c.createType),p.push(u),p.push(u),p.push(c),form.create(p).then(function(e){i(e.data)},function(e){d(e)})},function(e){d(e)})}else if(void 0!=e.method.form.createNewSeq){var p=[];p.push(s),p.push(o),p.push(a),p.push(e),p.push(t),p.push(n),p.push(r),p.push(c.createType),p.push(u),p.push(u),p.push(c),form.create(p).then(function(e){i(e.data)},function(e){d(e)})}break;case"indicator":if(void 0!=e.method.indicator.create)i("Not implemented");else if(void 0!=e.method.indicator.instantiate)i("Not implemented");else if(void 0!=e.method.indicator.setValue){var f=e.method.indicator.setValue.path;helper.getNodeValue(e.method.indicator.setValue.data,r,u).then(function(e){var s=[];s.push(r),s.push(u),s.push(f),s.push(e),form.updateIndicator(s).then(function(e){i(e.data)},function(e){d(e)})},function(e){d(e)})}else if(void 0!=e.method.indicator.updateStatus){var m=e.method.indicator.indicatorSetId,p=[];if(p.push(r),p.push(u),void 0!=e.method.indicator.updateStatus){var h=e.method.indicator.updateStatus;p.push(h),p.push(m),form.markUpdateIndicator(p).then(function(e){i(e.data)},function(e){d(e)})}else i("Action indicator sub type not found.")}else if(void 0!=e.method.indicator.setWrapperElement){var f=e.method.indicator.setWrapperElement.path,m=e.method.indicator.setWrapperElement.indicatorSetId;helper.getNodeValue(e.method.indicator.setWrapperElement.data,r,u).then(function(e){var s=[];s.push(r),s.push(u),s.push(f),s.push(e),s.push(m),form.updateIndicatorWrapper(s).then(function(e){i(e.data)},function(e){d(e)})},function(e){d(e)})}break;case"profile":if(void 0!=e.method.profile.create){var p=[];p.push(s),p.push(r),p.push(c.createType),p.push(u),p.push(c.baseUUID),p.push(c),form.createProfile(p).then(function(e){i(e.data)},function(e){d(e)})}else if(void 0!=e.method.profile.setStatusTo){var p=[],h=e.method.profile.setStatusTo;p.push(r),p.push(u),p.push(h),form.setStatus(p).then(function(e){i(e.data)},function(e){d(e)})}else void 0!=e.method.profile.setProfileStatus?helper.getNodeValue(e.method.profile.setProfileStatus.value,r,u).then(function(s){dao.setProfileStatus(e.method.profile.setProfileStatus.key,s),i({})},function(e){d(e)}):void 0!=e.method.profile.setSubprofileStatus&&helper.getNodeValue(e.method.profile.setSubprofileStatus.value,r,u).then(function(s){dao.setSubprofileStatus(e.method.profile.setSubprofileStatus.key,s),i({})},function(e){d(e)});break;case"subProcessInstance":var g=["instantiate","authorise","close","setVariable","setStatusTo","setStatusMsgTo","setTitle","setValidDate","setSPStatus"];switch(propertyExists(e.method.subProcessInstance,g)){case"setTitle":helper.getNodeValue(e.method.subProcessInstance.setTitle,r,u).then(function(s){actionsModule.subProcessInstance.setTitle(e.method.subProcessInstance.setTitle,u,s,r).then(function(e){i(e.data)},function(e){d(e)})},function(e){d(e)});break;case"setValidDate":helper.getNodeValue(e.method.subProcessInstance.setValidDate,r,u).then(function(s){actionsModule.subProcessInstance.setValidDate(e.method.subProcessInstance.setValidDate,u,s,r).then(function(e){i(e.data)},function(e){d(e)})},function(e){d(e)});break;case"setSPStatus":helper.getNodeValue(e.method.subProcessInstance.setSPStatus,r,u).then(function(s){actionsModule.subProcessInstance.setSPStatus(e.method.subProcessInstance.setSPStatus,u,s,r).then(function(e){i(e.data)},function(e){d(e)})},function(e){d(e)});break;default:d("No method found from implemented list in subprocess action.")}break;case"step":break;case"community":var v=["createCommunity","releaseAdoptedApplication","userJoinCommunity"];switch(propertyExists(e.method.community,v)){case"createCommunity":return actionsModule.community.createCommunity(e.method.community.createCommunity,u,r).then(function(e){i(e.data)},function(e){d(e)});case"releaseAdoptedApplication":return actionsModule.community.releaseAdoptedApplication(e.method.community.releaseAdoptedApplication,u,r).then(function(e){i(e.data)},function(e){d(e)});case"userJoinCommunity":return actionsModule.community.userJoinCommunity(e.method.community.userJoinCommunity,u,r).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"application":var S=["createAppDefinition","buildApplication","applicationAdoption"];switch(propertyExists(e.method.application,S)){case"createAppDefinition":return actionsModule.application.createAppDefinition(e.method.application.createAppDefinition,u,r).then(function(e){i(e.data)},function(e){d(e)});case"buildApplication":return actionsModule.application.buildApplication(e.method.application.buildApplication,u,r).then(function(e){i(e.data)},function(e){d(e)});case"applicationAdoption":return actionsModule.application.applicationAdoption(e.method.application.applicationAdoption,u,r).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"user":var I=["addToRole"];switch(propertyExists(e.method.user,I)){case"addToRole":return actionsModule.user.addToRole(e.method.user.addToRole,u,r).then(function(e){i(e.data)},function(e){d(e)})}break;case"sdo":var N=["create","enrollCourse"];switch(propertyExists(e.method.sdo,N)){case"create":return actionsModule.sdo.create(e.method.sdo.create,u,r).then(function(e){i(e.data)},function(e){d(e)});case"enrollCourse":return actionsModule.sdo.enrollCourse(e.method.sdo.enrollCourse,u,r).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"performance":var b=["unlockPeriod","lockPerformanceModel","setModelStatus"];switch(propertyExists(e.method.performance,b)){case"unlockPeriod":return actionsModule.performance.unlockPeriod(e.method.performance.unlockPeriod,u,r).then(function(e){i(e.data)},function(e){d(e)});case"setModelStatus":return actionsModule.performance.setModelStatus(e.method.performance.setModelStatus,u,r).then(function(e){i(e.data)},function(e){d(e)});case"lockPerformanceModel":return actionsModule.performance.lockPerformanceModel(e.method.performance.lockPerformanceModel,u,r).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"taxonomy":var y=["create"];switch(propertyExists(e.method.taxonomy,y)){case"create":return actionsModule.taxonomy.create(e.method.taxonomy.create,u,r).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"variables":var P=["setVariable"];switch(propertyExists(e.method.variables,P)){case"setVariable":return actionsModule.variables.setVariable(e.method.variables.setVariable,r,u).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"notification":if("string"==typeof e.method.notification){var _=e.method.notification;dao.getConfig(_).then(function(s){e.method.notification=s,actionsModule.notification.sendNotificationWorker(e.method.notification,r,u).then(function(e){i(e.data)},function(e){d(e)})}).catch(function(e){i(e)})}else actionsModule.notification.sendNotificationWorker(e.method.notification,r,u).then(function(e){i(e.data)},function(e){d(e)});break;case"report":var O=["createPerformanceReport","createReport","sdoReport","executeReport","requestReport","generateView","generateBasicView","generateUnionView","sdoReportMultiple","subprofileQuarterlyReport"];switch(propertyExists(e.method.report,O)){case"createPerformanceReport":return actionsModule.report.createPerformanceReport(e.method.report.createPerformanceReport,r,u).then(function(e){i(e.data)},function(e){d(e)});case"createReport":return actionsModule.report.createReport(e.method.report.createReport,r,u).then(function(e){i(e.data)},function(e){d(e)});case"sdoReport":return actionsModule.report.sdoReport(e.method.report.sdoReport,r,u).then(function(e){i(e.data)},function(e){d(e)});case"executeReport":return actionsModule.report.executeReport(e.method.report.executeReport,r,u).then(function(e){i(e.data)},function(e){d(e)});case"generateView":return actionsModule.report.generateView(e.method.report.generateView,r,u).then(function(e){i(e.data)},function(e){d(e)});case"requestReport":return actionsModule.report.requestReport(e.method.report.requestReport,r,u).then(function(e){i(e.data)},function(e){d(e)});case"generateBasicView":return actionsModule.report.generateBasicView(e.method.report.generateBasicView,r,u).then(function(e){i(e.data)},function(e){d(e)});case"generateUnionView":return actionsModule.report.generateUnionView(e.method.report.generateUnionView,r,u).then(function(e){i(e.data)},function(e){d(e)});case"sdoReportMultiple":return actionsModule.report.sdoReportMultiple(e.method.report.sdoReportMultiple,r,u).then(function(e){i(e.data)},function(e){d(e)});case"subprofileQuarterlyReport":return actionsModule.report.subprofileQuarterlyReport(e.method.report.subprofileQuarterlyReport,r,u).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"worker":var T=["sendWorker","executeLocal","create"];switch(propertyExists(e.method.worker,T)){case"sendWorker":return actionsModule.worker.sendWorker(e.method.worker.sendWorker,r,u).then(function(e){i(e.data)},function(e){d(e)});case"executeLocal":return actionsModule.worker.executeLocal(e.method.worker.executeLocal,r,u).then(function(e){i(e.data)},function(e){d(e)});case"create":return actionsModule.worker.create(e.method.worker.create,r,u).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"participants":var q=["linkParticipants","monthlyAttendance","monthlyProgressSummary","participantContracts"];switch(propertyExists(e.method.participants,q)){case"linkParticipants":return actionsModule.participants.linkParticipants(e.method.participants.linkParticipants,r,u).then(function(e){i(e.data)},function(e){d(e)});case"monthlyAttendance":return actionsModule.participants.monthlyAttendance(e.method.participants.monthlyAttendance,r,u).then(function(e){i(e.data)},function(e){d(e)});case"monthlyProgressSummary":return actionsModule.participants.monthlyProgressSummary(e.method.participants.monthlyProgressSummary,r,u).then(function(e){i(e.data)},function(e){d(e)});case"participantContracts":return actionsModule.participants.participantContracts(e.method.participants.participantContracts,r,u).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"generalFunctions":var x=["addToFavourites","addToUserFavourites"];switch(propertyExists(e.method.generalFunctions,x)){case"addToFavourites":return actionsModule.generalFunctions.addToFavourites(e.method.generalFunctions.addToFavourites,r,u).then(function(e){i(e.data)},function(e){d(e)});case"addToUserFavourites":return actionsModule.generalFunctions.addToUserFavourites(e.method.generalFunctions.addToUserFavourites,r,u).then(function(e){i(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;default:d("method not defined in configuration")}}else d("No method found from implemented list.")})}function task(e,s,t,i,n){return new Promise(function(s,o){var a=app.SCOPE.workflow;preActions(t.preActions,a,i).then(function(r){var c=[];if(void 0!=t.assign.role){var u=a.profile,d="",l=function(){var r=t.assign.role.roleId;library.getUsersFromProfileRole(d,r).then(function(o){if(void 0!=o)if(o.length>1){for(var r=!1,c=0;c<o.length;c++)o[c].id,_lclx.SUBSCRIPTIONS.userId==o[c].id&&(r=!0);if(r){void 0==n.assignmentHistory&&(n.assignmentHistory=[]);var u=n.assignedTo;if(""!=u.userId&&""!=u.name){var l=JSON.parse(JSON.stringify(u));n.assignmentHistory.push(l)}u.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,u.userId=_lclx.SUBSCRIPTIONS.userId+"",u.dateTime=moment().format(),u.type=ASSIGNMENT_TYPE_AUTO,u.dueDateTime="",u.by=_lclx.SUBSCRIPTIONS.userId+"";var p=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=p&&void 0!=p.assignment){var f={id:_lclx.SUBSCRIPTIONS.userId,name:_lclx.SUBSCRIPTIONS.username};if("string"==typeof p.assignment){var m=p.assignment;dao.getConfig(m).then(function(e){p.assignment=e,actionsModule.notification.assignmentNotification(p,a,i,f).then(function(e){console.log('User assigned successfully. UserId: "'+f.id+'", Name: "'+f.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+f.id+'", Name: "'+f.name+'"')})}).catch(function(e){s(e)})}else actionsModule.notification.assignmentNotification(p,a,i,f).then(function(e){console.log('User assigned successfully. UserId: "'+f.id+'", Name: "'+f.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+f.id+'", Name: "'+f.name+'"')})}}var h="";if(void 0!=t.assign.assignment){var h=n.assignment,g={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};h.accept=g,h.message=_getNameByLang(t.assign.assignment.message.i18n);var v={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};h.reject=v;var S={profileId:d,type:"user",userId:o};h.value=S,h.profileRoleId=d}if(r){var I=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+i+"']/id",a,{})[0],N=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+i+"']/id",a,{})[0],b=JSON.xpath("/subprocesses[_id eq '"+i+"']/step/id",a,{})[0];if(JSON.xpath("/processes[_id eq '"+I+"']/subProcesses[_id eq '"+N+"']/steps[_id eq '"+b+"']",a.config,{})[0],void 0!=t.preWorkActions){var y=t.preWorkActions;preWorkActions(y,a).then(function(e){s("Assignment is made. Pre work actions found and executed ")},function(e){v(e)})}else s("Assignment is made. No pre work actions found. ")}else{var p=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=p&&void 0!=p.assignmentAcceptance){var f={id:_lclx.SUBSCRIPTIONS.userId,name:_lclx.SUBSCRIPTIONS.username};actionsModule.notification.acceptanceNotificationExternal(p,a,i,o).then(function(e){s("Notifications request submitted for acceptance.")}).catch(function(e){s("Notifications failed"),console.log('User assignment notification failed to user UserId: "'+f.id+'", Name: "'+f.name+'"')})}else s("Notifications not found")}}else if(1==o.length){var P=o[0].id,_=o[0].name;void 0==n.assignmentHistory&&(n.assignmentHistory=[]);var u=n.assignedTo;if(""!=u.userId&&""!=u.name){var l=JSON.parse(JSON.stringify(u));n.assignmentHistory.push(l)}u.name=_+"",u.userId=P+"",u.dateTime=moment().format(),u.type=ASSIGNMENT_TYPE_AUTO,u.dueDateTime="",u.by=_lclx.SUBSCRIPTIONS.userId+"";var h="";if(void 0!=t.assign.assignment){var h=n.assignment,g={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)}
;h.accept=g,h.message=_getNameByLang(t.assign.assignment.message.i18n);var v={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};h.reject=v;var S={profileId:d,userId:o,type:"user"};h.value=S,h.profileRoleId=d}var p=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=p&&void 0!=p.assignment){var f={id:P,name:_};if("string"==typeof p.assignment){var m=p.assignment;dao.getConfig(m).then(function(e){p.assignment=e,actionsModule.notification.assignmentNotification(p,a,i,f).then(function(e){console.log('User assigned successfully. UserId: "'+f.id+'", Name: "'+f.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+f.id+'", Name: "'+f.name+'"')})}).catch(function(e){s(e)})}else actionsModule.notification.assignmentNotification(p,a,i,f).then(function(e){console.log('User assigned successfully. UserId: "'+f.id+'", Name: "'+f.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+f.id+'", Name: "'+f.name+'"')})}var I=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+i+"']/id",a,{})[0],N=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+i+"']/id",a,{})[0],b=JSON.xpath("/subprocesses[_id eq '"+i+"']/step/id",a,{})[0];if(JSON.xpath("/processes[_id eq '"+I+"']/subProcesses[_id eq '"+N+"']/steps[_id eq '"+b+"']",a.config,{})[0],void 0!=t.preWorkActions){var y=t.preWorkActions;preWorkActions(y,a).then(function(e){s("Assigned to the only user in role. Pre work actions executed")},function(e){v(e)})}else s("Assigned to the only user in role. No pre work actions found.")}else{var u=n.assignedTo;u.name="",u.userId="";var h="";if(void 0!=t.assign.assignment){var h=n.assignment,g={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};h.accept=g,h.message=_getNameByLang(t.assign.assignment.message.i18n);var v={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};h.reject=v;var S={profileId:d,userId:o,type:"user"};h.value=S,h.profileRoleId=d}s("No users found in list. Assigning blank ")}else v("Error in getUsersFromProfileRole ")}).catch(function(e){o(e)})};void 0!=t.assign.role.profile?("current"==t.assign.role.profile?d=a.profile:"community"==t.assign.role.profile&&(d=app.SCOPE.getCommunityId()),function(){var r=t.assign.role.roleId;library.getUsersListByRole(d,r).then(function(o){if(void 0!=o)if(o.length>1){var c=!1,l=library.getCurrentUserRoles(),p=l.profile.indexOf(r),f=l.community.indexOf(r),m=l.implicit.indexOf(r),h=l.adoption.indexOf(r),g=l.subprofile.indexOf(r);if(c=p>-1||f>-1||m>-1||h>-1||g>-1){void 0==n.assignmentHistory&&(n.assignmentHistory=[]);var v=n.assignedTo;if(""!=v.userId&&""!=v.name){var S=JSON.parse(JSON.stringify(v));n.assignmentHistory.push(S)}v.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,v.userId=_lclx.SUBSCRIPTIONS.userId+"",v.dateTime=moment().format(),v.type=ASSIGNMENT_TYPE_AUTO,v.dueDateTime="",v.by=_lclx.SUBSCRIPTIONS.userId+"";var I=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=I&&void 0!=I.assignment){var N={id:_lclx.SUBSCRIPTIONS.userId,name:_lclx.SUBSCRIPTIONS.username};if("string"==typeof I.assignment){var b=I.assignment;dao.getConfig(b).then(function(e){I.assignment=e,actionsModule.notification.assignmentNotification(I,a,i,N).then(function(e){console.log('User assigned successfully. UserId: "'+N.id+'", Name: "'+N.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}).catch(function(e){s(e)})}else actionsModule.notification.assignmentNotification(I,a,i,N).then(function(e){console.log('User assigned successfully. UserId: "'+N.id+'", Name: "'+N.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}}var y="";if(void 0!=t.assign.assignment){var y=n.assignment,P={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};y.accept=P,y.message=_getNameByLang(t.assign.assignment.message.i18n);var _={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};y.reject=_;var O={profileId:u,roleId:r,type:"role"};y.value=O,y.profileRoleId=d}if(c){var T=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+i+"']/id",a,{})[0],q=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+i+"']/id",a,{})[0],x=JSON.xpath("/subprocesses[_id eq '"+i+"']/step/id",a,{})[0];if(JSON.xpath("/processes[_id eq '"+T+"']/subProcesses[_id eq '"+q+"']/steps[_id eq '"+x+"']",a.config,{})[0],void 0!=t.preWorkActions){var k=t.preWorkActions;preWorkActions(k,a).then(function(e){s("Assignment is made. Pre work actions found and executed ")},function(e){_(e)})}else s("Assignment is made. No pre work actions found. ")}else{var I=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=I&&void 0!=I.assignmentAcceptance){var N={id:_lclx.SUBSCRIPTIONS.userId,name:_lclx.SUBSCRIPTIONS.username};if("string"==typeof I.assignmentAcceptance){var b=I.assignmentAcceptance;dao.getConfig(b).then(function(e){I.assignmentAcceptance=e,actionsModule.notification.acceptanceNotification(I,a,i,r).then(function(e){s("Notifications request submitted for acceptance.")}).catch(function(e){s("Notifications failed"),console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}).catch(function(e){s(e)})}else actionsModule.notification.acceptanceNotification(I,a,i,r).then(function(e){s("Notifications request submitted for acceptance.")}).catch(function(e){s("Notifications failed"),console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}else s("Notifications not found")}}else if(1==o.length){var U=o[0].id,w=o[0].name;void 0==n.assignmentHistory&&(n.assignmentHistory=[]);var v=n.assignedTo;if(""!=v.userId&&""!=v.name){var S=JSON.parse(JSON.stringify(v));n.assignmentHistory.push(S)}v.name=w+"",v.userId=U+"",v.dateTime=moment().format(),v.type=ASSIGNMENT_TYPE_AUTO,v.dueDateTime="",v.by=_lclx.SUBSCRIPTIONS.userId+"";var y="";if(void 0!=t.assign.assignment){var y=n.assignment,P={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};y.accept=P,y.message=_getNameByLang(t.assign.assignment.message.i18n);var _={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};y.reject=_;var O={profileId:u,roleId:r,type:"role"};y.value=O,y.profileRoleId=d}var I=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=I&&void 0!=I.assignment){var N={id:U,name:w};if("string"==typeof I.assignment){var b=I.assignment;dao.getConfig(b).then(function(e){I.assignment=e,actionsModule.notification.assignmentNotification(I,a,i,N).then(function(e){console.log('User assigned successfully. UserId: "'+N.id+'", Name: "'+N.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}).catch(function(e){s(e)})}else actionsModule.notification.assignmentNotification(I,a,i,N).then(function(e){console.log('User assigned successfully. UserId: "'+N.id+'", Name: "'+N.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}var T=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+i+"']/id",a,{})[0],q=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+i+"']/id",a,{})[0],x=JSON.xpath("/subprocesses[_id eq '"+i+"']/step/id",a,{})[0];if(JSON.xpath("/processes[_id eq '"+T+"']/subProcesses[_id eq '"+q+"']/steps[_id eq '"+x+"']",a.config,{})[0],void 0!=t.preWorkActions){var k=t.preWorkActions;preWorkActions(k,a).then(function(e){s("Assigned to the only user in role. Pre work actions executed")},function(e){_(e)})}else s("Assigned to the only user in role. No pre work actions found.")}else{var v=n.assignedTo;v.name="",v.userId="";var y="";if(void 0!=t.assign.assignment){var y=n.assignment,P={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};y.accept=P,y.message=_getNameByLang(t.assign.assignment.message.i18n);var _={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)};y.reject=_;var O={profileId:u,roleId:r,type:"role"};y.value=O,y.profileRoleId=d}s("No users found in list. Assigning blank ")}else _(err)},function(e){o(e)})}()):void 0!=t.assign.role.profileId&&helper.getNodeValue(t.assign.role.profileId,a,i).then(function(e){d=e,l()}).catch(function(e){o(e)})}else if(void 0!=t.assign.user)helper.getNodeValue(t.assign.user.userName,a,i).then(function(r){helper.getNodeValue(t.assign.user.userId,a,i).then(function(o){var o=o,u=r,l=a.profile;void 0==n.assignmentHistory&&(n.assignmentHistory=[]);var p=n.assignedTo;if(""!=p.userId&&""!=p.name){var f=JSON.parse(JSON.stringify(p));n.assignmentHistory.push(f)}p.name=u+"",p.userId=o+"",p.dateTime=moment().format(),p.type=ASSIGNMENT_TYPE_AUTO,p.dueDateTime="",p.by=_lclx.SUBSCRIPTIONS.userId+"";var m="";if(void 0!=t.assign.assignment){var m=n.assignment,h={show:t.assign.assignment.accept.show,label:_getNameByLang(t.assign.assignment.accept.label.i18n)};m.accept=h,m.message=_getNameByLang(t.assign.assignment.message.i18n);var g={show:t.assign.assignment.reject.show,label:_getNameByLang(t.assign.assignment.reject.label.i18n)},v={id:o,name:r};c.push(v),m.reject=g;var S={profileId:l,userId:c,type:"user"};m.value=S,m.profileRoleId=d}var I=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=I&&void 0!=I.assignment){var N={id:o,name:u};if("string"==typeof I.assignment){var b=I.assignment;dao.getConfig(b).then(function(e){I.assignment=e,actionsModule.notification.assignmentNotification(I,a,i,N).then(function(e){console.log('User assigned successfully. UserId: "'+N.id+'", Name: "'+N.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}).catch(function(e){s(e)})}else actionsModule.notification.assignmentNotification(I,a,i,N).then(function(e){console.log('User assigned successfully. UserId: "'+N.id+'", Name: "'+N.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+N.id+'", Name: "'+N.name+'"')})}var y=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+i+"']/id",a,{})[0],P=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+i+"']/id",a,{})[0],_=JSON.xpath("/subprocesses[_id eq '"+i+"']/step/id",a,{})[0];JSON.xpath("/processes[_id eq '"+y+"']/subProcesses[_id eq '"+P+"']/steps[_id eq '"+_+"']",a.config,{})[0],void 0!=t.preWorkActions?preWorkActions(t.preWorkActions,a).then(function(e){s("Assigned to the only user in role. Pre work actions executed")},function(e){g(e)}):s("Assigned to the only user in role. No pre work actions found.")},function(e){o(e)})},function(e){o(e)});else if(void 0!=t.assign.swimlane){var p=t.assign.swimlane.stepId,f=t.assign.swimlane.sequence,m=JSON.xpath("/subprocesses[_id eq '"+i+"']",a,{})[0],h=JSON.xpath("/history[id eq '"+p+"']",m,{}),g="";g="last"==f?JSON.xpath("max(for $s in /* return xs:dateTime($s/dateTimeCreated))",h,{})[0]:JSON.xpath("min(for $s in /* return xs:dateTime($s/dateTimeCreated))",h,{})[0];var v=JSON.xpath("/*[xs:dateTime(dateTimeCreated) eq xs:dateTime('"+g+"')]",h,{})[0],S=JSON.xpath("/assignmentHistory[last()]",v,{})[0],I=S.userId,N=S.name;void 0==n.assignmentHistory&&(n.assignmentHistory=[]);var b=n.assignedTo;if(""!=b.userId&&""!=b.name){var y=JSON.parse(JSON.stringify(b));n.assignmentHistory.push(y)}b.name=N+"",b.userId=I+"",b.dateTime=moment().format(),b.type=ASSIGNMENT_TYPE_SWIMLANE,b.dueDateTime="",b.by=_lclx.SUBSCRIPTIONS.userId+"";var P=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=P&&void 0!=P.assignment){var _={id:I,name:N};if("string"==typeof P.assignment){var O=P.assignment;dao.getConfig(O).then(function(e){P.assignment=e,actionsModule.notification.assignmentNotification(P,a,i,_).then(function(e){console.log('User assigned successfully. UserId: "'+_.id+'", Name: "'+_.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+_.id+'", Name: "'+_.name+'"')})}).catch(function(e){s(e)})}else actionsModule.notification.assignmentNotification(P,a,i,_).then(function(e){console.log('User assigned successfully. UserId: "'+_.id+'", Name: "'+_.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+_.id+'", Name: "'+_.name+'"')})}var T=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+i+"']/id",a,{})[0],q=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+i+"']/id",a,{})[0],p=JSON.xpath("/subprocesses[_id eq '"+i+"']/step/id",a,{})[0];if(JSON.xpath("/processes[_id eq '"+T+"']/subProcesses[_id eq '"+q+"']/steps[_id eq '"+p+"']",a.config,{})[0],void 0!=t.preWorkActions){var x=t.preWorkActions;preWorkActions(x,a).then(function(e){s("Assigned to the only user in role. Pre work actions executed")},function(e){o(e)})}else s("Assigned to the only user in role. No pre work actions found.")}},function(e){o(e)})})}function server(e,s,t,i,n,o,a,r,c,u){return new Promise(function(d,l){var p=(r.profile,e.serverAction[0]);void 0==a.assignmentHistory&&(a.assignmentHistory=[]);var f=a.assignedTo;if(""!=f.userId&&""!=f.name){var m=JSON.parse(JSON.stringify(f));a.assignmentHistory.push(m)}f.name=_lclx.SESSION.firstName+" "+_lclx.SESSION.lastName,f.userId=_lclx.SUBSCRIPTIONS.userId+"",f.dateTime=moment().format(),f.type=ASSIGNMENT_TYPE_AUTO,f.dueDateTime="",f.by=_lclx.SUBSCRIPTIONS.userId+"",action(p,s,t,i,n,o,a,r,c,u).then(function(e){d("No users found in list. Assigning blank ")},function(e){l("Server action error found rejected")})})}function transition(e,s,t,i,n,o,a,r,c,u){return new Promise(function(d,l){try{for(var p=0,f="",m=0,h=r.config.processes.filter(function(s){if(s._id==e)return s}),g=h[0].subProcesses.filter(function(e){if(e._id==t)return e}),v=g[0].steps.filter(function(e){if(e._id==n)return e}),S=v[0].transition.filter(function(e){if(e._id==o)return e}),I=0;I<g[0].steps.length;I++)g[0].steps[I]._id==n&&(p=parseInt(g[0].steps[I]._seq));g[0].steps.filter(function(e){m=p+1,parseInt(e._seq)==m&&(f=e._id)});var N=g[0].steps.length,b=JSON.xpath("/subprocesses[_id eq '"+c+"']",r,{})[0],y=JSON.xpath("/subprocesses[_id eq '"+c+"']/step",r,{})[0];void 0==b.history&&(b.history=[]);var P={transitionId:S[0]._id,dateTime:moment().format(),userId:_lclx.SUBSCRIPTIONS.userId+""};if(void 0!=u&&Object.keys(u).length>0?u.transition=P:y.transition=P,void 0!=u&&Object.keys(u).length>0){void 0==u.assignmentHistory&&(u.assignmentHistory=[]);var _=JSON.parse(JSON.stringify(u.assignedTo));""!=_.userId&&""!=_.name&&u.assignmentHistory.push(_)}else{void 0==y.assignmentHistory&&(y.assignmentHistory=[]);var _=JSON.parse(JSON.stringify(y.assignedTo));""!=_.userId&&""!=_.name&&y.assignmentHistory.push(_)}var O;O=void 0!=u&&Object.keys(u).length>0?JSON.parse(JSON.stringify(u)):JSON.parse(JSON.stringify(y));var T=function(e){var s=JSON.xpath("/subprocesses[_id eq '"+c+"']/indicators",r,{}),t=!1;void 0!=s&&0!=s.length||(t=!0,s=JSON.xpath("/indicators[workflows/processes[subProcessUUID eq '"+c+"']]",r,{})),void 0==e.indicators&&(e.indicators=[]);for(var i=0;i<s.length;i++)if(t){var n=s[i]._id,o=JSON.xpath("/indicators[_id eq '"+n+"']/_rev",r,{})[0],a=s[i].model.pending.seq,u=s[i].model.pending.status,d={uuid:n,rev:o,seq:a,status:u};e.indicators.push(d)}else{var n=s[i].instances[0].uuid,o=JSON.xpath("/indicators[_id eq '"+n+"']/_rev",r,{})[0],a=JSON.xpath("/indicators[_id eq '"+n+"']/model/pending/seq",r,{})[0],u=JSON.xpath("/indicators[_id eq '"+n+"']/model/pending/status",r,{})[0],d={uuid:n,rev:o,seq:a,status:u};e.indicators.push(d)}return delete e.assignedTo,delete e.assignment,e}(O);if(b.history.push(T),void 0!=S[0].transitionAction.goToStep){var q=parseInt(v[0]._seq)+parseInt(S[0].transitionAction.goToStep.default),x="";g[0].steps.filter(function(e){parseInt(e._seq)==m&&(x=e._id)}),step(e,s,t,i,x,q,a,r,c).then(function(e){if(q==N){var s=util.success("All Step transitions have completed successfully.",{subProcessComplete:!0,step:e.data});d(s)}else{var s=util.success("Step transition completed successfully.",{subProcessComplete:!1,step:e.data});d(s)}},function(e){l(e)})}else if(void 0!=S[0].transitionAction.goToStepId){var k=S[0].transitionAction.goToStepId.stepId,U=1;g[0].steps.filter(function(e){e._id==k&&(U=parseInt(e._seq))}),step(e,s,t,i,k,U,a,r,c).then(function(e){if(U==N||"Complete"==e.data.status){var s=util.success("All Step transitions have completed successfully.",{subProcessComplete:!0,step:e.data});d(s)}else{var s=util.success("Step transition completed successfully.",{subProcessComplete:!1,step:e.data});d(s)}},function(e){l(e)})}else if(void 0!=S[0].transitionAction.stop){var w=[];if(void 0!=b.messages)for(var A=0;A<b.messages.length;A++){var E=b.messages[A];"info"!=E.type&&"success"!=E.type||void 0!=E.keep&&1==E.keep?w.push(E):void 0!=E.url&&w.push(E)}b.messages=w;var C=h[0].postActions;postActions(C,r,c).then(function(e){var s=util.success("Step transition completed successfully.Workflow stopped.",{subProcessComplete:!0,step:u});d(s)},function(e){l(e)})}}catch(e){l(e)}})}function postActions(e,s,t){return new Promise(function(i,n){var o=[];try{var a=JSON.xpath("/subprocesses[_id eq '"+t+"']",s,{})[0],r=a["meta-data"].processConfigId,c=a["meta-data"].subProcessConfigId,u=a["meta-data"].subProcessInsSeq,d=a["meta-data"].subProcessInsSeq,l=JSON.xpath("/config/processes[_id eq '"+r+"']/subProcesses[_id eq '"+c+"']",s,{})[0],p=JSON.xpath("/subprocesses[_id eq '"+t+"']/step",s,{})[0];util.syncLoop(e.length,function(i){var a=i.iteration();action(e[a],r,u,c,d,l,p,s,{},t).then(function(e){o.push(!0),i.next()},function(e){o.push(!1),i.break(),n(e)})},function(){if(o.every(Boolean)){var e=util.success("Post-actions completed successfully.",{});i(e)}else{var s=util.error("WFPreActionsError","Not all post-actions passed.");n(s)}})}catch(e){n(e)}})}function processWorkflowMessage(e,s){var t=e;if(-1!==t.indexOf("#INSTANCE_LABEL")){var i=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+s+"']/label",app.SCOPE.workflow,{})[0];t=t.replace("#INSTANCE_LABEL",i)}if(-1!==t.indexOf("#USER_NAME")){var i=JSON.xpath("/subprocesses[_id eq '"+s+"']/step/assignedTo/name",app.SCOPE.workflow,{})[0];t=t.replace("#USER_NAME",i)}if(-1!==t.indexOf("#PROFILE_TITLE")){var i=app.profile.title;t=t.replace("#PROFILE_TITLE",i)}if(-1!==t.indexOf("#PROFILE_TYPE")){var i=app.SCOPE.APP_CONFIG.name;t=t.replace("#PROFILE_TYPE",i)}if(-1!==t.indexOf("#VAR_SPUUID")){var i=s;t=t.replace("#VAR_SPUUID",i)}return t}function _getName(e,s){if(void 0!==e)for(var t=0;t<e.length;t++)if(e[t]._lang===s)return e[t].value}function _getNameByLang(e){return library.getNameByLang(e)}function preWorkActions(e,s){return new Promise(function(t,i){var n=[];try{var o=JSON.xpath("/config/processes[_id eq '"+app.SCOPE.spo.pObject.id+"']/subProcesses[_id eq '"+app.SCOPE.spo.spObject.id+"']",s,{})[0],a=JSON.xpath("/subprocesses[_id eq '"+app.SCOPE.processUUID+"']/step",s,{})[0];util.syncLoop(e.length,function(t){var r=t.iteration();action(e[r],app.SCOPE.spo.pObject.id,app.SCOPE.spo.pObject.seq,app.SCOPE.spo.spObject.id,app.SCOPE.spo.spObject.seq,o,a,s,{},app.SCOPE.processUUID).then(function(e){n.push(!0),t.next()},function(e){n.push(!1),t.break(),i(e)})},function(){if(n.every(Boolean)){var e=util.success("PreWork-actions completed successfully.",{});t(e)}else{var s=util.error("WFPreActionsError","Not all pre-work-actions passed.");i(s)}})}catch(e){i(e)}})}var util=require("utility"),actionsModule=require("./actions"),helper=require("./helper"),form=require("./form");module.exports={preRequisites:preRequisites,preActions:preActions,postActions:postActions,preWorkActions:preWorkActions,subProcess:subProcess,indicatorDocs:indicatorDocs,task:task,transition:transition,assignUser:assignUser};

},{"./actions":2,"./form":3,"./helper":4,"utility":8}],8:[function(require,module,exports){
"use strict";function success(r,e){return{message:r,data:e}}function warn(r,e){return console.warn(e),{warning:r,data:e}}function error(r,e){var n=new Error("");return n.name=r,n.message=e,n}function syncLoop(r,e,n){var a=0,t=!1,o=!1,u={next:function(){if(t&&o&&n)return n();a<r?(a++,e(u)):(t=!0,n&&n())},iteration:function(){return a-1},break:function(r){t=!0,o=r}};return u.next(),u}function compare(r,e,n){switch(e){case"greaterThan":return r>n;case"lessThan":return r<n;case"greaterThanEqual":return r>=n;case"lessThanEqual":return r<=n;case"equalTo":return r===n;case"notEqualTo":return r!==n}}function getName(r,e){if(void 0!==r)for(var n=0;n<r.length;n++)if(r[n].i18n._lang===e)return r[n].i18n.value}module.exports={success:success,warn:warn,error:error,syncLoop:syncLoop,compare:compare,getName:getName};

},{}]},{},[1])(1)
});

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Vzci9sb2NhbC9saWIvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsImluZGV4LmpzIiwibGliL2FjdGlvbnMuanMiLCJsaWIvZm9ybS5qcyIsImxpYi9oZWxwZXIuanMiLCJsaWIvaW50ZXJmYWNlLmpzIiwibGliL25vZGVWYWx1ZS5qcyIsImxpYi9wcm9jZXNzLmpzIiwibm9kZV9tb2R1bGVzL3V0aWxpdHkvaW5kZXguanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQSxZQThDQSxTQUFTLFVBQVMsRUFBUyxFQUFhLEVBQUssR0FDekMsR0FBSSxHQUFRLElBR1osSUFBbUIsSUFBZixPQUFvQyxJQUFmLEVBQ3JCLEtBQU0sTUFBSyxNQUFNLGdCQUFpQiw4QkFDL0IsSUFBNEIsZ0JBQWxCLEdBQ2IsS0FBTSxJQUFJLE9BQU0sZ0RBTXBCLElBSkksRUFBTSxZQUFjLEdBQWUsR0FJeEIsSUFBWCxPQUE0QixJQUFYLEVBQ2pCLEtBQU0sTUFBSyxNQUFNLGdCQUFpQiw0QkFDL0IsSUFBd0IsZ0JBQWQsR0FDYixLQUFNLElBQUksT0FBTSw4Q0FNcEIsSUFKSSxFQUFNLFFBQVUsR0FBVyxHQUlwQixJQUFQLE9BQW9CLElBQVAsRUFDYixLQUFNLE1BQUssTUFBTSxnQkFBaUIseUJBQy9CLElBQW9CLGdCQUFWLEdBQ2IsS0FBTSxJQUFJLE9BQU0sMENBTXBCLElBSkksRUFBTSxJQUFNLEdBQU8sR0FJVCxJQUFWLE9BQTBCLElBQVYsRUFDaEIsS0FBTSxNQUFLLE1BQU0sZ0JBQWlCLHdDQUVsQyxHQUFNLE9BRG9CLGdCQUFiLEdBQ0UsS0FBSyxNQUFNLEdBRVgsRUFJbkIsRUFBTSxTQUVOLEVBQU0sZ0JBRU4sRUFBTSxjQXhGVixHQUFJLFNBQVUsUUFBUSxpQkFDbEIsS0FBTyxRQUFRLFdBQ2YsY0FBZ0IsUUFBUSxtQkFDeEIsT0FBUyxRQUFRLGVBa0dyQixVQUFT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LEVBQUssS0FBSyxHQUNWLEVBQUssS0FBSyxHQUNWLEVBQUssS0FBSyxHQUVWLEVBQUssS0FBSyxHQUNWLEVBQUssS0FBSyxFQUFLLFlBQ2YsRUFBSyxLQUFLLEdBQ1YsRUFBSyxLQUFLLEVBQUssVUFDZixFQUFLLEtBQUssR0FFVixLQUFLLE9BQU8sR0FBTSxLQUFLLFNBQVMsR0FDNUIsRUFBUSxFQUFPLE9BQ2hCLFNBQVMsR0FDUixFQUFPLFNBR1IsUUFBb0MsSUFBaEMsRUFBTyxPQUFPLEtBQUssVUFBd0IsQ0FFbEQsR0FBSSxLQUNKLEdBQUssS0FBSyxHQUNWLEVBQUssS0FBSyxHQUNWLEVBQUssS0FBSyxHQUNWLEVBQUssS0FBSyxHQUNWLEVBQUssS0FBSyxHQUNWLEVBQUssS0FBSyxFQUFLLFlBQ2YsRUFBSyxLQUFLLEdBQ1YsRUFBSyxLQUFLLEVBQUssVUFDZixFQUFLLEtBQUssR0FDVixLQUFLLFVBQVUsR0FBTSxLQUFLLFNBQVMsR0FDL0IsRUFBUSxFQUFPLE9BQ2hCLFNBQVMsR0FDUixFQUFPLFNBR1IsUUFBa0MsSUFBOUIsRUFBTyxPQUFPLEtBQUssUUFBc0IsQ0FDaEQsR0FBSSxLQUNKLEdBQUssS0FBSyxHQUNWLEVBQUssS0FBSyxFQUFLLFlBQ2YsRUFBSyxLQUFLLEdBQ1YsRUFBSyxLQUFLLEVBQUssVUFDZixFQUFLLEtBQUssR0FDVixLQUFLLFdBQVcsR0FBTSxLQUFLLFNBQVMsR0FDaEMsRUFBUSxFQUFPLE9BQ2hCLFNBQVMsR0FDUixFQUFPLFNBR1IsUUFBZ0MsSUFBNUIsRUFBTyxPQUFPLEtBQUssTUFBb0IsQ0FDOUMsR0FBSSxLQUNKLEdBQUssS0FBSyxHQUNWLEVBQUssS0FBSyxFQUFLLFlBQ2YsRUFBSyxLQUFLLEdBQ1YsRUFBSyxLQUFLLEVBQUssVUFDZixFQUFLLEtBQUssR0FDVixLQUFLLFNBQVMsR0FBTSxLQUFLLFNBQVMsR0FDOUIsRUFBUSxFQUFPLE9BQ2hCLFNBQVMsR0FDUixFQUFPLFNBR1IsUUFBZ0MsSUFBNUIsRUFBTyxPQUFPLEtBQUssTUFBb0IsQ0FFOUMs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QUNKLEdBQU0sTUFHakIsVUFBVSxXQUNOLE1BQU8sR0FBUSxHQUVuQixNQUFNLFNBQVMsR0FDWCxHQUFPLEVBQ1AsRUFBYSxHQUlyQixPQURBLEdBQUssT0FDRSxFQUdYLFFBQVMsU0FBUSxFQUFTLEVBQVUsR0FDakMsT0FBUSxHQUNQLElBQUssY0FDTixNQUFPLEdBQVUsQ0FDbEIsS0FBSyxXQUNKLE1BQU8sR0FBVSxDQUNsQixLQUFLLG1CQUNKLE1BQU8sSUFBVyxDQUNuQixLQUFLLGdCQUNKLE1BQU8sSUFBVyxDQUNuQixLQUFLLFVBQ0osTUFBTyxLQUFZLENBQ3BCLEtBQUssYUFDSixNQUFPLEtBQVksR0FJdEIsUUFBUyxTQUFRLEVBQUssR0FDckIsT0FBWSxLQUFSLEVBQ0gsSUFBSyxHQUFJLEdBQUksRUFBRyxFQUFJLEVBQUksT0FBUyxJQUNoQyxHQUFJLEVBQUksR0FBRyxLQUFLLFFBQVUsRUFDekIsTUFBTyxHQUFJLEdBQUcsS0FBSyxNQU12QixPQUFPLFNBRUwsUUFBUyxRQUNULEtBQU0sS0FDTixNQUFPLE1BQ1AsU0FBVSxTQUNWLFFBQVMsUUFDVixRQUFTIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgUHJvY2VzcyA9IHJlcXVpcmUoJy4vbGliL3Byb2Nlc3MnKTtcbnZhciB1dGlsID0gcmVxdWlyZSgndXRpbGl0eScpO1xudmFyIHVzZXJJbnRlcmZhY2UgPSByZXF1aXJlKCcuL2xpYi9pbnRlcmZhY2UnKTtcbnZhciBoZWxwZXIgPSByZXF1aXJlKCcuL2xpYi9oZWxwZXInKTtcblxuXG4vKmdsb2JhbHMgKi9cblxuLyoqXG4gKiBBIG5ldyBXb3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZSBjb250YWlucyB0aGUgcmVmZXJlbmNlIHRvIHRoZSBhcHBsaWNhdGlvblxuICogYW5kIGFzc29jaWF0ZWQgcHJvZmlsZSB3aGljaCBpdCByZXF1aXJlcyBhcyB0aGUgZmlyc3QgdHdvIHBhcmFtZXRlcnMuIEl0IGFsc29cbiAqIHJlcXVpcmVzIGEgd29ya2Zsb3cgY29uZmlndXJhdGlvbiwgYXMgdGhlIHRoaXJkIHBhcmFtZXRlciwgd2hpY2ggaXMgdXNlZCB0b1xuICogZGVzY2liZSB0aGUgd29ya2Zsb3cgcHJvY2Vzc2VzLiBJZiBhIHdvcmtmbG93IGluc3RhbmNlIGV4aXN0cyB5b3UgY2FuIHBhc3MgaXRcbiAqIGluIGFzIHRoZSBmb3VydGggcGFyYW1ldGVyIHdoaWNoIGl0IHdpbGwgdGhlbiB1c2UsIGVsc2UgY3JlYXRlIGEgbmV3IG9uZS5cbiAqXG4gKiBAY29uc3RydWN0b3JcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvZmlsZSAtIFRoZSBjdXJyZW50IHByb2ZpbGUgaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBhcHAgLSBUaGUgYXNzb2NpYXRlZCBhcHBsaWNhdGlvbiBpZFxuICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZyAtIFRoZSBhcHBsaWNhdGlvbiB3b3JrZmxvdyBjb25maWd1cmF0aW9uIC8gZGVmaW5pdGlvblxuICogQHBhcmFtIHtPYmplY3R9IFtpbnN0YW5jZV0gLSBBbiBleGlzdGluZyBhcHBsaWNhdGlvbiBwcm9maWxlIHdvcmtmbG93IGluc3RhbmNlIGJhc2VkXG4gKiBvbiB0aGUgZGVmaW5pdGlvblxuICpcbiAqIEBhdXRob3IgQnJlbnQgR29yZG9uXG4gKiBAdmVyc2lvbiAwLjEuMFxuICpcbiAqIEBleGFtcGxlXG4gKiB2YXIgY29uZmlnID0geyAnX2lkJzogJ2FiYzEyMycgfTtcblxuICogdmFyIGluc3RhbmNlID0geyAnX2lkJzogJ2luc3RhbmNlX2FiYzEyMycgfTtcblxuICogLy8gSWYgdGhlcmUgaXNuJ3QgYW4gZXhpc3RpbmcgaW5zdGFuY2VcbiAqIHZhciB3b3JrZmxvdyA9IG5ldyBXb3JrZmxvdygnMTIzNCcsICc1Njc4JywgY29uZmlnKTtcbiAqIC8vIElmIHRoZXJlIGlzIGFuIGV4aXN0aW5nIGluc3RhbmNlXG4gKiB2YXIgd29ya2Zsb3cgPSBuZXcgV29ya2Zsb3coJzEyMzQnLCAnNTY3OCcsIGNvbmZpZywgaW5zdGFuY2UpO1xuICpcbiAqIEByZXR1cm4ge09iamVjdH0gbmV3IFdvcmtmbG93IG9iamVjdFxuICpcbiAqIEB0aHJvd3MgRXJyb3I6IEEgcHJvZmlsZSBpZCBpcyByZXF1aXJlZFxuICogQHRocm93cyBFcnJvcjogQW4gYXBwIGlkIGlzIHJlcXVpcmVkXG4gKiBAdGhyb3dzIEVycm9yOiBBIHdvcmtmbG93IGNvbmZpZ3VyYXRpb24gaXMgcmVxdWlyZWRcbiAqXG4gKi9cblxuZnVuY3Rpb24gV29ya2Zsb3cocHJvZmlsZSwgY29tbXVuaXR5SWQsIGFwcCwgY29uZmlnKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIC8vIENvbW11bml0eSBJRCB2YWxpZGF0aW9uIGNoZWNrc1xuICAgIGlmIChjb21tdW5pdHlJZCA9PSAnJyB8fCBjb21tdW5pdHlJZCA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgdXRpbC5lcnJvcignUGFyYW1SZXF1aXJlZCcsICdBIGNvbW11bml0eSBpZCBpcyByZXF1aXJlZC4nKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZihjb21tdW5pdHlJZCkgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIGNvbW11bml0eSBpZCBtdXN0IGJlIGEgamF2YXNjcmlwdCBzdHJpbmcuJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgX3RoaXMuY29tbXVuaXR5SWQgPSBjb21tdW5pdHlJZCB8fCAnJztcbiAgICB9XG5cbiAgICAvLyBQcm9maWxlIElEIHZhbGlkYXRpb24gY2hlY2tzXG4gICAgaWYgKHByb2ZpbGUgPT0gJycgfHwgcHJvZmlsZSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgdXRpbC5lcnJvcignUGFyYW1SZXF1aXJlZCcsICdBIHByb2ZpbGUgaWQgaXMgcmVxdWlyZWQuJyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YocHJvZmlsZSkgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIHByb2ZpbGUgaWQgbXVzdCBiZSBhIGphdmFzY3JpcHQgc3RyaW5nLicpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIF90aGlzLnByb2ZpbGUgPSBwcm9maWxlIHx8ICcnO1xuICAgIH1cblxuICAgIC8vIEFwcCBJRCB2YWxpZGF0aW9uIGNoZWNrc1xuICAgIGlmIChhcHAgPT0gJycgfHwgYXBwID09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyB1dGlsLmVycm9yKCdQYXJhbVJlcXVpcmVkJywgJ0FuIGFwcCBpZCBpcyByZXF1aXJlZC4nKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZihhcHApICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBhcHAgaWQgbXVzdCBiZSBhIGphdmFzY3JpcHQgc3RyaW5nLicpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIF90aGlzLmFwcCA9IGFwcCB8fCAnJztcbiAgICB9XG5cbiAgICAvLyBXb3JrZmxvdyBjb25maWd1cmF0aW9uIHZhbGlkYXRpb24gY2hlY2tzXG4gICAgaWYgKGNvbmZpZyA9PSAnJyB8fCBjb25maWcgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IHV0aWwuZXJyb3IoJ1BhcmFtUmVxdWlyZWQnLCAnQSB3b3JrZmxvdyBjb25maWd1cmF0aW9uIGlzIHJlcXVpcmVkLicpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mKGNvbmZpZykgIT09ICdvYmplY3QnKSB7XG4gICAgICAgIF90aGlzLmNvbmZpZyA9IEpTT04ucGFyc2UoY29uZmlnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBfdGhpcy5jb25maWcgPSBjb25maWc7XG4gICAgfVxuXG4gICAgLy8gV29ya2Zsb3cgaW5zdGFuY2UgdmFsaWRhdGlvbiBjaGVja3NcbiAgICBfdGhpcy5pbnN0YW5jZTtcbiAgICAvLyBXb3JrZmxvdyBzdWItcHJvY2Vzc2VzIHZhbGlkYXRpb24gY2hlY2tzXG4gICAgX3RoaXMuc3VicHJvY2Vzc2VzID0gW107XG4gICAgLy8gV29ya2Zsb3cgaW5kaWNhdG9ycyBwbGFjZSBob2xkZXJcbiAgICBfdGhpcy5pbmRpY2F0b3JzID0gW107XG5cblxufVxuXG4vKipcbiAqIFdvcmtmbG93IGdldCBwcm9maWxlIGlkLlxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5nZXRQcm9maWxlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvZmlsZTtcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgZ2V0IGFwcCBpZC5cbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuZ2V0QXBwID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuYXBwO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyBnZXQgY29uZmlnLlxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5nZXRDb25maWcgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5jb25maWc7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IGdldCBpbnN0YW5jZS5cbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5cbldvcmtmbG93LnByb3RvdHlwZS5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmluc3RhbmNlO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyBzZXQgdGhlIGluc3RhbmNlIGRhdGEuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGRhdGEgLSB0aGUgd29ya2Zsb3cgcHJvY2VzcyBpbnN0YW5jZSBkYXRhXG4gKlxuICogQGV4YW1wbGUgXCJcIlxuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLnNldEluc3RhbmNlID0gZnVuY3Rpb24oZGF0YSkge1xuICAgIHRoaXMuaW5zdGFuY2UgPSBkYXRhO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyBnZXQgc3ViLXByb2Nlc3NlcyBkYXRhLlxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5nZXRTdWJQcm9jZXNzZXMgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5zdWJwcm9jZXNzZXM7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IHNldCB0aGUgc3ViLXByb2Nlc3NlcyBkYXRhLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIC0gdGhlIHdvcmtmbG93IHByb2Nlc3MgaW5zdGFuY2UgZGF0YVxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5zZXRTdWJQcm9jZXNzZXMgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgdGhpcy5zdWJwcm9jZXNzZXMgPSBkYXRhO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyBnZXQgaW5kaWNhdG9yIHNldCBkYXRhLlxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5nZXRJbmRpY2F0b3JzID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuaW5kaWNhdG9ycztcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgc2V0IHRoZSBpbmRpY2F0b3Igc2V0IGRhdGEuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGRhdGEgLSB0aGUgd29ya2Zsb3cgcHJvY2VzcyBpbnN0YW5jZSBkYXRhXG4gKlxuICogQGV4YW1wbGUgXCJcIlxuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLnNldEluZGljYXRvcnMgPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgdGhpcy5pbmRpY2F0b3JzID0gZGF0YTtcbn07XG5cbi8qKlxuICogU2V0IHRoZSB2YXJpYWJsZSB2YWx1ZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2UgcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdWJQcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdWItcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHN1YlByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2Ugc3ViLXByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RlcElkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3RlcCBpZFxuICogQHBhcmFtIHtPYmplY3R9IHZhcmlhYmxlIC0gdGhlIFdvcmtmbG93IHZhcmlhYmxlIG9iamVjdFxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuLy8gV29ya2Zsb3cucHJvdG90eXBlLnNldFZhcmlhYmxlID0gZnVuY3Rpb24ocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwgdmFyaWFibGUpe1xuLy8gXHR2YXIgX3RoaXMgPSB0aGlzO1xuLy8gXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4vLyBcdFx0dHJ5IHtcbi8vIFx0XHRcdFByb2Nlc3MuZ2V0VmFyaWFibGUocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwgdmFyaWFibGUpLnRoZW4oZnVuY2lvbihyZXN1bHQpe1xuLy8gXHRcdFx0XHRyZXNvbHZlKHJlc3VsdC5kYXRhKTtcbi8vIFx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG4vLyBcdFx0XHRcdHJlamVjdChlcnIpO1xuLy8gXHRcdFx0fSlcbi8vIFx0XHR9IGNhdGNoIChlcnIpIHtcbi8vIFx0XHRcdHJlamVjdChlcnIpO1xuLy8gXHRcdH1cblxuLy8gXHR9KTtcbi8vIH07XG5cbi8qKlxuICogR2V0IHRoZSB2YXJpYWJsZSB2YWx1ZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2UgcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdWJQcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdWItcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHN1YlByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2Ugc3ViLXByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RlcElkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3RlcCBpZFxuICogQHBhcmFtIHtzdHJpbmd9IGtleSAtIHRoZSBXb3JrZmxvdyB2YXJpYWJsZSBpZFxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuLy8gV29ya2Zsb3cucHJvdG90eXBlLmdldFZhcmlhYmxlID0gZnVuY3Rpb24ocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwga2V5KXtcbi8vIFx0dmFyIF90aGlzID0gdGhpcztcbi8vIFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuLy8gXHRcdHRyeSB7XG4vLyBcdFx0XHRQcm9jZXNzLnNldFZhcmlhYmxlKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIGtleSkudGhlbihmdW5jaW9uKHJlc3VsdCl7XG4vLyBcdFx0XHRcdHJlc29sdmUocmVzdWx0LmRhdGEpO1xuLy8gXHRcdFx0fSwgZnVuY3Rpb24oZXJyKXtcbi8vIFx0XHRcdFx0cmVqZWN0KGVycik7XG4vLyBcdFx0XHR9KVxuLy8gXHRcdH0gY2F0Y2ggKGVycikge1xuLy8gXHRcdFx0cmVqZWN0KGVycik7XG4vLyBcdFx0fVxuXG4vLyBcdH0pO1xuLy8gfTtcblxuLyoqXG4gKiBUaGlzIG1ldGhvZCBjcmVhdGVzIGEgbmV3IHdvcmtmbG93IHByb2Nlc3MgaS5lLiBpdCBjcmVhdGVzIGEgd29ya2Zsb3cgcHJvY2Vzc2VzIGluc3RhbmNlXG4gKiBvYmplY3Qgd2l0aCB0aGUgbWluaW11bSByZXF1aXJlZCBkYXRhLiBUaGlzIGluc3RhbmNlIGNhbiBiZSByZWZlcmVuY2VkIGluIHRoZSBmb2xsb3dpbmdcbiAqIHdheSwgc2VlIGV4YW1wbGUgYmVsb3cuXG4gKlxuICogQGV4YW1wbGVcbiAqIHZhciBjb25maWcgPSB7ICdfaWQnOiAnYWJjMTIzJyB9O1xuXG4gKiB2YXIgd29ya2Zsb3cgPSBuZXcgV29ya2Zsb3coJzEyMzQnLCAnNTY3OCcsIGNvbmZpZyk7XG4gKiB3b3JrZmxvdy5jcmVhdGUoKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gKlx0Y29uc29sZS5sb2cocmVzdWx0Lm1lc3NhZ2UpO1xuICpcdC8vIFRoZSBmb2xsb3dpbmcgcHJvcGVydGllcyBjYW4gbm93IGJlIGFjY2Vzc2VkXG4gKiBcdHZhciBwcm9maWxlID0gd29ya2Zsb3cucHJvZmlsZTtcbiAqIFx0dmFyIGFwcCA9IHdvcmtmbG93LmFwcDtcbiAqIFx0dmFyIGNvbmZpZyA9IHdvcmtmbG93LmNvbmZpZztcbiAqXHQvLyBPbiBzdWNjZXNzIHlvdSBjYW4gYWNjZXNzIHRoZSBpbnN0YW5jZSB0aGUgZm9sbG93aW5nIHdheVxuICpcdHZhciBpbnN0YW5jZSA9IHdvcmtmbG93Lmluc3RhbmNlO1xuICogfSwgZnVuY3Rpb24oZXJyb3Ipe1xuICpcdGNvbnNvbGUubG9nKGVycm9yKTtcbiAqIH0pO1xuICpcbiAqIEByZXR1cm4ge09iamVjdH0gbmV3IFdvcmtmbG93IGluc3RhbmNlIHdpdGggdXBkYXRlZCBpbnN0YW5jZSBkYXRhLlxuICpcbiAqL1xuXG5Xb3JrZmxvdy5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMuaW5zdGFuY2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHZhciB3YXJuID0gdXRpbC53YXJuKCdJbnN0YW5jZSBhbHJlYWR5IGV4aXN0cy4nLCBfdGhpcylcbiAgICAgICAgICAgICAgICByZXNvbHZlKHdhcm4pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgdGhlIHdvcmtmbG93IHByb2Nlc3NlcyBpbnN0YW5jZSBvYmplY3RcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPSB7XG4gICAgICAgICAgICAgICAgICAgIF9pZDogJycsXG4gICAgICAgICAgICAgICAgICAgIHZlcnNpb246ICcnLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnd29ya2Zsb3dJbnN0YW5jZScsXG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlczogW10sXG4gICAgICAgICAgICAgICAgICAgIGNoYW5uZWxzOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlX1wiICsgYXBwLlNDT1BFLnByb2ZpbGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25fXCIgKyBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkgKyBcIl9hcHBsaWNhdGlvbl9cIiArIGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkXG4gICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgbW9kZWwuX2lkID0gXCJfbG9jYWwvXCIgKyBfdGhpcy5wcm9maWxlICsgJzpwcm9jZXNzZXMnO1xuICAgICAgICAgICAgICAgIC8vbW9kZWwuX2lkID0gX3RoaXMucHJvZmlsZSArICc6cHJvY2Vzc2VzJztcblxuICAgICAgICAgICAgICAgIG1vZGVsLnZlcnNpb24gPSBfdGhpcy5jb25maWcudmVyc2lvbjtcbiAgICAgICAgICAgICAgICBfdGhpcy5pbnN0YW5jZSA9IG1vZGVsO1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrZmxvdyBwcm9jZXNzZXMgaW5zdGFuY2UgY3JlYXRlZCBzdWNjZXNzZnVsbHkuJywgX3RoaXMpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgaW5pdGlhbGlzZSwgdGhpcyBmdW5jdGlvbiBleGVjdXRlcyBhIHByb2Nlc3Mgd2l0aGluIGEgd29ya2Zsb3dcbiAqIGNvbmZpZ3VyYXRpb24uXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBwcm9jZXNzIGlkIHRvIHByb2Nlc3NcbiAqIEBwYXJhbSB7b2JqZWN0fSBbZGF0YV0gLSB0aGUgaW5wdXQgZGF0YSB0byBwcm9jZXNzXG4gKlxuICogQGV4YW1wbGVcbiAqIFdvcmtmbG93LmluaXRpYWxpc2UoJ3Byb2Nlc3NJZCcsIHsgdmFsaWREYXRlOiAnZGF0ZScgfSk7XG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuaW5pdGlhbGlzZSA9IGZ1bmN0aW9uKHByb2Nlc3NJZCwgZGF0YSwgc3VicHJvZmlsZUlkKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgY29uZmlnUHJvY2VzcyA9IFtdO1xuICAgICAgICAgICAgLy8gQ2hlY2sgdGhlIHBhc3NlZCBpbiBwYXJhbWV0ZXJzXG4gICAgICAgICAgICBpZiAocHJvY2Vzc0lkICE9PSAnJyAmJiBwcm9jZXNzSWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIC8vIEdldCB0aGUgY3VycmVudCBwcm9jZXNzIGNvbmZpZ1xuICAgICAgICAgICAgICAgIGNvbmZpZ1Byb2Nlc3MgPSBfdGhpcy5jb25maWcucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpQcm9jZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvYmpQcm9jZXNzLl9pZCA9PSBwcm9jZXNzSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmpQcm9jZXNzO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlnUHJvY2Vzc1swXS5faWQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGQ29uZmlnRXJyb3InLCAnTm8gdmFsaWQgcHJvY2VzcyBkZWZpbml0aW9uIGZvdW5kIHdpdGggcHJvY2VzcyBpZDogJyArIHByb2Nlc3NJZCk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbmZpZ1Byb2Nlc3MucHVzaChfdGhpcy5jb25maWcucHJvY2Vzc2VzWzBdKTtcbiAgICAgICAgICAgICAgICBwcm9jZXNzSWQgPSBfdGhpcy5jb25maWcucHJvY2Vzc2VzWzBdLl9pZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGJ1aWxkUGFyYW0gPSBmdW5jdGlvbihhcnJheSkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGluZE5hbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGwgPSAwOyBsIDwgYXJyYXkubGVuZ3RoIC0gMTsgbCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGluZE5hbWUgPSBpbmROYW1lICsgXCInXCIgKyBhcnJheVtsXSArIFwiJyxcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICcoJyArIGluZE5hbWUgKyBcIidcIiArIGFycmF5W2FycmF5Lmxlbmd0aCAtIDFdICsgXCInKVwiXG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciBzcElkID0gY29uZmlnUHJvY2Vzc1swXS5zdWJQcm9jZXNzZXNbMF0uX2lkO1xuICAgICAgICAgICAgdmFyIHRvQ2hlY2tBcnJheSA9IFtdO1xuICAgICAgICAgICAgdmFyIGluc3RhbmNlVHlwZSA9IGNvbmZpZ1Byb2Nlc3NbMF0uc3ViUHJvY2Vzc2VzWzBdLmluc3RhbmNlVHlwZTtcbiAgICAgICAgICAgIHZhciBwcm9jZXNzSW5kaWNhdG9ycyA9IEpTT04ueHBhdGgoXCJpbmRpY2F0b3JzL19pZFwiLCBjb25maWdQcm9jZXNzWzBdLnN1YlByb2Nlc3Nlc1swXSwge30pO1xuXG4gICAgICAgICAgICB2YXIgY2FuQ3JlYXRlUHJvY2VzcyA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy9TUDpUT0RPIERPTkVcbiAgICAgICAgICAgICAgICB2YXIgY291bnRTaW5nbGVMaXN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW3NldElkID0gXCIgKyBidWlsZFBhcmFtKGFycmF5KSArIFwiIGFuZCBjYXJkaW5hbGl0eSBlcSAnc2luZ2xlJyBdL3NldElkXCIsIGFwcC5TQ09QRS5BUFBfQ09ORklHLCB7fSk7XG4gICAgICAgICAgICAgICAgdmFyIGNvdW50U2luZ2xlID0gY291bnRTaW5nbGVMaXN0Lmxlbmd0aDtcblxuICAgICAgICAgICAgICAgIGlmIChjb3VudFNpbmdsZSA+IDApIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaW52b2x2ZWRwcm9jZXNzZXMgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaW5kaWNhdG9ycy9faWQgPSBcIisgYnVpbGRQYXJhbShjb3VudFNpbmdsZUxpc3QpICtcIl0vX2lkXCIsIF90aGlzLmNvbmZpZyx7fSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb3VudCA9IEpTT04ueHBhdGgoXCJjb3VudCgvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpZCA9IFwiKyBidWlsZFBhcmFtKGludm9sdmVkcHJvY2Vzc2VzKSArXCIgYW5kIGNvbXBsZXRlID0gZmFsc2UoKV0pXCIsIF90aGlzLHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChjb3VudCA9PSAwKVxuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZVR5cGUubmV3U2VxdWVuY2UgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb3VudCA9IEpTT04ueHBhdGgoXCJjb3VudCgvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpZCBlcSAnXCIrIHNwSWQgK1wiJyBhbmQgY29tcGxldGUgZXEgJ2ZhbHNlJ10pXCIsIF90aGlzICwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChjb3VudCA9PSAwKVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbnN0YW5jZVR5cGUubmV3SW5zdGFuY2UgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cblxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAoY2FuQ3JlYXRlUHJvY2Vzcyhwcm9jZXNzSW5kaWNhdG9ycykpIHtcblxuICAgICAgICAgICAgICAgIC8vIHZhciBwcm9jZXNzU2VxID0gMTtcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFByb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgICAgICBfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHByb2Nlc3NJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9jZXNzSXRlbS5pZCA9PSBwcm9jZXNzSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm9jZXNzLnB1c2gocHJvY2Vzc0l0ZW0pO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc1NlcSA9IGN1cnJlbnRQcm9jZXNzLmxlbmd0aCArIDE7XG4gICAgICAgICAgICAgICAgLy8gdmFyIG5leHRTZXEgPSBwcm9jZXNzU2VxICsgMTtcbiAgICAgICAgICAgICAgICAvLyBQdXNoIHRoZSBwcm9jZXNzIG9iamVjdCBpbnRvIHRoZSBhcnJheVxuICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzTW9kZWwgPSB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgc2VxOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc2VzOiBbXVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIDEuIFVwZGF0ZSB0aGUgcHJvY2VzcyBpZCBhbmQgc2VxXG4gICAgICAgICAgICAgICAgcHJvY2Vzc01vZGVsLmlkID0gcHJvY2Vzc0lkO1xuICAgICAgICAgICAgICAgIHByb2Nlc3NNb2RlbC5zZXEgPSBwcm9jZXNzU2VxO1xuICAgICAgICAgICAgICAgIF90aGlzLmluc3RhbmNlLnByb2Nlc3Nlcy5wdXNoKHByb2Nlc3NNb2RlbCk7XG4gICAgICAgICAgICAgICAgLy8gUGFyYW1ldGVyc1xuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzSWQgPSBjb25maWdQcm9jZXNzWzBdLnN1YlByb2Nlc3Nlc1swXS5faWQ7XG4gICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NTZXEgPSAxO1xuICAgICAgICAgICAgICAgIF90aGlzLmluc3RhbmNlLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ocHJvY2Vzc0l0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2Nlc3NJdGVtLmlkID09IHByb2Nlc3NJZCAmJiBwcm9jZXNzSXRlbS5zZXEgPT0gcHJvY2Vzc1NlcSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc1NlcSA9IHByb2Nlc3NJdGVtLnN1YlByb2Nlc3Nlcy5sZW5ndGggKyAxXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIENhbGwgdGhlIHN1YnByb2Nlc3MgbWV0aG9kXG4gICAgICAgICAgICAgICAgdmFyIGlucHV0VVVJRCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIGlmKGRhdGEuc3VicHJvY2Vzc1VVSUQgIT0gdW5kZWZpbmVkICYmIGRhdGEuc3VicHJvY2Vzc1VVSUQubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0VVVJRCA9IGRhdGEuc3VicHJvY2Vzc1VVSUQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vY3JlYXRlIHR4blxuICAgICAgICAgICAgICAgIHZhciB0eG5QYWNrZXQgPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogYXBwLlNDT1BFLmNvbW11bml0eUlkLFxuICAgICAgICAgICAgICAgICAgICBcInV1aWRcIjogaW5wdXRVVUlELFxuICAgICAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCxcbiAgICAgICAgICAgICAgICAgICAgXCJ0cmFuc2FjdGlvblR5cGVcIjogXCJzdWJQcm9jZXNzXCIsXG4gICAgICAgICAgICAgICAgICAgIFwiZG9jdW1lbnRzXCI6IFt7XCJkb2N1bWVudFwiOiBpbnB1dFVVSUQsIFwicmV2XCI6IFwiMFwifV1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgZGFvLnN0YXJ0VHJhbnNhY3Rpb24odHhuUGFja2V0KS50aGVuKGZ1bmN0aW9uKHN1Y2MpIHtcblxuICAgICAgICAgICAgICAgICAgICBQcm9jZXNzLnN1YlByb2Nlc3MoaW5wdXRVVUlELCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3VicHJvZmlsZUlkLCBkYXRhLCBfdGhpcykudGhlbihmdW5jdGlvbihzdWJQcm9jZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBHZW5lcmF0ZSB0aGUgdXVpZFxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXVpZCA9IHN1YlByb2Nlc3MuZGF0YS5faWQ7IC8vX3RoaXMucHJvZmlsZSArICc6JyArIF90aGlzLmFwcCArICc6JyArIHByb2Nlc3NJZCArICc6JyArIHByb2Nlc3NTZXEgKyAnOicgKyBzdWJQcm9jZXNzSWQgKyAnOicgKyBzdWJQcm9jZXNzU2VxO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBCdWlsZCB0aGUgc3ViLXByb2Nlc3MgcmVmZXJlbmNlIG9iamVjdFxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3JvdXBLZXkgPSBzdWJQcm9jZXNzLmRhdGEuZ3JvdXBLZXk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1RPRE86IENoYW5nZSByZXF1aXJlZCB0byBtb3ZlIGlzQWN0aXZlIHRvIHN1YlByb2Nlc3MgZmlsZS5SZW1vdmUgZnJvbSBoZXJlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3VicHJvZmlsZUlkID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NSZWYgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHN1YlByb2Nlc3NJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQ6IHN1YnByb2ZpbGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXE6IHN1YlByb2Nlc3MuZGF0YVtcIm1ldGEtZGF0YVwiXS5zdWJQcm9jZXNzSW5zU2VxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV1aWQ6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBLZXk6IGdyb3VwS2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBzdWJQcm9jZXNzLmRhdGEubGFiZWxcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgdGhlIHJlZmVyZW5jZSB0byB0aGUgcHJvY2VzcyBtb2RlbFxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc01vZGVsLnN1YlByb2Nlc3Nlcy5wdXNoKHN1YlByb2Nlc3NSZWYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBzdWJQcm9jZXNzIG1vZGVsIHRvIHRoZSBzdWJwcm9jZXNzZXMgYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vX3RoaXMuc3VicHJvY2Vzc2VzLnB1c2goc3ViUHJvY2Vzcy5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIF90aGlzLmluc3RhbmNlLnByb2Nlc3Nlcy5wdXNoKHByb2Nlc3NNb2RlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgX3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzSXRlbSA9IF90aGlzLmluc3RhbmNlLnByb2Nlc3Nlc1tpbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByb2Nlc3NJdGVtLmlkID09IHByb2Nlc3NJZCAmJiBwcm9jZXNzSXRlbS5zZXEgPT0gcHJvY2Vzc1NlcSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGN1cnJlbnQgcHJvY2VzcyBmcm9tIHRoZSBhcnJheSBhbmQgYWRkIHRoZSB1cGRhdGVkIHByb2Nlc3NNb2RlbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXMuc3BsaWNlKGluZGV4LCAxLCBwcm9jZXNzTW9kZWwpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFByb2Nlc3MgdGhlIGluZGljYXRvciBkb2N1bWVudHMgd29ya2Zsb3cgcHJvY2Vzc2VzIHVwZGF0ZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JzID0gc3ViUHJvY2Vzcy5kYXRhLmluZGljYXRvcnM7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcCA9IHN1YlByb2Nlc3MuZGF0YS5zdGVwO1xuICAgICAgICAgICAgICAgICAgICAgICAgUHJvY2Vzcy5pbmRpY2F0b3JEb2NzKHByb2Nlc3NJZCwgaW5kaWNhdG9ycywgc3RlcCwgX3RoaXMsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1Byb2Nlc3M6ICcgKyBfdGhpcy5jb25maWcucHJvY2Vzc2VzWzBdLl9pZCArICcgaW5pdGlhbGl6ZWQgc3VjY2Vzc2Z1bGx5LicsIHN1YlByb2Nlc3NSZWYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbW1pdCBjYWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXMgPSBfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhKG9iai5pZCA9PSBwcm9jZXNzSWQgJiYgb2JqLnNlcSA9PSBwcm9jZXNzU2VxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgICAgICAgICBpZihlcnIucmVzcG9uc2VKU09OICE9IHVuZGVmaW5lZCAmJiBlcnIucmVzcG9uc2VKU09OLm1lc3NhZ2UgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIucmVzcG9uc2VKU09OLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYoZXJyLnJlc3BvbnNlVGV4dCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9KTtcblxuXG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KFwiQ2Fubm90IGNyZWF0ZSB3b3JrZmxvdyBhcyBvdGhlciBwcm9jZXNzIHVzaW5nIHNhbWUgU0RPIGlzIG5vdCBjb21wbGV0ZVwiKVxuICAgICAgICAgICAgfVxuXG5cblxuXG5cblxuXG5cbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IHRyYW5zaXRpb24gdG8gdGhlIG5leHQgc3RlcC4gVGhpcyBtb3ZlcyB0aGUgd29ya2Zsb3cgZnJvbSB0aGUgY3VycmVudCBwcm9jZXNzLFxuICogc3ViLXByb2Nlc3Mgc3RlcCB0byB0aGUgbmV4dCBvbmUgYXMgc3BlY2lmaWVkLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBwcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gcHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBwcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN1YlByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN1Yi1wcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gc3ViUHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBzdWItcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGVwSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdGVwIGlkIFxuICogQHBhcmFtIHtzdHJpbmd9IHRyYW5zaXRpb25JZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHRyYW5zaXRpb24gaWRcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gYW55IGFkZGl0aW9uYWwgZGF0YSBwYXNzZWQgaW4gYXMga2V5IHZhbHVlIHBhaXJzXG4gKlxuICogQGV4YW1wbGVcbiAqIFdvcmtmbG93LnRyYW5zaXRpb24oJ3Byb2Nlc3NJZCcsIDEsICdzdWJQcm9jZXNzSWQnLCAxLCAnc3RlcElkJywgJ3RyYW5zaXRpb25JZCcsIHsga2V5OiAnJywgdmFsdWU6ICcnIH0pO1xuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLnRyYW5zaXRpb24gPSBmdW5jdGlvbihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCB0cmFuc2l0aW9uSWQsIGRhdGEsIHNwdXVpZCkge1xuICAgIC8vIFJlLWFzc2lnbiB0aGlzXG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgbW9kZWwgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9zdGVwXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgcHJvY2Vzc0lkICsgXCInXS9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NJZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBJZCArIFwiJ11cIiwgX3RoaXMuY29uZmlnLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc1NlcSA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL21ldGEtZGF0YS9zdWJQcm9jZXNzSW5zU2VxXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgdXBkYXRlID0gZnVuY3Rpb24odHlwZSwgcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihwcm9jZXNzSXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2Vzc0l0ZW0uaWQgPT0gcHJvY2Vzc0lkICYmIHByb2Nlc3NJdGVtLnNlcSA9PSBwcm9jZXNzU2VxKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NJdGVtLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzc0l0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViUHJvY2Vzc0l0ZW0uaWQgPT0gc3ViUHJvY2Vzc0lkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc3VicHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihzdWJQcm9jZXNzT2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3ViUHJvY2Vzc09iai5faWQgPT0gc3B1dWlkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZSA9PSAnc3RlcCcpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzT2JqLnN0ZXAgPSByZXN1bHQuZGF0YS5zdGVwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcyhyZXN1bHQubWVzc2FnZSwgc3ViUHJvY2Vzc09iaik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT0gJ3N0ZXBDb21wbGV0ZScpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzT2JqLnN0ZXAgPSByZXN1bHQuZGF0YS5zdGVwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzT2JqLmNvbXBsZXRlID0gdHJ1ZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbnNPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbdXVpZCBlcSAnXCIrIHN1YlByb2Nlc3NPYmouX2lkICtcIiddXCIsYXBwLlNDT1BFLndvcmtmbG93LHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zT2JqZWN0LmNvbXBsZXRlID0gdHJ1ZTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKHJlc3VsdC5tZXNzYWdlLCBzdWJQcm9jZXNzT2JqLnN0ZXApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBwb3N0QWN0aW9ucyA9IHt9XG5cbiAgICAgICAgICAgIGlmKHN0ZXBPYmplY3QuZnVuY3Rpb24udGFzayAhPSB1bmRlZmluZWQgJiYgc3RlcE9iamVjdC5mdW5jdGlvbi50YXNrLnBvc3RBY3Rpb25zICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBwb3N0QWN0aW9ucyA9IHN0ZXBPYmplY3QuZnVuY3Rpb24udGFzay5wb3N0QWN0aW9ucztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBQcm9jZXNzLnBvc3RBY3Rpb25zKHBvc3RBY3Rpb25zLCBfdGhpcywgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICBQcm9jZXNzLnRyYW5zaXRpb24ocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwgdHJhbnNpdGlvbklkLCBkYXRhLCBfdGhpcywgc3B1dWlkLCBtb2RlbCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5kYXRhLnN1YlByb2Nlc3NDb21wbGV0ZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlKCdzdGVwQ29tcGxldGUnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZSgnc3RlcCcsIHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZihzdGVwT2JqZWN0LmZ1bmN0aW9uLnNlcnZlciAhPSB1bmRlZmluZWQgJiYgc3RlcE9iamVjdC5mdW5jdGlvbi5zZXJ2ZXIucG9zdEFjdGlvbnMgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHBvc3RBY3Rpb25zID0gc3RlcE9iamVjdC5mdW5jdGlvbi5zZXJ2ZXIucG9zdEFjdGlvbnM7XG4gICAgICAgICAgICAgICAgUHJvY2Vzcy5wb3N0QWN0aW9ucyhwb3N0QWN0aW9ucywgX3RoaXMsIHNwdXVpZCkudGhlbihmdW5jdGlvbihzdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgUHJvY2Vzcy50cmFuc2l0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHRyYW5zaXRpb25JZCwgZGF0YSwgX3RoaXMsIHNwdXVpZCwgbW9kZWwpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuZGF0YS5zdWJQcm9jZXNzQ29tcGxldGUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZSgnc3RlcENvbXBsZXRlJywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUoJ3N0ZXAnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBQcm9jZXNzLnRyYW5zaXRpb24ocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwgdHJhbnNpdGlvbklkLCBkYXRhLCBfdGhpcywgc3B1dWlkLCBtb2RlbCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmRhdGEuc3ViUHJvY2Vzc0NvbXBsZXRlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZSgnc3RlcENvbXBsZXRlJywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlKCdzdGVwJywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcblxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcblxuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyBhc3NpZ24gdXNlci5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2UgcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdWJQcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdWItcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHN1YlByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2Ugc3ViLXByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RlcElkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3RlcCBpZFxuICogQHBhcmFtIHtvYmplY3R9IHVzZXIgLSB0aGUgdXNlciBpZCBhbmQgbmFtZSBkYXRhXG4gKlxuICogQGV4YW1wbGUgXCJcIlxuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLmFzc2lnblVzZXIgPSBmdW5jdGlvbihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgdXNlciwgdXVpZCkge1xuICAgIC8vIFJlLWFzc2lnbiB0aGUgV29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2UgYXMgX3RoaXNcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBzcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBhcHAuU0NPUEUud29ya2Zsb3csIHt9KVswXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHNwUmV2ID0gc3BPYmplY3QuX3JldjtcbiAgICAgICAgICAgIHZhciB0eG5QYWNrZXQgPSB7XG4gICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBhcHAuU0NPUEUuY29tbXVuaXR5SWQsXG4gICAgICAgICAgICAgICAgXCJ1dWlkXCI6IHV1aWQsXG4gICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQsXG4gICAgICAgICAgICAgICAgXCJ0cmFuc2FjdGlvblR5cGVcIjogXCJzdWJQcm9jZXNzXCIsXG4gICAgICAgICAgICAgICAgXCJkb2N1bWVudHNcIjogW3tcbiAgICAgICAgICAgICAgICAgICAgXCJkb2N1bWVudFwiOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICBcInJldlwiOiBzcFJldlxuICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBQcm9jZXNzLmFzc2lnblVzZXIocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHVzZXIsIHV1aWQsIF90aGlzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuXG4gICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICBcblxuXG4gICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgXG5cblxuXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pXG59O1xuXG4vKipcbiAqIFdvcmtmbG93IHRhc2ssIHRoaXMgbWV0aG9kIGV4ZWN1dGVzIGEgc3BlY2lmaWMgdGFzay5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIHByb2Nlc3MgaWQgdG8gcHJvY2Vzc1xuICogQHBhcmFtIHtvYmplY3R9IGlucHV0RGF0YSAtIHRoZSBpbnB1dCBkYXRhIHRvIHByb2Nlc3NcbiAqXG4gKiBAZXhhbXBsZVxuICogV29ya2Zsb3cuaW5pdGlhbGl6ZSgncHJvY2Vzc0lkJywgeyB2YWxpZERhdGU6ICdkYXRlJyB9KTtcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS51aSA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIFJlLWFzc2lnbiB0aGUgV29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2UgYXMgX3RoaXNcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHJldHVybiB7XG4gICAgICAgIGdldFByb2Nlc3M6IGZ1bmN0aW9uKHByb2Nlc3NJZCwgbGFuZykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJbnRlcmZhY2UuZ2V0UHJvY2Vzcyhwcm9jZXNzSWQsIGxhbmcsIF90aGlzKS50aGVuKGZ1bmN0aW9uKG1vZGVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICB9XG5cbn07XG5cbi8qKlxuICogV29ya2Zsb3cgdGFzaywgdGhpcyBtZXRob2QgZXhlY3V0ZXMgYSBzcGVjaWZpYyB0YXNrLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gdGhlIHByb2Nlc3MgaWQgdG8gcHJvY2Vzc1xuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGlucHV0IGRhdGEgdG8gcHJvY2Vzc1xuICogKiBAcGFyYW0ge3N0cmluZ30gdXVpZCAtIHRoZSBpbnB1dCBkYXRhIHRvIHByb2Nlc3NcbiAqXG4gKiBAZXhhbXBsZVxuICogV29ya2Zsb3cuZ2V0Tm9kZVZhbHVlKGRhdGEsIF9XRkluc3RhbmNlLCB1dWlkKTtcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cblxuV29ya2Zsb3cucHJvdG90eXBlLmdldE5vZGVWYWx1ZSA9IGZ1bmN0aW9uKGRhdGEsIHV1aWQpIHtcbiAgICAvLyBSZS1hc3NpZ24gdGhlIFdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlIGFzIF90aGlzXG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGRhdGEsIF90aGlzLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgIHJlc29sdmUocmVzKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pXG59O1xuXG4vKipcbiAqIFdvcmtmbG93IHRhc2ssIHRoaXMgbWV0aG9kIGV4ZWN1dGVzIGEgc3BlY2lmaWMgdGFzay5cbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gZGF0YSAtIHRoZSBwcm9jZXNzIGlkIHRvIHByb2Nlc3NcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBpbnB1dCBkYXRhIHRvIHByb2Nlc3NcbiAqXG4gKiBAZXhhbXBsZVxuICogV29ya2Zsb3cudGFrZUFzc2lnbm1lbnQoc3B1dWlkLCBfV0ZJbnN0YW5jZSk7XG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5cbldvcmtmbG93LnByb3RvdHlwZS50YWtlQXNzaWdubWVudCA9IGZ1bmN0aW9uKHNwdXVpZCkge1xuICAgIC8vIFJlLWFzc2lnbiB0aGUgV29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2UgYXMgX3RoaXNcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgIFxuICAgICAgICAgICAvL0Fzc2lnbm1lbnQgYXJlIGV4ZWN1dGluZyBoZXJlXG5cbiAgICAgICAgICAgdmFyIHNwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ11cIiwgX3RoaXMsIHt9KVswXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICB2YXIgYXNzaWduZWUgPSBKU09OLnhwYXRoKFwiL3N0ZXAvYXNzaWduZWRUb1wiLCBzcE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAvL1B1c2hpbmcgb2xkZXIgcmVjb3JkIGluIHJlQXNzaWduIGFycmF5XG5cbiAgICAgICAgICAgaWYgKHNwT2JqZWN0LnN0ZXAuYXNzaWdubWVudEhpc3RvcnkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICBzcE9iamVjdC5zdGVwLmFzc2lnbm1lbnRIaXN0b3J5ID0gW107XG4gICAgICAgICAgIH1cbiAgICAgICAgICAgaWYgKGFzc2lnbmVlLnVzZXJJZCAhPSBcIlwiICYmIGFzc2lnbmVlLm5hbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgc3BPYmplY3Quc3RlcC5hc3NpZ25tZW50SGlzdG9yeS5wdXNoKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXNzaWduZWUpKSk7XG4gICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgYXNzaWduZWUubmFtZSA9IF9sY2x4LlNFU1NJT04uZmlyc3ROYW1lICsgXCIgXCIgKyBfbGNseC5TRVNTSU9OLmxhc3ROYW1lO1xuICAgICAgICAgICBhc3NpZ25lZS51c2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG4gICAgICAgICAgIGFzc2lnbmVlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgIGFzc2lnbmVlLnR5cGUgPSBBU1NJR05NRU5UX1RZUEVfQUNDRVBUQU5DRTtcbiAgICAgICAgICAgYXNzaWduZWUuZHVlRGF0ZVRpbWUgPSAnJztcbiAgICAgICAgICAgYXNzaWduZWUuYnkgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG5cblxuICAgICAgICAgICAvL2ZldGNoIHByZVdvcmtBY3Rpb25zIGhlcmUgXG5cbiAgICAgICAgICAgdmFyIHByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzW3N1YlByb2Nlc3Nlcy91dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX3RoaXMsIHt9KVswXTtcbiAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1t1dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX3RoaXMsIHt9KVswXTtcbiAgICAgICAgICAgXG4gICAgICAgICAgIHZhciBzdGVwSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9zdGVwL2lkXCIsIF90aGlzLCB7fSlbMF07XG4gICAgICAgICBcbiAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgcHJvY2Vzc0lkICsgXCInXS9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NJZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBJZCArIFwiJ11cIiwgX3RoaXMuY29uZmlnLCB7fSlbMF07XG5cbiAgICAgICAgICAgaWYgKHN0ZXBPYmplY3QuZnVuY3Rpb24udGFzay5wcmVXb3JrQWN0aW9ucyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgdmFyIHByZVdvcmtBY3Rpb25zID0gc3RlcE9iamVjdC5mdW5jdGlvbi50YXNrLnByZVdvcmtBY3Rpb25zO1xuICAgICAgICAgICAgICAgUHJvY2Vzcy5wcmVXb3JrQWN0aW9ucyhwcmVXb3JrQWN0aW9ucywgX3RoaXMpLnRoZW4oZnVuY3Rpb24oc3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpcyk7XG5cbiAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG5cbiAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgIHJlc29sdmUoX3RoaXMpO1xuXG4gICAgICAgICAgIH1cblxuXG5cblxuXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuXG4gICAgICAgICAgICByZWplY3QoZXJyKTtcblxuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cblxuLyoqXG4gKiBXb3JrZmxvdyB0YXNrLCB0aGlzIG1ldGhvZCBleGVjdXRlcyBhIHNwZWNpZmljIHRhc2suXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IGRhdGEgLSB0aGUgcHJvY2VzcyBpZCB0byBwcm9jZXNzXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgaW5wdXQgZGF0YSB0byBwcm9jZXNzXG4gKlxuICogQGV4YW1wbGVcbiAqIFdvcmtmbG93LmNvbmRpdGlvbihjb25kaXRpb24sIHNwdXVpZCk7XG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5cbldvcmtmbG93LnByb3RvdHlwZS5jb25kaXRpb24gPSBmdW5jdGlvbihjb25kaXRpb24sIHNwdXVpZCkge1xuXG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgdHJ5IHtcblxuICAgICAgICAgICAgdmFyIG9wZXJhdG9yID0gY29uZGl0aW9uLm9wZXJhdG9yO1xuICAgICAgICAgICAgdmFyIGRhdGFCbG9jayA9IGNvbmRpdGlvbi52YWx1ZS5kYXRhO1xuXG4gICAgICAgICAgICBpZiAoY29uZGl0aW9uLnN1YmplY3QuaW5kaWNhdG9yICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHNldElkID0gY29uZGl0aW9uLnN1YmplY3QuaW5kaWNhdG9yLnNldElkO1xuICAgICAgICAgICAgICAgIHZhciBtb2RlbFNjb3BlID0gY29uZGl0aW9uLnN1YmplY3QuaW5kaWNhdG9yLm1vZGVsU2NvcGU7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRQYXRoID0gY29uZGl0aW9uLnN1YmplY3QuaW5kaWNhdG9yLmVsZW1lbnRQYXRoO1xuICAgICAgICAgICAgICAgIGlmIChjb25kaXRpb24uc3ViamVjdC5pbmRpY2F0b3IuY29udGV4dCA9PSAnc3ViUHJvY2VzcycpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgc2V0SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF90aGlzLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JNb2RlbCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX3RoaXMsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGFFbGVtZW50ID0gaW5kaWNhdG9yTW9kZWwubW9kZWxbbW9kZWxTY29wZV0uZGF0YVtzZXRJZF07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgZmluYWxWYWx1ZSA9IGRhdGFFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aFRvRWxlbWVudCA9IGVsZW1lbnRQYXRoID09IFwiXCIgPyBbXSA6IGVsZW1lbnRQYXRoLnNwbGl0KC9bJ1wiXFxbXFxdLl0rLyk7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBwYXRoVG9FbGVtZW50Lmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihwYXRoVG9FbGVtZW50W2tdID09IFwiXCIpIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IGZpbmFsVmFsdWVbcGF0aFRvRWxlbWVudFtrXV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZmluYWxWYWx1ZTsgXG5cbiAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShkYXRhQmxvY2ssIF90aGlzLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gaGVscGVyLmNvbXBhcmUodmFsdWUsIG9wZXJhdG9yLCByZXMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cblxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZGl0aW9uLnN1YmplY3QuaW5kaWNhdG9yLmNvbnRleHQgPT0gJ3N1YlByb2ZpbGUnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9TUDpUT0RPIERPTkVcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvck1vZGVsID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgc2V0SWQgKyBcIiddXCIsIF90aGlzLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YUVsZW1lbnQgPSBpbmRpY2F0b3JNb2RlbC5tb2RlbFttb2RlbFNjb3BlXS5kYXRhW3NldElkXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciBmaW5hbFZhbHVlID0gZGF0YUVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXRoVG9FbGVtZW50ID0gZWxlbWVudFBhdGggPT0gXCJcIiA/IFtdIDogZWxlbWVudFBhdGguc3BsaXQoL1snXCJcXFtcXF0uXSsvKTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHBhdGhUb0VsZW1lbnQubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBhdGhUb0VsZW1lbnRba10gPT0gXCJcIikgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlID0gZmluYWxWYWx1ZVtwYXRoVG9FbGVtZW50W2tdXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBmaW5hbFZhbHVlOyBcblxuICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGRhdGFCbG9jaywgX3RoaXMsIHNwdXVpZCkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBoZWxwZXIuY29tcGFyZSh2YWx1ZSwgb3BlcmF0b3IsIHJlcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdOb3QgaW1wbGVtZW50ZWQnKVxuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNvbmRpdGlvbi5zdWJqZWN0LmluZGljYXRvcldyYXBwZXIgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICByZWplY3QoJ05vdCBpbXBsZW1lbnRlZCcpO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNvbmRpdGlvbi5zdWJqZWN0LnZhcmlhYmxlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgLy8gdmFyIHZhbHVlID0gZGF0YUJsb2NrLnZhbHVlLmRhdGE7XG5cbiAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGRhdGFCbG9jayAsIF90aGlzLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24ocmhzKSB7XG4gICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUoY29uZGl0aW9uLnN1YmplY3QsIF90aGlzLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24obGhzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gaGVscGVyLmNvbXBhcmUobGhzLCBvcGVyYXRvciwgcmhzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgIC8vIHJlamVjdCgnTm90IGltcGxlbWVudGVkJylcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZGl0aW9uLnN1YmplY3Quc3ViUHJvY2VzcyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50UGF0aCA9IGNvbmRpdGlvbi5zdWJqZWN0LnN1YlByb2Nlc3MuZWxlbWVudFBhdGg7XG4gICAgICAgICAgICAgICAgdmFyIHNwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ11cIiwgX3RoaXMsIHt9KVswXTtcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBmaW5hbFZhbHVlID0gc3BPYmplY3Q7XG4gICAgICAgICAgICAgICAgdmFyIHBhdGhUb0VsZW1lbnQgPSBlbGVtZW50UGF0aCA9PSBcIlwiID8gW10gOiBlbGVtZW50UGF0aC5zcGxpdCgvWydcIlxcW1xcXS5dKy8pO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBwYXRoVG9FbGVtZW50Lmxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKHBhdGhUb0VsZW1lbnRba10gPT0gXCJcIikgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBmaW5hbFZhbHVlOyBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGRhdGFCbG9jaywgX3RoaXMsIHNwdXVpZCkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGhlbHBlci5jb21wYXJlKHZhbHVlLCBvcGVyYXRvciwgcmVzKTtcblxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcblxuICAgICAgICAgICAgcmVqZWN0KGVycik7XG5cbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFdvcmtmbG93OyIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWwgPSByZXF1aXJlKCd1dGlsaXR5Jyk7XG52YXIgbm9kZVZhbHVlID0gcmVxdWlyZSgnLi9ub2RlVmFsdWUnKTtcbnZhciBmb3JtID0gcmVxdWlyZSgnLi9mb3JtJyk7XG52YXIgaGVscGVyID0gcmVxdWlyZSgnLi9oZWxwZXInKTtcblxudmFyIGdhdGVrZWVwZXIgPSBuZXcgR0soKTtcblxuLyoqXG4gKiBBY3Rpb25zIE1vZHVsZVxuICpcbiAqIEBtb2R1bGUgbGliL2FjdGlvbnNcbiAqIEBhdXRob3IgSGFzYW4gQWJiYXNcbiAqIEB2ZXJzaW9uIDIuMC4wXG4gKiBAZGVzY3JpcHRpb24gdGVzdCBkZXNjcmlwdGlvblxuICogQGNvcHlyaWdodCBLd2FudHUgTHRkIFJTQSAyMDA5LTIwMTUuXG4gKlxuICovXG5cbi8qKlxuICogIEZvcm0gTW9kdWxlIGFjdGlvbnMgbmVlZHMgdG8gYmUgbW92ZWQgaGVyZS5cbiAqICBUaGlzIGFjdGlvbnMgbW9kdWxlIHdpbGwgYmUgY2VudGFsIHBsYWNlIHRvIGhvbGQgYWxsIGZ1bmN0aW9ucy5cbiAqICBcbiAqL1xuXG52YXIgY29tbXVuaXR5ID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICBjcmVhdGVDb21tdW5pdHk6IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImZvbGxvd1wiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciB1dWlkQ29tbXVuaXR5ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ0NvbW11bml0eSddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZUNvbW11bml0eVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5ld0NvbW11bml0eUlkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImluZGljYXRvclVVSURcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQ29tbXVuaXR5XCI6IHV1aWRDb21tdW5pdHlcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgdXNlckpvaW5Db21tdW5pdHk6IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcbiAgICAgICAgcmVsZWFzZUFkb3B0ZWRBcHBsaWNhdGlvbjogZnVuY3Rpb24oX2RlZiwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiZm9sbG93XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuICAgICAgICAgICAgICAgIHZhciB1dWlkUmVsZWFzZUFkb3B0ZWRBcHBsaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdhZG9wdGVkQXBwbGljYXRpb24nXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwicmVsZWFzZUFkb3B0ZWRBcHBsaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImluZGljYXRvclVVSURcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYWRvcHRlZEFwcGxpY2F0aW9uXCI6IHV1aWRSZWxlYXNlQWRvcHRlZEFwcGxpY2F0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9XG5cbn0pKCk7XG5cbnZhciBhcHBsaWNhdGlvbiA9IChmdW5jdGlvbigpIHtcblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgY3JlYXRlQXBwRGVmaW5pdGlvbjogZnVuY3Rpb24oX2RlZiwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiZm9sbG93XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuICAgICAgICAgICAgICAgIHZhciB1dWlkQXBwbGljYXRpb24gPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnQXBwbGljYXRpb24nXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZUFwcGxpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibmV3QXBwbGljYXRpb25JZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpbmRpY2F0b3JVVUlEXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkFwcGxpY2F0aW9uXCI6IHV1aWRBcHBsaWNhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtlciBwcm9jZXNzZXMgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGJ1aWxkQXBwbGljYXRpb246IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImZvbGxvd1wiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgdXVpZFB1Ymxpc2hBcHBsaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdQdWJsaXNoQXBwbGljYXRpb24nXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciB1dWlkQXBwbGljYXRpb25EZWZpbml0aW9uID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ0FwcGxpY2F0aW9uRGVmaW5pdGlvbiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciB1dWlkUm9sZXMgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnUm9sZXMnXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgdXVpZEFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ0FwcGxpY2F0aW9uJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHV1aWRBcHBQZXJtaXNzaW9ucyA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdBcHBQZXJtaXNzaW9ucyddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJidWlsZEFwcGxpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpbmRpY2F0b3JVVUlEXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlB1Ymxpc2hBcHBsaWNhdGlvblwiOiB1dWlkUHVibGlzaEFwcGxpY2F0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQXBwbGljYXRpb25EZWZpbml0aW9uXCI6IHV1aWRBcHBsaWNhdGlvbkRlZmluaXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJSb2xlc1wiOiB1dWlkUm9sZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJBcHBsaWNhdGlvblwiOiB1dWlkQXBwbGljYXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJBcHBQZXJtaXNzaW9uc1wiOiB1dWlkQXBwUGVybWlzc2lvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBhcHBsaWNhdGlvbkFkb3B0aW9uOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImZvbGxvd1wiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgdXVpZEFkb3B0aW9uID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ0Fkb3B0aW9uJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgdXVpZFB1Ymxpc2hBcHBsaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdQdWJsaXNoQXBwbGljYXRpb24nXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgdXVpZEFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ0FwcGxpY2F0aW9uJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImFkb3B0QXBwbGljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImluZGljYXRvclVVSURcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQWRvcHRpb25cIjogdXVpZEFkb3B0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiUHVibGlzaEFwcGxpY2F0aW9uXCI6IHV1aWRQdWJsaXNoQXBwbGljYXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJBcHBsaWNhdGlvblwiOiB1dWlkQXBwbGljYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVUYXhvbm9teTogZnVuY3Rpb24oX2RlZiwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiZm9sbG93XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuICAgICAgICAgICAgICAgIHZhciB0YXhvbm9teVVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnVGF4b25vbXknXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlVGF4b25vbXlcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ0YXhvbm9teVVVSURcIjogdGF4b25vbXlVVUlEXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtlciBwcm9jZXNzZXMgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG5cbiAgICB9XG5cbn0pKCk7XG5cbnZhciBwZXJmb3JtYW5jZSA9IChmdW5jdGlvbigpIHtcblxuICAgIHJldHVybiB7XG5cblxuICAgICAgICB1bmxvY2tQZXJpb2Q6IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciBlbnRyeVVVSUQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgUEVSSU9EX1NFVF9JRCArIFwiJyBvciBpZCBlcSAnXCIgKyBBVURJVF9QRVJJT0RfU0VUX0lEICsgXCInXS9pbnN0YW5jZXMvdXVpZFwiLCBzdWJwcm9jZXNzT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciBlbmRkYXRlID0gc3VicHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcblxuICAgICAgICAgICAgICAgIGxpYnJhcnkudW5sb2NrUGVyaW9kKGVudHJ5VVVJRCwgZW5kZGF0ZSwgdXVpZCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1VubG9jayBwZXJpb2QuJywgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cblxuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuXG5cblxuXG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldE1vZGVsU3RhdHVzOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBlbnRyeVVVSUQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgUEVSSU9EX1NFVF9JRCArIFwiJyBvciBpZCBlcSAnXCIgKyBBVURJVF9QRVJJT0RfU0VUX0lEICsgXCInXS9pbnN0YW5jZXMvdXVpZFwiLCBzdWJwcm9jZXNzT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciBlbmRkYXRlID0gc3VicHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcblxuICAgICAgICAgICAgICAgIHZhciBzdGF0dXNpMThuTGFiZWwgPSBKU09OLnhwYXRoKFwiL2xhYmVsXCIsIF9kZWYsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdHVzID0gaGVscGVyLmdldExhbmd1YWdlTWVzc2FnZShzdGF0dXNpMThuTGFiZWwpO1xuXG5cbiAgICAgICAgICAgICAgICBsaWJyYXJ5LnNldFBlcmlvZFN0YXR1cyhlbnRyeVVVSUQsIGVuZGRhdGUsIHN0YXR1cywgdXVpZCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ3NldE1vZGVsU3RhdHVzJywgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG5cblxuXG5cblxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuXG4gICAgICAgIGxvY2tQZXJmb3JtYW5jZU1vZGVsOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBlbnRyeVVVSUQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgUEVSRk9STUFOQ0VfU0VUX0lEICsgXCInXS9pbnN0YW5jZXMvdXVpZFwiLCBzdWJwcm9jZXNzT2JqZWN0LCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB2YXIgZW5kZGF0ZSA9IHN1YnByb2Nlc3NPYmplY3QuZGF0ZXMudmFsaWQ7XG5cbiAgICAgICAgICAgICAgICBsaWJyYXJ5LmxvY2tQZXJmb3JtYW5jZU1vZGVsKGVudHJ5VVVJRCwgZW5kZGF0ZSwgdXVpZCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0xvY2sgcGVyZm9ybWFuY2UgbW9kZWwuJywgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfSk7XG5cblxuXG5cblxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuXG52YXIgc2RvID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICBjcmVhdGU6IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImZvbGxvd1wiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgc2RvVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdTRE8nXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlU0RPXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic2RvVVVJRFwiOiBzZG9VVUlEXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtlciBwcm9jZXNzZXMgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG5cbiAgICB9XG5cbn0pKCk7XG5cbnZhciB0YXhvbm9teSA9IChmdW5jdGlvbigpIHtcblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgY3JlYXRlOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJmb2xsb3dcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG4gICAgICAgICAgICAgICAgdmFyIHRheG9ub215VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdUYXhvbm9teSddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVUYXhvbm9teVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInRheG9ub215VVVJRFwiOiB0YXhvbm9teVVVSURcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgIH1cblxufSkoKTtcblxudmFyIHN1YlByb2Nlc3NJbnN0YW5jZSA9IChmdW5jdGlvbigpIHtcblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgc2V0VGl0bGU6IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIGRhdGFWYWx1ZSwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHNwUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBhcHAuU0NPUEUud29ya2Zsb3csIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc1NQT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW3V1aWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYocHJvY2Vzc1NQT2JqZWN0ICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NTUE9iamVjdC5sYWJlbCA9IGRhdGFWYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgc3BQcm9jZXNzT2JqZWN0LmxhYmVsID0gZGF0YVZhbHVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIGl0ZW1zVG9Qcm9jZXNzID0gMTtcbiAgICAgICAgICAgICAgICB2YXIgc3R1ZmYgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0ge307XG5cbiAgICAgICAgICAgICAgICBvYmoubW9kZWwgPSBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXM7XG4gICAgICAgICAgICAgICAgc3R1ZmYucHVzaChvYmopO1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdWJwcm9jZXNzIHNldFRpdGxlIHN1Y2Nlc3MuJywgX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBzZXRWYWxpZERhdGU6IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIGRhdGFWYWx1ZSwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHNwUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBhcHAuU0NPUEUud29ya2Zsb3csIHt9KVswXTtcbiAgICAgICAgICAgICAgICBzcFByb2Nlc3NPYmplY3QuZGF0ZXMudmFsaWQgPSBkYXRhVmFsdWU7XG5cbiAgICAgICAgICAgICAgICB2YXIgaXRlbXNUb1Byb2Nlc3MgPSAxO1xuICAgICAgICAgICAgICAgIHZhciBzdHVmZiA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBvYmogPSB7fTtcblxuICAgICAgICAgICAgICAgIG9iai5tb2RlbCA9IHNwUHJvY2Vzc09iamVjdDtcbiAgICAgICAgICAgICAgICBzdHVmZi5wdXNoKG9iaik7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygndmFsaWQgZGF0ZSBzZXQuJywgX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBzZXRTUFN0YXR1czogZnVuY3Rpb24oX2RlZiwgdXVpZCwgZGF0YVZhbHVlLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3BQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHNwUHJvY2Vzc09iamVjdC5zcFN0YXR1cyA9IGRhdGFWYWx1ZTtcblxuICAgICAgICAgICAgICAgIHZhciBpdGVtc1RvUHJvY2VzcyA9IDE7XG4gICAgICAgICAgICAgICAgdmFyIHN0dWZmID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IHt9O1xuXG4gICAgICAgICAgICAgICAgb2JqLm1vZGVsID0gX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzO1xuICAgICAgICAgICAgICAgIHN0dWZmLnB1c2gob2JqKTtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnU3VicHJvY2VzcyBzcFN0YXR1cyBzdWNjZXNzLicsIF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcyk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICB9XG5cbn0pKCk7XG5cbnZhciB2YXJpYWJsZXMgPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAgIHNldFZhcmlhYmxlOiBmdW5jdGlvbihzZXRWYXJpYWJsZSwgX1dGSW5zdGFuY2UsIHV1aWQpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShzZXRWYXJpYWJsZS5kYXRhLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihkYXRhVmFsdWUpIHtcblxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzY29wZSA9IHNldFZhcmlhYmxlLnNjb3BlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdmFyaWFibGVOYW1lID0gc2V0VmFyaWFibGUubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhcmlhYmxlVHlwZSA9IHNldFZhcmlhYmxlLnZhcmlhYmxlVHlwZTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsaWREYXRlID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2RhdGVzL3ZhbGlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwcm9maWxlJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9maWxlVmFyaWFibGVGaWxlTmFtZSA9IHByb2ZpbGVJZCArICc6dmFyaWFibGVzJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHhuUGFja2V0ID0gYXBwLlNDT1BFLnR4bjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5nZXQocHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUpLnRoZW4oZnVuY3Rpb24oZmlsZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWZQYWNrID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhbFByb2Nlc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZVR5cGUgPT0gJ3BlcmlvZGljJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogT3ZlcndyaXRlIHRoZSBleGlzdGluZyB2YXJpYWJsZSBpbiBjYXNlIHdoZXJlIHNhbWUgdmFyaWFibGUgaXMgYXNzaWduZWQgYXQgbXVsdGlwbGUgc3RlcHMuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBwcm9jZXNzT2JqID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXNbc3ViUHJvY2Vzc2VzL3V1aWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBzZXEgPSBwcm9jZXNzT2JqLnNlcTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3NUeXBlID0gSlNPTi54cGF0aChcIi9jb25maWcvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tfaWQgZXEgL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWRdL3R5cGVcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB2YXIgcGFydCA9IGxpYnJhcnkuZ2V0U3VicHJvZmlsZVN1YnByb2Nlc3NJZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZCBhbmQgX2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgPSBcIiArIHBhcnQgKyBcIl0vX2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnByb2Nlc3NUeXBlID09IFBST0NFU1NfVFlQRV9TVUJQUk9GSUxFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZCBhbmQgdXVpZCA9IFwiKyBwYXJ0ICtcIl0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlck5hbWVcIjogX2xjbHguU1VCU0NSSVBUSU9OUy51c2VybmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IF9sY2x4LlNVQlNDUklQVElPTlMudXNlclByb2ZpbGVJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBzZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsaWREYXRlXCI6IHZhbGlkRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWx1ZVwiOiBkYXRhVmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZVt2YXJpYWJsZU5hbWVdICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmluYWxWYWx1ZSA9IGZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRoVG9FbGVtZW50ID0gdmFyaWFibGVOYW1lID09IFwiXCIgPyBbXSA6IHZhcmlhYmxlTmFtZS5zcGxpdCgvWydcIlxcW1xcXS5dKy8pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcGF0aFRvRWxlbWVudC5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocGF0aFRvRWxlbWVudFtrXSA9PSBcIlwiKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUucHVzaChvYmopO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlW3ZhcmlhYmxlTmFtZV0gPSBbb2JqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZVt2YXJpYWJsZU5hbWVdID0gZGF0YVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uc2F2ZShmaWxlKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZQYWNrLnJldiA9IGRhdGEucmV2O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJWYXJpYWJsZSBzZXQgc3VjY2Vzc2Z1bGx5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJGYWlsZWQgdG8gc2V0IFZhcmlhYmxlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0eG5QYWNrZXQuZG9jdW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUgPT0gdHhuUGFja2V0LmRvY3VtZW50c1tpXS5kb2N1bWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZlBhY2sgPSAgdHhuUGFja2V0LmRvY3VtZW50c1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWZvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eG5QYWNrZXQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFwcC5TQ09QRS50eG4pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4blBhY2tldC5kb2N1bWVudHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZlBhY2sgPSB7IFwiZG9jdW1lbnRcIjogcHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUsIFwicmV2XCI6IChmaWxlLl9yZXY9PXVuZGVmaW5lZCA/IFwiMFwiOiBmaWxlLl9yZXYpIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eG5QYWNrZXQuZG9jdW1lbnRzLnB1c2gocmVmUGFjayk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHAuU0NPUEUudHhuLmRvY3VtZW50cy5wdXNoKHJlZlBhY2spO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8udXBkYXRlVHJhbnNhY3Rpb24odHhuUGFja2V0KS50aGVuKGZ1bmN0aW9uKHN1Y2MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFByb2Nlc3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZXJyLnJlc3BvbnNlSlNPTiAhPSB1bmRlZmluZWQgJiYgZXJyLnJlc3BvbnNlSlNPTi5tZXNzYWdlICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIucmVzcG9uc2VKU09OLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZihlcnIucmVzcG9uc2VUZXh0ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyLnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFByb2Nlc3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiX2lkXCI6IHByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZS5jaGFubmVscyA9IGFwcC5wcm9maWxlLmNoYW5uZWxzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZVR5cGUgPT0gJ3BlcmlvZGljJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy92YXIgcHJvY2Vzc09iaiA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzW3N1YlByb2Nlc3Nlcy91dWlkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBzZXEgPSBwcm9jZXNzT2JqLnNlcTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VicHJvY2Vzc1R5cGUgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0vdHlwZVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCBfaWQgPSAvc3VicHJvY2Vzc2VzW19pZCA9IFwiICsgcGFydCArIFwiXS9faWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJwcm9jZXNzVHlwZSA9PSBQUk9DRVNTX1RZUEVfU1VCUFJPRklMRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCB1dWlkID0gXCIrIHBhcnQgK1wiXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVbdmFyaWFibGVOYW1lXSA9IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlclwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlck5hbWVcIjogX2xjbHguU1VCU0NSSVBUSU9OUy51c2VybmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogX2xjbHguU1VCU0NSSVBUSU9OUy51c2VyUHJvZmlsZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBzZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWxpZERhdGVcIjogdmFsaWREYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsdWVcIjogZGF0YVZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVbdmFyaWFibGVOYW1lXSA9IGRhdGFWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eG5QYWNrZXQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFwcC5TQ09QRS50eG4pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHhuUGFja2V0LmRvY3VtZW50cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVmUGFjayA9IHsgXCJkb2N1bWVudFwiOiBwcm9maWxlVmFyaWFibGVGaWxlTmFtZSwgXCJyZXZcIjogKGZpbGUuX3Jldj09dW5kZWZpbmVkID8gXCIwXCI6IGZpbGUuX3Jldil9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eG5QYWNrZXQuZG9jdW1lbnRzLnB1c2gocmVmUGFjayk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcC5TQ09QRS50eG4uZG9jdW1lbnRzLnB1c2gocmVmUGFjayk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLnVwZGF0ZVRyYW5zYWN0aW9uKHR4blBhY2tldCkudGhlbihmdW5jdGlvbihzdWNjKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uc2F2ZShmaWxlKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZQYWNrLnJldiA9IGRhdGEucmV2O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJWYXJpYWJsZSBzZXQgc3VjY2Vzc2Z1bGx5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJGYWlsZWQgdG8gc2V0IFZhcmlhYmxlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVyci5yZXNwb25zZUpTT04gIT0gdW5kZWZpbmVkICYmIGVyci5yZXNwb25zZUpTT04ubWVzc2FnZSAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIucmVzcG9uc2VKU09OLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKGVyci5yZXNwb25zZVRleHQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVyci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3N1YlByb2Nlc3NJbnN0YW5jZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFwibm90IGltcGxlbWVudGVkXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzdGVwJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJub3QgaW1wbGVtZW50ZWRcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzdWJQcm9maWxlU3ViUHJvY2Vzc0luc3RhbmNlJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lID0gc3ViUHJvZmlsZUlkICsgJzp2YXJpYWJsZXMnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdXBkYXRlIHRyeG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHhuUGFja2V0ID0gYXBwLlNDT1BFLnR4bjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0KHN1YlByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lKS50aGVuKGZ1bmN0aW9uKGZpbGUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLy9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlZlBhY2sgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxvY2FsUHJvY2VzcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhcmlhYmxlVHlwZSA9PSAncGVyaW9kaWMnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFydCA9IGxpYnJhcnkuZ2V0U3VicHJvZmlsZVN1YnByb2Nlc3NJZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB2YXIgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZCBhbmQgX2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgPSBcIiArIHBhcnQgKyBcIl0vX2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWQgYW5kIHV1aWQgPSBcIisgcGFydCArXCJdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlclwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJOYW1lXCI6IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJQcm9maWxlSWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogc2VxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbGlkRGF0ZVwiOiB2YWxpZERhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsdWVcIjogZGF0YVZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpbGVbdmFyaWFibGVOYW1lXSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbmFsVmFsdWUgPSBmaWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aFRvRWxlbWVudCA9IHZhcmlhYmxlTmFtZSA9PSBcIlwiID8gW10gOiB2YXJpYWJsZU5hbWUuc3BsaXQoL1snXCJcXFtcXF0uXSsvKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHBhdGhUb0VsZW1lbnQubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBhdGhUb0VsZW1lbnRba10gPT0gXCJcIikgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlID0gZmluYWxWYWx1ZVtwYXRoVG9FbGVtZW50W2tdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlLnB1c2gob2JqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZVt2YXJpYWJsZU5hbWVdID0gW29ial07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVbdmFyaWFibGVOYW1lXSA9IGRhdGFWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLnNhdmUoZmlsZSkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmUGFjay5yZXYgPSBkYXRhLnJldjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFwiVmFyaWFibGUgYXQgc3VicHJvZmlsZSBzZXQgc3VjY2Vzc2Z1bGx5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJGYWlsZWQgdG8gc2V0IFZhcmlhYmxlIGF0IHN1YnByb2ZpbGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmb3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHR4blBhY2tldC5kb2N1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJQcm9maWxlVmFyaWFibGVGaWxlTmFtZSA9PSB0eG5QYWNrZXQuZG9jdW1lbnRzW2ldLmRvY3VtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmUGFjayA9ICB0eG5QYWNrZXQuZG9jdW1lbnRzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZm91bmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4blBhY2tldCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXBwLlNDT1BFLnR4bikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHhuUGFja2V0LmRvY3VtZW50cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVmUGFjayA9IHsgXCJkb2N1bWVudFwiOiBzdWJQcm9maWxlVmFyaWFibGVGaWxlTmFtZSwgXCJyZXZcIjogKGZpbGUuX3Jldj09dW5kZWZpbmVkID8gXCIwXCI6IGZpbGUuX3JldikgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR4blBhY2tldC5kb2N1bWVudHMucHVzaChyZWZQYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcC5TQ09QRS50eG4uZG9jdW1lbnRzLnB1c2gocmVmUGFjayk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby51cGRhdGVUcmFuc2FjdGlvbih0eG5QYWNrZXQpLnRoZW4oZnVuY3Rpb24oc3VjYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsUHJvY2VzcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihlcnIucmVzcG9uc2VKU09OICE9IHVuZGVmaW5lZCAmJiBlcnIucmVzcG9uc2VKU09OLm1lc3NhZ2UgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVyci5yZXNwb25zZUpTT04ubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKGVyci5yZXNwb25zZVRleHQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsUHJvY2VzcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWxlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfaWRcIjogc3ViUHJvZmlsZVZhcmlhYmxlRmlsZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlLmNoYW5uZWxzID0gYXBwLnByb2ZpbGUuY2hhbm5lbHM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhcmlhYmxlVHlwZSA9PSAncGVyaW9kaWMnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBwcm9jZXNzT2JqID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXNbc3ViUHJvY2Vzc2VzL3V1aWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFyIHNlcSA9IHByb2Nlc3NPYmouc2VxO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCBpZCA9IC9zdWJwcm9jZXNzZXNbX2lkID0gL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbc3VicHJvZmlsZUlkIGVxICdcIiArIHN1YlByb2ZpbGVJZCArIFwiJ10vdXVpZF0vX2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFydCA9IGxpYnJhcnkuZ2V0U3VicHJvZmlsZVN1YnByb2Nlc3NJZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCBfaWQgPSAvc3VicHJvY2Vzc2VzW19pZCA9IFwiICsgcGFydCArIFwiXS9faWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVbdmFyaWFibGVOYW1lXSA9IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlclwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlck5hbWVcIjogX2xjbHguU1VCU0NSSVBUSU9OUy51c2VybmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogX2xjbHguU1VCU0NSSVBUSU9OUy51c2VyUHJvZmlsZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBzZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWxpZERhdGVcIjogdmFsaWREYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsdWVcIjogZGF0YVZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVbdmFyaWFibGVOYW1lXSA9IGRhdGFWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eG5QYWNrZXQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFwcC5TQ09QRS50eG4pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHhuUGFja2V0LmRvY3VtZW50cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVmUGFjayA9IHsgXCJkb2N1bWVudFwiOiBzdWJQcm9maWxlVmFyaWFibGVGaWxlTmFtZSwgXCJyZXZcIjogKGZpbGUuX3Jldj09dW5kZWZpbmVkID8gXCIwXCI6IGZpbGUuX3JldikgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHhuUGFja2V0LmRvY3VtZW50cy5wdXNoKHJlZlBhY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHAuU0NPUEUudHhuLmRvY3VtZW50cy5wdXNoKHJlZlBhY2spO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby51cGRhdGVUcmFuc2FjdGlvbih0eG5QYWNrZXQpLnRoZW4oZnVuY3Rpb24oc3VjYykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uc2F2ZShmaWxlKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWZQYWNrLnJldiA9IGRhdGEucmV2O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJWYXJpYWJsZSBhdCBzdWJwcm9maWxlIHNldCBzdWNjZXNzZnVsbHlcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkZhaWxlZCB0byBzZXQgVmFyaWFibGUgYXQgc3VicHJvZmlsZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVyci5yZXNwb25zZUpTT04gIT0gdW5kZWZpbmVkICYmIGVyci5yZXNwb25zZUpTT04ubWVzc2FnZSAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIucmVzcG9uc2VKU09OLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKGVyci5yZXNwb25zZVRleHQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVyci5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiZ2V0Tm9kZVZhbHVlIHZhbHVlIG5vdCBmb3VuZC5cIik7XG4gICAgICAgICAgICAgICAgfSk7XG5cblxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG5cbiAgICB9XG5cbn0pKCk7XG5cbnZhciBub3RpZmljYXRpb24gPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAgIHNlbmROb3RpZmljYXRpb25Xb3JrZXI6IGZ1bmN0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHV1aWQpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGdldFJlY2lwaWVudHMgPSBmdW5jdGlvbihub3RpZmljYXRpb24pIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWNpcGllbnRzID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnJvbGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5yb2xlID0gbm90aWZpY2F0aW9uLnJlY2lwaWVudHMucm9sZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZWNpcGllbnRzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm90aWZpY2F0aW9uLnJlY2lwaWVudHMucHJvZmlsZVJvbGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5wcm9maWxlUm9sZSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnByb2ZpbGVSb2xlLnJvbGUgPSBub3RpZmljYXRpb24ucmVjaXBpZW50cy5wcm9maWxlUm9sZS5yb2xlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnByb2ZpbGVSb2xlLnByb2ZpbGUgPSBub3RpZmljYXRpb24ucmVjaXBpZW50cy5wcm9maWxlUm9sZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2lwaWVudHMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3RpZmljYXRpb24ucmVjaXBpZW50cy5zdWJQcm9maWxlUm9sZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnN1YlByb2ZpbGVSb2xlID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuc3ViUHJvZmlsZVJvbGUucm9sZSA9IG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnN1YlByb2ZpbGVSb2xlLnJvbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuc3ViUHJvZmlsZVJvbGUuc3ViUHJvZmlsZUNhdGVnb3J5ID0gbm90aWZpY2F0aW9uLnJlY2lwaWVudHMuc3ViUHJvZmlsZVJvbGUuc3ViUHJvZmlsZUNhdGVnb3J5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnN1YlByb2ZpbGVSb2xlLnByb2ZpbGUgPSBub3RpZmljYXRpb24ucmVjaXBpZW50cy5zdWJQcm9maWxlUm9sZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2lwaWVudHMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3RpZmljYXRpb24ucmVjaXBpZW50cy5mdW5jdGlvbiAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLmZ1bmN0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuZnVuY3Rpb24udXNlcnMgPSB7fTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLmZ1bmN0aW9uLnVzZXJzLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihkYXRhVmFsdWUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IGRhdGFWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVjaXBpZW50cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3RpZmljYXRpb24ucmVjaXBpZW50cy5zdGVwQXNzaWduZWUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5zdGVwQXNzaWduZWUgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5zdGVwQXNzaWduZWUucm9sZSA9IG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnN0ZXBBc3NpZ25lZS5yb2xlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2lwaWVudHMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3RpZmljYXRpb24ucmVjaXBpZW50cy5zdGVwQXNzaWduZWVGcm9tU3RlcCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnN0ZXBBc3NpZ25lZUZyb21TdGVwID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwSWQgPSBub3RpZmljYXRpb24ucmVjaXBpZW50cy5zdGVwQXNzaWduZWVGcm9tU3RlcC5zdGVwSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuc3RlcEFzc2lnbmVlRnJvbVN0ZXAuc3RlcElkID0gc3RlcElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjYWxjdWthdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhpc3RvcnlPYmplY3QgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHN1YlByb2Nlc3NPYmplY3QuaGlzdG9yeS5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzdWJQcm9jZXNzT2JqZWN0Lmhpc3RvcnlbaV0uaWQgPT0gc3RlcElkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoaXN0b3J5T2JqZWN0ID0gc3ViUHJvY2Vzc09iamVjdC5oaXN0b3J5W2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihoaXN0b3J5T2JqZWN0LmFzc2lnbm1lbnRIaXN0b3J5ICE9IHVuZGVmaW5lZCAmJiBoaXN0b3J5T2JqZWN0LmFzc2lnbm1lbnRIaXN0b3J5Lmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IGhpc3RvcnlPYmplY3QuYXNzaWdubWVudEhpc3RvcnlbaGlzdG9yeU9iamVjdC5hc3NpZ25tZW50SGlzdG9yeS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuc3RlcEFzc2lnbmVlRnJvbVN0ZXAudXNlcklkID0gb2JqLnVzZXJJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2lwaWVudHMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3RpZmljYXRpb24ucmVjaXBpZW50cy5pbmRpY2F0b3IgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5pbmRpY2F0b3IgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXRJZCA9IG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLmluZGljYXRvci5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRJZCA9IG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLmluZGljYXRvci5lbGVtZW50SWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgaW5kaWNhdG9yU2V0SWQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvbW9kZWwvcGVuZGluZy9kYXRhLycgKyBpbmRpY2F0b3JTZXRJZCArICcvJyArIGVsZW1lbnRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJldFZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5pbmRpY2F0b3IudXNlcklkID0gcmV0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVjaXBpZW50cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm9jZWVkID0gZnVuY3Rpb24oc3ViUHJvY2Vzc09iamVjdCxzdWJwcm9maWxlSWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MubmFtZSA9IHN1YlByb2Nlc3NPYmplY3QubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy5pZCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy52YWxpZERhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLnZhbGlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MuZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMuZHVlO1xuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwT2JqZWN0ID0gc3ViUHJvY2Vzc09iamVjdC5zdGVwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBDcmVhdGVkRGF0ZVRpbWUgPSBzdGVwT2JqZWN0LmRhdGVUaW1lQ3JlYXRlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3RlcC5zdGVwSWQgPSBzdGVwT2JqZWN0LmlkO1xuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwQ29uZmlnT2JqZWN0ID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzT2JqZWN0LmlkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcE9iamVjdC5pZCArIFwiJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBOYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoc3RlcENvbmZpZ09iamVjdC5uYW1lKTtcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2goZSl7XG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm9kZVRpdGxlID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBzdWJwcm9maWxlSWQgKyBcIiddL3RpdGxlXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgIFxuICAgICAgICAgICAgICAgICAgICBcbiAgICBcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub2RlVGl0bGUgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLm5vZGUudGl0bGUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMubm9kZS50aXRsZSA9IG5vZGVUaXRsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICAgICAgICAgIFdvcmtlciBtZXNzYWdlIFxuICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5kZWZhdWx0ID0gbm90aWZpY2F0aW9uLm1lc3NhZ2UuZGVmYXVsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS50aXRsZSA9IG5vdGlmaWNhdGlvbi5tZXNzYWdlLnRpdGxlO1xuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5tZXNzYWdlLnJ0ZiAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UucnRmID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5tZXNzYWdlLnJ0Zi50ZW1wbGF0ZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLnJ0Zi50ZW1wbGF0ZSA9IG5vdGlmaWNhdGlvbi5tZXNzYWdlLnJ0Zi50ZW1wbGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5tZXNzYWdlLnJ0Zi5tYXJrdXAgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5ydGYubWFya3VwID0gbm90aWZpY2F0aW9uLm1lc3NhZ2UucnRmLm1hcmt1cDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgICAgICAgICBXb3JrZXIgbWVzc2FnZVR5cGUgXG4gICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlVHlwZSA9IG5vdGlmaWNhdGlvbi5tZXNzYWdlVHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICAgICAgICAgIFdvcmtlciBub3RpZmljYXRpb25UeXBlIFxuICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uVHlwZSA9IG5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25UeXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgICAgICAgICAgV29ya2VyIHByaW9yaXR5IFxuICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucHJpb3JpdHkgPSBub3RpZmljYXRpb24ucHJpb3JpdHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgICAgICAgICBXb3JrZXIgbm90aWZpY2F0aW9uQWN0aW9uIGlmIGV4aXN0cyBcbiAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbiAhPSB1bmRlZmluZWQpIHtcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmxhYmVsID0gbm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5sYWJlbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJICE9IHVuZGVmaW5lZCkge1xuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLlVSSSA9IG5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLlVSSTtcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG8gIT0gdW5kZWZpbmVkKSB7XG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uZ290byA9IG5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG87XG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5zY2hlZHVsZSAhPSB1bmRlZmluZWQpIHtcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXhlY3V0ZU9iamVjdCA9IG5vdGlmaWNhdGlvbi5zY2hlZHVsZS5leGVjdXRlQ29tbWFuZDtcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgd29ya2VyU2NoZWR1bGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVUaW1lOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bml0OiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3I6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4ZWN1dGVPYmplY3Qubm93ICE9IHVuZGVmaW5lZCkge1xuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgIFxuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5leGFjdCAhPSB1bmRlZmluZWQpIHtcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBleGVjdXRlT2JqZWN0LmV4YWN0LmRhdGVUaW1lO1xuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5kdWVEYXRlICE9IHVuZGVmaW5lZCkge1xuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR1ZURhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLmR1ZTtcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGR1ZURhdGUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KGR1ZURhdGUsIFwiWVlZWS1NTS1ERFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LmR1ZURhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC5kdWVEYXRlLnVuaXQ7XG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZSAhPSB1bmRlZmluZWQpIHtcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0ZWREYXRlVGltZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbGlkRGF0ZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQodmFsaWREYXRlLCBcIllZWVktTU0tRERcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC52YWxpZERhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC52YWxpZERhdGUudW5pdDtcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlICE9IHVuZGVmaW5lZCkge1xuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0ZWREYXRlVGltZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwQ3JlYXRlZERhdGVUaW1lID0gc3ViUHJvY2Vzc09iamVjdC5zdGVwLmR1ZURhdGVUaW1lO1xuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RlcENyZWF0ZWREYXRlVGltZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoc3RlcENyZWF0ZWREYXRlVGltZSkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUudW5pdDtcbiAgICBcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0U2NoZWR1bGUod29ya2VyU2NoZWR1bGUpO1xuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgICAgICAgICBXb3JrZXIgcmVjaXBpZW50c1xuICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICBcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBub3RpZmljYXRpb24gPT09IFwic3RyaW5nXCIpe1xuICAgIFxuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5nZXRDb25maWcobm90aWZpY2F0aW9uKS50aGVuKGZ1bmN0aW9uKG5vdGlPYmplY3Qpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24gPSBhc3NpZ25tZW50T2JqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0UmVjaXBpZW50cyhub3RpZmljYXRpb24pLnRoZW4oZnVuY3Rpb24ocmVjaXBpZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLnJlY2lwaWVudHMgPSByZWNpcGllbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0TWVzc2FnZShcIlRoZSBzZXJ2ZXIgaXMgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuIFBsZWFzZSB3YWl0IGEgZmV3IHNlY29uZHMgYW5kIHRoZW4gY2xpY2sgdGhlIHJlZnJlc2ggYnV0dG9uLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRBY3Rpb24oYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldENvbnRleHQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcERhdGVUaW1lOiBzdWJQcm9jZXNzT2JqZWN0LnN0ZXAuZGF0ZVRpbWVDcmVhdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZCgpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHdvcmtlck9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ05vdGlmaWNhdGlvbiBXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vdGlmaWNhdGlvbiAtIGdldFJlY2lwaWVudHMgZmFpbGVkIHdpdGggZXJyb3IgXCIgKyBlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihmYWlsKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShmYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgIFxuICAgIFxuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRSZWNpcGllbnRzKG5vdGlmaWNhdGlvbikudGhlbihmdW5jdGlvbihyZWNpcGllbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5yZWNpcGllbnRzID0gcmVjaXBpZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0TWVzc2FnZShcIlRoZSBzZXJ2ZXIgaXMgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuIFBsZWFzZSB3YWl0IGEgZmV3IHNlY29uZHMgYW5kIHRoZW4gY2xpY2sgdGhlIHJlZnJlc2ggYnV0dG9uLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldEFjdGlvbihhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0Q29udGV4dCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcERhdGVUaW1lOiBzdWJQcm9jZXNzT2JqZWN0LnN0ZXAuZGF0ZVRpbWVDcmVhdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZCgpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cod29ya2VyT2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdOb3RpZmljYXRpb24gV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vdGlmaWNhdGlvbiAtIGdldFJlY2lwaWVudHMgZmFpbGVkIHdpdGggZXJyb3IgXCIgKyBlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoYW5nZVRheEZ1bmN0aW9uID0gZnVuY3Rpb24oYXIsIGksc3ViUHJvY2Vzc09iamVjdCxzdWJwcm9maWxlSWQpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihhci5sZW5ndGggPT0gaSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2VlZChzdWJQcm9jZXNzT2JqZWN0LHN1YnByb2ZpbGVJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrID0gYXJbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoay5maWVsZCAhPVwiXCIgJiYgay5yZXBTdHIgIT0gXCJcIiAmJiBrLnNldElkICE9XCJcIil7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclZlcnNpb24gPSBcIjFcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBwLlNDT1BFLkFQUF9DT05GSUcuaW5kaWNhdG9ycy5mb3JFYWNoKGZ1bmN0aW9uKGFwcENvbmZpZ0luZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihhcHBDb25maWdJbmQuc2V0SWQgPT0gay5zZXRJZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yVmVyc2lvbiA9IGFwcENvbmZpZ0luZC52ZXJzaW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0VGF4b25vbXkoXCJGaWVsZF9JbmRpY2F0b3JfXCIrIGsuc2V0SWQgK1wiOlwiKyBpbmRpY2F0b3JWZXJzaW9uKS50aGVuKGZ1bmN0aW9uKGZpZWxkSW5kVGF4KXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpZWxkT2JqZWN0ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2hpbmdLZXkgPSBrLmZpZWxkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRJbmRUYXguZGF0YS5pdGVtcy5pdGVtLmZvckVhY2goZnVuY3Rpb24oZm8pe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGZvLmNvZGUgPT0gbWF0Y2hpbmdLZXkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZE9iamVjdCA9IGZvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5mb3JFYWNoKGZ1bmN0aW9uKHNwSW5kKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzcEluZC5jYXRlZ29yeS50ZXJtID09IGsuc2V0SWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmplY3QgPSBzcEluZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGsuZmllbGQuaW5kZXhPZihcIi5cIik+LTEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWVsZDEgPSBrLmZpZWxkLnNwbGl0KFwiLlwiKVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmllbGQyID0gay5maWVsZC5zcGxpdChcIi5cIilbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5kT2JqZWN0Lm1vZGVsICE9IHVuZGVmaW5lZCAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcgIT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGEgIT11bmRlZmluZWQgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGFbay5zZXRJZF0gIT11bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YVtrLnNldElkXVtmaWVsZDFdIT11bmRlZmluZWQgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGFbay5zZXRJZF1bZmllbGQxXVtmaWVsZDJdIT11bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhW2suc2V0SWRdW2ZpZWxkMV1bZmllbGQyXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGluZE9iamVjdC5tb2RlbCAhPSB1bmRlZmluZWQgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nICE9IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhICE9dW5kZWZpbmVkICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhW2suc2V0SWRdICE9dW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGFbay5zZXRJZF1bay5maWVsZF0hPXVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGFbay5zZXRJZF1bay5maWVsZF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihmaWVsZE9iamVjdC5kYXRhdHlwZSAhPSBudWxsICYmIGZpZWxkT2JqZWN0LmRhdGF0eXBlICE9IHVuZGVmaW5lZCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiBmaWVsZE9iamVjdC5kYXRhdHlwZSAhPVwiXCIgJiYgZmllbGRPYmplY3QuZGF0YXR5cGUgPT0gXCJjdXJyZW5jeVwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBjdXJyZW5jeVN5bWJvbCArIFwiIFwiKyBudW1iZXJXaXRoQ29tbWFzKHZhbHVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMudXNlckRlZmluZWQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJrZXlcIjpcIiNcIitrLnJlcFN0citcIiNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbHVlXCI6IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFuZ2VUYXhGdW5jdGlvbihhciwgaSsxLHN1YlByb2Nlc3NPYmplY3Qsc3VicHJvZmlsZUlkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOb3RpZmljYXRpb24gZXJyb3I6IEVycm9yIGZldGNoaW5nIEZpZWxkIEluZGljYXRvciB0YXhvbm9teVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gbmV3IE5vdGlmaWNhdGlvV29ya2VyKGFwcCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2ZpbGVJZCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9tZXRhLWRhdGEvc3VicHJvZmlsZUlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyB2YXIgcGF0aEFycmF5ID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLnNwbGl0KCcvJyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBiYXNlVVJMID0gRE9NQUlOLnJlcGxhY2UoXCJleGlzdC9yZXN0XCIsXCJcIik7IFxuICAgICAgICAgICAgICAgICAgICAvL3dpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCArIFwiLy9cIiArIHdpbmRvdy5sb2NhdGlvbi5ob3N0ICsgXCIvXCIgKyBwYXRoQXJyYXlbMV07XG5cblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlVHlwZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWV0YS1kYXRhXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IF9XRkluc3RhbmNlLmFwcCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBfV0ZJbnN0YW5jZS5jb21tdW5pdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2ZpbGVJZFwiOiBzdWJQcm9maWxlSWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uVHlwZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3VicHJvZmlsZUlkXCI6IHN1YnByb2ZpbGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByaW9yaXR5XCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWNpcGllbnRzXCI6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1cmxcIjogYmFzZVVSTCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImtleXNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImN1cnJlbnRVc2VyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsaWREYXRlXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImR1ZURhdGVcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZWREYXRlVGltZVwiOiBtb21lbnQoKS5mb3JtYXQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0ZXBcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwQ3JlYXRlZERhdGVUaW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0ZXBOYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0ZXBJZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibm9kZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRpdGxlXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VyRGVmaW5lZFwiOltdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgICAgICBLZXlzIG1lc3NhZ2UgXG4gICAgICAgICAgICAgICAgICAgICovXG5cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclRpdGxlID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBhcHAucHJvZmlsZS5faWQgKyBcIiddL3RpdGxlXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMucHJvZmlsZS5uYW1lID0gaW5kaWNhdG9yVGl0bGU7XG5cbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnByb2ZpbGUuaWQgPSBhcHAucHJvZmlsZS5faWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmNvbW11bml0eS5uYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoX2xjbHguQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmNvbW11bml0eS5pZCA9IF9sY2x4LkNPTU1VTklUWV9DT05GSUcuY29tbXVuaXR5SWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9hcHBsaWNhdGlvbnNbYXBwSWQgZXEgJ1wiICsgYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQgKyBcIiddXCIsIF9sY2x4LkNPTU1VTklUWV9DT05GSUcsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuYXBwbGljYXRpb24ubmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKGFwcGxpY2F0aW9uLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuYXBwbGljYXRpb24uaWQgPSBhcHBsaWNhdGlvbi5hcHBJZDtcblxuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY3VycmVudFVzZXIubmFtZSA9IF9sY2x4LlNFU1NJT04uZmlyc3ROYW1lICsgXCIgXCIgKyBfbGNseC5TRVNTSU9OLmxhc3ROYW1lO1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY3VycmVudFVzZXIuaWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVuY3lTeW1ib2wgPSBcIlwiO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKF9sY2x4LkNPTU1VTklUWV9DT05GSUcuc2V0dGluZ3MgIT0gdW5kZWZpbmVkIFxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgX2xjbHguQ09NTVVOSVRZX0NPTkZJRy5zZXR0aW5ncy5jdXJyZW5jeVN5bWJvbCAhPSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbmN5U3ltYm9sID0gX2xjbHguQ09NTVVOSVRZX0NPTkZJRy5zZXR0aW5ncy5jdXJyZW5jeVN5bWJvbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVuY3lTeW1ib2wgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmKG5vdGlmaWNhdGlvbi5zZG9LZXlzID09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uc2RvS2V5cyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZihub3RpZmljYXRpb24uc2RvS2V5cyAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlVGF4RnVuY3Rpb24obm90aWZpY2F0aW9uLnNkb0tleXMsIDAsc3ViUHJvY2Vzc09iamVjdCxzdWJwcm9maWxlSWQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ05vdGlmaWNhdGlvbiBXb3JrZXIgcHJvY2Vzc2VzIHdpdGggbm8gc2RvIGtleXMuJywgXCJzdWNjZXNzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG5cbiAgICAgICAgcmVBc3NpZ25tZW50Tm90aWZpY2F0aW9uOiBmdW5jdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCB1dWlkLCB1c2VyKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuXG4gICAgICAgICAgICAgICAgdmFyIGdldFJlY2lwaWVudHMgPSBmdW5jdGlvbih1c2VyT2JqKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlY2lwaWVudHMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuZnVuY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuZnVuY3Rpb24udXNlcnMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuZnVuY3Rpb24udXNlcnMgPSB1c2VyT2JqLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZWNpcGllbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gbmV3IE5vdGlmaWNhdGlvV29ya2VyKGFwcCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvZmlsZUlkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL21ldGEtZGF0YS9zdWJwcm9maWxlSWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAvLyB2YXIgcGF0aEFycmF5ID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLnNwbGl0KCcvJyk7XG4gICAgICAgICAgICAgICAgdmFyIGJhc2VVUkwgPSBET01BSU4ucmVwbGFjZShcImV4aXN0L3Jlc3RcIixcIlwiKTtcbiAgICAgICAgICAgICAgICAvL3dpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCArIFwiLy9cIiArIHdpbmRvdy5sb2NhdGlvbi5ob3N0ICsgXCIvXCIgKyBwYXRoQXJyYXlbMV07XG5cblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJydGZcIjoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZVR5cGVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWV0YS1kYXRhXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogX1dGSW5zdGFuY2UuYXBwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogX1dGSW5zdGFuY2UuY29tbXVuaXR5SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9maWxlSWRcIjogc3ViUHJvZmlsZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25UeXBlXCI6IFwid29ya2Zsb3dcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJpb3JpdHlcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVjaXBpZW50c1wiOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInVybFwiOiBiYXNlVVJMLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJrZXlzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImN1cnJlbnRVc2VyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWxpZERhdGVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkdWVEYXRlXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVkRGF0ZVRpbWVcIjogbW9tZW50KCkuZm9ybWF0KClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcENyZWF0ZWREYXRlVGltZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0ZXBOYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcElkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibm9kZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidGl0bGVcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VyRGVmaW5lZFwiOltdXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIEtleXMgbWVzc2FnZSBcbiAgICAgICAgICAgICAgICAqL1xuXG5cbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICBpZihub3RpZmljYXRpb24ucmVBc3NpZ25tZW50LnNkb0tleXMgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC5zZG9LZXlzLmZvckVhY2goZnVuY3Rpb24oayl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGsuZmllbGQgIT1cIlwiICYmIGsucmVwU3RyICE9IFwiXCIgJiYgay5zZXRJZCAhPVwiXCIpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLmluZGljYXRvcnMuZm9yRWFjaChmdW5jdGlvbihzcEluZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNwSW5kLmNhdGVnb3J5LnRlcm0gPT0gay5zZXRJZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmplY3QgPSBzcEluZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IFwiXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihrLmZpZWxkLmluZGV4T2YoXCIuXCIpPi0xKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpZWxkMSA9IGsuZmllbGQuc3BsaXQoXCIuXCIpWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmllbGQyID0gay5maWVsZC5zcGxpdChcIi5cIilbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpbmRPYmplY3QubW9kZWwgIT0gdW5kZWZpbmVkICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcgIT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhICE9dW5kZWZpbmVkICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YVtrLnNldElkXSAhPXVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YVtrLnNldElkXVtmaWVsZDFdIT11bmRlZmluZWQgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhW2suc2V0SWRdW2ZpZWxkMV1bZmllbGQyXSE9dW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGFbay5zZXRJZF1bZmllbGQxXVtmaWVsZDJdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5kT2JqZWN0Lm1vZGVsICE9IHVuZGVmaW5lZCAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nICE9IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YSAhPXVuZGVmaW5lZCAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGFbay5zZXRJZF0gIT11bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGFbay5zZXRJZF1bay5maWVsZF0hPXVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhW2suc2V0SWRdW2suZmllbGRdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy51c2VyRGVmaW5lZC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJrZXlcIjpcIiNcIitrLnJlcFN0citcIiNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWx1ZVwiOiB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVGl0bGUgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGFwcC5wcm9maWxlLl9pZCArIFwiJ10vdGl0bGVcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIC8vIGFhZGQga2V5cyB2YWx1ZXMgaGVyZVxuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnByb2ZpbGUubmFtZSA9IGluZGljYXRvclRpdGxlO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5wcm9maWxlLmlkID0gYXBwLnByb2ZpbGUuX2lkO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmNvbW11bml0eS5uYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoX2xjbHguQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlOYW1lKTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY29tbXVuaXR5LmlkID0gX2xjbHguQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlJZDtcblxuICAgICAgICAgICAgICAgIHZhciBhcHBsaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvYXBwbGljYXRpb25zW2FwcElkIGVxICdcIiArIGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkICsgXCInXVwiLCBfbGNseC5DT01NVU5JVFlfQ09ORklHLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuYXBwbGljYXRpb24ubmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKGFwcGxpY2F0aW9uLm5hbWUpO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5hcHBsaWNhdGlvbi5pZCA9IGFwcGxpY2F0aW9uLmFwcElkO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmN1cnJlbnRVc2VyLm5hbWUgPSBfbGNseC5TRVNTSU9OLmZpcnN0TmFtZSArIFwiIFwiICsgX2xjbHguU0VTU0lPTi5sYXN0TmFtZTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY3VycmVudFVzZXIuaWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcblxuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MubmFtZSA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9sYWJlbFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLmlkID0gdXVpZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLnZhbGlkRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMudmFsaWQ7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MuZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMuZHVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBzdWJQcm9jZXNzT2JqZWN0LnN0ZXA7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN0ZXAuc3RlcENyZWF0ZWREYXRlVGltZSA9IHN0ZXBPYmplY3QuZGF0ZVRpbWVDcmVhdGVkO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBJZCA9IHN0ZXBPYmplY3QuaWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RlcENvbmZpZ09iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc09iamVjdC5pZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBPYmplY3QuaWQgKyBcIiddXCIsIGFwcC5TQ09QRS53b3JrZmxvdy5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3RlcC5zdGVwTmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKHN0ZXBDb25maWdPYmplY3QubmFtZSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgbm9kZVRpdGxlID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBzdWJQcm9maWxlSWQgKyBcIiddL3RpdGxlXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuXG5cblxuXG4gICAgICAgICAgICAgICAgaWYgKG5vZGVUaXRsZSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLm5vZGUudGl0bGUgPSBcIlwiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5ub2RlLnRpdGxlID0gbm9kZVRpdGxlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIG1lc3NhZ2UgXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UuZGVmYXVsdCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLnRpdGxlID0gbm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC50aXRsZTtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZSA9IG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQubWVzc2FnZTtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBtZXNzYWdlVHlwZSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZVR5cGUgPSBub3RpZmljYXRpb24ucmVBc3NpZ25tZW50Lm1lc3NhZ2VUeXBlO1xuXG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBwcmlvcml0eSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucHJpb3JpdHkgPSBub3RpZmljYXRpb24ucmVBc3NpZ25tZW50LnByaW9yaXR5O1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIG5vdGlmaWNhdGlvbkFjdGlvbiBpZiBleGlzdHMgXG4gICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24ucmVBc3NpZ25tZW50Lm5vdGlmaWNhdGlvbkFjdGlvbiAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5sYWJlbCA9IG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQubm90aWZpY2F0aW9uQWN0aW9uLmxhYmVsO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLlVSSSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJID0gbm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLlVSSTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvID0gbm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG87XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQuc2NoZWR1bGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGV4ZWN1dGVPYmplY3QgPSBub3RpZmljYXRpb24ucmVBc3NpZ25tZW50LnNjaGVkdWxlLmV4ZWN1dGVDb21tYW5kO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB3b3JrZXJTY2hlZHVsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVUaW1lOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdW5pdDogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcjogXCJcIlxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4ZWN1dGVPYmplY3Qubm93ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LmV4YWN0ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGV4ZWN1dGVPYmplY3QuZXhhY3QuZGF0ZVRpbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LmR1ZURhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR1ZURhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLmR1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGR1ZURhdGUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudChkdWVEYXRlLCBcIllZWVktTU0tRERcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3QuZHVlRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC5kdWVEYXRlLnVuaXQ7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0ZWREYXRlVGltZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMudmFsaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWxpZERhdGUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCh2YWxpZERhdGUsIFwiWVlZWS1NTS1ERFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC52YWxpZERhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUudW5pdCA9IGV4ZWN1dGVPYmplY3QudmFsaWREYXRlLnVuaXQ7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0ZWREYXRlVGltZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcENyZWF0ZWREYXRlVGltZSA9IHN1YlByb2Nlc3NPYmplY3Quc3RlcC5kdWVEYXRlVGltZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0ZXBDcmVhdGVkRGF0ZVRpbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudChzdGVwQ3JlYXRlZERhdGVUaW1lKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUudW5pdCA9IGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlLnVuaXQ7XG5cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0U2NoZWR1bGUod29ya2VyU2NoZWR1bGUpO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIHJlY2lwaWVudHNcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgZ2V0UmVjaXBpZW50cyh1c2VyKS50aGVuKGZ1bmN0aW9uKHJlY2lwaWVudCkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLnJlY2lwaWVudHMgPSByZWNpcGllbnQ7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRBY3Rpb24oYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldE1lc3NhZ2UoXCJUaGUgc2VydmVyIGlzIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0LiBQbGVhc2Ugd2FpdCBhIGZldyBzZWNvbmRzIGFuZCB0aGVuIGNsaWNrIHRoZSByZWZyZXNoIGJ1dHRvbi5cIik7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kKCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdOb3RpZmljYXRpb24gV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkgZm9yIHJlYXNzaWdubWVudC4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTm90aWZpY2F0aW9uIC0gZ2V0UmVjaXBpZW50cyBmYWlsZWQgd2l0aCBlcnJvciBcIiArIGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuXG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBhc3NpZ25tZW50Tm90aWZpY2F0aW9uOiBmdW5jdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCB1dWlkLCB1c2VyKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuXG4gICAgICAgICAgICAgICAgdmFyIGdldFJlY2lwaWVudHMgPSBmdW5jdGlvbih1c2VyT2JqKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlY2lwaWVudHMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuZnVuY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuZnVuY3Rpb24udXNlcnMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuZnVuY3Rpb24udXNlcnMgPSB1c2VyT2JqLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZWNpcGllbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IG5ldyBOb3RpZmljYXRpb1dvcmtlcihhcHApO1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvZmlsZUlkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL21ldGEtZGF0YS9zdWJwcm9maWxlSWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyB2YXIgcGF0aEFycmF5ID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLnNwbGl0KCcvJyk7XG4gICAgICAgICAgICAgICAgdmFyIGJhc2VVUkwgPSBET01BSU4ucmVwbGFjZShcImV4aXN0L3Jlc3RcIixcIlwiKTtcbiAgICAgICAgICAgICAgICAvL3dpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCArIFwiLy9cIiArIHdpbmRvdy5sb2NhdGlvbi5ob3N0ICsgXCIvXCIgKyBwYXRoQXJyYXlbMV07XG5cblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJydGZcIjoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZVR5cGVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWV0YS1kYXRhXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogX1dGSW5zdGFuY2UuYXBwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogX1dGSW5zdGFuY2UuY29tbXVuaXR5SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9maWxlSWRcIjogc3ViUHJvZmlsZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25UeXBlXCI6IFwid29ya2Zsb3dcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJpb3JpdHlcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVjaXBpZW50c1wiOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInVybFwiOiBiYXNlVVJMLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJrZXlzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImN1cnJlbnRVc2VyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWxpZERhdGVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkdWVEYXRlXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVkRGF0ZVRpbWVcIjogbW9tZW50KCkuZm9ybWF0KClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcENyZWF0ZWREYXRlVGltZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0ZXBOYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcElkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibm9kZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidGl0bGVcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VyRGVmaW5lZFwiOiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgS2V5cyBtZXNzYWdlIFxuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgaWYobm90aWZpY2F0aW9uLmFzc2lnbm1lbnQuc2RvS2V5cyAhPSB1bmRlZmluZWQpe1xuXG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50LnNkb0tleXMuZm9yRWFjaChmdW5jdGlvbihrKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoay5maWVsZCAhPVwiXCIgJiYgay5yZXBTdHIgIT0gXCJcIiAmJiBrLnNldElkICE9XCJcIil7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5mb3JFYWNoKGZ1bmN0aW9uKHNwSW5kKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3BJbmQuY2F0ZWdvcnkudGVybSA9PSBrLnNldElkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdCA9IHNwSW5kXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGsuZmllbGQuaW5kZXhPZihcIi5cIik+LTEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmllbGQxID0gay5maWVsZC5zcGxpdChcIi5cIilbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWVsZDIgPSBrLmZpZWxkLnNwbGl0KFwiLlwiKVsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGluZE9iamVjdC5tb2RlbCAhPSB1bmRlZmluZWQgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmplY3QubW9kZWwucGVuZGluZyAhPSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGEgIT11bmRlZmluZWQgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhW2suc2V0SWRdICE9dW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhW2suc2V0SWRdW2ZpZWxkMV0hPXVuZGVmaW5lZCAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGFbay5zZXRJZF1bZmllbGQxXVtmaWVsZDJdIT11bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YVtrLnNldElkXVtmaWVsZDFdW2ZpZWxkMl1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpbmRPYmplY3QubW9kZWwgIT0gdW5kZWZpbmVkICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcgIT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhICE9dW5kZWZpbmVkICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YVtrLnNldElkXSAhPXVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YVtrLnNldElkXVtrLmZpZWxkXSE9dW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGFbay5zZXRJZF1bay5maWVsZF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMudXNlckRlZmluZWQucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwia2V5XCI6XCIjXCIray5yZXBTdHIrXCIjXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsdWVcIjogdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXG5cblxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JUaXRsZSA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgYXBwLnByb2ZpbGUuX2lkICsgXCInXS90aXRsZVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMucHJvZmlsZS5uYW1lID0gaW5kaWNhdG9yVGl0bGU7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnByb2ZpbGUuaWQgPSBhcHAucHJvZmlsZS5faWQ7XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY29tbXVuaXR5Lm5hbWUgPSBhcHAuZ2V0TmFtZUJ5TGFuZyhfbGNseC5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eU5hbWUpO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jb21tdW5pdHkuaWQgPSBfbGNseC5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eUlkO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9hcHBsaWNhdGlvbnNbYXBwSWQgZXEgJ1wiICsgYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQgKyBcIiddXCIsIF9sY2x4LkNPTU1VTklUWV9DT05GSUcsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5hcHBsaWNhdGlvbi5uYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoYXBwbGljYXRpb24ubmFtZSk7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmFwcGxpY2F0aW9uLmlkID0gYXBwbGljYXRpb24uYXBwSWQ7XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY3VycmVudFVzZXIubmFtZSA9IF9sY2x4LlNFU1NJT04uZmlyc3ROYW1lICsgXCIgXCIgKyBfbGNseC5TRVNTSU9OLmxhc3ROYW1lO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jdXJyZW50VXNlci5pZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuXG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy5uYW1lID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2xhYmVsXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MuaWQgPSB1dWlkO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MudmFsaWREYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy5kdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy5kdWU7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IHN1YlByb2Nlc3NPYmplY3Quc3RlcDtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3RlcC5zdGVwQ3JlYXRlZERhdGVUaW1lID0gc3RlcE9iamVjdC5kYXRlVGltZUNyZWF0ZWQ7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN0ZXAuc3RlcElkID0gc3RlcE9iamVjdC5pZDtcblxuICAgICAgICAgICAgICAgIHZhciBzdGVwQ29uZmlnT2JqZWN0ID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzT2JqZWN0LmlkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcE9iamVjdC5pZCArIFwiJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN0ZXAuc3RlcE5hbWUgPSBhcHAuZ2V0TmFtZUJ5TGFuZyhzdGVwQ29uZmlnT2JqZWN0Lm5hbWUpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG5vZGVUaXRsZSA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgc3ViUHJvZmlsZUlkICsgXCInXS90aXRsZVwiLCBhcHAuU0NPUEUud29ya2Zsb3csIHt9KVswXTtcbiAgICAgICAgICAgICAgICBpZiAobm9kZVRpdGxlID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMubm9kZS50aXRsZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLm5vZGUudGl0bGUgPSBub2RlVGl0bGU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbWVzc2FnZSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5kZWZhdWx0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UudGl0bGUgPSBub3RpZmljYXRpb24uYXNzaWdubWVudC50aXRsZTtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZSA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Lm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbWVzc2FnZVR5cGUgXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2VUeXBlID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQubWVzc2FnZVR5cGU7XG5cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIHByaW9yaXR5IFxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5wcmlvcml0eSA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50LnByaW9yaXR5O1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIG5vdGlmaWNhdGlvbkFjdGlvbiBpZiBleGlzdHMgXG4gICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24uYXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24ubGFiZWwgPSBub3RpZmljYXRpb24uYXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24ubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24uYXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLlVSSSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3RpZmljYXRpb24uYXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG8gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG8gPSBub3RpZmljYXRpb24uYXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG87XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24uYXNzaWdubWVudC5zY2hlZHVsZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZXhlY3V0ZU9iamVjdCA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50LnNjaGVkdWxlLmV4ZWN1dGVDb21tYW5kO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB3b3JrZXJTY2hlZHVsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVUaW1lOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdW5pdDogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcjogXCJcIlxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4ZWN1dGVPYmplY3Qubm93ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LmV4YWN0ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGV4ZWN1dGVPYmplY3QuZXhhY3QuZGF0ZVRpbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LmR1ZURhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy5kdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkdWVEYXRlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoZHVlRGF0ZSwgXCJZWVlZLU1NLUREXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LmR1ZURhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUudW5pdCA9IGV4ZWN1dGVPYmplY3QuZHVlRGF0ZS51bml0O1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC52YWxpZERhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR1ZURhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLnZhbGlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWREYXRlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQodmFsaWREYXRlLCBcIllZWVktTU0tRERcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3QudmFsaWREYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZS51bml0O1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBDcmVhdGVkRGF0ZVRpbWUgPSBzdWJQcm9jZXNzT2JqZWN0LnN0ZXAuZHVlRGF0ZVRpbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGVwQ3JlYXRlZERhdGVUaW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoc3RlcENyZWF0ZWREYXRlVGltZSkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZS51bml0O1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldFNjaGVkdWxlKHdvcmtlclNjaGVkdWxlKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIHJlY2lwaWVudHNcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgZ2V0UmVjaXBpZW50cyh1c2VyKS50aGVuKGZ1bmN0aW9uKHJlY2lwaWVudCkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLnJlY2lwaWVudHMgPSByZWNpcGllbnQ7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRBY3Rpb24oYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldE1lc3NhZ2UoXCJUaGUgc2VydmVyIGlzIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0LiBQbGVhc2Ugd2FpdCBhIGZldyBzZWNvbmRzIGFuZCB0aGVuIGNsaWNrIHRoZSByZWZyZXNoIGJ1dHRvbi5cIik7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kKCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh3b3JrZXJPYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ05vdGlmaWNhdGlvbiBXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseSBmb3IgYXNzaWdubWVudC4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTm90aWZpY2F0aW9uIC0gZ2V0UmVjaXBpZW50cyBmYWlsZWQgd2l0aCBlcnJvciBcIiArIGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuXG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBhY2NlcHRhbmNlTm90aWZpY2F0aW9uOiBmdW5jdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCB1dWlkLCByb2xlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuXG4gICAgICAgICAgICAgICAgdmFyIGdldFJvbGVzID0gZnVuY3Rpb24ocm9sZSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWNpcGllbnRzID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICByZWNpcGllbnRzLnJvbGUgPSByb2xlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZWNpcGllbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IG5ldyBOb3RpZmljYXRpb1dvcmtlcihhcHApO1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvZmlsZUlkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL21ldGEtZGF0YS9zdWJwcm9maWxlSWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIHZhciBwYXRoQXJyYXkgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKTtcbiAgICAgICAgICAgICAgICB2YXIgYmFzZVVSTCA9IERPTUFJTi5yZXBsYWNlKFwiZXhpc3QvcmVzdFwiLFwiXCIpO1xuICAgICAgICAgICAgICAgIC8vd2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3QgKyBcIi9cIiArIHBhdGhBcnJheVsxXTtcblxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJ0ZlwiOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlVHlwZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXRhLWRhdGFcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBfV0ZJbnN0YW5jZS5hcHAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBfV0ZJbnN0YW5jZS5jb21tdW5pdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2ZpbGVJZFwiOiBzdWJQcm9maWxlSWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvblR5cGVcIjogXCJ3b3JrZmxvd1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcmlvcml0eVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWNpcGllbnRzXCI6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidXJsXCI6IGJhc2VVUkwsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImtleXNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3VycmVudFVzZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbGlkRGF0ZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImR1ZURhdGVcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZWREYXRlVGltZVwiOiBtb21lbnQoKS5mb3JtYXQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwQ3JlYXRlZERhdGVUaW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcE5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwSWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJub2RlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0aXRsZVwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJEZWZpbmVkXCI6W11cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIEtleXMgbWVzc2FnZSBcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclRpdGxlID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBhcHAucHJvZmlsZS5faWQgKyBcIiddL3RpdGxlXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnByb2ZpbGUubmFtZSA9IGluZGljYXRvclRpdGxlO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5wcm9maWxlLmlkID0gYXBwLnByb2ZpbGUuX2lkO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmNvbW11bml0eS5uYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoX2xjbHguQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlOYW1lKTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY29tbXVuaXR5LmlkID0gX2xjbHguQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlJZDtcblxuICAgICAgICAgICAgICAgIHZhciBhcHBsaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvYXBwbGljYXRpb25zW2FwcElkIGVxICdcIiArIGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkICsgXCInXVwiLCBfbGNseC5DT01NVU5JVFlfQ09ORklHLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuYXBwbGljYXRpb24ubmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKGFwcGxpY2F0aW9uLm5hbWUpO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5hcHBsaWNhdGlvbi5pZCA9IGFwcGxpY2F0aW9uLmFwcElkO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmN1cnJlbnRVc2VyLm5hbWUgPSBfbGNseC5TRVNTSU9OLmZpcnN0TmFtZSArIFwiIFwiICsgX2xjbHguU0VTU0lPTi5sYXN0TmFtZTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY3VycmVudFVzZXIuaWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYobm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLnNkb0tleXMgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLnNkb0tleXMuZm9yRWFjaChmdW5jdGlvbihrKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoay5maWVsZCAhPVwiXCIgJiYgay5yZXBTdHIgIT0gXCJcIiAmJiBrLnNldElkICE9XCJcIil7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5mb3JFYWNoKGZ1bmN0aW9uKHNwSW5kKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3BJbmQuY2F0ZWdvcnkudGVybSA9PSBrLnNldElkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdCA9IHNwSW5kXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihrLmZpZWxkLmluZGV4T2YoXCIuXCIpPi0xKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpZWxkMSA9IGsuZmllbGQuc3BsaXQoXCIuXCIpWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmllbGQyID0gay5maWVsZC5zcGxpdChcIi5cIilbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpbmRPYmplY3QubW9kZWwgIT0gdW5kZWZpbmVkICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcgIT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhICE9dW5kZWZpbmVkICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YVtrLnNldElkXSAhPXVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YVtrLnNldElkXVtmaWVsZDFdIT11bmRlZmluZWQgJiYgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhW2suc2V0SWRdW2ZpZWxkMV1bZmllbGQyXSE9dW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGFbay5zZXRJZF1bZmllbGQxXVtmaWVsZDJdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5kT2JqZWN0Lm1vZGVsICE9IHVuZGVmaW5lZCAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nICE9IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YSAhPXVuZGVmaW5lZCAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGFbay5zZXRJZF0gIT11bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iamVjdC5tb2RlbC5wZW5kaW5nLmRhdGFbay5zZXRJZF1bay5maWVsZF0hPXVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhW2suc2V0SWRdW2suZmllbGRdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy51c2VyRGVmaW5lZC5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJrZXlcIjpcIiNcIitrLnJlcFN0citcIiNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWx1ZVwiOiB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MubmFtZSA9IHN1YlByb2Nlc3NPYmplY3QubGFiZWw7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MuaWQgPSB1dWlkO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MudmFsaWREYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy5kdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy5kdWU7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IHN1YlByb2Nlc3NPYmplY3Quc3RlcDtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3RlcC5zdGVwQ3JlYXRlZERhdGVUaW1lID0gc3RlcE9iamVjdC5kYXRlVGltZUNyZWF0ZWQ7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN0ZXAuc3RlcElkID0gc3RlcE9iamVjdC5pZDtcblxuICAgICAgICAgICAgICAgIHZhciBzdGVwQ29uZmlnT2JqZWN0ID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzT2JqZWN0LmlkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcE9iamVjdC5pZCArIFwiJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBOYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoc3RlcENvbmZpZ09iamVjdC5uYW1lKTtcblxuICAgICAgICAgICAgICAgIHZhciBub2RlVGl0bGUgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIHN1YlByb2ZpbGVJZCArIFwiJ10vdGl0bGVcIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgaWYgKG5vZGVUaXRsZSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLm5vZGUudGl0bGUgPSBcIlwiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5ub2RlLnRpdGxlID0gbm9kZVRpdGxlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIG1lc3NhZ2UgXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UuZGVmYXVsdCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLnRpdGxlID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLnRpdGxlO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbWVzc2FnZVR5cGUgXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2VUeXBlID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm1lc3NhZ2VUeXBlO1xuXG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBwcmlvcml0eSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucHJpb3JpdHkgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2UucHJpb3JpdHk7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbm90aWZpY2F0aW9uQWN0aW9uIGlmIGV4aXN0cyBcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5ub3RpZmljYXRpb25BY3Rpb24gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24ubGFiZWwgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmxhYmVsO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkkgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uZ290bztcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5zY2hlZHVsZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZXhlY3V0ZU9iamVjdCA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5zY2hlZHVsZS5leGVjdXRlQ29tbWFuZDtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgd29ya2VyU2NoZWR1bGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuaXQ6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3I6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChleGVjdXRlT2JqZWN0Lm5vdyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5leGFjdCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBleGVjdXRlT2JqZWN0LmV4YWN0LmRhdGVUaW1lO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5kdWVEYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy5kdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkdWVEYXRlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoZHVlRGF0ZSwgXCJZWVlZLU1NLUREXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LmR1ZURhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUudW5pdCA9IGV4ZWN1dGVPYmplY3QuZHVlRGF0ZS51bml0O1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC52YWxpZERhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR1ZURhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLnZhbGlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWREYXRlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQodmFsaWREYXRlLCBcIllZWVktTU0tRERcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3QudmFsaWREYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZS51bml0O1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBDcmVhdGVkRGF0ZVRpbWUgPSBzdWJQcm9jZXNzT2JqZWN0LnN0ZXAuZHVlRGF0ZVRpbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGVwQ3JlYXRlZERhdGVUaW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoc3RlcENyZWF0ZWREYXRlVGltZSkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZS51bml0O1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldFNjaGVkdWxlKHdvcmtlclNjaGVkdWxlKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIHJlY2lwaWVudHNcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgZ2V0Um9sZXMocm9sZSkudGhlbihmdW5jdGlvbihyZWNpcGllbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5yZWNpcGllbnRzID0gcmVjaXBpZW50O1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0QWN0aW9uKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRNZXNzYWdlKFwiVGhlIHNlcnZlciBpcyBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4gUGxlYXNlIHdhaXQgYSBmZXcgc2Vjb25kcyBhbmQgdGhlbiBjbGljayB0aGUgcmVmcmVzaCBidXR0b24uXCIpO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0Q29udGV4dCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh3b3JrZXJPYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ05vdGlmaWNhdGlvbiBXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseSBmb3IgYXNzaWdubWVudC4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTm90aWZpY2F0aW9uIC0gZ2V0UmVjaXBpZW50cyBmYWlsZWQgd2l0aCBlcnJvciBcIiArIGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuXG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBhY2NlcHRhbmNlTm90aWZpY2F0aW9uRXh0ZXJuYWw6IGZ1bmN0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHV1aWQsIHVzZXJzTGlzdCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblxuICAgICAgICAgICAgICAgIHZhciBnZXRVc2Vyc0xpc3QgPSBmdW5jdGlvbih1TGlzdCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjaXBpZW50cyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IHVMaXN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZWNpcGllbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IG5ldyBOb3RpZmljYXRpb1dvcmtlcihhcHApO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YlByb2ZpbGVJZCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9tZXRhLWRhdGEvc3VicHJvZmlsZUlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gdmFyIHBhdGhBcnJheSA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdCgnLycpO1xuICAgICAgICAgICAgICAgIHZhciBiYXNlVVJMID0gRE9NQUlOLnJlcGxhY2UoXCJleGlzdC9yZXN0XCIsXCJcIik7XG4gICAgICAgICAgICAgICAgLy93aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgKyBcIi8vXCIgKyB3aW5kb3cubG9jYXRpb24uaG9zdCArIFwiL1wiICsgcGF0aEFycmF5WzFdO1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicnRmXCI6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VUeXBlXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1ldGEtZGF0YVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IF9XRkluc3RhbmNlLmFwcCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IF9XRkluc3RhbmNlLmNvbW11bml0eUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvZmlsZUlkXCI6IHN1YlByb2ZpbGVJZFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uVHlwZVwiOiBcIndvcmtmbG93XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByaW9yaXR5XCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlY2lwaWVudHNcIjoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ1cmxcIjogYmFzZVVSTCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwia2V5c1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjdXJyZW50VXNlclwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsaWREYXRlXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZHVlRGF0ZVwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlZERhdGVUaW1lXCI6IG1vbWVudCgpLmZvcm1hdCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0ZXBcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0ZXBDcmVhdGVkRGF0ZVRpbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdGVwTmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0ZXBJZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5vZGVcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInRpdGxlXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBLZXlzIG1lc3NhZ2UgXG4gICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JUaXRsZSA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgYXBwLnByb2ZpbGUuX2lkICsgXCInXS90aXRsZVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5wcm9maWxlLm5hbWUgPSBpbmRpY2F0b3JUaXRsZTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMucHJvZmlsZS5pZCA9IGFwcC5wcm9maWxlLl9pZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jb21tdW5pdHkubmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKF9sY2x4LkNPTU1VTklUWV9DT05GSUcuY29tbXVuaXR5TmFtZSk7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmNvbW11bml0eS5pZCA9IF9sY2x4LkNPTU1VTklUWV9DT05GSUcuY29tbXVuaXR5SWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgYXBwbGljYXRpb24gPSBKU09OLnhwYXRoKFwiL2FwcGxpY2F0aW9uc1thcHBJZCBlcSAnXCIgKyBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCArIFwiJ11cIiwgX2xjbHguQ09NTVVOSVRZX0NPTkZJRywge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmFwcGxpY2F0aW9uLm5hbWUgPSBhcHAuZ2V0TmFtZUJ5TGFuZyhhcHBsaWNhdGlvbi5uYW1lKTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuYXBwbGljYXRpb24uaWQgPSBhcHBsaWNhdGlvbi5hcHBJZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jdXJyZW50VXNlci5uYW1lID0gX2xjbHguU0VTU0lPTi5maXJzdE5hbWUgKyBcIiBcIiArIF9sY2x4LlNFU1NJT04ubGFzdE5hbWU7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmN1cnJlbnRVc2VyLmlkID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLm5hbWUgPSBzdWJQcm9jZXNzT2JqZWN0LmxhYmVsO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MuaWQgPSB1dWlkO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MudmFsaWREYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy5kdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy5kdWU7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IHN1YlByb2Nlc3NPYmplY3Quc3RlcDtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3RlcC5zdGVwQ3JlYXRlZERhdGVUaW1lID0gc3RlcE9iamVjdC5kYXRlVGltZUNyZWF0ZWQ7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN0ZXAuc3RlcElkID0gc3RlcE9iamVjdC5pZDtcblxuICAgICAgICAgICAgICAgIHZhciBzdGVwQ29uZmlnT2JqZWN0ID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzT2JqZWN0LmlkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcE9iamVjdC5pZCArIFwiJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdGVwLnN0ZXBOYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoc3RlcENvbmZpZ09iamVjdC5uYW1lKTtcblxuICAgICAgICAgICAgICAgIHZhciBub2RlVGl0bGUgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIHN1YlByb2ZpbGVJZCArIFwiJ10vdGl0bGVcIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgaWYgKG5vZGVUaXRsZSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLm5vZGUudGl0bGUgPSBcIlwiO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5ub2RlLnRpdGxlID0gbm9kZVRpdGxlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIG1lc3NhZ2UgXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UuZGVmYXVsdCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLnRpdGxlID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLnRpdGxlO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLnJ0Zi5tYXJrdXAgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2UubWVzc2FnZTtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBtZXNzYWdlVHlwZSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZVR5cGUgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2UubWVzc2FnZVR5cGU7XG5cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIHByaW9yaXR5IFxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5wcmlvcml0eSA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5wcmlvcml0eTtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBub3RpZmljYXRpb25BY3Rpb24gaWYgZXhpc3RzIFxuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm5vdGlmaWNhdGlvbkFjdGlvbiAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5sYWJlbCA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5ub3RpZmljYXRpb25BY3Rpb24ubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkkgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLlVSSSA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLlVSSTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG8gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG8gPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLnNjaGVkdWxlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBleGVjdXRlT2JqZWN0ID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLnNjaGVkdWxlLmV4ZWN1dGVDb21tYW5kO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB3b3JrZXJTY2hlZHVsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVUaW1lOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdW5pdDogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcjogXCJcIlxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4ZWN1dGVPYmplY3Qubm93ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LmV4YWN0ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGV4ZWN1dGVPYmplY3QuZXhhY3QuZGF0ZVRpbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LmR1ZURhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR1ZURhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLmR1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGR1ZURhdGUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudChkdWVEYXRlLCBcIllZWVktTU0tRERcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3QuZHVlRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC5kdWVEYXRlLnVuaXQ7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0ZWREYXRlVGltZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMudmFsaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWxpZERhdGUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCh2YWxpZERhdGUsIFwiWVlZWS1NTS1ERFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC52YWxpZERhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUudW5pdCA9IGV4ZWN1dGVPYmplY3QudmFsaWREYXRlLnVuaXQ7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0ZWREYXRlVGltZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcENyZWF0ZWREYXRlVGltZSA9IHN1YlByb2Nlc3NPYmplY3Quc3RlcC5kdWVEYXRlVGltZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0ZXBDcmVhdGVkRGF0ZVRpbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudChzdGVwQ3JlYXRlZERhdGVUaW1lKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUudW5pdCA9IGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlLnVuaXQ7XG5cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0U2NoZWR1bGUod29ya2VyU2NoZWR1bGUpO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgcmVjaXBpZW50c1xuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgIGdldFVzZXJzTGlzdCh1c2Vyc0xpc3QpLnRoZW4oZnVuY3Rpb24ocmVjaXBpZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucmVjaXBpZW50cyA9IHJlY2lwaWVudDtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldEFjdGlvbihhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0TWVzc2FnZShcIlRoZSBzZXJ2ZXIgaXMgcHJvY2Vzc2luZyB5b3VyIHJlcXVlc3QuIFBsZWFzZSB3YWl0IGEgZmV3IHNlY29uZHMgYW5kIHRoZW4gY2xpY2sgdGhlIHJlZnJlc2ggYnV0dG9uLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldENvbnRleHQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzczoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cod29ya2VyT2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdOb3RpZmljYXRpb24gV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkgZm9yIGFzc2lnbm1lbnQuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vdGlmaWNhdGlvbiAtIGdldFJlY2lwaWVudHMgZmFpbGVkIHdpdGggZXJyb3IgXCIgKyBlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcblxuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuXG4gICAgfVxuXG59KSgpO1xuXG5cbnZhciByZXBvcnQgPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG5cblxuXG4gICAgICAgIGNyZWF0ZVBlcmZvcm1hbmNlUmVwb3J0OiBmdW5jdGlvbihwZXJmb3JtYW5jZVJlcG9ydE9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY3JlYXRlUGVyZm9ybWFuY2VSZXBvcnRcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG4gICAgICAgICAgICAgICAgdmFyIHdvcmtwbGFuU2V0SWQgPSBwZXJmb3JtYW5jZVJlcG9ydE9iamVjdC53b3JrcGxhblNldElkO1xuICAgICAgICAgICAgICAgIHZhciBjb25maWdTZXRJZCA9IHBlcmZvcm1hbmNlUmVwb3J0T2JqZWN0LmNvbmZpZ1NldElkO1xuXG5cbiAgICAgICAgICAgICAgICAvLyB3b3JrcGxhblNldElkIHNjb3BlIGlzIHByb2ZpbGVcbiAgICAgICAgICAgICAgICAvLyBjb25maWdTZXRJZCBzY29wZSBpcyBzdWJwcm9jZXNzZXNcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrcGxhblVVSUQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyB3b3JrcGxhblNldElkICsgXCInXS9faWRcIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIGNvbmZpZ1VVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBjb25maWdTZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlUGVyZm9ybWFuY2VSZXBvcnRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ3b3JrcGxhblVVSURcIjogd29ya3BsYW5VVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjb25maWdVVUlEXCI6IGNvbmZpZ1VVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbElkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtwbGFuUmVwb3J0IFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZVJlcG9ydDogZnVuY3Rpb24oY3JlYXRlUmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJleGVjdXRlUmVwb3J0XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHBlcmZvcm1hbmNlUmVwb3J0RGVmaW5pdGlvblNldElkID0gY3JlYXRlUmVwb3J0LlBlcmZvcm1hbmNlUmVwb3J0RGVmaW5pdGlvblNldElkO1xuICAgICAgICAgICAgICAgIHZhciByZXBvcnRpbmdTRE9TZXRJZCA9IGNyZWF0ZVJlcG9ydC5yZXBvcnRpbmdTRE9TZXRJZDtcblxuICAgICAgICAgICAgICAgIHZhciBwZXJmb3JtYW5jZVJlcG9ydERlZmluaXRpb24gPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyBwZXJmb3JtYW5jZVJlcG9ydERlZmluaXRpb25TZXRJZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHJlcG9ydGluZ1NETyA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHJlcG9ydGluZ1NET1NldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZVJlcG9ydFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInBlcmZvcm1hbmNlUmVwb3J0RGVmaW5pdGlvblwiOiBwZXJmb3JtYW5jZVJlcG9ydERlZmluaXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlcG9ydGluZ1NET1wiOiByZXBvcnRpbmdTRE8sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbElkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1JlcHJvdCBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuXG5cblxuICAgICAgICBzZG9SZXBvcnQ6IGZ1bmN0aW9uKHNkb1JlcG9ydCwgX1dGSW5zdGFuY2UsIHV1aWQpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwic2RvUmVwb3J0XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNldElkID0gc2RvUmVwb3J0LmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgc2V0SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydFVVSURcIjogc2RvUmVwb3J0VVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBhcHAuU0NPUEUud29ya2Zsb3cucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygncmVwb3J0IFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGV4ZWN1dGVSZXBvcnQ6IGZ1bmN0aW9uKGV4ZWN1dGVSZXBvcnQsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImV4ZWN1dGVSZXBvcnRcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cblxuXG4gICAgICAgICAgICAgICAgdmFyIFNET3JlcG9ydFNldElkID0gZXhlY3V0ZVJlcG9ydC5TRE9yZXBvcnRTZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgcmVwb3J0aW5nU0RPU2V0aWQgPSBleGVjdXRlUmVwb3J0LnJlcG9ydGluZ1NET1NldGlkO1xuXG4gICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB2YXIgU0RPcmVwb3J0VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIFNET3JlcG9ydFNldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciByZXBvcnRpbmdTRE9VVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgcmVwb3J0aW5nU0RPU2V0aWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICBpZiAoU0RPcmVwb3J0VVVJRCA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgU0RPcmVwb3J0VVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIFNET3JlcG9ydFNldElkICsgXCInXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiZXhlY3V0ZVJlcG9ydFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydFVVSURcIjogU0RPcmVwb3J0VVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVwb3J0aW5nU0RPVVVJRFwiOiByZXBvcnRpbmdTRE9VVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IGFwcC5TQ09QRS53b3JrZmxvdy5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdyZXBvcnQgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2VuZXJhdGVWaWV3OiBmdW5jdGlvbihnZW5lcmF0ZVZpZXcsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcInNkb1JlcG9ydFwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgVmlld0NvbmZpZ1NldElkID0gZ2VuZXJhdGVWaWV3LlZpZXdDb25maWdTZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgVmlld0NvbmZpZ1VVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBWaWV3Q29uZmlnU2V0SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJnZW5lcmF0ZVZpZXdcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ2aWV3Q29uZmlnVVVJRFwiOiBWaWV3Q29uZmlnVVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBhcHAuU0NPUEUud29ya2Zsb3cucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygncmVwb3J0IFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHJlcXVlc3RSZXBvcnQ6IGZ1bmN0aW9uKHJlcXVlc3RSZXBvcnQsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImV4ZWN1dGVSZXBvcnRcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2RvUmVxdWVzdFJlcG9ydFNldElkID0gcmVxdWVzdFJlcG9ydC5zZG9SZXF1ZXN0UmVwb3J0U2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIHNkb1JlcG9ydENyZWF0aW9uU2V0SWQgPSByZXF1ZXN0UmVwb3J0LnNkb1JlcG9ydENyZWF0aW9uU2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIHBlcmZvcm1hbmNlUmVwb3J0U2V0SWQgPSByZXF1ZXN0UmVwb3J0LnBlcmZvcm1hbmNlUmVwb3J0U2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIHNkb1JlcXVlc3RSZXBvcnRVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgc2RvUmVxdWVzdFJlcG9ydFNldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRDcmVhdGlvblVVSUQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyBzZG9SZXBvcnRDcmVhdGlvblNldElkICsgXCInXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgcGVyZm9ybWFuY2VSZXBvcnRVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgcGVyZm9ybWFuY2VSZXBvcnRTZXRJZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcInJlcXVlc3RSZXBvcnRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJwZXJmb3JtYW5jZVJlcG9ydFVVSURcIjogcGVyZm9ybWFuY2VSZXBvcnRVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXF1ZXN0UmVwb3J0VVVJRFwiOiBzZG9SZXF1ZXN0UmVwb3J0VVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic2RvUmVwb3J0Q3JlYXRpb25VVUlEXCI6IHNkb1JlcG9ydENyZWF0aW9uVVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBhcHAuU0NPUEUud29ya2Zsb3cucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUmVxdWVzdCByZXBvcnQgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cblxuICAgICAgICBnZW5lcmF0ZUJhc2ljVmlldzogZnVuY3Rpb24oZ2VuZXJhdGVCYXNpY1ZpZXcsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcInNkb1JlcG9ydFwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciBzZG9EYXRhT2JqZWN0Vmlld1NldElkID0gZ2VuZXJhdGVCYXNpY1ZpZXcuc2RvRGF0YU9iamVjdFZpZXdTZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgc2RvRGF0YU9iamVjdFZpZXdVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgc2RvRGF0YU9iamVjdFZpZXdTZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiZ2VuZXJhdGVCYXNpY1ZpZXdcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9EYXRhT2JqZWN0Vmlld1VVSURcIjogc2RvRGF0YU9iamVjdFZpZXdVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IGFwcC5TQ09QRS53b3JrZmxvdy5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdnZW5lcmF0ZUJhc2ljVmlldyBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBnZW5lcmF0ZVVuaW9uVmlldzogZnVuY3Rpb24oZ2VuZXJhdGVVbmlvblZpZXcsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcInNkb1JlcG9ydFwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciBzZG9EYXRhT2JqZWN0Vmlld1VuaW9uU2V0SWQgPSBnZW5lcmF0ZVVuaW9uVmlldy5zZG9EYXRhT2JqZWN0Vmlld1VuaW9uU2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIHNkb0RhdGFPYmplY3RWaWV3VW5pb25VVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgc2RvRGF0YU9iamVjdFZpZXdVbmlvblNldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJnZW5lcmF0ZVVuaW9uVmlld1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb0RhdGFPYmplY3RWaWV3VW5pb25VVUlEXCI6IHNkb0RhdGFPYmplY3RWaWV3VW5pb25VVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IGFwcC5TQ09QRS53b3JrZmxvdy5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdnZW5lcmF0ZVVuaW9uVmlldyBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBzZG9SZXBvcnRNdWx0aXBsZTogZnVuY3Rpb24oc2RvUmVwb3J0TXVsdGlwbGUsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcInNkb1JlcG9ydFwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRDcmVhdGlvblNldElkID0gc2RvUmVwb3J0TXVsdGlwbGUuc2RvUmVwb3J0Q3JlYXRpb25TZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgc2RvUmVwb3J0Vmlld3NTZXRJZCA9IHNkb1JlcG9ydE11bHRpcGxlLnNkb1JlcG9ydFZpZXdzU2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIHNkb1JlcG9ydEpvaW5zU2V0SWQgPSBzZG9SZXBvcnRNdWx0aXBsZS5zZG9SZXBvcnRKb2luc1NldElkO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNkb1JlcG9ydENyZWF0aW9uVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNkb1JlcG9ydENyZWF0aW9uU2V0SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHNkb1JlcG9ydFZpZXdzVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNkb1JlcG9ydFZpZXdzU2V0SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHNkb1JlcG9ydEpvaW5zVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNkb1JlcG9ydEpvaW5zU2V0SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXBvcnRNdWx0aXBsZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydENyZWF0aW9uVVVJRFwiOiBzZG9SZXBvcnRDcmVhdGlvblVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydFZpZXdzVVVJRFwiOiBzZG9SZXBvcnRWaWV3c1VVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydEpvaW5zVVVJRFwiOiBzZG9SZXBvcnRKb2luc1VVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogYXBwLlNDT1BFLndvcmtmbG93LnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ3Nkb1JlcG9ydE11bHRpcGxlIFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHN1YnByb2ZpbGVRdWFydGVybHlSZXBvcnQ6IGZ1bmN0aW9uKHN1YnByb2ZpbGVRdWFydGVybHlSZXBvcnQsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImV4ZWN1dGVSZXBvcnRcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2NoZWR1bGVSZXBvcnRJbmRpY2F0b3IgPSBzdWJwcm9maWxlUXVhcnRlcmx5UmVwb3J0LnNjaGVkdWxlUmVwb3J0SW5kaWNhdG9yO1xuICAgICAgICAgICAgICAgIHZhciBzY2hlZHVsZVJlcG9ydEluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyBzY2hlZHVsZVJlcG9ydEluZGljYXRvciArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHNkb1JlcG9ydEFwcHJvdmFsSW5kaWNhdG9yID0gc3VicHJvZmlsZVF1YXJ0ZXJseVJlcG9ydC5zZG9SZXBvcnRBcHByb3ZhbEluZGljYXRvcjtcbiAgICAgICAgICAgICAgICB2YXIgc2RvUmVwb3J0QXBwcm92YWxJbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgc2RvUmVwb3J0QXBwcm92YWxJbmRpY2F0b3IgKyBcIicgYW5kIHdvcmtmbG93c1sxXS9wcm9jZXNzZXNbMV0vc3ViUHJvY2Vzc1VVSUQgZXEgJ1wiICsgdXVpZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cblxuXG5cblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwic3VicHJvZmlsZVF1YXJ0ZXJseVJlcG9ydFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInNjaGVkdWxlUmVwb3J0SW5kaWNhdG9yVVVJRFwiOiBzY2hlZHVsZVJlcG9ydEluZGljYXRvclVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydEFwcHJvdmFsSW5kaWNhdG9yVVVJRFwiOiBzZG9SZXBvcnRBcHByb3ZhbEluZGljYXRvclVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YnByb2ZpbGVDb2RlXCI6IGFwcC5wcm9maWxlLnN1YlByb2ZpbGUuY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3VicHJvZmlsZVRpdGxlXCI6IGFwcC5wcm9maWxlLnN1YlByb2ZpbGUudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogYXBwLlNDT1BFLndvcmtmbG93LnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1F1YXJ0ZXJseVJlcG9ydCByZXBvcnQgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgfVxuXG5cblxuXG5cbiAgICB9XG5cbn0pKCk7XG5cbnZhciBwYXJ0aWNpcGFudHMgPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAgIGxpbmtQYXJ0aWNpcGFudHM6IGZ1bmN0aW9uKGxpbmtQYXJ0aWNpcGFudHMsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImZvbGxvd1wiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciBFUFdQTGlua1BhcnRpY2lwYW50c0luQnVsa0lkID0gbGlua1BhcnRpY2lwYW50cy5FUFdQTGlua1BhcnRpY2lwYW50c0luQnVsa0lkO1xuICAgICAgICAgICAgICAgIHZhciBFUFdQTGlua1BhcnRpY2lwYW50c0luQnVsa0lkVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIEVQV1BMaW5rUGFydGljaXBhbnRzSW5CdWxrSWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIEVQV1BMb2NhbGl0eUlkID0gbGlua1BhcnRpY2lwYW50cy5FUFdQTG9jYWxpdHlJZDtcbiAgICAgICAgICAgICAgICB2YXIgRVBXUExvY2FsaXR5SWRVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgRVBXUExvY2FsaXR5SWQgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIEVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZCA9IGxpbmtQYXJ0aWNpcGFudHMuRVBXUEFjdGl2ZVBhcnRpY2lwYW50c0lkO1xuICAgICAgICAgICAgICAgIHZhciBFUFdQQWN0aXZlUGFydGljaXBhbnRzSWRVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgRVBXUEFjdGl2ZVBhcnRpY2lwYW50c0lkICsgXCInXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwibGlua1BhcnRpY2lwYW50c1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIkVQV1BMaW5rUGFydGljaXBhbnRzSW5CdWxrSWRVVUlEXCI6IEVQV1BMaW5rUGFydGljaXBhbnRzSW5CdWxrSWRVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJFUFdQTG9jYWxpdHlJZFVVSURcIjogRVBXUExvY2FsaXR5SWRVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJFUFdQQWN0aXZlUGFydGljaXBhbnRzSWRVVUlEXCI6IEVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZFVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbElkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdFUFdQTGlua1BhcnRpY2lwYW50cyBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBtb250aGx5QXR0ZW5kYW5jZTogZnVuY3Rpb24obW9udGhseUF0dGVuZGFuY2UsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImZvbGxvd1wiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciBFUFdQTW9udGhseUF0dGVuZGFuY2VCdWxrVXBsb2FkSWQgPSBtb250aGx5QXR0ZW5kYW5jZS5FUFdQTW9udGhseUF0dGVuZGFuY2VCdWxrVXBsb2FkVVVJRDtcbiAgICAgICAgICAgICAgICB2YXIgRVBXUE1vbnRobHlBdHRlbmRhbmNlQnVsa1VwbG9hZFVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBFUFdQTW9udGhseUF0dGVuZGFuY2VCdWxrVXBsb2FkSWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgRVBXUEFjdGl2ZVBhcnRpY2lwYW50c0lkID0gbW9udGhseUF0dGVuZGFuY2UuRVBXUEFjdGl2ZVBhcnRpY2lwYW50c0lkVVVJRDtcbiAgICAgICAgICAgICAgICB2YXIgRVBXUEFjdGl2ZVBhcnRpY2lwYW50c0lkVVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIEVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB2YXIgRVBXUE1vbnRobHlFbXBsb3ltZW50UGVyTG9jYWxpdHlJZCA9IG1vbnRobHlBdHRlbmRhbmNlLkVQV1BNb250aGx5RW1wbG95bWVudFBlckxvY2FsaXR5VVVJRDtcbiAgICAgICAgICAgICAgICB2YXIgRVBXUE1vbnRobHlFbXBsb3ltZW50UGVyTG9jYWxpdHlVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgRVBXUE1vbnRobHlFbXBsb3ltZW50UGVyTG9jYWxpdHlJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcblxuXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcIm1vbnRobHlBdHRlbmRhbmNlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiRVBXUE1vbnRobHlBdHRlbmRhbmNlQnVsa1VwbG9hZFVVSURcIjogRVBXUE1vbnRobHlBdHRlbmRhbmNlQnVsa1VwbG9hZFVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZFVVSURcIjogRVBXUEFjdGl2ZVBhcnRpY2lwYW50c0lkVVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiRVBXUE1vbnRobHlFbXBsb3ltZW50UGVyTG9jYWxpdHlVVUlEXCI6IEVQV1BNb250aGx5RW1wbG95bWVudFBlckxvY2FsaXR5VVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsSWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ21vbnRobHlBdHRlbmRhbmNlIFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIG1vbnRobHlQcm9ncmVzc1N1bW1hcnk6IGZ1bmN0aW9uKG1vbnRobHlQcm9ncmVzc1N1bW1hcnksIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImZvbGxvd1wiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciBFUFdQTW9udGhseVByb2dyZXNzU3VtbWFyeUlkID0gbW9udGhseVByb2dyZXNzU3VtbWFyeS5FUFdQTW9udGhseVByb2dyZXNzU3VtbWFyeUlkVVVJRDtcbiAgICAgICAgICAgICAgICB2YXIgRVBXUE1vbnRobHlQcm9ncmVzc1N1bW1hcnlJZFVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBFUFdQTW9udGhseVByb2dyZXNzU3VtbWFyeUlkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIFxuXG5cblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwibW9udGhseVByb2dyZXNzU3VtbWFyeVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIkVQV1BNb250aGx5UHJvZ3Jlc3NTdW1tYXJ5SWRVVUlEXCI6IEVQV1BNb250aGx5UHJvZ3Jlc3NTdW1tYXJ5SWRVVUlELFxuXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbElkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdtb250aGx5QXR0ZW5kYW5jZSBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBwYXJ0aWNpcGFudENvbnRyYWN0czogZnVuY3Rpb24ocGFydGljaXBhbnRDb250cmFjdHMsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImZvbGxvd1wiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciBFUFdQUGFydGljaXBhbnRDb250cmFjdHNJZCA9IHBhcnRpY2lwYW50Q29udHJhY3RzLkVQV1BQYXJ0aWNpcGFudENvbnRyYWN0c0lkVVVJRDtcbiAgICAgICAgICAgICAgICB2YXIgRVBXUFBhcnRpY2lwYW50Q29udHJhY3RzSWRVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgRVBXUFBhcnRpY2lwYW50Q29udHJhY3RzSWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJwYXJ0aWNpcGFudENvbnRyYWN0c1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIkVQV1BQYXJ0aWNpcGFudENvbnRyYWN0c0lkVVVJRFwiOiBFUFdQUGFydGljaXBhbnRDb250cmFjdHNJZFVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbElkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ3BhcnRpY2lwYW50Q29udHJhY3RzIFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGdlbmVyaWNMaW5rUGFydGljaXBhbnRzOiBmdW5jdGlvbihnZW5lcmljTGlua1BhcnRpY2lwYW50cywgX1dGSW5zdGFuY2UsIHV1aWQpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuXG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9XG5cbn0pKCk7XG5cbnZhciB3b3JrZXIgPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAgIGdldFdvcmtlcldyYXBwZXI6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICB2YXIgd3JhcHBlciA9IHtcbiAgICAgICAgICAgICAgICBcInNvdXJjZVwiOiBcInJlbW90ZVwiLFxuICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcIndvcmtlck9iamVjdFwiLFxuICAgICAgICAgICAgICAgIFwiX2lkXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgXCJjaGFubmVsc1wiOiBbXCJ3b3JrZXJPYmplY3RcIl0sXG4gICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwibWVzc2FnZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwibWVzc2FnZVR5cGVcIjogXCJpbmZvXCIsXG4gICAgICAgICAgICAgICAgXCJjcmVhdGVkRGF0ZVRpbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcInNlbmRlclVzZXJJZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwic3ViUHJvZmlsZUlkXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgXCJwYXJlbnRUcmFuc2FjdGlvbklkXCI6IChhcHAuU0NPUEUudHhuID09IHVuZGVmaW5lZCA/IFwiXCIgOiBhcHAuU0NPUEUudHhuLnRyYW5zYWN0aW9uSWQpLFxuICAgICAgICAgICAgICAgIFwiYWN0aW9uXCI6IHtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcmV0dXJuIHdyYXBwZXI7XG5cbiAgICAgICAgfSxcbiAgICAgICAgc2VuZDogZnVuY3Rpb24od29ya2VyT2JqZWN0KSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTdWJtaXR0aW5nIFdvcmtlciBPYmplY3QgdG8gc2VydmVyJyk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cod29ya2VyT2JqZWN0KTtcbiAgICAgICAgICAgICAgICBkYW8uc2F2ZSh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyUmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh3b3JrZXJSZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBzdWJtaXR0aW5nIHdvcmtlciByZXNwb25zZSAhIScgKyBlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHNlbmRXb3JrZXI6IGZ1bmN0aW9uKHdvcmtlckNvbmZpZywgX1dGSW5zdGFuY2UsIHV1aWQpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwic2VuZFdvcmtlclwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc0dldE5vZGVWYWx1ZSA9IGZ1bmN0aW9uKHBhcmFtQmxvY2ssIHNlcSwgcGFyYW1OYW1lKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlcywgcmVqKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUocGFyYW1CbG9jaywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YVZhbHVlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBzZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1OYW1lXCI6IHBhcmFtTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRhVmFsdWVcIjogZGF0YVZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlaihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NQYXJhbXMgPSBmdW5jdGlvbihjb25maWdQYXJhbSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXMsIHJlaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtZXRlcnNBcnJheSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1zVG9Qcm9jZXNzID0gY29uZmlnUGFyYW0ubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb25maWdQYXJhbS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbUJsb2NrID0gY29uZmlnUGFyYW1baV0ucGFyYW1ldGVyVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlcSA9IGNvbmZpZ1BhcmFtW2ldLnNlcTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1OYW1lID0gY29uZmlnUGFyYW1baV0ucGFyYW1ldGVyTmFtZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbVZhbHVlID0gcHJvY2Vzc0dldE5vZGVWYWx1ZShwYXJhbUJsb2NrLCBzZXEsIHBhcmFtTmFtZSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IHJlc3BvbnNlLnNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1OYW1lXCI6IHJlc3BvbnNlLnBhcmFtTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1WYWx1ZVwiOiByZXNwb25zZS5kYXRhVmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtc1RvUHJvY2Vzcy0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbXNUb1Byb2Nlc3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyc0FycmF5LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IGl0ZW1zVG9Qcm9jZXNzICsgMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtTmFtZVwiOiBcImNvbW11bml0eUlkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbVZhbHVlXCI6IF9XRkluc3RhbmNlLmNvbW11bml0eUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyc0FycmF5LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IGl0ZW1zVG9Qcm9jZXNzICsgMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtTmFtZVwiOiBcImFwcGxpY2F0aW9uSWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtVmFsdWVcIjogX1dGSW5zdGFuY2UuYXBwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyc0FycmF5LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IGl0ZW1zVG9Qcm9jZXNzICsgMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtTmFtZVwiOiBcInByb2ZpbGVJZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1WYWx1ZVwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyc0FycmF5LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IGl0ZW1zVG9Qcm9jZXNzICsgNCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtTmFtZVwiOiBcInN1YlByb2Nlc3NVVUlEXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbVZhbHVlXCI6IHV1aWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMocGFyYW1ldGVyc0FycmF5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtc1RvUHJvY2Vzcy0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbXNUb1Byb2Nlc3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyc0FycmF5LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IGl0ZW1zVG9Qcm9jZXNzICsgMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtTmFtZVwiOiBcImNvbW11bml0eUlkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbVZhbHVlXCI6IF9XRkluc3RhbmNlLmNvbW11bml0eUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyc0FycmF5LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IGl0ZW1zVG9Qcm9jZXNzICsgMixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtTmFtZVwiOiBcImFwcGxpY2F0aW9uSWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtVmFsdWVcIjogX1dGSW5zdGFuY2UuYXBwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyc0FycmF5LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IGl0ZW1zVG9Qcm9jZXNzICsgMyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtTmFtZVwiOiBcInByb2ZpbGVJZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1WYWx1ZVwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyc0FycmF5LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IGl0ZW1zVG9Qcm9jZXNzICsgNCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtTmFtZVwiOiBcInN1YlByb2Nlc3NVVUlEXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbVZhbHVlXCI6IHV1aWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMocGFyYW1ldGVyc0FycmF5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIHR5cGUgPSBudWxsO1xuICAgICAgICAgICAgICAgIGlmICh3b3JrZXJDb25maWcucmVzdCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlnUGFyYW0gPSB3b3JrZXJDb25maWcucmVzdC5wYXJhbWV0ZXJzO1xuICAgICAgICAgICAgICAgICAgICBwcm9jZXNzUGFyYW1zKGNvbmZpZ1BhcmFtKS50aGVuKGZ1bmN0aW9uKHBhcmFtc0FycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VuZFdvcmtlclwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicmVzdFwiOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24uc2VuZFdvcmtlci5yZXN0LnVyaSA9IHdvcmtlckNvbmZpZy5yZXN0LnVyaTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5zZW5kV29ya2VyLnJlc3QucHJvZmlsSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLnNlbmRXb3JrZXIucmVzdC5wYXJhbWV0ZXJzID0gcGFyYW1zQXJyYXk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcE9iamVjdC5zcFN0YXR1cyA9ICdzdWJtaXR0ZWQnO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNwT2JqZWN0Lm1lc3NhZ2VzID09IHVuZGVmaW5lZCkgeyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3QubWVzc2FnZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBlbmRpbmdTdWJtaXNzaW9uT2JqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpMThuXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZW5cIjogXCJUaGUgc2VydmVyIGlzIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0LiBQbGVhc2Ugd2FpdCBhIGZldyBzZWNvbmRzIGFuZCB0aGVuIGNsaWNrIHRoZSByZWZyZXNoIGJ1dHRvbi5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInB0XCI6IFwiVGhlIHNlcnZlciBpcyBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4gUGxlYXNlIHdhaXQgYSBmZXcgc2Vjb25kcyBhbmQgdGhlbiBjbGljayB0aGUgcmVmcmVzaCBidXR0b24uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwiaW5mb1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcE9iamVjdC5tZXNzYWdlcy5wdXNoKHBlbmRpbmdTdWJtaXNzaW9uT2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3b3JrZXIgaWQgaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzcE9iamVjdC53b3JrZXJzID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcE9iamVjdC53b3JrZXJzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwT2JqZWN0LndvcmtlcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwid29ya2VySWRcIjogd29ya2VyT2JqZWN0Ll9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRlVGltZVwiOiBtb21lbnQoKS5mb3JtYXQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc2lzdERhdGEoJ3N1YnByb2Nlc3NlcycsIGFwcC5TQ09QRS53b3JrZmxvdywgdXVpZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oc2F2ZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtlciBSZXN0IHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGZhaWxlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1dvcmtlciBzdWJtaXR0ZWQgc3VicHJvY2VzcyBmaWxlIHVwZGF0ZSBmYWlsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChmYWlsZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1dvcmtlciBmYWlsZWQgJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInBhcmFtZXRlciBjcmVhdGlvbiBmYWlsZWQuIEFib3JkaW5nIHdvcmtlciBvYmplY3RcIik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh3b3JrZXJDb25maWcuZnVuY3Rpb25hbCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlnUGFyYW0gPSB3b3JrZXJDb25maWcuZnVuY3Rpb25hbC5wYXJhbWV0ZXJzO1xuICAgICAgICAgICAgICAgICAgICBwcm9jZXNzUGFyYW1zKGNvbmZpZ1BhcmFtKS50aGVuKGZ1bmN0aW9uKHBhcmFtc0FycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VuZFdvcmtlclwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZnVuY3Rpb25hbFwiOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24uc2VuZFdvcmtlci5mdW5jdGlvbmFsLm1ldGhvZE5hbWUgPSB3b3JrZXJDb25maWcuZnVuY3Rpb25hbC5tZXRob2ROYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLnNlbmRXb3JrZXIuZnVuY3Rpb25hbC5wcm9maWxJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24uc2VuZFdvcmtlci5mdW5jdGlvbmFsLnBhcmFtZXRlcnMgPSBwYXJhbXNBcnJheTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3Quc3BTdGF0dXMgPSAnc3VibWl0dGVkJztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzcE9iamVjdC5tZXNzYWdlcyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3QubWVzc2FnZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBlbmRpbmdTdWJtaXNzaW9uT2JqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpMThuXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZW5cIjogXCJUaGUgc2VydmVyIGlzIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0LiBQbGVhc2Ugd2FpdCBhIGZldyBzZWNvbmRzIGFuZCB0aGVuIGNsaWNrIHRoZSByZWZyZXNoIGJ1dHRvbi5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInB0XCI6IFwiVGhlIHNlcnZlciBpcyBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4gUGxlYXNlIHdhaXQgYSBmZXcgc2Vjb25kcyBhbmQgdGhlbiBjbGljayB0aGUgcmVmcmVzaCBidXR0b24uXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwiaW5mb1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcE9iamVjdC5tZXNzYWdlcy5wdXNoKHBlbmRpbmdTdWJtaXNzaW9uT2JqZWN0KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdvcmtlciBpZCBoZXJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNwT2JqZWN0LndvcmtlcnMgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwT2JqZWN0LndvcmtlcnMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3Qud29ya2Vycy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ3b3JrZXJJZFwiOiB3b3JrZXJPYmplY3QuX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhdGVUaW1lXCI6IG1vbWVudCgpLmZvcm1hdCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0RGF0YSgnc3VicHJvY2Vzc2VzJywgYXBwLlNDT1BFLndvcmtmbG93LCB1dWlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihzYXZlZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnV29ya2VyIGZ1bmN0aW9uYWwgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZmFpbGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnV29ya2VyIHN1Ym1pdHRlZCBzdWJwcm9jZXNzIGZpbGUgdXBkYXRlIGZhaWxlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGZhaWxlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdXb3JrZXIgZmFpbGVkICcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJwYXJhbWV0ZXIgY3JlYXRpb24gZmFpbGVkLiBBYm9yZGluZyB3b3JrZXIgb2JqZWN0XCIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgZXhlY3V0ZUxvY2FsOiBmdW5jdGlvbih3b3JrZXJDb25maWcsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuXG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc0dldE5vZGVWYWx1ZSA9IGZ1bmN0aW9uKHBhcmFtQmxvY2ssIHNlcSwgZGF0YVR5cGUpIHtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzLCByZWopIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShwYXJhbUJsb2NrLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihkYXRhVmFsdWUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IHNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRhVHlwZVwiOiBkYXRhVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRhVmFsdWVcIjogZGF0YVZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlaihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc1BhcmFtcyA9IGZ1bmN0aW9uKGNvbmZpZ1BhcmFtKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlcywgcmVqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1ldGVyc0FycmF5ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbXNUb1Byb2Nlc3MgPSBjb25maWdQYXJhbS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbmZpZ1BhcmFtLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtQmxvY2sgPSBjb25maWdQYXJhbVtpXS5wYXJhbWV0ZXJWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VxID0gY29uZmlnUGFyYW1baV0uc2VxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhVHlwZSA9IGNvbmZpZ1BhcmFtW2ldLmRhdGFUeXBlLmRhdGFUeXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbVZhbHVlID0gcHJvY2Vzc0dldE5vZGVWYWx1ZShwYXJhbUJsb2NrLCBzZXEsIGRhdGFUeXBlKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyc0FycmF5LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogcmVzcG9uc2Uuc2VxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRhVHlwZVwiOiByZXNwb25zZS5kYXRhVHlwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1WYWx1ZVwiOiByZXNwb25zZS5kYXRhVmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtc1RvUHJvY2Vzcy0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbXNUb1Byb2Nlc3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzKHBhcmFtZXRlcnNBcnJheSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNUb1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1zVG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyhwYXJhbWV0ZXJzQXJyYXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB2YXIgZml4UGFyYW1UeXBlID0gZnVuY3Rpb24ocGFyYW1WYWx1ZSwgZGF0YVR5cGUpIHtcblxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGRhdGFUeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwic3RyaW5nXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR4dCA9IHBhcmFtVmFsdWUucmVwbGFjZSgvJy9nLCBcIlxcXFwnXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBcIlwiICsgdHh0ICsgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJkYXRlXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZGF0ZVRpbWVcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJcIiArIHBhcmFtVmFsdWUgKyBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIm51bWJlclwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImRlY2ltYWxcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyYW1WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB2YXIgbWV0aG9kTmFtZSA9IHdvcmtlckNvbmZpZy5tZXRob2ROYW1lO1xuICAgICAgICAgICAgICAgIHZhciBjb25maWdQYXJhbSA9IHdvcmtlckNvbmZpZy5wYXJhbWV0ZXJzO1xuICAgICAgICAgICAgICAgIHByb2Nlc3NQYXJhbXMoY29uZmlnUGFyYW0pLnRoZW4oZnVuY3Rpb24ocGFyYW1zQXJyYXkpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgcExpc3QgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJhbXNBcnJheS5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBMaXN0ID0gcExpc3QgKyBmaXhQYXJhbVR5cGUocGFyYW1zQXJyYXlbaV0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbaV0uZGF0YVR5cGUpICsgJywnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHBMaXN0ID0gcExpc3QgKyBmaXhQYXJhbVR5cGUocGFyYW1zQXJyYXlbaV0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbaV0uZGF0YVR5cGUpXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGxiYWNrU3VjY2VzcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoXCJGdW5jdGlvbiAnXCIgKyBtZXRob2ROYW1lICsgXCInIGV4ZWN1dGVkLiBSZXNwb25zZSBzdWNjZXNzLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGxiYWNrRmFpbHVyZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChcIkZ1bmN0aW9uICdcIiArIG1ldGhvZE5hbWUgKyBcIicgZXhlY3V0ZWQuIFJlc3BvbnNlIGZhaWxlZC5cIik7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZhciBzcFVVSUQgPSBcIlwiICsgdXVpZCArIFwiXCJcbiAgICAgICAgICAgICAgICAgICAgLy8gdmFyIGZ1bmMgPSBtZXRob2ROYW1lICsgJygnICsgcExpc3QgKyAnLGNhbGxiYWNrU3VjY2VzcywgY2FsbGJhY2tGYWlsdXJlLCcgKyBzcFVVSUQgKyAnKSc7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiR29pbmcgdG8gZXhlY3V0ZSA9PSBcIiArIG1ldGhvZE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBpZihwYXJhbXNBcnJheS5sZW5ndGggPT0gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAoKGV2YWwobWV0aG9kTmFtZSkpKGNhbGxiYWNrU3VjY2VzcywgY2FsbGJhY2tGYWlsdXJlLCBzcFVVSUQpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHBhcmFtc0FycmF5Lmxlbmd0aCA9PSAxKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICgoZXZhbChtZXRob2ROYW1lKSkocGFyYW1zQXJyYXlbMF0ucGFyYW1WYWx1ZSwgY2FsbGJhY2tTdWNjZXNzLCBjYWxsYmFja0ZhaWx1cmUsIHNwVVVJRCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYocGFyYW1zQXJyYXkubGVuZ3RoID09IDIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgKChldmFsKG1ldGhvZE5hbWUpKShwYXJhbXNBcnJheVswXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVsxXS5wYXJhbVZhbHVlLCBjYWxsYmFja1N1Y2Nlc3MsIGNhbGxiYWNrRmFpbHVyZSwgc3BVVUlEKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihwYXJhbXNBcnJheS5sZW5ndGggPT0gMyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAoKGV2YWwobWV0aG9kTmFtZSkpKHBhcmFtc0FycmF5WzBdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzFdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzJdLnBhcmFtVmFsdWUsIGNhbGxiYWNrU3VjY2VzcywgY2FsbGJhY2tGYWlsdXJlLCBzcFVVSUQpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHBhcmFtc0FycmF5Lmxlbmd0aCA9PSA0KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICgoZXZhbChtZXRob2ROYW1lKSkocGFyYW1zQXJyYXlbMF0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbMV0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbMl0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbM10ucGFyYW1WYWx1ZSwgY2FsbGJhY2tTdWNjZXNzLCBjYWxsYmFja0ZhaWx1cmUsIHNwVVVJRCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYocGFyYW1zQXJyYXkubGVuZ3RoID09IDUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgKChldmFsKG1ldGhvZE5hbWUpKShwYXJhbXNBcnJheVswXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVsxXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVsyXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVszXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVs0XS5wYXJhbVZhbHVlLCBjYWxsYmFja1N1Y2Nlc3MsIGNhbGxiYWNrRmFpbHVyZSwgc3BVVUlEKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZihwYXJhbXNBcnJheS5sZW5ndGggPT0gNil7XG4gICAgICAgICAgICAgICAgICAgICAgICAoKGV2YWwobWV0aG9kTmFtZSkpKHBhcmFtc0FycmF5WzBdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzFdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzJdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzNdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzRdLnBhcmFtVmFsdWUsIHBhcmFtc0FycmF5WzVdLnBhcmFtVmFsdWUsIGNhbGxiYWNrU3VjY2VzcywgY2FsbGJhY2tGYWlsdXJlLCBzcFVVSUQpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHBhcmFtc0FycmF5Lmxlbmd0aCA9PSA3KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICgoZXZhbChtZXRob2ROYW1lKSkocGFyYW1zQXJyYXlbMF0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbMV0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbMl0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbM10ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbNF0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbNV0ucGFyYW1WYWx1ZSwgcGFyYW1zQXJyYXlbNl0ucGFyYW1WYWx1ZSwgY2FsbGJhY2tTdWNjZXNzLCBjYWxsYmFja0ZhaWx1cmUsIHNwVVVJRCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYocGFyYW1zQXJyYXkubGVuZ3RoID09IDgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgKChldmFsKG1ldGhvZE5hbWUpKShwYXJhbXNBcnJheVswXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVsxXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVsyXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVszXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVs0XS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVs1XS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVs2XS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVs3XS5wYXJhbVZhbHVlLCBjYWxsYmFja1N1Y2Nlc3MsIGNhbGxiYWNrRmFpbHVyZSwgc3BVVUlEKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy9yZXNvbHZlKFwiTG9jYWwgZnVuY3Rpb24gZXhlY3V0ZWRcIik7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJwYXJhbWV0ZXIgY3JlYXRpb24gZmFpbGVkLiBBYm9yZGluZyB3b3JrZXIgb2JqZWN0XCIpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuXG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0V29ya2VySW5mb0luU3VicHJvY2VzczogZnVuY3Rpb24od29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICB2YXIgc3VicHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBwZW5kaW5nU3VibWlzc2lvbk9iamVjdCA9IHtcbiAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjoge1xuICAgICAgICAgICAgICAgICAgICBcImkxOG5cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJfaWRcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW5cIjogXCJUaGUgc2VydmVyIGlzIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0LiBQbGVhc2Ugd2FpdCBhIGZldyBzZWNvbmRzIGFuZCB0aGVuIGNsaWNrIHRoZSByZWZyZXNoIGJ1dHRvbi5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHRcIjogXCJPIHNlcnZpZG9yIGVzdMOhIHByb2Nlc3NhbmRvIHN1YSBzb2xpY2l0YcOnw6NvLiBQb3IgZmF2b3IgYWd1YXJkZSBhbGd1bnMgc2VndW5kb3MgZSBkZXBvaXMgY2xpcXVlIG5vIGJvdMOjbyBhdHVhbGl6YXIuXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwiaW5mb1wiXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc3VicHJvY2Vzc09iamVjdC5tZXNzYWdlcyA9IFtdO1xuICAgICAgICAgICAgc3VicHJvY2Vzc09iamVjdC5tZXNzYWdlcy5wdXNoKHBlbmRpbmdTdWJtaXNzaW9uT2JqZWN0KTtcblxuICAgICAgICAgICAgaWYgKHN1YnByb2Nlc3NPYmplY3Qud29ya2VycyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBzdWJwcm9jZXNzT2JqZWN0LndvcmtlcnMgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN1YnByb2Nlc3NPYmplY3Qud29ya2Vycy5wdXNoKHtcbiAgICAgICAgICAgICAgICBcIndvcmtlcklkXCI6IHdvcmtlck9iamVjdC5faWQsXG4gICAgICAgICAgICAgICAgXCJkYXRlVGltZVwiOiBtb21lbnQoKS5mb3JtYXQoKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICB9LFxuXG5cbiAgICAgICAgY3JlYXRlOiBmdW5jdGlvbih3b3JrZXJDb25maWcsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciBjaGFubmVsID0gd29ya2VyQ29uZmlnLmNoYW5uZWw7XG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlckFjdGlvbiA9IHdvcmtlckNvbmZpZy5hY3Rpb247XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goY2hhbm5lbCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBhY3Rpb25bd29ya2VyQWN0aW9uXSA9IHt9O1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3b3JrZXJDb25maWcuaW5kaWNhdG9ycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGFiZWwgPSB3b3JrZXJDb25maWcuaW5kaWNhdG9yc1tpXS5sYWJlbDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNldElkID0gd29ya2VyQ29uZmlnLmluZGljYXRvcnNbaV0uc2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb250ZXh0ID0gd29ya2VyQ29uZmlnLmluZGljYXRvcnNbaV0uY29udGV4dDtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSBcIlwiO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250ZXh0ID09ICdzdWJQcm9jZXNzJyB8fCBjb250ZXh0ID09ICdjdXJyZW50U3ViUHJvY2Vzc0luc3RhbmNlJyB8fCBjb250ZXh0ID09ICdjdXJyZW50U3ViUHJvY2VzcycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vaWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBzZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihpZCA9PSB1bmRlZmluZWQpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNwb1JlZiA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vanVzdCB0byBtYWtlIHN1cmUgdGhpcyBpcyBub3QgdGhlIGNhc2Ugd2hlcmUgaW5kaWNhdG9ycyBhcmUgbm90IHBvcHVsYXRlZCBkdWUgdG8gc29tZSBvdGhlciByZWFzb24sIG5vdyB3ZSBjYW4gc2VhcmNoIGluIGdsb2JhbCBpbmRpY2F0b3IgYXJyYXkgZm9yIHJlZmVyZW5jZSBpbmRpY2F0b3IgY2FzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNwb1JlZiAhPSB1bmRlZmluZWQgJiYgc3BvUmVmLmluZGljYXRvcnMubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgc2V0SWQgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIHNldElkICsgXCInXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvblt3b3JrZXJBY3Rpb25dW2xhYmVsXSA9IGlkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFjdGlvblt3b3JrZXJBY3Rpb25dLnByb2ZpbElkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcblxuICAgICAgICAgICAgICAgIGlmICh3b3JrZXJDb25maWcuZml4ZWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd29ya2VyQ29uZmlnLmZpeGVkLmxlbmd0aDsgaSsrKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSB3b3JrZXJDb25maWcuZml4ZWRbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gT2JqZWN0LmtleXMob2JqKVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvblt3b3JrZXJBY3Rpb25dW2tleV0gPSBvYmpba2V5XVxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHdvcmtlckNvbmZpZy5kYXRhRmllbGRzICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb25bd29ya2VyQWN0aW9uXS5kYXRhRmllbGRzID0gd29ya2VyQ29uZmlnLmRhdGFGaWVsZHM7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgYWN0aW9uW3dvcmtlckFjdGlvbl0uYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIGFjdGlvblt3b3JrZXJBY3Rpb25dLmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgYWN0aW9uW3dvcmtlckFjdGlvbl0ucHJvZmlsZUlkID0gYXBwLlNDT1BFLndvcmtmbG93LnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgYWN0aW9uW3dvcmtlckFjdGlvbl0uc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKHdvcmtlckFjdGlvbiArICcgd29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuXG5cblxuXG5cblxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgfVxuXG59KSgpO1xuXG52YXIgdXNlciA9IChmdW5jdGlvbigpIHtcblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgYWRkVG9Sb2xlOiBmdW5jdGlvbihhZGRUb1JvbGUsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGFkZFRvUm9sZS51c2VyTmFtZSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24odXNlckRpc3BsYXlOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUoYWRkVG9Sb2xlLnVzZXJJZCwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24odXNlcklkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGFkZFRvUm9sZS5yb2xlSWQsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJvbGVJZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mIHVzZXJEaXNwbGF5TmFtZSAhPSAnc3RyaW5nJyAmJiB0eXBlb2YgdXNlcklkICE9ICdzdHJpbmcnICYmIEFycmF5LmlzQXJyYXkoW3VzZXJEaXNwbGF5TmFtZV0pICYmIEFycmF5LmlzQXJyYXkoW3VzZXJJZF0pKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2Ygcm9sZUlkICE9ICdzdHJpbmcnICYmIEFycmF5LmlzQXJyYXkoW3JvbGVJZF0pKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHVzZXJEaXNwbGF5TmFtZS5sZW5ndGggIT0gdXNlcklkLmxlbmd0aCB8fCB1c2VySWQubGVuZ3RoICE9IHJvbGVJZC5sZW5ndGgpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaXNFcnJvclwiOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjogXCJDb25maWcgaXNzdWUgaW4gcm9sZSBhc3NpZ25tZW50IGFjdGlvbi5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25Sb2xlID0gZnVuY3Rpb24odSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHVzZXJEaXNwbGF5TmFtZS5sZW5ndGggPT0gdSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUm9sZSBhc3NpZ25tZW50IGNvbXBsZXRlJywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHJvbGVJZFt1XSA9PSB1bmRlZmluZWQgfHwgcm9sZUlkW3VdID09IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IHVzZXJJZFt1XSA9PSB1bmRlZmluZWQgfHwgdXNlcklkW3VdID09IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IHVzZXJEaXNwbGF5TmFtZVt1XSA9PSB1bmRlZmluZWQgfHwgdXNlckRpc3BsYXlOYW1lW3VdID09IFwiXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnblJvbGUodSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udGV4dFR5cGUgPSBKU09OLnhwYXRoKFwiL3JvbGVzW2lkIGVxICdcIiArIHJvbGVJZFt1XSArIFwiJ10vdHlwZVwiLCBhcHAuU0NPUEUuQVBQX0NPTkZJRywge30pWzBdXG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb250ZXh0VHlwZSA9PSAnaW5zdGFuY2UnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9sZXNNYW5hZ2VyLmRvVXNlclJlZ2lzdHJhdGlvbih1c2VySWRbdV0sIHVzZXJEaXNwbGF5TmFtZVt1XSwgcm9sZUlkW3VdLCAnaW5zdGFuY2UnKS50aGVuKGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduUm9sZSh1ICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnblJvbGUodSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb250ZXh0VHlwZSA9PSAnc3VicHJvZmlsZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb2xlc01hbmFnZXIuZG9Vc2VyUmVnaXN0cmF0aW9uX25vZGUodXNlcklkW3VdLCB1c2VyRGlzcGxheU5hbWVbdV0sIHJvbGVJZFt1XSwgJ3N1YnByb2ZpbGUnKS50aGVuKGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduUm9sZSh1ICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnblJvbGUodSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb250ZXh0VHlwZSA9PSAnYWRvcHRpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9sZXNNYW5hZ2VyLmRvVXNlclJlZ2lzdHJhdGlvbl9hZG9wdGlvbih1c2VySWRbdV0sIHVzZXJEaXNwbGF5TmFtZVt1XSwgcm9sZUlkW3VdLCAnYWRvcHRpb24nKS50aGVuKGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduUm9sZSh1ICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnblJvbGUodSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25Sb2xlKHUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25Sb2xlKDApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnblJvbGUgPSBmdW5jdGlvbih1KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih1c2VyRGlzcGxheU5hbWUubGVuZ3RoID09IHUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUm9sZSBhc3NpZ25tZW50IGNvbXBsZXRlJywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHJvbGVJZCA9PSB1bmRlZmluZWQgfHwgcm9sZUlkID09IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IHVzZXJJZFt1XSA9PSB1bmRlZmluZWQgfHwgdXNlcklkW3VdID09IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IHVzZXJEaXNwbGF5TmFtZVt1XSA9PSB1bmRlZmluZWQgfHwgdXNlckRpc3BsYXlOYW1lW3VdID09IFwiXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnblJvbGUodSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udGV4dFR5cGUgPSBKU09OLnhwYXRoKFwiL3JvbGVzW2lkIGVxICdcIiArIHJvbGVJZCArIFwiJ10vdHlwZVwiLCBhcHAuU0NPUEUuQVBQX0NPTkZJRywge30pWzBdXG4gICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGV4dFR5cGUgPT0gJ2luc3RhbmNlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9sZXNNYW5hZ2VyLmRvVXNlclJlZ2lzdHJhdGlvbih1c2VySWRbdV0sIHVzZXJEaXNwbGF5TmFtZVt1XSwgcm9sZUlkLCAnaW5zdGFuY2UnKS50aGVuKGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25Sb2xlKHUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnblJvbGUodSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGV4dFR5cGUgPT0gJ3N1YnByb2ZpbGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb2xlc01hbmFnZXIuZG9Vc2VyUmVnaXN0cmF0aW9uX25vZGUodXNlcklkW3VdLCB1c2VyRGlzcGxheU5hbWVbdV0sIHJvbGVJZCwgJ3N1YnByb2ZpbGUnKS50aGVuKGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25Sb2xlKHUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnblJvbGUodSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGV4dFR5cGUgPT0gJ2Fkb3B0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9sZXNNYW5hZ2VyLmRvVXNlclJlZ2lzdHJhdGlvbl9hZG9wdGlvbih1c2VySWRbdV0sIHVzZXJEaXNwbGF5TmFtZVt1XSwgcm9sZUlkLCAnYWRvcHRpb24nKS50aGVuKGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25Sb2xlKHUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnblJvbGUodSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25Sb2xlKHUgKyAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduUm9sZSgwKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udGV4dFR5cGUgPSBKU09OLnhwYXRoKFwiL3JvbGVzW2lkIGVxICdcIiArIHJvbGVJZCArIFwiJ10vdHlwZVwiLCBhcHAuU0NPUEUuQVBQX0NPTkZJRywge30pWzBdXG4gICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGV4dFR5cGUgPT0gJ2luc3RhbmNlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9sZXNNYW5hZ2VyLmRvVXNlclJlZ2lzdHJhdGlvbih1c2VySWQsIHVzZXJEaXNwbGF5TmFtZSwgcm9sZUlkLCAnaW5zdGFuY2UnKS50aGVuKGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUm9sZSBhc3NpZ25lZCB0byB1c2VyIGluIGNvbnRleHQgaW5zdGFuY2UnLCBzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JvbGVzTWFuYWdlci0gaW5zdGFuY2UgZmFpbCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ3JvbGUgdXBkYXRlIGZhaWxlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGV4dFR5cGUgPT0gJ3N1YnByb2ZpbGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb2xlc01hbmFnZXIuZG9Vc2VyUmVnaXN0cmF0aW9uX25vZGUodXNlcklkLCB1c2VyRGlzcGxheU5hbWUsIHJvbGVJZCwgJ3N1YnByb2ZpbGUnKS50aGVuKGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUm9sZSBhc3NpZ25lZCB0byB1c2VyIGluIGNvbnRleHQgc3VicHJvZmlsZScsIHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncm9sZXNNYW5hZ2VyLSBzdWJwcm9maWxlIGZhaWwnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyb2xlIHVwZGF0ZSBmYWlsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHRUeXBlID09ICdhZG9wdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvbGVzTWFuYWdlci5kb1VzZXJSZWdpc3RyYXRpb25fYWRvcHRpb24odXNlcklkLCB1c2VyRGlzcGxheU5hbWUsIHJvbGVJZCwgJ2Fkb3B0aW9uJykudGhlbihmdW5jdGlvbihzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1JvbGUgYXNzaWduZWQgdG8gdXNlciBpbiBjb250ZXh0IGFkb3B0aW9uJywgcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyb2xlc01hbmFnZXItIGFkb3B0aW9uIGZhaWwnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyb2xlIHVwZGF0ZSBmYWlsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1JvbGUgbm90IGZvdW5kIGluIGFueSBjb250ZXh0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoJ1JvbGUgbm90IGZvdW5kIGluIGFueSBjb250ZXh0JylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG5cbnZhciBnZW5lcmFsRnVuY3Rpb25zID0gKGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYWRkVG9GYXZvdXJpdGVzOiBmdW5jdGlvbihmYXZCbG9jaywgX1dGSW5zdGFuY2UsIHV1aWQpe1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbnRleHQgPSBmYXZCbG9jay5jb250ZXh0O1xuICAgICAgICAgICAgICAgIGlmKGNvbnRleHQgPT0gXCJwcm9maWxlXCIpe1xuICAgICAgICAgICAgICAgICAgICBsaWJyYXJ5LmFkZFRvRmF2b3VyaXRlc1Byb2ZpbGUoKS50aGVuKGZ1bmN0aW9uKHMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzKTtcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZihjb250ZXh0ID09IFwic3VicHJvZmlsZVwiKXtcbiAgICAgICAgICAgICAgICAgICAgbGlicmFyeS5hZGRUb0Zhdm91cml0ZXNTdWJQcm9maWxlKCkudGhlbihmdW5jdGlvbihzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocyk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoY29udGV4dCA9PSBcInN1YnByb2Nlc3NcIil7XG4gICAgICAgICAgICAgICAgICAgIGxpYnJhcnkuYWRkVG9GYXZvdXJpdGVzU3ViUHJvY2Vzcyh1dWlkKS50aGVuKGZ1bmN0aW9uKHMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzKTtcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgYWRkVG9Vc2VyRmF2b3VyaXRlczogZnVuY3Rpb24oZmF2QmxvY2ssIF9XRkluc3RhbmNlLCB1dWlkKXtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIHZhciBjb250ZXh0ID0gZmF2QmxvY2suY29udGV4dDtcbiAgICAgICAgICAgICAgICB2YXIgdXNlckJsb2NrID0gZmF2QmxvY2sudXNlcjtcbiAgICAgICAgICAgICAgICAvLyBnZXQgdXNlcklkIGZyb20gZ2V0IG5vZGUgdmFsdWUgXG4gICAgICAgICAgICAgICAgLy9wYXNzIHRvIHNvbWUgbmV3IGZ1bmN0aW9uc1xuXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJJZCA9ICcnO1xuICAgICAgICAgICAgICAgIGlmICh1c2VyQmxvY2suc3RlcEFzc2lnbmVlRnJvbVN0ZXAgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBJZCA9IHVzZXJCbG9jay5zdGVwQXNzaWduZWVGcm9tU3RlcC5zdGVwSWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBoaXN0b3J5T2JqZWN0ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBzdWJQcm9jZXNzT2JqZWN0Lmhpc3RvcnkubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3ViUHJvY2Vzc09iamVjdC5oaXN0b3J5W2ldLmlkID09IHN0ZXBJZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGlzdG9yeU9iamVjdCA9IHN1YlByb2Nlc3NPYmplY3QuaGlzdG9yeVtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYoaGlzdG9yeU9iamVjdC5hc3NpZ25tZW50SGlzdG9yeSAhPSB1bmRlZmluZWQgJiYgaGlzdG9yeU9iamVjdC5hc3NpZ25tZW50SGlzdG9yeS5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBoaXN0b3J5T2JqZWN0LmFzc2lnbm1lbnRIaXN0b3J5W2hpc3RvcnlPYmplY3QuYXNzaWdubWVudEhpc3RvcnkubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VySWQgPSBvYmoudXNlcklkO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVzZXJCbG9jay5pbmRpY2F0b3IgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXRJZCA9IHVzZXJCbG9jay5pbmRpY2F0b3IuaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50SWQgPSB1c2VyQmxvY2suaW5kaWNhdG9yLmVsZW1lbnRJZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBpbmRpY2F0b3JTZXRJZCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy9tb2RlbC9wZW5kaW5nL2RhdGEvJyArIGluZGljYXRvclNldElkICsgJy8nICsgZWxlbWVudElkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmV0VmFsdWUgPSBKU09OLnhwYXRoKHhwYXRoLCBpbmRPYmplY3QsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICB1c2VySWQgPSByZXRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmKGNvbnRleHQgPT0gXCJwcm9maWxlXCIpe1xuICAgICAgICAgICAgICAgICAgICBsaWJyYXJ5LmFkZFRvRmF2b3VyaXRlc1Byb2ZpbGVGb3JVc2VyKHVzZXJJZCkudGhlbihmdW5jdGlvbihzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiV29ya2Zsb3cgKioqKioqIFByb2ZpbGUgRG9uZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocyk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoY29udGV4dCA9PSBcInN1YnByb2ZpbGVcIil7XG4gICAgICAgICAgICAgICAgICAgIGxpYnJhcnkuYWRkVG9GYXZvdXJpdGVzU3VicHJvZmlsZUZvclVzZXIodXNlcklkKS50aGVuKGZ1bmN0aW9uKHMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJXb3JrZmxvdyAqKioqKiogU3ViUHJvZmlsZSBEb25lXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzKTtcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZihjb250ZXh0ID09IFwic3VicHJvY2Vzc1wiKXtcbiAgICAgICAgICAgICAgICAgICAgbGlicmFyeS5hZGRUb1VzZXJzRmF2b3VyaXRlc1N1YlByb2Nlc3NGb3JVc2VyKHVzZXJJZCwgdXVpZCkudGhlbihmdW5jdGlvbihzKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiV29ya2Zsb3cgKioqKioqIFN1YnByb2Nlc3MgRG9uZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocyk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuICAgIGNvbW11bml0eTogY29tbXVuaXR5LFxuICAgIGFwcGxpY2F0aW9uOiBhcHBsaWNhdGlvbixcbiAgICBwZXJmb3JtYW5jZTogcGVyZm9ybWFuY2UsXG4gICAgd29ya2VyOiB3b3JrZXIsXG4gICAgc2RvOiBzZG8sXG4gICAgdGF4b25vbXk6IHRheG9ub215LFxuICAgIHN1YlByb2Nlc3NJbnN0YW5jZTogc3ViUHJvY2Vzc0luc3RhbmNlLFxuICAgIHZhcmlhYmxlczogdmFyaWFibGVzLFxuICAgIG5vdGlmaWNhdGlvbjogbm90aWZpY2F0aW9uLFxuICAgIHJlcG9ydDogcmVwb3J0LFxuICAgIHBhcnRpY2lwYW50czogcGFydGljaXBhbnRzLFxuICAgIHVzZXI6IHVzZXIsXG4gICAgZ2VuZXJhbEZ1bmN0aW9uczogZ2VuZXJhbEZ1bmN0aW9uc1xufSIsIid1c2Ugc3RyaWN0JztcblxuLy92YXIgZ2F0ZWtlZXBlciA9IHJlcXVpcmUoJy4uL2Jvd2VyX2NvbXBvbmVudHMvZ2F0ZWtlZXBlcicpO1xudmFyIHV0aWwgPSByZXF1aXJlKCd1dGlsaXR5Jyk7XG5cbi8vIHZhciB1dWlkID0gcmVxdWlyZSgnbm9kZS11dWlkJyk7XG5cbnZhciBnYXRla2VlcGVyID0gbmV3IEdLKCk7XG5cbi8qKlxuICogRm9ybSBNb2R1bGVcbiAqXG4gKiBAbW9kdWxlIGxpYi9mb3JtXG4gKiBAYXV0aG9yIEJyZW50IEdvcmRvblxuICogQHZlcnNpb24gMi4wLjBcbiAqIEBkZXNjcmlwdGlvbiB0ZXN0IGRlc2NyaXB0aW9uXG4gKiBAY29weXJpZ2h0IEt3YW50dSBMdGQgUlNBIDIwMDktMjAxNS5cbiAqXG4gKi9cblxuZnVuY3Rpb24gY3JlYXRlKGFyZ3MpIHtcblxuICAgIHZhciBwcm9jZXNzSWQgPSBhcmdzWzBdIHx8ICcnO1xuXG4gICAgdmFyIHN1YlByb2Nlc3MgPSBhcmdzWzFdIHx8IHt9O1xuXG4gICAgdmFyIHN0ZXAgPSBhcmdzWzJdIHx8IHt9O1xuXG4gICAgdmFyIGFjdGlvbiA9IGFyZ3NbM10gfHwge307XG5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBhcmdzWzZdIHx8IHt9O1xuXG4gICAgdmFyIGRhdGEgPSBhcmdzWzZdIHx8IHt9O1xuXG4gICAgdmFyIGluZGljYXRvcnMgPSBzdWJQcm9jZXNzLmluZGljYXRvcnMgfHwgW107XG5cbiAgICB2YXIgcmVzdWx0ID0gW107XG5cbiAgICB2YXIgaW5kaWNhdG9yVHlwZSA9IGFjdGlvbi5fdHlwZTtcblxuICAgIHZhciBwcm9jZXNzU2VxID0gYXJnc1s0XSB8fCAnJztcblxuICAgIHZhciBzdWJQcm9jZXNzU2VxID0gYXJnc1s1XSB8fCAnJztcblxuICAgIHZhciBjcmVhdGVUeXBlID0gYXJnc1s3XSB8fCAnJztcblxuICAgIHZhciBzdWJQcm9jZXNzSWQgPSBzdWJQcm9jZXNzLl9pZDtcblxuICAgIHZhciB1dWlkID0gYXJnc1s4XSB8fCAnJztcblxuICAgIHZhciBiYXNlVVVJRCA9IGFyZ3NbOV0gfHwgJyc7XG5cbiAgICB2YXIgcHJvZmlsZSA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG5cbiAgICB2YXIgaW5wdXREYXRhID0gYXJnc1sxMF0gfHwge307XG5cbiAgICB2YXIgZm9ybUNyZWF0ZVR5cGUgPSBhY3Rpb24ubWV0aG9kLmZvcm0uY3JlYXRlO1xuICAgIFxuICAgIGlmIChhY3Rpb24ubWV0aG9kLmZvcm0uYXV0aG9yaXNlQW5kQ3JlYXRlTmV3U2VxICE9IHVuZGVmaW5lZCkge1xuICAgICAgICBmb3JtQ3JlYXRlVHlwZSA9IGFjdGlvbi5tZXRob2QuZm9ybS5hdXRob3Jpc2VBbmRDcmVhdGVOZXdTZXE7XG4gICAgfSBcbiAgICBlbHNlIGlmIChhY3Rpb24ubWV0aG9kLmZvcm0uY3JlYXRlTmV3U2VxICE9IHVuZGVmaW5lZCkge1xuICAgICAgICBmb3JtQ3JlYXRlVHlwZSA9IGFjdGlvbi5tZXRob2QuZm9ybS5jcmVhdGVOZXdTZXE7XG4gICAgfVxuXG4gICAgdmFyIGZvcm1UeXBlID0gYWN0aW9uLm1ldGhvZC5mb3JtLnR5cGU7XG5cbiAgICB2YXIgcGFyYW1PYmplY3QgPSB7XG5cbiAgICAgICAgXCJmb3JtQ3JlYXRlVHlwZVwiOiBmb3JtQ3JlYXRlVHlwZSxcbiAgICAgICAgXCJmb3JtVHlwZVwiOiBmb3JtVHlwZVxuXG4gICAgfVxuICAgIFxuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdmFyIHRvUHJvY2VzcyA9IGluZGljYXRvcnMubGVuZ3RoO1xuICAgICAgICB2YXIgYnJva2UgPSBmYWxzZTtcblxuXG4gICAgICAgIC8vaGFzYW5cblxuICAgICAgICB2YXIgZXJyb3JBcnJheSA9IFtdO1xuXG4gICAgICAgIHZhciByZXNvbHZlQ2FsbGVyID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICBpZiAoYnJva2UgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBjcmVhdGUgaW5kaWNhdG9yIHBlcnNpc3Qgc3VjY2Vzcy4nLCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgIHZhciB0b0FkZFByb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IF9XRkluc3RhbmNlLmluc3RhbmNlLnByb2Nlc3Nlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX1dGSW5zdGFuY2UuaW5zdGFuY2UucHJvY2Vzc2VzW2ldLnN1YlByb2Nlc3Nlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b0FkZFByb2Nlc3MucHVzaChfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMgPSB0b0FkZFByb2Nlc3M7XG5cblxuICAgICAgICAgICAgICAgIHZhciBpbnZvbHZlZFN1YlByb2Nlc3NlcyA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc0lkID0gc3ViUHJvY2Vzc09iamVjdC5pZDtcbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc0NvbmZpZ09iamVjdCA9IEpTT04ueHBhdGgoXCIvY29uZmlnL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBpZiAoc3ViUHJvY2Vzc0NvbmZpZ09iamVjdC5pbnN0YW5jZVR5cGUubmV3U2VxdWVuY2UgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdWJQcm9jZXNzQ29uZmlnT2JqZWN0LmluZGljYXRvcnMubGVuZ3RoOyBpKyspIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvciA9IHN1YlByb2Nlc3NDb25maWdPYmplY3QuaW5kaWNhdG9yc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXRJZCA9IGluZGljYXRvci5faWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCJkaXN0aW5jdC12YWx1ZXMoL3N1YnByb2Nlc3Nlc1tncm91cEtleSA9ICdcIiArIHN1YlByb2Nlc3NPYmplY3QuZ3JvdXBLZXkgKyBcIiddL2luZGljYXRvcnNbaWQgPSAnXCIgKyBzZXRJZCArIFwiJ10vaW5zdGFuY2VzL3V1aWQpXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXMvaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBzZXRJZCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGljYXRvclVVSUQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvck9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kaWNhdG9yT2JqZWN0ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3JPYmplY3QubW9kZWwucGVuZGluZyA9IGluZGljYXRvck9iamVjdC5tb2RlbC5hcHByb3ZlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kTGlzdE5hbWVzID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3ViUHJvY2Vzc0NvbmZpZ09iamVjdC5pbmRpY2F0b3JzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5kTGlzdE5hbWVzID0gaW5kTGlzdE5hbWVzICsgXCInXCIgKyBzdWJQcm9jZXNzQ29uZmlnT2JqZWN0LmluZGljYXRvcnNbaV0uX2lkICsgXCInLFwiXG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpbmRMaXN0TmFtZXMgPSBpbmRMaXN0TmFtZXMgKyBcIidcIiArIHN1YlByb2Nlc3NDb25maWdPYmplY3QuaW5kaWNhdG9yc1tzdWJQcm9jZXNzQ29uZmlnT2JqZWN0LmluZGljYXRvcnMubGVuZ3RoIC0gMV0uX2lkICsgXCInXCJcbiAgICAgICAgICAgICAgICAgICAgaW52b2x2ZWRTdWJQcm9jZXNzZXMgPSBKU09OLnhwYXRoKFwiZGlzdGluY3QtdmFsdWVzKC9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gPSAoXCIgKyBpbmRMaXN0TmFtZXMgKyBcIildL21vZGVsL2FwcHJvdmVkL3N1YlByb2Nlc3NVVUlEKVwiLCBfV0ZJbnN0YW5jZSwge30pO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBwZXJzaXN0U3ViUHJvY2VzcyA9IGZ1bmN0aW9uIChpbmRleCwgaW52b2x2ZWRTdWJQcm9jZXNzZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PSBpbnZvbHZlZFN1YlByb2Nlc3Nlcy5sZW5ndGgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b0FkZFN1YlByb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzW2ldLmluZGljYXRvcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9BZGRTdWJQcm9jZXNzLnB1c2goX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3NlcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3NlcyA9IHRvQWRkU3ViUHJvY2VzcztcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJ1Byb2Nlc3MgZmFpbGVkJywgZXJyb3JBcnJheSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGZhaWx1cmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3REYXRhKCdpbmRpY2F0b3JzJywgX1dGSW5zdGFuY2UsIGludm9sdmVkU3ViUHJvY2Vzc2VzW2luZGV4XSkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0U3ViUHJvY2VzcyhpbmRleCArIDEsIGludm9sdmVkU3ViUHJvY2Vzc2VzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3RTdWJQcm9jZXNzKGluZGV4ICsgMSwgaW52b2x2ZWRTdWJQcm9jZXNzZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBwZXJzaXN0U3ViUHJvY2VzcygwLCBpbnZvbHZlZFN1YlByb2Nlc3Nlcyk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB0b0FkZFN1YlByb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXNbaV0uaW5kaWNhdG9ycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9BZGRTdWJQcm9jZXNzLnB1c2goX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3NlcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMgPSB0b0FkZFN1YlByb2Nlc3M7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCdQcm9jZXNzIGZhaWxlZCcsIGVycm9yQXJyYXkpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZmFpbHVyZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cblxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHN1YnByb2Nlc3NUeXBlID0gSlNPTi54cGF0aChcIi9jb25maWcvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInXS90eXBlXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgdmFyIGZvcm1DcmVhdGVGbiA9IGZ1bmN0aW9uIChpbmRpY2F0b3JUeXBlLCBpbmRpY2F0b3JJZCwgdmFsaWREYXRlLCBpbnN0YW50aWF0ZVNvdXJjZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgZ2F0ZWtlZXBlci5pbnN0YW50aWF0ZShiYXNlVVVJRCwgaW5kaWNhdG9yVHlwZSwgaW5kaWNhdG9ySWQsIF9XRkluc3RhbmNlLnByb2ZpbGUsIHZhbGlkRGF0ZSwgc3ViUHJvY2Vzc0lkLCBzdWJwcm9jZXNzVHlwZSkudGhlbihmdW5jdGlvbiAoZG9jQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBpbmRpY2F0b3Igd29ya2Zsb3cgcHJvY2Vzc2VzIHNlY3Rpb25cblxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRvY0FycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqZWN0ID0gZG9jQXJyYXlbaV07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3IgPSBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzW2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kaWNhdG9yLl9pZCA9PSBvYmplY3QubW9kZWwuX2lkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLnB1c2gob2JqZWN0Lm1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW9iamVjdC5tb2RlbC5faWQuZW5kc1dpdGgoJzphcHByb3ZlZCcpICYmICFvYmplY3QubW9kZWwuX2lkLmVuZHNXaXRoKCc6cmVqZWN0ZWQnKSkge1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QubW9kZWwubW9kZWwucGVuZGluZy52YWxpZERhdGUgPSB2YWxpZERhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0Lm1vZGVsLm1vZGVsLnBlbmRpbmcuc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3b3JrZmxvd09iaiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBfV0ZJbnN0YW5jZS5jb25maWcuX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImluc3RhbmNlXCI6IF9XRkluc3RhbmNlLmluc3RhbmNlLl9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9jZXNzZXNcIjogW3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogcHJvY2Vzc0lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzSWRcIjogc3ViUHJvY2Vzcy5faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0ZXBcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogc3RlcC5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBzdGVwLnNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0YXJ0RGF0ZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RhdHVzXCI6IHN0ZXAuc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZVwiOiBzdGVwLm1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhc3NpZ25lZFRvXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogc3RlcC5hc3NpZ25lZFRvLnVzZXJJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IHN0ZXAuYXNzaWduZWRUby5uYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbW1lbnRcIjogc3RlcC5jb21tZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tcGxldGVcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJlbmREYXRlXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmplY3QubW9kZWwubW9kZWwucGVuZGluZy5zZXEgPT0gMSAmJiBhY3Rpb24uc2V0V29ya2Zsb3dMYWJlbEluVGl0bGUgIT0gdW5kZWZpbmVkICYmIGFjdGlvbi5zZXRXb3JrZmxvd0xhYmVsSW5UaXRsZSAhPSAnJyAmJiBhY3Rpb24uc2V0V29ya2Zsb3dMYWJlbEluVGl0bGUgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QubW9kZWwudGl0bGUgPSBpbnB1dERhdGEubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvbi5zZXREcmFmdCAhPSB1bmRlZmluZWQgJiYgYWN0aW9uLnNldERyYWZ0ICE9ICcnICYmIGFjdGlvbi5zZXREcmFmdCA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdC5tb2RlbC5jb250cm9sLmRyYWZ0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFscmVhZHlFeGlzdHMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JJbmRleCA9IC0xO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdC5tb2RlbC53b3JrZmxvd3MuZm9yRWFjaChmdW5jdGlvbih3b3JrZmxvd0Jsb2NrSW5JbmRpY2F0b3IsIGluZGV4KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodXVpZCA9PSB3b3JrZmxvd0Jsb2NrSW5JbmRpY2F0b3IucHJvY2Vzc2VzWzBdLnN1YlByb2Nlc3NVVUlEKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscmVhZHlFeGlzdHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIWFscmVhZHlFeGlzdHMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QubW9kZWwud29ya2Zsb3dzLnB1c2god29ya2Zsb3dPYmopO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0Lm1vZGVsLndvcmtmbG93c1tvYkluZGV4XSA9IHdvcmtmbG93T2JqO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWFpbklkID0gb2JqZWN0Lm1vZGVsLl9pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwZXJzaXN0IHZpYSBnayBzbyB0aGF0IGl0IGlzIHNhdmUgaW4gY291Y2hcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYXRla2VlcGVyLnBlcnNpc3QoZG9jQXJyYXkpLnRoZW4oZnVuY3Rpb24gKHNhdmVkQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy91c2luZyBzYW1lIGlkIGNhbGwgaW5pdGlhbGlzZURhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jYWxsIGNvZGUgdG8gc2V0IHRvIHNldEluc3RhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5nZXQobWFpbklkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JNb2RlbCA9IGtvLm1hcHBpbmcuZnJvbUpTKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRlZmF1bHRNb2RlbFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2V0SWRcIjogaW5kaWNhdG9ySWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlcXVlbmNlID0gZGF0YS5tb2RlbC5wZW5kaW5nLnNlcTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhdGVrZWVwZXIuaW5zdGFudGlhdGVEYXRhKG1haW5JZCwgaW5zdGFudGlhdGVTb3VyY2UsIGluZGljYXRvck1vZGVsLCBkYXRhLm1vZGVsLnBlbmRpbmcuc2VxLCBwYXJhbU9iamVjdCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhWzBdLnN0YXR1cyA9PSBcIjIwMFwiKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IF9XRkluc3RhbmNlLmluZGljYXRvcnMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yID0gX1dGSW5zdGFuY2UuaW5kaWNhdG9yc1tpbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kaWNhdG9yLl9pZCA9PSBkYXRhWzBdLm1vZGVsLl9pZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLmluZGljYXRvcnMucHVzaChkYXRhWzBdLm1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VxdWVuY2UgPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvbi5zZXRXb3JrZmxvd0xhYmVsSW5GaWVsZCAhPSB1bmRlZmluZWQgJiYgYWN0aW9uLnNldFdvcmtmbG93TGFiZWxJbkZpZWxkICE9ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnRTZXRJZCA9IGFjdGlvbi5zZXRXb3JrZmxvd0xhYmVsSW5GaWVsZC5zcGxpdChcIi5cIilbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFzc2lnbm1lbnRTZXRJZCA9PSBpbmRpY2F0b3JJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR4dCA9IGlucHV0RGF0YS5sYWJlbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNxdW90ZSA9IHR4dC5yZXBsYWNlKC8nL2csIFwiXFxcXCdcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaW5hbFZhbHVlID0gZGF0YVswXS5tb2RlbC5tb2RlbC5wZW5kaW5nLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRoVG9FbGVtZW50ID0gYWN0aW9uLnNldFdvcmtmbG93TGFiZWxJbkZpZWxkID09IFwiXCIgPyBbXSA6IGFjdGlvbi5zZXRXb3JrZmxvd0xhYmVsSW5GaWVsZC5zcGxpdCgvWydcIlxcW1xcXS5dKy8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgayA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCBwYXRoVG9FbGVtZW50Lmxlbmd0aCAtIDE7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocGF0aFRvRWxlbWVudFtrXSA9PSBcIlwiKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWVbcGF0aFRvRWxlbWVudFtrXV0gPSBzcXVvdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhdGVrZWVwZXIucGVyc2lzdChkYXRhKS50aGVuKGZ1bmN0aW9uIChzYXZlZEFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0KG1haW5JZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLmluZGljYXRvcnMucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b1Byb2Nlc3MgPT0gMCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0RGF0YSgnaW5kaWNhdG9ycycsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBjcmVhdGUgaW5kaWNhdG9yIHBlcnNpc3Qgc3VjY2Vzcy4nLCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckFycmF5LnB1c2goe1wiZXJyb3JcIjogXCJwZXJzaXN0RGF0YSBcIisgdXVpZCwgXCJlcnJvckJsb2NrXCI6IGVycn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnRm9ybSBjcmVhdGUgaW5kaWNhdG9yIHBlcnNpc3QgZmFpbGVkLicsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicm9rZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoe30pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IF9XRkluc3RhbmNlLmluZGljYXRvcnMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yID0gX1dGSW5zdGFuY2UuaW5kaWNhdG9yc1tpbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kaWNhdG9yLl9pZCA9PSBkYXRhLl9pZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgY3VycmVudCBpdGVtIGZyb20gdGhlIGFycmF5IGFuZCBhZGQgdGhlIHVwZGF0ZWQgcHJvY2Vzc01vZGVsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLmluZGljYXRvcnMucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IF9XRkluc3RhbmNlLmluZGljYXRvcnMubGVuZ3RoO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc2lzdERhdGEoJ2luZGljYXRvcnMnLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBjcmVhdGUgaW5kaWNhdG9yIHBlcnNpc3Qgc3VjY2Vzcy4nLCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVDYWxsZXIoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckFycmF5LnB1c2goe1wiZXJyb3JcIjogXCJwZXJzaXN0RGF0YSBcIisgdXVpZCwgXCJlcnJvckJsb2NrXCI6IGVycn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gY3JlYXRlIGluZGljYXRvciBwZXJzaXN0IGZhaWxlZC4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicm9rZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHt9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3VuZCA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5wdXNoKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b1Byb2Nlc3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3REYXRhKCdpbmRpY2F0b3JzJywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBjcmVhdGUgaW5kaWNhdG9yIHBlcnNpc3Qgc3VjY2Vzcy4nLCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckFycmF5LnB1c2goe1wiZXJyb3JcIjogXCJwZXJzaXN0RGF0YSBcIisgdXVpZCwgXCJlcnJvckJsb2NrXCI6IGVycn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCdGb3JtIGNyZWF0ZSBpbmRpY2F0b3IgcGVyc2lzdCBmYWlsZWQuJywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicm9rZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVDYWxsZXIoKTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh7fSk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckFycmF5LnB1c2goe1wiZXJyb3JcIjogXCJkYW8uZ2V0KG1haW5JZCkgXCIrIG1haW5JZCwgXCJlcnJvckJsb2NrXCI6IGVycn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnMSBHYXRla2VlcGVyIGluaXRpYWxpc2F0aW9uIGZhaWxlZCB3aXRoIGluaXRpYWxpc2VEYXRhIG1lc3NhZ2UgJywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyb2tlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoe30pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yQXJyYXkucHVzaCh7XCJlcnJvclwiOiBcImdhdGVrZWVwZXIucGVyc2lzdChkYXRhKSAtIFBlcnNpc3RpbmcgYWxsIGRvY3MgXCIsIFwiZXJyb3JCbG9ja1wiOiBlcnJ9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCcyIEdhdGVrZWVwZXIgaW5pdGlhbGlzYXRpb24gZmFpbGVkIHdpdGggaW5pdGlhbGlzZURhdGEgbWVzc2FnZSAnLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicm9rZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b1Byb2Nlc3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmVDYWxsZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh7fSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckFycmF5LnB1c2goe1wiZXJyb3JcIjogXCJnYXRla2VlcGVyLmluc3RhbnRpYXRlRGF0YVwiKyBtYWluSWQgKyBcIiBcIisgZGF0YVswXS5zdGF0dXMgLCBcImVycm9yQmxvY2tcIjoge319KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJzMgR2F0ZWtlZXBlciBpbml0aWFsaXNhdGlvbiBmYWlsZWQgd2l0aCBpbml0aWFsaXNlRGF0YSBtZXNzYWdlICcsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJva2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRvUHJvY2VzcyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHt9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yQXJyYXkucHVzaCh7XCJlcnJvclwiOiBcImdhdGVrZWVwZXIuaW5zdGFudGlhdGVEYXRhXCIrIG1haW5JZCwgXCJlcnJvckJsb2NrXCI6IGVycn0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCc0IEdhdGVrZWVwZXIgaW5pdGlhbGlzYXRpb24gZmFpbGVkIHdpdGggaW5pdGlhbGlzZURhdGEgbWVzc2FnZSAnLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJva2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvUHJvY2Vzcy0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b1Byb2Nlc3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh7fSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yQXJyYXkucHVzaCh7XCJlcnJvclwiOiBcImRhby5nZXQobWFpbklkKSBcIisgbWFpbklkLCBcImVycm9yQmxvY2tcIjogZXJyfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnNSBHYXRla2VlcGVyIGluaXRpYWxpc2F0aW9uIGZhaWxlZCB3aXRoIGluaXRpYWxpc2VEYXRhIG1lc3NhZ2UgJywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJva2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoe30pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvckFycmF5LnB1c2goe1wiZXJyb3JcIjogXCJnYXRla2VlcGVyLnBlcnNpc3Qgc2F2ZWRBcnJheVwiLCBcImVycm9yQmxvY2tcIjogZXJyfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJzYgR2F0ZWtlZXBlciBpbml0aWFsaXNhdGlvbiBmYWlsZWQgd2l0aCBpbml0aWFsaXNlRGF0YSBtZXNzYWdlICcsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJva2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRvUHJvY2VzcyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHt9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JBcnJheS5wdXNoKHtcImVycm9yXCI6IFwiZ2F0ZWtlZXBlci5pbnN0YW50aWF0ZVwiLCBcImVycm9yQmxvY2tcIjogZXJyfSk7XG4gICAgICAgICAgICAgICAgICAgIGJyb2tlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b1Byb2Nlc3MgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxlcigpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh7fSk7XG5cblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KTtcblxuXG5cbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgaW5zdGFudGlhdGVTb3VyY2UgPSBGUk9NX0RFRklOSVRJT047XG5cbiAgICAgICAgdmFyIGxvb3BGdW5jdGlvbiA9IGZ1bmN0aW9uIChpbmRpY2F0b3JzLCBjb3VudGVyKSB7XG5cbiAgICAgICAgICAgIGlmIChpbmRpY2F0b3JzLmxlbmd0aCA9PSAwKSB7XG5cbiAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZUNhbGxlcigpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoY291bnRlciA8IGluZGljYXRvcnMubGVuZ3RoKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9ySWQgPSBpbmRpY2F0b3JzW2NvdW50ZXJdLl9pZDtcbiAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yTmFtZSA9IHV0aWwuZ2V0TmFtZShpbmRpY2F0b3JzW2NvdW50ZXJdLm5hbWUsICdlbicpO1xuICAgICAgICAgICAgICAgIHZhciBzZG9DcmVhdGVUeXBlID0gaW5kaWNhdG9yc1tjb3VudGVyXS5zZXF1ZW5jZUNyZWF0aW9uO1xuICAgICAgICAgICAgICAgIGlmKHNkb0NyZWF0ZVR5cGUgPT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgc2RvQ3JlYXRlVHlwZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSBpbmRpY2F0b3JzW2NvdW50ZXJdLmluaXRpYXRlRGF0YTtcblxuICAgICAgICAgICAgICAgIHZhciBpbml0VHlwZSA9ICcnO1xuICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzLmluc3RhbmNlVHlwZS5uZXdTZXF1ZW5jZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5pdFR5cGUgPSBJTlNUQU5DRV9UWVBFX05FV19TRVE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdWJQcm9jZXNzLmluc3RhbmNlVHlwZS5uZXdJbnN0YW5jZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5pdFR5cGUgPSBJTlNUQU5DRV9UWVBFX05FV19JTlM7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNyZWF0ZUZvcm0gPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBmb3JtQ3JlYXRlRm4oaW5pdFR5cGUsIGluZGljYXRvcklkLCBpbnB1dERhdGEudmFsaWREYXRlLCBpbnN0YW50aWF0ZVNvdXJjZSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvb3BGdW5jdGlvbihpbmRpY2F0b3JzLCAoY291bnRlciArIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYnJva2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlQ2FsbGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGluZGljYXRvckRvYyA9IHt9O1xuICAgICAgICAgICAgICAgIGlmIChiYXNlVVVJRCAhPSB1bmRlZmluZWQgJiYgYmFzZVVVSUQgIT0gJycgJiYgYmFzZVVVSUQubGVuZ3RoID4gMCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzcCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBiYXNlVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzLnBlcmlvZFR5cGUucGVyaW9kaWMgPT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiYXNlVVVJRCAhPSB1dWlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3AuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYoZm9ybUNyZWF0ZVR5cGUgPT0gQkxBTktfTU9ERUwgfHwgc2RvQ3JlYXRlVHlwZSA9PSBCTEFOS19NT0RFTCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW50aWF0ZVNvdXJjZSA9IEZST01fREVGSU5JVElPTjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlU291cmNlID0gRlJPTV9BVVRIT1JJU0VEO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVGb3JtKCk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2FyZGluYWxpdHkgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbc2V0SWQgZXEgJ1wiICsgaW5kaWNhdG9ySWQgKyBcIiddL2NhcmRpbmFsaXR5XCIsIGFwcC5TQ09QRS5BUFBfQ09ORklHLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGluaXRUeXBlID09IElOU1RBTkNFX1RZUEVfTkVXX0lOUykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FyZGluYWxpdHkgPT0gSU5ESUNBVE9SX0NBUkRJTkFMSVRZX1NJTkdMRSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlicmFyeS5nZXRTaW5nbGVJbmRpY2F0b3IoaW5kaWNhdG9ySWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZXhpc3RpbmdVVUlEKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdVVUlELmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlU291cmNlID0gRlJPTV9BVVRIT1JJU0VEO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFudGlhdGVTb3VyY2UgPSBGUk9NX0RFRklOSVRJT047XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVGb3JtKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihleGlzdGluZ1VVSUQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW50aWF0ZVNvdXJjZSA9IEZST01fREVGSU5JVElPTjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlRm9ybSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW50aWF0ZVNvdXJjZSA9IEZST01fREVGSU5JVElPTjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVGb3JtKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhcmRpbmFsaXR5ID09IElORElDQVRPUl9DQVJESU5BTElUWV9TSU5HTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpYnJhcnkuZ2V0U2luZ2xlSW5kaWNhdG9yKGluZGljYXRvcklkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGV4aXN0aW5nVVVJRCl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nVVVJRC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW50aWF0ZVNvdXJjZSA9IEZST01fQVVUSE9SSVNFRDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlU291cmNlID0gRlJPTV9ERUZJTklUSU9OO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlRm9ybSgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXhpc3RpbmdVVUlEKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFudGlhdGVTb3VyY2UgPSBGUk9NX0RFRklOSVRJT047XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZUZvcm0oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NoZWNrIGhlcmVcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRoID0gXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIGluZGljYXRvcklkICsgXCInIGFuZCBpZCA9IC9zdWJwcm9jZXNzZXNbaWQgPSAnXCIgKyBzdWJQcm9jZXNzSWQgKyBcIiddL2luZGljYXRvcnMvaW5zdGFuY2VzL3V1aWRdL19pZFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJwcm9jZXNzVHlwZSA9PSBQUk9DRVNTX1RZUEVfU1VCUFJPRklMRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIGluZGljYXRvcklkICsgXCInIGFuZCBpZCA9IC9zdWJwcm9jZXNzZXNbaWQgPSAnXCIgKyBzdWJQcm9jZXNzSWQgKyBcIicgYW5kIGlkID0gXCIgKyBwYXJ0ICsgXCJdL2luZGljYXRvcnMvaW5zdGFuY2VzL3V1aWRdL19pZFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdVVUlEID0gSlNPTi54cGF0aChwYXRoLCBfV0ZJbnN0YW5jZSwge30pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nVVVJRC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlU291cmNlID0gRlJPTV9BVVRIT1JJU0VEO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlU291cmNlID0gRlJPTV9ERUZJTklUSU9OO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVGb3JtKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgICBsb29wRnVuY3Rpb24oaW5kaWNhdG9ycywgMCk7XG5cbiAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIHNldEluc3RhbmNlVGl0bGUoYXJncykge1xuXG4gICAgdmFyIF9XRkluc3RhbmNlID0gYXJnc1swXSB8fCB7fTtcblxuICAgIHZhciB1dWlkID0gYXJnc1syXSB8fCAnJztcbiAgICB2YXIgZGF0YSA9IGFyZ3NbNF0gfHwge307XG5cbiAgICB2YXIgdGl0bGUgPSBkYXRhLmxhYmVsO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICB2YXIgc3ViUHJvY2Vzc0luc3RhbmNlID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgXG4gICAgICAgIHZhciBpbmRpY2F0b3JJbnN0YW5jZXMgPSBzdWJQcm9jZXNzSW5zdGFuY2UuaW5kaWNhdG9ycztcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluZGljYXRvckluc3RhbmNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBpbmRpY2F0b3JJbnN0YW5jZXNbaV0uaW5zdGFuY2VzWzBdLnV1aWQ7XG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9ySW5zdGFuY2UgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICBpbmRpY2F0b3JJbnN0YW5jZS50aXRsZSA9IGluZGljYXRvckluc3RhbmNlc1tpXS5pZCArICcgJyArIHRpdGxlO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJlc29sdmUoXCJTZXQgVGl0bGUgU3VjY2Vzc1wiLCBpbmRpY2F0b3JJbnN0YW5jZXMpO1xuXG4gICAgfSk7XG5cbn07XG5cbmZ1bmN0aW9uIGRlbGV0ZVByb2ZpbGUoYXJncykge1xuXG4gICAgdmFyIF9XRkluc3RhbmNlID0gYXJnc1swXSB8fCB7fTtcblxuICAgIHZhciBwcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0ge1xuICAgICAgICAgICAgXCJzb3VyY2VcIjogXCJyZW1vdGVcIixcbiAgICAgICAgICAgIFwidHlwZVwiOiBcIndvcmtlck9iamVjdFwiLFxuICAgICAgICAgICAgXCJfaWRcIjogZ2VuZXJhdGVVVUlEKCksXG4gICAgICAgICAgICBcImNoYW5uZWxzXCI6IFtcImRlbGV0ZVByb2ZpbGVcIiwgXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSwgXCJ3b3JrZXJPYmplY3RcIl0sXG4gICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkLFxuICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZSxcbiAgICAgICAgICAgIFwibWVzc2FnZVwiOiBcIlwiLFxuICAgICAgICAgICAgXCJzdWJwcm9maWxlSWRcIjogc3VicHJvZmlsZUlkLFxuICAgICAgICAgICAgXCJtZXNzYWdlVHlwZVwiOiBcImluZm9cIixcbiAgICAgICAgICAgIFwiY3JlYXRlZERhdGVUaW1lXCI6IG1vbWVudCgpLmZvcm1hdCgpLFxuICAgICAgICAgICAgXCJzZW5kZXJVc2VySWRcIjogX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQsXG4gICAgICAgICAgICBcInBhcmVudFRyYW5zYWN0aW9uSWRcIjogKGFwcC5TQ09QRS50eG4gPT0gdW5kZWZpbmVkICA/IFwiXCIgOiBhcHAuU0NPUEUudHhuLnRyYW5zYWN0aW9uSWQpLFxuICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJwcm9maWxlXCI6IHtcbiAgICAgICAgICAgICAgICBcImFjdGlvblwiOiBcImRlbGV0ZVByb2ZpbGVcIixcbiAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBwcm9maWxlSWRcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2cod29ya2VyT2JqZWN0KTtcbiAgICAgICAgZGFvLnNhdmUod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIldvcmtlciBPYmplY3Qgc3VibWl0dGVkIGZvciBwcm9maWxlKFwiICsgcHJvZmlsZUlkICsgXCIpIGRlbGV0aW9uLlwiKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgIHJlamVjdChkYXRhKTtcbiAgICAgICAgfSk7XG5cbiAgICB9KTtcblxufTtcblxuZnVuY3Rpb24gY3JlYXRlUHJvZmlsZShhcmdzKSB7XG5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBhcmdzWzFdIHx8IHt9O1xuXG4gICAgdmFyIGNvbW11bml0eUlkID0gX1dGSW5zdGFuY2UuY29tbXVuaXR5SWQ7XG4gICAgdmFyIHByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIGxpYnJhcnkuY3JlYXRlUHJvZmlsZURvY3VtZW50cyhjb21tdW5pdHlJZCwgcHJvZmlsZUlkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdGb3JtIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5LicsIGRhdGEpO1xuICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XG5cbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCdFUlJPUjogUHJvZmlsZSBjcmVhdGlvbiBmYWlsZWQnLCB7fSk7XG4gICAgICAgICAgICByZWplY3QoZmFpbHVyZSk7XG5cbiAgICAgICAgfSk7XG5cbiAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIHNldERyYWZ0KGFyZ3MpIHtcblxuICAgIHZhciBfV0ZJbnN0YW5jZSA9IGFyZ3NbMF0gfHwge307XG5cbiAgICB2YXIgY29tbXVuaXR5SWQgPSBfV0ZJbnN0YW5jZS5jb21tdW5pdHlJZDtcbiAgICB2YXIgcHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICB2YXIgdXVpZCA9IGFyZ3NbMl0gfHwgJyc7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIHZhciBzdWJQcm9jZXNzSW5zdGFuY2UgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgXG4gICAgICAgIHZhciBpbmRpY2F0b3JJbnN0YW5jZXMgPSBzdWJQcm9jZXNzSW5zdGFuY2UuaW5kaWNhdG9ycztcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluZGljYXRvckluc3RhbmNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBpbmRpY2F0b3JJbnN0YW5jZXNbaV0uaW5zdGFuY2VzWzBdLnV1aWQ7XG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9ySW5zdGFuY2UgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICBpbmRpY2F0b3JJbnN0YW5jZS5jb250cm9sLmRyYWZ0ID0gdHJ1ZTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXNvbHZlKFwiU2V0IERyYWZ0IFN1Y2Nlc3NcIiwgaW5kaWNhdG9ySW5zdGFuY2VzKTtcblxuICAgIH0pO1xufTtcblxuZnVuY3Rpb24gc2V0VW5EcmFmdChhcmdzKSB7XG5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBhcmdzWzBdIHx8IHt9O1xuXG4gICAgdmFyIGNvbW11bml0eUlkID0gX1dGSW5zdGFuY2UuY29tbXVuaXR5SWQ7XG4gICAgdmFyIHByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgdmFyIHV1aWQgPSBhcmdzWzJdIHx8ICcnO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICB2YXIgc3ViUHJvY2Vzc0luc3RhbmNlID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgIFxuICAgICAgICB2YXIgaW5kaWNhdG9ySW5zdGFuY2VzID0gc3ViUHJvY2Vzc0luc3RhbmNlLmluZGljYXRvcnM7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbmRpY2F0b3JJbnN0YW5jZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gaW5kaWNhdG9ySW5zdGFuY2VzW2ldLmluc3RhbmNlc1swXS51dWlkO1xuICAgICAgICAgICAgdmFyIGluZGljYXRvckluc3RhbmNlID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgaW5kaWNhdG9ySW5zdGFuY2UuY29udHJvbC5kcmFmdCA9IGZhbHNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJlc29sdmUoXCJTZXQgRHJhZnQgU3VjY2Vzc1wiLCBpbmRpY2F0b3JJbnN0YW5jZXMpO1xuXG4gICAgfSk7XG59O1xuXG5mdW5jdGlvbiBzYXZlKGluZGljYXRvcikge1xuICAgIHZhciBjb21wbGV0ZWQgPSBbXTtcbiAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgICBjb21wbGV0ZTogdHJ1ZSxcbiAgICAgICAgZGF0YTogW11cbiAgICB9O1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gaW5kaWNhdG9yIHNldCBzYXZlZCBzdWNjZXNzZnVsbHkuJywgcmVzdWx0KTtcbiAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIHN1Ym1pdChmb3JtKSB7XG4gICAgdmFyIGNvbXBsZXRlZCA9IFtdO1xuICAgIHZhciByZXN1bHQgPSB7XG4gICAgICAgIGNvbXBsZXRlOiB0cnVlLFxuICAgICAgICBkYXRhOiBbXVxuICAgIH07XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBzdWJtaXR0ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdCk7XG4gICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgfSk7XG59O1xuXG5mdW5jdGlvbiBhdXRob3Jpc2UoZm9ybSkge1xuICAgIHZhciBjb21wbGV0ZWQgPSBbXTtcbiAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgICBjb21wbGV0ZTogdHJ1ZSxcbiAgICAgICAgZGF0YTogW11cbiAgICB9O1xuXG4gICAgdmFyIHByb2Nlc3NJZCA9IGZvcm1bMF0gfHwgJyc7XG5cbiAgICB2YXIgc3ViUHJvY2VzcyA9IGZvcm1bMV0gfHwge307XG5cbiAgICB2YXIgc3ViUHJvY2Vzc0lkID0gc3ViUHJvY2Vzcy5faWQ7XG5cbiAgICB2YXIgcHJvY2Vzc1NlcSA9IGZvcm1bMl0gfHwgJyc7XG5cbiAgICB2YXIgc3ViUHJvY2Vzc1NlcSA9IGZvcm1bM10gfHwgJyc7XG5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBmb3JtWzRdIHx8IHt9O1xuXG4gICAgdmFyIHN1YlByb2Nlc3NVVUlEID0gZm9ybVs2XSB8fCAnJztcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgdmFyIHNwbyA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzVVVJRCArIFwiJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG5cbiAgICAgICAgLy92YXIgc3ViUHJvY2Vzc1VVSUQgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tpZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIicgYW5kIHNlcSBlcSAnXCIgKyBwcm9jZXNzU2VxICsgXCInXS9zdWJQcm9jZXNzZXNbaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInIGFuZCBzZXEgZXEgJ1wiICsgc3ViUHJvY2Vzc1NlcSArIFwiJ10vdXVpZFwiLCBfV0ZJbnN0YW5jZS5pbnN0YW5jZSwge30pWzBdO1xuICAgICAgICB2YXIgc3BJbmRpY2F0b3JzID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NVVUlEICsgXCInXS9pbmRpY2F0b3JzL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSk7XG4gICAgICAgIHZhciBpdGVtc1RvUHJvY2VzcyA9IHNwSW5kaWNhdG9ycy5sZW5ndGg7XG4gICAgICAgIHZhciB1cGRhdGVkT2JqZWN0c0FycmF5ID0gW107XG4gICAgICAgIHZhciB0ZW1wQXJyYXkgPSBbXTtcblxuICAgICAgICAvL3N0YXJ0IHR4biBvbiBpbmR1dWlkICsgOmFwcHJvdmVkIHRoZW4gY29tbWl0XG5cbiAgICAgICAgdmFyIHByb2Nlc3NTRE8gPSBmdW5jdGlvbihpKXtcblxuICAgICAgICAgICAgZ2F0ZWtlZXBlci5hdXRob3Jpc2Uoc3BJbmRpY2F0b3JzW2ldKS50aGVuKGZ1bmN0aW9uIChhdXRob3Jpc2VkUmV0dXJuKSB7XG5cbiAgICAgICAgICAgICAgICBnYXRla2VlcGVyLnBlcnNpc3QoYXV0aG9yaXNlZFJldHVybikudGhlbihmdW5jdGlvbiAoc2F2ZWRBcnJheSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB1dWlkU2F2ZWRJbmRpY2F0b3IgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYyA9IDA7IGMgPCBzYXZlZEFycmF5Lmxlbmd0aDsgYysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNhdmVkQXJyYXlbY10uaWQuZW5kc1dpdGgoJzphcHByb3ZlZCcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXVpZFNhdmVkSW5kaWNhdG9yID0gc2F2ZWRBcnJheVtjXS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgZGFvLmdldCh1dWlkU2F2ZWRJbmRpY2F0b3IpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9XRkluc3RhbmNlLmluZGljYXRvcnMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNUb1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbXNUb1Byb2Nlc3MgPT0gMCkge1xuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0RGF0YSgnaW5kaWNhdG9ycycsIF9XRkluc3RhbmNlLCBzdWJQcm9jZXNzVVVJRCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBhdXRob3Jpc2VkIHN1Y2Nlc3NmdWxseS4nLCB1cGRhdGVkT2JqZWN0c0FycmF5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gYXV0aG9yaXNlZCBwZXJzaXN0IGZhaWxlZC4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZmFpbHVyZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKGl0ZW1zVG9Qcm9jZXNzID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NTRE8oaSArIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yID0gX1dGSW5zdGFuY2UuaW5kaWNhdG9yc1tpbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRpY2F0b3IuX2lkID09IGRhdGEuX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGN1cnJlbnQgaXRlbSBmcm9tIHRoZSBhcnJheSBhbmQgYWRkIHRoZSB1cGRhdGVkIHByb2Nlc3NNb2RlbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcEFycmF5LnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL19XRkluc3RhbmNlLmluZGljYXRvcnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNUb1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtc1RvUHJvY2VzcyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZExlbmd0aCA9IF9XRkluc3RhbmNlLmluZGljYXRvcnMubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wTGVuZ3RoID0gdGVtcEFycmF5Lmxlbmd0aDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHAgPSAwOyBwIDwgaW5kTGVuZ3RoOyBwKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBPYmogPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgcSA9IDA7IHEgPCB0ZW1wTGVuZ3RoOyBxKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzW3BdLl9pZCA9PSB0ZW1wQXJyYXlbcV0uX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcE9iaiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0ZW1wT2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wQXJyYXkucHVzaChfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzW3BdKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycyA9IHRlbXBBcnJheTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3VuZCA9PSB0cnVlICYmIGl0ZW1zVG9Qcm9jZXNzID09IDApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0RGF0YSgnaW5kaWNhdG9ycycsIF9XRkluc3RhbmNlLCBzdWJQcm9jZXNzVVVJRCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBhdXRob3Jpc2VkIHN1Y2Nlc3NmdWxseS4nLCB1cGRhdGVkT2JqZWN0c0FycmF5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnRm9ybSBhdXRob3Jpc2VkIHBlcnNpc3QgZmFpbGVkLicsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChmYWlsdXJlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYoaXRlbXNUb1Byb2Nlc3MgPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc1NETyhpICsgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gYXV0aG9yaXNlZCBwZXJzaXN0IGZhaWxlZCAyLicsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChmYWlsdXJlKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCdGb3JtIGF1dGhvcmlzZWQgcGVyc2lzdCBmYWlsZWQgMy4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChmYWlsdXJlKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gYXV0aG9yaXNlZCBwZXJzaXN0IGZhaWxlZCA0LicsIHt9KTtcbiAgICAgICAgICAgICAgICByZWplY3QoZmFpbHVyZSk7XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgICAgICBwcm9jZXNzU0RPKDApO1xuXG5cblxuXG4gICAgfSk7XG59O1xuXG5mdW5jdGlvbiBjbG9zZShmb3JtKSB7XG4gICAgdmFyIGNvbXBsZXRlZCA9IFtdO1xuICAgIHZhciByZXN1bHQgPSB7XG4gICAgICAgIGNvbXBsZXRlOiB0cnVlLFxuICAgICAgICBkYXRhOiBbXVxuICAgIH07XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBjbG9zZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdCk7XG4gICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgfSk7XG59O1xuXG5cblxuZnVuY3Rpb24gdXBkYXRlSW5kaWNhdG9yKGFyZ3MpIHtcblxuICAgIHZhciBfV0ZJbnN0YW5jZSA9IGFyZ3NbMF0gfHwge307XG5cbiAgICB2YXIgdXVpZCA9IGFyZ3NbMV0gfHwgJyc7XG4gICAgdmFyIHBhdGggPSBhcmdzWzJdIHx8ICcnO1xuICAgIHZhciBkYXRhVmFsdWUgPSBhcmdzWzNdIHx8ICcnO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICB2YXIgc2V0SWQgPSBwYXRoLnNwbGl0KFwiLlwiLCAxKVswXTtcbiAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1t3b3JrZmxvd3MvcHJvY2Vzc2VzL3N1YlByb2Nlc3NVVUlEID0gJ1wiICsgdXVpZCArIFwiJyBhbmQgY2F0ZWdvcnkvdGVybSA9ICdcIiArIHNldElkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICBpZihpbmRPYmplY3QgPT0gdW5kZWZpbmVkICYmIHNldElkID09IFwiYXBwUHJvZmlsZVwiKXtcbiAgICAgICAgICAgIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1ttb2RlbC9wZW5kaW5nL3N0YXR1cyA9ICdBdXRob3Jpc2VkJyBhbmQgY2F0ZWdvcnkvdGVybSA9ICdcIiArIHNldElkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgaWYoaW5kT2JqZWN0ID09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgdmFyIHN0dWZmID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IHt9O1xuXG4gICAgICAgICAgICAgICAgb2JqLm1vZGVsID0ge307XG4gICAgICAgICAgICAgICAgc3R1ZmYucHVzaChvYmopO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0luZGljYXRvciB1cGRhdGVkIHNraXBwZWQuJywgc3R1ZmYpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHNxdW90ZSA9IChkYXRhVmFsdWUgKyBcIlwiKS5yZXBsYWNlKC8nL2csIFwiXFxcXCdcIik7XG4gICAgICAgIHZhciBzcXVvdGUgPSBzcXVvdGUuc3BsaXQoJ1xcbicpLmpvaW4oJyAnKTtcbiAgICAgICAgdmFyIGZpbmFsVmFsdWUgPSBpbmRPYmplY3QubW9kZWwucGVuZGluZy5kYXRhO1xuICAgICAgICB2YXIgcGF0aFRvRWxlbWVudCA9IHBhdGggPT0gXCJcIiA/IFtdIDogcGF0aC5zcGxpdCgvWydcIlxcW1xcXS5dKy8pO1xuICAgICAgICB2YXIgayA9IDA7XG4gICAgICAgIGZvciAoayA9IDA7IGsgPCBwYXRoVG9FbGVtZW50Lmxlbmd0aCAtIDE7IGsrKykge1xuICAgICAgICAgICAgaWYocGF0aFRvRWxlbWVudFtrXSA9PSBcIlwiKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsVmFsdWVbcGF0aFRvRWxlbWVudFtrXV0gPSBzcXVvdGU7XG4gICAgICAgIHZhciBpdGVtc1RvUHJvY2VzcyA9IDE7XG4gICAgICAgIHZhciBzdHVmZiA9IFtdO1xuICAgICAgICB2YXIgb2JqID0ge307XG5cbiAgICAgICAgb2JqLm1vZGVsID0gaW5kT2JqZWN0O1xuICAgICAgICBzdHVmZi5wdXNoKG9iaik7XG5cbiAgICAgICAgdmFyIHR4blBhY2tldCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXBwLlNDT1BFLnR4bikpO1xuICAgICAgICB0eG5QYWNrZXQuZG9jdW1lbnRzID0gW107XG4gICAgICAgIHZhciByZWZQYWNrID0geyBcImRvY3VtZW50XCI6IGluZE9iamVjdC5faWQsIFwicmV2XCI6IGluZE9iamVjdC5fcmV2IH07XG4gICAgICAgIHR4blBhY2tldC5kb2N1bWVudHMucHVzaChyZWZQYWNrKTtcbiAgICAgICAgYXBwLlNDT1BFLnR4bi5kb2N1bWVudHMucHVzaChyZWZQYWNrKTtcblxuICAgICAgICBkYW8udXBkYXRlVHJhbnNhY3Rpb24odHhuUGFja2V0KS50aGVuKGZ1bmN0aW9uKHN1Y2MpIHtcblxuICAgICAgICAgICAgZGFvLnNhdmUoaW5kT2JqZWN0KS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZWZQYWNrLnJldiA9IGRhdGEucmV2O1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZC4nLCBzdHVmZik7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZC4nLCBzdHVmZik7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZC4nLCBzdHVmZik7XG4gICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICB9KTtcblxuXG4gICAgfSk7XG59O1xuXG5cbmZ1bmN0aW9uIHVwZGF0ZUluZGljYXRvcldyYXBwZXIoYXJncykge1xuXG4gICAgdmFyIF9XRkluc3RhbmNlID0gYXJnc1swXSB8fCB7fTtcblxuICAgIHZhciB1dWlkID0gYXJnc1sxXSB8fCAnJztcbiAgICB2YXIgcGF0aCA9IGFyZ3NbMl0gfHwgJyc7XG4gICAgdmFyIGRhdGFWYWx1ZSA9IGFyZ3NbM10gfHwgJyc7XG4gICAgdmFyIGluZGljYXRvclNldElkID0gYXJnc1s0XSB8fCAnJztcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblxuICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW3dvcmtmbG93cy9wcm9jZXNzZXMvc3ViUHJvY2Vzc1VVSUQgPSAnXCIgKyB1dWlkICsgXCInIGFuZCBjYXRlZ29yeS90ZXJtID0gJ1wiICsgaW5kaWNhdG9yU2V0SWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgaWYoaW5kT2JqZWN0ID09IHVuZGVmaW5lZCAmJiBpbmRpY2F0b3JTZXRJZCA9PSBcImFwcFByb2ZpbGVcIil7XG4gICAgICAgICAgICBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbbW9kZWwvcGVuZGluZy9zdGF0dXMgPSAnQXV0aG9yaXNlZCcgYW5kIGNhdGVnb3J5L3Rlcm0gPSAnXCIgKyBpbmRpY2F0b3JTZXRJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIGlmKGluZE9iamVjdCA9PSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgIHZhciBzdHVmZiA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBvYmogPSB7fTtcblxuICAgICAgICAgICAgICAgIG9iai5tb2RlbCA9IHt9O1xuICAgICAgICAgICAgICAgIHN0dWZmLnB1c2gob2JqKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZCBza2lwcGVkLicsIHN0dWZmKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzcXVvdGUgPSBkYXRhVmFsdWUucmVwbGFjZSgvJy9nLCBcIlxcXFwnXCIpO1xuICAgICAgICB2YXIgc3F1b3RlID0gc3F1b3RlLnNwbGl0KCdcXG4nKS5qb2luKCcgJyk7XG4gICAgICAgIHZhciBmaW5hbFZhbHVlID0gaW5kT2JqZWN0O1xuICAgICAgICB2YXIgcGF0aFRvRWxlbWVudCA9IHBhdGggPT0gXCJcIiA/IFtdIDogcGF0aC5zcGxpdCgvWydcIlxcW1xcXS5dKy8pO1xuICAgICAgICB2YXIgayA9IDA7XG4gICAgICAgIGZvciAoayA9IDA7IGsgPCBwYXRoVG9FbGVtZW50Lmxlbmd0aCAtIDE7IGsrKykge1xuICAgICAgICAgICAgaWYocGF0aFRvRWxlbWVudFtrXSA9PSBcIlwiKSBjb250aW51ZTtcbiAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBmaW5hbFZhbHVlW3BhdGhUb0VsZW1lbnRba11dO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsVmFsdWVbcGF0aFRvRWxlbWVudFtrXV0gPSBzcXVvdGU7XG4gICAgICAgIHZhciBpdGVtc1RvUHJvY2VzcyA9IDE7XG4gICAgICAgIHZhciBzdHVmZiA9IFtdO1xuICAgICAgICB2YXIgb2JqID0ge307XG5cbiAgICAgICAgb2JqLm1vZGVsID0gaW5kT2JqZWN0O1xuICAgICAgICBzdHVmZi5wdXNoKG9iaik7XG5cbiAgICAgICAgdmFyIHR4blBhY2tldCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXBwLlNDT1BFLnR4bikpO1xuICAgICAgICB0eG5QYWNrZXQuZG9jdW1lbnRzID0gW107XG4gICAgICAgIHZhciByZWZQYWNrID0geyBcImRvY3VtZW50XCI6IGluZE9iamVjdC5faWQsIFwicmV2XCI6IGluZE9iamVjdC5fcmV2IH07XG4gICAgICAgIHR4blBhY2tldC5kb2N1bWVudHMucHVzaChyZWZQYWNrKTtcbiAgICAgICAgYXBwLlNDT1BFLnR4bi5kb2N1bWVudHMucHVzaChyZWZQYWNrKTtcblxuICAgICAgICBkYW8udXBkYXRlVHJhbnNhY3Rpb24odHhuUGFja2V0KS50aGVuKGZ1bmN0aW9uKHN1Y2MpIHtcblxuICAgICAgICAgICAgZGFvLnNhdmUoaW5kT2JqZWN0KS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICByZWZQYWNrLnJldiA9IGRhdGEucmV2O1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZC4nLCBzdHVmZik7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZC4nLCBzdHVmZik7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZC4nLCBzdHVmZik7XG4gICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICB9KTtcblxuICAgIH0pO1xufTtcblxuZnVuY3Rpb24gbWFya1VwZGF0ZUluZGljYXRvcihhcmdzKSB7XG5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBhcmdzWzBdIHx8IHt9O1xuXG4gICAgdmFyIHV1aWQgPSBhcmdzWzFdIHx8ICcnO1xuICAgIHZhciBzdGF0dXMgPSBhcmdzWzJdIHx8ICcnO1xuICAgIHZhciBpbmRpY2F0b3JTZXRJZCA9IGFyZ3NbM10gfHwgJyc7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbd29ya2Zsb3dzL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzVVVJRCA9ICdcIiArIHV1aWQgKyBcIicgYW5kIGNhdGVnb3J5L3Rlcm0gPSAnXCIgKyBpbmRpY2F0b3JTZXRJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuc3RhdHVzID0gc3RhdHVzO1xuICAgICAgICB2YXIgaXRlbXNUb1Byb2Nlc3MgPSAxO1xuICAgICAgICB2YXIgc3R1ZmYgPSBbXTtcbiAgICAgICAgdmFyIG9iaiA9IHt9O1xuICAgICAgICBvYmoubW9kZWwgPSBpbmRPYmplY3Q7XG4gICAgICAgIHN0dWZmLnB1c2gob2JqKTtcblxuICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnSW5kaWNhdG9yIHVwZGF0ZWQuJywgc3R1ZmYpO1xuICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgfSk7XG59O1xuXG5cbmZ1bmN0aW9uIHNldFN0YXR1cyhhcmdzKSB7XG5cblxuICAgIC8vIEN1cnJlbnRseSBzZXR0aW5nIHN0YXR1cyB0byBzdWJwcm9jZXNzIGluc3RhbmNlLiBpdCBzaG91bGQgdXBkYXRlIHNvbWUgZmllbGQgaW4gYXBwUHJvZmlsZSBvciB3aGF0ZXZlciBpbmRpY2F0b3IgdGhlIHByb2ZpbGUgaGFzLlxuICAgIHZhciBfV0ZJbnN0YW5jZSA9IGFyZ3NbMF0gfHwge307XG4gICAgdmFyIHV1aWQgPSBhcmdzWzFdIHx8ICcnO1xuICAgIHZhciBzdGF0dXMgPSBhcmdzWzJdIHx8ICcnO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICB2YXIgc3ViUHJvY2Vzc0luc3RhbmNlID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgXG4gICAgICAgIHN1YlByb2Nlc3NJbnN0YW5jZS5zdGVwLm1lc3NhZ2UgPSBzdGF0dXM7XG5cbiAgICAgICAgcmVzb2x2ZShcIlNldCBwcm9maWxlIHN0YXR1cyBTdWNjZXNzXCIsIHN1YlByb2Nlc3NJbnN0YW5jZSk7XG5cbiAgICB9KTtcblxufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG5cbiAgICBjcmVhdGU6IGNyZWF0ZSxcbiAgICBzYXZlOiBzYXZlLFxuICAgIHN1Ym1pdDogc3VibWl0LFxuICAgIGF1dGhvcmlzZTogYXV0aG9yaXNlLFxuICAgIGNsb3NlOiBjbG9zZSxcbiAgICBzZXREcmFmdDogc2V0RHJhZnQsXG4gICAgc2V0VW5EcmFmdDogc2V0VW5EcmFmdCxcbiAgICBjcmVhdGVQcm9maWxlOiBjcmVhdGVQcm9maWxlLFxuICAgIHNldEluc3RhbmNlVGl0bGU6IHNldEluc3RhbmNlVGl0bGUsXG4gICAgZGVsZXRlUHJvZmlsZTogZGVsZXRlUHJvZmlsZSxcbiAgICB1cGRhdGVJbmRpY2F0b3I6IHVwZGF0ZUluZGljYXRvcixcbiAgICBtYXJrVXBkYXRlSW5kaWNhdG9yOiBtYXJrVXBkYXRlSW5kaWNhdG9yLFxuICAgIHVwZGF0ZUluZGljYXRvcldyYXBwZXI6IHVwZGF0ZUluZGljYXRvcldyYXBwZXJcblxufSIsIid1c2Ugc3RyaWN0JztcblxuXG5mdW5jdGlvbiBnZXRMYW5ndWFnZU1lc3NhZ2UobWVzc2FnZSkge1xuXG4gICAgdmFyIGxhbmd1YWdlID0gc2VydmljZS5nZXRMYW5ndWFnZSgpO1xuICAgIHZhciByZXMgPSBtZXNzYWdlLmkxOG5bbGFuZ3VhZ2VdO1xuICAgIGlmKHJlcyA9PSB1bmRlZmluZWQpe1xuICAgICAgICByZXMgPSBtZXNzYWdlLmkxOG5bXCJlblwiXTtcbiAgICB9XG4gICAgcmV0dXJuIHJlcztcblxufTtcblxuZnVuY3Rpb24gbnVtYmVyV2l0aENvbW1hcyh4KSB7XG4gICAgaWYoeC50b1N0cmluZygpLnN0YXJ0c1dpdGgoXCI8XCIpKXtcbiAgICAgICAgcmV0dXJuIHgudG9TdHJpbmcoKTtcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgICAgcmV0dXJuIHgudG9TdHJpbmcoKS5yZXBsYWNlKC9cXEIoPz0oXFxkezN9KSsoPyFcXGQpKS9nLCBcIixcIik7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBnZXROb2RlVmFsdWUoZGF0YSwgX1dGSW5zdGFuY2UsIHV1aWQpIHtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgXG4gICAgICAgIGlmKHR5cGVvZiBkYXRhID09ICdzdHJpbmcnKXtcbiAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGF0YS52YWx1ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgdmFyIGlucHV0RGF0YVR5cGUgPSAnc3RyaW5nJztcblxuICAgICAgICAgICAgaWYgKGRhdGEudmFsdWUuZGF0YXR5cGUuZGF0YVR5cGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaW5wdXREYXRhVHlwZSA9IGRhdGEudmFsdWUuZGF0YXR5cGUuZGF0YVR5cGU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlucHV0RGF0YVR5cGUgPSBkYXRhLnZhbHVlLmRhdGF0eXBlO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIHZhciBpbnB1dFZhbHVlID0gZGF0YS52YWx1ZS5kYXRhO1xuXG4gICAgICAgICAgICBpZiAoaW5wdXREYXRhVHlwZSA9PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoTnVtYmVyKGlucHV0VmFsdWUpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhVHlwZSA9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoaW5wdXRWYWx1ZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YVR5cGUgPT0gJ2ludGVnZXInKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShwYXJzZUludChpbnB1dFZhbHVlKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YVR5cGUgPT0gJ2RlY2ltYWwnKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShwYXJzZUZsb2F0KGlucHV0VmFsdWUpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhVHlwZSA9PSAnZGF0ZScgfHwgaW5wdXREYXRhVHlwZSA9PSAnZGF0ZVRpbWUnKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShpbnB1dFZhbHVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gSW4gY2FzZSBkYXRhIHR5cGUgbm90IG1hdGNoZWRcbiAgICAgICAgICAgICAgICByZXNvbHZlKGlucHV0VmFsdWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YS5pbmRpY2F0b3JVVUlEICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAvLyBBIGNoYW5nZSBpcyByZXF1aXJlZCB0byBtYWtlIHN1cmUgcHJvcGVyIHNjb3BlIGlzIGlkZW50aWZpZWQuXG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IG51bGw7XG5cbiAgICAgICAgICAgIHZhciBzdWJwcm9jZXNzID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChzdWJwcm9jZXNzLmluZGljYXRvcnMubGVuZ3RoID09IDApIHtcblxuICAgICAgICAgICAgICAgIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyBkYXRhLmluZGljYXRvclVVSUQuaW5kaWNhdG9yU2V0SWQgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBkYXRhLmluZGljYXRvclVVSUQuaW5kaWNhdG9yU2V0SWQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIHN1YnByb2Nlc3MsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBpZiAoaW5kaWNhdG9yVVVJRCA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIGRhdGEuaW5kaWNhdG9yVVVJRC5pbmRpY2F0b3JTZXRJZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICAgICAgcmVzb2x2ZShpbmRpY2F0b3JVVUlEKTtcblxuICAgICAgICB9IGVsc2UgaWYgKGRhdGEuaW5kaWNhdG9yICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIGRhdGEuaW5kaWNhdG9yLmluZGljYXRvclNldElkICsgXCInXS9pbnN0YW5jZXMvdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIGJhc2VwYXRoID0gXCJcIjtcbiAgICAgICAgICAgIGlmKGRhdGEuaW5kaWNhdG9yLmJhc2VwYXRoICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgYmFzZXBhdGggPSBkYXRhLmluZGljYXRvci5iYXNlcGF0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvbW9kZWwvcGVuZGluZy9kYXRhLycgKyBkYXRhLmluZGljYXRvci5pbmRpY2F0b3JTZXRJZCArIGJhc2VwYXRoICsgJy8nICsgZGF0YS5pbmRpY2F0b3IuZWxlbWVudElkO1xuXG4gICAgICAgICAgICAvL3ZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICB2YXIgc3VicHJvY2Vzc1R5cGUgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0vdHlwZVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgLy92YXIgcGFydCA9IGxpYnJhcnkuZ2V0U3VicHJvZmlsZVN1YnByb2Nlc3NJZHMoKTtcblxuICAgICAgICAgICAgLy8gaWYgKHN1YnByb2Nlc3NUeXBlID09IFBST0NFU1NfVFlQRV9TVUJQUk9GSUxFKSB7XG4gICAgICAgICAgICAvLyAgICAgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZCBhbmQgX2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgPSBcIiArIHBhcnQgKyBcIl0vX2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgIHZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgaWYgKHN1YnByb2Nlc3NUeXBlID09IFBST0NFU1NfVFlQRV9TVUJQUk9GSUxFKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG4gICAgICAgICAgICAgICAgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWQgYW5kIHV1aWQgPSBcIisgcGFydCArXCJdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHJlcGxhY2VkUGF0aCA9IHJlcGxhY2VBbGwoeHBhdGgsICcjU0VRVUVOQ0UjJywgc2VxKTtcblxuICAgICAgICAgICAgdmFyIHZhbGlkRGF0ZSA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9kYXRlcy92YWxpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIGNvbmNhdFZhbGlkRGF0ZSA9IFwiJ1wiICsgdmFsaWREYXRlICsgXCInXCI7XG4gICAgICAgICAgICB2YXIgbmV3UGF0aCA9IHJlcGxhY2VBbGwocmVwbGFjZWRQYXRoLCAnI0VORF9EQVRFIycsIGNvbmNhdFZhbGlkRGF0ZSk7XG4gICAgICAgICAgICB2YXIgZG90UmVwbGFjZWQgPSByZXBsYWNlQWxsKG5ld1BhdGgsICdbLl0nLCAnLycpO1xuICAgICAgICAgICAgaWYoYmFzZXBhdGgubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgdmFyIHJldFZhbHVlID0gSlNPTi54cGF0aChkb3RSZXBsYWNlZCwgaW5kT2JqZWN0LCB7fSk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXRWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIHZhciByZXRWYWx1ZSA9IEpTT04ueHBhdGgoZG90UmVwbGFjZWQsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgIGlmKGRhdGEuaW5kaWNhdG9yLmFkZFN0cmluZyAhPSB1bmRlZmluZWQgJiYgZGF0YS5pbmRpY2F0b3IuYWRkU3RyaW5nICE9IFwiXCIpe1xuICAgICAgICAgICAgICAgICAgICByZXRWYWx1ZSA9IHJldFZhbHVlICsgZGF0YS5pbmRpY2F0b3IuYWRkU3RyaW5nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlc29sdmUocmV0VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YS5zeXN0ZW0gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgIHJlc29sdmUoXCJFUlJPUjogVW5pbXBsZW1lbnRlZCBzeXN0ZW0gdHlwZSBmb3VuZC5cIik7XG5cbiAgICAgICAgfSBlbHNlIGlmIChkYXRhLnZhcmlhYmxlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogVGFrZW4gb3V0IG9mIHNjaGVtYVxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NJbnN0YW5jZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkZXNjcmlwdGlvblwiOiBcInZhbHVlIG9mIHRoZSB2YXJpYWJsZSBzdWJQcm9jZXNzSW5zdGFuY2UgdmFyaWFibGUgY3VycmVudCBzdWJwcm9jZXNzSW5zdGFuY2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkZXNjcmlwdGlvblwiOiBcInZhbHVlIG9mIHRoZSB2YXJpYWJsZSBpbiB0aGUgY3VycmVudCBzdGVwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NJZFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkZXNjcmlwdGlvblwiOiBcInZhbHVlIG9mIHRoZSBjdXJyZW50IGFwcGxpY2FpdG9uIElEXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKGRhdGEudmFyaWFibGUucHJvZmlsZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgIHZhciB2YXJpYWJsZU5hbWUgPSBkYXRhLnZhcmlhYmxlLnByb2ZpbGU7XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUgPSBwcm9maWxlSWQgKyAnOnZhcmlhYmxlcyc7XG5cbiAgICAgICAgICAgICAgICBkYW8uZ2V0KHByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lKS50aGVuKGZ1bmN0aW9uKGZpbGUpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZihkYXRhLnZhcmlhYmxlLnR5cGUgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRhdGEudmFyaWFibGUudHlwZSA9PSBcImNvdW50XCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZmlsZVtkYXRhLnZhcmlhYmxlLm5hbWVdLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkVSUk9SOiBQcm9maWxlIHZhcmlhYmxlcyB0eXBlIGltcGxlbWVudGF0aW9uIC0gQ2FzZSBub3QgZm91bmRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbmFsVmFsdWUgPSBmaWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGhUb0VsZW1lbnQgPSB2YXJpYWJsZU5hbWUgPT0gXCJcIiA/IFtdIDogdmFyaWFibGVOYW1lLnNwbGl0KC9bJ1wiXFxbXFxdLl0rLyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcGF0aFRvRWxlbWVudC5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBhdGhUb0VsZW1lbnRba10gPT0gXCJcIikgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IGZpbmFsVmFsdWVbcGF0aFRvRWxlbWVudFtrXV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gZmluYWxWYWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYob2JqID09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiVmFyaWFibGUgbm90IGZvdW5kXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIG9iaiA9PSAnb2JqZWN0Jykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdldFNlcSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXMsIHJlail7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihkYXRhLnZhcmlhYmxlLnBlcmlvZGljID09IHVuZGVmaW5lZCB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnZhcmlhYmxlLnBlcmlvZGljLnNlcSA9PSB1bmRlZmluZWQpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFyIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VicHJvY2Vzc1R5cGUgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0vdHlwZVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgKHN1YnByb2Nlc3NUeXBlID09IFBST0NFU1NfVFlQRV9TVUJQUk9GSUxFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCBfaWQgPSAvc3VicHJvY2Vzc2VzW19pZCA9IFwiICsgcGFydCArIFwiXS9faWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJwcm9jZXNzVHlwZSA9PSBQUk9DRVNTX1RZUEVfU1VCUFJPRklMRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZCBhbmQgdXVpZCA9IFwiKyBwYXJ0ICtcIl0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzKHNlcSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Tm9kZVZhbHVlKGRhdGEudmFyaWFibGUucGVyaW9kaWMuc2VxLCBfV0ZJbnN0YW5jZSwgdXVpZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihzZXFWYXIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMoc2VxVmFyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0VmFsID0gZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzLHJlail7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2UGFyYW0gPSBcInZhbHVlXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRhdGEudmFyaWFibGUucGVyaW9kaWMgIT0gdW5kZWZpbmVkICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEudmFyaWFibGUucGVyaW9kaWMudmFsdWUgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Tm9kZVZhbHVlKGRhdGEudmFyaWFibGUucGVyaW9kaWMudmFsdWUsIF9XRkluc3RhbmNlLCB1dWlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbih2UGFyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyh2UGFyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyh2UGFyYW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRTZXEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHNlcSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldFZhbCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHZQYXJhbSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVQYXRoID0gXCIvXCIgKyB2YXJpYWJsZU5hbWUgKyBcIltcIiArIHNlcSArIFwiXS9cIiArIHZQYXJhbTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXRWYWx1ZSA9IEpTT04ueHBhdGgodmFsdWVQYXRoLCBmaWxlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJldFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgXG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgXG4gICAgXG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvYmogPT0gJ3N0cmluZycpIHtcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG9iaik7XG4gICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcblxuICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJFUlJPUjogUHJvZmlsZSB2YXJpYWJsZXMgbm90IGZvdW5kXCIpO1xuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZihkYXRhLnZhcmlhYmxlLnN1YlByb2ZpbGUgIT0gdW5kZWZpbmVkKXtcblxuICAgICAgICAgICAgICAgIHZhciB2YXJpYWJsZU5hbWUgPSBkYXRhLnZhcmlhYmxlLnN1YlByb2ZpbGU7XG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZFxuICAgICAgICAgICAgICAgIGlmKGRhdGEudmFyaWFibGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCAmJiBkYXRhLnZhcmlhYmxlLnN1YnByb2ZpbGVJZCAhPSBcIlwiKXtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gZGF0YS52YXJpYWJsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgLy8gdmFyIHByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgdmFyIHByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lID0gIHN1YnByb2ZpbGVJZCArICc6dmFyaWFibGVzJztcblxuICAgICAgICAgICAgICAgIGRhby5nZXQocHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUpLnRoZW4oZnVuY3Rpb24oZmlsZSkge1xuXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbmFsVmFsdWUgPSBmaWxlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aFRvRWxlbWVudCA9IHZhcmlhYmxlTmFtZSA9PSBcIlwiID8gW10gOiB2YXJpYWJsZU5hbWUuc3BsaXQoL1snXCJcXFtcXF0uXSsvKTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHBhdGhUb0VsZW1lbnQubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBhdGhUb0VsZW1lbnRba10gPT0gXCJcIikgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlID0gZmluYWxWYWx1ZVtwYXRoVG9FbGVtZW50W2tdXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gZmluYWxWYWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICBpZihvYmogPT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIlZhcmlhYmxlIG5vdCBmb3VuZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2Ygb2JqID09ICdvYmplY3QnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihkYXRhLnZhcmlhYmxlLnBlcmlvZGljID09IHVuZGVmaW5lZCB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnZhcmlhYmxlLnBlcmlvZGljLnNlcSA9PSB1bmRlZmluZWQpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy92YXIgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3NUeXBlID0gSlNPTi54cGF0aChcIi9jb25maWcvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tfaWQgZXEgL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWRdL3R5cGVcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgKHN1YnByb2Nlc3NUeXBlID09IFBST0NFU1NfVFlQRV9TVUJQUk9GSUxFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWQgYW5kIF9pZCA9IC9zdWJwcm9jZXNzZXNbX2lkID0gXCIgKyBwYXJ0ICsgXCJdL19pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnByb2Nlc3NUeXBlID09IFBST0NFU1NfVFlQRV9TVUJQUk9GSUxFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZCBhbmQgdXVpZCA9IFwiKyBwYXJ0ICtcIl0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VxID0gZ2V0Tm9kZVZhbHVlKGRhdGEudmFyaWFibGUucGVyaW9kaWMuc2VxLCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZQYXJhbSA9IFwidmFsdWVcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRhdGEudmFyaWFibGUucGVyaW9kaWMgIT0gdW5kZWZpbmVkICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEudmFyaWFibGUucGVyaW9kaWMudmFsdWUgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdlBhcmFtID0gZ2V0Tm9kZVZhbHVlKGRhdGEudmFyaWFibGUucGVyaW9kaWMudmFsdWUsIF9XRkluc3RhbmNlLCB1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVQYXRoID0gXCIvXCIgKyB2YXJpYWJsZU5hbWUgKyBcIltcIiArIHNlcSArIFwiXS9cIiArIHZQYXJhbTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXRWYWx1ZSA9IEpTT04ueHBhdGgodmFsdWVQYXRoLCBmaWxlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJldFZhbHVlKTtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygb2JqID09ICdzdHJpbmcnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob2JqKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkVSUk9SOiBzdWIgUHJvZmlsZSB2YXJpYWJsZXMgbm90IGZvdW5kXCIpO1xuXG4gICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWplY3QoXCJFUlJPUjogVW5pbXBsZW1lbnRlZCBwcm9maWxlIHR5cGUgZm91bmQuXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YS5pbmRpY2F0b3JXcmFwcGVyICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZGF0YS5pbmRpY2F0b3JXcmFwcGVyLmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBpbmRpY2F0b3JTZXQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIHZhciBlbGVtZW50cGF0aCA9IHJlcGxhY2VBbGwoZGF0YS5pbmRpY2F0b3JXcmFwcGVyLnBhdGgsIFwiWy5dXCIsIFwiL1wiKVxuICAgICAgICAgICAgdmFyIHhwYXRoID0gJy8nICsgZWxlbWVudHBhdGhcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG5cbiAgICAgICAgfSBlbHNlIGlmIChkYXRhLmNhbGN1bGF0ZWQgIT0gdW5kZWZpbmVkKSB7XG5cblxuICAgICAgICAgICAgdmFyIHZhbHVlID0gJyc7XG4gICAgICAgICAgICB2YXIgc2VwYXJhdG9yID0gZGF0YS5jYWxjdWxhdGVkLnNlcGFyYXRvcjtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmNhbGN1bGF0ZWQuZWxlbWVudHMubGVuZ3RoIC0gMTsgaSsrKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHMgPSBkYXRhLmNhbGN1bGF0ZWQuZWxlbWVudHM7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdmFyIHBvc3NpYmxlSXRlbXMgPSBbXCJmcm9tUmVwZWF0XCIsIFwiZWxlbWVudFByb3BlcnR5XCIsIFwiY29uc3RhbnRWYWx1ZVwiLCBcImVsZW1lbnRXcmFwcGVyXCIsIFwiY3VycmVudERhdGVcIiwgXCJyYW5kb21EaWdpdHNcIiwgXCJwcm9maWxlT2JqZWN0RWxlbWVudFwiLCBcInByb2ZpbGVPYmplY3RXcmFwcGVyXCIsIFwiY3VycmVudEZpbmFuY2lhbFllYXJcIiwgXCJzY29wZVZhcmlhYmxlXCIsIFwieHBhdGhcIl07XG4gICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhlbGVtZW50c1tpXSwgcG9zc2libGVJdGVtcykpIHtcblxuICAgICAgICAgICAgICAgICAgICBjYXNlICdlbGVtZW50UHJvcGVydHknOlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldCA9IGVsZW1lbnRzW2ldLmVsZW1lbnRQcm9wZXJ0eS5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgaW5kaWNhdG9yU2V0ICsgXCInXS9pbnN0YW5jZXMvdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLmVsZW1lbnRQcm9wZXJ0eS5lbGVtZW50SWQsIFwiWy5dXCIsIFwiL1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy9tb2RlbC9wZW5kaW5nL2RhdGEvJyArIGluZGljYXRvclNldCArICcvJyArIGVsZW1lbnRwYXRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY29uc3RhbnRWYWx1ZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtVmFsdWUgPSBlbGVtZW50c1tpXS5jb25zdGFudFZhbHVlLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Njb3BlVmFyaWFibGUnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFyTmFtZSA9IGVsZW1lbnRzW2ldLnNjb3BlVmFyaWFibGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHZhck5hbWUgPT0gXCIjVVNFUl9JRFwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtVmFsdWUgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodmFyTmFtZSA9PSBcIiNVU0VSTkFNRVwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtVmFsdWUgPSBfbGNseC5TRVNTSU9OLnVzZXJuYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih2YXJOYW1lID09IFwiI0ZJUlNUTkFNRVwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtVmFsdWUgPSBfbGNseC5TRVNTSU9OLmZpcnN0TmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodmFyTmFtZSA9PSBcIiNMQVNUTkFNRVwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtVmFsdWUgPSBfbGNseC5TRVNTSU9OLmxhc3ROYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoaXRlbVZhbHVlLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWUgKyBzZXBhcmF0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2VsZW1lbnRXcmFwcGVyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXQgPSBlbGVtZW50c1tpXS5lbGVtZW50V3JhcHBlci5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgaW5kaWNhdG9yU2V0ICsgXCInXS9pbnN0YW5jZXMvdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cGF0aCA9IHJlcGxhY2VBbGwoZWxlbWVudHNbaV0uZWxlbWVudFdyYXBwZXIuZWxlbWVudElkLCBcIlsuXVwiLCBcIi9cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvJyArIGVsZW1lbnRwYXRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY3VycmVudERhdGUnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgZm9ybWF0RGF0ZShuZXcgRGF0ZSgpKSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JhbmRvbURpZ2l0cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGlnaXRzID0gZWxlbWVudHNbaV0ucmFuZG9tRGlnaXRzLmRpZ2l0cztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByYW5kb20gPSBNYXRoLnJhbmRvbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4cCA9IE1hdGgucG93KDEwLCBkaWdpdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGludFBhcnQgPSAocmFuZG9tICogZXhwKSBeIDBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpbnRQYXJ0ICsgc2VwYXJhdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAncHJvZmlsZU9iamVjdEVsZW1lbnQnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZWxlbWVudHNbaV0ucHJvZmlsZU9iamVjdEVsZW1lbnQuaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ2FwcFByb2ZpbGUnXVwiLCBhcHAuU0NPUEUud29ya2Zsb3csIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cGF0aCA9IHJlcGxhY2VBbGwoZWxlbWVudHNbaV0ucHJvZmlsZU9iamVjdEVsZW1lbnQuZWxlbWVudElkLCBcIlsuXVwiLCBcIi9cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvbW9kZWwvcGVuZGluZy9kYXRhLycgKyBpbmRpY2F0b3JTZXQgKyAnLycgKyBlbGVtZW50cGF0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpdGVtVmFsdWUgPSBKU09OLnhwYXRoKHhwYXRoLCBpbmRPYmplY3QsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWUgKyBzZXBhcmF0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBjYXNlICdwcm9maWxlT2JqZWN0V3JhcHBlcic6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXQgPSBlbGVtZW50c1tpXS5wcm9maWxlT2JqZWN0V3JhcHBlci5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnYXBwUHJvZmlsZSddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRwYXRoID0gcmVwbGFjZUFsbChlbGVtZW50c1tpXS5wcm9maWxlT2JqZWN0V3JhcHBlci53cmFwcGVyRWxlbWVudElkLCBcIlsuXVwiLCBcIi9cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvJyArIGVsZW1lbnRwYXRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdjdXJyZW50RmluYW5jaWFsWWVhcic6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGFydERhdGUgPSBlbGVtZW50c1tpXS5jdXJyZW50RmluYW5jaWFsWWVhci5zdGFydERhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnRNb250aCA9IGVsZW1lbnRzW2ldLmN1cnJlbnRGaW5hbmNpYWxZZWFyLnN0YXJ0TW9udGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmluYW5jaWFsWWVhciA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKSArIFwiLVwiICsgc3RhcnRNb250aCArIFwiLVwiICsgc3RhcnREYXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGZpbmFuY2lhbFllYXIgKyBzZXBhcmF0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZnJvbVJlcGVhdCc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXQgPSBlbGVtZW50c1tpXS5mcm9tUmVwZWF0LmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBpbmRpY2F0b3JTZXQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLmZyb21SZXBlYXQucGF0aCwgXCJbLl1cIiwgXCIvXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy9tb2RlbC9wZW5kaW5nL2RhdGEvJyArIGluZGljYXRvclNldCArICcvJyArIGVsZW1lbnRwYXRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbHRlciA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGVsZW1lbnRzW2ldLmZyb21SZXBlYXQuZmlsdGVyID09ICd2YWxpZERhdGUnKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3AgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmQgPSBzcC5kYXRlcy52YWxpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXIgPSBcIltlbmRkYXRlIGVxICdcIisgdmQgK1wiJ10vXCJcbiAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB4cGF0aCA9IHhwYXRoICsgZmlsdGVyICsgcmVwbGFjZUFsbChlbGVtZW50c1tpXS5mcm9tUmVwZWF0LmVsZW1lbnQsIFwiWy5dXCIsIFwiL1wiKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAneHBhdGgnOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoZWxlbWVudHNbaV0ueHBhdGguaW5kaWNhdG9yU2V0SWQgIT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgZWxlbWVudHNbaV0ueHBhdGguaW5kaWNhdG9yU2V0SWQubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldCA9IGVsZW1lbnRzW2ldLnhwYXRoLmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgaW5kaWNhdG9yU2V0ICsgXCInXS9pbnN0YW5jZXMvdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoZWxlbWVudHNbaV0ueHBhdGguZXhwciwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoZWxlbWVudHNbaV0ueHBhdGguZXhwciwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlICsgc2VwYXJhdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGkgPSBkYXRhLmNhbGN1bGF0ZWQuZWxlbWVudHMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIHZhciBlbGVtZW50cyA9IGRhdGEuY2FsY3VsYXRlZC5lbGVtZW50cztcblxuICAgICAgICAgICAgdmFyIHBvc3NpYmxlSXRlbXMgPSBbXCJmcm9tUmVwZWF0XCIsXCJlbGVtZW50UHJvcGVydHlcIiwgXCJjb25zdGFudFZhbHVlXCIsIFwiZWxlbWVudFdyYXBwZXJcIiwgXCJjdXJyZW50RGF0ZVwiLCBcInJhbmRvbURpZ2l0c1wiLCBcInByb2ZpbGVPYmplY3RFbGVtZW50XCIsIFwicHJvZmlsZU9iamVjdFdyYXBwZXJcIiwgXCJjdXJyZW50RmluYW5jaWFsWWVhclwiLCBcInNjb3BlVmFyaWFibGVcIiwgXCJ4cGF0aFwiXTtcbiAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoZWxlbWVudHNbaV0sIHBvc3NpYmxlSXRlbXMpKSB7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdlbGVtZW50UHJvcGVydHknOlxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZWxlbWVudHNbaV0uZWxlbWVudFByb3BlcnR5LmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIGluZGljYXRvclNldCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cGF0aCA9IHJlcGxhY2VBbGwoZWxlbWVudHNbaV0uZWxlbWVudFByb3BlcnR5LmVsZW1lbnRJZCwgXCJbLl1cIiwgXCIvXCIpXG4gICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvbW9kZWwvcGVuZGluZy9kYXRhLycgKyBpbmRpY2F0b3JTZXQgKyAnLycgKyBlbGVtZW50cGF0aDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuXG4gICAgICAgICAgICAgICAgY2FzZSAnY29uc3RhbnRWYWx1ZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IGVsZW1lbnRzW2ldLmNvbnN0YW50VmFsdWUudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3Njb3BlVmFyaWFibGUnOlxuXG4gICAgICAgICAgICAgICAgICAgIHZhciB2YXJOYW1lID0gZWxlbWVudHNbaV0uc2NvcGVWYXJpYWJsZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmKHZhck5hbWUgPT0gXCIjVVNFUl9JRFwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1WYWx1ZSA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodmFyTmFtZSA9PSBcIiNVU0VSTkFNRVwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1WYWx1ZSA9IF9sY2x4LlNFU1NJT04udXNlcm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZih2YXJOYW1lID09IFwiI0ZJUlNUTkFNRVwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1WYWx1ZSA9IF9sY2x4LlNFU1NJT04uZmlyc3ROYW1lO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYodmFyTmFtZSA9PSBcIiNMQVNUTkFNRVwiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1WYWx1ZSA9IF9sY2x4LlNFU1NJT04ubGFzdE5hbWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYoaXRlbVZhbHVlLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdlbGVtZW50V3JhcHBlcic6XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXQgPSBlbGVtZW50c1tpXS5lbGVtZW50V3JhcHBlci5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBpbmRpY2F0b3JTZXQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLmVsZW1lbnRXcmFwcGVyLmVsZW1lbnRJZCwgXCJbLl1cIiwgXCIvXCIpXG4gICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvJyArIGVsZW1lbnRwYXRoO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cbiAgICAgICAgICAgICAgICBjYXNlICdjdXJyZW50RGF0ZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGZvcm1hdERhdGUobmV3IERhdGUoKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAncmFuZG9tRGlnaXRzJzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRpZ2l0cyA9IGVsZW1lbnRzW2ldLnJhbmRvbURpZ2l0cy5kaWdpdHM7XG4gICAgICAgICAgICAgICAgICAgIHZhciByYW5kb20gPSBNYXRoLnJhbmRvbSgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXhwID0gTWF0aC5wb3coMTAsIGRpZ2l0cyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbnRQYXJ0ID0gKHJhbmRvbSAqIGV4cCkgXiAwXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpbnRQYXJ0O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3Byb2ZpbGVPYmplY3RFbGVtZW50JzpcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZWxlbWVudHNbaV0ucHJvZmlsZU9iamVjdEVsZW1lbnQuaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnYXBwUHJvZmlsZSddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLnByb2ZpbGVPYmplY3RFbGVtZW50LmVsZW1lbnRJZCwgXCJbLl1cIiwgXCIvXCIpXG4gICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvbW9kZWwvcGVuZGluZy9kYXRhLycgKyBpbmRpY2F0b3JTZXQgKyAnLycgKyBlbGVtZW50cGF0aDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3Byb2ZpbGVPYmplY3RXcmFwcGVyJzpcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZWxlbWVudHNbaV0ucHJvZmlsZU9iamVjdFdyYXBwZXIuaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnYXBwUHJvZmlsZSddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLnByb2ZpbGVPYmplY3RXcmFwcGVyLndyYXBwZXJFbGVtZW50SWQsIFwiWy5dXCIsIFwiL1wiKVxuICAgICAgICAgICAgICAgICAgICB2YXIgeHBhdGggPSAnLycgKyBlbGVtZW50cGF0aDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2N1cnJlbnRGaW5hbmNpYWxZZWFyJzpcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnREYXRlID0gZWxlbWVudHNbaV0uY3VycmVudEZpbmFuY2lhbFllYXIuc3RhcnREYXRlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnRNb250aCA9IGVsZW1lbnRzW2ldLmN1cnJlbnRGaW5hbmNpYWxZZWFyLnN0YXJ0TW9udGg7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmaW5hbmNpYWxZZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpICsgXCItXCIgKyBzdGFydE1vbnRoICsgXCItXCIgKyBzdGFydERhdGU7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBmaW5hbmNpYWxZZWFyO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjYXNlICdmcm9tUmVwZWF0JzpcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZWxlbWVudHNbaV0uZnJvbVJlcGVhdC5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBpbmRpY2F0b3JTZXQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLmZyb21SZXBlYXQucGF0aCwgXCJbLl1cIiwgXCIvXCIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgeHBhdGggPSAnL21vZGVsL3BlbmRpbmcvZGF0YS8nICsgaW5kaWNhdG9yU2V0ICsgJy8nICsgZWxlbWVudHBhdGg7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmaWx0ZXIgPSAnJztcbiAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYoZWxlbWVudHNbaV0uZnJvbVJlcGVhdC5maWx0ZXIgPT0gJ3ZhbGlkRGF0ZScpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNwID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmQgPSBzcC5kYXRlcy52YWxpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlciA9IFwiW2VuZGRhdGUgZXEgJ1wiKyB2ZCArXCInXS9cIlxuICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHhwYXRoID0geHBhdGggKyBmaWx0ZXIgKyByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLmZyb21SZXBlYXQuZWxlbWVudCwgXCJbLl1cIiwgXCIvXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBpdGVtVmFsdWUgPSBKU09OLnhwYXRoKHhwYXRoLCBpbmRPYmplY3QsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICd4cGF0aCc6XG4gICAgICAgICAgICAgICAgICAgIGlmKGVsZW1lbnRzW2ldLnhwYXRoLmluZGljYXRvclNldElkICE9IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgZWxlbWVudHNbaV0ueHBhdGguaW5kaWNhdG9yU2V0SWQubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZWxlbWVudHNbaV0ueHBhdGguaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIGluZGljYXRvclNldCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gSlNPTi54cGF0aChlbGVtZW50c1tpXS54cGF0aC5leHByLCBpbmRPYmplY3QsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWUgKyBzZXBhcmF0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoZWxlbWVudHNbaV0ueHBhdGguZXhwciwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWUgKyBzZXBhcmF0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuXG5cblxuICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG5cbiAgICAgICAgfSBlbHNlIGlmIChkYXRhLnN1YlByb2Nlc3MgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgIGlmIChkYXRhLnN1YlByb2Nlc3MucGF0aCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgIHZhciBwYXRoID0gZGF0YS5zdWJQcm9jZXNzLnBhdGg7XG4gICAgICAgICAgICAgICAgdmFyIGFyciA9IHBhdGguc3BsaXQoXCIuXCIpO1xuICAgICAgICAgICAgICAgIHZhciBwYXRoSXRlbXMgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhdGhJdGVtcyA9IHBhdGhJdGVtcyArIFwiWydcIiArIGFycltpXSArIFwiJ11cIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3MgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgZmluYWxWYWx1ZSA9IHN1YnByb2Nlc3M7XG4gICAgICAgICAgICAgICAgdmFyIHBhdGhUb0VsZW1lbnQgPSBwYXRoSXRlbXMgPT0gXCJcIiA/IFtdIDogcGF0aEl0ZW1zLnNwbGl0KC9bJ1wiXFxbXFxdLl0rLyk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHBhdGhUb0VsZW1lbnQubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYocGF0aFRvRWxlbWVudFtrXSA9PSBcIlwiKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IGZpbmFsVmFsdWVbcGF0aFRvRWxlbWVudFtrXV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGZpbmFsVmFsdWU7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSlcblxuICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLnN1YlByb2Nlc3Muc3RlcFVzZXIgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgfVxuXG4gICAgfSk7XG5cblxuXG59O1xuXG5cbmZ1bmN0aW9uIHJlcGxhY2VBbGwodHh0LCByZXBsYWNlLCB3aXRoX3RoaXMpIHtcbiAgICBpZiAodHlwZW9mIHR4dC5yZXBsYWNlICE9ICdmdW5jdGlvbicpIHtcbiAgICAgICAgY29uc29sZS5sb2cocmVwbGFjZSArICcgJyArIHdpdGhfdGhpcyk7XG4gICAgICAgIGNvbnNvbGUubG9nKHR4dCk7XG4gICAgfVxuICAgIHJldHVybiB0eHQucmVwbGFjZShuZXcgUmVnRXhwKHJlcGxhY2UsICdnJyksIHdpdGhfdGhpcyk7XG59XG5cbmZ1bmN0aW9uIGZvcm1hdERhdGUoZGF0ZSkge1xuXG4gICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF0ZSgpO1xuICAgIHZhciBtb250aEluZGV4ID0gZGF0ZS5nZXRNb250aCgpKzE7XG4gICAgdmFyIHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XG5cbiAgICByZXR1cm4gZGF5ICsgJy0nICsgbW9udGhJbmRleCArICctJyArIHllYXI7XG59XG5cblxuZnVuY3Rpb24gY29tcGFyZShzdWJqZWN0LCBvcGVyYXRvciwgdmFsdWUpIHtcbiAgICBzd2l0Y2ggKG9wZXJhdG9yKSB7XG4gICAgICAgIGNhc2UgJz4nOlxuICAgICAgICAgICAgcmV0dXJuIHN1YmplY3QgPiB2YWx1ZTtcbiAgICAgICAgY2FzZSAnPCc6XG4gICAgICAgICAgICByZXR1cm4gc3ViamVjdCA8IHZhbHVlO1xuICAgICAgICBjYXNlICc+PSc6XG4gICAgICAgICAgICByZXR1cm4gc3ViamVjdCA+PSB2YWx1ZTtcbiAgICAgICAgY2FzZSAnPD0nOlxuICAgICAgICAgICAgcmV0dXJuIHN1YmplY3QgPD0gdmFsdWU7XG4gICAgICAgIGNhc2UgJz09JzpcbiAgICAgICAgICAgIGlmKHN1YmplY3QgPT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICBzdWJqZWN0ID0gXCJcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzdWJqZWN0ID09PSB2YWx1ZTtcbiAgICAgICAgY2FzZSAnIT0nOlxuICAgICAgICAgICAgcmV0dXJuIHN1YmplY3QgIT09IHZhbHVlO1xuICAgIH1cbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSB7XG5cbiAgICBnZXRMYW5ndWFnZU1lc3NhZ2U6IGdldExhbmd1YWdlTWVzc2FnZSxcbiAgICBnZXROb2RlVmFsdWU6IGdldE5vZGVWYWx1ZSxcbiAgICBjb21wYXJlOiBjb21wYXJlXG5cbn0iLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlsID0gcmVxdWlyZSgndXRpbGl0eScpO1xuXG4vKipcbiAqIFVzZXIgSW50ZXJmYWNlIE1vZHVsZVxuICpcbiAqIEBtb2R1bGUgbGliL3VpXG4gKiBAYXV0aG9yIEJyZW50IEdvcmRvblxuICogQHZlcnNpb24gMC4xLjBcbiAqIEBkZXNjcmlwdGlvbiB0ZXN0IGRlc2NyaXB0aW9uXG4gKlxuICovXG5cbiAvKipcbiAgKiBHZXQgYWxsIHByb2Nlc3Mgc3ViLXByb2Nlc3NlcyB1c2VyIGludGVyZmFjZSBkYXRhXG4gICpcbiAgKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gcHJvY2VzcyBpZFxuICAqIEBwYXJhbSB7c3RyaW5nfSBsYW5nIC0gdGhlIHVzZXIgcHJlZmZlcmVkIGxhbmdhdWdlXG4gICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAgKlxuICAqIEBleGFtcGxlICcnXG4gICpcbiAgKiBAcmV0dXJuICcnXG4gICpcbiAgKi9cbiBmdW5jdGlvbiBnZXRQcm9jZXNzKHByb2Nlc3NJZCwgbGFuZywgX1dGSW5zdGFuY2Upe1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhciBwcm9jZXNzTW9kZWwgPSBbXTtcbiAgICAgIHZhciBwcm9jZXNzSW5zdGFuY2UgPSBbXTtcbiAgICBcdF9XRkluc3RhbmNlLmluc3RhbmNlLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ocHJvY2Vzc0l0ZW0pe1xuICAgIFx0XHRpZiAocHJvY2Vzc0l0ZW0uaWQgPT0gcHJvY2Vzc0lkKSB7XG4gICAgXHRcdFx0cHJvY2Vzc0luc3RhbmNlID0gcHJvY2Vzc0l0ZW07XG4gICAgXHRcdH1cbiAgICBcdH0pXG4gICAgICAvLyBjb25zb2xlLmxvZyhwcm9jZXNzSW5zdGFuY2Uuc3ViUHJvY2Vzc2VzLmxlbmd0aCk7XG4gICAgICB1dGlsLnN5bmNMb29wKHByb2Nlc3NJbnN0YW5jZS5zdWJQcm9jZXNzZXMubGVuZ3RoLCBmdW5jdGlvbihsb29wKXtcbiAgXHRcdFx0dmFyIGNvdW50ZXIgPSBsb29wLml0ZXJhdGlvbigpO1xuICAgICAgICB2YXIgcHJvY2Vzc1NlcSA9IHByb2Nlc3NJbnN0YW5jZS5zZXE7XG4gICAgICAgIHZhciBzdWJQcm9jZXNzSWQgPSBwcm9jZXNzSW5zdGFuY2Uuc3ViUHJvY2Vzc2VzW2NvdW50ZXJdLmlkO1xuICAgICAgICB2YXIgc3ViUHJvY2Vzc1NlcSA9IHByb2Nlc3NJbnN0YW5jZS5zdWJQcm9jZXNzZXNbY291bnRlcl0uc2VxO1xuICAgICAgICBnZXRTdWJQcm9jZXNzKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBsYW5nLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihtb2RlbCl7XG4gICAgICAgICAgLy8gY29uc29sZS5sb2cobW9kZWwpO1xuICAgICAgICAgIHByb2Nlc3NNb2RlbC5wdXNoKG1vZGVsKTtcbiAgICAgICAgICBsb29wLm5leHQoKTtcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhwcm9jZXNzTW9kZWwpO1xuICBcdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2Nlc3NNb2RlbCk7XG4gIFx0XHRcdFx0bG9vcC5icmVhaygpO1xuICBcdFx0XHRcdHJlamVjdChlcnIpO1xuICBcdFx0XHR9KTtcbiAgXHRcdH0sIGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2Nlc3NNb2RlbCk7XG4gIFx0XHRcdHJlc29sdmUocHJvY2Vzc01vZGVsKTtcbiAgXHRcdH0pO1xuICAgIH0gY2F0Y2goZXJyKXtcbiAgICAgIHJlamVjdChlcnIpO1xuICAgIH1cbiAgfSlcbn07XG5cbiAvKipcbiAgKiBHZXQgU3ViUHJvY2VzcyB1c2VyIGludGVyZmFjZSBkYXRhXG4gICpcbiAgKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gcHJvY2VzcyBpZFxuICAqIEBwYXJhbSB7bnVtYmVyfSBwcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgc2VxXG4gICogQHBhcmFtIHtzdHJpbmd9IHN1YlByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN1Yi1wcm9jZXNzIGlkXG4gICogQHBhcmFtIHtudW1iZXJ9IHN1YlByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2Ugc3ViLXByb2Nlc3Mgc2VxXG4gICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAgKlxuICAqIEBleGFtcGxlICcnXG4gICpcbiAgKiBAcmV0dXJuICcnXG4gICpcbiAgKi9cbmZ1bmN0aW9uIGdldFN1YlByb2Nlc3MocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIGxhbmcsIF9XRkluc3RhbmNlKXtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHRyeSB7XG4gICAgICB2YXIgbW9kZWwgPSB7XG4gICAgICAgIGlkOiAnJyxcbiAgICAgICAgc2VxOiAnJyxcbiAgICAgICAgbmFtZTogJycsXG4gICAgICAgIGhlbHA6ICcnLFxuICAgICAgICBkYXRlczogJycsXG4gICAgICAgIHN0ZXA6ICcnXG4gICAgICB9O1xuICAgICAgdmFyIHN1YlByb2Nlc3MgPSBbXTtcbiAgICBcdHZhciBzdWJQcm9jZXNzQ29uZiA9IFtdO1xuICAgIFx0X1dGSW5zdGFuY2UuaW5zdGFuY2UucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihwcm9jZXNzSXRlbSl7XG4gICAgXHRcdGlmIChwcm9jZXNzSXRlbS5pZCA9PSBwcm9jZXNzSWQgJiYgcHJvY2Vzc0l0ZW0uc2VxID09IHByb2Nlc3NTZXEpIHtcbiAgICBcdFx0XHR2YXIgc3BMZW5ndGggPSBwcm9jZXNzSXRlbS5zdWJQcm9jZXNzZXMubGVuZ3RoO1xuICAgIFx0XHRcdHByb2Nlc3NJdGVtLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzc0l0ZW0pe1xuICAgIFx0XHRcdFx0aWYgKHN1YlByb2Nlc3NJdGVtLmlkID09IHN1YlByb2Nlc3NJZCAmJiBzdWJQcm9jZXNzSXRlbS5zZXEgPT0gc3ViUHJvY2Vzc1NlcSAmJiBzdWJQcm9jZXNzSXRlbS5jb21wbGV0ZSA9PSBmYWxzZSkge1xuICAgIFx0XHRcdFx0XHRzdWJQcm9jZXNzID0gc3ViUHJvY2Vzc0l0ZW07XG4gICAgXHRcdFx0XHR9XG4gICAgXHRcdFx0fSlcbiAgICBcdFx0fVxuICAgIFx0fSlcbiAgICBcdC8vIEdldCB0aGUgY3VycmVudCBzdWJQcm9jZXNzIGNvbmZpZ3VyYXRpb25cbiAgICBcdF9XRkluc3RhbmNlLmNvbmZpZy5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHByb2Nlc3NDb25maWcpe1xuICAgIFx0XHRpZiAocHJvY2Vzc0NvbmZpZy5faWQgPT0gcHJvY2Vzc0lkKSB7XG4gICAgXHRcdFx0cHJvY2Vzc0NvbmZpZy5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NDb25maWcpe1xuICAgIFx0XHRcdFx0aWYgKHN1YlByb2Nlc3NDb25maWcuX2lkID09IHN1YlByb2Nlc3NJZCkge1xuICAgIFx0XHRcdFx0XHRzdWJQcm9jZXNzQ29uZiA9IHN1YlByb2Nlc3NDb25maWc7XG4gICAgXHRcdFx0XHR9XG4gICAgXHRcdFx0fSlcbiAgICBcdFx0fVxuICAgIFx0fSlcbiAgICAgIC8vIFVwZGF0ZSB0aGUgbW9kZWxcbiAgICAgIG1vZGVsLmlkID0gc3ViUHJvY2Vzc0NvbmYuX2lkO1xuICAgICAgbW9kZWwuc2VxID0gc3ViUHJvY2Vzcy5zZXE7XG4gICAgICBtb2RlbC5uYW1lID0gdXRpbC5nZXROYW1lKHN1YlByb2Nlc3NDb25mLm5hbWUsIGxhbmcpO1xuICAgICAgbW9kZWwuaGVscCA9IHV0aWwuZ2V0TmFtZShzdWJQcm9jZXNzQ29uZi5oZWxwLCBsYW5nKTtcbiAgICAgIG1vZGVsLmRhdGVzID0gc3ViUHJvY2Vzcy5kYXRlcztcbiAgICAgIG1vZGVsLnN0ZXAgPSBzdWJQcm9jZXNzLnN0ZXA7XG4gICAgICByZXNvbHZlKG1vZGVsKTtcbiAgICB9IGNhdGNoKGVycikge1xuICAgICAgcmVqZWN0KGVycik7XG4gICAgfVxuICB9KVxufTtcblxuXG5cblxuZnVuY3Rpb24gcHJlcGFyZU5vdGlmaWNhdGlvblNjcmVlbigpe1xuXG4gIFwiXCJcbn07XG5cbiBtb2R1bGUuZXhwb3J0cyA9IHtcblxuICBnZXRQcm9jZXNzOiBnZXRQcm9jZXNzXG5cbiB9XG4iLCIndXNlIHN0cmljdCc7XG5cblxuZnVuY3Rpb24gZ2V0KCkge1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgfSk7XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuXG4gICAgZ2V0OiBnZXRcblxufSIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWwgPSByZXF1aXJlKCd1dGlsaXR5Jyk7XG52YXIgYWN0aW9uc01vZHVsZSA9IHJlcXVpcmUoJy4vYWN0aW9ucycpO1xudmFyIGhlbHBlciA9IHJlcXVpcmUoJy4vaGVscGVyJyk7XG52YXIgZm9ybSA9IHJlcXVpcmUoJy4vZm9ybScpO1xuXG4vKipcbiAqIFByb2Nlc3MgTW9kdWxlXG4gKlxuICogQG1vZHVsZSBsaWIvcHJvY2Vzc1xuICogQGF1dGhvciBIYXNhbiBBYmJhc1xuICogQHZlcnNpb24gMC4yLjFcbiAqIEBkZXNjcmlwdGlvbiBXb3JrZmxvdyBpbXBsZW1lbnRhdGlvbiBjaGFuZ2VkIGFzIHBlciBuZXcgc2NoZW1hIGltcGxlbWVudGF0aW9uXG4gKlxuICovXG5cbi8qKlxuICogQ291bnQgYW4gYXJyYXkgb2YgaXRlbXNcbiAqXG4gKiBAcGFyYW0ge0FycmF5fSBhcnIgLSB0aGUgYXJyYXkgZGF0YVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gY291bnQoYXJyKSB7XG4gICAgaWYgKGFyciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBhcnIubGVuZ3RoO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cblxufTtcblxuLyoqXG4gKiBQcm9jZXNzIHByZS1yZXF1aXNpdGVzXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IHByZXJlcXVpc2l0ZXMgLSB0aGUgcHJlLXJlcXVpc2l0ZXMgY29uZmlnIGRhdGFcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIHByZVJlcXVpc2l0ZXMocHJlcmVxdWlzaXRlcywgX1dGSW5zdGFuY2UsIHNwdXVpZCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgLy8gVW5jb21tZW50IGJlbG93IHNlY3Rpb24gd2hlbiByZWFkeSB0byBpbXBsZW1lbnRcbiAgICAgICAgdmFyIGNvbXBsZXRlZCA9IFtdO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdXRpbC5zeW5jTG9vcChwcmVyZXF1aXNpdGVzLmxlbmd0aCwgZnVuY3Rpb24obG9vcCkge1xuICAgICAgICAgICAgICAgIHZhciBjb3VudGVyID0gbG9vcC5pdGVyYXRpb24oKTtcbiAgICAgICAgICAgICAgICBwcmVSZXF1aXNpdGUocHJlcmVxdWlzaXRlc1tjb3VudGVyXSwgX1dGSW5zdGFuY2UsIHNwdXVpZCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGFsbCBwcmUtcmVxdWlzaXRlcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LlxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWQucHVzaCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgbG9vcC5uZXh0KCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZC5wdXNoKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgbG9vcC5icmVhaygpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChjb21wbGV0ZWQuZXZlcnkoQm9vbGVhbikpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1ByZS1yZXF1aXNpdGVzIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywge30pO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGUHJlUmVxdWlzaXRlRXJyb3InLCAnTm90IGFsbCBwcmUtcmVxdWlzaXRlcyBwYXNzZWQuJyk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgcHJlLXJlcXVpc2l0ZSwgZXhlY3V0ZSB0aGUgcHJlLXJlcXVpc2l0ZSBjb25kaXRpb24uXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IHByZXJlcXVpc2l0ZSAtIHRoZSBwcmUtcmVxdWlzaXRlIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZVxuICogUHJvY2Vzcy5wcmVSZXF1aXNpdGUoY29uZmlnLCBjb3VudGVyLCBpbnN0YW5jZSwgZG9jKTtcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBwcmVSZXF1aXNpdGUocHJlcmVxdWlzaXRlLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG5cblxuICAgICAgICBpZiAocHJlcmVxdWlzaXRlLmNoZWNrLm51bWJlclByb2Nlc3NJbnN0YW5jZXMgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgIHZhciBudW1iZXJQcm9jZXNzSW5zdGFuY2VzID0gcHJlcmVxdWlzaXRlLmNoZWNrLm51bWJlclByb2Nlc3NJbnN0YW5jZXM7XG4gICAgICAgICAgICB2YXIgX2ZpbHRlck9wZXJhdG9yID0gbnVtYmVyUHJvY2Vzc0luc3RhbmNlcy5vcGVyYXRvcjtcbiAgICAgICAgICAgIHZhciB4cGF0aE9wZXJhdG9yID0gJyc7XG4gICAgICAgICAgICBzd2l0Y2ggKF9maWx0ZXJPcGVyYXRvcikge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2dyZWF0ZXJUaGFuJzpcbiAgICAgICAgICAgICAgICAgICAgeHBhdGhPcGVyYXRvciA9ICdndCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2xlc3NUaGFuJzpcbiAgICAgICAgICAgICAgICAgICAgeHBhdGhPcGVyYXRvciA9ICdsdCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2dyZWF0ZXJUaGFuRXF1YWwnOlxuICAgICAgICAgICAgICAgICAgICB4cGF0aE9wZXJhdG9yID0gJ2dlJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbGVzc1RoYW5FcXVhbCc6XG4gICAgICAgICAgICAgICAgICAgIHhwYXRoT3BlcmF0b3IgPSAnbGUnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdlcXVhbFRvJzpcbiAgICAgICAgICAgICAgICAgICAgeHBhdGhPcGVyYXRvciA9ICdlcSc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ25vdEVxdWFsVG8nOlxuICAgICAgICAgICAgICAgICAgICB4cGF0aE9wZXJhdG9yID0gJ25lJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBfc3VicHJvY2Vzc0lkID0gbnVtYmVyUHJvY2Vzc0luc3RhbmNlcy5zdWJQcm9jZXNzSWQ7XG5cbiAgICAgICAgICAgIHZhciBfZmlsdGVyVmFsdWUgPSBudW1iZXJQcm9jZXNzSW5zdGFuY2VzLnR5cGU7XG5cbiAgICAgICAgICAgIHZhciBpbm5lclhwYXRoID0gJydcblxuICAgICAgICAgICAgaWYgKF9maWx0ZXJWYWx1ZSA9PSBcImFsbFwiKSB7XG4gICAgICAgICAgICAgICAgaW5uZXJYcGF0aCA9ICcnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbm5lclhwYXRoID0gXCJbY29tcGxldGUgZXEgJ3RydWUnXVwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgYWRkaXRpb25hbEZpbHRlciA9IFwiXCI7XG5cbiAgICAgICAgICAgIGlmIChudW1iZXJQcm9jZXNzSW5zdGFuY2VzLmZpbHRlciAhPSB1bmRlZmluZWQgJiYgbnVtYmVyUHJvY2Vzc0luc3RhbmNlcy5maWx0ZXIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGFkZGl0aW9uYWxGaWx0ZXIgPSBcIltcIiArIG51bWJlclByb2Nlc3NJbnN0YW5jZXMuZmlsdGVyICsgXCJdXCI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBmdWxsUGF0aCA9IFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgZXEgJ1wiICsgX3N1YnByb2Nlc3NJZCArIFwiJ11cIiArIGlubmVyWHBhdGggKyBhZGRpdGlvbmFsRmlsdGVyICsgXCIpXCI7XG5cbiAgICAgICAgICAgIHZhciBwcmVyZXFQcm9jZXNzVHlwZSA9IEpTT04ueHBhdGgoXCIvY29uZmlnL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIF9zdWJwcm9jZXNzSWQgKyBcIiddL3R5cGVcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuXG4gICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gJycgJiYgcHJlcmVxUHJvY2Vzc1R5cGUgIT0gdW5kZWZpbmVkICYmIHByZXJlcVByb2Nlc3NUeXBlID09IFBST0NFU1NfVFlQRV9TVUJQUk9GSUxFKSB7XG4gICAgICAgICAgICAgICAgZnVsbFBhdGggPSBcImNvdW50KC9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW2lkIGVxICdcIiArIF9zdWJwcm9jZXNzSWQgKyBcIicgYW5kIHV1aWQgPSBcIiArIHBhcnQgKyBcIl1cIiArIGlubmVyWHBhdGggKyBcIilcIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHN1YmplY3RDb3VudCA9IEpTT04ueHBhdGgoZnVsbFBhdGgsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgY291bnRWYWx1ZSA9IHByZXJlcXVpc2l0ZS5jaGVjay5udW1iZXJQcm9jZXNzSW5zdGFuY2VzLmNvdW50O1xuICAgICAgICAgICAgdmFyIGNvbXBhcmUgPSB1dGlsLmNvbXBhcmUoc3ViamVjdENvdW50LCBwcmVyZXF1aXNpdGUuY2hlY2subnVtYmVyUHJvY2Vzc0luc3RhbmNlcy5vcGVyYXRvciwgcGFyc2VJbnQoY291bnRWYWx1ZSkpO1xuXG5cbiAgICAgICAgICAgIGlmIChjb21wYXJlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1ByZS1yZXF1aXNpdGVzIHBhc3NlZC4nLCB7fSk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IGhlbHBlci5nZXRMYW5ndWFnZU1lc3NhZ2UocHJlcmVxdWlzaXRlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGUHJlUmVxdWlzaXRlRXJyb3InLCBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgfSBlbHNlIGlmIChwcmVyZXF1aXNpdGUuY2hlY2sudmFyaWFibGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgIHZhciBzY29wZSA9IHByZXJlcXVpc2l0ZS5jaGVjay52YXJpYWJsZS5zY29wZTtcbiAgICAgICAgICAgIHZhciBmaWxlTmFtZSA9ICcnO1xuXG4gICAgICAgICAgICBpZiAoc2NvcGUgPT0gXCJwcm9maWxlXCIpIHtcblxuICAgICAgICAgICAgICAgIHZhciBwcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIGZpbGVOYW1lID0gcHJvZmlsZUlkICsgJzp2YXJpYWJsZXMnO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNjb3BlID09IFwic3ViUHJvZmlsZVN1YlByb2Nlc3NJbnN0YW5jZVwiKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIGZpbGVOYW1lID0gc3ViUHJvZmlsZUlkICsgJzp2YXJpYWJsZXMnO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlamVjdChcIkVSUk9SOiBTY29wZSAnXCIgKyBzY29wZSArIFwiJyBub3QgaW1wbGVtZW50ZWQgaW4gcHJlLXJlcXVpc2l0ZXNcIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRhby5nZXQoZmlsZU5hbWUpLnRoZW4oZnVuY3Rpb24oZmlsZSkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHZhcmlhYmxlTmFtZSA9IHByZXJlcXVpc2l0ZS5jaGVjay52YXJpYWJsZS5uYW1lO1xuICAgICAgICAgICAgICAgIHZhciB2YXJpYWJsZVR5cGUgPSBwcmVyZXF1aXNpdGUuY2hlY2sudmFyaWFibGUudHlwZTtcbiAgICAgICAgICAgICAgICB2YXIgZmluYWxWYWx1ZSA9IGZpbGU7XG4gICAgICAgICAgICAgICAgdmFyIHBhdGhUb0VsZW1lbnQgPSB2YXJpYWJsZU5hbWUgPT0gXCJcIiA/IFtdIDogdmFyaWFibGVOYW1lLnNwbGl0KC9bJ1wiXFxbXFxdLl0rLyk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHBhdGhUb0VsZW1lbnQubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYocGF0aFRvRWxlbWVudFtrXSA9PSBcIlwiKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IGZpbmFsVmFsdWVbcGF0aFRvRWxlbWVudFtrXV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBvYmogPSBmaW5hbFZhbHVlO1xuICAgICAgICAgICAgICAgIHZhciBzdWJqZWN0VmFsdWVDYWxjdWxhdGVkO1xuXG4gICAgICAgICAgICAgICAgdmFyIGlucHV0VmFsdWUgPSBwcmVyZXF1aXNpdGUuY2hlY2sudmFyaWFibGUudmFsdWUuZGF0YTtcbiAgICAgICAgICAgICAgICB2YXIgaW5wdXREYXRhVHlwZSA9IHByZXJlcXVpc2l0ZS5jaGVjay52YXJpYWJsZS52YWx1ZS5kYXRhVHlwZS5kYXRhVHlwZTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZihvYmogPT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoaW5wdXREYXRhVHlwZSA9PSBcImRhdGVcIil7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmogPSBcIjIwMDAtMDEtMDFcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZVR5cGUgIT0gdW5kZWZpbmVkICYmIHZhcmlhYmxlVHlwZSA9PSBcImFycmF5XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgc3ViamVjdFZhbHVlQ2FsY3VsYXRlZCA9IG9iajtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvYmogPT0gJ29iamVjdCcpIHtcblxuICAgICAgICAgICAgICAgICAgICAvL3ZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3VicHJvY2Vzc1R5cGUgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXS90eXBlXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkIGFuZCBfaWQgPSAvc3VicHJvY2Vzc2VzW19pZCA9IFwiICsgcGFydCArIFwiXS9faWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgLy8gfVxuXG5cblxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWJwcm9jZXNzVHlwZSA9PSBQUk9DRVNTX1RZUEVfU1VCUFJPRklMRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkIGFuZCB1dWlkID0gXCIgKyBwYXJ0ICsgXCJdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG5cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlUGF0aCA9IFwiL1wiICsgdmFyaWFibGVOYW1lICsgXCJbXCIgKyBzZXEgKyBcIl0vdmFsdWVcIjtcbiAgICAgICAgICAgICAgICAgICAgc3ViamVjdFZhbHVlQ2FsY3VsYXRlZCA9IEpTT04ueHBhdGgodmFsdWVQYXRoLCBmaWxlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvYmogPT0gJ3N0cmluZycpIHtcblxuICAgICAgICAgICAgICAgICAgICBzdWJqZWN0VmFsdWVDYWxjdWxhdGVkID0gb2JqO1xuXG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgIGlmKGlucHV0VmFsdWUgPT0gXCIjVkFMSURfREFURVwiKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNwbyA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIGlmKHNwbyAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRWYWx1ZSA9IHNwby5kYXRlcy52YWxpZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpbnB1dFZhbHVlLmluZGV4T2YoXCJ4cGF0aDpcIikgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZnVsbFBhdGggPSBpbnB1dFZhbHVlLnN1YnN0cmluZyg2KTtcbiAgICAgICAgICAgICAgICAgICAgaW5wdXRWYWx1ZSA9IEpTT04ueHBhdGgoZnVsbFBhdGgsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGlucHV0VmFsdWUgPT0gXCIjVkFMSURfREFURVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzcG8gPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3BvICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXRWYWx1ZSA9IHNwby5kYXRlcy52YWxpZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgdmFyIGZpbmFsVmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKGlucHV0RGF0YVR5cGUgPT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IE51bWJlcihpbnB1dFZhbHVlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YVR5cGUgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgZmluYWxWYWx1ZSA9IGlucHV0VmFsdWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGFUeXBlID09ICdpbnRlZ2VyJykge1xuICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlID0gcGFyc2VJbnQoaW5wdXRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZVR5cGUgIT0gdW5kZWZpbmVkICYmIHZhcmlhYmxlVHlwZSA9PSBcImFycmF5XCIpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YmplY3RWYWx1ZUNhbGN1bGF0ZWQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViamVjdFZhbHVlQ2FsY3VsYXRlZCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YmplY3RWYWx1ZUNhbGN1bGF0ZWQgPSBzdWJqZWN0VmFsdWVDYWxjdWxhdGVkLmxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGFUeXBlID09ICdkZWNpbWFsJykge1xuICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlID0gcGFyc2VGbG9hdChpbnB1dFZhbHVlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YVR5cGUgPT0gJ2RhdGUnIHx8IGlucHV0RGF0YVR5cGUgPT0gJ2RhdGVUaW1lJykge1xuICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlID0gaW5wdXRWYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoc3ViamVjdFZhbHVlQ2FsY3VsYXRlZCA9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgICAgICAgICAgICAgKHByZXJlcXVpc2l0ZS5jaGVjay52YXJpYWJsZS5hbGxvd0JsYW5rICE9IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgcHJlcmVxdWlzaXRlLmNoZWNrLnZhcmlhYmxlLmFsbG93QmxhbmsgPT0gdHJ1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1ZhcmlhYmxlIFByZS1yZXF1aXNpdGVzIHBhc3NlZC4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBhcmUgPSB1dGlsLmNvbXBhcmUoc3ViamVjdFZhbHVlQ2FsY3VsYXRlZCwgcHJlcmVxdWlzaXRlLmNoZWNrLnZhcmlhYmxlLm9wZXJhdG9yLCBmaW5hbFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBhcmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdWYXJpYWJsZSBQcmUtcmVxdWlzaXRlcyBwYXNzZWQuJywge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBoZWxwZXIuZ2V0TGFuZ3VhZ2VNZXNzYWdlKHByZXJlcXVpc2l0ZS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlLnJlcGxhY2UoXCIjVkFMSURfREFURVwiLCBzdWJqZWN0VmFsdWVDYWxjdWxhdGVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGUHJlUmVxdWlzaXRlRXJyb3InLCBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAocHJlcmVxdWlzaXRlLmNoZWNrLnZhcmlhYmxlLmFsbG93QmxhbmsgIT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgIHByZXJlcXVpc2l0ZS5jaGVjay52YXJpYWJsZS5hbGxvd0JsYW5rID09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1ZhcmlhYmxlIFByZS1yZXF1aXNpdGVzIHBhc3NlZC4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBoZWxwZXIuZ2V0TGFuZ3VhZ2VNZXNzYWdlKHByZXJlcXVpc2l0ZS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UucmVwbGFjZShcIiNWQUxJRF9EQVRFXCIsIHN1YmplY3RWYWx1ZUNhbGN1bGF0ZWQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywgbWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcblxuICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gaGVscGVyLmdldExhbmd1YWdlTWVzc2FnZShwcmVyZXF1aXNpdGUubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UucmVwbGFjZShcIiNWQUxJRF9EQVRFXCIsIHN1YmplY3RWYWx1ZUNhbGN1bGF0ZWQpO1xuICAgICAgICAgICAgICAgIHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGUHJlUmVxdWlzaXRlRXJyb3I6JywgbWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSBlbHNlIGlmKHByZXJlcXVpc2l0ZS5jaGVjay5pbmRpY2F0b3IgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgIHZhciBvcGVyYXRvciA9IHByZXJlcXVpc2l0ZS5jaGVjay5pbmRpY2F0b3Iub3BlcmF0b3I7XG4gICAgICAgICAgICB2YXIgc2V0SWQgPSBwcmVyZXF1aXNpdGUuY2hlY2suaW5kaWNhdG9yLnNldElkO1xuICAgICAgICAgICAgdmFyIGZpZWxkID0gcHJlcmVxdWlzaXRlLmNoZWNrLmluZGljYXRvci5maWVsZDtcbiAgICAgICAgICAgIHZhciBzY29wZSA9IHByZXJlcXVpc2l0ZS5jaGVjay5pbmRpY2F0b3Iuc2NvcGU7XG5cbiAgICAgICAgICAgIHZhciBpbmRPYmogPSB7fTtcbiAgICAgICAgICAgIGlmIChzY29wZSA9PSBcInByb2ZpbGVcIikge1xuICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLmluZGljYXRvcnMuZm9yRWFjaChmdW5jdGlvbihpbmQpe1xuICAgICAgICAgICAgICAgICAgICBpZihpbmQuY2F0ZWdvcnkudGVybSA9PSBzZXRJZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRPYmogPSBpbmQ7IFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2NvcGUgPT0gXCJzdWJQcm9jZXNzXCIpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3BPYmplY3QgPSB7fTtcbiAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMuZm9yRWFjaChmdW5jdGlvbihzcCl7XG4gICAgICAgICAgICAgICAgICAgIGlmKHNwLl9pZCA9PSBzcHV1aWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3QgPSBzcDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgdmFyIGluZFVVSUQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIHNwT2JqZWN0LmluZGljYXRvcnMuZm9yRWFjaChmdW5jdGlvbihpbmRSZWYpe1xuICAgICAgICAgICAgICAgICAgICBpZihpbmRSZWYuaWQgPT0gc2V0SWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5kVVVJRCA9IGluZFJlZi5pbnN0YW5jZXNbMF0udXVpZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmZvckVhY2goZnVuY3Rpb24oaW5kKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoaW5kLl9pZCA9PSBpbmRVVUlEKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZE9iaiA9IGluZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KFwiRVJST1I6IFNjb3BlICdcIiArIHNjb3BlICsgXCInIG5vdCBpbXBsZW1lbnRlZCBpbiBwcmUtcmVxdWlzaXRlc1wiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHRva2VucyA9IGZpZWxkLnNwbGl0KFwiLlwiKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGdldFZhbHVlID0gZnVuY3Rpb24ob2JqZWN0LCB0b2tlbnMsIGluZGV4KXtcbiAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmKHRva2Vucy5sZW5ndGggPT0gaW5kZXgpe1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gdG9rZW5zW2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldFZhbHVlKG9iamVjdFtrZXldLCB0b2tlbnMsIGluZGV4KzEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgc2RvT2JqZWN0ID0gaW5kT2JqLm1vZGVsLnBlbmRpbmcuZGF0YVtzZXRJZF07XG4gICAgICAgICAgICB2YXIgc3ViamVjdFZhbHVlQ2FsY3VsYXRlZCA9IGdldFZhbHVlKHNkb09iamVjdCwgdG9rZW5zLDAgKVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKHByZXJlcXVpc2l0ZS5jaGVjay5pbmRpY2F0b3IuZGF0YSwgX1dGSW5zdGFuY2UsIHNwdXVpZCkudGhlbihmdW5jdGlvbihkYXRhVmFsdWUpIHtcblxuICAgICAgICAgICAgICAgIHZhciBjb21wYXJlID0gdXRpbC5jb21wYXJlKHN1YmplY3RWYWx1ZUNhbGN1bGF0ZWQsIHByZXJlcXVpc2l0ZS5jaGVjay5pbmRpY2F0b3Iub3BlcmF0b3IsIGRhdGFWYWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKGNvbXBhcmUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1ZhcmlhYmxlIFByZS1yZXF1aXNpdGVzIHBhc3NlZC4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBoZWxwZXIuZ2V0TGFuZ3VhZ2VNZXNzYWdlKHByZXJlcXVpc2l0ZS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UucmVwbGFjZShcIiNWQUxJRF9EQVRFXCIsIHN1YmplY3RWYWx1ZUNhbGN1bGF0ZWQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywgbWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoXCJFUlJPUjogZ2V0Tm9kZVZhbHVlIHJldHVybmVkIGVycm9yXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgIHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGUHJlUmVxdWlzaXRlRXJyb3InLCAnUHJlLXJlcXVpc2l0ZSB0eXBlIG5vdCBkZWZpbmVkLicpO1xuICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcblxuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogUHJvY2VzcyBwcmUtYWN0aW9uc3NcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gcHJlQWN0aW9ucyAtIHRoZSBwcmUtYWN0aW9ucyBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIHByZUFjdGlvbnMocHJlQWN0aW9ucywgX1dGSW5zdGFuY2UsIHNwdXVpZCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdmFyIGNvbXBsZXRlZCA9IFtdO1xuICAgICAgICB0cnkge1xuXG4gICAgICAgICAgICB2YXIgc3BPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIHByb2Nlc3NJRCA9IHNwT2JqZWN0W1wibWV0YS1kYXRhXCJdLnByb2Nlc3NDb25maWdJZDtcbiAgICAgICAgICAgIHZhciBwcm9jZXNzSWQgPSBzcE9iamVjdFtcIm1ldGEtZGF0YVwiXS5zdWJQcm9jZXNzQ29uZmlnSWQ7XG4gICAgICAgICAgICB2YXIgcHJvY2Vzc1NFUSA9IHNwT2JqZWN0W1wibWV0YS1kYXRhXCJdLnN1YlByb2Nlc3NJbnNTZXE7XG4gICAgICAgICAgICB2YXIgcHJvY2Vzc1NlcSA9IHNwT2JqZWN0W1wibWV0YS1kYXRhXCJdLnN1YlByb2Nlc3NJbnNTZXE7XG5cbiAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzQ29uZmlnT2JqZWN0ID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHByb2Nlc3NJRCArIFwiJ10vc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9zdGVwXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgIHV0aWwuc3luY0xvb3AocHJlQWN0aW9ucy5sZW5ndGgsIGZ1bmN0aW9uKGxvb3ApIHtcbiAgICAgICAgICAgICAgICB2YXIgY291bnRlciA9IGxvb3AuaXRlcmF0aW9uKCk7XG4gICAgICAgICAgICAgICAgYWN0aW9uKHByZUFjdGlvbnNbY291bnRlcl0sIHByb2Nlc3NJRCwgcHJvY2Vzc1NFUSwgcHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzQ29uZmlnT2JqZWN0LCBzdGVwT2JqZWN0LCBfV0ZJbnN0YW5jZSwge30sIHNwdXVpZCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGFsbCBwcmUtcmVxdWlzaXRlcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LlxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWQucHVzaCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgbG9vcC5uZXh0KCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZC5wdXNoKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgbG9vcC5icmVhaygpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChjb21wbGV0ZWQuZXZlcnkoQm9vbGVhbikpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1ByZS1hY3Rpb25zIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywge30pO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGUHJlUmVxdWlzaXRlRXJyb3InLCAnTm90IGFsbCBwcmUtYWN0aW9ucyBwYXNzZWQuJyk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IGdldCBzdWItcHJvY2VzcyBkYXRhLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCAtIHRoZSBzdWJQcm9jZXNzIGNvbmZpZyBpZFxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5mdW5jdGlvbiBnZXRTdWJQcm9jZXNzKGlkLCBfV0ZJbnN0YW5jZSkge1xuICAgIGlmIChfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3MpIHtcbiAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzLmlkID09IGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1YlByb2Nlc3M7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG4gICAgfVxuXG59O1xuXG4vKipcbiAqIFByb2Nlc3Mgc3ViLXByb2Nlc3NcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gcHJvY2VzcyAtIHRoZSBjdXJyZW50IHByb2Nlc3MgaWQgYW5kIHNlcVxuICogQHBhcmFtIHtvYmplY3R9IHN1YlByb2Nlc3MgLSB0aGUgc3ViLXByb2Nlc3MgaWQgYW5kIHNlcVxuICogQHBhcmFtIHtvYmplY3R9IGRhdGEgLSB0aGUgdXNlciBpbnB1dCBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgY3VycmVudCB3b3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gc3ViUHJvY2Vzcyh1dWlkLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3VicHJvZmlsZUlkLCBkYXRhLCBfV0ZJbnN0YW5jZSkge1xuICAgIC8vIEdldCB0aGUgY3VycmVudCBwcm9jZXNzIHN1YlByb2Nlc3MgaW5zdGFuY2VcbiAgICAvLyB2YXIgc3ViUHJvY2Vzc1NlcSA9IDE7XG4gICAgdmFyIHN1YlByb2Nlc3MgPSBbXTtcbiAgICB2YXIgcHJvY2Vzc0NvbmYgPSBbXTtcbiAgICB2YXIgc3ViUHJvY2Vzc0NvbmYgPSBbXTtcblxuXG4gICAgLy8gX1dGSW5zdGFuY2UuaW5zdGFuY2UucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpQcm9jZXNzKSB7XG4gICAgLy8gICAgIGlmIChvYmpQcm9jZXNzLmlkID09IHByb2Nlc3NJZCAmJiBvYmpQcm9jZXNzLnNlcSA9PSBwcm9jZXNzU2VxKSB7XG4gICAgLy8gICAgICAgICB2YXIgc3BMZW5ndGggPSBvYmpQcm9jZXNzLnN1YlByb2Nlc3Nlcy5sZW5ndGg7XG4gICAgLy8gICAgICAgICBvYmpQcm9jZXNzLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqU3ViUHJvY2Vzcykge1xuICAgIC8vICAgICAgICAgICAgIGlmIChvYmpTdWJQcm9jZXNzLmlkID09IHN1YlByb2Nlc3NJZCAmJiBvYmpTdWJQcm9jZXNzLnNlcSA9PSBzdWJQcm9jZXNzU2VxKSB7XG4gICAgLy8gICAgICAgICAgICAgICAgIHZhciB1dWlkID0gb2JqU3ViUHJvY2Vzcy51dWlkO1xuICAgIC8vICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NJdGVtKSB7XG4gICAgLy8gICAgICAgICAgICAgICAgICAgICBpZiAoc3ViUHJvY2Vzc0l0ZW0uX2lkID09IHV1aWQpIHtcbiAgICAvLyAgICAgICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzID0gc3ViUHJvY2Vzc0l0ZW07XG4gICAgLy8gICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAvLyAgICAgICAgICAgICAgICAgfSlcbiAgICAvLyAgICAgICAgICAgICB9XG4gICAgLy8gICAgICAgICB9KTtcbiAgICAvLyAgICAgfVxuXG4gICAgLy8gfSk7XG5cbiAgICAvLyBOT1RFOiBpbmNvbWluZyB1dWlkIHdpbGwgYmUgdXNlZCBpbiBjYXNlIG9mIG5ldyBzdWJwcm9jZXNzIGNyZWF0aW9uXG4gICAgX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihzdWJQcm9jZXNzSXRlbSkge1xuICAgICAgICBpZiAoc3ViUHJvY2Vzc0l0ZW0uX2lkID09IHV1aWQpIHtcbiAgICAgICAgICAgIHN1YlByb2Nlc3MgPSBzdWJQcm9jZXNzSXRlbTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG5cblxuXG4gICAgLy8gR2V0IHRoZSBjdXJyZW50IHN1YlByb2Nlc3MgY29uZmlndXJhdGlvblxuICAgIF9XRkluc3RhbmNlLmNvbmZpZy5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHByb2Nlc3NDb25maWcpIHtcbiAgICAgICAgaWYgKHByb2Nlc3NDb25maWcuX2lkID09IHByb2Nlc3NJZCkge1xuICAgICAgICAgICAgcHJvY2Vzc0NvbmYgPSBwcm9jZXNzQ29uZmlnO1xuICAgICAgICAgICAgcHJvY2Vzc0NvbmZpZy5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NDb25maWcpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3ViUHJvY2Vzc0NvbmZpZy5faWQgPT0gc3ViUHJvY2Vzc0lkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NDb25mID0gc3ViUHJvY2Vzc0NvbmZpZztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgIH0pO1xuXG4gICAgLy9UT0RPOiBDaGFuZ2UgcmVxdWlyZWQgdG8gbW92ZSBpc0FjdGl2ZSB0byBzdWJQcm9jZXNzIGZpbGUuSGVyZVxuICAgIHZhciBncm91cEtleSA9ICcnO1xuICAgIHZhciBiYXNlVVVJRCA9IGRhdGEuYmFzZVVVSUQ7XG4gICAgdmFyIGNvdW50U3VicHJvY2Vzc0luQ29udGV4dCA9IDA7XG5cbiAgICBpZiAoYmFzZVVVSUQgIT0gdW5kZWZpbmVkICYmIGJhc2VVVUlEICE9ICcnICYmIGJhc2VVVUlELmxlbmd0aCA+IDApIHtcblxuICAgICAgICB2YXIgcHJldmlvdXNPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgYmFzZVVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgZ3JvdXBLZXkgPSBwcmV2aW91c09iamVjdC5ncm91cEtleTtcbiAgICAgICAgY291bnRTdWJwcm9jZXNzSW5Db250ZXh0ID0gcHJldmlvdXNPYmplY3RbJ21ldGEtZGF0YSddLnN1YlByb2Nlc3NJbnNTZXE7XG5cblxuICAgIH0gZWxzZSB7XG5cbiAgICAgICAgdmFyIGNhcmRJbmRMaXN0ID0gJyc7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3ViUHJvY2Vzc0NvbmYuaW5kaWNhdG9ycy5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgIGNhcmRJbmRMaXN0ID0gY2FyZEluZExpc3QgKyBcIidcIiArIHN1YlByb2Nlc3NDb25mLmluZGljYXRvcnNbaV0uX2lkICsgXCInLFwiO1xuICAgICAgICB9XG4gICAgICAgIGNhcmRJbmRMaXN0ID0gY2FyZEluZExpc3QgKyBcIidcIiArIHN1YlByb2Nlc3NDb25mLmluZGljYXRvcnNbaV0uX2lkICsgXCInXCI7XG4gICAgICAgIHZhciBzaW5nbGVDYXJkID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW3NldElkID0gKFwiICsgY2FyZEluZExpc3QgKyBcIikgYW5kIGNhcmRpbmFsaXR5IGVxICdzaW5nbGUnXVwiLCBhcHAuU0NPUEUuQVBQX0NPTkZJRywge30pLmxlbmd0aDtcblxuICAgICAgICBpZiAoc3ViUHJvY2Vzc0NvbmYuaW5zdGFuY2VUeXBlLm5ld1NlcXVlbmNlICE9IHVuZGVmaW5lZCB8fCBzaW5nbGVDYXJkID4gMCkge1xuICAgICAgICAgICAgdmFyIHByZXZpb3VzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXNbaWQgZXEgJ1wiICsgcHJvY2Vzc0lkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgaWYgKHByZXZpb3VzT2JqZWN0ICE9IHVuZGVmaW5lZCAmJiBwcmV2aW91c09iamVjdC5zdWJQcm9jZXNzZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGdyb3VwS2V5ID0gcHJldmlvdXNPYmplY3Quc3ViUHJvY2Vzc2VzWzBdLmdyb3VwS2V5O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBncm91cEtleSA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ3JvdXBLZXkgPSBnZW5lcmF0ZVVVSUQoKTtcblxuICAgICAgICB9XG5cbiAgICAgICAgY291bnRTdWJwcm9jZXNzSW5Db250ZXh0ID0gSlNPTi54cGF0aChcImNvdW50KC9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW2dyb3VwS2V5IGVxICdcIiArIGdyb3VwS2V5ICsgXCInXSlcIiwgX1dGSW5zdGFuY2UuaW5zdGFuY2UsIHt9KVswXTtcbiAgICB9XG5cbiAgICB2YXIgbGFiZWwgPSBkYXRhLmxhYmVsO1xuICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0SWQgPSB1dWlkO1xuXG5cblxuXG5cblxuICAgIHZhciBtb2RlbCA9IHtcbiAgICAgICAgX2lkOiBzdWJQcm9jZXNzT2JqZWN0SWQsXG4gICAgICAgIGlkOiBzdWJQcm9jZXNzSWQsXG4gICAgICAgIHR5cGU6ICd3b3JrZmxvd0luc3RhbmNlU3ViUHJvY2VzcycsXG4gICAgICAgIGRhdGVUaW1lQ3JlYXRlZDogbW9tZW50KCkuZm9ybWF0KCksXG4gICAgICAgIGR1ZURhdGVUaW1lOiBtb21lbnQoKS5mb3JtYXQoKSxcbiAgICAgICAgc2VxOiBzdWJQcm9jZXNzU2VxLFxuICAgICAgICBpbml0aWF0ZWQ6IGZhbHNlLFxuICAgICAgICBkYXRlczoge1xuICAgICAgICAgICAgY3JlYXRlZDogJycsXG4gICAgICAgICAgICB2YWxpZDogJycsXG4gICAgICAgICAgICBzdGFydDogJycsXG4gICAgICAgICAgICBkdWU6ICcnLFxuICAgICAgICAgICAgY2xvc2VkOiAnJ1xuICAgICAgICB9LFxuICAgICAgICBjb21wbGV0ZTogZmFsc2UsXG4gICAgICAgIGluZGljYXRvcnM6IFtdLFxuICAgICAgICBzdGVwOiB7fSxcbiAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICBncm91cEtleTogZ3JvdXBLZXksXG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgY2hhbm5lbHM6IFtcbiAgICAgICAgICAgIFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCksXG4gICAgICAgICAgICBcInByb2ZpbGVfXCIgKyBhcHAuU0NPUEUucHJvZmlsZUlkLFxuICAgICAgICAgICAgXCJhcHBsaWNhdGlvbl9cIiArIGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkLFxuICAgICAgICAgICAgXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSArIFwiX2FwcGxpY2F0aW9uX1wiICsgYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWRcbiAgICAgICAgXSxcbiAgICAgICAgaGlzdG9yeTogW10sXG4gICAgICAgIC8vbWV0YSBpbmZvcm1hdGlvbiBhZGRlZCBmb3Igc2VydmVyIHNpZGUgY29uZmxpY3QgbWFuYWdlbWVudCBhbmQgbWVyZ2VyXG4gICAgICAgIFwibWV0YS1kYXRhXCI6IHtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uSWQ6IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkLFxuICAgICAgICAgICAgY29tbXVuaXR5SWQ6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgcHJvZmlsZUlkOiBhcHAuU0NPUEUucHJvZmlsZUlkLFxuICAgICAgICAgICAgc3VicHJvZmlsZUlkOiBzdWJwcm9maWxlSWQgPT0gdW5kZWZpbmVkID8gJycgOiBzdWJwcm9maWxlSWQsXG4gICAgICAgICAgICBwcm9jZXNzQ29uZmlnSWQ6IHByb2Nlc3NJZCxcbiAgICAgICAgICAgIHN1YlByb2Nlc3NDb25maWdJZDogc3ViUHJvY2Vzc0lkLFxuICAgICAgICAgICAgc3ViUHJvY2Vzc0luc1NlcTogY291bnRTdWJwcm9jZXNzSW5Db250ZXh0ICsgMVxuICAgICAgICB9LFxuICAgICAgICBtZXNzYWdlczogW10sXG4gICAgICAgIHNwU3RhdHVzOiAnJ1xuICAgIH07XG5cbiAgICBpZiAoZGF0YS52YWxpZERhdGUgIT0gdW5kZWZpbmVkICYmIGRhdGEudmFsaWREYXRlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgaWYoc3ViUHJvY2Vzc0NvbmYucGVyaW9kVHlwZS5wZXJpb2RpYyAhPSB1bmRlZmluZWQpe1xuICAgICAgICAgICAgbW9kZWwuZGF0ZXMudmFsaWQgPSBtb21lbnQoZGF0YS52YWxpZERhdGUpLmVuZE9mKFwibW9udGhcIikuZm9ybWF0KFwiWVlZWS1NTS1ERFwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgICAgbW9kZWwuZGF0ZXMudmFsaWQgPSBkYXRhLnZhbGlkRGF0ZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9XG5cbiAgICBpZiAoYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gXCJcIikge1xuICAgICAgICBtb2RlbC5jaGFubmVscy5wdXNoKFwicHJvZmlsZV9cIiArIGFwcC5TQ09QRS5wcm9maWxlSWQgKyBcIl9zdWJwcm9maWxlX1wiICsgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkKTtcbiAgICAgICAgbW9kZWwuY2hhbm5lbHMucHVzaChcInN1YnByb2ZpbGVfXCIgKyBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIG1vZGVsLmNoYW5uZWxzLnB1c2goXCJwcm9maWxlX1wiICsgYXBwLlNDT1BFLnByb2ZpbGVJZCArIFwiX3N1YnByb2ZpbGVfXCIgKyAwKTtcbiAgICAgICAgbW9kZWwuY2hhbm5lbHMucHVzaChcInN1YnByb2ZpbGVfXCIgKyAwKTtcbiAgICB9XG5cbiAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMucHVzaChtb2RlbCk7XG4gICAgLy8gUmV0dXJuIGEgcHJvbWlzZVxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgLy8gQ2F0Y2ggYWxsIHVuY2F1Z2h0IGVycm9yc1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gMS4gUHJvY2VzcyB0aGUgcHJlLWFjdGlvbnNcbiAgICAgICAgICAgIHZhciBwcmVBY3Rpb25zQ29uZiA9IHByb2Nlc3NDb25mLnByZUFjdGlvbnM7XG4gICAgICAgICAgICAvL2FjdGlvbihhY3Rpb25zW2NvdW50ZXJdLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2Vzcywgc3RlcCwgX1dGSW5zdGFuY2UsIGRhdGEsIHV1aWQpXG4gICAgICAgICAgICBwcmVBY3Rpb25zKHByZUFjdGlvbnNDb25mLCBfV0ZJbnN0YW5jZSwgc3ViUHJvY2Vzc09iamVjdElkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vIDIuIFByb2Nlc3MgdGhlIHByZS1yZXF1aXNpdGVzXG4gICAgICAgICAgICAgICAgdmFyIHByZXJlcXVpc2l0ZUNvbmYgPSBwcm9jZXNzQ29uZi5wcmVyZXF1aXNpdGVzO1xuICAgICAgICAgICAgICAgIHByZVJlcXVpc2l0ZXMocHJlcmVxdWlzaXRlQ29uZiwgX1dGSW5zdGFuY2UsIHN1YlByb2Nlc3NPYmplY3RJZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gMy4gSW5pdGlhdGUgdGhlIHN1YlByb2Nlc3NcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluaXRpYXRlQ29uZiA9IHN1YlByb2Nlc3NDb25mLmluaXRpYXRlO1xuICAgICAgICAgICAgICAgICAgICBpbml0aWF0ZShpbml0aWF0ZUNvbmYsIHN1YlByb2Nlc3MsIGRhdGEpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1VwZGF0ZSB0aGUgc3ViUHJvY2VzcyBtb2RlbFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuaW5pdGlhdGVkID0gcmVzdWx0LmRhdGEuaW5pdGlhdGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuZGF0ZXMgPSByZXN1bHQuZGF0YS5kYXRlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEV4ZWN1dGUgdGhlIGZpcnN0IHN0ZXBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwSWQgPSBzdWJQcm9jZXNzQ29uZi5zdGVwc1swXS5faWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNpdGlvbklkID0gc3ViUHJvY2Vzc0NvbmYuc3RlcHNbMF0udHJhbnNpdGlvblswXS5faWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcFNlcSA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGVwKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHN0ZXBTZXEsIGRhdGEsIF9XRkluc3RhbmNlLCBzdWJQcm9jZXNzT2JqZWN0SWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuc3RlcCA9IHJlc3VsdC5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3JzKHN1YlByb2Nlc3NDb25mLmluZGljYXRvcnMsIF9XRkluc3RhbmNlLCBtb2RlbC5faWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0MSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuaW5kaWNhdG9ycyA9IHJlc3VsdDEuZGF0YTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRXhlY3V0ZSB0aGUgdHJhbnNpdGlvbnMsIGlmIGF1dG9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU3VicHJvY2VzcyBwb3N0QWN0aW9ucyByZW1vdmVkIGZyb20gaGVyZSBhcyB0aGV5IHNob3VsZCBiZSBleGVjdXRlZCBhdCB0aGUgZW5kIG9mIHRoZSBzdWJQcm9jZXNzLCBtZWFucyBhdCBsYXN0IHN0ZXAgYWZ0ZXIgdHJhbnNpdGlvbiwganVzdCBiZWZvcmUgZmluaXNoLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2FuIGFkZCBoaXN0b3J5IG9iamVjdCBoZXJlIGluIGNhc2UgZm9yIGZpcnN0IHN0ZXAsIGkuZSBpbml0aWFsaXNhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbW9kZWwuaGlzdG9yeS5wdXNoKHJlc3VsdC5kYXRhKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MocmVzdWx0MS5tZXNzYWdlLCBtb2RlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzID0gX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIShvYmouX2lkID09IHN1YlByb2Nlc3NPYmplY3RJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMgPSBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICEob2JqLl9pZCA9PSBzdWJQcm9jZXNzT2JqZWN0SWQpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3NlcyA9IF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAhKG9iai5faWQgPT0gc3ViUHJvY2Vzc09iamVjdElkKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pO1xufTtcblxuLyoqXG4gKiBQcm9jZXNzIGluaXRpYXRlXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IGluaXRpYXRlIC0gdGhlIGluaXRpYXRlIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gZGF0YSAtIHRoZSB1c2VyIGlucHV0IGRhdGFcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIGluaXRpYXRlKGluaXRpYXRlLCBzdWJQcm9jZXNzLCBkYXRhKSB7XG4gICAgdmFyIGNvbXBsZXRlZCA9IFtdO1xuICAgIHZhciByZXN1bHQgPSB7XG4gICAgICAgIGluaXRpYXRlZDogZmFsc2UsXG4gICAgICAgIGRhdGVzOiB7XG4gICAgICAgICAgICBjcmVhdGVkOiAnJyxcbiAgICAgICAgICAgIHZhbGlkOiAnJyxcbiAgICAgICAgICAgIHN0YXJ0OiAnJyxcbiAgICAgICAgICAgIGR1ZTogJycsXG4gICAgICAgICAgICBjbG9zZWQ6ICcnXG4gICAgICAgIH1cblxuICAgIH07XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgIGlmIChpbml0aWF0ZS51c2VyICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRlcy5jcmVhdGVkID0gZGF0YS5jcmVhdGVkRGF0ZTtcbiAgICAgICAgICAgICAgICBpZiAoaW5pdGlhdGUudXNlci52YWxpZERhdGUuX3R5cGUgPT0gJ3VzZXJTZWxlY3RlZCcgfHwgaW5pdGlhdGUudXNlci52YWxpZERhdGUuX3R5cGUgPT0gJ2F1dG9TZWxlY3RlZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEudmFsaWREYXRlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmRhdGVzLnZhbGlkID0gZGF0YS52YWxpZERhdGU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuZGF0ZXMudmFsaWQgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3Vic3RyaW5nKDAsIDEwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGluaXRpYXRlLnVzZXIuZHVlRGF0ZS5fdHlwZSA9PSAndXNlclNlbGVjdGVkJyB8fCBpbml0aWF0ZS51c2VyLmR1ZURhdGUuX3R5cGUgPT0gJ2F1dG9TZWxlY3RlZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuZHVlRGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuZGF0ZXMuZHVlID0gZGF0YS5kdWVEYXRlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXN1bHQuZGF0ZXMuc3RhcnQgPSBkYXRhLmZpcnN0RGF0ZTtcblxuXG5cbiAgICAgICAgICAgICAgICByZXN1bHQuaW5pdGlhdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnU3ViLVByb2Nlc3MgaW5pdGlhdGUgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5pdGlhdGUuYXV0byAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgcmVzdWx0LmRhdGVzLmNyZWF0ZWQgPSBkYXRhLmNyZWF0ZWREYXRlO1xuXG4gICAgICAgICAgICAgICAgaWYgKGluaXRpYXRlLmRhdGVzLnZhbGlkLl90eXBlID09ICd1c2VyU2VsZWN0ZWQnIHx8IGluaXRpYXRlLmRhdGVzLnZhbGlkLl90eXBlID09ICdhdXRvU2VsZWN0ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnZhbGlkRGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuZGF0ZXMudmFsaWQgPSBkYXRhLnZhbGlkRGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHV0aWwud2FybignV0ZJbml0aWF0ZUVycm9yJywgJ05vIHZhbGlkIGRhdGUgcGFzc2VkIGluIC0ge2RhdGEudmFsaWREYXRlfScpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5pdGlhdGUuZGF0ZXMuZHVlLl90eXBlID09ICd1c2VyU2VsZWN0ZWQnIHx8IGluaXRpYXRlLmRhdGVzLmR1ZS5fdHlwZSA9PSAnYXV0b1NlbGVjdGVkJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5kdWVEYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRlcy5kdWUgPSBkYXRhLmR1ZURhdGU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1dGlsLndhcm4oJ1dGSW5pdGlhdGVFcnJvcicsICdObyBkdWUgZGF0ZSBwYXNzZWQgaW4gLSB7ZGF0YS5kdWVEYXRlfScpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXN1bHQuaW5pdGlhdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnU3ViLVByb2Nlc3MgaW5pdGlhdGUgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7Ki9cblxuICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgIHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGSW5pdGlhdGVFcnJvcicsICdJbml0aWF0ZSB0eXBlOiAnICsgaW5pdGlhdGUuX3R5cGUgKyAnIG5vdCBkZWZpbmVkLicpO1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHN1YlByb2Nlc3MuY29tcGxldGUgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpbml0KCk7XG4gICAgICAgIH0gZWxzZSBpZiAoIXN1YlByb2Nlc3MuY29tcGxldGUpIHtcbiAgICAgICAgICAgIGlmIChpbml0aWF0ZS5wYXJhbGxlbEluc3RhbmNlcykge1xuICAgICAgICAgICAgICAgIGluaXQoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZJbml0aWF0ZUVycm9yJywgJ1N1Yi1wcm9jZXNzOiAnICsgc3ViUHJvY2Vzcy5pZCArICcgc3RpbGwgYWN0aXZlIGFuZCBwYXJhbGxlbCBpbnN0YW5jZXMgYXJlIG5vdCBhbGxvd2VkLicpO1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFByb2Nlc3Mgc3RlcFxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgY3VycmVudCBwcm9jZXNzIGlkXG4gKiBAcGFyYW0ge3N0cmluZ30gc3ViUHJvY2Vzc0lkIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGVwSWQgLSB0aGUgY3VycmVudCBzdWItcHJvY2VzcyBzdGVwIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gc3RlcFNlcSAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIHN0ZXAgaW5zdGFuY2UgY291bnRlciAvIHNlcXVlbmNlXG4gKiBAcGFyYW0ge29iamVjdH0gZGF0YSAtIHRoZSB1c2VyIGlucHV0IGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IF9XRkluc3RhbmNlIGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBzdGVwKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHN0ZXBTZXEsIGRhdGEsIF9XRkluc3RhbmNlLCBzcHV1aWQpIHtcblxuICAgIC8vIERlZmF1bHQgc3RlcCBtb2RlbFxuICAgIHZhciBtb2RlbCA9IHtcbiAgICAgICAga2V5OiBnZW5lcmF0ZVVVSUQoKSxcbiAgICAgICAgaWQ6ICcnLFxuICAgICAgICBzZXE6ICcnLFxuICAgICAgICBzdGF0dXM6ICcnLFxuICAgICAgICBtZXNzYWdlOiAnJyxcbiAgICAgICAgYXNzaWduZWRUbzoge1xuICAgICAgICAgICAgdXNlcklkOiAnJyxcbiAgICAgICAgICAgIG5hbWU6ICcnLFxuICAgICAgICAgICAgZGF0ZVRpbWU6ICcnLFxuICAgICAgICAgICAgdHlwZTogJycsXG4gICAgICAgICAgICBkdWVEYXRlVGltZTogJycsXG4gICAgICAgICAgICBieTogJydcbiAgICAgICAgfSxcbiAgICAgICAgYXNzaWdubWVudEhpc3Rvcnk6IFtdLFxuICAgICAgICBkYXRlVGltZUNyZWF0ZWQ6IG1vbWVudCgpLmZvcm1hdCgpLFxuICAgICAgICBkdWVEYXRlVGltZTogbW9tZW50KCkuZm9ybWF0KCksXG4gICAgICAgIHRyYW5zaXRpb246IHtcbiAgICAgICAgICAgIHRyYW5zaXRpb25JZDogJycsXG4gICAgICAgICAgICBkYXRlVGltZTogJycsXG4gICAgICAgICAgICB1c2VySWQ6ICcnXG4gICAgICAgIH0sXG4gICAgICAgIGFzc2lnbm1lbnQ6IHt9LFxuICAgICAgICBjb21tZW50OiAnJ1xuICAgIH07XG5cbiAgICB2YXIgc3ViUHJvY2VzcyA9IHt9O1xuXG4gICAgdmFyIHV1aWQgPSAnJztcbiAgICB2YXIgaW5zdFN1YlByb2Nlc3M7XG4gICAgdmFyIHN0ZXAgPSB7fTtcblxuICAgIHZhciB0cmFuc2l0aW9uSWQgPSAnJztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvL0dldCB0aGUgY3VycmVudCBzdWJQcm9jZXNzIGluc3RhbmNlIGRhdGFcblxuICAgICAgICAgICAgLy8gX1dGSW5zdGFuY2UuaW5zdGFuY2UucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpQcm9jZXNzKSB7XG4gICAgICAgICAgICAvLyAgICAgaWYgKG9ialByb2Nlc3MuaWQgPT0gcHJvY2Vzc0lkICYmIG9ialByb2Nlc3Muc2VxID09IHByb2Nlc3NTZXEpIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgb2JqUHJvY2Vzcy5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialN1YlByb2Nlc3MpIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgIGlmIChvYmpTdWJQcm9jZXNzLmlkID09IHN1YlByb2Nlc3NJZCAmJiBvYmpTdWJQcm9jZXNzLnNlcSA9PSBzdWJQcm9jZXNzU2VxKSB7XG4gICAgICAgICAgICAvLyAgICAgICAgICAgICAgICAgdXVpZCA9IG9ialN1YlByb2Nlc3MudXVpZDtcbiAgICAgICAgICAgIC8vICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vICAgICAgICAgfSlcbiAgICAgICAgICAgIC8vICAgICB9XG4gICAgICAgICAgICAvLyB9KTtcblxuICAgICAgICAgICAgX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihzdWJQcm9jZXNzSXRlbSkge1xuICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzSXRlbS5faWQgPT0gYXBwLlNDT1BFLnByb2Nlc3NVVUlEKSB7XG4gICAgICAgICAgICAgICAgICAgIGluc3RTdWJQcm9jZXNzID0gc3ViUHJvY2Vzc0l0ZW07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgX1dGSW5zdGFuY2UuY29uZmlnLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqUHJvY2Vzcykge1xuICAgICAgICAgICAgICAgIGlmIChvYmpQcm9jZXNzLl9pZCA9PSBwcm9jZXNzSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgb2JqUHJvY2Vzcy5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialN1YlByb2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmpTdWJQcm9jZXNzLl9pZCA9PSBzdWJQcm9jZXNzSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzID0gb2JqU3ViUHJvY2VzcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpTdWJQcm9jZXNzLnN0ZXBzLmZpbHRlcihmdW5jdGlvbihvYmpTdGVwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmpTdGVwLl9pZCA9PSBzdGVwSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXAgPSBvYmpTdGVwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgc3ViLXByb2Nlc3Mgc3RlcCBkYXRhXG4gICAgICAgICAgICBtb2RlbC5pZCA9IHN0ZXBJZDtcbiAgICAgICAgICAgIG1vZGVsLnNlcSA9IHN0ZXBTZXE7XG5cbiAgICAgICAgICAgIHZhciBpbnN0YW5jZVN0YXR1cyA9ICcnO1xuICAgICAgICAgICAgaWYgKHN0ZXAuc2V0SW5zdGFuY2VTdGF0dXNUby5Ob3RTdGFydGVkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGluc3RhbmNlU3RhdHVzID0gXCJOb3RTdGFydGVkXCI7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0ZXAuc2V0SW5zdGFuY2VTdGF0dXNUby5DcmVhdGVkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGluc3RhbmNlU3RhdHVzID0gXCJDcmVhdGVkXCI7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0ZXAuc2V0SW5zdGFuY2VTdGF0dXNUby5JblByb2dyZXNzICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGluc3RhbmNlU3RhdHVzID0gXCJJblByb2dyZXNzXCI7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0ZXAuc2V0SW5zdGFuY2VTdGF0dXNUby5TdWJtaXR0ZWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VTdGF0dXMgPSBcIlN1Ym1pdHRlZFwiO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChzdGVwLnNldEluc3RhbmNlU3RhdHVzVG8uQ29tcGxldGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VTdGF0dXMgPSBcIkNvbXBsZXRlXCI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBsYW5ndWFnZSA9IHNlcnZpY2UuZ2V0TGFuZ3VhZ2UoKTtcblxuICAgICAgICAgICAgbW9kZWwuc3RhdHVzID0gaW5zdGFuY2VTdGF0dXM7XG4gICAgICAgICAgICBtb2RlbC5tZXNzYWdlID0gc3RlcC5zZXRJbnN0YW5jZVN0YXR1c1RvW2luc3RhbmNlU3RhdHVzXS5sYWJlbC5pMThuW2xhbmd1YWdlXTtcbiAgICAgICAgICAgIGlmKG1vZGVsLm1lc3NhZ2UgPT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICBtb2RlbC5tZXNzYWdlID0gc3RlcC5zZXRJbnN0YW5jZVN0YXR1c1RvW2luc3RhbmNlU3RhdHVzXS5sYWJlbC5pMThuW1wiZW5cIl07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtb2RlbC5jb21tZW50ID0gZGF0YS5jb21tZW50ICE9PSB1bmRlZmluZWQgPyBkYXRhLmNvbW1lbnQgOiAnJztcbiAgICAgICAgICAgIHZhciBpbmRpY2F0b3JzID0gaW5zdFN1YlByb2Nlc3MgIT09IHVuZGVmaW5lZCA/IGluc3RTdWJQcm9jZXNzLmluZGljYXRvcnMgOiBbXTtcblxuICAgICAgICAgICAgdmFyIHVwZGF0ZVNQSW5kaWNhdG9yT2JqZWN0ID0gZnVuY3Rpb24oaW5kaWNhdG9ycywgX1dGSW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgYXNzaWduZWUgPSBtb2RlbC5hc3NpZ25lZFRvO1xuICAgICAgICAgICAgICAgIGlmIChpbmRpY2F0b3JzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbmRpY2F0b3JzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yT2JqZWN0ID0gaW5kaWNhdG9yc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1dWlkID0gaW5kaWNhdG9yT2JqZWN0Lmluc3RhbmNlc1swXS51dWlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvciA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluZGljYXRvck9iamVjdC5pbnN0YW5jZXNbMF0uc2VxID0gaW5kaWNhdG9yLm1vZGVsLnBlbmRpbmcuc2VxO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGluZGljYXRvci53b3JrZmxvd3MubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kaWNhdG9yLndvcmtmbG93c1tqXS5wcm9jZXNzZXNbMF0gIT0gdW5kZWZpbmVkICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGljYXRvci53b3JrZmxvd3Nbal0ucHJvY2Vzc2VzWzBdLnN1YlByb2Nlc3NVVUlEICE9IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3Iud29ya2Zsb3dzW2pdLnByb2Nlc3Nlc1swXS5zdGVwICE9IHVuZGVmaW5lZCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcHV1aWQgPT0gaW5kaWNhdG9yLndvcmtmbG93c1tqXS5wcm9jZXNzZXNbMF0uc3ViUHJvY2Vzc1VVSUQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yLndvcmtmbG93c1tqXS5wcm9jZXNzZXNbMF0uc3RlcC5hc3NpZ25lZFRvID0gYXNzaWduZWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGNsZWFyU1BTdGF0dXMgPSBmdW5jdGlvbihzcHV1aWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIG9iai5zcFN0YXR1cyA9IFwiXCI7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpbmRpY2F0b3JEb2NzKHByb2Nlc3NJZCwgaW5kaWNhdG9ycywgbW9kZWwsIF9XRkluc3RhbmNlLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgdXVpZCA9IHNwdXVpZDtcblxuICAgICAgICAgICAgICAgIGlmIChzdGVwLmZ1bmN0aW9uLmFjdGlvbnMgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbnMoc3RlcC5mdW5jdGlvbi5hY3Rpb25zLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2VzcywgbW9kZWwsIF9XRkluc3RhbmNlLCBkYXRhLCBzcHV1aWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWduZWUgPSBtb2RlbC5hc3NpZ25lZFRvO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUubmFtZSA9IF9sY2x4LlNFU1NJT04uZmlyc3ROYW1lICsgXCIgXCIgKyBfbGNseC5TRVNTSU9OLmxhc3ROYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLnVzZXJJZCA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLnR5cGUgPSBBU1NJR05NRU5UX1RZUEVfQVVUTztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5kdWVEYXRlVGltZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmJ5ID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQgKyBcIlwiO1xuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVNQSW5kaWNhdG9yT2JqZWN0KGluZGljYXRvcnMsIF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNpdGlvbklkID0gc3RlcC50cmFuc2l0aW9uWzBdLl9pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHRyYW5zaXRpb25JZCwgZGF0YSwgX1dGSW5zdGFuY2UsIHNwdXVpZCwgbW9kZWwpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdUcmFuc2l0aW9uIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywgcmVzdWx0LmRhdGEuc3RlcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHN0ZXAuZnVuY3Rpb24udGFzayAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTWFrZSBhc3NpZ25tZW50c1xuICAgICAgICAgICAgICAgICAgICB0YXNrKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3RlcC5mdW5jdGlvbi50YXNrLCBzcHV1aWQsIG1vZGVsKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVTUEluZGljYXRvck9iamVjdChpbmRpY2F0b3JzLCBfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnVGFzayBhd2FpdGluZyB1c2VyIGFjdGlvbi4nLCBtb2RlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RlcC5mdW5jdGlvbi5zZXJ2ZXIgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIE1ha2UgYXNzaWdubWVudHNcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJTUFN0YXR1cyhzcHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICBzZXJ2ZXIoc3RlcC5mdW5jdGlvbi5zZXJ2ZXIsIHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdWJQcm9jZXNzLCBtb2RlbCwgX1dGSW5zdGFuY2UsIGRhdGEsIHNwdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlU1BJbmRpY2F0b3JPYmplY3QoaW5kaWNhdG9ycywgX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1NlcnZlciBhd2FpdGluZyBzZXJ2ZXIgcmVzcG9uc2UuJywgbW9kZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogUHJvY2VzcyBpbmRpY2F0b3IgdXBkYXRlc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBhY3Rpb25zIC0gdGhlIGFjdGlvbnMgY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBzdWJQcm9jZXNzIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3MgZm9ybSBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIGluZGljYXRvcnMoaW5kaWNhdG9ycywgX1dGSW5zdGFuY2UsIHNwdXVpZCkge1xuICAgIHZhciBtb2RlbCA9IFtdO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBhcnJheSA9IEpTT04ueHBhdGgoXCJpbmRpY2F0b3JzW2ZuOmNvdW50KC4vd29ya2Zsb3dzL3Byb2Nlc3Nlc1tzdWJQcm9jZXNzVVVJRCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddKSBndCAwXVwiLCBfV0ZJbnN0YW5jZSwge30pO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGFycmF5Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluZGljYXRvciA9IGFycmF5W2pdO1xuICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JNb2RlbCA9IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZXM6IFtdXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlTW9kZWwgPSB7XG4gICAgICAgICAgICAgICAgICAgIHV1aWQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJycsXG4gICAgICAgICAgICAgICAgICAgIGtleTogJycsXG4gICAgICAgICAgICAgICAgICAgIHNlcTogMSxcbiAgICAgICAgICAgICAgICAgICAgcmV2OiAnJ1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGluZGljYXRvck1vZGVsLmlkID0gaW5kaWNhdG9yLmNhdGVnb3J5LnRlcm07XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VNb2RlbC51dWlkID0gaW5kaWNhdG9yLl9pZDtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZU1vZGVsLnJldiA9IGluZGljYXRvci5fcmV2O1xuICAgICAgICAgICAgICAgIGluc3RhbmNlTW9kZWwudGl0bGUgPSBpbmRpY2F0b3IudGl0bGU7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VNb2RlbC5rZXkgPSAnJztcbiAgICAgICAgICAgICAgICBpbnN0YW5jZU1vZGVsLnNlcSA9IGluZGljYXRvci5tb2RlbC5wZW5kaW5nLnNlcTsgLy8gaW5kaWNhdG9yIHNlcSBudW1iZXIgaGVyZSB3aGljaCBpcyBnZXR0aW5nIHVwZGF0ZWQuXG4gICAgICAgICAgICAgICAgaW5kaWNhdG9yTW9kZWwuaW5zdGFuY2VzLnB1c2goaW5zdGFuY2VNb2RlbCk7XG4gICAgICAgICAgICAgICAgbW9kZWwucHVzaChpbmRpY2F0b3JNb2RlbCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdQcm9jZXNzIGluZGljYXRvciBtb2RlbCB1cGRhdGVkLicsIG1vZGVsKTtcbiAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pXG59O1xuXG4vKipcbiAqIFByb2Nlc3MgYXNzaWduIHVzZXJcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2UgcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdWJQcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdWItcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHN1YlByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2Ugc3ViLXByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RlcElkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3RlcCBpZFxuICogQHBhcmFtIHtzdHJpbmd9IHRyYW5zaXRpb25JZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHRyYW5zaXRpb24gaWRcbiAqIEBwYXJhbSB7b2JqZWN0fSB1c2VyIC0gdGhlIHVzZXIgdG8gYXNzaWduIHRvXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgY3VycmVudCB3b3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gYXNzaWduVXNlcihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgdXNlciwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgIC8vIEdldCB0aGUgY3VycmVudCBzdWJQcm9jZXNzIGluc3RhbmNlIGRhdGFcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgIF9XRkluc3RhbmNlLmluc3RhbmNlLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24gKG9ialByb2Nlc3MpIHtcbiAgICAgICAgICAgICAgICBpZiAob2JqUHJvY2Vzcy5pZCA9PSBwcm9jZXNzSWQgJiYgb2JqUHJvY2Vzcy5zZXEgPT0gcHJvY2Vzc1NlcSkge1xuICAgICAgICAgICAgICAgICAgICBvYmpQcm9jZXNzLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24gKG9ialN1YlByb2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmpTdWJQcm9jZXNzLmlkID09IHN1YlByb2Nlc3NJZCAmJiBvYmpTdWJQcm9jZXNzLnNlcSA9PSBzdWJQcm9jZXNzU2VxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXVpZCA9IG9ialN1YlByb2Nlc3MudXVpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NJdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN1YlByb2Nlc3NJdGVtLl9pZCA9PSB1dWlkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vQWRkZWQgdG8gaHN0b3J5XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzSXRlbS5zdGVwLmFzc2lnbm1lbnRIaXN0b3J5ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25tZW50SGlzdG9yeSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8udXNlcklkICE9IFwiXCIgJiYgc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLm5hbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25tZW50SGlzdG9yeS5wdXNoKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvKSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIHVzZXIgZGV0YWlsc1xuICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8udXNlcklkID0gdXNlci5pZDtcbiAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLm5hbWUgPSB1c2VyLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUby5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8udHlwZSA9IEFTU0lHTk1FTlRfVFlQRV9SRUFTU0lHTk1FTlQ7XG4gICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUby5kdWVEYXRlVGltZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8uYnkgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBpbmRpY2F0b3JzIHVzZXIgZGV0YWlsc1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9ycyA9IHN1YlByb2Nlc3NJdGVtLmluZGljYXRvcnM7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5kaWNhdG9ycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvciA9IGluZGljYXRvcnNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGluZGljYXRvci5pbnN0YW5jZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSBpbmRpY2F0b3IuaW5zdGFuY2VzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZG9jID0gX1dGSW5zdGFuY2UuaW5kaWNhdG9yc1trXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLnV1aWQgPT0gZG9jLl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jLndvcmtmbG93cy5maWx0ZXIoZnVuY3Rpb24od29ya2Zsb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZmxvdy5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHByb2Nlc3NJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9jZXNzSXRlbS5pZCA9PSBwcm9jZXNzSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgdXNlciBpZCBhbmQgbmFtZSBpbiB0aGUgZG9jdW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUby51c2VySWQgPSB1c2VyLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLm5hbWUgPSB1c2VyLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy9TZW5kIGFzc2lnbiB1c2VyIG5vdGlmaWNhdGlvbiBmcm9tIGhlcmVcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbm90aWZpY2F0aW9uID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHByb2Nlc3NJZCArIFwiJ10vbm90aWZpY2F0aW9uc1wiLCBfV0ZJbnN0YW5jZS5jb25maWcsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uICE9IHVuZGVmaW5lZCAmJiBub3RpZmljYXRpb24ucmVBc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2Ygbm90aWZpY2F0aW9uLnJlQXNzaWdubWVudCA9PT0gXCJzdHJpbmdcIil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZUFzc2lnbm1lbnROSWQgPSBub3RpZmljYXRpb24ucmVBc3NpZ25tZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5nZXRDb25maWcocmVBc3NpZ25tZW50TklkKS50aGVuKGZ1bmN0aW9uKHJlQXNzaWdubWVudE9iamVjdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQgPSByZUFzc2lnbm1lbnRPYmplY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLm5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnROb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgdXVpZCwgdXNlcikudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnVXNlciBhc3NpZ25lZCBzdWNjZXNzZnVsbHkuIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJywgc3ViUHJvY2Vzc0l0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGZhaWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGZhaWwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGZhaWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLm5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnROb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgdXVpZCwgdXNlcikudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1VzZXIgYXNzaWduZWQgc3VjY2Vzc2Z1bGx5LiBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicsIHN1YlByb2Nlc3NJdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihmYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGZhaWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICBcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInLCBzdWJQcm9jZXNzSXRlbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuXG5cblxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogUHJvY2VzcyBpbmRpY2F0b3IgZG9jdW1lbnQgdXBkYXRlc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBhY3Rpb25zIC0gdGhlIGFjdGlvbnMgY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBzdWJQcm9jZXNzIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3MgZm9ybSBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIGluZGljYXRvckRvY3MocHJvY2Vzc0lkLCBpbmRpY2F0b3JzLCBzdGVwLCBfV0ZJbnN0YW5jZSwgY3VycmVudFNQVVVJRCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgaW5kaWNhdG9yIHNlY3Rpb25zIG9mIHRoZSBzdWJQcm9jZXNzXG4gICAgICAgICAgICBpZiAoaW5kaWNhdG9ycyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRkluZGljYXRvcnNVcGRhdGUnLCAnSW5kaWNhdG9ycyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQuIC0gVmFsdWU6ICcgKyBpbmRpY2F0b3JzKVxuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluZGljYXRvcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvciA9IGluZGljYXRvcnNbaV07XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaW5kaWNhdG9yLmluc3RhbmNlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gaW5kaWNhdG9yLmluc3RhbmNlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkb2MgPSBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzW2tdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS51dWlkID09IGRvYy5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jLndvcmtmbG93cy5maWx0ZXIoZnVuY3Rpb24od29ya2Zsb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtmbG93LnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ocHJvY2Vzc0l0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2Vzc0l0ZW0uc3ViUHJvY2Vzc1VVSUQgPT0gY3VycmVudFNQVVVJRCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzSXRlbS5zdGVwLmlkID0gc3RlcC5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3RlcC5zZXEgPSBzdGVwLnNlcTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3RlcC5zdGF0dXMgPSBzdGVwLnN0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3RlcC5tZXNzYWdlID0gc3RlcC5tZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8udXNlcklkID0gc3RlcC5hc3NpZ25lZFRvLnVzZXJJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLm5hbWUgPSBzdGVwLmFzc2lnbmVkVG8ubmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3RlcC5jb21tZW50ID0gc3RlcC5jb21tZW50ICE9PSB1bmRlZmluZWQgPyBzdGVwLmNvbW1lbnQgOiAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0luZGljYXRvciBkb2N1bWVudHMgd29ya2Zsb3cgcHJvY2VzcyBtb2RlbCB1cGRhdGVkLicsIF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pXG59O1xuXG4vKipcbiAqIFByb2Nlc3MgYWN0aW9uc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBhY3Rpb25zIC0gdGhlIGFjdGlvbnMgY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBzdWJQcm9jZXNzIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3MgZm9ybSBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cblxuZnVuY3Rpb24gYWN0aW9ucyhhY3Rpb25zLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2Vzcywgc3RlcCwgX1dGSW5zdGFuY2UsIGRhdGEsIHV1aWQpIHtcbiAgICB2YXIgYXJyQWN0aW9ucyA9IFtdO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdXRpbC5zeW5jTG9vcChhY3Rpb25zLmxlbmd0aCwgZnVuY3Rpb24obG9vcCkge1xuICAgICAgICAgICAgdmFyIGNvdW50ZXIgPSBsb29wLml0ZXJhdGlvbigpO1xuICAgICAgICAgICAgYWN0aW9uKGFjdGlvbnNbY291bnRlcl0sIHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdWJQcm9jZXNzLCBzdGVwLCBfV0ZJbnN0YW5jZSwgZGF0YSwgdXVpZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJldEFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBhY3Rpb25zW2NvdW50ZXJdLl9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcTogY291bnRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHJlc3VsdFxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIGFyckFjdGlvbnMucHVzaChyZXRBY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICBsb29wLm5leHQoKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgbG9vcC5icmVhaygpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSwgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnQWN0aW9ucyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIGFyckFjdGlvbnMpO1xuICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgYWN0aW9uXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IGFjdGlvbiAtIHRoZSBhY3Rpb24gY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBzdWJQcm9jZXNzIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3MgZm9ybSBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIGFjdGlvbihhY3Rpb24sIHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdWJQcm9jZXNzLCBzdGVwLCBfV0ZJbnN0YW5jZSwgZGF0YSwgdXVpZCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICBpZiAoYWN0aW9uLm1ldGhvZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciBtZXRob2RQb3NzaWJsZUl0ZW1zID0gW1wiZm9ybVwiLCBcImluZGljYXRvclwiLCBcInByb2ZpbGVcIiwgXCJzdWJQcm9jZXNzSW5zdGFuY2VcIiwgXCJzdGVwXCIsIFwiY29tbXVuaXR5XCIsIFwiYXBwbGljYXRpb25cIiwgXCJ1c2VyXCIsIFwic2RvXCIsIFwicGVyZm9ybWFuY2VcIiwgXCJ0YXhvbm9teVwiLCBcInZhcmlhYmxlc1wiLCBcIm5vdGlmaWNhdGlvblwiLCBcInJlcG9ydFwiLCBcIndvcmtlclwiLCBcInBhcnRpY2lwYW50c1wiLCBcImdlbmVyYWxGdW5jdGlvbnNcIl07XG4gICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2QsIG1ldGhvZFBvc3NpYmxlSXRlbXMpKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnZm9ybSc6XG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpb24ubWV0aG9kLmZvcm0uY3JlYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHByb2Nlc3NJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3RlcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwcm9jZXNzU2VxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChzdWJQcm9jZXNzU2VxKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmNyZWF0ZVR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEuYmFzZVVVSUQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtLmNyZWF0ZShhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5tZXRob2QuZm9ybS5hdXRob3Jpc2UgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc0lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChzdWJQcm9jZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwcm9jZXNzU2VxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChzdWJQcm9jZXNzU2VxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5jcmVhdGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmJhc2VVVUlEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uYXV0aG9yaXNlKGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5mb3JtLnVuZHJhZnQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmNyZWF0ZVR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEuYmFzZVVVSUQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5zZXRVbkRyYWZ0KGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5mb3JtLmRyYWZ0ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5jcmVhdGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmJhc2VVVUlEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uc2V0RHJhZnQoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24ubWV0aG9kLmZvcm0uY2xvc2UgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzcy5pbmRpY2F0b3JzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5jcmVhdGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmJhc2VVVUlEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uY2xvc2UoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24ubWV0aG9kLmZvcm0uYXV0aG9yaXNlQW5kQ3JlYXRlTmV3U2VxICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHByb2Nlc3NJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc1NlcSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzc1NlcSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEuY3JlYXRlVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2godXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5iYXNlVVVJRCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtLmF1dGhvcmlzZShhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIG5ldyBzZXF1ZW5jZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc0lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN0ZXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwcm9jZXNzU2VxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzc1NlcSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmNyZWF0ZVR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2godXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5jcmVhdGUoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vRWQgY3JlYXRpb24gb2YgbmV3IHNlcXVlbmNlXG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5mb3JtLmNyZWF0ZU5ld1NlcSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwcm9jZXNzSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN1YlByb2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN0ZXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc1NlcSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzc1NlcSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5jcmVhdGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5jcmVhdGUoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2luZGljYXRvcic6XG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpb24ubWV0aG9kLmluZGljYXRvci5jcmVhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJOb3QgaW1wbGVtZW50ZWRcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24ubWV0aG9kLmluZGljYXRvci5pbnN0YW50aWF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShcIk5vdCBpbXBsZW1lbnRlZFwiKTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5tZXRob2QuaW5kaWNhdG9yLnNldFZhbHVlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IGFjdGlvbi5tZXRob2QuaW5kaWNhdG9yLnNldFZhbHVlLnBhdGg7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUoYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3Iuc2V0VmFsdWUuZGF0YSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YVZhbHVlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YVZhbHVlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0udXBkYXRlSW5kaWNhdG9yKGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3IudXBkYXRlU3RhdHVzICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0SWQgPSBhY3Rpb24ubWV0aG9kLmluZGljYXRvci5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3IudXBkYXRlU3RhdHVzICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSBhY3Rpb24ubWV0aG9kLmluZGljYXRvci51cGRhdGVTdGF0dXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN0YXR1cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGluZGljYXRvclNldElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBLZWVwIGluZGljYXRvciBmdW5jdGlvbnMgaW4gaW5kaWF0b3IgZmlsZSBpc3RlYWQgb2YgZm9ybSBmaWxlLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0ubWFya1VwZGF0ZUluZGljYXRvcihhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShcIkFjdGlvbiBpbmRpY2F0b3Igc3ViIHR5cGUgbm90IGZvdW5kLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5tZXRob2QuaW5kaWNhdG9yLnNldFdyYXBwZXJFbGVtZW50ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IGFjdGlvbi5tZXRob2QuaW5kaWNhdG9yLnNldFdyYXBwZXJFbGVtZW50LnBhdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0SWQgPSBhY3Rpb24ubWV0aG9kLmluZGljYXRvci5zZXRXcmFwcGVyRWxlbWVudC5pbmRpY2F0b3JTZXRJZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShhY3Rpb24ubWV0aG9kLmluZGljYXRvci5zZXRXcmFwcGVyRWxlbWVudC5kYXRhLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihkYXRhVmFsdWUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2godXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChpbmRpY2F0b3JTZXRJZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtLnVwZGF0ZUluZGljYXRvcldyYXBwZXIoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3Byb2ZpbGUnOlxuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uLm1ldGhvZC5wcm9maWxlLmNyZWF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwcm9jZXNzSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmNyZWF0ZVR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEuYmFzZVVVSUQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5jcmVhdGVQcm9maWxlKGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5wcm9maWxlLnNldFN0YXR1c1RvICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXR1cyA9IGFjdGlvbi5tZXRob2QucHJvZmlsZS5zZXRTdGF0dXNUbztcblxuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChzdGF0dXMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtLnNldFN0YXR1cyhhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFjdGlvbi5tZXRob2QucHJvZmlsZS5zZXRQcm9maWxlU3RhdHVzICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGFjdGlvbi5tZXRob2QucHJvZmlsZS5zZXRQcm9maWxlU3RhdHVzLnZhbHVlLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihkYXRhVmFsdWUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5zZXRQcm9maWxlU3RhdHVzKGFjdGlvbi5tZXRob2QucHJvZmlsZS5zZXRQcm9maWxlU3RhdHVzLmtleSwgZGF0YVZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChhY3Rpb24ubWV0aG9kLnByb2ZpbGUuc2V0U3VicHJvZmlsZVN0YXR1cyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShhY3Rpb24ubWV0aG9kLnByb2ZpbGUuc2V0U3VicHJvZmlsZVN0YXR1cy52YWx1ZSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YVZhbHVlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uc2V0U3VicHJvZmlsZVN0YXR1cyhhY3Rpb24ubWV0aG9kLnByb2ZpbGUuc2V0U3VicHJvZmlsZVN0YXR1cy5rZXksIGRhdGFWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdzdWJQcm9jZXNzSW5zdGFuY2UnOlxuICAgICAgICAgICAgICAgICAgICB2YXIgc3BQb3NzaWJsZUl0ZW1zID0gW1wiaW5zdGFudGlhdGVcIiwgXCJhdXRob3Jpc2VcIiwgXCJjbG9zZVwiLCBcInNldFZhcmlhYmxlXCIsIFwic2V0U3RhdHVzVG9cIiwgXCJzZXRTdGF0dXNNc2dUb1wiLCBcInNldFRpdGxlXCIsIFwic2V0VmFsaWREYXRlXCIsIFwic2V0U1BTdGF0dXNcIl07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoYWN0aW9uLm1ldGhvZC5zdWJQcm9jZXNzSW5zdGFuY2UsIHNwUG9zc2libGVJdGVtcykpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2V0VGl0bGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUoYWN0aW9uLm1ldGhvZC5zdWJQcm9jZXNzSW5zdGFuY2Uuc2V0VGl0bGUsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGFWYWx1ZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUuc3ViUHJvY2Vzc0luc3RhbmNlLnNldFRpdGxlKGFjdGlvbi5tZXRob2Quc3ViUHJvY2Vzc0luc3RhbmNlLnNldFRpdGxlLCB1dWlkLCBkYXRhVmFsdWUsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy91cGRhdGUgc3VicHJvY2VzcyBsYWJlbCBpbiB3b3JrZmxvdyBpbnN0YW5jZSBwcm9jZXNzIG9iamVjdDogVE9ET1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzZXRWYWxpZERhdGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUoYWN0aW9uLm1ldGhvZC5zdWJQcm9jZXNzSW5zdGFuY2Uuc2V0VmFsaWREYXRlLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihkYXRhVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5zdWJQcm9jZXNzSW5zdGFuY2Uuc2V0VmFsaWREYXRlKGFjdGlvbi5tZXRob2Quc3ViUHJvY2Vzc0luc3RhbmNlLnNldFZhbGlkRGF0ZSwgdXVpZCwgZGF0YVZhbHVlLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3VwZGF0ZSBzdWJwcm9jZXNzIGxhYmVsIGluIHdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgb2JqZWN0OiBUT0RPXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2V0U1BTdGF0dXMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUoYWN0aW9uLm1ldGhvZC5zdWJQcm9jZXNzSW5zdGFuY2Uuc2V0U1BTdGF0dXMsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGFWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLnN1YlByb2Nlc3NJbnN0YW5jZS5zZXRTUFN0YXR1cyhhY3Rpb24ubWV0aG9kLnN1YlByb2Nlc3NJbnN0YW5jZS5zZXRTUFN0YXR1cywgdXVpZCwgZGF0YVZhbHVlLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3VwZGF0ZSBzdWJwcm9jZXNzIGxhYmVsIGluIHdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgb2JqZWN0OiBUT0RPXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QgaW4gc3VicHJvY2VzcyBhY3Rpb24uXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnc3RlcCc6XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2NvbW11bml0eSc6XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21tdW5pdHlQb3NzaWJsZUl0ZW1zID0gW1wiY3JlYXRlQ29tbXVuaXR5XCIsIFwicmVsZWFzZUFkb3B0ZWRBcHBsaWNhdGlvblwiLCBcInVzZXJKb2luQ29tbXVuaXR5XCJdO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2QuY29tbXVuaXR5LCBjb21tdW5pdHlQb3NzaWJsZUl0ZW1zKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjcmVhdGVDb21tdW5pdHknOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLmNvbW11bml0eS5jcmVhdGVDb21tdW5pdHkoYWN0aW9uLm1ldGhvZC5jb21tdW5pdHkuY3JlYXRlQ29tbXVuaXR5LCB1dWlkLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdyZWxlYXNlQWRvcHRlZEFwcGxpY2F0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5jb21tdW5pdHkucmVsZWFzZUFkb3B0ZWRBcHBsaWNhdGlvbihhY3Rpb24ubWV0aG9kLmNvbW11bml0eS5yZWxlYXNlQWRvcHRlZEFwcGxpY2F0aW9uLCB1dWlkLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd1c2VySm9pbkNvbW11bml0eSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUuY29tbXVuaXR5LnVzZXJKb2luQ29tbXVuaXR5KGFjdGlvbi5tZXRob2QuY29tbXVuaXR5LnVzZXJKb2luQ29tbXVuaXR5LCB1dWlkLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnYXBwbGljYXRpb24nOlxuICAgICAgICAgICAgICAgICAgICB2YXIgYXBwbGljYXRpb25Qb3NzaWJsZUl0ZW1zID0gW1wiY3JlYXRlQXBwRGVmaW5pdGlvblwiLCBcImJ1aWxkQXBwbGljYXRpb25cIiwgXCJhcHBsaWNhdGlvbkFkb3B0aW9uXCJdO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2QuYXBwbGljYXRpb24sIGFwcGxpY2F0aW9uUG9zc2libGVJdGVtcykpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY3JlYXRlQXBwRGVmaW5pdGlvbic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUuYXBwbGljYXRpb24uY3JlYXRlQXBwRGVmaW5pdGlvbihhY3Rpb24ubWV0aG9kLmFwcGxpY2F0aW9uLmNyZWF0ZUFwcERlZmluaXRpb24sIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2J1aWxkQXBwbGljYXRpb24nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLmFwcGxpY2F0aW9uLmJ1aWxkQXBwbGljYXRpb24oYWN0aW9uLm1ldGhvZC5hcHBsaWNhdGlvbi5idWlsZEFwcGxpY2F0aW9uLCB1dWlkLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhcHBsaWNhdGlvbkFkb3B0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5hcHBsaWNhdGlvbi5hcHBsaWNhdGlvbkFkb3B0aW9uKGFjdGlvbi5tZXRob2QuYXBwbGljYXRpb24uYXBwbGljYXRpb25BZG9wdGlvbiwgdXVpZCwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJObyBtZXRob2QgZm91bmQgZnJvbSBpbXBsZW1lbnRlZCBsaXN0LlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAndXNlcic6XG4gICAgICAgICAgICAgICAgICAgIHZhciB1c2VyUG9zc2libGVJdGVtcyA9IFtcImFkZFRvUm9sZVwiXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhhY3Rpb24ubWV0aG9kLnVzZXIsIHVzZXJQb3NzaWJsZUl0ZW1zKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYWRkVG9Sb2xlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS51c2VyLmFkZFRvUm9sZShhY3Rpb24ubWV0aG9kLnVzZXIuYWRkVG9Sb2xlLCB1dWlkLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3Nkbyc6XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZG9Qb3NzaWJsZUl0ZW1zID0gW1wiY3JlYXRlXCIsIFwiZW5yb2xsQ291cnNlXCJdO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2Quc2RvLCBzZG9Qb3NzaWJsZUl0ZW1zKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjcmVhdGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnNkby5jcmVhdGUoYWN0aW9uLm1ldGhvZC5zZG8uY3JlYXRlLCB1dWlkLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZW5yb2xsQ291cnNlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5zZG8uZW5yb2xsQ291cnNlKGFjdGlvbi5tZXRob2Quc2RvLmVucm9sbENvdXJzZSwgdXVpZCwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJObyBtZXRob2QgZm91bmQgZnJvbSBpbXBsZW1lbnRlZCBsaXN0LlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAncGVyZm9ybWFuY2UnOlxuICAgICAgICAgICAgICAgICAgICB2YXIgcGVyZm9ybWFuY2VQb3NzaWJsZUl0ZW1zID0gW1widW5sb2NrUGVyaW9kXCIsIFwibG9ja1BlcmZvcm1hbmNlTW9kZWxcIiwgXCJzZXRNb2RlbFN0YXR1c1wiXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhhY3Rpb24ubWV0aG9kLnBlcmZvcm1hbmNlLCBwZXJmb3JtYW5jZVBvc3NpYmxlSXRlbXMpKSB7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAndW5sb2NrUGVyaW9kJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5wZXJmb3JtYW5jZS51bmxvY2tQZXJpb2QoYWN0aW9uLm1ldGhvZC5wZXJmb3JtYW5jZS51bmxvY2tQZXJpb2QsIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzZXRNb2RlbFN0YXR1cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucGVyZm9ybWFuY2Uuc2V0TW9kZWxTdGF0dXMoYWN0aW9uLm1ldGhvZC5wZXJmb3JtYW5jZS5zZXRNb2RlbFN0YXR1cywgdXVpZCwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2xvY2tQZXJmb3JtYW5jZU1vZGVsJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5wZXJmb3JtYW5jZS5sb2NrUGVyZm9ybWFuY2VNb2RlbChhY3Rpb24ubWV0aG9kLnBlcmZvcm1hbmNlLmxvY2tQZXJmb3JtYW5jZU1vZGVsLCB1dWlkLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3RheG9ub215JzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRheG9ub215UG9zc2libGVJdGVtcyA9IFtcImNyZWF0ZVwiXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhhY3Rpb24ubWV0aG9kLnRheG9ub215LCB0YXhvbm9teVBvc3NpYmxlSXRlbXMpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUudGF4b25vbXkuY3JlYXRlKGFjdGlvbi5tZXRob2QudGF4b25vbXkuY3JlYXRlLCB1dWlkLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAndmFyaWFibGVzJzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhcmlhYmxlc1Bvc3NpYmxlSXRlbXMgPSBbXCJzZXRWYXJpYWJsZVwiXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhhY3Rpb24ubWV0aG9kLnZhcmlhYmxlcywgdmFyaWFibGVzUG9zc2libGVJdGVtcykpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2V0VmFyaWFibGUnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUudmFyaWFibGVzLnNldFZhcmlhYmxlKGFjdGlvbi5tZXRob2QudmFyaWFibGVzLnNldFZhcmlhYmxlLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbm90aWZpY2F0aW9uJzpcblxuXG4gICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBhY3Rpb24ubWV0aG9kLm5vdGlmaWNhdGlvbiA9PT0gXCJzdHJpbmdcIil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlQXNzaWdubWVudE5JZCA9IGFjdGlvbi5tZXRob2Qubm90aWZpY2F0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0Q29uZmlnKHJlQXNzaWdubWVudE5JZCkudGhlbihmdW5jdGlvbihyZUFzc2lnbm1lbnRPYmplY3Qpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5tZXRob2Qubm90aWZpY2F0aW9uID0gcmVBc3NpZ25tZW50T2JqZWN0O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uc2VuZE5vdGlmaWNhdGlvbldvcmtlcihhY3Rpb24ubWV0aG9kLm5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGZhaWwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZmFpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLm5vdGlmaWNhdGlvbi5zZW5kTm90aWZpY2F0aW9uV29ya2VyKGFjdGlvbi5tZXRob2Qubm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAgICAgY2FzZSAncmVwb3J0JzpcbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcG9ydFBvc3NpYmxlSXRlbXMgPSBbXCJjcmVhdGVQZXJmb3JtYW5jZVJlcG9ydFwiLCBcImNyZWF0ZVJlcG9ydFwiLCBcInNkb1JlcG9ydFwiLCBcImV4ZWN1dGVSZXBvcnRcIiwgXCJyZXF1ZXN0UmVwb3J0XCIsIFwiZ2VuZXJhdGVWaWV3XCIsIFwiZ2VuZXJhdGVCYXNpY1ZpZXdcIiwgXCJnZW5lcmF0ZVVuaW9uVmlld1wiLCBcInNkb1JlcG9ydE11bHRpcGxlXCIsIFwic3VicHJvZmlsZVF1YXJ0ZXJseVJlcG9ydFwiXTtcblxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2QucmVwb3J0LCByZXBvcnRQb3NzaWJsZUl0ZW1zKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjcmVhdGVQZXJmb3JtYW5jZVJlcG9ydCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucmVwb3J0LmNyZWF0ZVBlcmZvcm1hbmNlUmVwb3J0KGFjdGlvbi5tZXRob2QucmVwb3J0LmNyZWF0ZVBlcmZvcm1hbmNlUmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjcmVhdGVSZXBvcnQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnJlcG9ydC5jcmVhdGVSZXBvcnQoYWN0aW9uLm1ldGhvZC5yZXBvcnQuY3JlYXRlUmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2RvUmVwb3J0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5yZXBvcnQuc2RvUmVwb3J0KGFjdGlvbi5tZXRob2QucmVwb3J0LnNkb1JlcG9ydCwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2V4ZWN1dGVSZXBvcnQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnJlcG9ydC5leGVjdXRlUmVwb3J0KGFjdGlvbi5tZXRob2QucmVwb3J0LmV4ZWN1dGVSZXBvcnQsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdnZW5lcmF0ZVZpZXcnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnJlcG9ydC5nZW5lcmF0ZVZpZXcoYWN0aW9uLm1ldGhvZC5yZXBvcnQuZ2VuZXJhdGVWaWV3LCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncmVxdWVzdFJlcG9ydCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucmVwb3J0LnJlcXVlc3RSZXBvcnQoYWN0aW9uLm1ldGhvZC5yZXBvcnQucmVxdWVzdFJlcG9ydCwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2dlbmVyYXRlQmFzaWNWaWV3JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5yZXBvcnQuZ2VuZXJhdGVCYXNpY1ZpZXcoYWN0aW9uLm1ldGhvZC5yZXBvcnQuZ2VuZXJhdGVCYXNpY1ZpZXcsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdnZW5lcmF0ZVVuaW9uVmlldyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucmVwb3J0LmdlbmVyYXRlVW5pb25WaWV3KGFjdGlvbi5tZXRob2QucmVwb3J0LmdlbmVyYXRlVW5pb25WaWV3LCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzZG9SZXBvcnRNdWx0aXBsZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucmVwb3J0LnNkb1JlcG9ydE11bHRpcGxlKGFjdGlvbi5tZXRob2QucmVwb3J0LnNkb1JlcG9ydE11bHRpcGxlLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3VicHJvZmlsZVF1YXJ0ZXJseVJlcG9ydCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucmVwb3J0LnN1YnByb2ZpbGVRdWFydGVybHlSZXBvcnQoYWN0aW9uLm1ldGhvZC5yZXBvcnQuc3VicHJvZmlsZVF1YXJ0ZXJseVJlcG9ydCwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICd3b3JrZXInOlxuICAgICAgICAgICAgICAgICAgICB2YXIgd29ya2VyUG9zc2libGVJdGVtcyA9IFtcInNlbmRXb3JrZXJcIiwgXCJleGVjdXRlTG9jYWxcIiwgXCJjcmVhdGVcIl07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoYWN0aW9uLm1ldGhvZC53b3JrZXIsIHdvcmtlclBvc3NpYmxlSXRlbXMpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NlbmRXb3JrZXInOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUud29ya2VyLnNlbmRXb3JrZXIoYWN0aW9uLm1ldGhvZC53b3JrZXIuc2VuZFdvcmtlciwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZXhlY3V0ZUxvY2FsJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLndvcmtlci5leGVjdXRlTG9jYWwoYWN0aW9uLm1ldGhvZC53b3JrZXIuZXhlY3V0ZUxvY2FsLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjcmVhdGUnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUud29ya2VyLmNyZWF0ZShhY3Rpb24ubWV0aG9kLndvcmtlci5jcmVhdGUsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuXG5cbiAgICAgICAgICAgICAgICBjYXNlICdwYXJ0aWNpcGFudHMnOlxuICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGFydGljaXBhbnRQb3NzaWJsZUl0ZW1zID0gW1wibGlua1BhcnRpY2lwYW50c1wiLCBcIm1vbnRobHlBdHRlbmRhbmNlXCIsIFwibW9udGhseVByb2dyZXNzU3VtbWFyeVwiLCBcInBhcnRpY2lwYW50Q29udHJhY3RzXCJdO1xuXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoYWN0aW9uLm1ldGhvZC5wYXJ0aWNpcGFudHMsIHBhcnRpY2lwYW50UG9zc2libGVJdGVtcykpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbGlua1BhcnRpY2lwYW50cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucGFydGljaXBhbnRzLmxpbmtQYXJ0aWNpcGFudHMoYWN0aW9uLm1ldGhvZC5wYXJ0aWNpcGFudHMubGlua1BhcnRpY2lwYW50cywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW9udGhseUF0dGVuZGFuY2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnBhcnRpY2lwYW50cy5tb250aGx5QXR0ZW5kYW5jZShhY3Rpb24ubWV0aG9kLnBhcnRpY2lwYW50cy5tb250aGx5QXR0ZW5kYW5jZSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW9udGhseVByb2dyZXNzU3VtbWFyeSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucGFydGljaXBhbnRzLm1vbnRobHlQcm9ncmVzc1N1bW1hcnkoYWN0aW9uLm1ldGhvZC5wYXJ0aWNpcGFudHMubW9udGhseVByb2dyZXNzU3VtbWFyeSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3BhcnRpY2lwYW50Q29udHJhY3RzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5wYXJ0aWNpcGFudHMucGFydGljaXBhbnRDb250cmFjdHMoYWN0aW9uLm1ldGhvZC5wYXJ0aWNpcGFudHMucGFydGljaXBhbnRDb250cmFjdHMsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJObyBtZXRob2QgZm91bmQgZnJvbSBpbXBsZW1lbnRlZCBsaXN0LlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJnZW5lcmFsRnVuY3Rpb25zXCI6XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvc3NpYmxlSXRlbXMgPSBbXCJhZGRUb0Zhdm91cml0ZXNcIiwgXCJhZGRUb1VzZXJGYXZvdXJpdGVzXCJdO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2QuZ2VuZXJhbEZ1bmN0aW9ucywgcG9zc2libGVJdGVtcykpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYWRkVG9GYXZvdXJpdGVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5nZW5lcmFsRnVuY3Rpb25zLmFkZFRvRmF2b3VyaXRlcyhhY3Rpb24ubWV0aG9kLmdlbmVyYWxGdW5jdGlvbnMuYWRkVG9GYXZvdXJpdGVzLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYWRkVG9Vc2VyRmF2b3VyaXRlcyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUuZ2VuZXJhbEZ1bmN0aW9ucy5hZGRUb1VzZXJGYXZvdXJpdGVzKGFjdGlvbi5tZXRob2QuZ2VuZXJhbEZ1bmN0aW9ucy5hZGRUb1VzZXJGYXZvdXJpdGVzLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cblxuXG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJtZXRob2Qgbm90IGRlZmluZWQgaW4gY29uZmlndXJhdGlvblwiKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuXG4gICAgICAgIH1cblxuICAgIH0pO1xufTtcblxuLyoqXG4gKiBQcm9jZXNzIHRhc2tzXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IHRhc2sgLSB0aGUgdGFzayBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IGlucHV0RGF0YSAtIHRoZSB1c2VyIGlucHV0IGRhdGFcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIHRhc2soc3VicHJvY2Vzc0lELCBzdWJwcm9jZXNzU0VRLCB0YXNrLCBzcHV1aWQsIG1vZGVsKSB7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgdmFyIF9XRkluc3RhbmNlID0gYXBwLlNDT1BFLndvcmtmbG93O1xuICAgICAgICB2YXIgcHJlQWN0aW9uc0NvbmYgPSB0YXNrLnByZUFjdGlvbnM7XG4gICAgICAgIHByZUFjdGlvbnMocHJlQWN0aW9uc0NvbmYsIF9XRkluc3RhbmNlLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24ocHJlQWN0aW9uUmVzdWx0KSB7XG5cbiAgICAgICAgICAgIHZhciBsaXN0ID0gW107XG5cblxuICAgICAgICAgICAgaWYgKHRhc2suYXNzaWduLnJvbGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFzc2lnblR5cGUgPSAncHJvZmlsZVJvbGUnO1xuICAgICAgICAgICAgICAgIHZhciBwcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHZhciBpZCA9ICcnO1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NUb0Fzc2lnbkV4dGVybmFsID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHJvbGUgPSB0YXNrLmFzc2lnbi5yb2xlLnJvbGVJZDtcbiAgICAgICAgICAgICAgICAgICAgbGlicmFyeS5nZXRVc2Vyc0Zyb21Qcm9maWxlUm9sZShpZCwgcm9sZSkudGhlbihmdW5jdGlvbihsaXN0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaXN0ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpc3QubGVuZ3RoID4gMSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZGluZyByb2xlcyBmcm9tIGV4dGVybmFsIHByb2ZpbGVcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNDdXJyZW50VXNlckV4aXN0SW5HaXZlblJvbGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdWlkID0gbGlzdFtpXS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCA9PSBsaXN0W2ldLmlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNDdXJyZW50VXNlckV4aXN0SW5HaXZlblJvbGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDdXJyZW50VXNlckV4aXN0SW5HaXZlblJvbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhc3NpZ25lZS51c2VySWQgIT0gXCJcIiAmJiBhc3NpZ25lZS5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3T2JqID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhc3NpZ25lZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5LnB1c2gobmV3T2JqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5uYW1lID0gX2xjbHguU0VTU0lPTi5maXJzdE5hbWUgKyBcIiBcIiArIF9sY2x4LlNFU1NJT04ubGFzdE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS51c2VySWQgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUudHlwZSA9IEFTU0lHTk1FTlRfVFlQRV9BVVRPO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuZHVlRGF0ZVRpbWUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmJ5ID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQgKyBcIlwiO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RpZmljYXRpb24gdGhhdCBpdHMgYmVlbiBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHRvIHlvdVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TZW5kIGFzc2lnbiB1c2VyIG5vdGlmaWNhdGlvbiBmcm9tIGhlcmVcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub3RpZmljYXRpb24gPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3VicHJvY2Vzc0lEICsgXCInXS9ub3RpZmljYXRpb25zXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbiAhPSB1bmRlZmluZWQgJiYgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXIgPSB7ICdpZCc6IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkLCAnbmFtZSc6IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcm5hbWUgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2Ygbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQgPT09IFwic3RyaW5nXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnROSWQgPSBub3RpZmljYXRpb24uYXNzaWdubWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5nZXRDb25maWcoYXNzaWdubWVudE5JZCkudGhlbihmdW5jdGlvbihhc3NpZ25tZW50T2JqZWN0KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50ID0gYXNzaWdubWVudE9iamVjdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYXNzaWdubWVudE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25lZCBzdWNjZXNzZnVsbHkuIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5jYXRjaChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihmYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZmFpbCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGZhaWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYXNzaWdubWVudE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWduZWQgc3VjY2Vzc2Z1bGx5LiBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmNhdGNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2suYXNzaWduLmFzc2lnbm1lbnQgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gbW9kZWwuYXNzaWdubWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY2NlcHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93XCI6IHRhc2suYXNzaWduLmFzc2lnbm1lbnQuYWNjZXB0LnNob3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5hY2NlcHQgPSBhY2NlcHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50Lm1lc3NhZ2UgPSBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50Lm1lc3NhZ2UuaTE4bik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1wiOiB0YXNrLmFzc2lnbi5hc3NpZ25tZW50LnJlamVjdC5zaG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIjogX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3QubGFiZWwuaTE4bilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucmVqZWN0ID0gcmVqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IGlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcInVzZXJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBsaXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnByb2ZpbGVSb2xlSWQgPSBpZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ3VycmVudFVzZXJFeGlzdEluR2l2ZW5Sb2xlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0ZpcmUgUHJlLXdvcmtBY3Rpb25zIGhlcmVcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzW3N1YlByb2Nlc3Nlcy91dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzSWQgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbdXVpZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcElkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vc3RlcC9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcElkICsgXCInXVwiLCBfV0ZJbnN0YW5jZS5jb25maWcsIHt9KVswXTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFzay5wcmVXb3JrQWN0aW9ucyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcmVXb3JrQWN0aW9uc09iaiA9IHRhc2sucHJlV29ya0FjdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlV29ya0FjdGlvbnMocHJlV29ya0FjdGlvbnNPYmosIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnQXNzaWdubWVudCBpcyBtYWRlLiBQcmUgd29yayBhY3Rpb25zIGZvdW5kIGFuZCBleGVjdXRlZCAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnQXNzaWdubWVudCBpcyBtYWRlLiBObyBwcmUgd29yayBhY3Rpb25zIGZvdW5kLiAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RpZmljYXRpb24gdGhhdCBpdHMgYmVlbiByZWxlYXNlZCBmb3IgYWNjZXB0YW5jZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm90aWZpY2F0aW9uID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YnByb2Nlc3NJRCArIFwiJ10vbm90aWZpY2F0aW9uc1wiLCBfV0ZJbnN0YW5jZS5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vaXNzdWUgaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbiAhPSB1bmRlZmluZWQgJiYgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VyID0geyAnaWQnOiBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCwgJ25hbWUnOiBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJuYW1lIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYWNjZXB0YW5jZU5vdGlmaWNhdGlvbkV4dGVybmFsKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHNwdXVpZCwgbGlzdCkudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnTm90aWZpY2F0aW9ucyByZXF1ZXN0IHN1Ym1pdHRlZCBmb3IgYWNjZXB0YW5jZS4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ05vdGlmaWNhdGlvbnMgZmFpbGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25tZW50IG5vdGlmaWNhdGlvbiBmYWlsZWQgdG8gdXNlciBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnTm90aWZpY2F0aW9ucyBub3QgZm91bmQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpc3QubGVuZ3RoID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW1wbGVtZW50IGhlcmUgcHJlV29ya0FjdGlvbiBhcyB0aGlzIGlzIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgaW4gY2FzZSBvZiAxIHVzZXIgYW5kIHdpbGwgbm90IGdvIHRyb3VnaCBhY2NlcHRhbmNlIGZ1bmN0aW9uLlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VySWQgPSBsaXN0WzBdLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlcm5hbWUgPSBsaXN0WzBdLm5hbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25lZSA9IG1vZGVsLmFzc2lnbmVkVG87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhc3NpZ25lZS51c2VySWQgIT0gXCJcIiAmJiBhc3NpZ25lZS5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdPYmogPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFzc2lnbmVlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeS5wdXNoKG5ld09iaik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUubmFtZSA9IHVzZXJuYW1lICsgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUudXNlcklkID0gdXNlcklkICsgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUudHlwZSA9IEFTU0lHTk1FTlRfVFlQRV9BVVRPO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5kdWVEYXRlVGltZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5ieSA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFzay5hc3NpZ24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSBtb2RlbC5hc3NpZ25tZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjY2VwdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5hY2NlcHQuc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCI6IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQuYWNjZXB0LmxhYmVsLmkxOG4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LmFjY2VwdCA9IGFjY2VwdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQubWVzc2FnZSA9IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQubWVzc2FnZS5pMThuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWplY3QgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93XCI6IHRhc2suYXNzaWduLmFzc2lnbm1lbnQucmVqZWN0LnNob3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LnJlamVjdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5yZWplY3QgPSByZWplY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogbGlzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJ1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucHJvZmlsZVJvbGVJZCA9IGlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RpZmljYXRpb24gdGhhdCBpdHMgYmVlbiBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHRvIHlvdVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1NlbmQgYXNzaWduIHVzZXIgbm90aWZpY2F0aW9uIGZyb20gaGVyZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub3RpZmljYXRpb24gPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3VicHJvY2Vzc0lEICsgXCInXS9ub3RpZmljYXRpb25zXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uICE9IHVuZGVmaW5lZCAmJiBub3RpZmljYXRpb24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VyID0geyAnaWQnOiB1c2VySWQsICduYW1lJzogdXNlcm5hbWUgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50ID09PSBcInN0cmluZ1wiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnROSWQgPSBub3RpZmljYXRpb24uYXNzaWdubWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0Q29uZmlnKGFzc2lnbm1lbnROSWQpLnRoZW4oZnVuY3Rpb24oYXNzaWdubWVudE9iamVjdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50ID0gYXNzaWdubWVudE9iamVjdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUubm90aWZpY2F0aW9uLmFzc2lnbm1lbnROb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgc3B1dWlkLCB1c2VyKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5jYXRjaChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25tZW50IG5vdGlmaWNhdGlvbiBmYWlsZWQgdG8gdXNlciBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihmYWlsKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShmYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUubm90aWZpY2F0aW9uLmFzc2lnbm1lbnROb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgc3B1dWlkLCB1c2VyKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25lZCBzdWNjZXNzZnVsbHkuIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmNhdGNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihmYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25tZW50IG5vdGlmaWNhdGlvbiBmYWlsZWQgdG8gdXNlciBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9GaXJlIFByZS13b3JrQWN0aW9ucyBoZXJlXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzW3N1YlByb2Nlc3Nlcy91dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1t1dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBJZCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3N0ZXAvaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcElkICsgXCInXVwiLCBfV0ZJbnN0YW5jZS5jb25maWcsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFzay5wcmVXb3JrQWN0aW9ucyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZVdvcmtBY3Rpb25zT2JqID0gdGFzay5wcmVXb3JrQWN0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZVdvcmtBY3Rpb25zKHByZVdvcmtBY3Rpb25zT2JqLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnQXNzaWduZWQgdG8gdGhlIG9ubHkgdXNlciBpbiByb2xlLiBQcmUgd29yayBhY3Rpb25zIGV4ZWN1dGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdBc3NpZ25lZCB0byB0aGUgb25seSB1c2VyIGluIHJvbGUuIE5vIHByZSB3b3JrIGFjdGlvbnMgZm91bmQuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vQ2FzZSB3aGVyZSB1c2VycyBsaXN0ID0gMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWduZWUgPSBtb2RlbC5hc3NpZ25lZFRvO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5uYW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUudXNlcklkID0gXCJcIjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFzay5hc3NpZ24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSBtb2RlbC5hc3NpZ25tZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjY2VwdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5hY2NlcHQuc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCI6IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQuYWNjZXB0LmxhYmVsLmkxOG4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LmFjY2VwdCA9IGFjY2VwdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQubWVzc2FnZSA9IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQubWVzc2FnZS5pMThuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWplY3QgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93XCI6IHRhc2suYXNzaWduLmFzc2lnbm1lbnQucmVqZWN0LnNob3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LnJlamVjdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5yZWplY3QgPSByZWplY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogbGlzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJ1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucHJvZmlsZVJvbGVJZCA9IGlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9XaWxsIGJlIGZpcmVkIGZyb20gVGFrZUFzc2lnbm1lbnQgcGF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFwiTm8gdXNlcnMgZm91bmQgaW4gbGlzdC4gQXNzaWduaW5nIGJsYW5rIFwiKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoJ0Vycm9yIGluIGdldFVzZXJzRnJvbVByb2ZpbGVSb2xlICcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzVG9Bc3NpZ24gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJvbGUgPSB0YXNrLmFzc2lnbi5yb2xlLnJvbGVJZDtcbiAgICAgICAgICAgICAgICAgICAgbGlicmFyeS5nZXRVc2Vyc0xpc3RCeVJvbGUoaWQsIHJvbGUpLnRoZW4oZnVuY3Rpb24obGlzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpc3QgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGlzdC5sZW5ndGggPiAxKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTmV3IHJlcXVpcmVtZW50IGhlcmUgd2lsbCBhdXRvbWF0aWNhbGx5IGFzc2lnbiB0aGUgc3RlcCB0byBjdXJyZW50IHVzZXIgaWYgdGhpcyB1c2VyIGZhbGxzIHVuZGVyIHRoZSBwcm92aWRlZCBncm91cC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUlVMRSBJTlRST0RVQ0VEIE9OIDE2LU1BUkNILTIwMTdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgY3VycmVudCB1c2VyIGxpZXMgd2l0aGluIHRoZSBzcGVjaWZpZWQgcm9sZSwgaXQgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHRvIHRoYXQgdXNlci5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNDdXJyZW50VXNlckV4aXN0SW5HaXZlblJvbGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJvbGVzT2JqZWN0ID0gbGlicmFyeS5nZXRDdXJyZW50VXNlclJvbGVzKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQ3VycmVudFVzZXJSb2xlMSA9IHJvbGVzT2JqZWN0LnByb2ZpbGUuaW5kZXhPZihyb2xlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQ3VycmVudFVzZXJSb2xlMiA9IHJvbGVzT2JqZWN0LmNvbW11bml0eS5pbmRleE9mKHJvbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNDdXJyZW50VXNlclJvbGUzID0gcm9sZXNPYmplY3QuaW1wbGljaXQuaW5kZXhPZihyb2xlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQ3VycmVudFVzZXJSb2xlNCA9IHJvbGVzT2JqZWN0LmFkb3B0aW9uLmluZGV4T2Yocm9sZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc0N1cnJlbnRVc2VyUm9sZTUgPSByb2xlc09iamVjdC5zdWJwcm9maWxlLmluZGV4T2Yocm9sZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ3VycmVudFVzZXJSb2xlMSA+IC0xIHx8IGlzQ3VycmVudFVzZXJSb2xlMiA+IC0xIHx8IGlzQ3VycmVudFVzZXJSb2xlMyA+IC0xIHx8IGlzQ3VycmVudFVzZXJSb2xlNCA+IC0xIHx8IGlzQ3VycmVudFVzZXJSb2xlNSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0N1cnJlbnRVc2VyRXhpc3RJbkdpdmVuUm9sZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0N1cnJlbnRVc2VyRXhpc3RJbkdpdmVuUm9sZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ3VycmVudFVzZXJFeGlzdEluR2l2ZW5Sb2xlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25lZSA9IG1vZGVsLmFzc2lnbmVkVG87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXNzaWduZWUudXNlcklkICE9IFwiXCIgJiYgYXNzaWduZWUubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld09iaiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXNzaWduZWUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeS5wdXNoKG5ld09iaik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUubmFtZSA9IF9sY2x4LlNFU1NJT04uZmlyc3ROYW1lICsgXCIgXCIgKyBfbGNseC5TRVNTSU9OLmxhc3ROYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUudXNlcklkID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQgKyBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLnR5cGUgPSBBU1NJR05NRU5UX1RZUEVfQVVUTztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmR1ZURhdGVUaW1lID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5ieSA9IF9sY2x4LlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90aWZpY2F0aW9uIHRoYXQgaXRzIGJlZW4gYXV0b21hdGljYWxseSBhc3NpZ25lZCB0byB5b3VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU2VuZCBhc3NpZ24gdXNlciBub3RpZmljYXRpb24gZnJvbSBoZXJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm90aWZpY2F0aW9uID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YnByb2Nlc3NJRCArIFwiJ10vbm90aWZpY2F0aW9uc1wiLCBfV0ZJbnN0YW5jZS5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24gIT0gdW5kZWZpbmVkICYmIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VyID0geyAnaWQnOiBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCwgJ25hbWUnOiBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJuYW1lIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50ID09PSBcInN0cmluZ1wiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50TklkID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0Q29uZmlnKGFzc2lnbm1lbnROSWQpLnRoZW4oZnVuY3Rpb24oYXNzaWdubWVudE9iamVjdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb24uYXNzaWdubWVudCA9IGFzc2lnbm1lbnRPYmplY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUubm90aWZpY2F0aW9uLmFzc2lnbm1lbnROb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgc3B1dWlkLCB1c2VyKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWduZWQgc3VjY2Vzc2Z1bGx5LiBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25tZW50IG5vdGlmaWNhdGlvbiBmYWlsZWQgdG8gdXNlciBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGZhaWwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShmYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUubm90aWZpY2F0aW9uLmFzc2lnbm1lbnROb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgc3B1dWlkLCB1c2VyKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5jYXRjaChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25tZW50IG5vdGlmaWNhdGlvbiBmYWlsZWQgdG8gdXNlciBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFzay5hc3NpZ24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSBtb2RlbC5hc3NpZ25tZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjY2VwdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5hY2NlcHQuc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCI6IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQuYWNjZXB0LmxhYmVsLmkxOG4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LmFjY2VwdCA9IGFjY2VwdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQubWVzc2FnZSA9IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQubWVzc2FnZS5pMThuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWplY3QgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93XCI6IHRhc2suYXNzaWduLmFzc2lnbm1lbnQucmVqZWN0LnNob3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LnJlamVjdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5yZWplY3QgPSByZWplY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogcHJvZmlsZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicm9sZUlkXCI6IHJvbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwicm9sZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnByb2ZpbGVSb2xlSWQgPSBpZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0N1cnJlbnRVc2VyRXhpc3RJbkdpdmVuUm9sZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9GaXJlIFByZS13b3JrQWN0aW9ucyBoZXJlXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzSWQgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlc1tzdWJQcm9jZXNzZXMvdXVpZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBJZCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3N0ZXAvaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgcHJvY2Vzc0lkICsgXCInXS9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NJZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2sucHJlV29ya0FjdGlvbnMgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJlV29ya0FjdGlvbnNPYmogPSB0YXNrLnByZVdvcmtBY3Rpb25zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZVdvcmtBY3Rpb25zKHByZVdvcmtBY3Rpb25zT2JqLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ0Fzc2lnbm1lbnQgaXMgbWFkZS4gUHJlIHdvcmsgYWN0aW9ucyBmb3VuZCBhbmQgZXhlY3V0ZWQgJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ0Fzc2lnbm1lbnQgaXMgbWFkZS4gTm8gcHJlIHdvcmsgYWN0aW9ucyBmb3VuZC4gJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90aWZpY2F0aW9uIHRoYXQgaXRzIGJlZW4gcmVsZWFzZWQgZm9yIGFjY2VwdGFuY2VcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJwcm9jZXNzSUQgKyBcIiddL25vdGlmaWNhdGlvbnNcIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2lzc3VlIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24gIT0gdW5kZWZpbmVkICYmIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlciA9IHsgJ2lkJzogX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQsICduYW1lJzogX2xjbHguU1VCU0NSSVBUSU9OUy51c2VybmFtZSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2Ygbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlID09PSBcInN0cmluZ1wiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50TklkID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLmdldENvbmZpZyhhc3NpZ25tZW50TklkKS50aGVuKGZ1bmN0aW9uKGFzc2lnbm1lbnRPYmplY3Qpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlID0gYXNzaWdubWVudE9iamVjdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYWNjZXB0YW5jZU5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHJvbGUpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnTm90aWZpY2F0aW9ucyByZXF1ZXN0IHN1Ym1pdHRlZCBmb3IgYWNjZXB0YW5jZS4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmNhdGNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnTm90aWZpY2F0aW9ucyBmYWlsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWdubWVudCBub3RpZmljYXRpb24gZmFpbGVkIHRvIHVzZXIgVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZmFpbCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGZhaWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUubm90aWZpY2F0aW9uLmFjY2VwdGFuY2VOb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgc3B1dWlkLCByb2xlKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ05vdGlmaWNhdGlvbnMgcmVxdWVzdCBzdWJtaXR0ZWQgZm9yIGFjY2VwdGFuY2UuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihmYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnTm90aWZpY2F0aW9ucyBmYWlsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25tZW50IG5vdGlmaWNhdGlvbiBmYWlsZWQgdG8gdXNlciBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdOb3RpZmljYXRpb25zIG5vdCBmb3VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGlzdC5sZW5ndGggPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbXBsZW1lbnQgaGVyZSBwcmVXb3JrQWN0aW9uIGFzIHRoaXMgaXMgYXV0b21hdGljYWxseSBhc3NpZ25lZCBpbiBjYXNlIG9mIDEgdXNlciBhbmQgd2lsbCBub3QgZ28gdHJvdWdoIGFjY2VwdGFuY2UgZnVuY3Rpb24uXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGxpc3RbMF0uaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VybmFtZSA9IGxpc3RbMF0ubmFtZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFzc2lnbmVlLnVzZXJJZCAhPSBcIlwiICYmIGFzc2lnbmVlLm5hbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld09iaiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXNzaWduZWUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5LnB1c2gobmV3T2JqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5uYW1lID0gdXNlcm5hbWUgKyBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS51c2VySWQgPSB1c2VySWQgKyBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS50eXBlID0gQVNTSUdOTUVOVF9UWVBFX0FVVE87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmR1ZURhdGVUaW1lID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmJ5ID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQgKyBcIlwiO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLmFzc2lnbi5hc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudCA9IG1vZGVsLmFzc2lnbm1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWNjZXB0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1wiOiB0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5zaG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIjogX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5hY2NlcHQubGFiZWwuaTE4bilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQuYWNjZXB0ID0gYWNjZXB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5tZXNzYWdlID0gX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5tZXNzYWdlLmkxOG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3Quc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCI6IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQucmVqZWN0LmxhYmVsLmkxOG4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnJlamVjdCA9IHJlamVjdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBwcm9maWxlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJyb2xlSWRcIjogcm9sZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJyb2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucHJvZmlsZVJvbGVJZCA9IGlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RpZmljYXRpb24gdGhhdCBpdHMgYmVlbiBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHRvIHlvdVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1NlbmQgYXNzaWduIHVzZXIgbm90aWZpY2F0aW9uIGZyb20gaGVyZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub3RpZmljYXRpb24gPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3VicHJvY2Vzc0lEICsgXCInXS9ub3RpZmljYXRpb25zXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uICE9IHVuZGVmaW5lZCAmJiBub3RpZmljYXRpb24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VyID0geyAnaWQnOiB1c2VySWQsICduYW1lJzogdXNlcm5hbWUgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2Ygbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQgPT09IFwic3RyaW5nXCIpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudE5JZCA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5nZXRDb25maWcoYXNzaWdubWVudE5JZCkudGhlbihmdW5jdGlvbihhc3NpZ25tZW50T2JqZWN0KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQgPSBhc3NpZ25tZW50T2JqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYXNzaWdubWVudE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWduZWQgc3VjY2Vzc2Z1bGx5LiBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmNhdGNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGZhaWwpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGZhaWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYXNzaWdubWVudE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0ZpcmUgUHJlLXdvcmtBY3Rpb25zIGhlcmVcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXNbc3ViUHJvY2Vzc2VzL3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcElkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vc3RlcC9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHByb2Nlc3NJZCArIFwiJ10vc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzSWQgKyBcIiddL3N0ZXBzW19pZCBlcSAnXCIgKyBzdGVwSWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLnByZVdvcmtBY3Rpb25zICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJlV29ya0FjdGlvbnNPYmogPSB0YXNrLnByZVdvcmtBY3Rpb25zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlV29ya0FjdGlvbnMocHJlV29ya0FjdGlvbnNPYmosIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdBc3NpZ25lZCB0byB0aGUgb25seSB1c2VyIGluIHJvbGUuIFByZSB3b3JrIGFjdGlvbnMgZXhlY3V0ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ0Fzc2lnbmVkIHRvIHRoZSBvbmx5IHVzZXIgaW4gcm9sZS4gTm8gcHJlIHdvcmsgYWN0aW9ucyBmb3VuZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9DYXNlIHdoZXJlIHVzZXJzIGxpc3QgPSAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25lZSA9IG1vZGVsLmFzc2lnbmVkVG87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLm5hbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS51c2VySWQgPSBcIlwiO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLmFzc2lnbi5hc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudCA9IG1vZGVsLmFzc2lnbm1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWNjZXB0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1wiOiB0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5zaG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIjogX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5hY2NlcHQubGFiZWwuaTE4bilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQuYWNjZXB0ID0gYWNjZXB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5tZXNzYWdlID0gX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5tZXNzYWdlLmkxOG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3Quc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCI6IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQucmVqZWN0LmxhYmVsLmkxOG4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnJlamVjdCA9IHJlamVjdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBwcm9maWxlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJyb2xlSWRcIjogcm9sZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJyb2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucHJvZmlsZVJvbGVJZCA9IGlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9XaWxsIGJlIGZpcmVkIGZyb20gVGFrZUFzc2lnbm1lbnQgcGF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFwiTm8gdXNlcnMgZm91bmQgaW4gbGlzdC4gQXNzaWduaW5nIGJsYW5rIFwiKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaWYgKHRhc2suYXNzaWduLnJvbGUucHJvZmlsZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodGFzay5hc3NpZ24ucm9sZS5wcm9maWxlID09ICdjdXJyZW50Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRhc2suYXNzaWduLnJvbGUucHJvZmlsZSA9PSAnY29tbXVuaXR5Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBwcm9jZXNzVG9Bc3NpZ24oKTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGFzay5hc3NpZ24ucm9sZS5wcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZSh0YXNrLmFzc2lnbi5yb2xlLnByb2ZpbGVJZCwgX1dGSW5zdGFuY2UsIHNwdXVpZCkudGhlbihmdW5jdGlvbihmb3JtUHJvZmlsZUlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZCA9IGZvcm1Qcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzVG9Bc3NpZ25FeHRlcm5hbCgpO1xuICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH1cblxuXG5cblxuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrLmFzc2lnbi51c2VyICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZSh0YXNrLmFzc2lnbi51c2VyLnVzZXJOYW1lLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHVzZXJOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUodGFzay5hc3NpZ24udXNlci51c2VySWQsIF9XRkluc3RhbmNlLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24odXNlcklkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VySWQgPSB1c2VySWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlcm5hbWUgPSB1c2VyTmFtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25lZSA9IG1vZGVsLmFzc2lnbmVkVG87XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXNzaWduZWUudXNlcklkICE9IFwiXCIgJiYgYXNzaWduZWUubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld09iaiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXNzaWduZWUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeS5wdXNoKG5ld09iaik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5uYW1lID0gdXNlcm5hbWUgKyBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUudXNlcklkID0gdXNlcklkICsgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS50eXBlID0gQVNTSUdOTUVOVF9UWVBFX0FVVE87XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5kdWVEYXRlVGltZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuYnkgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFzay5hc3NpZ24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gbW9kZWwuYXNzaWdubWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWNjZXB0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5hY2NlcHQuc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LmFjY2VwdCA9IGFjY2VwdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50Lm1lc3NhZ2UgPSBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50Lm1lc3NhZ2UuaTE4bik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93XCI6IHRhc2suYXNzaWduLmFzc2lnbm1lbnQucmVqZWN0LnNob3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIjogX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3QubGFiZWwuaTE4bilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogdXNlcklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB1c2VyTmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaXN0LnB1c2goaSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnJlamVjdCA9IHJlamVjdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IHByb2ZpbGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogbGlzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwidXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuXG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucHJvZmlsZVJvbGVJZCA9IGlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RpZmljYXRpb24gdGhhdCBpdHMgYmVlbiBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHRvIHlvdVxuICAgICAgICAgICAgICAgICAgICAgICAgLy9TZW5kIGFzc2lnbiB1c2VyIG5vdGlmaWNhdGlvbiBmcm9tIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub3RpZmljYXRpb24gPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3VicHJvY2Vzc0lEICsgXCInXS9ub3RpZmljYXRpb25zXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbiAhPSB1bmRlZmluZWQgJiYgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXIgPSB7ICdpZCc6IHVzZXJJZCwgJ25hbWUnOiB1c2VybmFtZSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBub3RpZmljYXRpb24uYXNzaWdubWVudCA9PT0gXCJzdHJpbmdcIil7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudE5JZCA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLmdldENvbmZpZyhhc3NpZ25tZW50TklkKS50aGVuKGZ1bmN0aW9uKGFzc2lnbm1lbnRPYmplY3Qpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQgPSBhc3NpZ25tZW50T2JqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLm5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Tm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHNwdXVpZCwgdXNlcikudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmNhdGNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWdubWVudCBub3RpZmljYXRpb24gZmFpbGVkIHRvIHVzZXIgVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihmYWlsKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZmFpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLm5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Tm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHNwdXVpZCwgdXNlcikudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25lZCBzdWNjZXNzZnVsbHkuIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihmYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWdubWVudCBub3RpZmljYXRpb24gZmFpbGVkIHRvIHVzZXIgVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy9GaXJlIFByZS13b3JrQWN0aW9ucyBoZXJlXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXNbc3ViUHJvY2Vzc2VzL3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1t1dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBJZCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3N0ZXAvaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgcHJvY2Vzc0lkICsgXCInXS9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NJZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLnByZVdvcmtBY3Rpb25zICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZVdvcmtBY3Rpb25zT2JqID0gdGFzay5wcmVXb3JrQWN0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVXb3JrQWN0aW9ucyhwcmVXb3JrQWN0aW9uc09iaiwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdBc3NpZ25lZCB0byB0aGUgb25seSB1c2VyIGluIHJvbGUuIFByZSB3b3JrIGFjdGlvbnMgZXhlY3V0ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnQXNzaWduZWQgdG8gdGhlIG9ubHkgdXNlciBpbiByb2xlLiBObyBwcmUgd29yayBhY3Rpb25zIGZvdW5kLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrLmFzc2lnbi5zd2ltbGFuZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzdGVwSWQgPSB0YXNrLmFzc2lnbi5zd2ltbGFuZS5zdGVwSWQ7XG4gICAgICAgICAgICAgICAgdmFyIHNlcXVlbmNlID0gdGFzay5hc3NpZ24uc3dpbWxhbmUuc2VxdWVuY2U7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2VzcyA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB2YXIgaGlzdG9yeUxpc3QgPSBKU09OLnhwYXRoKFwiL2hpc3RvcnlbaWQgZXEgJ1wiICsgc3RlcElkICsgXCInXVwiLCBzdWJQcm9jZXNzLCB7fSk7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGVTZWFyY2ggPSAnJztcbiAgICAgICAgICAgICAgICBpZiAoc2VxdWVuY2UgPT0gJ2xhc3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIGRhdGVTZWFyY2ggPSBKU09OLnhwYXRoKFwibWF4KGZvciAkcyBpbiAvKiByZXR1cm4geHM6ZGF0ZVRpbWUoJHMvZGF0ZVRpbWVDcmVhdGVkKSlcIiwgaGlzdG9yeUxpc3QsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBkYXRlU2VhcmNoID0gSlNPTi54cGF0aChcIm1pbihmb3IgJHMgaW4gLyogcmV0dXJuIHhzOmRhdGVUaW1lKCRzL2RhdGVUaW1lQ3JlYXRlZCkpXCIsIGhpc3RvcnlMaXN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBoaXN0b3J5T2JqZWN0ID0gSlNPTi54cGF0aChcIi8qW3hzOmRhdGVUaW1lKGRhdGVUaW1lQ3JlYXRlZCkgZXEgeHM6ZGF0ZVRpbWUoJ1wiICsgZGF0ZVNlYXJjaCArIFwiJyldXCIsIGhpc3RvcnlMaXN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2Fzc2lnbm1lbnRIaXN0b3J5W2xhc3QoKV1cIiwgaGlzdG9yeU9iamVjdCwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJJZCA9IGFzc2lnbm1lbnRPYmplY3QudXNlcklkO1xuICAgICAgICAgICAgICAgIHZhciB1c2VybmFtZSA9IGFzc2lnbm1lbnRPYmplY3QubmFtZTtcblxuICAgICAgICAgICAgICAgIGlmIChtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgYXNzaWduZWUgPSBtb2RlbC5hc3NpZ25lZFRvO1xuICAgICAgICAgICAgICAgIGlmIChhc3NpZ25lZS51c2VySWQgIT0gXCJcIiAmJiBhc3NpZ25lZS5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld09iaiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXNzaWduZWUpKTtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkucHVzaChuZXdPYmopO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhc3NpZ25lZS5uYW1lID0gdXNlcm5hbWUgKyBcIlwiO1xuICAgICAgICAgICAgICAgIGFzc2lnbmVlLnVzZXJJZCA9IHVzZXJJZCArIFwiXCI7XG4gICAgICAgICAgICAgICAgYXNzaWduZWUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICBhc3NpZ25lZS50eXBlID0gQVNTSUdOTUVOVF9UWVBFX1NXSU1MQU5FO1xuICAgICAgICAgICAgICAgIGFzc2lnbmVlLmR1ZURhdGVUaW1lID0gJyc7XG4gICAgICAgICAgICAgICAgYXNzaWduZWUuYnkgPSBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG5cbiAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudCA9ICcnO1xuXG4gICAgICAgICAgICAgICAgLy8gTm90aWZpY2F0aW9uIHRoYXQgaXRzIGJlZW4gYXV0b21hdGljYWxseSBhc3NpZ25lZCB0byB5b3VcbiAgICAgICAgICAgICAgICAvL1NlbmQgYXNzaWduIHVzZXIgbm90aWZpY2F0aW9uIGZyb20gaGVyZVxuICAgICAgICAgICAgICAgIHZhciBub3RpZmljYXRpb24gPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3VicHJvY2Vzc0lEICsgXCInXS9ub3RpZmljYXRpb25zXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24gIT0gdW5kZWZpbmVkICYmIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXNlciA9IHsgJ2lkJzogdXNlcklkLCAnbmFtZSc6IHVzZXJuYW1lIH07XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50ID09PSBcInN0cmluZ1wiKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudE5JZCA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0Q29uZmlnKGFzc2lnbm1lbnROSWQpLnRoZW4oZnVuY3Rpb24oYXNzaWdubWVudE9iamVjdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQgPSBhc3NpZ25tZW50T2JqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUubm90aWZpY2F0aW9uLmFzc2lnbm1lbnROb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgc3B1dWlkLCB1c2VyKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25lZCBzdWNjZXNzZnVsbHkuIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmNhdGNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihmYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25tZW50IG5vdGlmaWNhdGlvbiBmYWlsZWQgdG8gdXNlciBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZmFpbCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShmYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUubm90aWZpY2F0aW9uLmFzc2lnbm1lbnROb3RpZmljYXRpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgc3B1dWlkLCB1c2VyKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWduZWQgc3VjY2Vzc2Z1bGx5LiBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oZmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25tZW50IG5vdGlmaWNhdGlvbiBmYWlsZWQgdG8gdXNlciBVc2VySWQ6IFwiJyArIHVzZXIuaWQgKyAnXCIsIE5hbWU6IFwiJyArIHVzZXIubmFtZSArICdcIicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vRmlyZSBQcmUtd29ya0FjdGlvbnMgaGVyZVxuICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzSWQgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlc1tzdWJQcm9jZXNzZXMvdXVpZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1t1dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgc3RlcElkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vc3RlcC9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgcHJvY2Vzc0lkICsgXCInXS9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NJZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICBpZiAodGFzay5wcmVXb3JrQWN0aW9ucyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgcHJlV29ya0FjdGlvbnNPYmogPSB0YXNrLnByZVdvcmtBY3Rpb25zO1xuICAgICAgICAgICAgICAgICAgICBwcmVXb3JrQWN0aW9ucyhwcmVXb3JrQWN0aW9uc09iaiwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnQXNzaWduZWQgdG8gdGhlIG9ubHkgdXNlciBpbiByb2xlLiBQcmUgd29yayBhY3Rpb25zIGV4ZWN1dGVkJyk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnQXNzaWduZWQgdG8gdGhlIG9ubHkgdXNlciBpbiByb2xlLiBObyBwcmUgd29yayBhY3Rpb25zIGZvdW5kLicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuXG5cblxuLyoqXG4gKiBQcm9jZXNzIHRhc2tzXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IHRhc2sgLSB0aGUgdGFzayBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IGlucHV0RGF0YSAtIHRoZSB1c2VyIGlucHV0IGRhdGFcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIHNlcnZlcihzZXJ2ZXIsIHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdWJQcm9jZXNzLCBtb2RlbCwgX1dGSW5zdGFuY2UsIGRhdGEsIHV1aWQpIHtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAvL3ZhciBfV0ZJbnN0YW5jZSA9IGFwcC5TQ09QRS53b3JrZmxvdztcbiAgICAgICAgdmFyIHByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgIHZhciBhY3Rpb25CbG9jayA9IHNlcnZlci5zZXJ2ZXJBY3Rpb25bMF07XG4gICAgICAgIGlmIChtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID0gW107XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgYXNzaWduZWUgPSBtb2RlbC5hc3NpZ25lZFRvO1xuICAgICAgICBpZiAoYXNzaWduZWUudXNlcklkICE9IFwiXCIgJiYgYXNzaWduZWUubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICB2YXIgbmV3T2JqID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhc3NpZ25lZSkpO1xuICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkucHVzaChuZXdPYmopO1xuICAgICAgICB9XG4gICAgICAgIGFzc2lnbmVlLm5hbWUgPSBfbGNseC5TRVNTSU9OLmZpcnN0TmFtZSArIFwiIFwiICsgX2xjbHguU0VTU0lPTi5sYXN0TmFtZTtcbiAgICAgICAgYXNzaWduZWUudXNlcklkID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQgKyBcIlwiO1xuICAgICAgICBhc3NpZ25lZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICBhc3NpZ25lZS50eXBlID0gQVNTSUdOTUVOVF9UWVBFX0FVVE87XG4gICAgICAgIGFzc2lnbmVlLmR1ZURhdGVUaW1lID0gJyc7XG4gICAgICAgIGFzc2lnbmVlLmJ5ID0gX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWQgKyBcIlwiO1xuXG4gICAgICAgIGFjdGlvbihhY3Rpb25CbG9jaywgcHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN1YlByb2Nlc3MsIG1vZGVsLCBfV0ZJbnN0YW5jZSwgZGF0YSwgdXVpZClcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoXCJObyB1c2VycyBmb3VuZCBpbiBsaXN0LiBBc3NpZ25pbmcgYmxhbmsgXCIpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KFwiU2VydmVyIGFjdGlvbiBlcnJvciBmb3VuZCByZWplY3RlZFwiKVxuICAgICAgICAgICAgfSk7XG4gICAgfSk7XG5cbn07XG5cbi8qKlxuICogUHJvY2VzcyB0cmFuc2l0aW9uXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBwcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3ViUHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3ViLXByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdWJQcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHN1Yi1wcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN0ZXBJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN0ZXAgaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSB0cmFuc2l0aW9uSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiB0cmFuc2l0aW9uIGlkXG4gKiBAcGFyYW0ge29iamVjdH0gZGF0YSAtIGFueSBhZGRpdGlvbmFsIGRhdGEgcGFzc2VkIGluIGFzIGtleSB2YWx1ZSBwYWlyc1xuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIHRyYW5zaXRpb24ocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN0ZXBJZCwgdHJhbnNpdGlvbklkLCBkYXRhLCBfV0ZJbnN0YW5jZSwgc3B1dWlkLCBtb2RlbCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBzdGVwU2VxID0gMDtcbiAgICAgICAgICAgIHZhciBuZXh0U3RlcElkID0gJyc7XG4gICAgICAgICAgICB2YXIgbmV4dFN0ZXBTZXEgPSAwO1xuICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UHJvY2VzcyA9IF9XRkluc3RhbmNlLmNvbmZpZy5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialByb2Nlc3MpIHtcbiAgICAgICAgICAgICAgICBpZiAob2JqUHJvY2Vzcy5faWQgPT0gcHJvY2Vzc0lkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmpQcm9jZXNzO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgY3VycmVudFN1YlByb2Nlc3MgPSBjdXJyZW50UHJvY2Vzc1swXS5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialN1YlByb2Nlc3MpIHtcbiAgICAgICAgICAgICAgICBpZiAob2JqU3ViUHJvY2Vzcy5faWQgPT0gc3ViUHJvY2Vzc0lkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmpTdWJQcm9jZXNzO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgY3VycmVudFN0ZXAgPSBjdXJyZW50U3ViUHJvY2Vzc1swXS5zdGVwcy5maWx0ZXIoZnVuY3Rpb24ob2JqU3RlcCkge1xuICAgICAgICAgICAgICAgIGlmIChvYmpTdGVwLl9pZCA9PSBzdGVwSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9ialN0ZXA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZhciB0cmFuc2l0aW9uID0gY3VycmVudFN0ZXBbMF0udHJhbnNpdGlvbi5maWx0ZXIoZnVuY3Rpb24ob2JqVHJhbnNpdGlvbikge1xuICAgICAgICAgICAgICAgIGlmIChvYmpUcmFuc2l0aW9uLl9pZCA9PSB0cmFuc2l0aW9uSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9ialRyYW5zaXRpb247XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHNbaV0uX2lkID09IHN0ZXBJZCkge1xuICAgICAgICAgICAgICAgICAgICBzdGVwU2VxID0gcGFyc2VJbnQoY3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHNbaV0uX3NlcSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGN1cnJlbnRTdWJQcm9jZXNzWzBdLnN0ZXBzLmZpbHRlcihmdW5jdGlvbihzdGVwSXRlbSkge1xuICAgICAgICAgICAgICAgIG5leHRTdGVwU2VxID0gc3RlcFNlcSArIDE7XG4gICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KHN0ZXBJdGVtLl9zZXEpID09IG5leHRTdGVwU2VxKSB7XG4gICAgICAgICAgICAgICAgICAgIG5leHRTdGVwSWQgPSBzdGVwSXRlbS5faWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KVxuXG5cblxuXG4gICAgICAgICAgICB2YXIgbWF4U3RlcHMgPSBjdXJyZW50U3ViUHJvY2Vzc1swXS5zdGVwcy5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgc3BpbnN0YW5jZU9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgc3BJbnN0YW5jZVN0ZXBPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9zdGVwXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgIC8vIEFkZGluZyBzdGVwIE9iamVjdCBpbiBzdWJwcm9jZXNzIGhpc3RvcnkgRnJvbSBzZWNvbmQgc3RlcC4gQXMgZmlyc3Qgc3RlcCBpcyBhZGRlZCBhdCBzdWJQcm9jZXNzKCkgZnVuY3Rpb24gXG4gICAgICAgICAgICBpZiAoc3BpbnN0YW5jZU9iamVjdC5oaXN0b3J5ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHNwaW5zdGFuY2VPYmplY3QuaGlzdG9yeSA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHB1c2hJbmRpY2F0b3JUb01vZGVsID0gZnVuY3Rpb24obW9kZWwpIHtcblxuICAgICAgICAgICAgICAgIC8vIEluIGJvdGggIHRoZSBjYXNlcyB0aGUgbGlzdCBpcyBkaWZmZXJuZXQgdGhhdCBuZWVkcyB0byBiZSBtYWRlIHNhbWUuXG5cbiAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yTGlzdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2luZGljYXRvcnNcIiwgX1dGSW5zdGFuY2UsIHt9KTtcblxuICAgICAgICAgICAgICAgIHZhciBpc0ZpcnN0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKGluZGljYXRvckxpc3QgPT0gdW5kZWZpbmVkIHx8IGluZGljYXRvckxpc3QubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaXNGaXJzdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGluZGljYXRvckxpc3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbd29ya2Zsb3dzL3Byb2Nlc3Nlc1tzdWJQcm9jZXNzVVVJRCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddXVwiLCBfV0ZJbnN0YW5jZSwge30pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobW9kZWwuaW5kaWNhdG9ycyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWwuaW5kaWNhdG9ycyA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGluZGljYXRvckxpc3QubGVuZ3RoOyBqKyspIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNGaXJzdCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXVpZCA9IGluZGljYXRvckxpc3Rbal0uX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJldiA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vX3JldlwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlcSA9IGluZGljYXRvckxpc3Rbal0ubW9kZWwucGVuZGluZy5zZXE7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhdHVzID0gaW5kaWNhdG9yTGlzdFtqXS5tb2RlbC5wZW5kaW5nLnN0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXVpZDogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXY6IHJldixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXE6IHNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHN0YXR1c1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuaW5kaWNhdG9ycy5wdXNoKGluZE9iamVjdCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHV1aWQgPSBpbmRpY2F0b3JMaXN0W2pdLmluc3RhbmNlc1swXS51dWlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJldiA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vX3JldlwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlcSA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vbW9kZWwvcGVuZGluZy9zZXFcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL21vZGVsL3BlbmRpbmcvc3RhdHVzXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV1aWQ6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2OiByZXYsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VxOiBzZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBzdGF0dXNcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmluZGljYXRvcnMucHVzaChpbmRPYmplY3QpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGVsZXRlIG1vZGVsLmFzc2lnbmVkVG87XG4gICAgICAgICAgICAgICAgZGVsZXRlIG1vZGVsLmFzc2lnbm1lbnQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vZGVsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBhZGQgaW5mb3JtYXRpb24gdG8gdHJhbnN0aW9uIG9iamVjdC5cbiAgICAgICAgICAgIHZhciB0cm5PYmplY3QgPSB7XG4gICAgICAgICAgICAgICAgdHJhbnNpdGlvbklkOiB0cmFuc2l0aW9uWzBdLl9pZCxcbiAgICAgICAgICAgICAgICBkYXRlVGltZTogbW9tZW50KCkuZm9ybWF0KCksXG4gICAgICAgICAgICAgICAgdXNlcklkOiBfbGNseC5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChtb2RlbCAhPSB1bmRlZmluZWQgJiYgT2JqZWN0LmtleXMobW9kZWwpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBtb2RlbC50cmFuc2l0aW9uID0gdHJuT2JqZWN0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzcEluc3RhbmNlU3RlcE9iamVjdC50cmFuc2l0aW9uID0gdHJuT2JqZWN0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBjb3B5IGN1cnJlbnQgYXNzaWduZWRUbyB0byByZUFzc2lnbm1lbnQgb2JqZWN0XG5cbiAgICAgICAgICAgIGlmIChtb2RlbCAhPSB1bmRlZmluZWQgJiYgT2JqZWN0LmtleXMobW9kZWwpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBpZiAobW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBhc3NpZ25lZU9iaiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkobW9kZWwuYXNzaWduZWRUbykpO1xuICAgICAgICAgICAgICAgIGlmIChhc3NpZ25lZU9iai51c2VySWQgIT0gXCJcIiAmJiBhc3NpZ25lZU9iai5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkucHVzaChhc3NpZ25lZU9iaik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChzcEluc3RhbmNlU3RlcE9iamVjdC5hc3NpZ25tZW50SGlzdG9yeSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3BJbnN0YW5jZVN0ZXBPYmplY3QuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlT2JqID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShzcEluc3RhbmNlU3RlcE9iamVjdC5hc3NpZ25lZFRvKSk7XG4gICAgICAgICAgICAgICAgaWYgKGFzc2lnbmVlT2JqLnVzZXJJZCAhPSBcIlwiICYmIGFzc2lnbmVlT2JqLm5hbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICBzcEluc3RhbmNlU3RlcE9iamVjdC5hc3NpZ25tZW50SGlzdG9yeS5wdXNoKGFzc2lnbmVlT2JqKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBoaXN0b3J5TW9kZWw7XG4gICAgICAgICAgICBpZiAobW9kZWwgIT0gdW5kZWZpbmVkICYmIE9iamVjdC5rZXlzKG1vZGVsKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgaGlzdG9yeU1vZGVsID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShtb2RlbCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBoaXN0b3J5TW9kZWwgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNwSW5zdGFuY2VTdGVwT2JqZWN0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaW5kTW9kZWxJblN0ZXAgPSBwdXNoSW5kaWNhdG9yVG9Nb2RlbChoaXN0b3J5TW9kZWwpO1xuICAgICAgICAgICAgc3BpbnN0YW5jZU9iamVjdC5oaXN0b3J5LnB1c2goaW5kTW9kZWxJblN0ZXApO1xuXG4gICAgICAgICAgICBpZiAodHJhbnNpdGlvblswXS50cmFuc2l0aW9uQWN0aW9uLmdvVG9TdGVwICE9IHVuZGVmaW5lZCkge1xuXG5cblxuICAgICAgICAgICAgICAgIHZhciBuZXh0U2VxID0gcGFyc2VJbnQoY3VycmVudFN0ZXBbMF0uX3NlcSkgKyBwYXJzZUludCh0cmFuc2l0aW9uWzBdLnRyYW5zaXRpb25BY3Rpb24uZ29Ub1N0ZXAuZGVmYXVsdCk7XG4gICAgICAgICAgICAgICAgdmFyIG5leHRJZCA9ICcnO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRTdWJQcm9jZXNzWzBdLnN0ZXBzLmZpbHRlcihmdW5jdGlvbihzdGVwSXRlbSkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChzdGVwSXRlbS5fc2VxKSA9PSBuZXh0U3RlcFNlcSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dElkID0gc3RlcEl0ZW0uX2lkO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHN0ZXAocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIG5leHRJZCwgbmV4dFNlcSwgZGF0YSwgX1dGSW5zdGFuY2UsIHNwdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRTZXEgPT0gbWF4U3RlcHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdBbGwgU3RlcCB0cmFuc2l0aW9ucyBoYXZlIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NDb21wbGV0ZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwOiByZXN1bHQuZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnU3RlcCB0cmFuc2l0aW9uIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NDb21wbGV0ZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcDogcmVzdWx0LmRhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHJhbnNpdGlvblswXS50cmFuc2l0aW9uQWN0aW9uLmdvVG9TdGVwSWQgIT0gdW5kZWZpbmVkKSB7XG5cblxuXG4gICAgICAgICAgICAgICAgdmFyIGdvVG9TdGVwSWQgPSB0cmFuc2l0aW9uWzBdLnRyYW5zaXRpb25BY3Rpb24uZ29Ub1N0ZXBJZC5zdGVwSWQ7XG4gICAgICAgICAgICAgICAgdmFyIGdvVG9TdGVwU2VxID0gMTtcblxuICAgICAgICAgICAgICAgIGN1cnJlbnRTdWJQcm9jZXNzWzBdLnN0ZXBzLmZpbHRlcihmdW5jdGlvbihzdGVwSXRlbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RlcEl0ZW0uX2lkID09IGdvVG9TdGVwSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdvVG9TdGVwU2VxID0gcGFyc2VJbnQoc3RlcEl0ZW0uX3NlcSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgc3RlcChwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgZ29Ub1N0ZXBJZCwgZ29Ub1N0ZXBTZXEsIGRhdGEsIF9XRkluc3RhbmNlLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChnb1RvU3RlcFNlcSA9PSBtYXhTdGVwcyB8fCByZXN1bHQuZGF0YS5zdGF0dXMgPT0gJ0NvbXBsZXRlJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnQWxsIFN0ZXAgdHJhbnNpdGlvbnMgaGF2ZSBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzQ29tcGxldGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcDogcmVzdWx0LmRhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnU3RlcCB0cmFuc2l0aW9uIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NDb21wbGV0ZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcDogcmVzdWx0LmRhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRyYW5zaXRpb25bMF0udHJhbnNpdGlvbkFjdGlvbi5zdG9wICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHZhciBuZXdBcnIgPSBbXTtcbiAgICAgICAgICAgICAgICBpZihzcGluc3RhbmNlT2JqZWN0Lm1lc3NhZ2VzICE9IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgICAgIGZvcih2YXIgbSA9IDA7IG0gPCBzcGluc3RhbmNlT2JqZWN0Lm1lc3NhZ2VzLmxlbmd0aDsgbSsrKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBzcGluc3RhbmNlT2JqZWN0Lm1lc3NhZ2VzW21dO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoKG9iai50eXBlID09IFwiaW5mb1wiIHx8IG9iai50eXBlID09IFwic3VjY2Vzc1wiKSAmJiBcbiAgICAgICAgICAgICAgICAgICAgICAgIChvYmoua2VlcCA9PSB1bmRlZmluZWQgfHwgb2JqLmtlZXAgIT0gdHJ1ZSkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKG9iai51cmwgIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3QXJyLnB1c2gob2JqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0Fyci5wdXNoKG9iaik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3BpbnN0YW5jZU9iamVjdC5tZXNzYWdlcyA9IG5ld0FycjtcbiAgICAgICAgICAgICAgICAvLyBBcyB0aGlzIGlzIHRoZSBsYXN0IHN0ZXAgKHdoZXJlIHN0b3AgaXMgZGVmaWVkKSAsIHN1YlByb2Nlc3MgcG9zdEFjdGlvbnMgc2hvdWxkIGNvbWUgaGVyZS5cbiAgICAgICAgICAgICAgICB2YXIgcG9zdEFjdGlvbnNDb25mID0gY3VycmVudFByb2Nlc3NbMF0ucG9zdEFjdGlvbnM7XG4gICAgICAgICAgICAgICAgcG9zdEFjdGlvbnMocG9zdEFjdGlvbnNDb25mLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdGVwIHRyYW5zaXRpb24gY29tcGxldGVkIHN1Y2Nlc3NmdWxseS5Xb3JrZmxvdyBzdG9wcGVkLicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NDb21wbGV0ZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXA6IG1vZGVsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgcG9zdEFjdGlvbnNcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gcG9zdEFjdGlvbnMgLSB0aGUgcG9zdEFjdGlvbnMgY29uZmlnIGRhdGFcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIHBvc3RBY3Rpb25zKHBvc3RBY3Rpb25zLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB2YXIgY29tcGxldGVkID0gW107XG4gICAgICAgIHRyeSB7XG5cblxuICAgICAgICAgICAgdmFyIHNwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgdmFyIHByb2Nlc3NJRCA9IHNwT2JqZWN0W1wibWV0YS1kYXRhXCJdLnByb2Nlc3NDb25maWdJZDtcbiAgICAgICAgICAgIHZhciBwcm9jZXNzSWQgPSBzcE9iamVjdFtcIm1ldGEtZGF0YVwiXS5zdWJQcm9jZXNzQ29uZmlnSWQ7XG4gICAgICAgICAgICB2YXIgcHJvY2Vzc1NFUSA9IHNwT2JqZWN0W1wibWV0YS1kYXRhXCJdLnN1YlByb2Nlc3NJbnNTZXE7XG4gICAgICAgICAgICB2YXIgcHJvY2Vzc1NlcSA9IHNwT2JqZWN0W1wibWV0YS1kYXRhXCJdLnN1YlByb2Nlc3NJbnNTZXE7XG5cbiAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzQ29uZmlnT2JqZWN0ID0gSlNPTi54cGF0aChcIi9jb25maWcvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSUQgKyBcIiddL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgcHJvY2Vzc0lkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9zdGVwXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cblxuICAgICAgICAgICAgdXRpbC5zeW5jTG9vcChwb3N0QWN0aW9ucy5sZW5ndGgsIGZ1bmN0aW9uKGxvb3ApIHtcbiAgICAgICAgICAgICAgICB2YXIgY291bnRlciA9IGxvb3AuaXRlcmF0aW9uKCk7XG4gICAgICAgICAgICAgICAgYWN0aW9uKHBvc3RBY3Rpb25zW2NvdW50ZXJdLCBwcm9jZXNzSUQsIHByb2Nlc3NTRVEsIHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0NvbmZpZ09iamVjdCwgc3RlcE9iamVjdCwgX1dGSW5zdGFuY2UsIHt9LCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBhbGwgcHJlLXJlcXVpc2l0ZXMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS5cbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGVkLnB1c2godHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGxvb3AubmV4dCgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWQucHVzaChmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIGxvb3AuYnJlYWsoKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoY29tcGxldGVkLmV2ZXJ5KEJvb2xlYW4pKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdQb3N0LWFjdGlvbnMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZQcmVBY3Rpb25zRXJyb3InLCAnTm90IGFsbCBwb3N0LWFjdGlvbnMgcGFzc2VkLicpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pO1xufTtcblxuLypcbmZ1bmN0aW9uIHNlbmROb3RpZmljYXRpb25zKHVzZXJzTGlzdCwgc3B1dWlkKXtcblxuICAvLyBnZXQgdXNlcnMgbGlzdCBcbiAgLy8gc2VuIG5vdGlmaWNhdGlvbnMgdG8gdXNlcnMgeSBhZGRpbmcgY2hhbm5lbHMgdG8gdGhlbVxuXG4gIHZhciBjaGFubmVsQXJyYXkgPSBbXTtcblxuICBmb3IoaT0wO2k8dXNlcnNMaXN0Lmxlbmd0aDsgaSsrKXtcbiAgICBjaGFubmVsQXJyYXkucHVzaChcInVzZXJfXCIrdXNlcnNMaXN0W2ldLmlkKTtcbiAgfVxuXG4gIGFzc2lnblRvVXNlcnMocHJvY2Vzc1dvcmtmbG93TWVzc2FnZShOT1RJRklDQVRJT05fVVNFUl9NU0dfQUNDRVBULCBzcHV1aWQpLCBjaGFubmVsQXJyYXkpO1xuXG59OyovXG5cbi8qZnVuY3Rpb24gYXNzaWduVG9Vc2VycyhtZXNzYWdlLCBjaGFubmVsQXJyYXkpe1xuXG4gICAgIHZhciBjaGFubmVscyA9IGNoYW5uZWxBcnJheTtcblxuICAgICB2YXIgbm90aWZpY2F0aW9uID0gIHsgXG4gICAgICAgICAgXCJfaWRcIjogZ2VuZXJhdGVVVUlEKCksXG4gICAgICAgICAgXCJjaGFubmVsc1wiOmNoYW5uZWxzLFxuICAgICAgICAgIFwibWVzc2FnZVwiOiBtZXNzYWdlLFxuICAgICAgICAgIFwibWVzc2FnZVR5cGVcIjogXCJpbmZvXCIsXG4gICAgICAgICAgXCJjcmVhdGVkRGF0ZVRpbWVcIjogbW9tZW50KCkuZm9ybWF0KCksXG4gICAgICAgICAgXCJyZWFkXCI6IGZhbHNlLFxuICAgICAgICAgIFwicmVhZERhdGVUaW1lXCI6IFwiXCIsXG4gICAgICAgICAgXCJ0eXBlXCI6IFwibm90aWZpY2F0aW9uXCIsXG4gICAgICAgICAgXCJzZW5kZXJVc2VySWRcIjogX2xjbHguU1VCU0NSSVBUSU9OUy51c2VySWRcbiAgICAgICB9O1xuXG4gICAgICAgY29uc29sZS5sb2cobm90aWZpY2F0aW9uKTtcbiAgICAgICBkYW8uc2F2ZShub3RpZmljYXRpb24pO1xuXG4gIH07Ki9cblxuZnVuY3Rpb24gcHJvY2Vzc1dvcmtmbG93TWVzc2FnZShtZXNzYWdlLCBzcHV1aWQpIHtcblxuICAgIHZhciByZXBsYWNlZE1zZyA9IG1lc3NhZ2U7XG5cbiAgICBpZiAocmVwbGFjZWRNc2cuaW5kZXhPZignI0lOU1RBTkNFX0xBQkVMJykgIT09IC0xKSB7XG4gICAgICAgIHZhciB2YWwgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbdXVpZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2xhYmVsXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICByZXBsYWNlZE1zZyA9IHJlcGxhY2VkTXNnLnJlcGxhY2UoJyNJTlNUQU5DRV9MQUJFTCcsIHZhbCk7XG5cbiAgICB9XG5cbiAgICBpZiAocmVwbGFjZWRNc2cuaW5kZXhPZignI1VTRVJfTkFNRScpICE9PSAtMSkge1xuICAgICAgICB2YXIgdmFsID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vc3RlcC9hc3NpZ25lZFRvL25hbWVcIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG5cbiAgICAgICAgcmVwbGFjZWRNc2cgPSByZXBsYWNlZE1zZy5yZXBsYWNlKCcjVVNFUl9OQU1FJywgdmFsKTtcblxuICAgIH1cblxuICAgIGlmIChyZXBsYWNlZE1zZy5pbmRleE9mKCcjUFJPRklMRV9USVRMRScpICE9PSAtMSkge1xuICAgICAgICB2YXIgdmFsID0gYXBwLnByb2ZpbGUudGl0bGU7XG4gICAgICAgIHJlcGxhY2VkTXNnID0gcmVwbGFjZWRNc2cucmVwbGFjZSgnI1BST0ZJTEVfVElUTEUnLCB2YWwpO1xuXG4gICAgfVxuXG4gICAgaWYgKHJlcGxhY2VkTXNnLmluZGV4T2YoJyNQUk9GSUxFX1RZUEUnKSAhPT0gLTEpIHtcbiAgICAgICAgdmFyIHZhbCA9IGFwcC5TQ09QRS5BUFBfQ09ORklHLm5hbWU7XG4gICAgICAgIHJlcGxhY2VkTXNnID0gcmVwbGFjZWRNc2cucmVwbGFjZSgnI1BST0ZJTEVfVFlQRScsIHZhbCk7XG5cbiAgICB9XG5cbiAgICBpZiAocmVwbGFjZWRNc2cuaW5kZXhPZignI1ZBUl9TUFVVSUQnKSAhPT0gLTEpIHtcbiAgICAgICAgdmFyIHZhbCA9IHNwdXVpZDtcbiAgICAgICAgcmVwbGFjZWRNc2cgPSByZXBsYWNlZE1zZy5yZXBsYWNlKCcjVkFSX1NQVVVJRCcsIHZhbCk7XG5cbiAgICB9XG5cbiAgICByZXR1cm4gcmVwbGFjZWRNc2c7XG59O1xuXG5mdW5jdGlvbiBfZ2V0TmFtZShhcnIsIGxhbmcpIHtcbiAgICBpZiAoYXJyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChhcnJbaV0uX2xhbmcgPT09IGxhbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXJyW2ldLnZhbHVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgIH1cblxufTtcblxuZnVuY3Rpb24gX2dldE5hbWVCeUxhbmcob2JqKSB7XG4gICAgcmV0dXJuIGxpYnJhcnkuZ2V0TmFtZUJ5TGFuZyhvYmopO1xufTtcblxuXG5cblxuXG4vKipcbiAqIFByb2Nlc3MgcHJlV29ya0FjdGlvbnNcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gcHJlV29ya0FjdGlvbnMgLSB0aGUgcHJlV29ya0FjdGlvbnMgY29uZmlnIGRhdGFcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cblxuZnVuY3Rpb24gcHJlV29ya0FjdGlvbnMocHJlV29ya0FjdGlvbnMsIF9XRkluc3RhbmNlKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB2YXIgY29tcGxldGVkID0gW107XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc0NvbmZpZ09iamVjdCA9IEpTT04ueHBhdGgoXCIvY29uZmlnL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgYXBwLlNDT1BFLnNwby5wT2JqZWN0LmlkICsgXCInXS9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIGFwcC5TQ09QRS5zcG8uc3BPYmplY3QuaWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBhcHAuU0NPUEUucHJvY2Vzc1VVSUQgKyBcIiddL3N0ZXBcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgdXRpbC5zeW5jTG9vcChwcmVXb3JrQWN0aW9ucy5sZW5ndGgsIGZ1bmN0aW9uKGxvb3ApIHtcbiAgICAgICAgICAgICAgICB2YXIgY291bnRlciA9IGxvb3AuaXRlcmF0aW9uKCk7XG4gICAgICAgICAgICAgICAgYWN0aW9uKHByZVdvcmtBY3Rpb25zW2NvdW50ZXJdLCBhcHAuU0NPUEUuc3BvLnBPYmplY3QuaWQsIGFwcC5TQ09QRS5zcG8ucE9iamVjdC5zZXEsIGFwcC5TQ09QRS5zcG8uc3BPYmplY3QuaWQsIGFwcC5TQ09QRS5zcG8uc3BPYmplY3Quc2VxLCBzdWJQcm9jZXNzQ29uZmlnT2JqZWN0LCBzdGVwT2JqZWN0LCBfV0ZJbnN0YW5jZSwge30sIGFwcC5TQ09QRS5wcm9jZXNzVVVJRCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGFsbCBwcmUtcmVxdWlzaXRlcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LlxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWQucHVzaCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgbG9vcC5uZXh0KCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZC5wdXNoKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgbG9vcC5icmVhaygpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChjb21wbGV0ZWQuZXZlcnkoQm9vbGVhbikpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1ByZVdvcmstYWN0aW9ucyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZUFjdGlvbnNFcnJvcicsICdOb3QgYWxsIHByZS13b3JrLWFjdGlvbnMgcGFzc2VkLicpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pO1xufTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuICAgIHByZVJlcXVpc2l0ZXM6IHByZVJlcXVpc2l0ZXMsXG4gICAgcHJlQWN0aW9uczogcHJlQWN0aW9ucyxcbiAgICBwb3N0QWN0aW9uczogcG9zdEFjdGlvbnMsXG4gICAgcHJlV29ya0FjdGlvbnM6IHByZVdvcmtBY3Rpb25zLFxuICAgIHN1YlByb2Nlc3M6IHN1YlByb2Nlc3MsXG4gICAgaW5kaWNhdG9yRG9jczogaW5kaWNhdG9yRG9jcyxcbiAgICB0YXNrOiB0YXNrLFxuICAgIHRyYW5zaXRpb246IHRyYW5zaXRpb24sXG4gICAgYXNzaWduVXNlcjogYXNzaWduVXNlclxuXG59IiwiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIFV0aWxpdHkgTW9kdWxlXG4gKlxuICogQG1vZHVsZSBsaWIvdXRpbFxuICpcbiAqIEBhdXRob3IgQnJlbnQgR29yZG9uXG4gKiBAdmVyc2lvbiAwLjEuMFxuICpcbiAqIEBkZXNjcmlwdGlvblxuICogV29ya2Zsb3cgdXRpbGl0eSBtb2R1bGUgdXNlZCB0byBmb3JtYXQgdGhlIHJldHVybiBhbmQgZXJyb3Igb2JqZWN0cywgYW5kXG4gKiBjb250YWlucyBzb21lIG90aGVyIHV0aWxpdHkgZnVuY3Rpb25zIHN1Y2ggYXMgYSBzeW5jIGxvb3AgYW5kIGNvbXBhcmUuXG4gKlxuICovXG5cbi8qKlxuICogU3VjY2VzcyBibG9jayByZXR1cm4gb2JqZWN0LCBjb250YWlucyBhIG1lc3NhZ2UgYW5kIG9wdGlvbmFsIGRhdGEgb2JqZWN0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlIC0gdGhlIHN1Y2Nlc3MgbWVzc2FnZVxuICogQHBhcmFtIHtzdHJpbmd8T2JqZWN0fSBbZGF0YV0gLSB0aGUgc3VjY2VzcyByZXR1cm5lZCBkYXRhXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIFJldHVybiBzdWNjZXNzIHdpdGhvdXQgYSBkYXRhIGJsb2NrXG4gKiB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnU3VjY2VzcyBtZXNzYWdlIGdvZXMgaGVyZS4uLicpO1xuICpcbiAqIEByZXR1cm4ge09iamVjdH0gLSB3aXRoIG1lc3NhZ2UgYW5kIGRhdGEgcHJvcGVydGllc1xuICpcbiAqL1xuZnVuY3Rpb24gc3VjY2VzcyhtZXNzYWdlLCBkYXRhKXtcblx0cmV0dXJuIHtcblx0XHRtZXNzYWdlOiBtZXNzYWdlLFxuXHRcdGRhdGE6IGRhdGFcblx0fTtcbn07XG5cbi8qKlxuICogV2FybmluZyBibG9jayByZXR1cm4gb2JqZWN0LCBjb250YWlucyBhIG1lc3NhZ2UgYW5kIG9wdGlvbmFsIGRhdGEgb2JqZWN0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlIC0gdGhlIHdhcm5pbmcgbWVzc2FnZVxuICogQHBhcmFtIHtzdHJpbmd8T2JqZWN0fSBbZGF0YV0gLSB0aGUgcmV0dXJuZWQgZGF0YVxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBSZXR1cm4gc3VjY2VzcyB3aXRob3V0IGEgZGF0YSBibG9ja1xuICogdmFyIHN1Y2Nlc3MgPSB1dGlsLndhcm4oJ1dhcm5pbmcgbWVzc2FnZSBnb2VzIGhlcmUuLi4nKTtcbiAqXG4gKiBAcmV0dXJuIHtPYmplY3R9IHdpdGggbWVzc2FnZSBhbmQgZGF0YSBwcm9wZXJ0aWVzLCBhbmQgbG9ncyB0aGUgd2FybmluZyB0byB0aGUgY29uc29sZS5cbiAqXG4gKi9cbmZ1bmN0aW9uIHdhcm4obWVzc2FnZSwgZGF0YSl7XG5cdGNvbnNvbGUud2FybihkYXRhKTtcblx0cmV0dXJuIHtcblx0XHR3YXJuaW5nOiBtZXNzYWdlLFxuXHRcdGRhdGE6IGRhdGFcblx0fTtcbn07XG5cbi8qKlxuICogRXJyb3IgYmxvY2sgSlMgZXJyb3Igb2JqZWN0LCBjb250YWlucyBhIGNvZGUgYW5kIG1lc3NhZ2UgZm9yIHRoZSBlcnJvci5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gY29kZSAtIHRoZSBlcnJvciBjb2RlXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSAtIHRoZSBlcnJvciBtZXNzYWdlXG4gKlxuICogQGV4YW1wbGVcbiAqIHZhciBzdWNjZXNzID0gdXRpbC5lcnJvcignRXJyb3IwMDEnLCdFcnJvciBtZXNzYWdlIGdvZXMgaGVyZS4uLicpO1xuICpcbiAqIEByZXR1cm4ge09iamVjdH0gd2l0aCBhIGNvZGUgYW5kIG1lc3NhZ2UgcHJvcGVydGllcy5cbiAqXG4gKi9cbmZ1bmN0aW9uIGVycm9yKGNvZGUsIG1lc3NhZ2Upe1xuXHR2YXIgZXJyID0gbmV3IEVycm9yKCcnKTtcblx0ZXJyLm5hbWUgPSBjb2RlO1xuXHRlcnIubWVzc2FnZSA9IG1lc3NhZ2U7XG5cdHJldHVybiBlcnI7XG59O1xuXG4vKipcbiAqIEEgbG9vcCB3aGljaCBjYW4gbG9vcCBYIGFtb3VudCBvZiB0aW1lcywgd2hpY2ggY2FycmllcyBvdXRcbiAqIGFzeW5jaHJvbm91cyBjb2RlLCBidXQgd2FpdHMgZm9yIHRoYXQgY29kZSB0byBjb21wbGV0ZSBiZWZvcmUgbG9vcGluZy5cbiAqXG4gKiBAcGFyYW0ge251bWJlcn0gaXRlcmF0aW9ucyAtIHRoZSBudW1iZXIgb2YgaXRlcmF0aW9ucyB0byBjYXJyeSBvdXRcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IHByb2Nlc3MgLSB0aGUgY29kZS9mdW5jdGlvbiB3ZSdyZSBydW5uaW5nIGZvciBldmVyeVxuICogaXRlcmF0aW9uXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBleGl0IC0gYW4gb3B0aW9uYWwgY2FsbGJhY2sgdG8gY2Fycnkgb3V0IG9uY2UgdGhlIGxvb3BcbiAqIGhhcyBjb21wbGV0ZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogdXRpbC5zeW5jTG9vcCg1LCBmdW5jdGlvbihsb29wKXtcbiAqIFx0dmFyIGNvdW50ZXIgPSBsb29wLml0ZXJhdGlvbigpO1xuICogXHQvLyBBZGQgYXN5bmMgY2FsbHMgaGVyZS4uXG4gKlxuICogfSwgZnVuY3Rpb24oKXtcbiAqIFx0Ly8gT24gY29tcGxldGUgcGVyZm9ybSBhY3Rpb25zIGhlcmUuLi5cbiAqXG4gKiB9KTtcbiAqXG4gKiBAcmV0dXJuIHtPYmplY3R9IHRoZSBsb29wIGNvbnRyb2wgb2JqZWN0LlxuICpcbiAqL1xuZnVuY3Rpb24gc3luY0xvb3AoaXRlcmF0aW9ucywgcHJvY2VzcywgZXhpdCl7XG4gICAgdmFyIGluZGV4ID0gMCxcbiAgICAgICAgZG9uZSA9IGZhbHNlLFxuICAgICAgICBzaG91bGRFeGl0ID0gZmFsc2U7XG4gICAgdmFyIGxvb3AgPSB7XG4gICAgICAgIG5leHQ6ZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGlmKGRvbmUpe1xuICAgICAgICAgICAgICAgIGlmKHNob3VsZEV4aXQgJiYgZXhpdCl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBleGl0KCk7IC8vIEV4aXQgaWYgd2UncmUgZG9uZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIElmIHdlJ3JlIG5vdCBmaW5pc2hlZFxuICAgICAgICAgICAgaWYoaW5kZXggPCBpdGVyYXRpb25zKXtcbiAgICAgICAgICAgICAgICBpbmRleCsrOyAvLyBJbmNyZW1lbnQgb3VyIGluZGV4XG4gICAgICAgICAgICAgICAgcHJvY2Vzcyhsb29wKTsgLy8gUnVuIG91ciBwcm9jZXNzLCBwYXNzIGluIHRoZSBsb29wXG4gICAgICAgICAgICAvLyBPdGhlcndpc2Ugd2UncmUgZG9uZVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkb25lID0gdHJ1ZTsgLy8gTWFrZSBzdXJlIHdlIHNheSB3ZSdyZSBkb25lXG4gICAgICAgICAgICAgICAgaWYoZXhpdCkgZXhpdCgpOyAvLyBDYWxsIHRoZSBjYWxsYmFjayBvbiBleGl0XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGl0ZXJhdGlvbjpmdW5jdGlvbigpe1xuICAgICAgICAgICAgcmV0dXJuIGluZGV4IC0gMTsgLy8gUmV0dXJuIHRoZSBsb29wIG51bWJlciB3ZSdyZSBvblxuICAgICAgICB9LFxuICAgICAgICBicmVhazpmdW5jdGlvbihlbmQpe1xuICAgICAgICAgICAgZG9uZSA9IHRydWU7IC8vIEVuZCB0aGUgbG9vcFxuICAgICAgICAgICAgc2hvdWxkRXhpdCA9IGVuZDsgLy8gUGFzc2luZyBlbmQgYXMgdHJ1ZSBtZWFucyB3ZSBzdGlsbCBjYWxsIHRoZSBleGl0IGNhbGxiYWNrXG4gICAgICAgIH1cbiAgICB9O1xuICAgIGxvb3AubmV4dCgpO1xuICAgIHJldHVybiBsb29wO1xufTtcblxuZnVuY3Rpb24gY29tcGFyZShzdWJqZWN0LCBvcGVyYXRvciwgdmFsdWUpIHtcbiAgXHRzd2l0Y2ggKG9wZXJhdG9yKSB7XG4gIFx0XHRjYXNlICdncmVhdGVyVGhhbic6XG5cdFx0XHRyZXR1cm4gc3ViamVjdCA+IHZhbHVlO1xuXHRcdGNhc2UgJ2xlc3NUaGFuJzpcblx0XHRcdHJldHVybiBzdWJqZWN0IDwgdmFsdWU7XG5cdFx0Y2FzZSAnZ3JlYXRlclRoYW5FcXVhbCc6XG5cdFx0XHRyZXR1cm4gc3ViamVjdCA+PSB2YWx1ZTtcblx0XHRjYXNlICdsZXNzVGhhbkVxdWFsJzpcblx0XHRcdHJldHVybiBzdWJqZWN0IDw9IHZhbHVlO1xuXHRcdGNhc2UgJ2VxdWFsVG8nOlxuXHRcdFx0cmV0dXJuIHN1YmplY3QgPT09IHZhbHVlO1xuXHRcdGNhc2UgJ25vdEVxdWFsVG8nOlxuXHRcdFx0cmV0dXJuIHN1YmplY3QgIT09IHZhbHVlO1xuICBcdH1cbn07XG5cbmZ1bmN0aW9uIGdldE5hbWUoYXJyLCBsYW5nKXtcblx0aWYgKGFyciAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoIDsgaSsrKSB7XG5cdFx0XHRpZiAoYXJyW2ldLmkxOG4uX2xhbmcgPT09IGxhbmcpIHtcblx0XHRcdFx0cmV0dXJuIGFycltpXS5pMThuLnZhbHVlO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuIFx0c3VjY2Vzczogc3VjY2VzcyxcbiBcdHdhcm46IHdhcm4sXG4gXHRlcnJvcjogZXJyb3IsXG4gXHRzeW5jTG9vcDogc3luY0xvb3AsXG4gXHRjb21wYXJlOiBjb21wYXJlLFxuXHRnZXROYW1lOiBnZXROYW1lXG5cbiB9XG4iXX0=
