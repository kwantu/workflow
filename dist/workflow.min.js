(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Workflow = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function Workflow(e,t,s,o){var i=this;if(""==t||void 0==t)throw util.error("ParamRequired","A community id is required.");if("string"!=typeof t)throw new Error("The community id must be a javascript string.");if(i.communityId=t||"",""==e||void 0==e)throw util.error("ParamRequired","A profile id is required.");if("string"!=typeof e)throw new Error("The profile id must be a javascript string.");if(i.profile=e||"",""==s||void 0==s)throw util.error("ParamRequired","An app id is required.");if("string"!=typeof s)throw new Error("The app id must be a javascript string.");if(i.app=s||"",""==o||void 0==o)throw util.error("ParamRequired","A workflow configuration is required.");"object"!=typeof o?i.config=JSON.parse(o):i.config=o,i.instance,i.subprocesses=[],i.indicators=[]}var Process=require("./lib/process"),util=require("utility"),userInterface=require("./lib/interface"),helper=require("./lib/helper");Workflow.prototype.getProfile=function(){return this.profile},Workflow.prototype.getApp=function(){return this.app},Workflow.prototype.getConfig=function(){return this.config},Workflow.prototype.getInstance=function(){return this.instance},Workflow.prototype.setInstance=function(e){this.instance=e},Workflow.prototype.getSubProcesses=function(){return this.subprocesses},Workflow.prototype.setSubProcesses=function(e){this.subprocesses=e},Workflow.prototype.getIndicators=function(){return this.indicators},Workflow.prototype.setIndicators=function(e){this.indicators=e},Workflow.prototype.create=function(){var e=this;return new Promise(function(t,s){try{if(void 0!==e.instance){var o=util.warn("Instance already exists.",e);t(o)}else{var i={_id:"",version:"",type:"workflowInstance",processes:[],channels:["community_"+app.SCOPE.getCommunityId(),"profile_"+app.SCOPE.profileId,"application_"+app.SCOPE.applicationId,"community_"+app.SCOPE.getCommunityId()+"_application_"+app.SCOPE.applicationId]};i._id="_local/"+e.profile+":processes:local",i.version=e.config.version,e.instance=i;var r=util.success("Workflow processes instance created successfully.",e);t(r)}}catch(e){s(e)}})},Workflow.prototype.initialise=function(e,t,s){var o=this;return new Promise(function(i,r){try{var n=[];if(""!==e&&void 0!==e){if(n=o.config.processes.filter(function(t){if(t._id==e)return t}),void 0==n[0]._id){var c=util.error("WFConfigError","No valid process definition found with process id: "+e);r(c)}}else n.push(o.config.processes[0]),e=o.config.processes[0]._id;var a=[];o.instance.processes.filter(function(t){t.id==e&&a.push(t)});var u=a.length+1,p={id:"",seq:"",subProcesses:[]};p.id=e,p.seq=u,o.instance.processes.push(p);var d=n[0].subProcesses[0]._id,f=1;o.instance.processes.filter(function(t){t.id==e&&t.seq==u&&(f=t.subProcesses.length+1)}),Process.subProcess(e,u,d,f,s,t,o).then(function(t){var n=t.data._id,c=t.data.groupKey;void 0==s&&(s="");var a={id:d,subprofileId:s,seq:t.data["meta-data"].subProcessInsSeq,uuid:n,groupKey:c};p.subProcesses.push(a);for(var f=0;f<o.instance.processes.length;f++){var l=o.instance.processes[f];l.id==e&&l.seq==u&&o.instance.processes.splice(f,1,p)}var h=t.data.indicators,m=t.data.step;Process.indicatorDocs(e,h,m,o).then(function(e){var t=util.success("Process: "+o.config.processes[0]._id+" initialized successfully.",a);i(t)},function(e){r(e)})},function(t){o.instance.processes=o.instance.processes.filter(function(t){return!(t.id==e&&t.seq==u)}),console.log(t),r(t)})}catch(e){r(e)}})},Workflow.prototype.transition=function(e,t,s,o,i,r,n,c){var a=this;return new Promise(function(o,u){try{var p=JSON.xpath("/subprocesses[_id eq '"+c+"']/step",app.SCOPE.workflow,{})[0],d=JSON.xpath("/processes[_id eq '"+e+"']/subProcesses[_id eq '"+s+"']/steps[_id eq '"+i+"']",a.config,{})[0],f=JSON.xpath("/subprocesses[_id eq '"+c+"']/meta-data/subProcessInsSeq",app.SCOPE.workflow,{})[0],l=function(i,r){a.instance.processes.filter(function(n){n.id==e&&n.seq==t&&n.subProcesses.filter(function(e){e.id==s&&a.subprocesses.filter(function(e){if(e._id==c)if("step"==i){e.step=r.data.step;var t=util.success(r.message,e);o(t)}else if("stepComplete"==i){e.step=r.data.step,e.complete=!0;var t=util.success(r.message,e.step);o(t)}})})})};if(void 0!=d.function.task&&void 0!=d.function.task.postActions){var h=d.function.task.postActions;Process.postActions(h,a,c).then(function(o){Process.transition(e,t,s,f,i,r,n,a,c,p).then(function(e){e.data.subProcessComplete?l("stepComplete",e):l("step",e)},function(e){u(e)})},function(e){u(e)})}else Process.transition(e,t,s,f,i,r,n,a,c,p).then(function(e){e.data.subProcessComplete?l("stepComplete",e):l("step",e)},function(e){u(e)})}catch(e){u(e)}})},Workflow.prototype.assignUser=function(e,t,s,o,i,r){var n=this;return new Promise(function(c,a){try{Process.assignUser(e,t,s,o,i,r,n).then(function(e){c(e)},function(e){a(e)})}catch(e){a(e)}})},Workflow.prototype.ui=function(){var e=this;return{getProcess:function(t,s){return new Promise(function(o,i){try{userInterface.getProcess(t,s,e).then(function(e){o(e)},function(e){i(e)})}catch(e){i(e)}})}}},Workflow.prototype.getNodeValue=function(e,t){var s=this;return new Promise(function(o,i){try{helper.getNodeValue(e,s,t).then(function(e){o(e)},function(e){i(e)})}catch(e){i(e)}})},Workflow.prototype.takeAssignment=function(e){var t=this;return new Promise(function(s,o){try{var i=JSON.xpath("/subprocesses[_id eq '"+e+"']",t,{})[0],r=JSON.xpath("/step/assignedTo",i,{})[0];void 0==i.step.assignmentHistory&&(i.step.assignmentHistory=[]),""!=r.userId&&""!=r.name&&i.step.assignmentHistory.push(JSON.parse(JSON.stringify(r))),r.name=LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,r.userId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"",r.dateTime=moment().format(),r.type=ASSIGNMENT_TYPE_ACCEPTANCE,r.dueDateTime="",r.by=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"";var n=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+e+"']/id",t,{})[0],c=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+e+"']/id",t,{})[0],a=JSON.xpath("/subprocesses[_id eq '"+e+"']/step/id",t,{})[0],u=JSON.xpath("/processes[_id eq '"+n+"']/subProcesses[_id eq '"+c+"']/steps[_id eq '"+a+"']",t.config,{})[0];if(void 0!=u.function.task.preWorkActions){var p=u.function.task.preWorkActions;Process.preWorkActions(p,t).then(function(e){s(t)},function(e){o(e)})}else s(t)}catch(e){o(e)}})},Workflow.prototype.condition=function(condition,spuuid){var _this=this;return new Promise(function(resolve,reject){try{var operator=condition.operator,dataBlock=condition.value.data;if(void 0!=condition.subject.indicator){var setId=condition.subject.indicator.setId,modelScope=condition.subject.indicator.modelScope,elementPath=condition.subject.indicator.elementPath;if("subProcess"==condition.subject.indicator.context){var indicatorUUID=JSON.xpath("/subprocesses[_id eq '"+spuuid+"']/indicators[id eq '"+setId+"']/instances[1]/uuid",_this,{})[0],indicatorModel=JSON.xpath("/indicators[_id eq '"+indicatorUUID+"']",_this,{})[0],dataElement=indicatorModel.model[modelScope].data[setId],value=eval("dataElement."+elementPath);helper.getNodeValue(dataBlock,_this,spuuid).then(function(e){var t=helper.compare(value,operator,e);resolve(t)},function(e){reject(e)})}else reject("Not implemented")}else if(void 0!=condition.subject.indicatorWrapper)reject("Not implemented");else if(void 0!=condition.subject.variable)reject("Not implemented");else if(void 0!=condition.subject.subProcess){var elementPath=condition.subject.subProcess.elementPath,spObject=JSON.xpath("/subprocesses[_id eq '"+spuuid+"']",_this,{})[0],value=eval("spObject."+elementPath);helper.getNodeValue(dataBlock,_this,spuuid).then(function(e){var t=helper.compare(value,operator,e);resolve(t)},function(e){reject(e)})}}catch(e){reject(e)}})},module.exports=Workflow;

},{"./lib/helper":4,"./lib/interface":5,"./lib/process":7,"utility":8}],2:[function(require,module,exports){
"use strict";var util=require("utility"),nodeValue=require("./nodeValue"),form=require("./form"),helper=require("./helper"),gatekeeper=new GK,community=function(){return{createCommunity:function(e,i,o){return new Promise(function(e,t){var n=worker.getWorkerWrapper(),a="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(a=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=o.profile,n.subProcessUUID=i,n.subprofileId=a,n.channels.push("dataRegistry"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=JSON.xpath("/indicators[category/term eq 'Community']/_id",o,{})[0],s={createCommunity:{newCommunityId:o.profile,indicatorUUID:{Community:r}}};n.action=s,worker.send(n).then(function(t){worker.setWorkerInfoInSubprocess(n,o,i);var a=util.success("Worker processed successfully.",t);e(a)},function(e){t(e)})})},userJoinCommunity:function(e,i,o){return new Promise(function(e,i){})},releaseAdoptedApplication:function(e,i,o){return new Promise(function(e,t){var n=worker.getWorkerWrapper(),a="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(a=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=o.profile,n.subProcessUUID=i,n.subprofileId=a,n.channels.push("dataRegistry"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'adoptedApplication']/instances[1]/uuid",o,{})[0],s={releaseAdoptedApplication:{communityId:o.profile,indicatorUUID:{adoptedApplication:r}}};n.action=s,worker.send(n).then(function(t){worker.setWorkerInfoInSubprocess(n,o,i);var a=util.success("Worker processes successfully.",t);e(a)},function(e){t(e)})})}}}(),application=function(){return{createAppDefinition:function(e,i,o){return new Promise(function(e,t){var n=worker.getWorkerWrapper(),a="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(a=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=o.profile,n.subProcessUUID=i,n.subprofileId=a,n.channels.push("dataRegistry"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=JSON.xpath("/indicators[category/term eq 'Application']/_id",o,{})[0],s={createApplication:{newApplicationId:o.profile,indicatorUUID:{Application:r}}};n.action=s,worker.send(n).then(function(t){worker.setWorkerInfoInSubprocess(n,o,i);var a=util.success("Worker processes successfully.",t);e(a)},function(e){t(e)})})},buildApplication:function(e,i,o){return new Promise(function(e,t){var n=worker.getWorkerWrapper(),a="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(a=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=o.profile,n.subProcessUUID=i,n.subprofileId=a,n.channels.push("dataRegistry"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'PublishApplication']/instances[1]/uuid",o,{})[0],s=JSON.xpath("/indicators[category/term eq 'ApplicationDefinition']/_id",o,{})[0],p=JSON.xpath("/indicators[category/term eq 'Roles']/_id",o,{})[0],c=JSON.xpath("/indicators[category/term eq 'Application']/_id",o,{})[0],u=JSON.xpath("/indicators[category/term eq 'AppPermissions']/_id",o,{})[0],d={buildApplication:{applicationId:o.profile,indicatorUUID:{PublishApplication:r,ApplicationDefinition:s,Roles:p,Application:c,AppPermissions:u}}};n.action=d,worker.send(n).then(function(t){worker.setWorkerInfoInSubprocess(n,o,i);var a=util.success("Worker processes successfully.",t);e(a)},function(e){t(e)})})},applicationAdoption:function(e,i,o){return new Promise(function(e,t){var n=worker.getWorkerWrapper(),a="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(a=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=o.profile,n.subProcessUUID=i,n.subprofileId=a,n.channels.push("dataRegistry"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'Adoption']/instances[1]/uuid",o,{})[0],s=JSON.xpath("/indicators[category/term eq 'PublishApplication']/_id",o,{})[0],p=JSON.xpath("/indicators[category/term eq 'Application']/_id",o,{})[0],c={adoptApplication:{applicationId:o.profile,indicatorUUID:{Adoption:r,PublishApplication:s,Application:p}}};n.action=c,worker.send(n).then(function(t){worker.setWorkerInfoInSubprocess(n,o,i);var a=util.success("Worker processes successfully.",t);e(a)},function(e){t(e)})})},createTaxonomy:function(e,i,o){return new Promise(function(e,t){var n=worker.getWorkerWrapper(),a="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(a=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=o.profile,n.subProcessUUID=i,n.subprofileId=a,n.channels.push("dataRegistry"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'Taxonomy']/instances[1]/uuid",o,{})[0],s={createTaxonomy:{taxonomyUUID:r}};n.action=s,worker.send(n).then(function(t){worker.setWorkerInfoInSubprocess(n,o,i);var a=util.success("Worker processes successfully.",t);e(a)},function(e){t(e)})})}}}(),performance=function(){return{unlockPeriod:function(e,i,o){return new Promise(function(e,t){var n=JSON.xpath("/subprocesses[_id eq '"+i+"']",o,{})[0],a=JSON.xpath("/indicators[id eq '"+PERIOD_SET_ID+"']/instances/uuid",n,{})[0],r=n.dates.valid;library.unlockPeriod(a,r,i).then(function(i){var o=util.success("Unlock period.",i);e(o)},function(e){t(e)})})},setModelStatus:function(e,i,o){return new Promise(function(t,n){var a=JSON.xpath("/subprocesses[_id eq '"+i+"']",o,{})[0],r=JSON.xpath("/indicators[id eq '"+PERIOD_SET_ID+"']/instances/uuid",a,{})[0],s=a.dates.valid,p=JSON.xpath("/label",e,{})[0],c=helper.getLanguageMessage(p);library.setPeriodStatus(r,s,c,i).then(function(e){var i=util.success("setModelStatus",e);t(i)},function(e){n(e)})})},lockPerformanceModel:function(e,i,o){return new Promise(function(e,t){var n=JSON.xpath("/subprocesses[_id eq '"+i+"']",o,{})[0],a=JSON.xpath("/indicators[id eq '"+PERFORMANCE_SET_ID+"']/instances/uuid",n,{})[0],r=n.dates.valid;library.lockPerformanceModel(a,r,i).then(function(i){var o=util.success("Lock performance model.",i);e(o)},function(e){t(e)})})}}}(),sdo=function(){return{create:function(e,i,o){return new Promise(function(e,t){var n=worker.getWorkerWrapper(),a="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(a=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=o.profile,n.subProcessUUID=i,n.subprofileId=a,n.channels.push("dataRegistry"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'SDO']/instances[1]/uuid",o,{})[0],s={createSDO:{sdoUUID:r}};n.action=s,worker.send(n).then(function(t){worker.setWorkerInfoInSubprocess(n,o,i);var a=util.success("Worker processes successfully.",t);e(a)},function(e){t(e)})})}}}(),taxonomy=function(){return{create:function(e,i,o){return new Promise(function(e,t){var n=worker.getWorkerWrapper(),a="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(a=app.profile.subprofileId),n._id=generateUUID(),n.communityId=app.SCOPE.getCommunityId(),n.applicationId=app.SCOPE.applicationId,n.createdDateTime=moment().format(),n.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,n.profileId=o.profile,n.subProcessUUID=i,n.subprofileId=a,n.channels.push("dataRegistry"),n.channels.push("community_"+app.SCOPE.getCommunityId());var r=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators[id eq 'Taxonomy']/instances[1]/uuid",o,{})[0],s={createTaxonomy:{taxonomyUUID:r}};n.action=s,worker.send(n).then(function(t){worker.setWorkerInfoInSubprocess(n,o,i);var a=util.success("Worker processes successfully.",t);e(a)},function(e){t(e)})})}}}(),subProcessInstance=function(){return{setTitle:function(e,i,o,t){return new Promise(function(e,n){var a=JSON.xpath("/subprocesses[_id eq '"+i+"']",app.SCOPE.workflow,{})[0];a.label=o;var r=[],s={};s.model=t.subprocesses,r.push(s);var p=util.success("Subprocess setTitle success.",t.subprocesses);e(p)})},setValidDate:function(e,i,o,t){return new Promise(function(e,n){var a=JSON.xpath("/subprocesses[_id eq '"+i+"']",app.SCOPE.workflow,{})[0];a.dates.valid=o;var r=[],s={};s.model=a,r.push(s);var p=util.success("valid date set.",t.subprocesses);e(p)})},setSPStatus:function(e,i,o,t){return new Promise(function(e,n){var a=JSON.xpath("/subprocesses[_id eq '"+i+"']",app.SCOPE.workflow,{})[0];a.spStatus=o;var r=[],s={};s.model=t.subprocesses,r.push(s);var p=util.success("Subprocess spStatus success.",t.subprocesses);e(p)})}}}(),variables=function(){return{setVariable:function(setVariable,_WFInstance,uuid){return new Promise(function(resolve,reject){helper.getNodeValue(setVariable.data,_WFInstance,uuid).then(function(dataValue){var scope=setVariable.scope,variableName=setVariable.name,variableType=setVariable.variableType,validDate=JSON.xpath("/subprocesses[_id eq '"+uuid+"']/dates/valid",_WFInstance,{})[0];switch(scope){case"profile":var profileId=_WFInstance.profile,profileVariableFileName=profileId+":variables";dao.get(profileVariableFileName).then(function(file){if("periodic"==variableType){var processObj=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+uuid+"']",_WFInstance,{})[0],seq=processObj.seq,obj={subProcessUUID:uuid,user:{userName:LOCAL_SETTINGS.SUBSCRIPTIONS.username,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userProfileId},seq:seq,validDate:validDate,value:dataValue};void 0!=file[variableName]?eval("file."+variableName+".push(obj)"):file[variableName]=[obj]}else file[variableName]=dataValue;dao.upsert(file).then(function(e){resolve("Variable set successfully")}).catch(function(e){reject("Failed to set Variable")})}).catch(function(e){var i={_id:profileVariableFileName};if(i.channels=app.profile.channels,"periodic"==variableType){var o=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+uuid+"']",_WFInstance,{})[0],t=o.seq;i[variableName]=[{subProcessUUID:uuid,user:{userName:LOCAL_SETTINGS.SUBSCRIPTIONS.username,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userProfileId},seq:t,validDate:validDate,value:dataValue}]}else i[variableName]=dataValue;dao.upsert(i).then(function(e){resolve("Variable set successfully")}).catch(function(e){reject("Failed to set Variable")})});break;case"subProcessInstance":resolve("not implemented");break;case"step":resolve("not implemented");break;case"subProfileSubProcessInstance":var subProfileId=app.profile.subprofileId,subProfileVariableFileName=subProfileId+":variables";dao.get(subProfileVariableFileName).then(function(file){if("periodic"==variableType){var part=library.getSubprofileSubprocessIds(),seq=JSON.xpath("count(/subprocesses[_id eq '"+uuid+"']/preceding-sibling::node()[id = /subprocesses[_id eq '"+uuid+"']/id and _id = /subprocesses[_id = "+part+"]/_id])",_WFInstance,{})[0]+1,obj={subProcessUUID:uuid,user:{userName:LOCAL_SETTINGS.SUBSCRIPTIONS.username,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userProfileId},seq:seq,validDate:validDate,value:dataValue};void 0!=file[variableName]?eval("file."+variableName+".push(obj)"):file[variableName]=[obj]}else file[variableName]=dataValue;dao.upsert(file).then(function(e){resolve("Variable at subprofile set successfully")}).catch(function(e){reject("Failed to set Variable at subprofile")})}).catch(function(e){var i={_id:subProfileVariableFileName};if(i.channels=app.profile.channels,"periodic"==variableType){var o=library.getSubprofileSubprocessIds(),t=JSON.xpath("count(/subprocesses[_id eq '"+uuid+"']/preceding-sibling::node()[id = /subprocesses[_id eq '"+uuid+"']/id and _id = /subprocesses[_id = "+o+"]/_id])",_WFInstance,{})[0]+1;i[variableName]=[{subProcessUUID:uuid,user:{userName:LOCAL_SETTINGS.SUBSCRIPTIONS.username,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userProfileId},seq:t,validDate:validDate,value:dataValue}]}else i[variableName]=dataValue;dao.upsert(i).then(function(e){resolve("Variable at subprofile set successfully")}).catch(function(e){reject("Failed to set Variable at subprofile")})})}},function(e){reject("getNodeValue value not found.")})})}}}(),notification=function(){return{sendNotificationWorker:function(e,i,o){return new Promise(function(t,n){var a=function(e){return new Promise(function(t,n){var a={};void 0!=e.recipients.role?(a.role=e.recipients.role,t(a)):void 0!=e.recipients.profileRole?(a.profileRole={},a.profileRole.role=e.recipients.profileRole.role,a.profileRole.profile=e.recipients.profileRole.profile,t(a)):void 0!=e.recipients.subProfileRole?(a.subProfileRole={},a.subProfileRole.role=e.recipients.subProfileRole.role,a.subProfileRole.subProfileCategory=e.recipients.subProfileRole.subProfileCategory,a.subProfileRole.profile=e.recipients.subProfileRole.profile,t(a)):void 0!=e.recipients.function?(a.function={},a.function.users={},helper.getNodeValue(e.recipients.function.users,i,o).then(function(e){a.function.users=e,t(a)},function(e){rej(e)})):void 0!=e.recipients.stepAssignee&&(a.stepAssignee={},a.stepAssignee.role=e.recipients.stepAssignee.role,t(a))})},r=new NotificatioWorker(app),s=JSON.xpath("/subprocesses[_id eq '"+o+"']/meta-data/subprofileId",i,{})[0],p=window.location.pathname.split("/"),c=window.location.protocol+"//"+window.location.host+"/"+p[1],u="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(u=app.profile.subprofileId);var d={notification:{message:{},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:o,subProfileId:s},notificationType:"",subprofileId:u,priority:"",recipients:{},url:c,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:""}}}};d.notification.keys.profile.name=app.profile.title,d.notification.keys.profile.id=app.profile._id,d.notification.keys.community.name=app.getNameByLang(LOCAL_SETTINGS.COMMUNITY_CONFIG.communityName),d.notification.keys.community.id=LOCAL_SETTINGS.COMMUNITY_CONFIG.communityId;var l=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",LOCAL_SETTINGS.COMMUNITY_CONFIG,{})[0];if(d.notification.keys.application.name=app.getNameByLang(l.name),d.notification.keys.application.id=l.appId,d.notification.keys.currentUser.name=LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,d.notification.keys.currentUser.id=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,d.notification.keys.subProcess.name=JSON.xpath("/subprocesses[_id eq '"+o+"']/label",i,{})[0],d.notification.keys.subProcess.id=o,d.notification.message.default=e.message.default,d.notification.message.title=e.message.title,void 0!=e.message.rtf&&(d.notification.message.rtf={},void 0!=e.message.rtf.template?d.notification.message.rtf.template=e.message.rtf.template:void 0!=e.message.rtf.markup&&(d.notification.message.rtf.markup=e.message.rtf.markup)),d.notification.messageType=e.messageType,d.notification.notificationType=e.notificationType,d.notification.priority=e.priority,void 0!=e.notificationAction&&(d.notification.notificationAction={},d.notification.notificationAction.label=e.notificationAction.label,void 0!=e.notificationAction.action.URI?(d.notification.notificationAction.action={},d.notification.notificationAction.action.URI=e.notificationAction.action.URI):void 0!=e.notificationAction.action.goto&&(d.notification.notificationAction.action={},d.notification.notificationAction.action.goto=e.notificationAction.action.goto)),void 0!=e.schedule){var f=e.schedule.executeCommand,m={dateTime:"",unit:"",factor:""};if(void 0!=f.now)m.dateTime=moment().format();else if(void 0!=f.exact)m.dateTime=f.exact.dateTime;else if(void 0!=f.dueDate){var I=JSON.xpath("/subprocesses[_id eq '"+o+"']",i,{})[0],S="",b=I.dates.due;S=""!=b?moment(b,"YYYY-MM-DD"):moment().format(),m.dateTime=S,m.factor=f.dueDate.factor,m.unit=f.dueDate.unit}else if(void 0!=f.validDate){var I=JSON.xpath("/subprocesses[_id eq '"+o+"']",i,{})[0],S="",b=I.dates.valid;S=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),m.dateTime=S,m.factor=f.validDate.factor,m.unit=f.validDate.unit}else if(void 0!=f.stepCreatedDate){var I=JSON.xpath("/subprocesses[_id eq '"+o+"']",i,{})[0],S="",y=I.step.dueDateTime;S=""!=y?moment(y).format():moment().format(),m.dateTime=S,m.factor=f.stepCreatedDate.factor,m.unit=f.stepCreatedDate.unit}else m.dateTime=moment().format();r.setSchedule(m)}a(e).then(function(e){d.notification.recipients=e,r.setMessage("Worker submitted for execution"),r.setAction(d);var n=JSON.xpath("/subprocesses[_id eq '"+o+"']",i,{})[0];r.setContext({step:{stepDateTime:n.step.dateTimeCreated}}),r.send().then(function(e){console.log(r);var i=util.success("Notification Worker processes successfully.",e);t(i)},function(e){t(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),n(e)})})},reAssignmentNotification:function(e,i,o,t){return new Promise(function(n,a){var r=function(e){return new Promise(function(i,o){var t={};t.function={},t.function.users={},t.function.users=e.id,i(t)})},s=new NotificatioWorker(app),p=JSON.xpath("/subprocesses[_id eq '"+o+"']/meta-data/subprofileId",i,{})[0],c=window.location.pathname.split("/"),u=window.location.protocol+"//"+window.location.host+"/"+c[1],d={notification:{message:{rtf:{}},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:o,subProfileId:p},notificationType:"workflow",priority:"",recipients:{},url:u,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:""}}}};d.notification.keys.profile.name=app.profile.title,d.notification.keys.profile.id=app.profile._id,d.notification.keys.community.name=app.getNameByLang(LOCAL_SETTINGS.COMMUNITY_CONFIG.communityName),d.notification.keys.community.id=LOCAL_SETTINGS.COMMUNITY_CONFIG.communityId;var l=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",LOCAL_SETTINGS.COMMUNITY_CONFIG,{})[0];if(d.notification.keys.application.name=app.getNameByLang(l.name),d.notification.keys.application.id=l.appId,d.notification.keys.currentUser.name=LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,d.notification.keys.currentUser.id=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,d.notification.keys.subProcess.name=JSON.xpath("/subprocesses[_id eq '"+o+"']/label",i,{})[0],d.notification.keys.subProcess.id=o,d.notification.message.default="",d.notification.message.title=e.reAssignment.title,d.notification.message.rtf.markup=e.reAssignment.message,d.notification.messageType=e.reAssignment.messageType,d.notification.priority=e.reAssignment.priority,void 0!=e.reAssignment.notificationAction&&(d.notification.notificationAction={},d.notification.notificationAction.label=e.reAssignment.notificationAction.label,void 0!=e.reAssignment.notificationAction.action.URI?(d.notification.notificationAction.action={},d.notification.notificationAction.action.URI=e.reAssignment.notificationAction.action.URI):void 0!=e.reAssignment.notificationAction.action.goto&&(d.notification.notificationAction.action={},d.notification.notificationAction.action.goto=e.reAssignment.notificationAction.action.goto)),void 0!=e.reAssignment.schedule){var f=e.reAssignment.schedule.executeCommand,m={dateTime:"",unit:"",factor:""};if(void 0!=f.now)m.dateTime=moment().format();else if(void 0!=f.exact)m.dateTime=f.exact.dateTime;else if(void 0!=f.dueDate){var I=JSON.xpath("/subprocesses[_id eq '"+o+"']",i,{})[0],S="",b=I.dates.due;S=""!=b?moment(b,"YYYY-MM-DD"):moment().format(),m.dateTime=S,m.factor=f.dueDate.factor,m.unit=f.dueDate.unit}else if(void 0!=f.validDate){var I=JSON.xpath("/subprocesses[_id eq '"+o+"']",i,{})[0],S="",b=I.dates.valid;S=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),m.dateTime=S,m.factor=f.validDate.factor,m.unit=f.validDate.unit}else if(void 0!=f.stepCreatedDate){var I=JSON.xpath("/subprocesses[_id eq '"+o+"']",i,{})[0],S="",y=I.step.dueDateTime;S=""!=y?moment(y).format():moment().format(),m.dateTime=S,m.factor=f.stepCreatedDate.factor,m.unit=f.stepCreatedDate.unit}else m.dateTime=moment().format();s.setSchedule(m)}r(t).then(function(e){d.notification.recipients=e,s.setAction(d),s.setMessage("Worker submitted for execution"),s.send().then(function(e){var i=util.success("Notification Worker processes successfully for reassignment.",e);n(i)},function(e){n(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),a(e)})})},assignmentNotification:function(e,i,o,t){return new Promise(function(n,a){var r=function(e){return new Promise(function(i,o){var t={};t.function={},t.function.users={},t.function.users=e.id,i(t)})},s=new NotificatioWorker(app),p=JSON.xpath("/subprocesses[_id eq '"+o+"']/meta-data/subprofileId",i,{})[0],c=window.location.pathname.split("/"),u=window.location.protocol+"//"+window.location.host+"/"+c[1],d={notification:{message:{rtf:{}},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:o,subProfileId:p},notificationType:"workflow",priority:"",recipients:{},url:u,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:""}}}};d.notification.keys.profile.name=app.profile.title,d.notification.keys.profile.id=app.profile._id,d.notification.keys.community.name=app.getNameByLang(LOCAL_SETTINGS.COMMUNITY_CONFIG.communityName),d.notification.keys.community.id=LOCAL_SETTINGS.COMMUNITY_CONFIG.communityId;var l=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",LOCAL_SETTINGS.COMMUNITY_CONFIG,{})[0];if(d.notification.keys.application.name=app.getNameByLang(l.name),d.notification.keys.application.id=l.appId,d.notification.keys.currentUser.name=LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,d.notification.keys.currentUser.id=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,d.notification.keys.subProcess.name=JSON.xpath("/subprocesses[_id eq '"+o+"']/label",i,{})[0],d.notification.keys.subProcess.id=o,d.notification.message.default="",d.notification.message.title=e.assignment.title,d.notification.message.rtf.markup=e.assignment.message,d.notification.messageType=e.assignment.messageType,d.notification.priority=e.assignment.priority,void 0!=e.assignment.notificationAction&&(d.notification.notificationAction={},d.notification.notificationAction.label=e.assignment.notificationAction.label,void 0!=e.assignment.notificationAction.action.URI?(d.notification.notificationAction.action={},d.notification.notificationAction.action.URI=e.assignment.notificationAction.action.URI):void 0!=e.assignment.notificationAction.action.goto&&(d.notification.notificationAction.action={},d.notification.notificationAction.action.goto=e.assignment.notificationAction.action.goto)),void 0!=e.assignment.schedule){var f=e.assignment.schedule.executeCommand,m={dateTime:"",unit:"",factor:""};if(void 0!=f.now)m.dateTime=moment().format();else if(void 0!=f.exact)m.dateTime=f.exact.dateTime;else if(void 0!=f.dueDate){var I=JSON.xpath("/subprocesses[_id eq '"+o+"']",i,{})[0],S="",b=I.dates.due;S=""!=b?moment(b,"YYYY-MM-DD"):moment().format(),m.dateTime=S,m.factor=f.dueDate.factor,m.unit=f.dueDate.unit}else if(void 0!=f.validDate){var I=JSON.xpath("/subprocesses[_id eq '"+o+"']",i,{})[0],S="",b=I.dates.valid;S=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),m.dateTime=S,m.factor=f.validDate.factor,m.unit=f.validDate.unit}else if(void 0!=f.stepCreatedDate){var I=JSON.xpath("/subprocesses[_id eq '"+o+"']",i,{})[0],S="",y=I.step.dueDateTime;S=""!=y?moment(y).format():moment().format(),m.dateTime=S,m.factor=f.stepCreatedDate.factor,m.unit=f.stepCreatedDate.unit}else m.dateTime=moment().format();s.setSchedule(m)}r(t).then(function(e){d.notification.recipients=e,s.setAction(d),s.setMessage("Worker submitted for execution"),s.send().then(function(e){console.log(s);var i=util.success("Notification Worker processes successfully for assignment.",e);n(i)},function(e){n(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),a(e)})})},acceptanceNotification:function(e,i,o,t){return new Promise(function(n,a){var r=function(e){return new Promise(function(i,o){var t={};t.role=e,i(t)})},s=new NotificatioWorker(app),p=JSON.xpath("/subprocesses[_id eq '"+o+"']/meta-data/subprofileId",i,{})[0],c=window.location.pathname.split("/"),u=window.location.protocol+"//"+window.location.host+"/"+c[1],d={notification:{message:{rtf:{}},messageType:"","meta-data":{applicationId:i.app,communityId:i.communityId,profileId:i.profile,subProcessUUID:o,subProfileId:p},notificationType:"workflow",priority:"",recipients:{},url:u,keys:{profile:{name:"",id:""},community:{name:"",id:""},application:{name:"",id:""},currentUser:{name:"",id:""},subProcess:{name:"",id:""}}}};d.notification.keys.profile.name=app.profile.title,d.notification.keys.profile.id=app.profile._id,d.notification.keys.community.name=app.getNameByLang(LOCAL_SETTINGS.COMMUNITY_CONFIG.communityName),d.notification.keys.community.id=LOCAL_SETTINGS.COMMUNITY_CONFIG.communityId;var l=JSON.xpath("/applications[appId eq '"+app.SCOPE.applicationId+"']",LOCAL_SETTINGS.COMMUNITY_CONFIG,{})[0];if(d.notification.keys.application.name=app.getNameByLang(l.name),d.notification.keys.application.id=l.appId,d.notification.keys.currentUser.name=LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,d.notification.keys.currentUser.id=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,d.notification.keys.subProcess.name=JSON.xpath("/subprocesses[_id eq '"+o+"']/label",i,{})[0],d.notification.keys.subProcess.id=o,d.notification.message.default="",d.notification.message.title=e.assignmentAcceptance.title,d.notification.message.rtf.markup=e.assignmentAcceptance.message,d.notification.messageType=e.assignmentAcceptance.messageType,d.notification.priority=e.assignmentAcceptance.priority,void 0!=e.assignmentAcceptance.notificationAction&&(d.notification.notificationAction={},d.notification.notificationAction.label=e.assignmentAcceptance.notificationAction.label,void 0!=e.assignmentAcceptance.notificationAction.action.URI?(d.notification.notificationAction.action={},d.notification.notificationAction.action.URI=e.assignmentAcceptance.notificationAction.action.URI):void 0!=e.assignmentAcceptance.notificationAction.action.goto&&(d.notification.notificationAction.action={},d.notification.notificationAction.action.goto=e.assignmentAcceptance.notificationAction.action.goto)),void 0!=e.assignmentAcceptance.schedule){var f=e.assignmentAcceptance.schedule.executeCommand,m={dateTime:"",unit:"",factor:""};if(void 0!=f.now)m.dateTime=moment().format();else if(void 0!=f.exact)m.dateTime=f.exact.dateTime;else if(void 0!=f.dueDate){var I=JSON.xpath("/subprocesses[_id eq '"+o+"']",i,{})[0],S="",b=I.dates.due;S=""!=b?moment(b,"YYYY-MM-DD"):moment().format(),m.dateTime=S,m.factor=f.dueDate.factor,m.unit=f.dueDate.unit}else if(void 0!=f.validDate){var I=JSON.xpath("/subprocesses[_id eq '"+o+"']",i,{})[0],S="",b=I.dates.valid;S=""!=validDate?moment(validDate,"YYYY-MM-DD"):moment().format(),m.dateTime=S,m.factor=f.validDate.factor,m.unit=f.validDate.unit}else if(void 0!=f.stepCreatedDate){var I=JSON.xpath("/subprocesses[_id eq '"+o+"']",i,{})[0],S="",y=I.step.dueDateTime;S=""!=y?moment(y).format():moment().format(),m.dateTime=S,m.factor=f.stepCreatedDate.factor,m.unit=f.stepCreatedDate.unit}else m.dateTime=moment().format();s.setSchedule(m)}r(t).then(function(e){d.notification.recipients=e,s.setAction(d),s.setMessage("Worker submitted for execution"),s.setContext({process:{}}),s.send(s).then(function(e){console.log(s);var i=util.success("Notification Worker processes successfully for assignment.",e);n(i)},function(e){n(e)})}).catch(function(e){console.log("Notification - getRecipients failed with error "+e),a(e)})})}}}(),report=function(){return{createPerformanceReport:function(e,i,o){return new Promise(function(t,n){var a=worker.getWorkerWrapper(),r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=i.profile,a.subProcessUUID=o,a.subprofileId=r,a.channels.push("createPerformanceReport"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=e.workplanSetId,p=e.configSetId,c=JSON.xpath("/indicators[category/term eq '"+s+"']/_id",app.SCOPE.workflow,{})[0],u=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+p+"']/instances[1]/uuid",i,{})[0],d={createPerformanceReport:{workplanUUID:c,configUUID:u,profilId:i.profile}};a.action=d,worker.send(a).then(function(e){worker.setWorkerInfoInSubprocess(a,i,o);var n=util.success("WorkplanReport Worker processed successfully.",e);t(n)},function(e){n(e)})})},createReport:function(e,i,o){return new Promise(function(t,n){var a=worker.getWorkerWrapper(),r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=i.profile,a.subProcessUUID=o,a.subprofileId=r,a.channels.push("executeReport"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=e.PerformanceReportDefinitionSetId,p=e.reportingSDOSetId,c=JSON.xpath("/indicators[category/term eq '"+s+"']/_id",i,{})[0],u=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+p+"']/instances[1]/uuid",i,{})[0],d={createReport:{performanceReportDefinition:c,reportingSDO:u,profilId:i.profile}};a.action=d,worker.send(a).then(function(e){worker.setWorkerInfoInSubprocess(a,i,o);var n=util.success("Reprot Worker processed successfully.",e);t(n)},function(e){n(e)})})},sdoReport:function(e,i,o){return new Promise(function(t,n){var a=worker.getWorkerWrapper(),r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=i.profile,a.subProcessUUID=o,a.subprofileId=r,a.channels.push("sdoReport"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=e.indicatorSetId,p=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+s+"']/instances[1]/uuid",i,{})[0],c={sdoReport:{sdoReportUUID:p,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:o}};a.action=c,worker.send(a).then(function(e){worker.setWorkerInfoInSubprocess(a,i,o);var n=util.success("report Worker processed successfully.",e);t(n)},function(e){n(e)})})},executeReport:function(e,i,o){return new Promise(function(t,n){var a=worker.getWorkerWrapper(),r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId),
a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=i.profile,a.subProcessUUID=o,a.subprofileId=r,a.channels.push("executeReport"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=e.SDOreportSetId,p=e.reportingSDOSetid,c=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+s+"']/instances[1]/uuid",i,{})[0],u=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+p+"']/instances[1]/uuid",i,{})[0];void 0==c&&(c=JSON.xpath("/indicators[category/term eq '"+s+"']/_id",i,{})[0]);var d={executeReport:{sdoReportUUID:c,reportingSDOUUID:u,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:o}};a.action=d,worker.send(a).then(function(e){worker.setWorkerInfoInSubprocess(a,i,o);var n=util.success("report Worker processed successfully.",e);t(n)},function(e){n(e)})})},generateView:function(e,i,o){return new Promise(function(t,n){var a=worker.getWorkerWrapper(),r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=i.profile,a.subProcessUUID=o,a.subprofileId=r,a.channels.push("sdoReport"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=e.ViewConfigSetId,p=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+s+"']/instances[1]/uuid",i,{})[0],c={generateView:{viewConfigUUID:p,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:o}};a.action=c,worker.send(a).then(function(e){worker.setWorkerInfoInSubprocess(a,i,o);var n=util.success("report Worker processed successfully.",e);t(n)},function(e){n(e)})})},requestReport:function(e,i,o){return new Promise(function(t,n){var a=worker.getWorkerWrapper(),r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=i.profile,a.subProcessUUID=o,a.subprofileId=r,a.channels.push("executeReport"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=e.sdoRequestReportSetId,p=e.sdoReportCreationSetId,c=e.performanceReportSetId,u=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+s+"']/instances[1]/uuid",i,{})[0],d=JSON.xpath("/indicators[category/term eq '"+p+"']/_id",i,{})[0],l=JSON.xpath("/indicators[category/term eq '"+c+"']/_id",i,{})[0],f={requestReport:{performanceReportUUID:l,sdoRequestReportUUID:u,sdoReportCreationUUID:d,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:o}};a.action=f,worker.send(a).then(function(e){worker.setWorkerInfoInSubprocess(a,i,o);var n=util.success("Request report Worker processed successfully.",e);t(n)},function(e){n(e)})})},generateBasicView:function(e,i,o){return new Promise(function(t,n){var a=worker.getWorkerWrapper(),r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=i.profile,a.subProcessUUID=o,a.subprofileId=r,a.channels.push("sdoReport"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=e.sdoDataObjectViewSetId,p=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+s+"']/instances[1]/uuid",i,{})[0],c={generateBasicView:{sdoDataObjectViewUUID:p,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:o}};a.action=c,worker.send(a).then(function(e){worker.setWorkerInfoInSubprocess(a,i,o);var n=util.success("generateBasicView Worker processed successfully.",e);t(n)},function(e){n(e)})})},generateUnionView:function(e,i,o){return new Promise(function(t,n){var a=worker.getWorkerWrapper(),r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=i.profile,a.subProcessUUID=o,a.subprofileId=r,a.channels.push("sdoReport"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=e.sdoDataObjectViewUnionSetId,p=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+s+"']/instances[1]/uuid",i,{})[0],c={generateUnionView:{sdoDataObjectViewUnionUUID:p,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:o}};a.action=c,worker.send(a).then(function(e){worker.setWorkerInfoInSubprocess(a,i,o);var n=util.success("generateUnionView Worker processed successfully.",e);t(n)},function(e){n(e)})})},sdoReportMultiple:function(e,i,o){return new Promise(function(t,n){var a=worker.getWorkerWrapper(),r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=i.profile,a.subProcessUUID=o,a.subprofileId=r,a.channels.push("sdoReport"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=e.sdoReportCreationSetId,p=e.sdoReportViewsSetId,c=e.sdoReportJoinsSetId,u=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+s+"']/instances[1]/uuid",i,{})[0],d=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+p+"']/instances[1]/uuid",i,{})[0],l=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+c+"']/instances[1]/uuid",i,{})[0],f={sdoReportMultiple:{sdoReportCreationUUID:u,sdoReportViewsUUID:d,sdoReportJoinsUUID:l,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:o}};a.action=f,worker.send(a).then(function(e){worker.setWorkerInfoInSubprocess(a,i,o);var n=util.success("sdoReportMultiple Worker processed successfully.",e);t(n)},function(e){n(e)})})},subprofileQuarterlyReport:function(e,i,o){return new Promise(function(t,n){var a=worker.getWorkerWrapper(),r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=i.profile,a.subProcessUUID=o,a.subprofileId=r,a.channels.push("executeReport"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=e.scheduleReportIndicator,p=JSON.xpath("/indicators[category/term eq '"+s+"']/_id",i,{})[0],c=e.sdoReportApprovalIndicator,u=JSON.xpath("/indicators[category/term eq '"+c+"' and workflows[1]/processes[1]/subProcessUUID eq '"+o+"']/_id",i,{})[0],d={subprofileQuarterlyReport:{scheduleReportIndicatorUUID:p,sdoReportApprovalIndicatorUUID:u,subprofileCode:app.profile.subProfile.code,subprofileTitle:app.profile.subProfile.title,applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.workflow.profile,subProcessUUID:o}};a.action=d,worker.send(a).then(function(e){worker.setWorkerInfoInSubprocess(a,i,o);var n=util.success("QuarterlyReport report Worker processed successfully.",e);t(n)},function(e){n(e)})})}}}(),participants=function(){return{linkParticipants:function(e,i,o){return new Promise(function(t,n){var a=worker.getWorkerWrapper(),r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=i.profile,a.subProcessUUID=o,a.subprofileId=r,a.channels.push("navigation"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=e.EPWPLinkParticipantsInBulkId,p=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+s+"']/instances[1]/uuid",i,{})[0],c=e.EPWPLocalityId,u=JSON.xpath("/indicators[category/term eq '"+c+"']/_id",i,{})[0],d=e.EPWPActiveParticipantsId,l=JSON.xpath("/indicators[category/term eq '"+d+"']/_id",i,{})[0],f={linkParticipants:{EPWPLinkParticipantsInBulkIdUUID:p,EPWPLocalityIdUUID:u,EPWPActiveParticipantsIdUUID:l,profilId:i.profile}};a.action=f,worker.send(a).then(function(e){worker.setWorkerInfoInSubprocess(a,i,o);var n=util.success("EPWPLinkParticipants Worker processed successfully.",e);t(n)},function(e){n(e)})})},monthlyAttendance:function(e,i,o){return new Promise(function(t,n){var a=worker.getWorkerWrapper(),r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=i.profile,a.subProcessUUID=o,a.subprofileId=r,a.channels.push("navigation"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=e.EPWPMonthlyAttendanceBulkUploadUUID,p=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+s+"']/instances[1]/uuid",i,{})[0],c=e.EPWPActiveParticipantsIdUUID,u=JSON.xpath("/indicators[category/term eq '"+c+"']/_id",i,{})[0],d=e.EPWPMonthlyEmploymentPerLocalityUUID,l=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+d+"']/instances[1]/uuid",i,{})[0],f={monthlyAttendance:{EPWPMonthlyAttendanceBulkUploadUUID:p,EPWPActiveParticipantsIdUUID:u,EPWPMonthlyEmploymentPerLocalityUUID:l,profilId:i.profile}};a.action=f,worker.send(a).then(function(e){worker.setWorkerInfoInSubprocess(a,i,o);var n=util.success("monthlyAttendance Worker processed successfully.",e);t(n)},function(e){n(e)})})},monthlyProgressSummary:function(e,i,o){return new Promise(function(t,n){var a=worker.getWorkerWrapper(),r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=i.profile,a.subProcessUUID=o,a.subprofileId=r,a.channels.push("navigation"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=e.EPWPMonthlyProgressSummaryIdUUID,p=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+s+"']/instances[1]/uuid",i,{})[0],c={monthlyProgressSummary:{EPWPMonthlyProgressSummaryIdUUID:p,profilId:i.profile}};a.action=c,worker.send(a).then(function(e){worker.setWorkerInfoInSubprocess(a,i,o);var n=util.success("monthlyAttendance Worker processed successfully.",e);t(n)},function(e){n(e)})})},participantContracts:function(e,i,o){return new Promise(function(t,n){var a=worker.getWorkerWrapper(),r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=i.profile,a.subProcessUUID=o,a.subprofileId=r,a.channels.push("navigation"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=e.EPWPParticipantContractsIdUUID,p=JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+s+"']/instances[1]/uuid",i,{})[0],c={participantContracts:{EPWPParticipantContractsIdUUID:p,profilId:i.profile}};a.action=c,worker.send(a).then(function(e){worker.setWorkerInfoInSubprocess(a,i,o);var n=util.success("participantContracts Worker processed successfully.",e);t(n)},function(e){n(e)})})}}}(),worker=function(){return{getWorkerWrapper:function(){var e={source:"remote",type:"workerObject",_id:"",channels:[],profileId:"",communityId:"",applicationId:"",subProcessUUID:"",message:"",messageType:"info",createdDateTime:"",senderUserId:"",subProfileId:"",action:{}};return e},send:function(e){return new Promise(function(i,o){console.log("Submitting Worker Object to server"),console.log(e),dao.save(e).then(function(e){i(e)}).catch(function(e){console.log("Error submitting worker response !!"+e),o(e)})})},sendWorker:function(e,i,o){return new Promise(function(t,n){var a=worker.getWorkerWrapper(),r="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(r=app.profile.subprofileId),a._id=generateUUID(),a.communityId=app.SCOPE.getCommunityId(),a.applicationId=app.SCOPE.applicationId,a.createdDateTime=moment().format(),a.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,a.profileId=i.profile,a.subProcessUUID=o,a.subprofileId=r,a.channels.push("sendWorker"),a.channels.push("community_"+app.SCOPE.getCommunityId());var s=function(e,t,n){return new Promise(function(a,r){helper.getNodeValue(e,i,o).then(function(e){a({seq:t,paramName:n,dataValue:e})},function(e){r(e)})})},p=function(e){return new Promise(function(t,n){for(var a=[],r=e.length,p=0;p<e.length;p++){var c=e[p].parameterValue,u=e[p].seq,d=e[p].parameterName;s(c,u,d).then(function(e){a.push({seq:e.seq,paramName:e.paramName,paramValue:e.dataValue}),r--,0==r&&(a.push({seq:r+1,paramName:"communityId",paramValue:i.communityId}),a.push({seq:r+2,paramName:"applicationId",paramValue:i.app}),a.push({seq:r+3,paramName:"profileId",paramValue:i.profile}),a.push({seq:r+4,paramName:"subProcessUUID",paramValue:o}),t(a))},function(e){r--,0==r&&(a.push({seq:r+1,paramName:"communityId",paramValue:i.communityId}),a.push({seq:r+2,paramName:"applicationId",paramValue:i.app}),a.push({seq:r+3,paramName:"profileId",paramValue:i.profile}),a.push({seq:r+4,paramName:"subProcessUUID",paramValue:o}),t(a))})}})};if(void 0!=e.rest){var c=e.rest.parameters;p(c).then(function(r){var s={sendWorker:{rest:{}}};s.sendWorker.rest.uri=e.rest.uri,s.sendWorker.rest.profilId=i.profile,s.sendWorker.rest.parameters=r,a.action=s,worker.send(a).then(function(e){var r=JSON.xpath("/subprocesses[_id eq '"+o+"']",i,{})[0];r.spStatus="submitted",void 0==r.messages&&(r.messages=[]);var s={message:{i18n:{_id:"",en:"Server request is pending",pt:"Server request is pending"}},type:"info"};r.messages.push(s),void 0==r.workers&&(r.workers=[]),r.workers.push({workerId:a._id,dateTime:moment().format()}),persistData("subprocesses",app.SCOPE.workflow,o).then(function(i){var o=util.success("Worker Rest processed successfully.",e);t(o)}).catch(function(e){console.log("Worker submitted subprocess file update failed"),n(e)})},function(e){console.log("Worker failed "),n(e)})},function(e){console.log("parameter creation failed. Abording worker object")})}else if(void 0!=e.functional){var c=e.functional.parameters;p(c).then(function(r){var s={sendWorker:{functional:{}}};s.sendWorker.functional.methodName=e.functional.methodName,s.sendWorker.functional.profilId=i.profile,s.sendWorker.functional.parameters=r,a.action=s,worker.send(a).then(function(e){var r=JSON.xpath("/subprocesses[_id eq '"+o+"']",i,{})[0];r.spStatus="submitted",void 0==r.messages&&(r.messages=[]);var s={message:{i18n:{_id:"",en:"Server request is pending",pt:"Server request is pending"}},type:"info"};r.messages.push(s),void 0==r.workers&&(r.workers=[]),r.workers.push({workerId:a._id,dateTime:moment().format()}),persistData("subprocesses",app.SCOPE.workflow,o).then(function(i){var o=util.success("Worker functional processed successfully.",e);t(o)}).catch(function(e){console.log("Worker submitted subprocess file update failed"),n(e)})},function(e){console.log("Worker failed "),n(e)})},function(e){console.log("parameter creation failed. Abording worker object")})}})},executeLocal:function(workerConfig,_WFInstance,uuid){return new Promise(function(resolve,reject){var processGetNodeValue=function(e,i,o){return new Promise(function(t,n){helper.getNodeValue(e,_WFInstance,uuid).then(function(e){t({seq:i,dataType:o,dataValue:e})},function(e){n(e)})})},processParams=function(e){return new Promise(function(i,o){for(var t=[],n=e.length,a=0;a<e.length;a++){var r=e[a].parameterValue,s=e[a].seq,p=e[a].dataType.dataType;processGetNodeValue(r,s,p).then(function(e){t.push({seq:e.seq,dataType:e.dataType,paramValue:e.dataValue}),n--,0==n&&i(t)},function(e){n--,0==n&&i(t)})}})},fixParamType=function(e,i){switch(i){case"string":var o=e.replace(/'/g,"\\'");return"'"+o+"'";case"date":case"dateTime":return"'"+e+"'";case"number":case"decimal":return e}},methodName=workerConfig.methodName,configParam=workerConfig.parameters;processParams(configParam).then(function(paramsArray){for(var pList="",i=0;i<paramsArray.length-1;i++)pList=pList+fixParamType(paramsArray[i].paramValue,paramsArray[i].dataType)+",";pList+=fixParamType(paramsArray[i].paramValue,paramsArray[i].dataType);var callbackSuccess=function(){return resolve("Function '"+methodName+"' executed. Response success.")},callbackFailure=function(){return reject("Function '"+methodName+"' executed. Response failed.")},spUUID="'"+uuid+"'",func=methodName+"("+pList+",callbackSuccess, callbackFailure,"+spUUID+")",exe=eval(func);console.log(exe),resolve("Local function executed")},function(e){console.log("parameter creation failed. Abording worker object"),reject(e)})})},setWorkerInfoInSubprocess:function(e,i,o){var t=JSON.xpath("/subprocesses[_id eq '"+o+"']",i,{})[0],n={message:{i18n:{_id:"",en:"Worker submitted",pt:"Worker submitted"}},type:"info"};t.messages=[],t.messages.push(n),void 0==t.workers&&(t.workers=[]),t.workers.push({workerId:e._id,dateTime:moment().format()})},create:function(e,i,o){return new Promise(function(t,n){var a=e.channel,r=e.action,s=worker.getWorkerWrapper(),p="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(p=app.profile.subprofileId),s._id=generateUUID(),s.communityId=app.SCOPE.getCommunityId(),s.applicationId=app.SCOPE.applicationId,s.createdDateTime=moment().format(),s.senderUserId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId,s.profileId=i.profile,s.subProcessUUID=o,s.subprofileId=p,s.channels.push(a),s.channels.push("community_"+app.SCOPE.getCommunityId());var c={};c[r]={};for(var u=0;u<e.indicators.length;u++){var d=e.indicators[u].label,l=e.indicators[u].setId,f=e.indicators[u].context,m="";m="subProcess"==f?JSON.xpath("/subprocesses[_id eq '"+o+"']/indicators[id eq '"+l+"']/instances[1]/uuid",i,{})[0]:JSON.xpath("/indicators[category/term eq '"+l+"']/_id",i,{})[0],c[r][d]=m}c[r].profilId=i.profile,s.action=c,worker.send(s).then(function(e){worker.setWorkerInfoInSubprocess(s,i,o);var n=util.success(r+" worker processed successfully.",e);t(n)},function(e){n(e)})})}}}(),user=function(){return{addToRole:function(e,i,o){return new Promise(function(t,n){helper.getNodeValue(e.userName,o,i).then(function(a){helper.getNodeValue(e.userId,o,i).then(function(i){var o=JSON.xpath("/roles[id eq '"+e.roleId+"']/type",app.SCOPE.APP_CONFIG,{})[0];"instance"==o?rolesManager.doUserRegistration(i,a,e.roleId,"instance").then(function(e){var i=util.success("Role assigned to user in context instance",e);t(i)}).catch(function(e){console.log("rolesManager- instance fail"),t("role update failed")}):"subprofile"==o?rolesManager.doUserRegistration_node(i,a,e.roleId,"subprofile").then(function(e){var i=util.success("Role assigned to user in context subprofile",e);t(i)}).catch(function(e){console.log("rolesManager- subprofile fail"),t("role update failed")}):"adoption"==o?rolesManager.doUserRegistration_adoption(i,a,e.roleId,"adoption").then(function(e){var i=util.success("Role assigned to user in context adoption",e);t(i)}).catch(function(e){console.log("rolesManager- adoption fail"),t("role update failed")}):(console.log("Role not found in any context"),n("Role not found in any context"))}).catch(function(e){n(e)})}).catch(function(e){n(e)})})}}}();module.exports={community:community,application:application,performance:performance,worker:worker,sdo:sdo,taxonomy:taxonomy,subProcessInstance:subProcessInstance,variables:variables,notification:notification,report:report,participants:participants,user:user};

},{"./form":3,"./helper":4,"./nodeValue":6,"utility":8}],3:[function(require,module,exports){
"use strict";function create(args){var processId=args[0]||"",subProcess=args[1]||{},step=args[2]||{},action=args[3]||{},_WFInstance=args[6]||{},data=args[6]||{},indicators=subProcess.indicators||[],result=[],indicatorType=action._type,processSeq=args[4]||"",subProcessSeq=args[5]||"",createType=args[7]||"",subProcessId=subProcess._id,uuid=args[8]||"",baseUUID=args[9]||"",profile=_WFInstance.profile,inputData=args[10]||{},formCreateType=action.method.form.create,formType=action.method.form.type,paramObject={formCreateType:formCreateType,formType:formType};return new Promise(function(resolve,reject){for(var toProcess=indicators.length,subprocessType=JSON.xpath("/config/processes/subProcesses[_id eq '"+subProcessId+"']/type",_WFInstance,{})[0],formCreateFn=function(indicatorType,indicatorId,validDate,instantiateSource){gatekeeper.instantiate(baseUUID,indicatorType,indicatorId,_WFInstance.profile,validDate,subProcessId,subprocessType).then(function(docArray){for(var i=0;i<docArray.length;i++){var object=docArray[i];if(!object.model._id.endsWith(":approved")&&!object.model._id.endsWith(":rejected")){object.model.model.pending.validDate=validDate,object.model.model.pending.subProcessUUID=uuid;var workflowObj={id:_WFInstance.config._id,instance:_WFInstance.instance._id,processes:[{id:processId,subProcessId:subProcess._id,subProcessUUID:uuid,step:{id:step.id,seq:step.seq,startDate:"",status:step.status,message:step.message,assignedTo:{userId:step.assignedTo.userId,name:step.assignedTo.name},comment:step.comment,complete:!1,endDate:""}}]};void 0!=action.setWorkflowLabelInTitle&&""!=action.setWorkflowLabelInTitle&&1==action.setWorkflowLabelInTitle&&(object.model.title=inputData.label),void 0!=action.setDraft&&""!=action.setDraft&&1==action.setDraft&&(object.model.control.draft=!0),object.model.workflows.push(workflowObj);var mainId=object.model._id;gatekeeper.persist(docArray).then(function(savedArray){dao.get(mainId).then(function(data){var indicatorModel=ko.mapping.fromJS({defaultModel:{setId:indicatorId}});gatekeeper.instantiateData(mainId,instantiateSource,indicatorModel,data.model.pending.seq,paramObject).then(function(data){if("200"==data[0].status){if(void 0!=action.setWorkflowLabelInField&&""!=action.setWorkflowLabelInField){var assignmentSetId=action.setWorkflowLabelInField.split(".")[0];if(assignmentSetId==indicatorId){console.log(data[0]);var txt=inputData.label,squote=txt.replace(/'/g,"\\'"),path="data[0].model.model.pending.data."+action.setWorkflowLabelInField+"='"+squote+"'";eval(path)}}gatekeeper.persist(data).then(function(e){dao.get(mainId).then(function(e){if(0==_WFInstance.indicators.length)_WFInstance.indicators.push(e),toProcess--,0==toProcess&&persistData("indicators",_WFInstance,uuid).then(function(e){var t=util.success("Form create indicator persist success.",_WFInstance.indicators);resolve(t)}).catch(function(e){console.error(e);var t=util.success("Form create indicator persist failed."+e[0].message,{});reject(t)});else{for(var t=!1,s=0;s<_WFInstance.indicators.length;s++){var i=_WFInstance.indicators[s];i._id==e._id&&(t=!0,_WFInstance.indicators.splice(s,1),_WFInstance.indicators.push(e),toProcess--,0==toProcess&&persistData("indicators",_WFInstance,uuid).then(function(e){var t=util.success("Form create indicator persist success.",_WFInstance.indicators);resolve(t)}).catch(function(e){console.error(e);var t=util.success("Form create indicator persist failed."+e[0].message,{});reject(t)}))}0==t&&(_WFInstance.indicators.push(e),toProcess--,0==toProcess&&persistData("indicators",_WFInstance,uuid).then(function(e){var t=util.success("Form create indicator persist success.",_WFInstance.indicators);resolve(t)}).catch(function(e){console.error(e);var t=util.success("Form create indicator persist failed."+e[0].message,{});reject(t)}))}}).catch(function(e){console.error(e);var t=util.success("1 Gatekeeper initialisation failed with initialiseData message "+e[0].message,{});reject(t)})},function(e){console.error(e);var t=util.success("2 Gatekeeper initialisation failed with initialiseData message "+e[0].message,{});reject(t)})}else{var failure=util.success("3 Gatekeeper initialisation failed with initialiseData message "+err[0].message,{});reject(failure)}},function(e){var t=util.success("4 Gatekeeper initialisation failed with initialiseData message "+e[0].message,{});reject(t)})}).catch(function(e){console.error(e);var t=util.success("5 Gatekeeper initialisation failed with initialiseData message "+e[0].message,{});reject(t)})},function(e){console.error(e);var t=util.success("6 Gatekeeper initialisation failed with initialiseData message "+e[0].message,{});reject(t)})}}},function(e){for(var t=[],s=0;s<_WFInstance.instance.processes.length;s++)_WFInstance.instance.processes[s].subProcesses.length>0&&t.push(_WFInstance.instance.processes[s]);_WFInstance.instance.processes=[],_WFInstance.instance.processes=t;for(var i=[],s=0;s<_WFInstance.subprocesses.length;s++)_WFInstance.subprocesses[s].indicators.length>0&&i.push(_WFInstance.subprocesses[s]);_WFInstance.subprocesses=[],_WFInstance.subprocesses=i,console.error(e);var a=util.success("7 Gatekeeper initialisation failed with initialiseData message "+e[0].message,{});reject(a)})},instantiateSource=FROM_DEFINITION,counter=0;counter<indicators.length;counter++){var indicatorId=indicators[counter]._id,indicatorName=util.getName(indicators[counter].name,"en"),source=indicators[counter].initiateData,initType="";void 0!=subProcess.instanceType.newSequence?initType=INSTANCE_TYPE_NEW_SEQ:void 0!=subProcess.instanceType.newInstance&&(initType=INSTANCE_TYPE_NEW_INS);var indicatorDoc={};if(void 0!=baseUUID&&""!=baseUUID&&baseUUID.length>0){var sp=JSON.xpath("/subprocesses[_id eq '"+baseUUID+"']",_WFInstance,{})[0];void 0==subProcess.periodType.periodic&&baseUUID!=uuid&&(sp.active=!1),instantiateSource=FROM_AUTHORISED}else{var cardinality=JSON.xpath("/indicators[setId eq '"+indicatorId+"']/cardinality",app.SCOPE.APP_CONFIG,{})[0];if(initType==INSTANCE_TYPE_NEW_INS)if(cardinality==INDICATOR_CARDINALITY_SINGLE){var existingUUID=JSON.xpath("/indicators[category/term eq '"+indicatorId+"']/_id",_WFInstance,{});instantiateSource=existingUUID.length>0?FROM_AUTHORISED:FROM_DEFINITION}else instantiateSource=FROM_DEFINITION;else if(cardinality==INDICATOR_CARDINALITY_SINGLE){var existingUUID=JSON.xpath("/indicators[category/term eq '"+indicatorId+"']/_id",app.SCOPE.workflow,{});instantiateSource=existingUUID.length>0?FROM_AUTHORISED:FROM_DEFINITION}else{var path="/indicators[category/term eq '"+indicatorId+"' and id = /subprocesses[id = '"+subProcessId+"']/indicators/instances/uuid]/_id",part=library.getSubprofileSubprocessIds();subprocessType==PROCESS_TYPE_SUBPROFILE&&(path="/indicators[category/term eq '"+indicatorId+"' and id = /subprocesses[id = '"+subProcessId+"' and id = "+part+"]/indicators/instances/uuid]/_id");var existingUUID=JSON.xpath(path,_WFInstance,{});instantiateSource=existingUUID.length>0?FROM_AUTHORISED:FROM_DEFINITION}}formCreateFn(initType,indicatorId,"",instantiateSource)}})}function setInstanceTitle(e){var t=e[0]||{},s=e[2]||"",i=e[4]||{},a=i.label;return new Promise(function(e,i){for(var r=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],n=r.indicators,o=0;o<n.length;o++){var c=n[o].instances[0].uuid,d=JSON.xpath("/indicators[_id eq '"+c+"']",t,{})[0];d.title=n[o].id+" "+a}e("Set Title Success",n)})}function deleteProfile(e){var t=e[0]||{},s=t.profile;return new Promise(function(e,i){var a="";void 0!=app.profile&&void 0!=app.profile.subprofileId&&(a=app.profile.subprofileId);var r={source:"remote",type:"workerObject",_id:generateUUID(),channels:["deleteProfile","community_"+app.SCOPE.getCommunityId()],communityId:app.SCOPE.getCommunityId(),applicationId:app.SCOPE.applicationId,profileId:t.profile,message:"",subprofileId:a,messageType:"info",createdDateTime:moment().format(),senderUserId:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,notification:{},profile:{action:"deleteProfile",profileId:s}};console.log(r),dao.upsert(r).then(function(t){console.log("Worker Object submitted for profile("+s+") deletion."),console.log(t),e(t)}).catch(function(e){console.log(e),i(data)})})}function createProfile(e){var t=e[1]||{},s=t.communityId,i=t.profile;return new Promise(function(e,t){library.createProfileDocuments(s,i).then(function(t){var s=util.success("Form created successfully.",t);e(s)}).catch(function(e){console.error(e);var s=util.success("ERROR: Profile creation failed"+e[0].message,{});t(s)})})}function setDraft(e){var t=e[0]||{},s=(t.communityId,t.profile,e[2]||"");return new Promise(function(e,i){for(var a=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],r=a.indicators,n=0;n<r.length;n++){var o=r[n].instances[0].uuid,c=JSON.xpath("/indicators[_id eq '"+o+"']",t,{})[0];c.control.draft=!0}e("Set Draft Success",r)})}function setUnDraft(e){var t=e[0]||{},s=(t.communityId,t.profile,e[2]||"");return new Promise(function(e,i){for(var a=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],r=a.indicators,n=0;n<r.length;n++){var o=r[n].instances[0].uuid,c=JSON.xpath("/indicators[_id eq '"+o+"']",t,{})[0];c.control.draft=!1}e("Set Draft Success",r)})}function save(e){var t={complete:!0,data:[]};return new Promise(function(e,s){var i=util.success("Form indicator set saved successfully.",t);e(i)})}function submit(e){var t={complete:!0,data:[]};return new Promise(function(e,s){var i=util.success("Form submitted successfully.",t);e(i)})}function authorise(e){var t=(e[0]||"",e[1]||{}),s=(t._id,e[2]||"",e[3]||"",e[4]||{}),i=e[6]||"";return new Promise(function(e,t){for(var a=JSON.xpath("/subprocesses[_id eq '"+i+"']/indicators/instances/uuid",s,{}),r=a.length,n=[],o=[],c=0;c<a.length;c++)gatekeeper.authorise(a[c]).then(function(a){gatekeeper.persist(a).then(function(a){for(var c="",d=0;d<a.length;d++)a[d].id.endsWith(":approved")||(c=a[d].id);dao.get(c).then(function(a){if(0==s.indicators.length)s.indicators.push(a),r--,0==r&&persistData("indicators",s,i).then(function(t){var s=util.success("Form authorised successfully.",n);e(s)}).catch(function(e){console.error(e);var s=util.success("Form authorised persist failed."+e[0].message,{});t(s)});else{for(var c=!1,d=0;d<s.indicators.length;d++){var u=s.indicators[d];if(u._id==a._id&&(c=!0,o.push(a),r--,0==r)){for(var l=s.indicators.length,p=o.length,f=0;f<l;f++){for(var I=!1,m=0;m<p;m++)s.indicators[f]._id==o[m]._id&&(I=!0);I||o.push(s.indicators[f])}s.indicators=o;break}}1==c&&0==r&&persistData("indicators",s,i).then(function(t){var s=util.success("Form authorised successfully.",n);e(s)}).catch(function(e){console.error(e);var s=util.success("Form authorised persist failed."+e[0].message,{});t(s)})}}).catch(function(e){console.error(e)})},function(e){console.error(err)})},function(t){if(r--,0==r){var s=util.success("Form authorised successfully.",n);e(s)}})})}function close(e){var t={complete:!0,data:[]};return new Promise(function(e,s){var i=util.success("Form closed successfully.",t);e(i)})}function updateIndicator(args){var _WFInstance=args[0]||{},uuid=args[1]||"",path=args[2]||"",dataValue=args[3]||"";return new Promise(function(resolve,reject){var setId=path.split(".",1)[0],indObject=JSON.xpath("/indicators[workflows/processes/subProcessUUID = '"+uuid+"' and category/term = '"+setId+"']",_WFInstance,{})[0],squote=dataValue+"".replace(/'/g,"\\'"),expr="indObject.model.pending.data."+path+" = '"+squote+"'";eval(expr);var itemsToProcess=1,stuff=[],obj={};obj.model=indObject,stuff.push(obj);var success=util.success("Indicator updated.",stuff);resolve(success)})}function updateIndicatorWrapper(args){var _WFInstance=args[0]||{},uuid=args[1]||"",path=args[2]||"",dataValue=args[3]||"",indicatorSetId=args[4]||"";return new Promise(function(resolve,reject){var indObject=JSON.xpath("/indicators[workflows/processes/subProcessUUID = '"+uuid+"' and category/term = '"+indicatorSetId+"']",_WFInstance,{})[0],squote=dataValue.replace(/'/g,"\\'"),expr="indObject."+path+" = '"+squote+"'";eval(expr);var itemsToProcess=1,stuff=[],obj={};obj.model=indObject,stuff.push(obj);var success=util.success("Indicator updated.",stuff);resolve(success)})}function markUpdateIndicator(e){var t=e[0]||{},s=e[1]||"",i=e[2]||"",a=e[3]||"";return new Promise(function(e,r){var n=JSON.xpath("/indicators[workflows/processes/subProcessUUID = '"+s+"' and category/term = '"+a+"']",t,{})[0];n.model.pending.status=i;var o=[],c={};c.model=n,o.push(c);var d=util.success("Indicator updated.",o);e(d)})}function setStatus(e){var t=e[0]||{},s=e[1]||"",i=e[2]||"";return new Promise(function(e,a){var r=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0];r.step.message=i,e("Set profile status Success",r)})}var util=require("utility"),gatekeeper=new GK;module.exports={create:create,save:save,submit:submit,authorise:authorise,close:close,setDraft:setDraft,setUnDraft:setUnDraft,createProfile:createProfile,setInstanceTitle:setInstanceTitle,deleteProfile:deleteProfile,updateIndicator:updateIndicator,markUpdateIndicator:markUpdateIndicator,updateIndicatorWrapper:updateIndicatorWrapper};

},{"utility":8}],4:[function(require,module,exports){
"use strict";function getLanguageMessage(message){var language=service.getLanguage(),res=eval("message.i18n."+language);return res}function getNodeValue(data,_WFInstance,uuid){return new Promise(function(resolve,reject){if(void 0!=data.value){var inputDataType="string";inputDataType=void 0!=data.value.datatype.dataType?data.value.datatype.dataType:data.value.datatype;var inputValue=data.value.data;resolve("number"==inputDataType?Number(inputValue):"string"==inputDataType?inputValue:"integer"==inputDataType?parseInt(inputValue):"decimal"==inputDataType?parseFloat(inputValue):"date"==inputDataType||"dateTime"==inputDataType?inputValue:inputValue)}else if(void 0!=data.indicatorUUID){var indicatorUUID=null,subprocess=JSON.xpath("/subprocesses[_id eq '"+uuid+"']",_WFInstance,{})[0];0==subprocess.indicators.length?indicatorUUID=JSON.xpath("/indicators[category/term eq '"+data.indicatorUUID.indicatorSetId+"']/_id",_WFInstance,{})[0]:(indicatorUUID=JSON.xpath("/indicators[id eq '"+data.indicatorUUID.indicatorSetId+"']/instances/uuid",subprocess,{})[0],void 0==indicatorUUID&&(indicatorUUID=JSON.xpath("/indicators[category/term eq '"+data.indicatorUUID.indicatorSetId+"']/_id",_WFInstance,{})[0])),resolve(indicatorUUID)}else if(void 0!=data.indicator){var indicatorUUID=JSON.xpath("/subprocesses[_id eq '"+uuid+"']/indicators[id eq '"+data.indicator.indicatorSetId+"']/instances/uuid",_WFInstance,{})[0],indObject=JSON.xpath("/indicators[_id eq '"+indicatorUUID+"']",_WFInstance,{})[0],xpath="/model/pending/data/"+data.indicator.indicatorSetId+"/"+data.indicator.elementId,seq=JSON.xpath("count(/subprocesses[_id eq '"+uuid+"']/preceding-sibling::node()[id = /subprocesses[_id eq '"+uuid+"']/id])",_WFInstance,{})[0]+1,subprocessType=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+uuid+"']/id]/type",_WFInstance,{})[0],part=library.getSubprofileSubprocessIds();subprocessType==PROCESS_TYPE_SUBPROFILE&&(seq=JSON.xpath("count(/subprocesses[_id eq '"+uuid+"']/preceding-sibling::node()[id = /subprocesses[_id eq '"+uuid+"']/id and _id = /subprocesses[_id = "+part+"]/_id])",_WFInstance,{})[0]+1);var replacedPath=replaceAll(xpath,"#SEQUENCE#",seq),validDate=JSON.xpath("/subprocesses[_id eq '"+uuid+"']/dates/valid",_WFInstance,{})[0],concatValidDate="'"+validDate+"'",newPath=replaceAll(replacedPath,"#END_DATE#",concatValidDate),dotReplaced=replaceAll(newPath,"[.]","/"),retValue=JSON.xpath(dotReplaced,indObject,{})[0];resolve(retValue)}else if(void 0!=data.system)resolve("ERROR: Unimplemented system type found.");else if(void 0!=data.variable)if(void 0!=data.variable.profile){var variableName=data.variable.profile,profileId=_WFInstance.profile,profileVariableFileName=profileId+":variables";dao.get(profileVariableFileName).then(function(file){var obj=eval("file."+variableName);if("object"==typeof obj){var seq=JSON.xpath("count(/subprocesses[_id eq '"+uuid+"']/preceding-sibling::node()[id = /subprocesses[_id eq '"+uuid+"']/id])",_WFInstance,{})[0]+1,subprocessType=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+uuid+"']/id]/type",_WFInstance,{})[0],part=library.getSubprofileSubprocessIds();subprocessType==PROCESS_TYPE_SUBPROFILE&&(seq=JSON.xpath("count(/subprocesses[_id eq '"+uuid+"']/preceding-sibling::node()[id = /subprocesses[_id eq '"+uuid+"']/id and _id = /subprocesses[_id = "+part+"]/_id])",_WFInstance,{})[0]+1);var valuePath="/"+variableName+"[seq eq '"+seq+"']/value",retValue=JSON.xpath(valuePath,file,{})[0];resolve(retValue)}else"string"==typeof obj&&resolve(obj)}).catch(function(e){reject("ERROR: Profile variables not found")})}else reject("ERROR: Unimplemented profile type found.");else if(void 0!=data.indicatorWrapper){var indicatorSet=data.indicatorWrapper.indicatorSetId,indicatorUUID=JSON.xpath("/subprocesses[_id eq '"+uuid+"']/indicators[id eq '"+indicatorSet+"']/instances/uuid",_WFInstance,{})[0],indObject=JSON.xpath("/indicators[_id eq '"+indicatorUUID+"']",_WFInstance,{})[0],elementpath=replaceAll(data.indicatorWrapper.path,"[.]","/"),xpath="/"+elementpath,value=JSON.xpath(xpath,indObject,{})[0];resolve(value)}else if(void 0!=data.calculated){for(var value="",separator=data.calculated.separator,i=0;i<data.calculated.elements.length-1;i++){var elements=data.calculated.elements,possibleItems=["elementProperty","constantValue","elementWrapper","currentDate","randomDigits","profileObjectElement","profileObjectWrapper","currentFinancialYear"];switch(propertyExists(elements[i],possibleItems)){case"elementProperty":var indicatorSet=elements[i].elementProperty.indicatorSetId,indicatorUUID=JSON.xpath("/subprocesses[_id eq '"+uuid+"']/indicators[id eq '"+indicatorSet+"']/instances/uuid",_WFInstance,{})[0],indObject=JSON.xpath("/indicators[_id eq '"+indicatorUUID+"']",_WFInstance,{})[0],elementpath=replaceAll(elements[i].elementProperty.elementId,"[.]","/"),xpath="/model/pending/data/"+indicatorSet+"/"+elementpath,itemValue=JSON.xpath(xpath,indObject,{})[0];value=value+itemValue+separator;break;case"constantValue":var itemValue=elements[i].constantValue.value;value=value+itemValue+separator;break;case"elementWrapper":var indicatorSet=elements[i].elementWrapper.indicatorSetId,indicatorUUID=JSON.xpath("/subprocesses[_id eq '"+uuid+"']/indicators[id eq '"+indicatorSet+"']/instances/uuid",_WFInstance,{})[0],indObject=JSON.xpath("/indicators[_id eq '"+indicatorUUID+"']",_WFInstance,{})[0],elementpath=replaceAll(elements[i].elementWrapper.elementId,"[.]","/"),xpath="/"+elementpath,itemValue=JSON.xpath(xpath,indObject,{})[0];value=value+itemValue+separator;break;case"currentDate":value=value+formatDate(new Date)+separator;break;case"randomDigits":var digits=elements[i].randomDigits.digits,random=Math.random(),exp=Math.pow(10,digits),intPart=random*exp^0;value=value+intPart+separator;break;case"profileObjectElement":var indicatorSet=elements[i].profileObjectElement.indicatorSetId,indObject=JSON.xpath("/indicators[category/term eq 'appProfile']",app.SCOPE.workflow,{})[0],elementpath=replaceAll(elements[i].profileObjectElement.elementId,"[.]","/"),xpath="/model/pending/data/"+indicatorSet+"/"+elementpath,itemValue=JSON.xpath(xpath,indObject,{})[0];value=value+itemValue+separator;break;case"profileObjectWrapper":var indicatorSet=elements[i].profileObjectWrapper.indicatorSetId,indObject=JSON.xpath("/indicators[category/term eq 'appProfile']",app.SCOPE.workflow,{})[0],elementpath=replaceAll(elements[i].profileObjectWrapper.wrapperElementId,"[.]","/"),xpath="/"+elementpath,itemValue=JSON.xpath(xpath,indObject,{})[0];value=value+itemValue+separator;break;case"currentFinancialYear":var startDate=elements[i].currentFinancialYear.startDate,startMonth=elements[i].currentFinancialYear.startMonth,financialYear=(new Date).getFullYear()+"-"+startMonth+"-"+startDate;value=value+financialYear+separator;break;default:reject("No method found from implemented list.")}}var i=data.calculated.elements.length-1,elements=data.calculated.elements,possibleItems=["elementProperty","constantValue","elementWrapper","currentDate","randomDigits","profileObjectElement","profileObjectWrapper","currentFinancialYear"];switch(propertyExists(elements[i],possibleItems)){case"elementProperty":var indicatorSet=elements[i].elementProperty.indicatorSetId,indicatorUUID=JSON.xpath("/subprocesses[_id eq '"+uuid+"']/indicators[id eq '"+indicatorSet+"']/instances/uuid",_WFInstance,{})[0],indObject=JSON.xpath("/indicators[_id eq '"+indicatorUUID+"']",_WFInstance,{})[0],elementpath=replaceAll(elements[i].elementProperty.elementId,"[.]","/"),xpath="/model/pending/data/"+indicatorSet+"/"+elementpath,itemValue=JSON.xpath(xpath,indObject,{})[0];value+=itemValue;break;case"constantValue":var itemValue=elements[i].constantValue.value;value+=itemValue;break;case"elementWrapper":var indicatorSet=elements[i].elementWrapper.indicatorSetId,indicatorUUID=JSON.xpath("/subprocesses[_id eq '"+uuid+"']/indicators[id eq '"+indicatorSet+"']/instances/uuid",_WFInstance,{})[0],indObject=JSON.xpath("/indicators[_id eq '"+indicatorUUID+"']",_WFInstance,{})[0],elementpath=replaceAll(elements[i].elementWrapper.elementId,"[.]","/"),xpath="/"+elementpath,itemValue=JSON.xpath(xpath,indObject,{})[0];value+=itemValue;break;case"currentDate":value+=formatDate(new Date);break;case"randomDigits":var digits=elements[i].randomDigits.digits,random=Math.random(),exp=Math.pow(10,digits),intPart=random*exp^0;value+=intPart;break;case"profileObjectElement":var indicatorSet=elements[i].profileObjectElement.indicatorSetId,indObject=JSON.xpath("/indicators[category/term eq 'appProfile']",app.SCOPE.workflow,{})[0],elementpath=replaceAll(elements[i].profileObjectElement.elementId,"[.]","/"),xpath="/model/pending/data/"+indicatorSet+"/"+elementpath,itemValue=JSON.xpath(xpath,indObject,{})[0];value+=itemValue;break;case"profileObjectWrapper":var indicatorSet=elements[i].profileObjectWrapper.indicatorSetId,indObject=JSON.xpath("/indicators[category/term eq 'appProfile']",app.SCOPE.workflow,{})[0],elementpath=replaceAll(elements[i].profileObjectWrapper.wrapperElementId,"[.]","/"),xpath="/"+elementpath,itemValue=JSON.xpath(xpath,indObject,{})[0];value+=itemValue;break;case"currentFinancialYear":var startDate=elements[i].currentFinancialYear.startDate,startMonth=elements[i].currentFinancialYear.startMonth,financialYear=(new Date).getFullYear()+"-"+startMonth+"-"+startDate;value+=financialYear;break;default:reject("No method found from implemented list.")}resolve(value)}else if(void 0!=data.subProcess){for(var path=data.subProcess.path,arr=path.split("."),pathItems="",i=0;i<arr.length;i++)pathItems=pathItems+"['"+arr[i]+"']";var subprocess=JSON.xpath("/subprocesses[_id eq '"+uuid+"']",_WFInstance,{})[0],value=eval("subprocess"+pathItems);resolve(value)}})}function replaceAll(e,a,t){return"function"!=typeof e.replace&&(console.log(a+" "+t),console.log(e)),e.replace(new RegExp(a,"g"),t)}function formatDate(e){var a=e.getDate(),t=e.getMonth(),i=e.getFullYear();return a+"-"+t+"-"+i}function compare(e,a,t){switch(a){case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t;case"==":return e==t;case"!=":return e!=t}}module.exports={getLanguageMessage:getLanguageMessage,getNodeValue:getNodeValue,compare:compare};

},{}],5:[function(require,module,exports){
"use strict";function getProcess(e,s,t){return new Promise(function(n,i){try{var c=[],r=[];t.instance.processes.filter(function(s){s.id==e&&(r=s)}),util.syncLoop(r.subProcesses.length,function(n){var o=n.iteration(),u=r.seq,f=r.subProcesses[o].id,a=r.subProcesses[o].seq;getSubProcess(e,u,f,a,s,t).then(function(e){c.push(e),n.next()},function(e){n.break(),i(e)})},function(){n(c)})}catch(e){i(e)}})}function getSubProcess(e,s,t,n,i,c){return new Promise(function(r,o){try{var u={id:"",seq:"",name:"",help:"",dates:"",step:""},f=[],a=[];c.instance.processes.filter(function(i){if(i.id==e&&i.seq==s){i.subProcesses.length;i.subProcesses.filter(function(e){e.id==t&&e.seq==n&&0==e.complete&&(f=e)})}}),c.config.processes.filter(function(s){s._id==e&&s.subProcesses.filter(function(e){e._id==t&&(a=e)})}),u.id=a._id,u.seq=f.seq,u.name=util.getName(a.name,i),u.help=util.getName(a.help,i),u.dates=f.dates,u.step=f.step,r(u)}catch(e){o(e)}})}function prepareNotificationScreen(){""}var util=require("utility");module.exports={getProcess:getProcess};

},{"utility":8}],6:[function(require,module,exports){
"use strict";function get(){return new Promise(function(e,t){})}module.exports={get:get};

},{}],7:[function(require,module,exports){
"use strict";function count(e){return void 0!==e?e.length:0}function preRequisites(e,t,s){return new Promise(function(n,i){var o=[];try{util.syncLoop(e.length,function(n){var a=n.iteration();preRequisite(e[a],t,s).then(function(e){o.push(!0),n.next()},function(e){o.push(!1),n.break(),i(e)})},function(){if(o.every(Boolean)){var e=util.success("Pre-requisites completed successfully.",{});n(e)}else{var t=util.error("WFPreRequisiteError","Not all pre-requisites passed.");i(t)}})}catch(e){i(e)}})}function preRequisite(prerequisite,_WFInstance,spuuid){return new Promise(function(resolve,reject){if(void 0!=prerequisite.check.numberProcessInstances){var numberProcessInstances=prerequisite.check.numberProcessInstances,_filterOperator=numberProcessInstances.operator,xpathOperator="";switch(_filterOperator){case"greaterThan":xpathOperator="gt";break;case"lessThan":xpathOperator="lt";break;case"greaterThanEqual":xpathOperator="ge";break;case"lessThanEqual":xpathOperator="le";break;case"equalTo":xpathOperator="eq";break;case"notEqualTo":xpathOperator="ne"}var _subprocessId=numberProcessInstances.subProcessId,_filterElement="step/status",_filterValue=numberProcessInstances.type,innerXpath="/"+_filterElement+"[. eq '"+_filterValue+"']",fullPath="count(/subprocesses[id eq '"+_subprocessId+"']"+innerXpath+")",prereqProcessType=JSON.xpath("/config/processes/subProcesses[_id eq '"+_subprocessId+"']/type",_WFInstance,{})[0],part=library.getSubprofileSubprocessIds();void 0!=app.profile.subprofileId&&""!=app.profile.subprofileId&&void 0!=prereqProcessType&&prereqProcessType==PROCESS_TYPE_SUBPROFILE&&(fullPath="count(/subprocesses[id eq '"+_subprocessId+"' and _id = "+part+"]"+innerXpath+")");var subjectCount=JSON.xpath(fullPath,_WFInstance,{})[0],countValue=prerequisite.check.numberProcessInstances.count,compare=util.compare(subjectCount,prerequisite.check.numberProcessInstances.operator,parseInt(countValue));if(compare){var success=util.success("Pre-requisites passed.",{});resolve(success)}else{var message=helper.getLanguageMessage(prerequisite.message),error=util.error("WFPreRequisiteError",message);reject(error)}}else if(void 0!=prerequisite.check.variable){var scope=prerequisite.check.variable.scope,fileName="";if("profile"==scope){var profileId=_WFInstance.profile;fileName=profileId+":variables"}else if("subProfileSubProcessInstance"==scope){var subProfileId=app.profile.subprofileId;fileName=subProfileId+":variables"}else reject("ERROR: Scope '"+scope+"' not implemented in pre-requisites");dao.get(fileName).then(function(file){var variableName=prerequisite.check.variable.name,obj=eval("file."+variableName),subjectValueCalculated;if("object"==typeof obj){var seq=JSON.xpath("count(/subprocesses[_id eq '"+spuuid+"']/preceding-sibling::node()[id = /subprocesses[_id eq '"+spuuid+"']/id])",_WFInstance,{})[0]+1,subprocessType=JSON.xpath("/config/processes/subProcesses[_id eq /subprocesses[_id eq '"+spuuid+"']/id]/type",_WFInstance,{})[0],part=library.getSubprofileSubprocessIds();subprocessType==PROCESS_TYPE_SUBPROFILE&&(seq=JSON.xpath("count(/subprocesses[_id eq '"+spuuid+"']/preceding-sibling::node()[id = /subprocesses[_id eq '"+spuuid+"']/id and _id = /subprocesses[_id = "+part+"]/_id])",_WFInstance,{})[0]+1);var valuePath="/"+variableName+"[seq eq '"+seq+"']/value";subjectValueCalculated=JSON.xpath(valuePath,file,{})[0]}else"string"==typeof obj&&(subjectValueCalculated=obj);var inputValue=prerequisite.check.variable.value.data,inputDataType=prerequisite.check.variable.value.dataType.dataType,finalValue;"number"==inputDataType?finalValue=Number(inputValue):"string"==inputDataType?finalValue=inputValue:"integer"==inputDataType?finalValue=parseInt(inputValue):"decimal"==inputDataType?finalValue=parseFloat(inputValue):"date"!=inputDataType&&"dateTime"!=inputDataType||(finalValue=inputValue);var compare=util.compare(subjectValueCalculated,prerequisite.check.variable.operator,finalValue);if(compare){var success=util.success("Variable Pre-requisites passed.",{});resolve(success)}else{var message=helper.getLanguageMessage(prerequisite.message),error=util.error("WFPreRequisiteError",message);reject(error)}}).catch(function(e){var t=helper.getLanguageMessage(prerequisite.message),e=util.error("WFPreRequisiteError:",t);reject(e)})}else{var error=util.error("WFPreRequisiteError","Pre-requisite type not defined.");reject(error)}})}function preActions(e,t,s){return new Promise(function(n,i){var o=[];try{var a=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],r=a["meta-data"].processConfigId,c=a["meta-data"].subProcessConfigId,u=a["meta-data"].subProcessInsSeq,d=a["meta-data"].subProcessInsSeq,p=JSON.xpath("/processes[_id eq '"+r+"']/subProcesses[_id eq '"+c+"']",t.config,{})[0],l=JSON.xpath("/subprocesses[_id eq '"+s+"']/step",t,{})[0];util.syncLoop(e.length,function(n){var a=n.iteration();action(e[a],r,u,c,d,p,l,t,{},s).then(function(e){o.push(!0),n.next()},function(e){o.push(!1),n.break(),i(e)})},function(){if(o.every(Boolean)){var e=util.success("Pre-actions completed successfully.",{});n(e)}else{var t=util.error("WFPreRequisiteError","Not all pre-actions passed.");i(t)}})}catch(e){i(e)}})}function getSubProcess(e,t){return void 0==t.subprocesses?[]:void t.subprocesses.filter(function(t){if(t.id==e)return t})}function subProcess(e,t,s,n,i,o,a){var r=[],c=[],u=[];a.instance.processes.filter(function(i){if(i.id==e&&i.seq==t){i.subProcesses.length;i.subProcesses.filter(function(e){if(e.id==s&&e.seq==n){var t=e.uuid;a.subprocesses.filter(function(e){e._id==t&&(r=e)})}})}}),a.config.processes.filter(function(t){t._id==e&&(c=t,t.subProcesses.filter(function(e){e._id==s&&(u=e)}))});var d="",p=o.baseUUID;if(void 0!=p&&""!=p&&p.length>0){var l=JSON.xpath("/subprocesses[_id eq '"+p+"']",a,{})[0];d=l.groupKey}else{for(var f="",m=0;m<u.indicators.length-1;m++)f=f+"'"+u.indicators[m]._id+"',";f=f+"'"+u.indicators[m]._id+"'";var h=JSON.xpath("/indicators[setId = ("+f+") and cardinality eq 'single']",app.SCOPE.APP_CONFIG,{}).length;if(void 0!=u.instanceType.newSequence||h>0){var l=JSON.xpath("/instance/processes[id eq '"+e+"']",a,{})[0];d=void 0!=l&&l.subProcesses.length>0?l.subProcesses[0].groupKey:generateUUID()}else d=generateUUID()}var g=JSON.xpath("count(/processes/subProcesses[groupKey eq '"+d+"'])",a.instance,{})[0],v=o.label,S=generateUUID(),I={_id:S,id:s,type:"workflowInstanceSubProcess",dateTimeCreated:moment().format(),dueDateTime:moment().format(),seq:n,initiated:!1,dates:{created:"",valid:"",start:"",due:"",closed:""},complete:!1,indicators:[],step:{},active:!0,groupKey:d,label:v,channels:["community_"+app.SCOPE.getCommunityId(),"profile_"+app.SCOPE.profileId,"application_"+app.SCOPE.applicationId,"community_"+app.SCOPE.getCommunityId()+"_application_"+app.SCOPE.applicationId],history:[],"meta-data":{applicationId:app.SCOPE.applicationId,communityId:app.SCOPE.getCommunityId(),profileId:app.SCOPE.profileId,subprofileId:void 0==i?"":i,processConfigId:e,subProcessConfigId:s,subProcessInsSeq:g+1},messages:[],spStatus:""};return void 0!=app.profile.subprofileId&&""!=app.profile.subprofileId?(I.channels.push("profile_"+app.SCOPE.profileId+"_subprofile_"+app.profile.subprofileId),I.channels.push("subprofile_"+app.profile.subprofileId)):(I.channels.push("profile_"+app.SCOPE.profileId+"_subprofile_0"),I.channels.push("subprofile_0")),a.subprocesses.push(I),new Promise(function(i,d){try{var p=c.preActions;preActions(p,a,S).then(function(p){var l=c.prerequisites;preRequisites(l,a,S).then(function(c){var p=u.initiate;initiate(p,r,o).then(function(r){I.initiated=r.data.initiated,I.dates=r.data.dates;var c=u.steps[0]._id,p=(u.steps[0].transition[0]._id,1);step(e,t,s,n,c,p,o,a,S).then(function(e){I.step=e.data,indicators(u.indicators,a,I._id).then(function(e){I.indicators=e.data;var t=util.success(e.message,I);i(t)},function(e){d(e)})},function(e){d(e)})},function(e){a.subprocesses=a.subprocesses.filter(function(e){return!(e._id==S)}),d(e)})},function(e){a.subprocesses=a.subprocesses.filter(function(e){return!(e._id==S)}),d(e)})},function(e){a.subprocesses=a.subprocesses.filter(function(e){return!(e._id==S)}),d(e)})}catch(e){d(e)}})}function initiate(e,t,s){var n={initiated:!1,dates:{created:"",valid:"",start:"",due:"",closed:""}};return new Promise(function(i,o){var a=function(){if(void 0!=e.user){n.dates.created=s.createdDate,"userSelected"!=e.user.validDate._type&&"autoSelected"!=e.user.validDate._type||(void 0!=s.validDate?n.dates.valid=s.validDate:n.dates.valid=(new Date).toISOString().substring(0,10)),"userSelected"!=e.user.dueDate._type&&"autoSelected"!=e.user.dueDate._type||(void 0!==s.dueDate?n.dates.due=s.dueDate:util.warn("WFInitiateError","No due date passed in - {data.dueDate}")),n.dates.start=s.firstDate,n.initiated=!0;var t=util.success("Sub-Process initiate completed successfully.",n);i(t)}else if(void 0!=e.auto);else{var a=util.error("WFInitiateError","Initiate type: "+e._type+" not defined.");o(a)}};if(void 0==t.complete)a();else if(!t.complete)if(e.parallelInstances)a();else{var r=util.error("WFInitiateError","Sub-process: "+t.id+" still active and parallel instances are not allowed.");o(r)}})}function step(processId,processSeq,subProcessId,subProcessSeq,stepId,stepSeq,data,_WFInstance,spuuid){var model={key:generateUUID(),id:"",seq:"",status:"",message:"",assignedTo:{userId:"",name:"",dateTime:"",type:"",dueDateTime:"",by:""},assignmentHistory:[],dateTimeCreated:moment().format(),dueDateTime:moment().format(),transition:{transitionId:"",dateTime:"",userId:""},assignment:{},comment:""},subProcess={},uuid="",instSubProcess,step={},transitionId="";return new Promise(function(resolve,reject){try{_WFInstance.instance.processes.filter(function(e){e.id==processId&&e.seq==processSeq&&e.subProcesses.filter(function(e){e.id==subProcessId&&e.seq==subProcessSeq&&(uuid=e.uuid)})}),_WFInstance.subprocesses.filter(function(e){e._id==uuid&&(instSubProcess=e)}),_WFInstance.config.processes.filter(function(e){e._id==processId&&e.subProcesses.filter(function(e){e._id==subProcessId&&(subProcess=e,e.steps.filter(function(e){e._id==stepId&&(step=e)}))})}),model.id=stepId,model.seq=stepSeq;var instanceStatus="";void 0!=step.setInstanceStatusTo.NotStarted?instanceStatus="NotStarted":void 0!=step.setInstanceStatusTo.Created?instanceStatus="Created":void 0!=step.setInstanceStatusTo.InProgress?instanceStatus="InProgress":void 0!=step.setInstanceStatusTo.Submitted?instanceStatus="Submitted":void 0!=step.setInstanceStatusTo.Complete&&(instanceStatus="Complete");var language=service.getLanguage();model.status=instanceStatus,model.message=eval("step.setInstanceStatusTo."+instanceStatus+".label.i18n."+language),model.comment=void 0!==data.comment?data.comment:"";var indicators=void 0!==instSubProcess?instSubProcess.indicators:[],updateSPIndicatorObject=function(e,t){if(e.length>0)for(var s=0;s<e.length;s++){var n=e[s],i=n.instances[0].uuid,o=JSON.xpath("/indicators[_id eq '"+i+"']/model/pending/seq",t,{})[0];n.instances[0].seq=o}},clearSPStatus=function(e){var t=JSON.xpath("/subprocesses[_id eq '"+e+"']",_WFInstance,{})[0];t.spStatus=""};indicatorDocs(processId,indicators,model,_WFInstance).then(function(e){uuid=spuuid,void 0!=step.function.actions?actions(step.function.actions,processId,processSeq,subProcessId,subProcessSeq,subProcess,model,_WFInstance,data,spuuid).then(function(e){updateSPIndicatorObject(indicators,_WFInstance);var t=step.transition[0]._id;transition(processId,processSeq,subProcessId,subProcessSeq,stepId,t,data,_WFInstance,spuuid,model).then(function(e){var t=util.success("Transition completed successfully.",e.data.step);resolve(t)},function(e){reject(e)})},function(e){reject(e)}):void 0!=step.function.task?task(processId,processSeq,step.function.task,spuuid,model).then(function(e){updateSPIndicatorObject(indicators,_WFInstance);var t=util.success("Task awaiting user action.",model);resolve(t)},function(e){reject(e)}):void 0!=step.function.server&&(clearSPStatus(spuuid),server(step.function.server,processId,processSeq,subProcessId,subProcessSeq,subProcess,model,_WFInstance,data,spuuid).then(function(e){updateSPIndicatorObject(indicators,_WFInstance);var t=util.success("Server awaiting server response.",model);resolve(t)},function(e){reject(e)}))},function(e){reject(e)})}catch(e){reject(e)}})}function indicators(e,t,s){var n=[];return new Promise(function(e,i){try{for(var o=JSON.xpath("indicators[fn:count(./workflows/processes[subProcessUUID eq '"+s+"']) gt 0]",t,{}),a=0;a<o.length;a++){var r=o[a],c={id:"",instances:[]},u={uuid:"",title:"",key:"",seq:1,rev:""};c.id=r.category.term,u.uuid=r._id,u.rev=r._rev,u.title=r.title,u.key="",u.seq=r.model.pending.seq,c.instances.push(u),n.push(c)}var d=util.success("Process indicator model updated.",n);e(d)}catch(e){i(e)}})}function assignUser(e,t,s,n,i,o,a){return new Promise(function(t,s){try{a.subprocesses.filter(function(s){if(s._id==o){void 0==s.step.assignmentHistory&&(s.step.assignmentHistory=[]),""!=s.step.assignedTo.userId&&""!=s.step.assignedTo.name&&s.step.assignmentHistory.push(JSON.parse(JSON.stringify(s.step.assignedTo))),s.step.assignedTo.userId=i.id,s.step.assignedTo.name=i.name,s.step.assignedTo.dateTime=moment().format(),s.step.assignedTo.type=ASSIGNMENT_TYPE_REASSIGNMENT,s.step.assignedTo.dueDateTime="",s.step.assignedTo.by=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"";for(var n=s.indicators,r=0;r<n.length;r++)for(var c=n[r],u=0;u<c.instances.length;u++)for(var d=c.instances[u],p=0;p<a.indicators.length;p++){var l=a.indicators[p];d.uuid==l._id&&l.workflows.filter(function(t){t.id==a.config._id&&t.processes.filter(function(t){t.id==e&&(t.step.assignedTo.userId=i.id,t.step.assignedTo.name=i.name)})})}var f=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=f&&void 0!=f.reAssignment)actionsModule.notification.reAssignmentNotification(f,a,o,i).then(function(e){var e=util.success('User assigned successfully. UserId: "'+i.id+'", Name: "'+i.name+'"',s);t(e)}).catch(function(e){t(e)});else{var m=util.success('User assigned successfully. UserId: "'+i.id+'", Name: "'+i.name+'"',s);t(m)}}})}catch(e){s(e)}})}function indicatorDocs(e,t,s,n){return new Promise(function(i,o){try{if(void 0==t){util.error("WFIndicatorsUpdate","Indicators parameter is required. - Value: "+t);o(err)}else{for(var a=0;a<t.length;a++)for(var r=t[a],c=0;c<r.instances.length;c++)for(var u=r.instances[c],d=0;d<n.indicators.length;d++){var p=n.indicators[d];u.uuid==p._id&&p.workflows.filter(function(t){t.id==n.config._id&&t.processes.filter(function(t){t.id==e&&(t.step.id=s.id,t.step.seq=s.seq,t.step.status=s.status,t.step.message=s.message,t.step.assignedTo.userId=s.assignedTo.userId,t.step.assignedTo.name=s.assignedTo.name,t.step.comment=void 0!==s.comment?s.comment:"")})})}var l=util.success("Indicator documents workflow process model updated.",n);i(l)}}catch(e){o(e)}})}function actions(e,t,s,n,i,o,a,r,c,u){var d=[];return new Promise(function(p,l){util.syncLoop(e.length,function(p){var f=p.iteration();action(e[f],t,s,n,i,o,a,r,c,u).then(function(t){var s={id:e[f]._id,seq:f,data:t};d.push(s),p.next()},function(e){p.break(),l(e)})},function(){var e=util.success("Actions completed successfully.",d);p(e)})})}function action(e,t,s,n,i,o,a,r,c,u){return new Promise(function(n,d){if(void 0!=e.method){var p=["form","indicator","profile","subProcessInstance","step","community","application","user","sdo","performance","taxonomy","variables","notification","report","worker","participants"];switch(propertyExists(e.method,p)){case"form":if(void 0!=e.method.form.create){var l=[];l.push(t),l.push(o),l.push(a),l.push(e),l.push(s),l.push(i),l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.create(l).then(function(e){n(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.authorise){var l=[];l.push(t),l.push(o),l.push(s),l.push(i),l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.authorise(l).then(function(e){n(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.undraft){var l=[];l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.setUnDraft(l).then(function(e){n(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.draft){var l=[];l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.setDraft(l).then(function(e){n(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.close){var l=[];l.push(o.indicators),l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.close(l).then(function(e){n(e.data)},function(e){d(e)})}else if(void 0!=e.method.form.authoriseAndCreateNewSeq){var l=[];l.push(t),l.push(o),l.push(s),l.push(i),l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.authorise(l).then(function(p){var l=[];l.push(t),l.push(o),l.push(a),l.push(e),l.push(s),l.push(i),l.push(r),l.push(c.createType),l.push(u),l.push(u),l.push(c),form.create(l).then(function(e){n(e.data)},function(e){d(e)})},function(e){d(e)})}break;case"indicator":if(void 0!=e.method.indicator.create)n("Not implemented");else if(void 0!=e.method.indicator.instantiate)n("Not implemented");else if(void 0!=e.method.indicator.setValue){var f=e.method.indicator.setValue.path;helper.getNodeValue(e.method.indicator.setValue.data,r,u).then(function(e){var t=[];t.push(r),t.push(u),t.push(f),t.push(e),form.updateIndicator(t).then(function(e){n(e.data)},function(e){d(e)})},function(e){d(e)})}else if(void 0!=e.method.indicator.updateStatus){var m=e.method.indicator.indicatorSetId,l=[];if(l.push(r),l.push(u),void 0!=e.method.indicator.updateStatus){var h=e.method.indicator.updateStatus;l.push(h),l.push(m),form.markUpdateIndicator(l).then(function(e){n(e.data)},function(e){d(e)})}else n("Action indicator sub type not found.")}else if(void 0!=e.method.indicator.setWrapperElement){var f=e.method.indicator.setWrapperElement.path,m=e.method.indicator.setWrapperElement.indicatorSetId;helper.getNodeValue(e.method.indicator.setWrapperElement.data,r,u).then(function(e){var t=[];t.push(r),t.push(u),t.push(f),t.push(e),t.push(m),form.updateIndicatorWrapper(t).then(function(e){n(e.data)},function(e){d(e)})},function(e){d(e)})}break;case"profile":if(void 0!=e.method.profile.create){var l=[];l.push(t),l.push(r),l.push(c.createType),l.push(u),l.push(c.baseUUID),l.push(c),form.createProfile(l).then(function(e){n(e.data)},function(e){d(e)})}else if(void 0!=e.method.profile.setStatusTo){var l=[],h=e.method.profile.setStatusTo;l.push(r),l.push(u),l.push(h),form.setStatus(l).then(function(e){n(e.data)},function(e){d(e)})}break;case"subProcessInstance":var g=["instantiate","authorise","close","setVariable","setStatusTo","setStatusMsgTo","setTitle","setValidDate","setSPStatus"];switch(propertyExists(e.method.subProcessInstance,g)){case"setTitle":helper.getNodeValue(e.method.subProcessInstance.setTitle,r,u).then(function(t){actionsModule.subProcessInstance.setTitle(e.method.subProcessInstance.setTitle,u,t,r).then(function(e){n(e.data)},function(e){d(e)})},function(e){d(e)});break;case"setValidDate":helper.getNodeValue(e.method.subProcessInstance.setValidDate,r,u).then(function(t){actionsModule.subProcessInstance.setValidDate(e.method.subProcessInstance.setValidDate,u,t,r).then(function(e){n(e.data)},function(e){d(e)})},function(e){d(e)});break;case"setSPStatus":helper.getNodeValue(e.method.subProcessInstance.setSPStatus,r,u).then(function(t){actionsModule.subProcessInstance.setSPStatus(e.method.subProcessInstance.setSPStatus,u,t,r).then(function(e){n(e.data)},function(e){d(e)})},function(e){d(e)});break;default:d("No method found from implemented list in subprocess action.")}break;case"step":break;case"community":var v=["createCommunity","releaseAdoptedApplication","userJoinCommunity"];switch(propertyExists(e.method.community,v)){case"createCommunity":return actionsModule.community.createCommunity(e.method.community.createCommunity,u,r).then(function(e){n(e.data)},function(e){d(e)});case"releaseAdoptedApplication":return actionsModule.community.releaseAdoptedApplication(e.method.community.releaseAdoptedApplication,u,r).then(function(e){n(e.data)},function(e){d(e)});case"userJoinCommunity":return actionsModule.community.userJoinCommunity(e.method.community.userJoinCommunity,u,r).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"application":var S=["createAppDefinition","buildApplication","applicationAdoption"];switch(propertyExists(e.method.application,S)){case"createAppDefinition":return actionsModule.application.createAppDefinition(e.method.application.createAppDefinition,u,r).then(function(e){n(e.data)},function(e){d(e)});case"buildApplication":return actionsModule.application.buildApplication(e.method.application.buildApplication,u,r).then(function(e){n(e.data)},function(e){d(e)});case"applicationAdoption":return actionsModule.application.applicationAdoption(e.method.application.applicationAdoption,u,r).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"user":var I=["addToRole"];switch(propertyExists(e.method.user,I)){case"addToRole":return actionsModule.user.addToRole(e.method.user.addToRole,u,r).then(function(e){n(e.data)},function(e){d(e)})}break;case"sdo":var b=["create","enrollCourse"];switch(propertyExists(e.method.sdo,b)){case"create":return actionsModule.sdo.create(e.method.sdo.create,u,r).then(function(e){n(e.data)},function(e){d(e)});case"enrollCourse":return actionsModule.sdo.enrollCourse(e.method.sdo.enrollCourse,u,r).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"performance":var y=["unlockPeriod","lockPerformanceModel","setModelStatus"];switch(propertyExists(e.method.performance,y)){case"unlockPeriod":return actionsModule.performance.unlockPeriod(e.method.performance.unlockPeriod,u,r).then(function(e){n(e.data)},function(e){d(e)});case"setModelStatus":return actionsModule.performance.setModelStatus(e.method.performance.setModelStatus,u,r).then(function(e){n(e.data)},function(e){d(e)});case"lockPerformanceModel":return actionsModule.performance.lockPerformanceModel(e.method.performance.lockPerformanceModel,u,r).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"taxonomy":var P=["create"];switch(propertyExists(e.method.taxonomy,P)){case"create":return actionsModule.taxonomy.create(e.method.taxonomy.create,u,r).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"variables":var _=["setVariable"];switch(propertyExists(e.method.variables,_)){case"setVariable":return actionsModule.variables.setVariable(e.method.variables.setVariable,r,u).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"notification":return actionsModule.notification.sendNotificationWorker(e.method.notification,r,u).then(function(e){n(e.data)},function(e){d(e)});case"report":var N=["createPerformanceReport","createReport","sdoReport","executeReport","requestReport","generateView","generateBasicView","generateUnionView","sdoReportMultiple","subprofileQuarterlyReport"];switch(propertyExists(e.method.report,N)){case"createPerformanceReport":return actionsModule.report.createPerformanceReport(e.method.report.createPerformanceReport,r,u).then(function(e){n(e.data)},function(e){d(e)});case"createReport":return actionsModule.report.createReport(e.method.report.createReport,r,u).then(function(e){n(e.data)},function(e){d(e)});case"sdoReport":return actionsModule.report.sdoReport(e.method.report.sdoReport,r,u).then(function(e){n(e.data)},function(e){d(e)});case"executeReport":return actionsModule.report.executeReport(e.method.report.executeReport,r,u).then(function(e){n(e.data)},function(e){d(e)});case"generateView":return actionsModule.report.generateView(e.method.report.generateView,r,u).then(function(e){n(e.data)},function(e){d(e)});case"requestReport":return actionsModule.report.requestReport(e.method.report.requestReport,r,u).then(function(e){n(e.data)},function(e){d(e)});case"generateBasicView":return actionsModule.report.generateBasicView(e.method.report.generateBasicView,r,u).then(function(e){n(e.data)},function(e){d(e)});case"generateUnionView":return actionsModule.report.generateUnionView(e.method.report.generateUnionView,r,u).then(function(e){n(e.data)},function(e){d(e)});case"sdoReportMultiple":return actionsModule.report.sdoReportMultiple(e.method.report.sdoReportMultiple,r,u).then(function(e){n(e.data)},function(e){d(e)});case"subprofileQuarterlyReport":return actionsModule.report.subprofileQuarterlyReport(e.method.report.subprofileQuarterlyReport,r,u).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"worker":var T=["sendWorker","executeLocal","create"];switch(propertyExists(e.method.worker,T)){case"sendWorker":return actionsModule.worker.sendWorker(e.method.worker.sendWorker,r,u).then(function(e){n(e.data)},function(e){d(e)});case"executeLocal":return actionsModule.worker.executeLocal(e.method.worker.executeLocal,r,u).then(function(e){n(e.data)},function(e){d(e)});case"create":return actionsModule.worker.create(e.method.worker.create,r,u).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;case"participants":var q=["linkParticipants","monthlyAttendance","monthlyProgressSummary","participantContracts"];switch(propertyExists(e.method.participants,q)){case"linkParticipants":return actionsModule.participants.linkParticipants(e.method.participants.linkParticipants,r,u).then(function(e){n(e.data)},function(e){d(e)});case"monthlyAttendance":return actionsModule.participants.monthlyAttendance(e.method.participants.monthlyAttendance,r,u).then(function(e){n(e.data)},function(e){d(e)});case"monthlyProgressSummary":return actionsModule.participants.monthlyProgressSummary(e.method.participants.monthlyProgressSummary,r,u).then(function(e){n(e.data)},function(e){d(e)});case"participantContracts":return actionsModule.participants.participantContracts(e.method.participants.participantContracts,r,u).then(function(e){n(e.data)},function(e){d(e)});default:d("No method found from implemented list.")}break;default:d("method not defined in configuration")}}else d("No method found from implemented list.")})}function task(e,t,s,n,i){return new Promise(function(t,o){var a=app.SCOPE.workflow,r=s.preActions;preActions(r,a,n).then(function(r){if(void 0!=s.assign.role){var c=a.profile,u="";"current"==s.assign.role.profile?u=a.profile:"community"==s.assign.role.profile&&(u=app.SCOPE.getCommunityId());var d=s.assign.role.roleId;library.getUsersListByRole(u,d).then(function(o){if(void 0!=o)if(o.length>1){var r=!1,p=library.getCurrentUserRoles(),l=p.profile.indexOf(d),f=p.community.indexOf(d),m=p.implicit.indexOf(d),h=p.adoption.indexOf(d),g=p.subprofile.indexOf(d);if(r=l>-1||f>-1||m>-1||h>-1||g>-1){void 0==i.assignmentHistory&&(i.assignmentHistory=[]);var v=i.assignedTo;if(""!=v.userId&&""!=v.name){var S=JSON.parse(JSON.stringify(v));i.assignmentHistory.push(S)}v.name=LOCAL_SETTINGS.SUBSCRIPTIONS.username+"",v.userId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"",v.dateTime=moment().format(),v.type=ASSIGNMENT_TYPE_AUTO,v.dueDateTime="",v.by=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"";var I=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=I&&void 0!=I.assignment){var b={id:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,name:LOCAL_SETTINGS.SUBSCRIPTIONS.username};actionsModule.notification.assignmentNotification(I,a,n,b).then(function(e){console.log('User assigned successfully. UserId: "'+b.id+'", Name: "'+b.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+b.id+'", Name: "'+b.name+'"')})}}var y="";if(void 0!=s.assign.assignment){var y=i.assignment,P={show:s.assign.assignment.accept.show,label:_getNameByLang(s.assign.assignment.accept.label.i18n)};y.accept=P,y.message=_getNameByLang(s.assign.assignment.message.i18n);var _={show:s.assign.assignment.reject.show,label:_getNameByLang(s.assign.assignment.reject.label.i18n)};y.reject=_;var N={profileId:c,roleId:d,type:"role"};y.value=N,y.profileRoleId=u}if(r){var T=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+n+"']/id",a,{})[0],q=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+n+"']/id",a,{})[0],O=JSON.xpath("/subprocesses[_id eq '"+n+"']/step/id",a,{})[0];JSON.xpath("/processes[_id eq '"+T+"']/subProcesses[_id eq '"+q+"']/steps[_id eq '"+O+"']",a.config,{})[0];if(void 0!=s.preWorkActions){var k=s.preWorkActions;preWorkActions(k,a).then(function(e){t("Assignment is made. Pre work actions found and executed ")},function(e){_(e)})}else t("Assignment is made. No pre work actions found. ")}else{var I=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=I&&void 0!=I.assignmentAcceptance){var b={id:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,name:LOCAL_SETTINGS.SUBSCRIPTIONS.username};actionsModule.notification.acceptanceNotification(I,a,n,d).then(function(e){console.log('User assigned successfully. UserId: "'+b.id+'", Name: "'+b.name+'"'),t("Notifications request submitted for acceptance.")}).catch(function(e){t("Notifications failed"),console.log('User assignment notification failed to user UserId: "'+b.id+'", Name: "'+b.name+'"')})}else t("Notifications not found")}}else if(1==o.length){var A=o[0].id,w=o[0].name;void 0==i.assignmentHistory&&(i.assignmentHistory=[]);var v=i.assignedTo;if(""!=v.userId&&""!=v.name){var S=JSON.parse(JSON.stringify(v));i.assignmentHistory.push(S)}v.name=w+"",v.userId=A+"",v.dateTime=moment().format(),v.type=ASSIGNMENT_TYPE_AUTO,v.dueDateTime="",v.by=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"";var y="";if(void 0!=s.assign.assignment){var y=i.assignment,P={show:s.assign.assignment.accept.show,label:_getNameByLang(s.assign.assignment.accept.label.i18n)};y.accept=P,y.message=_getNameByLang(s.assign.assignment.message.i18n);var _={show:s.assign.assignment.reject.show,label:_getNameByLang(s.assign.assignment.reject.label.i18n)};y.reject=_;var N={profileId:c,roleId:d,type:"role"};y.value=N,y.profileRoleId=u}var I=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=I&&void 0!=I.assignment){var b={id:A,name:w};actionsModule.notification.assignmentNotification(I,a,n,b).then(function(e){console.log('User assigned successfully. UserId: "'+b.id+'", Name: "'+b.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+b.id+'", Name: "'+b.name+'"')})}var T=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+n+"']/id",a,{})[0],q=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+n+"']/id",a,{})[0],O=JSON.xpath("/subprocesses[_id eq '"+n+"']/step/id",a,{})[0];JSON.xpath("/processes[_id eq '"+T+"']/subProcesses[_id eq '"+q+"']/steps[_id eq '"+O+"']",a.config,{})[0];if(void 0!=s.preWorkActions){var k=s.preWorkActions;preWorkActions(k,a).then(function(e){t("Assigned to the only user in role. Pre work actions executed")},function(e){_(e)})}else t("Assigned to the only user in role. No pre work actions found.")}else{var v=i.assignedTo;v.name="",v.userId="";var y="";if(void 0!=s.assign.assignment){var y=i.assignment,P={show:s.assign.assignment.accept.show,label:_getNameByLang(s.assign.assignment.accept.label.i18n)};y.accept=P,y.message=_getNameByLang(s.assign.assignment.message.i18n);var _={show:s.assign.assignment.reject.show,label:_getNameByLang(s.assign.assignment.reject.label.i18n)};y.reject=_;var N={profileId:c,roleId:d,type:"role"};y.value=N,y.profileRoleId=u}t("No users found in list. Assigning blank ")}else console.log("Error in getUsersListByRole undefined"),_(err)},function(e){console.log("Error in getUsersListByRole"),o(e)})}else void 0!=s.assign.user?helper.getNodeValue(s.assign.user.userName,a,n).then(function(r){helper.getNodeValue(s.assign.user.userId,a,n).then(function(o){var o=o,p=r;
void 0==i.assignmentHistory&&(i.assignmentHistory=[]);var l=i.assignedTo;if(""!=l.userId&&""!=l.name){var f=JSON.parse(JSON.stringify(l));i.assignmentHistory.push(f)}l.name=p+"",l.userId=o+"",l.dateTime=moment().format(),l.type=ASSIGNMENT_TYPE_AUTO,l.dueDateTime="",l.by=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"";var m="";if(void 0!=s.assign.assignment){var m=i.assignment,h={show:s.assign.assignment.accept.show,label:_getNameByLang(s.assign.assignment.accept.label.i18n)};m.accept=h,m.message=_getNameByLang(s.assign.assignment.message.i18n);var g={show:s.assign.assignment.reject.show,label:_getNameByLang(s.assign.assignment.reject.label.i18n)};m.reject=g;var v={profileId:c,roleId:d,type:"role"};m.value=v,m.profileRoleId=u}var S=JSON.xpath("/processes[_id eq '"+e+"']/notifications",a.config,{})[0];if(void 0!=S&&void 0!=S.assignment){var I={id:o,name:p};actionsModule.notification.assignmentNotification(S,a,n,I).then(function(e){console.log('User assigned successfully. UserId: "'+I.id+'", Name: "'+I.name+'"')}).catch(function(e){console.log('User assignment notification failed to user UserId: "'+I.id+'", Name: "'+I.name+'"')})}var b=JSON.xpath("/instance/processes[subProcesses/uuid eq '"+n+"']/id",a,{})[0],y=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+n+"']/id",a,{})[0],P=JSON.xpath("/subprocesses[_id eq '"+n+"']/step/id",a,{})[0];JSON.xpath("/processes[_id eq '"+b+"']/subProcesses[_id eq '"+y+"']/steps[_id eq '"+P+"']",a.config,{})[0];if(void 0!=s.preWorkActions){var _=s.preWorkActions;preWorkActions(_,a).then(function(e){t("Assigned to the only user in role. Pre work actions executed")},function(e){g(e)})}else t("Assigned to the only user in role. No pre work actions found.")},function(e){o(e)})},function(e){o(e)}):void 0!=s.assign.swimlane&&(t("swimlane"),console.log("Swimlane implementation !!"))},function(e){o(e)})})}function server(e,t,s,n,i,o,a,r,c,u){return new Promise(function(d,p){var l=(r.profile,e.serverAction[0]);void 0==a.assignmentHistory&&(a.assignmentHistory=[]);var f=a.assignedTo;if(""!=f.userId&&""!=f.name){var m=JSON.parse(JSON.stringify(f));a.assignmentHistory.push(m)}f.name=LOCAL_SETTINGS.SUBSCRIPTIONS.username+"",f.userId=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"",f.dateTime=moment().format(),f.type=ASSIGNMENT_TYPE_AUTO,f.dueDateTime="",f.by=LOCAL_SETTINGS.SUBSCRIPTIONS.userId+"",action(l,t,s,n,i,o,a,r,c,u).then(function(e){d("No users found in list. Assigning blank ")},function(e){p("Server action error found rejected")})})}function transition(e,t,s,n,i,o,a,r,c,u){return new Promise(function(d,p){try{for(var l=0,f="",m=0,h=r.config.processes.filter(function(t){if(t._id==e)return t}),g=h[0].subProcesses.filter(function(e){if(e._id==s)return e}),v=g[0].steps.filter(function(e){if(e._id==i)return e}),S=v[0].transition.filter(function(e){if(e._id==o)return e}),I=0;I<g[0].steps.length;I++)g[0].steps[I]._id==i&&(l=parseInt(g[0].steps[I]._seq));g[0].steps.filter(function(e){m=l+1,parseInt(e._seq)==m&&(f=e._id)});var b=g[0].steps.length,y=JSON.xpath("/subprocesses[_id eq '"+c+"']",r,{})[0],P=JSON.xpath("/subprocesses[_id eq '"+c+"']/step",r,{})[0];void 0==y.history&&(y.history=[]);var _=function(e){var t=JSON.xpath("/subprocesses[_id eq '"+c+"']/indicators",r,{}),s=!1;void 0!=t&&0!=t.length||(s=!0,t=JSON.xpath("/indicators[workflows/processes[subProcessUUID eq '"+c+"']]",r,{})),void 0==e.indicators&&(e.indicators=[]);for(var n=0;n<t.length;n++)if(s){var i=t[n]._id,o=JSON.xpath("/indicators[_id eq '"+i+"']/_rev",r,{})[0],a=t[n].model.pending.seq,u=t[n].model.pending.status,d={uuid:i,rev:o,seq:a,status:u};e.indicators.push(d)}else{var i=t[n].instances[0].uuid,o=JSON.xpath("/indicators[_id eq '"+i+"']/_rev",r,{})[0],a=JSON.xpath("/indicators[_id eq '"+i+"']/model/pending/seq",r,{})[0],u=JSON.xpath("/indicators[_id eq '"+i+"']/model/pending/status",r,{})[0],d={uuid:i,rev:o,seq:a,status:u};e.indicators.push(d)}return delete e.assignedTo,delete e.assignment,e},N={transitionId:S[0]._id,dateTime:moment().format(),userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userId+""};if(void 0!=u&&Object.keys(u).length>0?u.transition=N:P.transition=N,void 0!=u&&Object.keys(u).length>0){void 0==u.assignmentHistory&&(u.assignmentHistory=[]);var T=JSON.parse(JSON.stringify(u.assignedTo));""!=T.userId&&""!=T.name&&u.assignmentHistory.push(T)}else{void 0==P.assignmentHistory&&(P.assignmentHistory=[]);var T=JSON.parse(JSON.stringify(P.assignedTo));""!=T.userId&&""!=T.name&&P.assignmentHistory.push(T)}var q;q=void 0!=u&&Object.keys(u).length>0?JSON.parse(JSON.stringify(u)):JSON.parse(JSON.stringify(P));var O=_(q);if(y.history.push(O),void 0!=S[0].transitionAction.goToStep){var k=parseInt(v[0]._seq)+parseInt(S[0].transitionAction.goToStep.default),A="";g[0].steps.filter(function(e){parseInt(e._seq)==m&&(A=e._id)}),step(e,t,s,n,A,k,a,r,c).then(function(e){if(k==b){var t=util.success("All Step transitions have completed successfully.",{subProcessComplete:!0,step:e.data});d(t)}else{var t=util.success("Step transition completed successfully.",{subProcessComplete:!1,step:e.data});d(t)}},function(e){p(e)})}else if(void 0!=S[0].transitionAction.goToStepId){var w=S[0].transitionAction.goToStepId.stepId,E=1;g[0].steps.filter(function(e){e._id==w&&(E=parseInt(e._seq))}),step(e,t,s,n,w,E,a,r,c).then(function(e){if(E==b||"Complete"==e.data.status){var t=util.success("All Step transitions have completed successfully.",{subProcessComplete:!0,step:e.data});d(t)}else{var t=util.success("Step transition completed successfully.",{subProcessComplete:!1,step:e.data});d(t)}},function(e){p(e)})}else if(void 0!=S[0].transitionAction.stop){var x=h[0].postActions;postActions(x,r,c).then(function(e){var t=util.success("Step transition completed successfully.Workflow stopped.",{subProcessComplete:!0,step:u});d(t)},function(e){p(e)})}}catch(e){p(e)}})}function postActions(e,t,s){return new Promise(function(n,i){var o=[];try{var a=JSON.xpath("/subprocesses[_id eq '"+s+"']",t,{})[0],r=a["meta-data"].processConfigId,c=a["meta-data"].subProcessConfigId,u=a["meta-data"].subProcessInsSeq,d=a["meta-data"].subProcessInsSeq,p=JSON.xpath("/config/processes[_id eq '"+r+"']/subProcesses[_id eq '"+c+"']",t,{})[0],l=JSON.xpath("/subprocesses[_id eq '"+s+"']/step",t,{})[0];util.syncLoop(e.length,function(n){var a=n.iteration();action(e[a],r,u,c,d,p,l,t,{},s).then(function(e){o.push(!0),n.next()},function(e){o.push(!1),n.break(),i(e)})},function(){if(o.every(Boolean)){var e=util.success("Post-actions completed successfully.",{});n(e)}else{var t=util.error("WFPreActionsError","Not all post-actions passed.");i(t)}})}catch(e){i(e)}})}function processWorkflowMessage(e,t){var s=e;if(s.indexOf("#INSTANCE_LABEL")!==-1){var n=JSON.xpath("/instance/processes/subProcesses[uuid eq '"+t+"']/label",app.SCOPE.workflow,{})[0];s=s.replace("#INSTANCE_LABEL",n)}if(s.indexOf("#USER_NAME")!==-1){var n=JSON.xpath("/subprocesses[_id eq '"+t+"']/step/assignedTo/name",app.SCOPE.workflow,{})[0];s=s.replace("#USER_NAME",n)}if(s.indexOf("#PROFILE_TITLE")!==-1){var n=app.profile.title;s=s.replace("#PROFILE_TITLE",n)}if(s.indexOf("#PROFILE_TYPE")!==-1){var n=app.SCOPE.APP_CONFIG.name;s=s.replace("#PROFILE_TYPE",n)}if(s.indexOf("#VAR_SPUUID")!==-1){var n=t;s=s.replace("#VAR_SPUUID",n)}return s}function _getName(e,t){if(void 0!==e)for(var s=0;s<e.length;s++)if(e[s]._lang===t)return e[s].value}function _getNameByLang(e){return library.getNameByLang(e)}function preWorkActions(e,t){return new Promise(function(s,n){var i=[];try{var o=JSON.xpath("/config/processes[_id eq '"+app.processID+"']/subProcesses[_id eq '"+app.processId+"']",t,{})[0],a=JSON.xpath("/subprocesses[_id eq '"+app.SCOPE.processUUID+"']/step",t,{})[0];util.syncLoop(e.length,function(s){var r=s.iteration();action(e[r],app.processID,app.processSEQ,app.processId,app.processSeq,o,a,t,{},app.SCOPE.processUUID).then(function(e){i.push(!0),s.next()},function(e){i.push(!1),s.break(),n(e)})},function(){if(i.every(Boolean)){var e=util.success("PreWork-actions completed successfully.",{});s(e)}else{var t=util.error("WFPreActionsError","Not all pre-work-actions passed.");n(t)}})}catch(e){n(e)}})}var util=require("utility"),actionsModule=require("./actions"),helper=require("./helper"),form=require("./form");module.exports={preRequisites:preRequisites,preActions:preActions,postActions:postActions,preWorkActions:preWorkActions,subProcess:subProcess,indicatorDocs:indicatorDocs,task:task,transition:transition,assignUser:assignUser};

},{"./actions":2,"./form":3,"./helper":4,"utility":8}],8:[function(require,module,exports){
"use strict";function success(r,e){return{message:r,data:e}}function warn(r,e){return console.warn(e),{warning:r,data:e}}function error(r,e){var n=new Error("");return n.name=r,n.message=e,n}function syncLoop(r,e,n){var a=0,t=!1,o=!1,u={next:function(){return t&&o&&n?n():void(a<r?(a++,e(u)):(t=!0,n&&n()))},iteration:function(){return a-1},break:function(r){t=!0,o=r}};return u.next(),u}function compare(r,e,n){switch(e){case"greaterThan":return r>n;case"lessThan":return r<n;case"greaterThanEqual":return r>=n;case"lessThanEqual":return r<=n;case"equalTo":return r===n;case"notEqualTo":return r!==n}}function getName(r,e){if(void 0!==r)for(var n=0;n<r.length;n++)if(r[n].i18n._lang===e)return r[n].i18n.value}module.exports={success:success,warn:warn,error:error,syncLoop:syncLoop,compare:compare,getName:getName};

},{}]},{},[1])(1)
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJpbmRleC5qcyIsImxpYi9hY3Rpb25zLmpzIiwibGliL2Zvcm0uanMiLCJsaWIvaGVscGVyLmpzIiwibGliL2ludGVyZmFjZS5qcyIsImxpYi9ub2RlVmFsdWUuanMiLCJsaWIvcHJvY2Vzcy5qcyIsIm5vZGVfbW9kdWxlcy91dGlsaXR5L2luZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUEsWUE4Q0EsU0FBUyxVQUFTLEVBQVMsRUFBYSxFQUFLLEdBQ3pDLEdBQUksR0FBUSxJQUdaLElBQW1CLElBQWYsR0FBb0MsUUFBZixFQUNyQixLQUFNLE1BQUssTUFBTSxnQkFBaUIsOEJBQy9CLElBQTRCLGdCQUFsQixHQUNiLEtBQU0sSUFBSSxPQUFNLGdEQU1wQixJQUpJLEVBQU0sWUFBYyxHQUFlLEdBSXhCLElBQVgsR0FBNEIsUUFBWCxFQUNqQixLQUFNLE1BQUssTUFBTSxnQkFBaUIsNEJBQy9CLElBQXdCLGdCQUFkLEdBQ2IsS0FBTSxJQUFJLE9BQU0sOENBTXBCLElBSkksRUFBTSxRQUFVLEdBQVcsR0FJcEIsSUFBUCxHQUFvQixRQUFQLEVBQ2IsS0FBTSxNQUFLLE1BQU0sZ0JBQWlCLHlCQUMvQixJQUFvQixnQkFBVixHQUNiLEtBQU0sSUFBSSxPQUFNLDBDQU1wQixJQUpJLEVBQU0sSUFBTSxHQUFPLEdBSVQsSUFBVixHQUEwQixRQUFWLEVBQ2hCLEtBQU0sTUFBSyxNQUFNLGdCQUFpQix3Q0FDUixpQkFBYixHQUNiLEVBQU0sT0FBUyxLQUFLLE1BQU0sR0FFMUIsRUFBTSxPQUFTLEVBSW5CLEVBQU0sU0FFTixFQUFNLGdCQUVOLEVBQU0sY0F4RlYsR0FBSSxTQUFVLFFBQVEsaUJBQ2xCLEtBQU8sUUFBUSxXQUNmLGNBQWdCLFFBQVEsbUJBQ3hCLE9BQVMsUUFBUSxlQWtHckIsVUFBUyxVQUFVLFdBQWEsV0FDNUIsTUFBTyxNQUFLLFNBV2hCLFNBQVMsVUFB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Q0FDbEIsS0FBSyxXQUNKLE1BQU8sR0FBVSxDQUNsQixLQUFLLG1CQUNKLE1BQU8sSUFBVyxDQUNuQixLQUFLLGdCQUNKLE1BQU8sSUFBVyxDQUNuQixLQUFLLFVBQ0osTUFBTyxLQUFZLENBQ3BCLEtBQUssYUFDSixNQUFPLEtBQVksR0FJdEIsUUFBUyxTQUFRLEVBQUssR0FDckIsR0FBWSxTQUFSLEVBQ0gsSUFBSyxHQUFJLEdBQUksRUFBRyxFQUFJLEVBQUksT0FBUyxJQUNoQyxHQUFJLEVBQUksR0FBRyxLQUFLLFFBQVUsRUFDekIsTUFBTyxHQUFJLEdBQUcsS0FBSyxNQU12QixPQUFPLFNBRUwsUUFBUyxRQUNULEtBQU0sS0FDTixNQUFPLE1BQ1AsU0FBVSxTQUNWLFFBQVMsUUFDVixRQUFTIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIid1c2Ugc3RyaWN0JztcblxudmFyIFByb2Nlc3MgPSByZXF1aXJlKCcuL2xpYi9wcm9jZXNzJyk7XG52YXIgdXRpbCA9IHJlcXVpcmUoJ3V0aWxpdHknKTtcbnZhciB1c2VySW50ZXJmYWNlID0gcmVxdWlyZSgnLi9saWIvaW50ZXJmYWNlJyk7XG52YXIgaGVscGVyID0gcmVxdWlyZSgnLi9saWIvaGVscGVyJyk7XG5cblxuLypnbG9iYWxzICovXG5cbi8qKlxuICogQSBuZXcgV29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2UgY29udGFpbnMgdGhlIHJlZmVyZW5jZSB0byB0aGUgYXBwbGljYXRpb25cbiAqIGFuZCBhc3NvY2lhdGVkIHByb2ZpbGUgd2hpY2ggaXQgcmVxdWlyZXMgYXMgdGhlIGZpcnN0IHR3byBwYXJhbWV0ZXJzLiBJdCBhbHNvXG4gKiByZXF1aXJlcyBhIHdvcmtmbG93IGNvbmZpZ3VyYXRpb24sIGFzIHRoZSB0aGlyZCBwYXJhbWV0ZXIsIHdoaWNoIGlzIHVzZWQgdG9cbiAqIGRlc2NpYmUgdGhlIHdvcmtmbG93IHByb2Nlc3Nlcy4gSWYgYSB3b3JrZmxvdyBpbnN0YW5jZSBleGlzdHMgeW91IGNhbiBwYXNzIGl0XG4gKiBpbiBhcyB0aGUgZm91cnRoIHBhcmFtZXRlciB3aGljaCBpdCB3aWxsIHRoZW4gdXNlLCBlbHNlIGNyZWF0ZSBhIG5ldyBvbmUuXG4gKlxuICogQGNvbnN0cnVjdG9yXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2ZpbGUgLSBUaGUgY3VycmVudCBwcm9maWxlIGlkXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwIC0gVGhlIGFzc29jaWF0ZWQgYXBwbGljYXRpb24gaWRcbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgLSBUaGUgYXBwbGljYXRpb24gd29ya2Zsb3cgY29uZmlndXJhdGlvbiAvIGRlZmluaXRpb25cbiAqIEBwYXJhbSB7T2JqZWN0fSBbaW5zdGFuY2VdIC0gQW4gZXhpc3RpbmcgYXBwbGljYXRpb24gcHJvZmlsZSB3b3JrZmxvdyBpbnN0YW5jZSBiYXNlZFxuICogb24gdGhlIGRlZmluaXRpb25cbiAqXG4gKiBAYXV0aG9yIEJyZW50IEdvcmRvblxuICogQHZlcnNpb24gMC4xLjBcbiAqXG4gKiBAZXhhbXBsZVxuICogdmFyIGNvbmZpZyA9IHsgJ19pZCc6ICdhYmMxMjMnIH07XG5cbiAqIHZhciBpbnN0YW5jZSA9IHsgJ19pZCc6ICdpbnN0YW5jZV9hYmMxMjMnIH07XG5cbiAqIC8vIElmIHRoZXJlIGlzbid0IGFuIGV4aXN0aW5nIGluc3RhbmNlXG4gKiB2YXIgd29ya2Zsb3cgPSBuZXcgV29ya2Zsb3coJzEyMzQnLCAnNTY3OCcsIGNvbmZpZyk7XG4gKiAvLyBJZiB0aGVyZSBpcyBhbiBleGlzdGluZyBpbnN0YW5jZVxuICogdmFyIHdvcmtmbG93ID0gbmV3IFdvcmtmbG93KCcxMjM0JywgJzU2NzgnLCBjb25maWcsIGluc3RhbmNlKTtcbiAqXG4gKiBAcmV0dXJuIHtPYmplY3R9IG5ldyBXb3JrZmxvdyBvYmplY3RcbiAqXG4gKiBAdGhyb3dzIEVycm9yOiBBIHByb2ZpbGUgaWQgaXMgcmVxdWlyZWRcbiAqIEB0aHJvd3MgRXJyb3I6IEFuIGFwcCBpZCBpcyByZXF1aXJlZFxuICogQHRocm93cyBFcnJvcjogQSB3b3JrZmxvdyBjb25maWd1cmF0aW9uIGlzIHJlcXVpcmVkXG4gKlxuICovXG5cbmZ1bmN0aW9uIFdvcmtmbG93KHByb2ZpbGUsIGNvbW11bml0eUlkLCBhcHAsIGNvbmZpZykge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAvLyBDb21tdW5pdHkgSUQgdmFsaWRhdGlvbiBjaGVja3NcbiAgICBpZiAoY29tbXVuaXR5SWQgPT0gJycgfHwgY29tbXVuaXR5SWQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IHV0aWwuZXJyb3IoJ1BhcmFtUmVxdWlyZWQnLCAnQSBjb21tdW5pdHkgaWQgaXMgcmVxdWlyZWQuJyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YoY29tbXVuaXR5SWQpICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb21tdW5pdHkgaWQgbXVzdCBiZSBhIGphdmFzY3JpcHQgc3RyaW5nLicpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIF90aGlzLmNvbW11bml0eUlkID0gY29tbXVuaXR5SWQgfHwgJyc7XG4gICAgfVxuXG4gICAgLy8gUHJvZmlsZSBJRCB2YWxpZGF0aW9uIGNoZWNrc1xuICAgIGlmIChwcm9maWxlID09ICcnIHx8IHByb2ZpbGUgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHRocm93IHV0aWwuZXJyb3IoJ1BhcmFtUmVxdWlyZWQnLCAnQSBwcm9maWxlIGlkIGlzIHJlcXVpcmVkLicpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mKHByb2ZpbGUpICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBwcm9maWxlIGlkIG11c3QgYmUgYSBqYXZhc2NyaXB0IHN0cmluZy4nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBfdGhpcy5wcm9maWxlID0gcHJvZmlsZSB8fCAnJztcbiAgICB9XG5cbiAgICAvLyBBcHAgSUQgdmFsaWRhdGlvbiBjaGVja3NcbiAgICBpZiAoYXBwID09ICcnIHx8IGFwcCA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgdXRpbC5lcnJvcignUGFyYW1SZXF1aXJlZCcsICdBbiBhcHAgaWQgaXMgcmVxdWlyZWQuJyk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YoYXBwKSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdUaGUgYXBwIGlkIG11c3QgYmUgYSBqYXZhc2NyaXB0IHN0cmluZy4nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBfdGhpcy5hcHAgPSBhcHAgfHwgJyc7XG4gICAgfVxuXG4gICAgLy8gV29ya2Zsb3cgY29uZmlndXJhdGlvbiB2YWxpZGF0aW9uIGNoZWNrc1xuICAgIGlmIChjb25maWcgPT0gJycgfHwgY29uZmlnID09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyB1dGlsLmVycm9yKCdQYXJhbVJlcXVpcmVkJywgJ0Egd29ya2Zsb3cgY29uZmlndXJhdGlvbiBpcyByZXF1aXJlZC4nKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZihjb25maWcpICE9PSAnb2JqZWN0Jykge1xuICAgICAgICBfdGhpcy5jb25maWcgPSBKU09OLnBhcnNlKGNvbmZpZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgX3RoaXMuY29uZmlnID0gY29uZmlnO1xuICAgIH1cblxuICAgIC8vIFdvcmtmbG93IGluc3RhbmNlIHZhbGlkYXRpb24gY2hlY2tzXG4gICAgX3RoaXMuaW5zdGFuY2U7XG4gICAgLy8gV29ya2Zsb3cgc3ViLXByb2Nlc3NlcyB2YWxpZGF0aW9uIGNoZWNrc1xuICAgIF90aGlzLnN1YnByb2Nlc3NlcyA9IFtdO1xuICAgIC8vIFdvcmtmbG93IGluZGljYXRvcnMgcGxhY2UgaG9sZGVyXG4gICAgX3RoaXMuaW5kaWNhdG9ycyA9IFtdO1xuXG5cbn1cblxuLyoqXG4gKiBXb3JrZmxvdyBnZXQgcHJvZmlsZSBpZC5cbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuZ2V0UHJvZmlsZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnByb2ZpbGU7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IGdldCBhcHAgaWQuXG4gKlxuICogQGV4YW1wbGUgXCJcIlxuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLmdldEFwcCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmFwcDtcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgZ2V0IGNvbmZpZy5cbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuZ2V0Q29uZmlnID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuY29uZmlnO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyBnZXQgaW5zdGFuY2UuXG4gKlxuICogQGV4YW1wbGUgXCJcIlxuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuXG5Xb3JrZmxvdy5wcm90b3R5cGUuZ2V0SW5zdGFuY2UgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5pbnN0YW5jZTtcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgc2V0IHRoZSBpbnN0YW5jZSBkYXRhLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIC0gdGhlIHdvcmtmbG93IHByb2Nlc3MgaW5zdGFuY2UgZGF0YVxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5zZXRJbnN0YW5jZSA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICB0aGlzLmluc3RhbmNlID0gZGF0YTtcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgZ2V0IHN1Yi1wcm9jZXNzZXMgZGF0YS5cbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuZ2V0U3ViUHJvY2Vzc2VzID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuc3VicHJvY2Vzc2VzO1xufTtcblxuLyoqXG4gKiBXb3JrZmxvdyBzZXQgdGhlIHN1Yi1wcm9jZXNzZXMgZGF0YS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gZGF0YSAtIHRoZSB3b3JrZmxvdyBwcm9jZXNzIGluc3RhbmNlIGRhdGFcbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuc2V0U3ViUHJvY2Vzc2VzID0gZnVuY3Rpb24oZGF0YSkge1xuICAgIHRoaXMuc3VicHJvY2Vzc2VzID0gZGF0YTtcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgZ2V0IGluZGljYXRvciBzZXQgZGF0YS5cbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuZ2V0SW5kaWNhdG9ycyA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLmluZGljYXRvcnM7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IHNldCB0aGUgaW5kaWNhdG9yIHNldCBkYXRhLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhIC0gdGhlIHdvcmtmbG93IHByb2Nlc3MgaW5zdGFuY2UgZGF0YVxuICpcbiAqIEBleGFtcGxlIFwiXCJcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS5zZXRJbmRpY2F0b3JzID0gZnVuY3Rpb24oZGF0YSkge1xuICAgIHRoaXMuaW5kaWNhdG9ycyA9IGRhdGE7XG59O1xuXG4vKipcbiAqIFNldCB0aGUgdmFyaWFibGUgdmFsdWUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBwcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3ViUHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3ViLXByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdWJQcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHN1Yi1wcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN0ZXBJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN0ZXAgaWRcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YXJpYWJsZSAtIHRoZSBXb3JrZmxvdyB2YXJpYWJsZSBvYmplY3RcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbi8vIFdvcmtmbG93LnByb3RvdHlwZS5zZXRWYXJpYWJsZSA9IGZ1bmN0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHZhcmlhYmxlKXtcbi8vIFx0dmFyIF90aGlzID0gdGhpcztcbi8vIFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuLy8gXHRcdHRyeSB7XG4vLyBcdFx0XHRQcm9jZXNzLmdldFZhcmlhYmxlKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHZhcmlhYmxlKS50aGVuKGZ1bmNpb24ocmVzdWx0KXtcbi8vIFx0XHRcdFx0cmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4vLyBcdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuLy8gXHRcdFx0XHRyZWplY3QoZXJyKTtcbi8vIFx0XHRcdH0pXG4vLyBcdFx0fSBjYXRjaCAoZXJyKSB7XG4vLyBcdFx0XHRyZWplY3QoZXJyKTtcbi8vIFx0XHR9XG5cbi8vIFx0fSk7XG4vLyB9O1xuXG4vKipcbiAqIEdldCB0aGUgdmFyaWFibGUgdmFsdWUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBwcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3ViUHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3ViLXByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdWJQcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHN1Yi1wcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN0ZXBJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN0ZXAgaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSB0aGUgV29ya2Zsb3cgdmFyaWFibGUgaWRcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbi8vIFdvcmtmbG93LnByb3RvdHlwZS5nZXRWYXJpYWJsZSA9IGZ1bmN0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIGtleSl7XG4vLyBcdHZhciBfdGhpcyA9IHRoaXM7XG4vLyBcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbi8vIFx0XHR0cnkge1xuLy8gXHRcdFx0UHJvY2Vzcy5zZXRWYXJpYWJsZShwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCBrZXkpLnRoZW4oZnVuY2lvbihyZXN1bHQpe1xuLy8gXHRcdFx0XHRyZXNvbHZlKHJlc3VsdC5kYXRhKTtcbi8vIFx0XHRcdH0sIGZ1bmN0aW9uKGVycil7XG4vLyBcdFx0XHRcdHJlamVjdChlcnIpO1xuLy8gXHRcdFx0fSlcbi8vIFx0XHR9IGNhdGNoIChlcnIpIHtcbi8vIFx0XHRcdHJlamVjdChlcnIpO1xuLy8gXHRcdH1cblxuLy8gXHR9KTtcbi8vIH07XG5cbi8qKlxuICogVGhpcyBtZXRob2QgY3JlYXRlcyBhIG5ldyB3b3JrZmxvdyBwcm9jZXNzIGkuZS4gaXQgY3JlYXRlcyBhIHdvcmtmbG93IHByb2Nlc3NlcyBpbnN0YW5jZVxuICogb2JqZWN0IHdpdGggdGhlIG1pbmltdW0gcmVxdWlyZWQgZGF0YS4gVGhpcyBpbnN0YW5jZSBjYW4gYmUgcmVmZXJlbmNlZCBpbiB0aGUgZm9sbG93aW5nXG4gKiB3YXksIHNlZSBleGFtcGxlIGJlbG93LlxuICpcbiAqIEBleGFtcGxlXG4gKiB2YXIgY29uZmlnID0geyAnX2lkJzogJ2FiYzEyMycgfTtcblxuICogdmFyIHdvcmtmbG93ID0gbmV3IFdvcmtmbG93KCcxMjM0JywgJzU2NzgnLCBjb25maWcpO1xuICogd29ya2Zsb3cuY3JlYXRlKCkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuICpcdGNvbnNvbGUubG9nKHJlc3VsdC5tZXNzYWdlKTtcbiAqXHQvLyBUaGUgZm9sbG93aW5nIHByb3BlcnRpZXMgY2FuIG5vdyBiZSBhY2Nlc3NlZFxuICogXHR2YXIgcHJvZmlsZSA9IHdvcmtmbG93LnByb2ZpbGU7XG4gKiBcdHZhciBhcHAgPSB3b3JrZmxvdy5hcHA7XG4gKiBcdHZhciBjb25maWcgPSB3b3JrZmxvdy5jb25maWc7XG4gKlx0Ly8gT24gc3VjY2VzcyB5b3UgY2FuIGFjY2VzcyB0aGUgaW5zdGFuY2UgdGhlIGZvbGxvd2luZyB3YXlcbiAqXHR2YXIgaW5zdGFuY2UgPSB3b3JrZmxvdy5pbnN0YW5jZTtcbiAqIH0sIGZ1bmN0aW9uKGVycm9yKXtcbiAqXHRjb25zb2xlLmxvZyhlcnJvcik7XG4gKiB9KTtcbiAqXG4gKiBAcmV0dXJuIHtPYmplY3R9IG5ldyBXb3JrZmxvdyBpbnN0YW5jZSB3aXRoIHVwZGF0ZWQgaW5zdGFuY2UgZGF0YS5cbiAqXG4gKi9cblxuV29ya2Zsb3cucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKF90aGlzLmluc3RhbmNlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgd2FybiA9IHV0aWwud2FybignSW5zdGFuY2UgYWxyZWFkeSBleGlzdHMuJywgX3RoaXMpXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh3YXJuKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSB3b3JrZmxvdyBwcm9jZXNzZXMgaW5zdGFuY2Ugb2JqZWN0XG4gICAgICAgICAgICAgICAgdmFyIG1vZGVsID0ge1xuICAgICAgICAgICAgICAgICAgICBfaWQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3dvcmtmbG93SW5zdGFuY2UnLFxuICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZXM6IFtdLFxuICAgICAgICAgICAgICAgICAgICBjaGFubmVsczogW1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZV9cIiArIGFwcC5TQ09QRS5wcm9maWxlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uX1wiICsgYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpICsgXCJfYXBwbGljYXRpb25fXCIgKyBhcHAuU0NPUEUuYXBwbGljYXRpb25JZFxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIG1vZGVsLl9pZCA9IFwiX2xvY2FsL1wiICsgX3RoaXMucHJvZmlsZSArICc6cHJvY2Vzc2VzOmxvY2FsJztcbiAgICAgICAgICAgICAgICAvL21vZGVsLl9pZCA9IF90aGlzLnByb2ZpbGUgKyAnOnByb2Nlc3Nlcyc7XG5cbiAgICAgICAgICAgICAgICBtb2RlbC52ZXJzaW9uID0gX3RoaXMuY29uZmlnLnZlcnNpb247XG4gICAgICAgICAgICAgICAgX3RoaXMuaW5zdGFuY2UgPSBtb2RlbDtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnV29ya2Zsb3cgcHJvY2Vzc2VzIGluc3RhbmNlIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5LicsIF90aGlzKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IGluaXRpYWxpc2UsIHRoaXMgZnVuY3Rpb24gZXhlY3V0ZXMgYSBwcm9jZXNzIHdpdGhpbiBhIHdvcmtmbG93XG4gKiBjb25maWd1cmF0aW9uLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgcHJvY2VzcyBpZCB0byBwcm9jZXNzXG4gKiBAcGFyYW0ge29iamVjdH0gW2RhdGFdIC0gdGhlIGlucHV0IGRhdGEgdG8gcHJvY2Vzc1xuICpcbiAqIEBleGFtcGxlXG4gKiBXb3JrZmxvdy5pbml0aWFsaXNlKCdwcm9jZXNzSWQnLCB7IHZhbGlkRGF0ZTogJ2RhdGUnIH0pO1xuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuV29ya2Zsb3cucHJvdG90eXBlLmluaXRpYWxpc2UgPSBmdW5jdGlvbihwcm9jZXNzSWQsIGRhdGEsIHN1YnByb2ZpbGVJZCkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGNvbmZpZ1Byb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgIC8vIENoZWNrIHRoZSBwYXNzZWQgaW4gcGFyYW1ldGVyc1xuICAgICAgICAgICAgaWYgKHByb2Nlc3NJZCAhPT0gJycgJiYgcHJvY2Vzc0lkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAvLyBHZXQgdGhlIGN1cnJlbnQgcHJvY2VzcyBjb25maWdcbiAgICAgICAgICAgICAgICBjb25maWdQcm9jZXNzID0gX3RoaXMuY29uZmlnLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqUHJvY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAob2JqUHJvY2Vzcy5faWQgPT0gcHJvY2Vzc0lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqUHJvY2VzcztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpZ1Byb2Nlc3NbMF0uX2lkID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRkNvbmZpZ0Vycm9yJywgJ05vIHZhbGlkIHByb2Nlc3MgZGVmaW5pdGlvbiBmb3VuZCB3aXRoIHByb2Nlc3MgaWQ6ICcgKyBwcm9jZXNzSWQpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25maWdQcm9jZXNzLnB1c2goX3RoaXMuY29uZmlnLnByb2Nlc3Nlc1swXSk7XG4gICAgICAgICAgICAgICAgcHJvY2Vzc0lkID0gX3RoaXMuY29uZmlnLnByb2Nlc3Nlc1swXS5faWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdldCB0aGUgY3VycmVudCBsaXN0IG9mIHByb2Nlc3MgaW5zdGFuY2VzXG4gICAgICAgICAgICAvLyB2YXIgcHJvY2Vzc1NlcSA9IDE7XG4gICAgICAgICAgICB2YXIgY3VycmVudFByb2Nlc3MgPSBbXTtcbiAgICAgICAgICAgIF90aGlzLmluc3RhbmNlLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ocHJvY2Vzc0l0ZW0pIHtcbiAgICAgICAgICAgICAgICBpZiAocHJvY2Vzc0l0ZW0uaWQgPT0gcHJvY2Vzc0lkKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQcm9jZXNzLnB1c2gocHJvY2Vzc0l0ZW0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgcHJvY2Vzc1NlcSA9IGN1cnJlbnRQcm9jZXNzLmxlbmd0aCArIDE7XG4gICAgICAgICAgICAvLyB2YXIgbmV4dFNlcSA9IHByb2Nlc3NTZXEgKyAxO1xuICAgICAgICAgICAgLy8gUHVzaCB0aGUgcHJvY2VzcyBvYmplY3QgaW50byB0aGUgYXJyYXlcbiAgICAgICAgICAgIHZhciBwcm9jZXNzTW9kZWwgPSB7XG4gICAgICAgICAgICAgICAgaWQ6ICcnLFxuICAgICAgICAgICAgICAgIHNlcTogJycsXG4gICAgICAgICAgICAgICAgc3ViUHJvY2Vzc2VzOiBbXVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyAxLiBVcGRhdGUgdGhlIHByb2Nlc3MgaWQgYW5kIHNlcVxuICAgICAgICAgICAgcHJvY2Vzc01vZGVsLmlkID0gcHJvY2Vzc0lkO1xuICAgICAgICAgICAgcHJvY2Vzc01vZGVsLnNlcSA9IHByb2Nlc3NTZXE7XG4gICAgICAgICAgICBfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXMucHVzaChwcm9jZXNzTW9kZWwpO1xuICAgICAgICAgICAgLy8gUGFyYW1ldGVyc1xuICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NJZCA9IGNvbmZpZ1Byb2Nlc3NbMF0uc3ViUHJvY2Vzc2VzWzBdLl9pZDtcbiAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzU2VxID0gMTtcbiAgICAgICAgICAgIF90aGlzLmluc3RhbmNlLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ocHJvY2Vzc0l0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByb2Nlc3NJdGVtLmlkID09IHByb2Nlc3NJZCAmJiBwcm9jZXNzSXRlbS5zZXEgPT0gcHJvY2Vzc1NlcSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc1NlcSA9IHByb2Nlc3NJdGVtLnN1YlByb2Nlc3Nlcy5sZW5ndGggKyAxXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLy8gQ2FsbCB0aGUgc3VicHJvY2VzcyBtZXRob2RcblxuICAgICAgICAgICAgUHJvY2Vzcy5zdWJQcm9jZXNzKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdWJwcm9maWxlSWQsIGRhdGEsIF90aGlzKS50aGVuKGZ1bmN0aW9uKHN1YlByb2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAvLyBHZW5lcmF0ZSB0aGUgdXVpZFxuXG4gICAgICAgICAgICAgICAgdmFyIHV1aWQgPSBzdWJQcm9jZXNzLmRhdGEuX2lkOyAvL190aGlzLnByb2ZpbGUgKyAnOicgKyBfdGhpcy5hcHAgKyAnOicgKyBwcm9jZXNzSWQgKyAnOicgKyBwcm9jZXNzU2VxICsgJzonICsgc3ViUHJvY2Vzc0lkICsgJzonICsgc3ViUHJvY2Vzc1NlcTtcblxuICAgICAgICAgICAgICAgIC8vIEJ1aWxkIHRoZSBzdWItcHJvY2VzcyByZWZlcmVuY2Ugb2JqZWN0XG5cbiAgICAgICAgICAgICAgICB2YXIgZ3JvdXBLZXkgPSBzdWJQcm9jZXNzLmRhdGEuZ3JvdXBLZXk7XG4gICAgICAgICAgICAgICAgLy9UT0RPOiBDaGFuZ2UgcmVxdWlyZWQgdG8gbW92ZSBpc0FjdGl2ZSB0byBzdWJQcm9jZXNzIGZpbGUuUmVtb3ZlIGZyb20gaGVyZVxuICAgICAgICAgICAgICAgIGlmIChzdWJwcm9maWxlSWQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9ICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc1JlZiA9IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHN1YlByb2Nlc3NJZCxcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkOiBzdWJwcm9maWxlSWQsXG4gICAgICAgICAgICAgICAgICAgIHNlcTogc3ViUHJvY2Vzcy5kYXRhW1wibWV0YS1kYXRhXCJdLnN1YlByb2Nlc3NJbnNTZXEsXG4gICAgICAgICAgICAgICAgICAgIHV1aWQ6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgIGdyb3VwS2V5OiBncm91cEtleVxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gQWRkIHRoZSByZWZlcmVuY2UgdG8gdGhlIHByb2Nlc3MgbW9kZWxcbiAgICAgICAgICAgICAgICBwcm9jZXNzTW9kZWwuc3ViUHJvY2Vzc2VzLnB1c2goc3ViUHJvY2Vzc1JlZik7XG4gICAgICAgICAgICAgICAgLy8gQWRkIHRoZSBzdWJQcm9jZXNzIG1vZGVsIHRvIHRoZSBzdWJwcm9jZXNzZXMgYXJyYXlcbiAgICAgICAgICAgICAgICAvL190aGlzLnN1YnByb2Nlc3Nlcy5wdXNoKHN1YlByb2Nlc3MuZGF0YSk7XG4gICAgICAgICAgICAgICAgLy8gX3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzLnB1c2gocHJvY2Vzc01vZGVsKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgX3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc0l0ZW0gPSBfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXNbaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2Vzc0l0ZW0uaWQgPT0gcHJvY2Vzc0lkICYmIHByb2Nlc3NJdGVtLnNlcSA9PSBwcm9jZXNzU2VxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGN1cnJlbnQgcHJvY2VzcyBmcm9tIHRoZSBhcnJheSBhbmQgYWRkIHRoZSB1cGRhdGVkIHByb2Nlc3NNb2RlbFxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW5zdGFuY2UucHJvY2Vzc2VzLnNwbGljZShpbmRleCwgMSwgcHJvY2Vzc01vZGVsKVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIHRoZSBpbmRpY2F0b3IgZG9jdW1lbnRzIHdvcmtmbG93IHByb2Nlc3NlcyB1cGRhdGVzXG4gICAgICAgICAgICAgICAgdmFyIGluZGljYXRvcnMgPSBzdWJQcm9jZXNzLmRhdGEuaW5kaWNhdG9ycztcbiAgICAgICAgICAgICAgICB2YXIgc3RlcCA9IHN1YlByb2Nlc3MuZGF0YS5zdGVwO1xuICAgICAgICAgICAgICAgIFByb2Nlc3MuaW5kaWNhdG9yRG9jcyhwcm9jZXNzSWQsIGluZGljYXRvcnMsIHN0ZXAsIF90aGlzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUHJvY2VzczogJyArIF90aGlzLmNvbmZpZy5wcm9jZXNzZXNbMF0uX2lkICsgJyBpbml0aWFsaXplZCBzdWNjZXNzZnVsbHkuJywgc3ViUHJvY2Vzc1JlZik7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXMgPSBfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gIShvYmouaWQgPT0gcHJvY2Vzc0lkICYmIG9iai5zZXEgPT0gcHJvY2Vzc1NlcSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogV29ya2Zsb3cgdHJhbnNpdGlvbiB0byB0aGUgbmV4dCBzdGVwLiBUaGlzIG1vdmVzIHRoZSB3b3JrZmxvdyBmcm9tIHRoZSBjdXJyZW50IHByb2Nlc3MsXG4gKiBzdWItcHJvY2VzcyBzdGVwIHRvIHRoZSBuZXh0IG9uZSBhcyBzcGVjaWZpZWQuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBwcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3ViUHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3ViLXByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdWJQcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHN1Yi1wcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN0ZXBJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN0ZXAgaWQgXG4gKiBAcGFyYW0ge3N0cmluZ30gdHJhbnNpdGlvbklkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gdHJhbnNpdGlvbiBpZFxuICogQHBhcmFtIHtvYmplY3R9IGRhdGEgLSBhbnkgYWRkaXRpb25hbCBkYXRhIHBhc3NlZCBpbiBhcyBrZXkgdmFsdWUgcGFpcnNcbiAqXG4gKiBAZXhhbXBsZVxuICogV29ya2Zsb3cudHJhbnNpdGlvbigncHJvY2Vzc0lkJywgMSwgJ3N1YlByb2Nlc3NJZCcsIDEsICdzdGVwSWQnLCAndHJhbnNpdGlvbklkJywgeyBrZXk6ICcnLCB2YWx1ZTogJycgfSk7XG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUudHJhbnNpdGlvbiA9IGZ1bmN0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHRyYW5zaXRpb25JZCwgZGF0YSwgc3B1dWlkKSB7XG4gICAgLy8gUmUtYXNzaWduIHRoaXNcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBtb2RlbCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3N0ZXBcIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcElkICsgXCInXVwiLCBfdGhpcy5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzU2VxID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vbWV0YS1kYXRhL3N1YlByb2Nlc3NJbnNTZXFcIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG5cbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgY3VycmVudCBzdWItcHJvY2VzcyBzdGVwIGRhdGFcbiAgICAgICAgICAgIHZhciB1cGRhdGUgPSBmdW5jdGlvbih0eXBlLCByZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHByb2Nlc3NJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwcm9jZXNzSXRlbS5pZCA9PSBwcm9jZXNzSWQgJiYgcHJvY2Vzc0l0ZW0uc2VxID09IHByb2Nlc3NTZXEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3ViUHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihzdWJQcm9jZXNzSXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzSXRlbS5pZCA9PSBzdWJQcm9jZXNzSWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NPYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzT2JqLl9pZCA9PSBzcHV1aWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09ICdzdGVwJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NPYmouc3RlcCA9IHJlc3VsdC5kYXRhLnN0ZXA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKHJlc3VsdC5tZXNzYWdlLCBzdWJQcm9jZXNzT2JqKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PSAnc3RlcENvbXBsZXRlJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NPYmouc3RlcCA9IHJlc3VsdC5kYXRhLnN0ZXA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NPYmouY29tcGxldGUgPSB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKHJlc3VsdC5tZXNzYWdlLCBzdWJQcm9jZXNzT2JqLnN0ZXApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgaWYgKHN0ZXBPYmplY3QuZnVuY3Rpb24udGFzayAhPSB1bmRlZmluZWQgJiYgc3RlcE9iamVjdC5mdW5jdGlvbi50YXNrLnBvc3RBY3Rpb25zICE9IHVuZGVmaW5lZCkge1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgcG9zdEFjdGlvbnMgPSBzdGVwT2JqZWN0LmZ1bmN0aW9uLnRhc2sucG9zdEFjdGlvbnM7XG4gICAgICAgICAgICAgICAgUHJvY2Vzcy5wb3N0QWN0aW9ucyhwb3N0QWN0aW9ucywgX3RoaXMsIHNwdXVpZCkudGhlbihmdW5jdGlvbihzdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgUHJvY2Vzcy50cmFuc2l0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHRyYW5zaXRpb25JZCwgZGF0YSwgX3RoaXMsIHNwdXVpZCwgbW9kZWwpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuZGF0YS5zdWJQcm9jZXNzQ29tcGxldGUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZSgnc3RlcENvbXBsZXRlJywgcmVzdWx0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUoJ3N0ZXAnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcblxuICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG5cblxuICAgICAgICAgICAgICAgIFByb2Nlc3MudHJhbnNpdGlvbihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCB0cmFuc2l0aW9uSWQsIGRhdGEsIF90aGlzLCBzcHV1aWQsIG1vZGVsKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuZGF0YS5zdWJQcm9jZXNzQ29tcGxldGUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlKCdzdGVwQ29tcGxldGUnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGUoJ3N0ZXAnLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuXG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IGFzc2lnbiB1c2VyLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBwcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gcHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBwcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN1YlByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN1Yi1wcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gc3ViUHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBzdWItcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGVwSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdGVwIGlkXG4gKiBAcGFyYW0ge29iamVjdH0gdXNlciAtIHRoZSB1c2VyIGlkIGFuZCBuYW1lIGRhdGFcbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5Xb3JrZmxvdy5wcm90b3R5cGUuYXNzaWduVXNlciA9IGZ1bmN0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCB1c2VyLCB1dWlkKSB7XG4gICAgLy8gUmUtYXNzaWduIHRoZSBXb3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZSBhcyBfdGhpc1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgUHJvY2Vzcy5hc3NpZ25Vc2VyKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCB1c2VyLCB1dWlkLCBfdGhpcykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pXG59O1xuXG4vKipcbiAqIFdvcmtmbG93IHRhc2ssIHRoaXMgbWV0aG9kIGV4ZWN1dGVzIGEgc3BlY2lmaWMgdGFzay5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIHByb2Nlc3MgaWQgdG8gcHJvY2Vzc1xuICogQHBhcmFtIHtvYmplY3R9IGlucHV0RGF0YSAtIHRoZSBpbnB1dCBkYXRhIHRvIHByb2Nlc3NcbiAqXG4gKiBAZXhhbXBsZVxuICogV29ya2Zsb3cuaW5pdGlhbGl6ZSgncHJvY2Vzc0lkJywgeyB2YWxpZERhdGU6ICdkYXRlJyB9KTtcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cbldvcmtmbG93LnByb3RvdHlwZS51aSA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIFJlLWFzc2lnbiB0aGUgV29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2UgYXMgX3RoaXNcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgIHJldHVybiB7XG4gICAgICAgIGdldFByb2Nlc3M6IGZ1bmN0aW9uKHByb2Nlc3NJZCwgbGFuZykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJbnRlcmZhY2UuZ2V0UHJvY2Vzcyhwcm9jZXNzSWQsIGxhbmcsIF90aGlzKS50aGVuKGZ1bmN0aW9uKG1vZGVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICB9XG5cbn07XG5cbi8qKlxuICogV29ya2Zsb3cgdGFzaywgdGhpcyBtZXRob2QgZXhlY3V0ZXMgYSBzcGVjaWZpYyB0YXNrLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gdGhlIHByb2Nlc3MgaWQgdG8gcHJvY2Vzc1xuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGlucHV0IGRhdGEgdG8gcHJvY2Vzc1xuICogKiBAcGFyYW0ge3N0cmluZ30gdXVpZCAtIHRoZSBpbnB1dCBkYXRhIHRvIHByb2Nlc3NcbiAqXG4gKiBAZXhhbXBsZVxuICogV29ya2Zsb3cuZ2V0Tm9kZVZhbHVlKGRhdGEsIF9XRkluc3RhbmNlLCB1dWlkKTtcbiAqXG4gKiBAcmV0dXJuIFwiXCJcbiAqXG4gKi9cblxuV29ya2Zsb3cucHJvdG90eXBlLmdldE5vZGVWYWx1ZSA9IGZ1bmN0aW9uKGRhdGEsIHV1aWQpIHtcbiAgICAvLyBSZS1hc3NpZ24gdGhlIFdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlIGFzIF90aGlzXG4gICAgdmFyIF90aGlzID0gdGhpcztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGRhdGEsIF90aGlzLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICAgICAgIHJlc29sdmUocmVzKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pXG59O1xuXG4vKipcbiAqIFdvcmtmbG93IHRhc2ssIHRoaXMgbWV0aG9kIGV4ZWN1dGVzIGEgc3BlY2lmaWMgdGFzay5cbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gZGF0YSAtIHRoZSBwcm9jZXNzIGlkIHRvIHByb2Nlc3NcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBpbnB1dCBkYXRhIHRvIHByb2Nlc3NcbiAqXG4gKiBAZXhhbXBsZVxuICogV29ya2Zsb3cudGFrZUFzc2lnbm1lbnQoc3B1dWlkLCBfV0ZJbnN0YW5jZSk7XG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5cbldvcmtmbG93LnByb3RvdHlwZS50YWtlQXNzaWdubWVudCA9IGZ1bmN0aW9uKHNwdXVpZCkge1xuICAgIC8vIFJlLWFzc2lnbiB0aGUgV29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2UgYXMgX3RoaXNcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgIC8vQXNzaWdubWVudCBhcmUgZXhlY3V0aW5nIGhlcmVcblxuICAgICAgICAgICAgdmFyIHNwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ11cIiwgX3RoaXMsIHt9KVswXTtcbiAgICAgICAgICAgIHZhciBhc3NpZ25lZSA9IEpTT04ueHBhdGgoXCIvc3RlcC9hc3NpZ25lZFRvXCIsIHNwT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAvL1B1c2hpbmcgb2xkZXIgcmVjb3JkIGluIHJlQXNzaWduIGFycmF5XG5cbiAgICAgICAgICAgIGlmIChzcE9iamVjdC5zdGVwLmFzc2lnbm1lbnRIaXN0b3J5ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHNwT2JqZWN0LnN0ZXAuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhc3NpZ25lZS51c2VySWQgIT0gXCJcIiAmJiBhc3NpZ25lZS5uYW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICBzcE9iamVjdC5zdGVwLmFzc2lnbm1lbnRIaXN0b3J5LnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhc3NpZ25lZSkpKTtcbiAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgIGFzc2lnbmVlLm5hbWUgPSBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmZpcnN0TmFtZSArIFwiIFwiICsgTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5sYXN0TmFtZTtcbiAgICAgICAgICAgIGFzc2lnbmVlLnVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcbiAgICAgICAgICAgIGFzc2lnbmVlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICBhc3NpZ25lZS50eXBlID0gQVNTSUdOTUVOVF9UWVBFX0FDQ0VQVEFOQ0U7XG4gICAgICAgICAgICBhc3NpZ25lZS5kdWVEYXRlVGltZSA9ICcnO1xuICAgICAgICAgICAgYXNzaWduZWUuYnkgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG5cblxuICAgICAgICAgICAgLy9mZXRjaCBwcmVXb3JrQWN0aW9ucyBoZXJlIFxuXG4gICAgICAgICAgICB2YXIgcHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXNbc3ViUHJvY2Vzc2VzL3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfdGhpcywge30pWzBdO1xuICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1t1dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX3RoaXMsIHt9KVswXTtcbiAgICAgICAgICAgIHZhciBzdGVwSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9zdGVwL2lkXCIsIF90aGlzLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcElkICsgXCInXVwiLCBfdGhpcy5jb25maWcsIHt9KVswXTtcblxuICAgICAgICAgICAgaWYgKHN0ZXBPYmplY3QuZnVuY3Rpb24udGFzay5wcmVXb3JrQWN0aW9ucyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgIHZhciBwcmVXb3JrQWN0aW9ucyA9IHN0ZXBPYmplY3QuZnVuY3Rpb24udGFzay5wcmVXb3JrQWN0aW9ucztcbiAgICAgICAgICAgICAgICBQcm9jZXNzLnByZVdvcmtBY3Rpb25zKHByZVdvcmtBY3Rpb25zLCBfdGhpcykudGhlbihmdW5jdGlvbihzdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShfdGhpcyk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcblxuICAgICAgICAgICAgcmVqZWN0KGVycik7XG5cbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG5cbi8qKlxuICogV29ya2Zsb3cgdGFzaywgdGhpcyBtZXRob2QgZXhlY3V0ZXMgYSBzcGVjaWZpYyB0YXNrLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gdGhlIHByb2Nlc3MgaWQgdG8gcHJvY2Vzc1xuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGlucHV0IGRhdGEgdG8gcHJvY2Vzc1xuICpcbiAqIEBleGFtcGxlXG4gKiBXb3JrZmxvdy5jb25kaXRpb24oY29uZGl0aW9uLCBzcHV1aWQpO1xuICpcbiAqIEByZXR1cm4gXCJcIlxuICpcbiAqL1xuXG5Xb3JrZmxvdy5wcm90b3R5cGUuY29uZGl0aW9uID0gZnVuY3Rpb24oY29uZGl0aW9uLCBzcHV1aWQpIHtcblxuICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgIHZhciBvcGVyYXRvciA9IGNvbmRpdGlvbi5vcGVyYXRvcjtcbiAgICAgICAgICAgIHZhciBkYXRhQmxvY2sgPSBjb25kaXRpb24udmFsdWUuZGF0YTtcblxuICAgICAgICAgICAgaWYgKGNvbmRpdGlvbi5zdWJqZWN0LmluZGljYXRvciAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzZXRJZCA9IGNvbmRpdGlvbi5zdWJqZWN0LmluZGljYXRvci5zZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWxTY29wZSA9IGNvbmRpdGlvbi5zdWJqZWN0LmluZGljYXRvci5tb2RlbFNjb3BlO1xuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50UGF0aCA9IGNvbmRpdGlvbi5zdWJqZWN0LmluZGljYXRvci5lbGVtZW50UGF0aDtcbiAgICAgICAgICAgICAgICBpZiAoY29uZGl0aW9uLnN1YmplY3QuaW5kaWNhdG9yLmNvbnRleHQgPT0gJ3N1YlByb2Nlc3MnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfdGhpcywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yTW9kZWwgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF90aGlzLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhRWxlbWVudCA9IGluZGljYXRvck1vZGVsLm1vZGVsW21vZGVsU2NvcGVdLmRhdGFbc2V0SWRdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBldmFsKFwiZGF0YUVsZW1lbnQuXCIgKyBlbGVtZW50UGF0aCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShkYXRhQmxvY2ssIF90aGlzLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gaGVscGVyLmNvbXBhcmUodmFsdWUsIG9wZXJhdG9yLCByZXMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCgnTm90IGltcGxlbWVudGVkJylcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgfSBlbHNlIGlmIChjb25kaXRpb24uc3ViamVjdC5pbmRpY2F0b3JXcmFwcGVyICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJlamVjdCgnTm90IGltcGxlbWVudGVkJylcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZGl0aW9uLnN1YmplY3QudmFyaWFibGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KCdOb3QgaW1wbGVtZW50ZWQnKVxuICAgICAgICAgICAgfSBlbHNlIGlmIChjb25kaXRpb24uc3ViamVjdC5zdWJQcm9jZXNzICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRQYXRoID0gY29uZGl0aW9uLnN1YmplY3Quc3ViUHJvY2Vzcy5lbGVtZW50UGF0aDtcbiAgICAgICAgICAgICAgICB2YXIgc3BPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXVwiLCBfdGhpcywge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGV2YWwoXCJzcE9iamVjdC5cIiArIGVsZW1lbnRQYXRoKTtcbiAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGRhdGFCbG9jaywgX3RoaXMsIHNwdXVpZCkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGhlbHBlci5jb21wYXJlKHZhbHVlLCBvcGVyYXRvciwgcmVzKTtcblxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcblxuICAgICAgICAgICAgcmVqZWN0KGVycik7XG5cbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFdvcmtmbG93OyIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWwgPSByZXF1aXJlKCd1dGlsaXR5Jyk7XG52YXIgbm9kZVZhbHVlID0gcmVxdWlyZSgnLi9ub2RlVmFsdWUnKTtcbnZhciBmb3JtID0gcmVxdWlyZSgnLi9mb3JtJyk7XG52YXIgaGVscGVyID0gcmVxdWlyZSgnLi9oZWxwZXInKTtcblxudmFyIGdhdGVrZWVwZXIgPSBuZXcgR0soKTtcblxuLyoqXG4gKiBBY3Rpb25zIE1vZHVsZVxuICpcbiAqIEBtb2R1bGUgbGliL2FjdGlvbnNcbiAqIEBhdXRob3IgSGFzYW4gQWJiYXNcbiAqIEB2ZXJzaW9uIDIuMC4wXG4gKiBAZGVzY3JpcHRpb24gdGVzdCBkZXNjcmlwdGlvblxuICogQGNvcHlyaWdodCBLd2FudHUgTHRkIFJTQSAyMDA5LTIwMTUuXG4gKlxuICovXG5cbi8qKlxuICogIEZvcm0gTW9kdWxlIGFjdGlvbnMgbmVlZHMgdG8gYmUgbW92ZWQgaGVyZS5cbiAqICBUaGlzIGFjdGlvbnMgbW9kdWxlIHdpbGwgYmUgY2VudGFsIHBsYWNlIHRvIGhvbGQgYWxsIGZ1bmN0aW9ucy5cbiAqICBcbiAqL1xuXG52YXIgY29tbXVuaXR5ID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICBjcmVhdGVDb21tdW5pdHk6IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImRhdGFSZWdpc3RyeVwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciB1dWlkQ29tbXVuaXR5ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ0NvbW11bml0eSddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlQ29tbXVuaXR5XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibmV3Q29tbXVuaXR5SWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaW5kaWNhdG9yVVVJRFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJDb21tdW5pdHlcIjogdXVpZENvbW11bml0eVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICB1c2VySm9pbkNvbW11bml0eTogZnVuY3Rpb24oX2RlZiwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuICAgICAgICByZWxlYXNlQWRvcHRlZEFwcGxpY2F0aW9uOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJkYXRhUmVnaXN0cnlcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG4gICAgICAgICAgICAgICAgdmFyIHV1aWRSZWxlYXNlQWRvcHRlZEFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ2Fkb3B0ZWRBcHBsaWNhdGlvbiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcInJlbGVhc2VBZG9wdGVkQXBwbGljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpbmRpY2F0b3JVVUlEXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFkb3B0ZWRBcHBsaWNhdGlvblwiOiB1dWlkUmVsZWFzZUFkb3B0ZWRBcHBsaWNhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtlciBwcm9jZXNzZXMgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuXG52YXIgYXBwbGljYXRpb24gPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAgIGNyZWF0ZUFwcERlZmluaXRpb246IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImRhdGFSZWdpc3RyeVwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgdXVpZEFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ0FwcGxpY2F0aW9uJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVBcHBsaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5ld0FwcGxpY2F0aW9uSWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaW5kaWNhdG9yVVVJRFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJBcHBsaWNhdGlvblwiOiB1dWlkQXBwbGljYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBidWlsZEFwcGxpY2F0aW9uOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJkYXRhUmVnaXN0cnlcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG4gICAgICAgICAgICAgICAgdmFyIHV1aWRQdWJsaXNoQXBwbGljYXRpb24gPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnUHVibGlzaEFwcGxpY2F0aW9uJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIHZhciB1dWlkQXBwbGljYXRpb25EZWZpbml0aW9uID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ0FwcGxpY2F0aW9uRGVmaW5pdGlvbiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciB1dWlkUm9sZXMgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnUm9sZXMnXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgdXVpZEFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ0FwcGxpY2F0aW9uJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHV1aWRBcHBQZXJtaXNzaW9ucyA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdBcHBQZXJtaXNzaW9ucyddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJidWlsZEFwcGxpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJpbmRpY2F0b3JVVUlEXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlB1Ymxpc2hBcHBsaWNhdGlvblwiOiB1dWlkUHVibGlzaEFwcGxpY2F0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiQXBwbGljYXRpb25EZWZpbml0aW9uXCI6IHV1aWRBcHBsaWNhdGlvbkRlZmluaXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJSb2xlc1wiOiB1dWlkUm9sZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJBcHBsaWNhdGlvblwiOiB1dWlkQXBwbGljYXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJBcHBQZXJtaXNzaW9uc1wiOiB1dWlkQXBwUGVybWlzc2lvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBhcHBsaWNhdGlvbkFkb3B0aW9uOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImRhdGFSZWdpc3RyeVwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgdXVpZEFkb3B0aW9uID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ0Fkb3B0aW9uJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIHZhciB1dWlkUHVibGlzaEFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1B1Ymxpc2hBcHBsaWNhdGlvbiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciB1dWlkQXBwbGljYXRpb24gPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnQXBwbGljYXRpb24nXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiYWRvcHRBcHBsaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaW5kaWNhdG9yVVVJRFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJBZG9wdGlvblwiOiB1dWlkQWRvcHRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJQdWJsaXNoQXBwbGljYXRpb25cIjogdXVpZFB1Ymxpc2hBcHBsaWNhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIkFwcGxpY2F0aW9uXCI6IHV1aWRBcHBsaWNhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtlciBwcm9jZXNzZXMgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZVRheG9ub215OiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJkYXRhUmVnaXN0cnlcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG4gICAgICAgICAgICAgICAgdmFyIHRheG9ub215VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdUYXhvbm9teSddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZVRheG9ub215XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidGF4b25vbXlVVUlEXCI6IHRheG9ub215VVVJRFxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuXG5cblxudmFyIHBlcmZvcm1hbmNlID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuXG4gICAgICAgIHVubG9ja1BlcmlvZDogZnVuY3Rpb24oX2RlZiwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIC8vIG1lc3NhZ2UgZnJvbSBzdGVwIDogVE9ETyBcblxuICAgICAgICAgICAgICAgIHZhciBlbnRyeVVVSUQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgUEVSSU9EX1NFVF9JRCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgc3VicHJvY2Vzc09iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBlbmRkYXRlID0gc3VicHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcblxuICAgICAgICAgICAgICAgIGxpYnJhcnkudW5sb2NrUGVyaW9kKGVudHJ5VVVJRCwgZW5kZGF0ZSwgdXVpZCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1VubG9jayBwZXJpb2QuJywgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cblxuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuXG5cblxuXG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldE1vZGVsU3RhdHVzOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIGVudHJ5VVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBQRVJJT0RfU0VUX0lEICsgXCInXS9pbnN0YW5jZXMvdXVpZFwiLCBzdWJwcm9jZXNzT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIGVuZGRhdGUgPSBzdWJwcm9jZXNzT2JqZWN0LmRhdGVzLnZhbGlkO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN0YXR1c2kxOG5MYWJlbCA9IEpTT04ueHBhdGgoXCIvbGFiZWxcIiwgX2RlZiwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSBoZWxwZXIuZ2V0TGFuZ3VhZ2VNZXNzYWdlKHN0YXR1c2kxOG5MYWJlbCk7XG5cblxuICAgICAgICAgICAgICAgIGxpYnJhcnkuc2V0UGVyaW9kU3RhdHVzKGVudHJ5VVVJRCwgZW5kZGF0ZSwgc3RhdHVzLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2Vzcygnc2V0TW9kZWxTdGF0dXMnLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuXG5cblxuXG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG5cbiAgICAgICAgbG9ja1BlcmZvcm1hbmNlTW9kZWw6IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB2YXIgZW50cnlVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2lkIGVxICdcIiArIFBFUkZPUk1BTkNFX1NFVF9JRCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgc3VicHJvY2Vzc09iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBlbmRkYXRlID0gc3VicHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcblxuICAgICAgICAgICAgICAgIGxpYnJhcnkubG9ja1BlcmZvcm1hbmNlTW9kZWwoZW50cnlVVUlELCBlbmRkYXRlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnTG9jayBwZXJmb3JtYW5jZSBtb2RlbC4nLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuXG5cblxuXG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9XG5cbn0pKCk7XG5cbnZhciBzZG8gPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAgIGNyZWF0ZTogZnVuY3Rpb24oX2RlZiwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiZGF0YVJlZ2lzdHJ5XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuICAgICAgICAgICAgICAgIHZhciBzZG9VVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1NETyddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZVNET1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1VVSURcIjogc2RvVVVJRFxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuXG52YXIgdGF4b25vbXkgPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG4gICAgICAgIGNyZWF0ZTogZnVuY3Rpb24oX2RlZiwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiZGF0YVJlZ2lzdHJ5XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuICAgICAgICAgICAgICAgIHZhciB0YXhvbm9teVVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnVGF4b25vbXknXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVUYXhvbm9teVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInRheG9ub215VVVJRFwiOiB0YXhvbm9teVVVSURcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgIH1cblxufSkoKTtcblxudmFyIHN1YlByb2Nlc3NJbnN0YW5jZSA9IChmdW5jdGlvbigpIHtcblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgc2V0VGl0bGU6IGZ1bmN0aW9uKF9kZWYsIHV1aWQsIGRhdGFWYWx1ZSwgX1dGSW5zdGFuY2UpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHNwUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBhcHAuU0NPUEUud29ya2Zsb3csIHt9KVswXTtcbiAgICAgICAgICAgICAgICBzcFByb2Nlc3NPYmplY3QubGFiZWwgPSBkYXRhVmFsdWU7XG5cbiAgICAgICAgICAgICAgICB2YXIgaXRlbXNUb1Byb2Nlc3MgPSAxO1xuICAgICAgICAgICAgICAgIHZhciBzdHVmZiA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBvYmogPSB7fTtcblxuICAgICAgICAgICAgICAgIG9iai5tb2RlbCA9IF9XRkluc3RhbmNlLnN1YnByb2Nlc3NlcztcbiAgICAgICAgICAgICAgICBzdHVmZi5wdXNoKG9iaik7XG4gICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1N1YnByb2Nlc3Mgc2V0VGl0bGUgc3VjY2Vzcy4nLCBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHNldFZhbGlkRGF0ZTogZnVuY3Rpb24oX2RlZiwgdXVpZCwgZGF0YVZhbHVlLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3BQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgIHNwUHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZCA9IGRhdGFWYWx1ZTtcblxuICAgICAgICAgICAgICAgIHZhciBpdGVtc1RvUHJvY2VzcyA9IDE7XG4gICAgICAgICAgICAgICAgdmFyIHN0dWZmID0gW107XG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IHt9O1xuXG4gICAgICAgICAgICAgICAgb2JqLm1vZGVsID0gc3BQcm9jZXNzT2JqZWN0O1xuICAgICAgICAgICAgICAgIHN0dWZmLnB1c2gob2JqKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCd2YWxpZCBkYXRlIHNldC4nLCBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHNldFNQU3RhdHVzOiBmdW5jdGlvbihfZGVmLCB1dWlkLCBkYXRhVmFsdWUsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzcFByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgc3BQcm9jZXNzT2JqZWN0LnNwU3RhdHVzID0gZGF0YVZhbHVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIGl0ZW1zVG9Qcm9jZXNzID0gMTtcbiAgICAgICAgICAgICAgICB2YXIgc3R1ZmYgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0ge307XG5cbiAgICAgICAgICAgICAgICBvYmoubW9kZWwgPSBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXM7XG4gICAgICAgICAgICAgICAgc3R1ZmYucHVzaChvYmopO1xuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdWJwcm9jZXNzIHNwU3RhdHVzIHN1Y2Nlc3MuJywgX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgIH1cblxufSkoKTtcblxudmFyIHZhcmlhYmxlcyA9IChmdW5jdGlvbigpIHtcblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgc2V0VmFyaWFibGU6IGZ1bmN0aW9uKHNldFZhcmlhYmxlLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKHNldFZhcmlhYmxlLmRhdGEsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGFWYWx1ZSkge1xuXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHNjb3BlID0gc2V0VmFyaWFibGUuc2NvcGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YXJpYWJsZU5hbWUgPSBzZXRWYXJpYWJsZS5uYW1lO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdmFyaWFibGVUeXBlID0gc2V0VmFyaWFibGUudmFyaWFibGVUeXBlO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWxpZERhdGUgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vZGF0ZXMvdmFsaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwcm9maWxlJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9maWxlVmFyaWFibGVGaWxlTmFtZSA9IHByb2ZpbGVJZCArICc6dmFyaWFibGVzJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0KHByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lKS50aGVuKGZ1bmN0aW9uKGZpbGUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFyaWFibGVUeXBlID09ICdwZXJpb2RpYycpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogT3ZlcndyaXRlIHRoZSBleGlzdGluZyB2YXJpYWJsZSBpbiBjYXNlIHdoZXJlIHNhbWUgdmFyaWFibGUgaXMgYXNzaWduZWQgYXQgbXVsdGlwbGUgc3RlcHMuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzT2JqID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXNbc3ViUHJvY2Vzc2VzL3V1aWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSBwcm9jZXNzT2JqLnNlcTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlclwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlck5hbWVcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VybmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VyUHJvZmlsZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBzZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWxpZERhdGVcIjogdmFsaWREYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsdWVcIjogZGF0YVZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWxlW3ZhcmlhYmxlTmFtZV0gIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZhbCgnZmlsZS4nICsgdmFyaWFibGVOYW1lICsgJy5wdXNoKG9iaiknKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZVt2YXJpYWJsZU5hbWVdID0gW29ial07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVbdmFyaWFibGVOYW1lXSA9IGRhdGFWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby51cHNlcnQoZmlsZSkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFwiVmFyaWFibGUgc2V0IHN1Y2Nlc3NmdWxseVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkZhaWxlZCB0byBzZXQgVmFyaWFibGVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiX2lkXCI6IHByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZS5jaGFubmVscyA9IGFwcC5wcm9maWxlLmNoYW5uZWxzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZVR5cGUgPT0gJ3BlcmlvZGljJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NPYmogPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlc1tzdWJQcm9jZXNzZXMvdXVpZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlcSA9IHByb2Nlc3NPYmouc2VxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZVt2YXJpYWJsZU5hbWVdID0gW3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VyTmFtZVwiOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJQcm9maWxlSWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IHNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbGlkRGF0ZVwiOiB2YWxpZERhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWx1ZVwiOiBkYXRhVmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZVt2YXJpYWJsZU5hbWVdID0gZGF0YVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLnVwc2VydChmaWxlKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJWYXJpYWJsZSBzZXQgc3VjY2Vzc2Z1bGx5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiRmFpbGVkIHRvIHNldCBWYXJpYWJsZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3N1YlByb2Nlc3NJbnN0YW5jZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFwibm90IGltcGxlbWVudGVkXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzdGVwJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJub3QgaW1wbGVtZW50ZWRcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzdWJQcm9maWxlU3ViUHJvY2Vzc0luc3RhbmNlJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lID0gc3ViUHJvZmlsZUlkICsgJzp2YXJpYWJsZXMnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5nZXQoc3ViUHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUpLnRoZW4oZnVuY3Rpb24oZmlsZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YXJpYWJsZVR5cGUgPT0gJ3BlcmlvZGljJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFydCA9IGxpYnJhcnkuZ2V0U3VicHJvZmlsZVN1YnByb2Nlc3NJZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCBfaWQgPSAvc3VicHJvY2Vzc2VzW19pZCA9IFwiICsgcGFydCArIFwiXS9faWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInVzZXJOYW1lXCI6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlclByb2ZpbGVJZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogc2VxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsaWREYXRlXCI6IHZhbGlkRGF0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInZhbHVlXCI6IGRhdGFWYWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZVt2YXJpYWJsZU5hbWVdICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2YWwoJ2ZpbGUuJyArIHZhcmlhYmxlTmFtZSArICcucHVzaChvYmopJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVbdmFyaWFibGVOYW1lXSA9IFtvYmpdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlW3ZhcmlhYmxlTmFtZV0gPSBkYXRhVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8udXBzZXJ0KGZpbGUpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShcIlZhcmlhYmxlIGF0IHN1YnByb2ZpbGUgc2V0IHN1Y2Nlc3NmdWxseVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkZhaWxlZCB0byBzZXQgVmFyaWFibGUgYXQgc3VicHJvZmlsZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWxlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJfaWRcIjogc3ViUHJvZmlsZVZhcmlhYmxlRmlsZU5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlLmNoYW5uZWxzID0gYXBwLnByb2ZpbGUuY2hhbm5lbHM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhcmlhYmxlVHlwZSA9PSAncGVyaW9kaWMnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBwcm9jZXNzT2JqID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXNbc3ViUHJvY2Vzc2VzL3V1aWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFyIHNlcSA9IHByb2Nlc3NPYmouc2VxO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3ZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCBpZCA9IC9zdWJwcm9jZXNzZXNbX2lkID0gL2luc3RhbmNlL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbc3VicHJvZmlsZUlkIGVxICdcIiArIHN1YlByb2ZpbGVJZCArIFwiJ10vdXVpZF0vX2lkXSlcIiwgX1dGSW5zdGFuY2UsIHt9KVswXSArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFydCA9IGxpYnJhcnkuZ2V0U3VicHJvZmlsZVN1YnByb2Nlc3NJZHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCBfaWQgPSAvc3VicHJvY2Vzc2VzW19pZCA9IFwiICsgcGFydCArIFwiXS9faWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVbdmFyaWFibGVOYW1lXSA9IFt7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlclwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlck5hbWVcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VybmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VyUHJvZmlsZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBzZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWxpZERhdGVcIjogdmFsaWREYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidmFsdWVcIjogZGF0YVZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVbdmFyaWFibGVOYW1lXSA9IGRhdGFWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby51cHNlcnQoZmlsZSkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFwiVmFyaWFibGUgYXQgc3VicHJvZmlsZSBzZXQgc3VjY2Vzc2Z1bGx5XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiRmFpbGVkIHRvIHNldCBWYXJpYWJsZSBhdCBzdWJwcm9maWxlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJnZXROb2RlVmFsdWUgdmFsdWUgbm90IGZvdW5kLlwiKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuXG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgIH1cblxufSkoKTtcblxudmFyIG5vdGlmaWNhdGlvbiA9IChmdW5jdGlvbigpIHtcblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgc2VuZE5vdGlmaWNhdGlvbldvcmtlcjogZnVuY3Rpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblxuICAgICAgICAgICAgICAgIHZhciBnZXRSZWNpcGllbnRzID0gZnVuY3Rpb24obm90aWZpY2F0aW9uKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlY2lwaWVudHMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24ucmVjaXBpZW50cy5yb2xlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5yb2xlID0gbm90aWZpY2F0aW9uLnJlY2lwaWVudHMucm9sZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2lwaWVudHMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnByb2ZpbGVSb2xlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5wcm9maWxlUm9sZSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMucHJvZmlsZVJvbGUucm9sZSA9IG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnByb2ZpbGVSb2xlLnJvbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5wcm9maWxlUm9sZS5wcm9maWxlID0gbm90aWZpY2F0aW9uLnJlY2lwaWVudHMucHJvZmlsZVJvbGUucHJvZmlsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2lwaWVudHMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnN1YlByb2ZpbGVSb2xlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5zdWJQcm9maWxlUm9sZSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuc3ViUHJvZmlsZVJvbGUucm9sZSA9IG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnN1YlByb2ZpbGVSb2xlLnJvbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5zdWJQcm9maWxlUm9sZS5zdWJQcm9maWxlQ2F0ZWdvcnkgPSBub3RpZmljYXRpb24ucmVjaXBpZW50cy5zdWJQcm9maWxlUm9sZS5zdWJQcm9maWxlQ2F0ZWdvcnk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5zdWJQcm9maWxlUm9sZS5wcm9maWxlID0gbm90aWZpY2F0aW9uLnJlY2lwaWVudHMuc3ViUHJvZmlsZVJvbGUucHJvZmlsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2lwaWVudHMpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLmZ1bmN0aW9uICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuZnVuY3Rpb24udXNlcnMgPSB7fTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUobm90aWZpY2F0aW9uLnJlY2lwaWVudHMuZnVuY3Rpb24udXNlcnMsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGFWYWx1ZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuZnVuY3Rpb24udXNlcnMgPSBkYXRhVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVjaXBpZW50cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnN0ZXBBc3NpZ25lZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY2lwaWVudHMuc3RlcEFzc2lnbmVlID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5zdGVwQXNzaWduZWUucm9sZSA9IG5vdGlmaWNhdGlvbi5yZWNpcGllbnRzLnN0ZXBBc3NpZ25lZS5yb2xlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVjaXBpZW50cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gbmV3IE5vdGlmaWNhdGlvV29ya2VyKGFwcCk7XG5cblxuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9maWxlSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vbWV0YS1kYXRhL3N1YnByb2ZpbGVJZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIHBhdGhBcnJheSA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdCgnLycpO1xuICAgICAgICAgICAgICAgIHZhciBiYXNlVVJMID0gd2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3QgKyBcIi9cIiArIHBhdGhBcnJheVsxXTtcblxuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZVwiOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VUeXBlXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1ldGEtZGF0YVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IF9XRkluc3RhbmNlLmFwcCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IF9XRkluc3RhbmNlLmNvbW11bml0eUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvZmlsZUlkXCI6IHN1YlByb2ZpbGVJZFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uVHlwZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJwcm9maWxlSWRcIjogc3VicHJvZmlsZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcmlvcml0eVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWNpcGllbnRzXCI6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidXJsXCI6IGJhc2VVUkwsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImtleXNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3VycmVudFVzZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgS2V5cyBtZXNzYWdlIFxuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMucHJvZmlsZS5uYW1lID0gYXBwLnByb2ZpbGUudGl0bGU7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnByb2ZpbGUuaWQgPSBhcHAucHJvZmlsZS5faWQ7XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY29tbXVuaXR5Lm5hbWUgPSBhcHAuZ2V0TmFtZUJ5TGFuZyhMT0NBTF9TRVRUSU5HUy5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eU5hbWUpO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jb21tdW5pdHkuaWQgPSBMT0NBTF9TRVRUSU5HUy5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eUlkO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9hcHBsaWNhdGlvbnNbYXBwSWQgZXEgJ1wiICsgYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQgKyBcIiddXCIsIExPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9DT05GSUcsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5hcHBsaWNhdGlvbi5uYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoYXBwbGljYXRpb24ubmFtZSk7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmFwcGxpY2F0aW9uLmlkID0gYXBwbGljYXRpb24uYXBwSWQ7XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY3VycmVudFVzZXIubmFtZSA9IExPQ0FMX1NFVFRJTkdTLlNFU1NJT04uZmlyc3ROYW1lICsgXCIgXCIgKyBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmxhc3ROYW1lO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jdXJyZW50VXNlci5pZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuXG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy5uYW1lID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2xhYmVsXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MuaWQgPSB1dWlkO1xuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbWVzc2FnZSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5kZWZhdWx0ID0gbm90aWZpY2F0aW9uLm1lc3NhZ2UuZGVmYXVsdDtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UudGl0bGUgPSBub3RpZmljYXRpb24ubWVzc2FnZS50aXRsZTtcblxuICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24ubWVzc2FnZS5ydGYgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5ydGYgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5tZXNzYWdlLnJ0Zi50ZW1wbGF0ZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5ydGYudGVtcGxhdGUgPSBub3RpZmljYXRpb24ubWVzc2FnZS5ydGYudGVtcGxhdGU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm90aWZpY2F0aW9uLm1lc3NhZ2UucnRmLm1hcmt1cCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5ydGYubWFya3VwID0gbm90aWZpY2F0aW9uLm1lc3NhZ2UucnRmLm1hcmt1cDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBtZXNzYWdlVHlwZSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZVR5cGUgPSBub3RpZmljYXRpb24ubWVzc2FnZVR5cGU7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbm90aWZpY2F0aW9uVHlwZSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uVHlwZSA9IG5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25UeXBlO1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIHByaW9yaXR5IFxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5wcmlvcml0eSA9IG5vdGlmaWNhdGlvbi5wcmlvcml0eTtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBub3RpZmljYXRpb25BY3Rpb24gaWYgZXhpc3RzIFxuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbiAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5sYWJlbCA9IG5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24ubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkkgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLlVSSSA9IG5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLlVSSTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG8gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG8gPSBub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLnNjaGVkdWxlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBleGVjdXRlT2JqZWN0ID0gbm90aWZpY2F0aW9uLnNjaGVkdWxlLmV4ZWN1dGVDb21tYW5kO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB3b3JrZXJTY2hlZHVsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVUaW1lOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdW5pdDogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcjogXCJcIlxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4ZWN1dGVPYmplY3Qubm93ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LmV4YWN0ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGV4ZWN1dGVPYmplY3QuZXhhY3QuZGF0ZVRpbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LmR1ZURhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy5kdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkdWVEYXRlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoZHVlRGF0ZSwgXCJZWVlZLU1NLUREXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LmR1ZURhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUudW5pdCA9IGV4ZWN1dGVPYmplY3QuZHVlRGF0ZS51bml0O1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC52YWxpZERhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdWVEYXRlID0gc3ViUHJvY2Vzc09iamVjdC5kYXRlcy52YWxpZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbGlkRGF0ZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KHZhbGlkRGF0ZSwgXCJZWVlZLU1NLUREXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC52YWxpZERhdGUudW5pdDtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0ZWREYXRlVGltZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcENyZWF0ZWREYXRlVGltZSA9IHN1YlByb2Nlc3NPYmplY3Quc3RlcC5kdWVEYXRlVGltZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0ZXBDcmVhdGVkRGF0ZVRpbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudChzdGVwQ3JlYXRlZERhdGVUaW1lKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUudW5pdCA9IGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlLnVuaXQ7XG5cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0U2NoZWR1bGUod29ya2VyU2NoZWR1bGUpO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgcmVjaXBpZW50c1xuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICBnZXRSZWNpcGllbnRzKG5vdGlmaWNhdGlvbikudGhlbihmdW5jdGlvbihyZWNpcGllbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5yZWNpcGllbnRzID0gcmVjaXBpZW50O1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0TWVzc2FnZShcIldvcmtlciBzdWJtaXR0ZWQgZm9yIGV4ZWN1dGlvblwiKTtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldEFjdGlvbihhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0Q29udGV4dCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGVwOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcERhdGVUaW1lOiBzdWJQcm9jZXNzT2JqZWN0LnN0ZXAuZGF0ZVRpbWVDcmVhdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZCgpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cod29ya2VyT2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdOb3RpZmljYXRpb24gV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vdGlmaWNhdGlvbiAtIGdldFJlY2lwaWVudHMgZmFpbGVkIHdpdGggZXJyb3IgXCIgKyBlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcblxuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cblxuICAgICAgICByZUFzc2lnbm1lbnROb3RpZmljYXRpb246IGZ1bmN0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHV1aWQsIHVzZXIpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgZ2V0UmVjaXBpZW50cyA9IGZ1bmN0aW9uKHVzZXJPYmopIHtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjaXBpZW50cyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IHVzZXJPYmouaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2lwaWVudHMpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSBuZXcgTm90aWZpY2F0aW9Xb3JrZXIoYXBwKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9maWxlSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vbWV0YS1kYXRhL3N1YnByb2ZpbGVJZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciBwYXRoQXJyYXkgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKTtcbiAgICAgICAgICAgICAgICB2YXIgYmFzZVVSTCA9IHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCArIFwiLy9cIiArIHdpbmRvdy5sb2NhdGlvbi5ob3N0ICsgXCIvXCIgKyBwYXRoQXJyYXlbMV07XG5cblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJydGZcIjoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZVR5cGVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWV0YS1kYXRhXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogX1dGSW5zdGFuY2UuYXBwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogX1dGSW5zdGFuY2UuY29tbXVuaXR5SWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9maWxlSWRcIjogc3ViUHJvZmlsZUlkXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25UeXBlXCI6IFwid29ya2Zsb3dcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJpb3JpdHlcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVjaXBpZW50c1wiOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInVybFwiOiBiYXNlVVJMLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJrZXlzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImN1cnJlbnRVc2VyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIEtleXMgbWVzc2FnZSBcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnByb2ZpbGUubmFtZSA9IGFwcC5wcm9maWxlLnRpdGxlO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5wcm9maWxlLmlkID0gYXBwLnByb2ZpbGUuX2lkO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmNvbW11bml0eS5uYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoTE9DQUxfU0VUVElOR1MuQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlOYW1lKTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY29tbXVuaXR5LmlkID0gTE9DQUxfU0VUVElOR1MuQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlJZDtcblxuICAgICAgICAgICAgICAgIHZhciBhcHBsaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvYXBwbGljYXRpb25zW2FwcElkIGVxICdcIiArIGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkICsgXCInXVwiLCBMT0NBTF9TRVRUSU5HUy5DT01NVU5JVFlfQ09ORklHLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuYXBwbGljYXRpb24ubmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKGFwcGxpY2F0aW9uLm5hbWUpO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5hcHBsaWNhdGlvbi5pZCA9IGFwcGxpY2F0aW9uLmFwcElkO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmN1cnJlbnRVc2VyLm5hbWUgPSBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmZpcnN0TmFtZSArIFwiIFwiICsgTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5sYXN0TmFtZTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY3VycmVudFVzZXIuaWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcblxuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MubmFtZSA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9sYWJlbFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLmlkID0gdXVpZDtcblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIG1lc3NhZ2UgXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UuZGVmYXVsdCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLnRpdGxlID0gbm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC50aXRsZTtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5ydGYubWFya3VwID0gbm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC5tZXNzYWdlO1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIG1lc3NhZ2VUeXBlIFxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlVHlwZSA9IG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQubWVzc2FnZVR5cGU7XG5cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIHByaW9yaXR5IFxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5wcmlvcml0eSA9IG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQucHJpb3JpdHk7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbm90aWZpY2F0aW9uQWN0aW9uIGlmIGV4aXN0cyBcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQubm90aWZpY2F0aW9uQWN0aW9uICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmxhYmVsID0gbm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24ubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24ucmVBc3NpZ25tZW50Lm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkkgPSBub3RpZmljYXRpb24ucmVBc3NpZ25tZW50Lm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG8gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLmdvdG8gPSBub3RpZmljYXRpb24ucmVBc3NpZ25tZW50Lm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uZ290bztcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLnJlQXNzaWdubWVudC5zY2hlZHVsZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZXhlY3V0ZU9iamVjdCA9IG5vdGlmaWNhdGlvbi5yZUFzc2lnbm1lbnQuc2NoZWR1bGUuZXhlY3V0ZUNvbW1hbmQ7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHdvcmtlclNjaGVkdWxlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVRpbWU6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1bml0OiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoZXhlY3V0ZU9iamVjdC5ub3cgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG5cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3QuZXhhY3QgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gZXhlY3V0ZU9iamVjdC5leGFjdC5kYXRlVGltZTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3QuZHVlRGF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR1ZURhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLmR1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGR1ZURhdGUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudChkdWVEYXRlLCBcIllZWVktTU0tRERcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3QuZHVlRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC5kdWVEYXRlLnVuaXQ7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR1ZURhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLnZhbGlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWREYXRlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQodmFsaWREYXRlLCBcIllZWVktTU0tRERcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3QudmFsaWREYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZS51bml0O1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwQ3JlYXRlZERhdGVUaW1lID0gc3ViUHJvY2Vzc09iamVjdC5zdGVwLmR1ZURhdGVUaW1lO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RlcENyZWF0ZWREYXRlVGltZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KHN0ZXBDcmVhdGVkRGF0ZVRpbWUpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUudW5pdDtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRTY2hlZHVsZSh3b3JrZXJTY2hlZHVsZSk7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgcmVjaXBpZW50c1xuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICBnZXRSZWNpcGllbnRzKHVzZXIpLnRoZW4oZnVuY3Rpb24ocmVjaXBpZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucmVjaXBpZW50cyA9IHJlY2lwaWVudDtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldEFjdGlvbihhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0TWVzc2FnZShcIldvcmtlciBzdWJtaXR0ZWQgZm9yIGV4ZWN1dGlvblwiKTtcbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmQoKS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ05vdGlmaWNhdGlvbiBXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseSBmb3IgcmVhc3NpZ25tZW50LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJOb3RpZmljYXRpb24gLSBnZXRSZWNpcGllbnRzIGZhaWxlZCB3aXRoIGVycm9yIFwiICsgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG5cblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGFzc2lnbm1lbnROb3RpZmljYXRpb246IGZ1bmN0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHV1aWQsIHVzZXIpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgZ2V0UmVjaXBpZW50cyA9IGZ1bmN0aW9uKHVzZXJPYmopIHtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjaXBpZW50cyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5mdW5jdGlvbi51c2VycyA9IHVzZXJPYmouaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlY2lwaWVudHMpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gbmV3IE5vdGlmaWNhdGlvV29ya2VyKGFwcCk7XG5cblxuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9maWxlSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vbWV0YS1kYXRhL3N1YnByb2ZpbGVJZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIHBhdGhBcnJheSA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdCgnLycpO1xuICAgICAgICAgICAgICAgIHZhciBiYXNlVVJMID0gd2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3QgKyBcIi9cIiArIHBhdGhBcnJheVsxXTtcblxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJ0ZlwiOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXNzYWdlVHlwZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJtZXRhLWRhdGFcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBfV0ZJbnN0YW5jZS5hcHAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBfV0ZJbnN0YW5jZS5jb21tdW5pdHlJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2ZpbGVJZFwiOiBzdWJQcm9maWxlSWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvblR5cGVcIjogXCJ3b3JrZmxvd1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcmlvcml0eVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZWNpcGllbnRzXCI6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidXJsXCI6IGJhc2VVUkwsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImtleXNcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3VycmVudFVzZXJcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgS2V5cyBtZXNzYWdlIFxuICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMucHJvZmlsZS5uYW1lID0gYXBwLnByb2ZpbGUudGl0bGU7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnByb2ZpbGUuaWQgPSBhcHAucHJvZmlsZS5faWQ7XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY29tbXVuaXR5Lm5hbWUgPSBhcHAuZ2V0TmFtZUJ5TGFuZyhMT0NBTF9TRVRUSU5HUy5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eU5hbWUpO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jb21tdW5pdHkuaWQgPSBMT0NBTF9TRVRUSU5HUy5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eUlkO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFwcGxpY2F0aW9uID0gSlNPTi54cGF0aChcIi9hcHBsaWNhdGlvbnNbYXBwSWQgZXEgJ1wiICsgYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQgKyBcIiddXCIsIExPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9DT05GSUcsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5hcHBsaWNhdGlvbi5uYW1lID0gYXBwLmdldE5hbWVCeUxhbmcoYXBwbGljYXRpb24ubmFtZSk7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmFwcGxpY2F0aW9uLmlkID0gYXBwbGljYXRpb24uYXBwSWQ7XG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuY3VycmVudFVzZXIubmFtZSA9IExPQ0FMX1NFVFRJTkdTLlNFU1NJT04uZmlyc3ROYW1lICsgXCIgXCIgKyBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmxhc3ROYW1lO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jdXJyZW50VXNlci5pZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuXG5cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy5uYW1lID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2xhYmVsXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLnN1YlByb2Nlc3MuaWQgPSB1dWlkO1xuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbWVzc2FnZSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5kZWZhdWx0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2UudGl0bGUgPSBub3RpZmljYXRpb24uYXNzaWdubWVudC50aXRsZTtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5ydGYubWFya3VwID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQubWVzc2FnZTtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBtZXNzYWdlVHlwZSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZVR5cGUgPSBub3RpZmljYXRpb24uYXNzaWdubWVudC5tZXNzYWdlVHlwZTtcblxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgcHJpb3JpdHkgXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLnByaW9yaXR5ID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQucHJpb3JpdHk7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbm90aWZpY2F0aW9uQWN0aW9uIGlmIGV4aXN0cyBcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Lm5vdGlmaWNhdGlvbkFjdGlvbiAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5sYWJlbCA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Lm5vdGlmaWNhdGlvbkFjdGlvbi5sYWJlbDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Lm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkkgPSBub3RpZmljYXRpb24uYXNzaWdubWVudC5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uLlVSSTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Lm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uZ290byAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24uYWN0aW9uID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uZ290byA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Lm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uZ290bztcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50LnNjaGVkdWxlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBleGVjdXRlT2JqZWN0ID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQuc2NoZWR1bGUuZXhlY3V0ZUNvbW1hbmQ7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHdvcmtlclNjaGVkdWxlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVRpbWU6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICB1bml0OiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoZXhlY3V0ZU9iamVjdC5ub3cgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG5cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3QuZXhhY3QgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gZXhlY3V0ZU9iamVjdC5leGFjdC5kYXRlVGltZTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3QuZHVlRGF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR1ZURhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLmR1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGR1ZURhdGUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudChkdWVEYXRlLCBcIllZWVktTU0tRERcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3QuZHVlRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC5kdWVEYXRlLnVuaXQ7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR1ZURhdGUgPSBzdWJQcm9jZXNzT2JqZWN0LmRhdGVzLnZhbGlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWREYXRlICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQodmFsaWREYXRlLCBcIllZWVktTU0tRERcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3QudmFsaWREYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LnZhbGlkRGF0ZS51bml0O1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2FsY3VsYXRlZERhdGVUaW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwQ3JlYXRlZERhdGVUaW1lID0gc3ViUHJvY2Vzc09iamVjdC5zdGVwLmR1ZURhdGVUaW1lO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RlcENyZWF0ZWREYXRlVGltZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KHN0ZXBDcmVhdGVkRGF0ZVRpbWUpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBjYWxjdWxhdGVkRGF0ZVRpbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5mYWN0b3IgPSBleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZS5mYWN0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS51bml0ID0gZXhlY3V0ZU9iamVjdC5zdGVwQ3JlYXRlZERhdGUudW5pdDtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRTY2hlZHVsZSh3b3JrZXJTY2hlZHVsZSk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciByZWNpcGllbnRzXG4gICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgIGdldFJlY2lwaWVudHModXNlcikudGhlbihmdW5jdGlvbihyZWNpcGllbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5yZWNpcGllbnRzID0gcmVjaXBpZW50O1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0QWN0aW9uKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRNZXNzYWdlKFwiV29ya2VyIHN1Ym1pdHRlZCBmb3IgZXhlY3V0aW9uXCIpO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZCgpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cod29ya2VyT2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdOb3RpZmljYXRpb24gV29ya2VyIHByb2Nlc3NlcyBzdWNjZXNzZnVsbHkgZm9yIGFzc2lnbm1lbnQuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk5vdGlmaWNhdGlvbiAtIGdldFJlY2lwaWVudHMgZmFpbGVkIHdpdGggZXJyb3IgXCIgKyBlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcblxuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgYWNjZXB0YW5jZU5vdGlmaWNhdGlvbjogZnVuY3Rpb24obm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgdXVpZCwgcm9sZSkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblxuICAgICAgICAgICAgICAgIHZhciBnZXRSb2xlcyA9IGZ1bmN0aW9uKHJvbGUpIHtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVjaXBpZW50cyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVjaXBpZW50cy5yb2xlID0gcm9sZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVjaXBpZW50cyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSBuZXcgTm90aWZpY2F0aW9Xb3JrZXIoYXBwKTtcblxuXG4gICAgICAgICAgICAgICAgdmFyIHN1YlByb2ZpbGVJZCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9tZXRhLWRhdGEvc3VicHJvZmlsZUlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB2YXIgcGF0aEFycmF5ID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLnNwbGl0KCcvJyk7XG4gICAgICAgICAgICAgICAgdmFyIGJhc2VVUkwgPSB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgKyBcIi8vXCIgKyB3aW5kb3cubG9jYXRpb24uaG9zdCArIFwiL1wiICsgcGF0aEFycmF5WzFdO1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcIm5vdGlmaWNhdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicnRmXCI6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VUeXBlXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1ldGEtZGF0YVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IF9XRkluc3RhbmNlLmFwcCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IF9XRkluc3RhbmNlLmNvbW11bml0eUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvZmlsZUlkXCI6IHN1YlByb2ZpbGVJZFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibm90aWZpY2F0aW9uVHlwZVwiOiBcIndvcmtmbG93XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByaW9yaXR5XCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInJlY2lwaWVudHNcIjoge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ1cmxcIjogYmFzZVVSTCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwia2V5c1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjdXJyZW50VXNlclwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBLZXlzIG1lc3NhZ2UgXG4gICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5wcm9maWxlLm5hbWUgPSBhcHAucHJvZmlsZS50aXRsZTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMucHJvZmlsZS5pZCA9IGFwcC5wcm9maWxlLl9pZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jb21tdW5pdHkubmFtZSA9IGFwcC5nZXROYW1lQnlMYW5nKExPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9DT05GSUcuY29tbXVuaXR5TmFtZSk7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmNvbW11bml0eS5pZCA9IExPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9DT05GSUcuY29tbXVuaXR5SWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgYXBwbGljYXRpb24gPSBKU09OLnhwYXRoKFwiL2FwcGxpY2F0aW9uc1thcHBJZCBlcSAnXCIgKyBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCArIFwiJ11cIiwgTE9DQUxfU0VUVElOR1MuQ09NTVVOSVRZX0NPTkZJRywge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmFwcGxpY2F0aW9uLm5hbWUgPSBhcHAuZ2V0TmFtZUJ5TGFuZyhhcHBsaWNhdGlvbi5uYW1lKTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuYXBwbGljYXRpb24uaWQgPSBhcHBsaWNhdGlvbi5hcHBJZDtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5jdXJyZW50VXNlci5uYW1lID0gTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5maXJzdE5hbWUgKyBcIiBcIiArIExPQ0FMX1NFVFRJTkdTLlNFU1NJT04ubGFzdE5hbWU7XG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5rZXlzLmN1cnJlbnRVc2VyLmlkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQ7XG5cblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ua2V5cy5zdWJQcm9jZXNzLm5hbWUgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vbGFiZWxcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLmtleXMuc3ViUHJvY2Vzcy5pZCA9IHV1aWQ7XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBtZXNzYWdlIFxuICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5tZXNzYWdlLmRlZmF1bHQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS50aXRsZSA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS50aXRsZTtcblxuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubWVzc2FnZS5ydGYubWFya3VwID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbWVzc2FnZVR5cGUgXG4gICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm1lc3NhZ2VUeXBlID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm1lc3NhZ2VUeXBlO1xuXG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICAgIFdvcmtlciBwcmlvcml0eSBcbiAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ucHJpb3JpdHkgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2UucHJpb3JpdHk7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICBXb3JrZXIgbm90aWZpY2F0aW9uQWN0aW9uIGlmIGV4aXN0cyBcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5ub3RpZmljYXRpb25BY3Rpb24gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5ub3RpZmljYXRpb25BY3Rpb24ubGFiZWwgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmxhYmVsO1xuICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uVVJJICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkkgPSBub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5VUkk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3RpZmljYXRpb24uYXNzaWdubWVudEFjY2VwdGFuY2Uubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24ubm90aWZpY2F0aW9uLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5ub3RpZmljYXRpb24ubm90aWZpY2F0aW9uQWN0aW9uLmFjdGlvbi5nb3RvID0gbm90aWZpY2F0aW9uLmFzc2lnbm1lbnRBY2NlcHRhbmNlLm5vdGlmaWNhdGlvbkFjdGlvbi5hY3Rpb24uZ290bztcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5zY2hlZHVsZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgZXhlY3V0ZU9iamVjdCA9IG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZS5zY2hlZHVsZS5leGVjdXRlQ29tbWFuZDtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgd29ya2VyU2NoZWR1bGUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlVGltZTogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIHVuaXQ6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3I6IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChleGVjdXRlT2JqZWN0Lm5vdyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5leGFjdCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBleGVjdXRlT2JqZWN0LmV4YWN0LmRhdGVUaW1lO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhlY3V0ZU9iamVjdC5kdWVEYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0ZWREYXRlVGltZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMuZHVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZHVlRGF0ZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KGR1ZURhdGUsIFwiWVlZWS1NTS1ERFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC5kdWVEYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LmR1ZURhdGUudW5pdDtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4ZWN1dGVPYmplY3QudmFsaWREYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc09iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhbGN1bGF0ZWREYXRlVGltZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVlRGF0ZSA9IHN1YlByb2Nlc3NPYmplY3QuZGF0ZXMudmFsaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWxpZERhdGUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCh2YWxpZERhdGUsIFwiWVlZWS1NTS1ERFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsY3VsYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmRhdGVUaW1lID0gY2FsY3VsYXRlZERhdGVUaW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZmFjdG9yID0gZXhlY3V0ZU9iamVjdC52YWxpZERhdGUuZmFjdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUudW5pdCA9IGV4ZWN1dGVPYmplY3QudmFsaWREYXRlLnVuaXQ7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBDcmVhdGVkRGF0ZVRpbWUgPSBzdWJQcm9jZXNzT2JqZWN0LnN0ZXAuZHVlRGF0ZVRpbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGVwQ3JlYXRlZERhdGVUaW1lICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxjdWxhdGVkRGF0ZVRpbWUgPSBtb21lbnQoc3RlcENyZWF0ZWREYXRlVGltZSkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGN1bGF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB3b3JrZXJTY2hlZHVsZS5kYXRlVGltZSA9IGNhbGN1bGF0ZWREYXRlVGltZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLmZhY3RvciA9IGV4ZWN1dGVPYmplY3Quc3RlcENyZWF0ZWREYXRlLmZhY3RvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlclNjaGVkdWxlLnVuaXQgPSBleGVjdXRlT2JqZWN0LnN0ZXBDcmVhdGVkRGF0ZS51bml0O1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyU2NoZWR1bGUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNldFNjaGVkdWxlKHdvcmtlclNjaGVkdWxlKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgV29ya2VyIHJlY2lwaWVudHNcbiAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgZ2V0Um9sZXMocm9sZSkudGhlbihmdW5jdGlvbihyZWNpcGllbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uLm5vdGlmaWNhdGlvbi5yZWNpcGllbnRzID0gcmVjaXBpZW50O1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0QWN0aW9uKGFjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZXRNZXNzYWdlKFwiV29ya2VyIHN1Ym1pdHRlZCBmb3IgZXhlY3V0aW9uXCIpO1xuICAgICAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2V0Q29udGV4dCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzOiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh3b3JrZXJPYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ05vdGlmaWNhdGlvbiBXb3JrZXIgcHJvY2Vzc2VzIHN1Y2Nlc3NmdWxseSBmb3IgYXNzaWdubWVudC4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTm90aWZpY2F0aW9uIC0gZ2V0UmVjaXBpZW50cyBmYWlsZWQgd2l0aCBlcnJvciBcIiArIGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuXG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuXG5cbiAgICB9XG5cbn0pKCk7XG5cblxudmFyIHJlcG9ydCA9IChmdW5jdGlvbigpIHtcblxuICAgIHJldHVybiB7XG5cblxuXG5cbiAgICAgICAgY3JlYXRlUGVyZm9ybWFuY2VSZXBvcnQ6IGZ1bmN0aW9uKHBlcmZvcm1hbmNlUmVwb3J0T2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjcmVhdGVQZXJmb3JtYW5jZVJlcG9ydFwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgd29ya3BsYW5TZXRJZCA9IHBlcmZvcm1hbmNlUmVwb3J0T2JqZWN0LndvcmtwbGFuU2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIGNvbmZpZ1NldElkID0gcGVyZm9ybWFuY2VSZXBvcnRPYmplY3QuY29uZmlnU2V0SWQ7XG5cblxuICAgICAgICAgICAgICAgIC8vIHdvcmtwbGFuU2V0SWQgc2NvcGUgaXMgcHJvZmlsZVxuICAgICAgICAgICAgICAgIC8vIGNvbmZpZ1NldElkIHNjb3BlIGlzIHN1YnByb2Nlc3Nlc1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtwbGFuVVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIHdvcmtwbGFuU2V0SWQgKyBcIiddL19pZFwiLCBhcHAuU0NPUEUud29ya2Zsb3csIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgY29uZmlnVVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIGNvbmZpZ1NldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZVBlcmZvcm1hbmNlUmVwb3J0XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwid29ya3BsYW5VVUlEXCI6IHdvcmtwbGFuVVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29uZmlnVVVJRFwiOiBjb25maWdVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdXb3JrcGxhblJlcG9ydCBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVSZXBvcnQ6IGZ1bmN0aW9uKGNyZWF0ZVJlcG9ydCwgX1dGSW5zdGFuY2UsIHV1aWQpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiZXhlY3V0ZVJlcG9ydFwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciBwZXJmb3JtYW5jZVJlcG9ydERlZmluaXRpb25TZXRJZCA9IGNyZWF0ZVJlcG9ydC5QZXJmb3JtYW5jZVJlcG9ydERlZmluaXRpb25TZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgcmVwb3J0aW5nU0RPU2V0SWQgPSBjcmVhdGVSZXBvcnQucmVwb3J0aW5nU0RPU2V0SWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgcGVyZm9ybWFuY2VSZXBvcnREZWZpbml0aW9uID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgcGVyZm9ybWFuY2VSZXBvcnREZWZpbml0aW9uU2V0SWQgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciByZXBvcnRpbmdTRE8gPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyByZXBvcnRpbmdTRE9TZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVSZXBvcnRcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJwZXJmb3JtYW5jZVJlcG9ydERlZmluaXRpb25cIjogcGVyZm9ybWFuY2VSZXBvcnREZWZpbml0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJyZXBvcnRpbmdTRE9cIjogcmVwb3J0aW5nU0RPLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxJZFwiOiBfV0ZJbnN0YW5jZS5wcm9maWxlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdSZXByb3QgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cblxuXG5cbiAgICAgICAgc2RvUmVwb3J0OiBmdW5jdGlvbihzZG9SZXBvcnQsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcInNkb1JlcG9ydFwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciBzZXRJZCA9IHNkb1JlcG9ydC5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgc2RvUmVwb3J0VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydFVVSURcIjogc2RvUmVwb3J0VVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tbXVuaXR5SWRcIjogYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCksXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBhcHAuU0NPUEUud29ya2Zsb3cucHJvZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc1VVSURcIjogdXVpZFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygncmVwb3J0IFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGV4ZWN1dGVSZXBvcnQ6IGZ1bmN0aW9uKGV4ZWN1dGVSZXBvcnQsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImV4ZWN1dGVSZXBvcnRcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cblxuXG4gICAgICAgICAgICAgICAgdmFyIFNET3JlcG9ydFNldElkID0gZXhlY3V0ZVJlcG9ydC5TRE9yZXBvcnRTZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgcmVwb3J0aW5nU0RPU2V0aWQgPSBleGVjdXRlUmVwb3J0LnJlcG9ydGluZ1NET1NldGlkO1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgU0RPcmVwb3J0VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIFNET3JlcG9ydFNldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgIHZhciByZXBvcnRpbmdTRE9VVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgcmVwb3J0aW5nU0RPU2V0aWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICBpZiAoU0RPcmVwb3J0VVVJRCA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgU0RPcmVwb3J0VVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIFNET3JlcG9ydFNldElkICsgXCInXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiZXhlY3V0ZVJlcG9ydFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydFVVSURcIjogU0RPcmVwb3J0VVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicmVwb3J0aW5nU0RPVVVJRFwiOiByZXBvcnRpbmdTRE9VVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IGFwcC5TQ09QRS53b3JrZmxvdy5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdyZXBvcnQgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2VuZXJhdGVWaWV3OiBmdW5jdGlvbihnZW5lcmF0ZVZpZXcsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcInNkb1JlcG9ydFwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcbiAgICAgICAgICAgICAgICB2YXIgVmlld0NvbmZpZ1NldElkID0gZ2VuZXJhdGVWaWV3LlZpZXdDb25maWdTZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgVmlld0NvbmZpZ1VVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBWaWV3Q29uZmlnU2V0SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiZ2VuZXJhdGVWaWV3XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidmlld0NvbmZpZ1VVSURcIjogVmlld0NvbmZpZ1VVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogYXBwLlNDT1BFLndvcmtmbG93LnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ3JlcG9ydCBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICByZXF1ZXN0UmVwb3J0OiBmdW5jdGlvbihyZXF1ZXN0UmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJleGVjdXRlUmVwb3J0XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNkb1JlcXVlc3RSZXBvcnRTZXRJZCA9IHJlcXVlc3RSZXBvcnQuc2RvUmVxdWVzdFJlcG9ydFNldElkO1xuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRDcmVhdGlvblNldElkID0gcmVxdWVzdFJlcG9ydC5zZG9SZXBvcnRDcmVhdGlvblNldElkO1xuICAgICAgICAgICAgICAgIHZhciBwZXJmb3JtYW5jZVJlcG9ydFNldElkID0gcmVxdWVzdFJlcG9ydC5wZXJmb3JtYW5jZVJlcG9ydFNldElkO1xuICAgICAgICAgICAgICAgIHZhciBzZG9SZXF1ZXN0UmVwb3J0VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNkb1JlcXVlc3RSZXBvcnRTZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgc2RvUmVwb3J0Q3JlYXRpb25VVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgc2RvUmVwb3J0Q3JlYXRpb25TZXRJZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHBlcmZvcm1hbmNlUmVwb3J0VVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIHBlcmZvcm1hbmNlUmVwb3J0U2V0SWQgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJyZXF1ZXN0UmVwb3J0XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicGVyZm9ybWFuY2VSZXBvcnRVVUlEXCI6IHBlcmZvcm1hbmNlUmVwb3J0VVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic2RvUmVxdWVzdFJlcG9ydFVVSURcIjogc2RvUmVxdWVzdFJlcG9ydFVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydENyZWF0aW9uVVVJRFwiOiBzZG9SZXBvcnRDcmVhdGlvblVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogYXBwLlNDT1BFLndvcmtmbG93LnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1JlcXVlc3QgcmVwb3J0IFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG5cbiAgICAgICAgZ2VuZXJhdGVCYXNpY1ZpZXc6IGZ1bmN0aW9uKGdlbmVyYXRlQmFzaWNWaWV3LCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJzZG9SZXBvcnRcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2RvRGF0YU9iamVjdFZpZXdTZXRJZCA9IGdlbmVyYXRlQmFzaWNWaWV3LnNkb0RhdGFPYmplY3RWaWV3U2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIHNkb0RhdGFPYmplY3RWaWV3VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIHNkb0RhdGFPYmplY3RWaWV3U2V0SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwiZ2VuZXJhdGVCYXNpY1ZpZXdcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJzZG9EYXRhT2JqZWN0Vmlld1VVSURcIjogc2RvRGF0YU9iamVjdFZpZXdVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IGFwcC5TQ09QRS53b3JrZmxvdy5wcm9maWxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiB1dWlkXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdnZW5lcmF0ZUJhc2ljVmlldyBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBnZW5lcmF0ZVVuaW9uVmlldzogZnVuY3Rpb24oZ2VuZXJhdGVVbmlvblZpZXcsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcInNkb1JlcG9ydFwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciBzZG9EYXRhT2JqZWN0Vmlld1VuaW9uU2V0SWQgPSBnZW5lcmF0ZVVuaW9uVmlldy5zZG9EYXRhT2JqZWN0Vmlld1VuaW9uU2V0SWQ7XG4gICAgICAgICAgICAgICAgdmFyIHNkb0RhdGFPYmplY3RWaWV3VW5pb25VVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgc2RvRGF0YU9iamVjdFZpZXdVbmlvblNldElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcImdlbmVyYXRlVW5pb25WaWV3XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic2RvRGF0YU9iamVjdFZpZXdVbmlvblVVSURcIjogc2RvRGF0YU9iamVjdFZpZXdVbmlvblVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogYXBwLlNDT1BFLndvcmtmbG93LnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ2dlbmVyYXRlVW5pb25WaWV3IFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHNkb1JlcG9ydE11bHRpcGxlOiBmdW5jdGlvbihzZG9SZXBvcnRNdWx0aXBsZSwgX1dGSW5zdGFuY2UsIHV1aWQpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwic2RvUmVwb3J0XCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNkb1JlcG9ydENyZWF0aW9uU2V0SWQgPSBzZG9SZXBvcnRNdWx0aXBsZS5zZG9SZXBvcnRDcmVhdGlvblNldElkO1xuICAgICAgICAgICAgICAgIHZhciBzZG9SZXBvcnRWaWV3c1NldElkID0gc2RvUmVwb3J0TXVsdGlwbGUuc2RvUmVwb3J0Vmlld3NTZXRJZDtcbiAgICAgICAgICAgICAgICB2YXIgc2RvUmVwb3J0Sm9pbnNTZXRJZCA9IHNkb1JlcG9ydE11bHRpcGxlLnNkb1JlcG9ydEpvaW5zU2V0SWQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2RvUmVwb3J0Q3JlYXRpb25VVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgc2RvUmVwb3J0Q3JlYXRpb25TZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgc2RvUmVwb3J0Vmlld3NVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgc2RvUmVwb3J0Vmlld3NTZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB2YXIgc2RvUmVwb3J0Sm9pbnNVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgc2RvUmVwb3J0Sm9pbnNTZXRJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJzZG9SZXBvcnRNdWx0aXBsZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydENyZWF0aW9uVVVJRFwiOiBzZG9SZXBvcnRDcmVhdGlvblVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydFZpZXdzVVVJRFwiOiBzZG9SZXBvcnRWaWV3c1VVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydEpvaW5zVVVJRFwiOiBzZG9SZXBvcnRKb2luc1VVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogYXBwLlNDT1BFLndvcmtmbG93LnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ3Nkb1JlcG9ydE11bHRpcGxlIFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHN1YnByb2ZpbGVRdWFydGVybHlSZXBvcnQ6IGZ1bmN0aW9uKHN1YnByb2ZpbGVRdWFydGVybHlSZXBvcnQsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImV4ZWN1dGVSZXBvcnRcIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2NoZWR1bGVSZXBvcnRJbmRpY2F0b3IgPSBzdWJwcm9maWxlUXVhcnRlcmx5UmVwb3J0LnNjaGVkdWxlUmVwb3J0SW5kaWNhdG9yO1xuICAgICAgICAgICAgICAgIHZhciBzY2hlZHVsZVJlcG9ydEluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyBzY2hlZHVsZVJlcG9ydEluZGljYXRvciArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgdmFyIHNkb1JlcG9ydEFwcHJvdmFsSW5kaWNhdG9yID0gc3VicHJvZmlsZVF1YXJ0ZXJseVJlcG9ydC5zZG9SZXBvcnRBcHByb3ZhbEluZGljYXRvcjtcbiAgICAgICAgICAgICAgICB2YXIgc2RvUmVwb3J0QXBwcm92YWxJbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgc2RvUmVwb3J0QXBwcm92YWxJbmRpY2F0b3IgKyBcIicgYW5kIHdvcmtmbG93c1sxXS9wcm9jZXNzZXNbMV0vc3ViUHJvY2Vzc1VVSUQgZXEgJ1wiICsgdXVpZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cblxuXG5cblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwic3VicHJvZmlsZVF1YXJ0ZXJseVJlcG9ydFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcInNjaGVkdWxlUmVwb3J0SW5kaWNhdG9yVVVJRFwiOiBzY2hlZHVsZVJlcG9ydEluZGljYXRvclVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInNkb1JlcG9ydEFwcHJvdmFsSW5kaWNhdG9yVVVJRFwiOiBzZG9SZXBvcnRBcHByb3ZhbEluZGljYXRvclVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YnByb2ZpbGVDb2RlXCI6IGFwcC5wcm9maWxlLnN1YlByb2ZpbGUuY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3VicHJvZmlsZVRpdGxlXCI6IGFwcC5wcm9maWxlLnN1YlByb2ZpbGUudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uSWRcIjogYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogYXBwLlNDT1BFLndvcmtmbG93LnByb2ZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1F1YXJ0ZXJseVJlcG9ydCByZXBvcnQgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgfVxuXG5cblxuXG5cbiAgICB9XG5cbn0pKCk7XG5cblxuXG5cblxuXG5cbnZhciBwYXJ0aWNpcGFudHMgPSAoZnVuY3Rpb24oKSB7XG5cbiAgICByZXR1cm4ge1xuXG5cblxuXG4gICAgICAgIGxpbmtQYXJ0aWNpcGFudHM6IGZ1bmN0aW9uKGxpbmtQYXJ0aWNpcGFudHMsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcIm5hdmlnYXRpb25cIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgRVBXUExpbmtQYXJ0aWNpcGFudHNJbkJ1bGtJZCA9IGxpbmtQYXJ0aWNpcGFudHMuRVBXUExpbmtQYXJ0aWNpcGFudHNJbkJ1bGtJZDtcbiAgICAgICAgICAgICAgICB2YXIgRVBXUExpbmtQYXJ0aWNpcGFudHNJbkJ1bGtJZFVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBFUFdQTGlua1BhcnRpY2lwYW50c0luQnVsa0lkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIEVQV1BMb2NhbGl0eUlkID0gbGlua1BhcnRpY2lwYW50cy5FUFdQTG9jYWxpdHlJZDtcbiAgICAgICAgICAgICAgICB2YXIgRVBXUExvY2FsaXR5SWRVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgRVBXUExvY2FsaXR5SWQgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIEVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZCA9IGxpbmtQYXJ0aWNpcGFudHMuRVBXUEFjdGl2ZVBhcnRpY2lwYW50c0lkO1xuICAgICAgICAgICAgICAgIHZhciBFUFdQQWN0aXZlUGFydGljaXBhbnRzSWRVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgRVBXUEFjdGl2ZVBhcnRpY2lwYW50c0lkICsgXCInXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIFwibGlua1BhcnRpY2lwYW50c1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcIkVQV1BMaW5rUGFydGljaXBhbnRzSW5CdWxrSWRVVUlEXCI6IEVQV1BMaW5rUGFydGljaXBhbnRzSW5CdWxrSWRVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJFUFdQTG9jYWxpdHlJZFVVSURcIjogRVBXUExvY2FsaXR5SWRVVUlELFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJFUFdQQWN0aXZlUGFydGljaXBhbnRzSWRVVUlEXCI6IEVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZFVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbElkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICB3b3JrZXIuc2VuZCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24od29ya2VyU3VjY2Vzcykge1xuXG4gICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZXRXb3JrZXJJbmZvSW5TdWJwcm9jZXNzKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdFUFdQTGlua1BhcnRpY2lwYW50cyBXb3JrZXIgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHdvcmtlckZhaWwpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBtb250aGx5QXR0ZW5kYW5jZTogZnVuY3Rpb24obW9udGhseUF0dGVuZGFuY2UsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcIm5hdmlnYXRpb25cIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgRVBXUE1vbnRobHlBdHRlbmRhbmNlQnVsa1VwbG9hZElkID0gbW9udGhseUF0dGVuZGFuY2UuRVBXUE1vbnRobHlBdHRlbmRhbmNlQnVsa1VwbG9hZFVVSUQ7XG4gICAgICAgICAgICAgICAgdmFyIEVQV1BNb250aGx5QXR0ZW5kYW5jZUJ1bGtVcGxvYWRVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgRVBXUE1vbnRobHlBdHRlbmRhbmNlQnVsa1VwbG9hZElkICsgXCInXS9pbnN0YW5jZXNbMV0vdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIEVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZCA9IG1vbnRobHlBdHRlbmRhbmNlLkVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZFVVSUQ7XG4gICAgICAgICAgICAgICAgdmFyIEVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZFVVSUQgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnXCIgKyBFUFdQQWN0aXZlUGFydGljaXBhbnRzSWQgKyBcIiddL19pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgdmFyIEVQV1BNb250aGx5RW1wbG95bWVudFBlckxvY2FsaXR5SWQgPSBtb250aGx5QXR0ZW5kYW5jZS5FUFdQTW9udGhseUVtcGxveW1lbnRQZXJMb2NhbGl0eVVVSUQ7XG4gICAgICAgICAgICAgICAgdmFyIEVQV1BNb250aGx5RW1wbG95bWVudFBlckxvY2FsaXR5VVVJRCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pbmRpY2F0b3JzW2lkIGVxICdcIiArIEVQV1BNb250aGx5RW1wbG95bWVudFBlckxvY2FsaXR5SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cblxuXG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcIm1vbnRobHlBdHRlbmRhbmNlXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiRVBXUE1vbnRobHlBdHRlbmRhbmNlQnVsa1VwbG9hZFVVSURcIjogRVBXUE1vbnRobHlBdHRlbmRhbmNlQnVsa1VwbG9hZFVVSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIkVQV1BBY3RpdmVQYXJ0aWNpcGFudHNJZFVVSURcIjogRVBXUEFjdGl2ZVBhcnRpY2lwYW50c0lkVVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiRVBXUE1vbnRobHlFbXBsb3ltZW50UGVyTG9jYWxpdHlVVUlEXCI6IEVQV1BNb250aGx5RW1wbG95bWVudFBlckxvY2FsaXR5VVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsSWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ21vbnRobHlBdHRlbmRhbmNlIFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIG1vbnRobHlQcm9ncmVzc1N1bW1hcnk6IGZ1bmN0aW9uKG1vbnRobHlQcm9ncmVzc1N1bW1hcnksIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJPYmplY3QgPSB3b3JrZXIuZ2V0V29ya2VyV3JhcHBlcigpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YnByb2ZpbGVJZCA9IGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuX2lkID0gZ2VuZXJhdGVVVUlEKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNvbW11bml0eUlkID0gYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY3JlYXRlZERhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnNlbmRlclVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5wcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJQcm9jZXNzVVVJRCA9IHV1aWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YnByb2ZpbGVJZCA9IHN1YnByb2ZpbGVJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcIm5hdmlnYXRpb25cIik7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgRVBXUE1vbnRobHlQcm9ncmVzc1N1bW1hcnlJZCA9IG1vbnRobHlQcm9ncmVzc1N1bW1hcnkuRVBXUE1vbnRobHlQcm9ncmVzc1N1bW1hcnlJZFVVSUQ7XG4gICAgICAgICAgICAgICAgdmFyIEVQV1BNb250aGx5UHJvZ3Jlc3NTdW1tYXJ5SWRVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgRVBXUE1vbnRobHlQcm9ncmVzc1N1bW1hcnlJZCArIFwiJ10vaW5zdGFuY2VzWzFdL3V1aWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcblxuXG5cblxuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgXCJtb250aGx5UHJvZ3Jlc3NTdW1tYXJ5XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiRVBXUE1vbnRobHlQcm9ncmVzc1N1bW1hcnlJZFVVSURcIjogRVBXUE1vbnRobHlQcm9ncmVzc1N1bW1hcnlJZFVVSUQsXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsSWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYWN0aW9uID0gYWN0aW9uO1xuICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd29ya2VyLnNldFdvcmtlckluZm9JblN1YnByb2Nlc3Mod29ya2VyT2JqZWN0LCBfV0ZJbnN0YW5jZSwgdXVpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ21vbnRobHlBdHRlbmRhbmNlIFdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHBhcnRpY2lwYW50Q29udHJhY3RzOiBmdW5jdGlvbihwYXJ0aWNpcGFudENvbnRyYWN0cywgX1dGSW5zdGFuY2UsIHV1aWQpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwibmF2aWdhdGlvblwiKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY2hhbm5lbHMucHVzaChcImNvbW11bml0eV9cIiArIGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpKTtcblxuICAgICAgICAgICAgICAgIHZhciBFUFdQUGFydGljaXBhbnRDb250cmFjdHNJZCA9IHBhcnRpY2lwYW50Q29udHJhY3RzLkVQV1BQYXJ0aWNpcGFudENvbnRyYWN0c0lkVVVJRDtcbiAgICAgICAgICAgICAgICB2YXIgRVBXUFBhcnRpY2lwYW50Q29udHJhY3RzSWRVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgRVBXUFBhcnRpY2lwYW50Q29udHJhY3RzSWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICBcInBhcnRpY2lwYW50Q29udHJhY3RzXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiRVBXUFBhcnRpY2lwYW50Q29udHJhY3RzSWRVVUlEXCI6IEVQV1BQYXJ0aWNpcGFudENvbnRyYWN0c0lkVVVJRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsSWRcIjogX1dGSW5zdGFuY2UucHJvZmlsZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygncGFydGljaXBhbnRDb250cmFjdHMgV29ya2VyIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbih3b3JrZXJGYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh3b3JrZXJGYWlsKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuXG5cbiAgICB9XG5cbn0pKCk7XG5cblxuXG5cblxuXG52YXIgd29ya2VyID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgcmV0dXJuIHtcblxuICAgICAgICBnZXRXb3JrZXJXcmFwcGVyOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgdmFyIHdyYXBwZXIgPSB7XG4gICAgICAgICAgICAgICAgXCJzb3VyY2VcIjogXCJyZW1vdGVcIixcbiAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJ3b3JrZXJPYmplY3RcIixcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwiY2hhbm5lbHNcIjogW10sXG4gICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcImNvbW11bml0eUlkXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbklkXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgXCJzdWJQcm9jZXNzVVVJRFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwibWVzc2FnZVwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwibWVzc2FnZVR5cGVcIjogXCJpbmZvXCIsXG4gICAgICAgICAgICAgICAgXCJjcmVhdGVkRGF0ZVRpbWVcIjogXCJcIixcbiAgICAgICAgICAgICAgICBcInNlbmRlclVzZXJJZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgIFwic3ViUHJvZmlsZUlkXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgXCJhY3Rpb25cIjoge1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXR1cm4gd3JhcHBlcjtcblxuICAgICAgICB9LFxuICAgICAgICBzZW5kOiBmdW5jdGlvbih3b3JrZXJPYmplY3QpIHtcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1N1Ym1pdHRpbmcgV29ya2VyIE9iamVjdCB0byBzZXJ2ZXInKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh3b3JrZXJPYmplY3QpO1xuICAgICAgICAgICAgICAgIGRhby5zYXZlKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJSZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHdvcmtlclJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIHN1Ym1pdHRpbmcgd29ya2VyIHJlc3BvbnNlICEhJyArIGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgc2VuZFdvcmtlcjogZnVuY3Rpb24od29ya2VyQ29uZmlnLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgd29ya2VyT2JqZWN0ID0gd29ya2VyLmdldFdvcmtlcldyYXBwZXIoKTtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJwcm9maWxlSWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzdWJwcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0Ll9pZCA9IGdlbmVyYXRlVVVJRCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jb21tdW5pdHlJZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNyZWF0ZWREYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zZW5kZXJVc2VySWQgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QucHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3ViUHJvY2Vzc1VVSUQgPSB1dWlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5zdWJwcm9maWxlSWQgPSBzdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmNoYW5uZWxzLnB1c2goXCJzZW5kV29ya2VyXCIpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzR2V0Tm9kZVZhbHVlID0gZnVuY3Rpb24ocGFyYW1CbG9jaywgc2VxLCBwYXJhbU5hbWUpIHtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzLCByZWopIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShwYXJhbUJsb2NrLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihkYXRhVmFsdWUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IHNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogcGFyYW1OYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhdGFWYWx1ZVwiOiBkYXRhVmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc1BhcmFtcyA9IGZ1bmN0aW9uKGNvbmZpZ1BhcmFtKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlcywgcmVqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1ldGVyc0FycmF5ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbXNUb1Byb2Nlc3MgPSBjb25maWdQYXJhbS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvbmZpZ1BhcmFtLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtQmxvY2sgPSBjb25maWdQYXJhbVtpXS5wYXJhbWV0ZXJWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VxID0gY29uZmlnUGFyYW1baV0uc2VxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbU5hbWUgPSBjb25maWdQYXJhbVtpXS5wYXJhbWV0ZXJOYW1lO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtVmFsdWUgPSBwcm9jZXNzR2V0Tm9kZVZhbHVlKHBhcmFtQmxvY2ssIHNlcSwgcGFyYW1OYW1lKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyc0FycmF5LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogcmVzcG9uc2Uuc2VxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbU5hbWVcIjogcmVzcG9uc2UucGFyYW1OYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbVZhbHVlXCI6IHJlc3BvbnNlLmRhdGFWYWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zVG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtc1RvUHJvY2VzcyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzQXJyYXkucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogaXRlbXNUb1Byb2Nlc3MgKyAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1OYW1lXCI6IFwiY29tbXVuaXR5SWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtVmFsdWVcIjogX1dGSW5zdGFuY2UuY29tbXVuaXR5SWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzQXJyYXkucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogaXRlbXNUb1Byb2Nlc3MgKyAyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1OYW1lXCI6IFwiYXBwbGljYXRpb25JZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1WYWx1ZVwiOiBfV0ZJbnN0YW5jZS5hcHBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzQXJyYXkucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogaXRlbXNUb1Byb2Nlc3MgKyAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1OYW1lXCI6IFwicHJvZmlsZUlkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbVZhbHVlXCI6IF9XRkluc3RhbmNlLnByb2ZpbGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzQXJyYXkucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogaXRlbXNUb1Byb2Nlc3MgKyA0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1OYW1lXCI6IFwic3ViUHJvY2Vzc1VVSURcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtVmFsdWVcIjogdXVpZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyhwYXJhbWV0ZXJzQXJyYXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zVG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtc1RvUHJvY2VzcyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzQXJyYXkucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogaXRlbXNUb1Byb2Nlc3MgKyAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1OYW1lXCI6IFwiY29tbXVuaXR5SWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtVmFsdWVcIjogX1dGSW5zdGFuY2UuY29tbXVuaXR5SWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzQXJyYXkucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogaXRlbXNUb1Byb2Nlc3MgKyAyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1OYW1lXCI6IFwiYXBwbGljYXRpb25JZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1WYWx1ZVwiOiBfV0ZJbnN0YW5jZS5hcHBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzQXJyYXkucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogaXRlbXNUb1Byb2Nlc3MgKyAzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1OYW1lXCI6IFwicHJvZmlsZUlkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwYXJhbVZhbHVlXCI6IF9XRkluc3RhbmNlLnByb2ZpbGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzQXJyYXkucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZXFcIjogaXRlbXNUb1Byb2Nlc3MgKyA0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicGFyYW1OYW1lXCI6IFwic3ViUHJvY2Vzc1VVSURcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtVmFsdWVcIjogdXVpZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyhwYXJhbWV0ZXJzQXJyYXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKHdvcmtlckNvbmZpZy5yZXN0ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb25maWdQYXJhbSA9IHdvcmtlckNvbmZpZy5yZXN0LnBhcmFtZXRlcnM7XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NQYXJhbXMoY29uZmlnUGFyYW0pLnRoZW4oZnVuY3Rpb24ocGFyYW1zQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZW5kV29ya2VyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJyZXN0XCI6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5zZW5kV29ya2VyLnJlc3QudXJpID0gd29ya2VyQ29uZmlnLnJlc3QudXJpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uLnNlbmRXb3JrZXIucmVzdC5wcm9maWxJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24uc2VuZFdvcmtlci5yZXN0LnBhcmFtZXRlcnMgPSBwYXJhbXNBcnJheTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3Quc3BTdGF0dXMgPSAnc3VibWl0dGVkJztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzcE9iamVjdC5tZXNzYWdlcyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3QubWVzc2FnZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBlbmRpbmdTdWJtaXNzaW9uT2JqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpMThuXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZW5cIjogXCJTZXJ2ZXIgcmVxdWVzdCBpcyBwZW5kaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwdFwiOiBcIlNlcnZlciByZXF1ZXN0IGlzIHBlbmRpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJpbmZvXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwT2JqZWN0Lm1lc3NhZ2VzLnB1c2gocGVuZGluZ1N1Ym1pc3Npb25PYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdvcmtlciBpZCBoZXJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNwT2JqZWN0LndvcmtlcnMgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwT2JqZWN0LndvcmtlcnMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3Qud29ya2Vycy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ3b3JrZXJJZFwiOiB3b3JrZXJPYmplY3QuX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhdGVUaW1lXCI6IG1vbWVudCgpLmZvcm1hdCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0RGF0YSgnc3VicHJvY2Vzc2VzJywgYXBwLlNDT1BFLndvcmtmbG93LCB1dWlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihzYXZlZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnV29ya2VyIFJlc3QgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseS4nLCB3b3JrZXJTdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZmFpbGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnV29ya2VyIHN1Ym1pdHRlZCBzdWJwcm9jZXNzIGZpbGUgdXBkYXRlIGZhaWxlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGZhaWxlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnV29ya2VyIGZhaWxlZCAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGFyYW1ldGVyIGNyZWF0aW9uIGZhaWxlZC4gQWJvcmRpbmcgd29ya2VyIG9iamVjdFwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHdvcmtlckNvbmZpZy5mdW5jdGlvbmFsICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb25maWdQYXJhbSA9IHdvcmtlckNvbmZpZy5mdW5jdGlvbmFsLnBhcmFtZXRlcnM7XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NQYXJhbXMoY29uZmlnUGFyYW0pLnRoZW4oZnVuY3Rpb24ocGFyYW1zQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzZW5kV29ya2VyXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJmdW5jdGlvbmFsXCI6IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5zZW5kV29ya2VyLmZ1bmN0aW9uYWwubWV0aG9kTmFtZSA9IHdvcmtlckNvbmZpZy5mdW5jdGlvbmFsLm1ldGhvZE5hbWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb24uc2VuZFdvcmtlci5mdW5jdGlvbmFsLnByb2ZpbElkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbi5zZW5kV29ya2VyLmZ1bmN0aW9uYWwucGFyYW1ldGVycyA9IHBhcmFtc0FycmF5O1xuICAgICAgICAgICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LmFjdGlvbiA9IGFjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtlci5zZW5kKHdvcmtlck9iamVjdCkudGhlbihmdW5jdGlvbih3b3JrZXJTdWNjZXNzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3BPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcE9iamVjdC5zcFN0YXR1cyA9ICdzdWJtaXR0ZWQnO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNwT2JqZWN0Lm1lc3NhZ2VzID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcE9iamVjdC5tZXNzYWdlcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGVuZGluZ1N1Ym1pc3Npb25PYmplY3QgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImkxOG5cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiX2lkXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJlblwiOiBcIlNlcnZlciByZXF1ZXN0IGlzIHBlbmRpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInB0XCI6IFwiU2VydmVyIHJlcXVlc3QgaXMgcGVuZGluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcImluZm9cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BPYmplY3QubWVzc2FnZXMucHVzaChwZW5kaW5nU3VibWlzc2lvbk9iamVjdCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3b3JrZXIgaWQgaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzcE9iamVjdC53b3JrZXJzID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcE9iamVjdC53b3JrZXJzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwT2JqZWN0LndvcmtlcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwid29ya2VySWRcIjogd29ya2VyT2JqZWN0Ll9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkYXRlVGltZVwiOiBtb21lbnQoKS5mb3JtYXQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyc2lzdERhdGEoJ3N1YnByb2Nlc3NlcycsIGFwcC5TQ09QRS53b3JrZmxvdywgdXVpZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oc2F2ZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1dvcmtlciBmdW5jdGlvbmFsIHByb2Nlc3NlZCBzdWNjZXNzZnVsbHkuJywgd29ya2VyU3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGZhaWxlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1dvcmtlciBzdWJtaXR0ZWQgc3VicHJvY2VzcyBmaWxlIHVwZGF0ZSBmYWlsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChmYWlsZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHdvcmtlckZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnV29ya2VyIGZhaWxlZCAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGFyYW1ldGVyIGNyZWF0aW9uIGZhaWxlZC4gQWJvcmRpbmcgd29ya2VyIG9iamVjdFwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIGV4ZWN1dGVMb2NhbDogZnVuY3Rpb24od29ya2VyQ29uZmlnLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cblxuXG4gICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NHZXROb2RlVmFsdWUgPSBmdW5jdGlvbihwYXJhbUJsb2NrLCBzZXEsIGRhdGFUeXBlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlcywgcmVqKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUocGFyYW1CbG9jaywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YVZhbHVlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBzZXEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YVR5cGVcIjogZGF0YVR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YVZhbHVlXCI6IGRhdGFWYWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWooZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NQYXJhbXMgPSBmdW5jdGlvbihjb25maWdQYXJhbSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXMsIHJlaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtZXRlcnNBcnJheSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1zVG9Qcm9jZXNzID0gY29uZmlnUGFyYW0ubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb25maWdQYXJhbS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbUJsb2NrID0gY29uZmlnUGFyYW1baV0ucGFyYW1ldGVyVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlcSA9IGNvbmZpZ1BhcmFtW2ldLnNlcTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YVR5cGUgPSBjb25maWdQYXJhbVtpXS5kYXRhVHlwZS5kYXRhVHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW1WYWx1ZSA9IHByb2Nlc3NHZXROb2RlVmFsdWUocGFyYW1CbG9jaywgc2VxLCBkYXRhVHlwZSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnNBcnJheS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2VxXCI6IHJlc3BvbnNlLnNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YVR5cGVcIjogcmVzcG9uc2UuZGF0YVR5cGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhcmFtVmFsdWVcIjogcmVzcG9uc2UuZGF0YVZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNUb1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1zVG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcyhwYXJhbWV0ZXJzQXJyYXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zVG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtc1RvUHJvY2VzcyA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMocGFyYW1ldGVyc0FycmF5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgdmFyIGZpeFBhcmFtVHlwZSA9IGZ1bmN0aW9uKHBhcmFtVmFsdWUsIGRhdGFUeXBlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChkYXRhVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInN0cmluZ1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eHQgPSBwYXJhbVZhbHVlLnJlcGxhY2UoLycvZywgXCJcXFxcJ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCInXCIgKyB0eHQgKyBcIidcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJkYXRlXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZGF0ZVRpbWVcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCInXCIgKyBwYXJhbVZhbHVlICsgXCInXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwibnVtYmVyXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZGVjaW1hbFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJhbVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHZhciBtZXRob2ROYW1lID0gd29ya2VyQ29uZmlnLm1ldGhvZE5hbWU7XG4gICAgICAgICAgICAgICAgdmFyIGNvbmZpZ1BhcmFtID0gd29ya2VyQ29uZmlnLnBhcmFtZXRlcnM7XG4gICAgICAgICAgICAgICAgcHJvY2Vzc1BhcmFtcyhjb25maWdQYXJhbSkudGhlbihmdW5jdGlvbihwYXJhbXNBcnJheSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBwTGlzdCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcmFtc0FycmF5Lmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcExpc3QgPSBwTGlzdCArIGZpeFBhcmFtVHlwZShwYXJhbXNBcnJheVtpXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVtpXS5kYXRhVHlwZSkgKyAnLCc7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcExpc3QgPSBwTGlzdCArIGZpeFBhcmFtVHlwZShwYXJhbXNBcnJheVtpXS5wYXJhbVZhbHVlLCBwYXJhbXNBcnJheVtpXS5kYXRhVHlwZSlcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY2FsbGJhY2tTdWNjZXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShcIkZ1bmN0aW9uICdcIiArIG1ldGhvZE5hbWUgKyBcIicgZXhlY3V0ZWQuIFJlc3BvbnNlIHN1Y2Nlc3MuXCIpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2FsbGJhY2tGYWlsdXJlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KFwiRnVuY3Rpb24gJ1wiICsgbWV0aG9kTmFtZSArIFwiJyBleGVjdXRlZC4gUmVzcG9uc2UgZmFpbGVkLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNwVVVJRCA9IFwiJ1wiICsgdXVpZCArIFwiJ1wiXG4gICAgICAgICAgICAgICAgICAgIHZhciBmdW5jID0gbWV0aG9kTmFtZSArICcoJyArIHBMaXN0ICsgJyxjYWxsYmFja1N1Y2Nlc3MsIGNhbGxiYWNrRmFpbHVyZSwnICsgc3BVVUlEICsgJyknO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXhlID0gZXZhbChmdW5jKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXhlKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShcIkxvY2FsIGZ1bmN0aW9uIGV4ZWN1dGVkXCIpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGFyYW1ldGVyIGNyZWF0aW9uIGZhaWxlZC4gQWJvcmRpbmcgd29ya2VyIG9iamVjdFwiKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG5cblxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9LFxuXG4gICAgICAgIHNldFdvcmtlckluZm9JblN1YnByb2Nlc3M6IGZ1bmN0aW9uKHdvcmtlck9iamVjdCwgX1dGSW5zdGFuY2UsIHV1aWQpIHtcblxuICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3NPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIHZhciBwZW5kaW5nU3VibWlzc2lvbk9iamVjdCA9IHtcbiAgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIjoge1xuICAgICAgICAgICAgICAgICAgICBcImkxOG5cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJfaWRcIjogXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW5cIjogXCJXb3JrZXIgc3VibWl0dGVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInB0XCI6IFwiV29ya2VyIHN1Ym1pdHRlZFwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcImluZm9cIlxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHN1YnByb2Nlc3NPYmplY3QubWVzc2FnZXMgPSBbXTtcbiAgICAgICAgICAgIHN1YnByb2Nlc3NPYmplY3QubWVzc2FnZXMucHVzaChwZW5kaW5nU3VibWlzc2lvbk9iamVjdCk7XG5cbiAgICAgICAgICAgIGlmIChzdWJwcm9jZXNzT2JqZWN0LndvcmtlcnMgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc3VicHJvY2Vzc09iamVjdC53b3JrZXJzID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzdWJwcm9jZXNzT2JqZWN0LndvcmtlcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgXCJ3b3JrZXJJZFwiOiB3b3JrZXJPYmplY3QuX2lkLFxuICAgICAgICAgICAgICAgIFwiZGF0ZVRpbWVcIjogbW9tZW50KCkuZm9ybWF0KClcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgfSxcblxuXG4gICAgICAgIGNyZWF0ZTogZnVuY3Rpb24od29ya2VyQ29uZmlnLCBfV0ZJbnN0YW5jZSwgdXVpZCkge1xuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hhbm5lbCA9IHdvcmtlckNvbmZpZy5jaGFubmVsO1xuICAgICAgICAgICAgICAgIHZhciB3b3JrZXJBY3Rpb24gPSB3b3JrZXJDb25maWcuYWN0aW9uO1xuXG4gICAgICAgICAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHdvcmtlci5nZXRXb3JrZXJXcmFwcGVyKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3VicHJvZmlsZUlkID0gXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAoYXBwLnByb2ZpbGUgIT0gdW5kZWZpbmVkICYmIGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5faWQgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuY29tbXVuaXR5SWQgPSBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3QuYXBwbGljYXRpb25JZCA9IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jcmVhdGVkRGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc2VuZGVyVXNlcklkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQ7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgd29ya2VyT2JqZWN0LnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcbiAgICAgICAgICAgICAgICB3b3JrZXJPYmplY3Quc3VicHJvZmlsZUlkID0gc3VicHJvZmlsZUlkO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKGNoYW5uZWwpO1xuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCkpO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IHtcblxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgYWN0aW9uW3dvcmtlckFjdGlvbl0gPSB7fTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd29ya2VyQ29uZmlnLmluZGljYXRvcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxhYmVsID0gd29ya2VyQ29uZmlnLmluZGljYXRvcnNbaV0ubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZXRJZCA9IHdvcmtlckNvbmZpZy5pbmRpY2F0b3JzW2ldLnNldElkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IHdvcmtlckNvbmZpZy5pbmRpY2F0b3JzW2ldLmNvbnRleHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gXCJcIjtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoY29udGV4dCA9PSAnc3ViUHJvY2VzcycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgc2V0SWQgKyBcIiddL2luc3RhbmNlc1sxXS91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIHNldElkICsgXCInXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25bd29ya2VyQWN0aW9uXVtsYWJlbF0gPSBpZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhY3Rpb25bd29ya2VyQWN0aW9uXS5wcm9maWxJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGVcblxuICAgICAgICAgICAgICAgIHdvcmtlck9iamVjdC5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgICAgICAgICAgd29ya2VyLnNlbmQod29ya2VyT2JqZWN0KS50aGVuKGZ1bmN0aW9uKHdvcmtlclN1Y2Nlc3MpIHtcblxuICAgICAgICAgICAgICAgICAgICB3b3JrZXIuc2V0V29ya2VySW5mb0luU3VicHJvY2Vzcyh3b3JrZXJPYmplY3QsIF9XRkluc3RhbmNlLCB1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2Vzcyh3b3JrZXJBY3Rpb24gKyAnIHdvcmtlciBwcm9jZXNzZWQgc3VjY2Vzc2Z1bGx5LicsIHdvcmtlclN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24od29ya2VyRmFpbCkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3Qod29ya2VyRmFpbCk7XG4gICAgICAgICAgICAgICAgfSk7XG5cblxuXG5cblxuXG5cblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSxcblxuICAgIH1cblxufSkoKTtcblxuXG52YXIgdXNlciA9IChmdW5jdGlvbigpIHtcblxuICAgIHJldHVybiB7XG5cbiAgICAgICAgYWRkVG9Sb2xlOiBmdW5jdGlvbihhZGRUb1JvbGUsIHV1aWQsIF9XRkluc3RhbmNlKSB7XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGFkZFRvUm9sZS51c2VyTmFtZSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24odXNlckRpc3BsYXlOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUoYWRkVG9Sb2xlLnVzZXJJZCwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24odXNlcklkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29udGV4dFR5cGUgPSBKU09OLnhwYXRoKFwiL3JvbGVzW2lkIGVxICdcIiArIGFkZFRvUm9sZS5yb2xlSWQgKyBcIiddL3R5cGVcIiwgYXBwLlNDT1BFLkFQUF9DT05GSUcsIHt9KVswXVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGV4dFR5cGUgPT0gJ2luc3RhbmNlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvbGVzTWFuYWdlci5kb1VzZXJSZWdpc3RyYXRpb24odXNlcklkLCB1c2VyRGlzcGxheU5hbWUsIGFkZFRvUm9sZS5yb2xlSWQsICdpbnN0YW5jZScpLnRoZW4oZnVuY3Rpb24ocykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUm9sZSBhc3NpZ25lZCB0byB1c2VyIGluIGNvbnRleHQgaW5zdGFuY2UnLCBzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JvbGVzTWFuYWdlci0gaW5zdGFuY2UgZmFpbCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdyb2xlIHVwZGF0ZSBmYWlsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGV4dFR5cGUgPT0gJ3N1YnByb2ZpbGUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9sZXNNYW5hZ2VyLmRvVXNlclJlZ2lzdHJhdGlvbl9ub2RlKHVzZXJJZCwgdXNlckRpc3BsYXlOYW1lLCBhZGRUb1JvbGUucm9sZUlkLCAnc3VicHJvZmlsZScpLnRoZW4oZnVuY3Rpb24ocykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUm9sZSBhc3NpZ25lZCB0byB1c2VyIGluIGNvbnRleHQgc3VicHJvZmlsZScsIHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncm9sZXNNYW5hZ2VyLSBzdWJwcm9maWxlIGZhaWwnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncm9sZSB1cGRhdGUgZmFpbGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHRUeXBlID09ICdhZG9wdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb2xlc01hbmFnZXIuZG9Vc2VyUmVnaXN0cmF0aW9uX2Fkb3B0aW9uKHVzZXJJZCwgdXNlckRpc3BsYXlOYW1lLCBhZGRUb1JvbGUucm9sZUlkLCAnYWRvcHRpb24nKS50aGVuKGZ1bmN0aW9uKHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1JvbGUgYXNzaWduZWQgdG8gdXNlciBpbiBjb250ZXh0IGFkb3B0aW9uJywgcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyb2xlc01hbmFnZXItIGFkb3B0aW9uIGZhaWwnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgncm9sZSB1cGRhdGUgZmFpbGVkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSb2xlIG5vdCBmb3VuZCBpbiBhbnkgY29udGV4dCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCgnUm9sZSBub3QgZm91bmQgaW4gYW55IGNvbnRleHQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufSkoKTtcblxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuICAgIGNvbW11bml0eTogY29tbXVuaXR5LFxuICAgIGFwcGxpY2F0aW9uOiBhcHBsaWNhdGlvbixcbiAgICBwZXJmb3JtYW5jZTogcGVyZm9ybWFuY2UsXG4gICAgd29ya2VyOiB3b3JrZXIsXG4gICAgc2RvOiBzZG8sXG4gICAgdGF4b25vbXk6IHRheG9ub215LFxuICAgIHN1YlByb2Nlc3NJbnN0YW5jZTogc3ViUHJvY2Vzc0luc3RhbmNlLFxuICAgIHZhcmlhYmxlczogdmFyaWFibGVzLFxuICAgIG5vdGlmaWNhdGlvbjogbm90aWZpY2F0aW9uLFxuICAgIHJlcG9ydDogcmVwb3J0LFxuICAgIHBhcnRpY2lwYW50czogcGFydGljaXBhbnRzLFxuICAgIHVzZXI6IHVzZXJcbn0iLCIndXNlIHN0cmljdCc7XG5cbi8vdmFyIGdhdGVrZWVwZXIgPSByZXF1aXJlKCcuLi9ib3dlcl9jb21wb25lbnRzL2dhdGVrZWVwZXInKTtcbnZhciB1dGlsID0gcmVxdWlyZSgndXRpbGl0eScpO1xuXG4vLyB2YXIgdXVpZCA9IHJlcXVpcmUoJ25vZGUtdXVpZCcpO1xuXG52YXIgZ2F0ZWtlZXBlciA9IG5ldyBHSygpO1xuXG4vKipcbiAqIEZvcm0gTW9kdWxlXG4gKlxuICogQG1vZHVsZSBsaWIvZm9ybVxuICogQGF1dGhvciBCcmVudCBHb3Jkb25cbiAqIEB2ZXJzaW9uIDIuMC4wXG4gKiBAZGVzY3JpcHRpb24gdGVzdCBkZXNjcmlwdGlvblxuICogQGNvcHlyaWdodCBLd2FudHUgTHRkIFJTQSAyMDA5LTIwMTUuXG4gKlxuICovXG5cbmZ1bmN0aW9uIGNyZWF0ZShhcmdzKSB7XG5cbiAgICB2YXIgcHJvY2Vzc0lkID0gYXJnc1swXSB8fCAnJztcblxuICAgIHZhciBzdWJQcm9jZXNzID0gYXJnc1sxXSB8fCB7fTtcblxuICAgIHZhciBzdGVwID0gYXJnc1syXSB8fCB7fTtcblxuICAgIHZhciBhY3Rpb24gPSBhcmdzWzNdIHx8IHt9O1xuXG4gICAgdmFyIF9XRkluc3RhbmNlID0gYXJnc1s2XSB8fCB7fTtcblxuICAgIHZhciBkYXRhID0gYXJnc1s2XSB8fCB7fTtcblxuICAgIHZhciBpbmRpY2F0b3JzID0gc3ViUHJvY2Vzcy5pbmRpY2F0b3JzIHx8IFtdO1xuXG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuXG4gICAgdmFyIGluZGljYXRvclR5cGUgPSBhY3Rpb24uX3R5cGU7XG5cbiAgICB2YXIgcHJvY2Vzc1NlcSA9IGFyZ3NbNF0gfHwgJyc7XG5cbiAgICB2YXIgc3ViUHJvY2Vzc1NlcSA9IGFyZ3NbNV0gfHwgJyc7XG5cbiAgICB2YXIgY3JlYXRlVHlwZSA9IGFyZ3NbN10gfHwgJyc7XG5cbiAgICB2YXIgc3ViUHJvY2Vzc0lkID0gc3ViUHJvY2Vzcy5faWQ7XG5cbiAgICB2YXIgdXVpZCA9IGFyZ3NbOF0gfHwgJyc7XG5cbiAgICB2YXIgYmFzZVVVSUQgPSBhcmdzWzldIHx8ICcnO1xuXG4gICAgdmFyIHByb2ZpbGUgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuXG4gICAgdmFyIGlucHV0RGF0YSA9IGFyZ3NbMTBdIHx8IHt9O1xuXG4gICAgdmFyIGZvcm1DcmVhdGVUeXBlID0gYWN0aW9uLm1ldGhvZC5mb3JtLmNyZWF0ZTtcblxuICAgIHZhciBmb3JtVHlwZSA9IGFjdGlvbi5tZXRob2QuZm9ybS50eXBlO1xuXG4gICAgdmFyIHBhcmFtT2JqZWN0ID0ge1xuXG4gICAgICAgIFwiZm9ybUNyZWF0ZVR5cGVcIjogZm9ybUNyZWF0ZVR5cGUsXG4gICAgICAgIFwiZm9ybVR5cGVcIjogZm9ybVR5cGVcblxuICAgIH1cblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdmFyIHRvUHJvY2VzcyA9IGluZGljYXRvcnMubGVuZ3RoO1xuXG4gICAgICAgIHZhciBzdWJwcm9jZXNzVHlwZSA9IEpTT04ueHBhdGgoXCIvY29uZmlnL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NJZCArIFwiJ10vdHlwZVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgIHZhciBmb3JtQ3JlYXRlRm4gPSBmdW5jdGlvbihpbmRpY2F0b3JUeXBlLCBpbmRpY2F0b3JJZCwgdmFsaWREYXRlLCBpbnN0YW50aWF0ZVNvdXJjZSkge1xuXG4gICAgICAgICAgICBnYXRla2VlcGVyLmluc3RhbnRpYXRlKGJhc2VVVUlELCBpbmRpY2F0b3JUeXBlLCBpbmRpY2F0b3JJZCwgX1dGSW5zdGFuY2UucHJvZmlsZSwgdmFsaWREYXRlLCBzdWJQcm9jZXNzSWQsIHN1YnByb2Nlc3NUeXBlKS50aGVuKGZ1bmN0aW9uKGRvY0FycmF5KSB7XG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBpbmRpY2F0b3Igd29ya2Zsb3cgcHJvY2Vzc2VzIHNlY3Rpb25cblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZG9jQXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9iamVjdCA9IGRvY0FycmF5W2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIW9iamVjdC5tb2RlbC5faWQuZW5kc1dpdGgoJzphcHByb3ZlZCcpICYmICFvYmplY3QubW9kZWwuX2lkLmVuZHNXaXRoKCc6cmVqZWN0ZWQnKSkge1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdC5tb2RlbC5tb2RlbC5wZW5kaW5nLnZhbGlkRGF0ZSA9IHZhbGlkRGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdC5tb2RlbC5tb2RlbC5wZW5kaW5nLnN1YlByb2Nlc3NVVUlEID0gdXVpZDtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB3b3JrZmxvd09iaiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IF9XRkluc3RhbmNlLmNvbmZpZy5faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpbnN0YW5jZVwiOiBfV0ZJbnN0YW5jZS5pbnN0YW5jZS5faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9jZXNzZXNcIjogW3tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiOiBwcm9jZXNzSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3ViUHJvY2Vzc0lkXCI6IHN1YlByb2Nlc3MuX2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NVVUlEXCI6IHV1aWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCI6IHN0ZXAuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNlcVwiOiBzdGVwLnNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic3RhcnREYXRlXCI6IFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN0YXR1c1wiOiBzdGVwLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibWVzc2FnZVwiOiBzdGVwLm1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFzc2lnbmVkVG9cIjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IHN0ZXAuYXNzaWduZWRUby51c2VySWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCI6IHN0ZXAuYXNzaWduZWRUby5uYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjb21tZW50XCI6IHN0ZXAuY29tbWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29tcGxldGVcIjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImVuZERhdGVcIjogXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uLnNldFdvcmtmbG93TGFiZWxJblRpdGxlICE9IHVuZGVmaW5lZCAmJiBhY3Rpb24uc2V0V29ya2Zsb3dMYWJlbEluVGl0bGUgIT0gJycgJiYgYWN0aW9uLnNldFdvcmtmbG93TGFiZWxJblRpdGxlID09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QubW9kZWwudGl0bGUgPSBpbnB1dERhdGEubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpb24uc2V0RHJhZnQgIT0gdW5kZWZpbmVkICYmIGFjdGlvbi5zZXREcmFmdCAhPSAnJyAmJiBhY3Rpb24uc2V0RHJhZnQgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdC5tb2RlbC5jb250cm9sLmRyYWZ0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0Lm1vZGVsLndvcmtmbG93cy5wdXNoKHdvcmtmbG93T2JqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYWluSWQgPSBvYmplY3QubW9kZWwuX2lkO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGVyc2lzdCB2aWEgZ2sgc28gdGhhdCBpdCBpcyBzYXZlIGluIGNvdWNoXG4gICAgICAgICAgICAgICAgICAgICAgICBnYXRla2VlcGVyLnBlcnNpc3QoZG9jQXJyYXkpLnRoZW4oZnVuY3Rpb24oc2F2ZWRBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdXNpbmcgc2FtZSBpZCBjYWxsIGluaXRpYWxpc2VEYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jYWxsIGNvZGUgdG8gc2V0IHRvIHNldEluc3RhbmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLmdldChtYWluSWQpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JNb2RlbCA9IGtvLm1hcHBpbmcuZnJvbUpTKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGVmYXVsdE1vZGVsXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNldElkXCI6IGluZGljYXRvcklkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhdGVrZWVwZXIuaW5zdGFudGlhdGVEYXRhKG1haW5JZCwgaW5zdGFudGlhdGVTb3VyY2UsIGluZGljYXRvck1vZGVsLCBkYXRhLm1vZGVsLnBlbmRpbmcuc2VxLCBwYXJhbU9iamVjdCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVswXS5zdGF0dXMgPT0gXCIyMDBcIikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvbi5zZXRXb3JrZmxvd0xhYmVsSW5GaWVsZCAhPSB1bmRlZmluZWQgJiYgYWN0aW9uLnNldFdvcmtmbG93TGFiZWxJbkZpZWxkICE9ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50U2V0SWQgPSBhY3Rpb24uc2V0V29ya2Zsb3dMYWJlbEluRmllbGQuc3BsaXQoXCIuXCIpWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXNzaWdubWVudFNldElkID09IGluZGljYXRvcklkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eHQgPSBpbnB1dERhdGEubGFiZWw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3F1b3RlID0gdHh0LnJlcGxhY2UoLycvZywgXCJcXFxcJ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRoID0gXCJkYXRhWzBdLm1vZGVsLm1vZGVsLnBlbmRpbmcuZGF0YS5cIiArIGFjdGlvbi5zZXRXb3JrZmxvd0xhYmVsSW5GaWVsZCArIFwiPSdcIiArIHNxdW90ZSArIFwiJ1wiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZhbChwYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2F0ZWtlZXBlci5wZXJzaXN0KGRhdGEpLnRoZW4oZnVuY3Rpb24oc2F2ZWRBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0KG1haW5JZCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLmluZGljYXRvcnMucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0RGF0YSgnaW5kaWNhdG9ycycsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gY3JlYXRlIGluZGljYXRvciBwZXJzaXN0IHN1Y2Nlc3MuJywgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnRm9ybSBjcmVhdGUgaW5kaWNhdG9yIHBlcnNpc3QgZmFpbGVkLicgKyBlcnJbMF0ubWVzc2FnZSwge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGZhaWx1cmUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmb3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yID0gX1dGSW5zdGFuY2UuaW5kaWNhdG9yc1tpbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRpY2F0b3IuX2lkID09IGRhdGEuX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGN1cnJlbnQgaXRlbSBmcm9tIHRoZSBhcnJheSBhbmQgYWRkIHRoZSB1cGRhdGVkIHByb2Nlc3NNb2RlbFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0RGF0YSgnaW5kaWNhdG9ycycsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBjcmVhdGUgaW5kaWNhdG9yIHBlcnNpc3Qgc3VjY2Vzcy4nLCBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gY3JlYXRlIGluZGljYXRvciBwZXJzaXN0IGZhaWxlZC4nICsgZXJyWzBdLm1lc3NhZ2UsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGZhaWx1cmUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZm91bmQgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5wdXNoKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvUHJvY2Vzcy0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3REYXRhKCdpbmRpY2F0b3JzJywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gY3JlYXRlIGluZGljYXRvciBwZXJzaXN0IHN1Y2Nlc3MuJywgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gY3JlYXRlIGluZGljYXRvciBwZXJzaXN0IGZhaWxlZC4nICsgZXJyWzBdLm1lc3NhZ2UsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZmFpbHVyZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJzEgR2F0ZWtlZXBlciBpbml0aWFsaXNhdGlvbiBmYWlsZWQgd2l0aCBpbml0aWFsaXNlRGF0YSBtZXNzYWdlICcgKyBlcnJbMF0ubWVzc2FnZSwge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGZhaWx1cmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCcyIEdhdGVrZWVwZXIgaW5pdGlhbGlzYXRpb24gZmFpbGVkIHdpdGggaW5pdGlhbGlzZURhdGEgbWVzc2FnZSAnICsgZXJyWzBdLm1lc3NhZ2UsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGZhaWx1cmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCczIEdhdGVrZWVwZXIgaW5pdGlhbGlzYXRpb24gZmFpbGVkIHdpdGggaW5pdGlhbGlzZURhdGEgbWVzc2FnZSAnICsgZXJyWzBdLm1lc3NhZ2UsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZmFpbHVyZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnNCBHYXRla2VlcGVyIGluaXRpYWxpc2F0aW9uIGZhaWxlZCB3aXRoIGluaXRpYWxpc2VEYXRhIG1lc3NhZ2UgJyArIGVyclswXS5tZXNzYWdlLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZmFpbHVyZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJzUgR2F0ZWtlZXBlciBpbml0aWFsaXNhdGlvbiBmYWlsZWQgd2l0aCBpbml0aWFsaXNlRGF0YSBtZXNzYWdlICcgKyBlcnJbMF0ubWVzc2FnZSwge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZmFpbHVyZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnNiBHYXRla2VlcGVyIGluaXRpYWxpc2F0aW9uIGZhaWxlZCB3aXRoIGluaXRpYWxpc2VEYXRhIG1lc3NhZ2UgJyArIGVyclswXS5tZXNzYWdlLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGZhaWx1cmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgdG9BZGRQcm9jZXNzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9XRkluc3RhbmNlLmluc3RhbmNlLnByb2Nlc3Nlc1tpXS5zdWJQcm9jZXNzZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdG9BZGRQcm9jZXNzLnB1c2goX1dGSW5zdGFuY2UuaW5zdGFuY2UucHJvY2Vzc2VzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5zdGFuY2UucHJvY2Vzc2VzID0gW107XG4gICAgICAgICAgICAgICAgX1dGSW5zdGFuY2UuaW5zdGFuY2UucHJvY2Vzc2VzID0gdG9BZGRQcm9jZXNzO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRvQWRkU3ViUHJvY2VzcyA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXNbaV0uaW5kaWNhdG9ycy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b0FkZFN1YlByb2Nlc3MucHVzaChfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMgPSBbXTtcbiAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMgPSB0b0FkZFN1YlByb2Nlc3M7XG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJzcgR2F0ZWtlZXBlciBpbml0aWFsaXNhdGlvbiBmYWlsZWQgd2l0aCBpbml0aWFsaXNlRGF0YSBtZXNzYWdlICcgKyBlcnJbMF0ubWVzc2FnZSwge30pO1xuICAgICAgICAgICAgICAgIHJlamVjdChmYWlsdXJlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBpbnN0YW50aWF0ZVNvdXJjZSA9IEZST01fREVGSU5JVElPTjtcblxuICAgICAgICBmb3IgKHZhciBjb3VudGVyID0gMDsgY291bnRlciA8IGluZGljYXRvcnMubGVuZ3RoOyBjb3VudGVyKyspIHtcbiAgICAgICAgICAgIHZhciBpbmRpY2F0b3JJZCA9IGluZGljYXRvcnNbY291bnRlcl0uX2lkO1xuICAgICAgICAgICAgdmFyIGluZGljYXRvck5hbWUgPSB1dGlsLmdldE5hbWUoaW5kaWNhdG9yc1tjb3VudGVyXS5uYW1lLCAnZW4nKTtcblxuICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGluZGljYXRvcnNbY291bnRlcl0uaW5pdGlhdGVEYXRhO1xuXG4gICAgICAgICAgICB2YXIgaW5pdFR5cGUgPSAnJztcbiAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzLmluc3RhbmNlVHlwZS5uZXdTZXF1ZW5jZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBpbml0VHlwZSA9IElOU1RBTkNFX1RZUEVfTkVXX1NFUTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3ViUHJvY2Vzcy5pbnN0YW5jZVR5cGUubmV3SW5zdGFuY2UgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaW5pdFR5cGUgPSBJTlNUQU5DRV9UWVBFX05FV19JTlM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBpbmRpY2F0b3JEb2MgPSB7fTtcbiAgICAgICAgICAgIGlmIChiYXNlVVVJRCAhPSB1bmRlZmluZWQgJiYgYmFzZVVVSUQgIT0gJycgJiYgYmFzZVVVSUQubGVuZ3RoID4gMCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHNwID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIGJhc2VVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN1YlByb2Nlc3MucGVyaW9kVHlwZS5wZXJpb2RpYyA9PSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoYmFzZVVVSUQgIT0gdXVpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3AuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgICAgICBpbnN0YW50aWF0ZVNvdXJjZSA9IEZST01fQVVUSE9SSVNFRDtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgY2FyZGluYWxpdHkgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbc2V0SWQgZXEgJ1wiICsgaW5kaWNhdG9ySWQgKyBcIiddL2NhcmRpbmFsaXR5XCIsIGFwcC5TQ09QRS5BUFBfQ09ORklHLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5pdFR5cGUgPT0gSU5TVEFOQ0VfVFlQRV9ORVdfSU5TKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNhcmRpbmFsaXR5ID09IElORElDQVRPUl9DQVJESU5BTElUWV9TSU5HTEUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nVVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIGluZGljYXRvcklkICsgXCInXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nVVVJRC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFudGlhdGVTb3VyY2UgPSBGUk9NX0FVVEhPUklTRUQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlU291cmNlID0gRlJPTV9ERUZJTklUSU9OO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFudGlhdGVTb3VyY2UgPSBGUk9NX0RFRklOSVRJT047XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNhcmRpbmFsaXR5ID09IElORElDQVRPUl9DQVJESU5BTElUWV9TSU5HTEUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nVVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIGluZGljYXRvcklkICsgXCInXS9faWRcIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ1VVSUQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlU291cmNlID0gRlJPTV9BVVRIT1JJU0VEO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW50aWF0ZVNvdXJjZSA9IEZST01fREVGSU5JVElPTjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRoID0gXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIGluZGljYXRvcklkICsgXCInIGFuZCBpZCA9IC9zdWJwcm9jZXNzZXNbaWQgPSAnXCIgKyBzdWJQcm9jZXNzSWQgKyBcIiddL2luZGljYXRvcnMvaW5zdGFuY2VzL3V1aWRdL19pZFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnQgPSBsaWJyYXJ5LmdldFN1YnByb2ZpbGVTdWJwcm9jZXNzSWRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIGluZGljYXRvcklkICsgXCInIGFuZCBpZCA9IC9zdWJwcm9jZXNzZXNbaWQgPSAnXCIgKyBzdWJQcm9jZXNzSWQgKyBcIicgYW5kIGlkID0gXCIgKyBwYXJ0ICsgXCJdL2luZGljYXRvcnMvaW5zdGFuY2VzL3V1aWRdL19pZFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nVVVJRCA9IEpTT04ueHBhdGgocGF0aCwgX1dGSW5zdGFuY2UsIHt9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nVVVJRC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFudGlhdGVTb3VyY2UgPSBGUk9NX0FVVEhPUklTRUQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbnRpYXRlU291cmNlID0gRlJPTV9ERUZJTklUSU9OO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3JtQ3JlYXRlRm4oaW5pdFR5cGUsIGluZGljYXRvcklkLCAnJywgaW5zdGFudGlhdGVTb3VyY2UpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIHNldEluc3RhbmNlVGl0bGUoYXJncykge1xuXG4gICAgdmFyIF9XRkluc3RhbmNlID0gYXJnc1swXSB8fCB7fTtcblxuICAgIHZhciB1dWlkID0gYXJnc1syXSB8fCAnJztcbiAgICB2YXIgZGF0YSA9IGFyZ3NbNF0gfHwge307XG5cbiAgICB2YXIgdGl0bGUgPSBkYXRhLmxhYmVsO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIHZhciBzdWJQcm9jZXNzSW5zdGFuY2UgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgdmFyIGluZGljYXRvckluc3RhbmNlcyA9IHN1YlByb2Nlc3NJbnN0YW5jZS5pbmRpY2F0b3JzO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5kaWNhdG9ySW5zdGFuY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IGluZGljYXRvckluc3RhbmNlc1tpXS5pbnN0YW5jZXNbMF0udXVpZDtcbiAgICAgICAgICAgIHZhciBpbmRpY2F0b3JJbnN0YW5jZSA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIGluZGljYXRvckluc3RhbmNlLnRpdGxlID0gaW5kaWNhdG9ySW5zdGFuY2VzW2ldLmlkICsgJyAnICsgdGl0bGU7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmVzb2x2ZShcIlNldCBUaXRsZSBTdWNjZXNzXCIsIGluZGljYXRvckluc3RhbmNlcyk7XG5cbiAgICB9KTtcblxufTtcblxuZnVuY3Rpb24gZGVsZXRlUHJvZmlsZShhcmdzKSB7XG5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBhcmdzWzBdIHx8IHt9O1xuXG4gICAgdmFyIHByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgdmFyIHN1YnByb2ZpbGVJZCA9IFwiXCI7XG4gICAgICAgIGlmIChhcHAucHJvZmlsZSAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc3VicHJvZmlsZUlkID0gYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHdvcmtlck9iamVjdCA9IHtcbiAgICAgICAgICAgIFwic291cmNlXCI6IFwicmVtb3RlXCIsXG4gICAgICAgICAgICBcInR5cGVcIjogXCJ3b3JrZXJPYmplY3RcIixcbiAgICAgICAgICAgIFwiX2lkXCI6IGdlbmVyYXRlVVVJRCgpLFxuICAgICAgICAgICAgXCJjaGFubmVsc1wiOiBbXCJkZWxldGVQcm9maWxlXCIsIFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCldLFxuICAgICAgICAgICAgXCJjb21tdW5pdHlJZFwiOiBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSxcbiAgICAgICAgICAgIFwiYXBwbGljYXRpb25JZFwiOiBhcHAuU0NPUEUuYXBwbGljYXRpb25JZCxcbiAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IF9XRkluc3RhbmNlLnByb2ZpbGUsXG4gICAgICAgICAgICBcIm1lc3NhZ2VcIjogXCJcIixcbiAgICAgICAgICAgIFwic3VicHJvZmlsZUlkXCI6IHN1YnByb2ZpbGVJZCxcbiAgICAgICAgICAgIFwibWVzc2FnZVR5cGVcIjogXCJpbmZvXCIsXG4gICAgICAgICAgICBcImNyZWF0ZWREYXRlVGltZVwiOiBtb21lbnQoKS5mb3JtYXQoKSxcbiAgICAgICAgICAgIFwic2VuZGVyVXNlcklkXCI6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkLFxuICAgICAgICAgICAgXCJub3RpZmljYXRpb25cIjoge1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJwcm9maWxlXCI6IHtcbiAgICAgICAgICAgICAgICBcImFjdGlvblwiOiBcImRlbGV0ZVByb2ZpbGVcIixcbiAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBwcm9maWxlSWRcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2cod29ya2VyT2JqZWN0KTtcbiAgICAgICAgZGFvLnVwc2VydCh3b3JrZXJPYmplY3QpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJXb3JrZXIgT2JqZWN0IHN1Ym1pdHRlZCBmb3IgcHJvZmlsZShcIiArIHByb2ZpbGVJZCArIFwiKSBkZWxldGlvbi5cIik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgIHJlamVjdChkYXRhKTtcbiAgICAgICAgfSk7XG5cbiAgICB9KTtcblxufTtcblxuZnVuY3Rpb24gY3JlYXRlUHJvZmlsZShhcmdzKSB7XG5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBhcmdzWzFdIHx8IHt9O1xuXG4gICAgdmFyIGNvbW11bml0eUlkID0gX1dGSW5zdGFuY2UuY29tbXVuaXR5SWQ7XG4gICAgdmFyIHByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgbGlicmFyeS5jcmVhdGVQcm9maWxlRG9jdW1lbnRzKGNvbW11bml0eUlkLCBwcm9maWxlSWQpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuXG4gICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBjcmVhdGVkIHN1Y2Nlc3NmdWxseS4nLCBkYXRhKTtcbiAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG5cbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgICAgICAgIHZhciBmYWlsdXJlID0gdXRpbC5zdWNjZXNzKCdFUlJPUjogUHJvZmlsZSBjcmVhdGlvbiBmYWlsZWQnICsgZXJyWzBdLm1lc3NhZ2UsIHt9KTtcbiAgICAgICAgICAgIHJlamVjdChmYWlsdXJlKTtcblxuICAgICAgICB9KTtcblxuICAgIH0pO1xufTtcblxuZnVuY3Rpb24gc2V0RHJhZnQoYXJncykge1xuXG4gICAgdmFyIF9XRkluc3RhbmNlID0gYXJnc1swXSB8fCB7fTtcblxuICAgIHZhciBjb21tdW5pdHlJZCA9IF9XRkluc3RhbmNlLmNvbW11bml0eUlkO1xuICAgIHZhciBwcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgIHZhciB1dWlkID0gYXJnc1syXSB8fCAnJztcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICB2YXIgc3ViUHJvY2Vzc0luc3RhbmNlID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgIHZhciBpbmRpY2F0b3JJbnN0YW5jZXMgPSBzdWJQcm9jZXNzSW5zdGFuY2UuaW5kaWNhdG9ycztcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluZGljYXRvckluc3RhbmNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBpbmRpY2F0b3JJbnN0YW5jZXNbaV0uaW5zdGFuY2VzWzBdLnV1aWQ7XG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9ySW5zdGFuY2UgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICBpbmRpY2F0b3JJbnN0YW5jZS5jb250cm9sLmRyYWZ0ID0gdHJ1ZTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXNvbHZlKFwiU2V0IERyYWZ0IFN1Y2Nlc3NcIiwgaW5kaWNhdG9ySW5zdGFuY2VzKTtcblxuICAgIH0pO1xufTtcblxuZnVuY3Rpb24gc2V0VW5EcmFmdChhcmdzKSB7XG5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBhcmdzWzBdIHx8IHt9O1xuXG4gICAgdmFyIGNvbW11bml0eUlkID0gX1dGSW5zdGFuY2UuY29tbXVuaXR5SWQ7XG4gICAgdmFyIHByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgdmFyIHV1aWQgPSBhcmdzWzJdIHx8ICcnO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIHZhciBzdWJQcm9jZXNzSW5zdGFuY2UgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgdmFyIGluZGljYXRvckluc3RhbmNlcyA9IHN1YlByb2Nlc3NJbnN0YW5jZS5pbmRpY2F0b3JzO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5kaWNhdG9ySW5zdGFuY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9yVVVJRCA9IGluZGljYXRvckluc3RhbmNlc1tpXS5pbnN0YW5jZXNbMF0udXVpZDtcbiAgICAgICAgICAgIHZhciBpbmRpY2F0b3JJbnN0YW5jZSA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIGluZGljYXRvckluc3RhbmNlLmNvbnRyb2wuZHJhZnQgPSBmYWxzZTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXNvbHZlKFwiU2V0IERyYWZ0IFN1Y2Nlc3NcIiwgaW5kaWNhdG9ySW5zdGFuY2VzKTtcblxuICAgIH0pO1xufTtcblxuZnVuY3Rpb24gc2F2ZShpbmRpY2F0b3IpIHtcbiAgICB2YXIgY29tcGxldGVkID0gW107XG4gICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgICAgY29tcGxldGU6IHRydWUsXG4gICAgICAgIGRhdGE6IFtdXG4gICAgfTtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gaW5kaWNhdG9yIHNldCBzYXZlZCBzdWNjZXNzZnVsbHkuJywgcmVzdWx0KTtcbiAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIHN1Ym1pdChmb3JtKSB7XG4gICAgdmFyIGNvbXBsZXRlZCA9IFtdO1xuICAgIHZhciByZXN1bHQgPSB7XG4gICAgICAgIGNvbXBsZXRlOiB0cnVlLFxuICAgICAgICBkYXRhOiBbXVxuICAgIH07XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdGb3JtIHN1Ym1pdHRlZCBzdWNjZXNzZnVsbHkuJywgcmVzdWx0KTtcbiAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIGF1dGhvcmlzZShmb3JtKSB7XG4gICAgdmFyIGNvbXBsZXRlZCA9IFtdO1xuICAgIHZhciByZXN1bHQgPSB7XG4gICAgICAgIGNvbXBsZXRlOiB0cnVlLFxuICAgICAgICBkYXRhOiBbXVxuICAgIH07XG5cbiAgICB2YXIgcHJvY2Vzc0lkID0gZm9ybVswXSB8fCAnJztcblxuICAgIHZhciBzdWJQcm9jZXNzID0gZm9ybVsxXSB8fCB7fTtcblxuICAgIHZhciBzdWJQcm9jZXNzSWQgPSBzdWJQcm9jZXNzLl9pZDtcblxuICAgIHZhciBwcm9jZXNzU2VxID0gZm9ybVsyXSB8fCAnJztcblxuICAgIHZhciBzdWJQcm9jZXNzU2VxID0gZm9ybVszXSB8fCAnJztcblxuICAgIHZhciBfV0ZJbnN0YW5jZSA9IGZvcm1bNF0gfHwge307XG5cbiAgICB2YXIgc3ViUHJvY2Vzc1VVSUQgPSBmb3JtWzZdIHx8ICcnO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIC8vdmFyIHN1YlByb2Nlc3NVVUlEID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbaWQgZXEgJ1wiICsgcHJvY2Vzc0lkICsgXCInIGFuZCBzZXEgZXEgJ1wiICsgcHJvY2Vzc1NlcSArIFwiJ10vc3ViUHJvY2Vzc2VzW2lkIGVxICdcIiArIHN1YlByb2Nlc3NJZCArIFwiJyBhbmQgc2VxIGVxICdcIiArIHN1YlByb2Nlc3NTZXEgKyBcIiddL3V1aWRcIiwgX1dGSW5zdGFuY2UuaW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgdmFyIHNwSW5kaWNhdG9ycyA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzVVVJRCArIFwiJ10vaW5kaWNhdG9ycy9pbnN0YW5jZXMvdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pO1xuICAgICAgICB2YXIgaXRlbXNUb1Byb2Nlc3MgPSBzcEluZGljYXRvcnMubGVuZ3RoO1xuICAgICAgICB2YXIgdXBkYXRlZE9iamVjdHNBcnJheSA9IFtdO1xuICAgICAgICB2YXIgdGVtcEFycmF5ID0gW107XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzcEluZGljYXRvcnMubGVuZ3RoOyBpKyspIHtcblxuICAgICAgICAgICAgZ2F0ZWtlZXBlci5hdXRob3Jpc2Uoc3BJbmRpY2F0b3JzW2ldKS50aGVuKGZ1bmN0aW9uKGF1dGhvcmlzZWRSZXR1cm4pIHtcblxuICAgICAgICAgICAgICAgIGdhdGVrZWVwZXIucGVyc2lzdChhdXRob3Jpc2VkUmV0dXJuKS50aGVuKGZ1bmN0aW9uKHNhdmVkQXJyYXkpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgdXVpZFNhdmVkSW5kaWNhdG9yID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGMgPSAwOyBjIDwgc2F2ZWRBcnJheS5sZW5ndGg7IGMrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzYXZlZEFycmF5W2NdLmlkLmVuZHNXaXRoKCc6YXBwcm92ZWQnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV1aWRTYXZlZEluZGljYXRvciA9IHNhdmVkQXJyYXlbY10uaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGRhby5nZXQodXVpZFNhdmVkSW5kaWNhdG9yKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9XRkluc3RhbmNlLmluZGljYXRvcnMubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNUb1Byb2Nlc3MtLTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXRlbXNUb1Byb2Nlc3MgPT0gMCkge1xuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJzaXN0RGF0YSgnaW5kaWNhdG9ycycsIF9XRkluc3RhbmNlLCBzdWJQcm9jZXNzVVVJRCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdGb3JtIGF1dGhvcmlzZWQgc3VjY2Vzc2Z1bGx5LicsIHVwZGF0ZWRPYmplY3RzQXJyYXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZhaWx1cmUgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gYXV0aG9yaXNlZCBwZXJzaXN0IGZhaWxlZC4nICsgZXJyWzBdLm1lc3NhZ2UsIHt9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChmYWlsdXJlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmb3VuZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IF9XRkluc3RhbmNlLmluZGljYXRvcnMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3IgPSBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzW2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGljYXRvci5faWQgPT0gZGF0YS5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgY3VycmVudCBpdGVtIGZyb20gdGhlIGFycmF5IGFuZCBhZGQgdGhlIHVwZGF0ZWQgcHJvY2Vzc01vZGVsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wQXJyYXkucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9fV0ZJbnN0YW5jZS5pbmRpY2F0b3JzLnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtc1RvUHJvY2Vzcy0tO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1zVG9Qcm9jZXNzID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kTGVuZ3RoID0gX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBMZW5ndGggPSB0ZW1wQXJyYXkubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgcCA9IDA7IHAgPCBpbmRMZW5ndGg7IHArKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcE9iaiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBxID0gMDsgcSA8IHRlbXBMZW5ndGg7IHErKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9XRkluc3RhbmNlLmluZGljYXRvcnNbcF0uX2lkID09IHRlbXBBcnJheVtxXS5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wT2JqID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRlbXBPYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBBcnJheS5wdXNoKF9XRkluc3RhbmNlLmluZGljYXRvcnNbcF0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzID0gdGVtcEFycmF5O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvdW5kID09IHRydWUgJiYgaXRlbXNUb1Byb2Nlc3MgPT0gMCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcnNpc3REYXRhKCdpbmRpY2F0b3JzJywgX1dGSW5zdGFuY2UsIHN1YlByb2Nlc3NVVUlEKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0Zvcm0gYXV0aG9yaXNlZCBzdWNjZXNzZnVsbHkuJywgdXBkYXRlZE9iamVjdHNBcnJheSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFpbHVyZSA9IHV0aWwuc3VjY2VzcygnRm9ybSBhdXRob3Jpc2VkIHBlcnNpc3QgZmFpbGVkLicgKyBlcnJbMF0ubWVzc2FnZSwge30pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGZhaWx1cmUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9LCBmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgIGl0ZW1zVG9Qcm9jZXNzLS07XG4gICAgICAgICAgICAgICAgaWYgKGl0ZW1zVG9Qcm9jZXNzID09IDApIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBhdXRob3Jpc2VkIHN1Y2Nlc3NmdWxseS4nLCB1cGRhdGVkT2JqZWN0c0FycmF5KTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgIH0pO1xufTtcblxuZnVuY3Rpb24gY2xvc2UoZm9ybSkge1xuICAgIHZhciBjb21wbGV0ZWQgPSBbXTtcbiAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgICBjb21wbGV0ZTogdHJ1ZSxcbiAgICAgICAgZGF0YTogW11cbiAgICB9O1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnRm9ybSBjbG9zZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdCk7XG4gICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgfSk7XG59O1xuXG5cblxuZnVuY3Rpb24gdXBkYXRlSW5kaWNhdG9yKGFyZ3MpIHtcblxuICAgIHZhciBfV0ZJbnN0YW5jZSA9IGFyZ3NbMF0gfHwge307XG5cbiAgICB2YXIgdXVpZCA9IGFyZ3NbMV0gfHwgJyc7XG4gICAgdmFyIHBhdGggPSBhcmdzWzJdIHx8ICcnO1xuICAgIHZhciBkYXRhVmFsdWUgPSBhcmdzWzNdIHx8ICcnO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIHZhciBzZXRJZCA9IHBhdGguc3BsaXQoXCIuXCIsIDEpWzBdO1xuICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW3dvcmtmbG93cy9wcm9jZXNzZXMvc3ViUHJvY2Vzc1VVSUQgPSAnXCIgKyB1dWlkICsgXCInIGFuZCBjYXRlZ29yeS90ZXJtID0gJ1wiICsgc2V0SWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgdmFyIHNxdW90ZSA9IGRhdGFWYWx1ZSArIFwiXCIucmVwbGFjZSgvJy9nLCBcIlxcXFwnXCIpO1xuICAgICAgICB2YXIgZXhwciA9IFwiaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YS5cIiArIHBhdGggKyBcIiA9ICdcIiArIHNxdW90ZSArIFwiJ1wiO1xuICAgICAgICBldmFsKGV4cHIpO1xuICAgICAgICB2YXIgaXRlbXNUb1Byb2Nlc3MgPSAxO1xuICAgICAgICB2YXIgc3R1ZmYgPSBbXTtcbiAgICAgICAgdmFyIG9iaiA9IHt9O1xuXG4gICAgICAgIG9iai5tb2RlbCA9IGluZE9iamVjdDtcbiAgICAgICAgc3R1ZmYucHVzaChvYmopO1xuXG4gICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZC4nLCBzdHVmZik7XG4gICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICB9KTtcbn07XG5cblxuZnVuY3Rpb24gdXBkYXRlSW5kaWNhdG9yV3JhcHBlcihhcmdzKSB7XG5cbiAgICB2YXIgX1dGSW5zdGFuY2UgPSBhcmdzWzBdIHx8IHt9O1xuXG4gICAgdmFyIHV1aWQgPSBhcmdzWzFdIHx8ICcnO1xuICAgIHZhciBwYXRoID0gYXJnc1syXSB8fCAnJztcbiAgICB2YXIgZGF0YVZhbHVlID0gYXJnc1szXSB8fCAnJztcbiAgICB2YXIgaW5kaWNhdG9yU2V0SWQgPSBhcmdzWzRdIHx8ICcnO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG5cbiAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1t3b3JrZmxvd3MvcHJvY2Vzc2VzL3N1YlByb2Nlc3NVVUlEID0gJ1wiICsgdXVpZCArIFwiJyBhbmQgY2F0ZWdvcnkvdGVybSA9ICdcIiArIGluZGljYXRvclNldElkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG5cblxuICAgICAgICB2YXIgc3F1b3RlID0gZGF0YVZhbHVlLnJlcGxhY2UoLycvZywgXCJcXFxcJ1wiKTtcbiAgICAgICAgdmFyIGV4cHIgPSBcImluZE9iamVjdC5cIiArIHBhdGggKyBcIiA9ICdcIiArIHNxdW90ZSArIFwiJ1wiO1xuICAgICAgICBldmFsKGV4cHIpO1xuICAgICAgICB2YXIgaXRlbXNUb1Byb2Nlc3MgPSAxO1xuICAgICAgICB2YXIgc3R1ZmYgPSBbXTtcbiAgICAgICAgdmFyIG9iaiA9IHt9O1xuXG4gICAgICAgIG9iai5tb2RlbCA9IGluZE9iamVjdDtcbiAgICAgICAgc3R1ZmYucHVzaChvYmopO1xuXG4gICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgdXBkYXRlZC4nLCBzdHVmZik7XG4gICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICB9KTtcbn07XG5cbmZ1bmN0aW9uIG1hcmtVcGRhdGVJbmRpY2F0b3IoYXJncykge1xuXG4gICAgdmFyIF9XRkluc3RhbmNlID0gYXJnc1swXSB8fCB7fTtcblxuICAgIHZhciB1dWlkID0gYXJnc1sxXSB8fCAnJztcbiAgICB2YXIgc3RhdHVzID0gYXJnc1syXSB8fCAnJztcbiAgICB2YXIgaW5kaWNhdG9yU2V0SWQgPSBhcmdzWzNdIHx8ICcnO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbd29ya2Zsb3dzL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzVVVJRCA9ICdcIiArIHV1aWQgKyBcIicgYW5kIGNhdGVnb3J5L3Rlcm0gPSAnXCIgKyBpbmRpY2F0b3JTZXRJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgaW5kT2JqZWN0Lm1vZGVsLnBlbmRpbmcuc3RhdHVzID0gc3RhdHVzO1xuICAgICAgICB2YXIgaXRlbXNUb1Byb2Nlc3MgPSAxO1xuICAgICAgICB2YXIgc3R1ZmYgPSBbXTtcbiAgICAgICAgdmFyIG9iaiA9IHt9O1xuICAgICAgICBvYmoubW9kZWwgPSBpbmRPYmplY3Q7XG4gICAgICAgIHN0dWZmLnB1c2gob2JqKTtcblxuICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnSW5kaWNhdG9yIHVwZGF0ZWQuJywgc3R1ZmYpO1xuICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgfSk7XG59O1xuXG5cbmZ1bmN0aW9uIHNldFN0YXR1cyhhcmdzKSB7XG5cblxuICAgIC8vIEN1cnJlbnRseSBzZXR0aW5nIHN0YXR1cyB0byBzdWJwcm9jZXNzIGluc3RhbmNlLiBpdCBzaG91bGQgdXBkYXRlIHNvbWUgZmllbGQgaW4gYXBwUHJvZmlsZSBvciB3aGF0ZXZlciBpbmRpY2F0b3IgdGhlIHByb2ZpbGUgaGFzLlxuICAgIHZhciBfV0ZJbnN0YW5jZSA9IGFyZ3NbMF0gfHwge307XG4gICAgdmFyIHV1aWQgPSBhcmdzWzFdIHx8ICcnO1xuICAgIHZhciBzdGF0dXMgPSBhcmdzWzJdIHx8ICcnO1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIHZhciBzdWJQcm9jZXNzSW5zdGFuY2UgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgc3ViUHJvY2Vzc0luc3RhbmNlLnN0ZXAubWVzc2FnZSA9IHN0YXR1cztcblxuICAgICAgICByZXNvbHZlKFwiU2V0IHByb2ZpbGUgc3RhdHVzIFN1Y2Nlc3NcIiwgc3ViUHJvY2Vzc0luc3RhbmNlKTtcblxuICAgIH0pO1xuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuICAgIGNyZWF0ZTogY3JlYXRlLFxuICAgIHNhdmU6IHNhdmUsXG4gICAgc3VibWl0OiBzdWJtaXQsXG4gICAgYXV0aG9yaXNlOiBhdXRob3Jpc2UsXG4gICAgY2xvc2U6IGNsb3NlLFxuICAgIHNldERyYWZ0OiBzZXREcmFmdCxcbiAgICBzZXRVbkRyYWZ0OiBzZXRVbkRyYWZ0LFxuICAgIGNyZWF0ZVByb2ZpbGU6IGNyZWF0ZVByb2ZpbGUsXG4gICAgc2V0SW5zdGFuY2VUaXRsZTogc2V0SW5zdGFuY2VUaXRsZSxcbiAgICBkZWxldGVQcm9maWxlOiBkZWxldGVQcm9maWxlLFxuICAgIHVwZGF0ZUluZGljYXRvcjogdXBkYXRlSW5kaWNhdG9yLFxuICAgIG1hcmtVcGRhdGVJbmRpY2F0b3I6IG1hcmtVcGRhdGVJbmRpY2F0b3IsXG4gICAgdXBkYXRlSW5kaWNhdG9yV3JhcHBlcjogdXBkYXRlSW5kaWNhdG9yV3JhcHBlclxuXG59IiwiJ3VzZSBzdHJpY3QnO1xuXG5cbmZ1bmN0aW9uIGdldExhbmd1YWdlTWVzc2FnZShtZXNzYWdlKSB7XG5cbiAgICB2YXIgbGFuZ3VhZ2UgPSBzZXJ2aWNlLmdldExhbmd1YWdlKCk7XG4gICAgdmFyIHJlcyA9IGV2YWwoXCJtZXNzYWdlLmkxOG4uXCIgKyBsYW5ndWFnZSk7XG4gICAgcmV0dXJuIHJlcztcblxufTtcblxuZnVuY3Rpb24gZ2V0Tm9kZVZhbHVlKGRhdGEsIF9XRkluc3RhbmNlLCB1dWlkKSB7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgaWYgKGRhdGEudmFsdWUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgIHZhciBpbnB1dERhdGFUeXBlID0gJ3N0cmluZyc7XG5cbiAgICAgICAgICAgIGlmIChkYXRhLnZhbHVlLmRhdGF0eXBlLmRhdGFUeXBlICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGlucHV0RGF0YVR5cGUgPSBkYXRhLnZhbHVlLmRhdGF0eXBlLmRhdGFUeXBlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbnB1dERhdGFUeXBlID0gZGF0YS52YWx1ZS5kYXRhdHlwZTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICB2YXIgaW5wdXRWYWx1ZSA9IGRhdGEudmFsdWUuZGF0YTtcblxuICAgICAgICAgICAgaWYgKGlucHV0RGF0YVR5cGUgPT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKE51bWJlcihpbnB1dFZhbHVlKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YVR5cGUgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGlucHV0VmFsdWUpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGFUeXBlID09ICdpbnRlZ2VyJykge1xuICAgICAgICAgICAgICAgIHJlc29sdmUocGFyc2VJbnQoaW5wdXRWYWx1ZSkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChpbnB1dERhdGFUeXBlID09ICdkZWNpbWFsJykge1xuICAgICAgICAgICAgICAgIHJlc29sdmUocGFyc2VGbG9hdChpbnB1dFZhbHVlKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YVR5cGUgPT0gJ2RhdGUnIHx8IGlucHV0RGF0YVR5cGUgPT0gJ2RhdGVUaW1lJykge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoaW5wdXRWYWx1ZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEluIGNhc2UgZGF0YSB0eXBlIG5vdCBtYXRjaGVkXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShpbnB1dFZhbHVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGVsc2UgaWYgKGRhdGEuaW5kaWNhdG9yVVVJRCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgLy8gQSBjaGFuZ2UgaXMgcmVxdWlyZWQgdG8gbWFrZSBzdXJlIHByb3BlciBzY29wZSBpcyBpZGVudGlmaWVkLlxuICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBudWxsO1xuXG4gICAgICAgICAgICB2YXIgc3VicHJvY2VzcyA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgaWYgKHN1YnByb2Nlc3MuaW5kaWNhdG9ycy5sZW5ndGggPT0gMCkge1xuXG4gICAgICAgICAgICAgICAgaW5kaWNhdG9yVVVJRCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdcIiArIGRhdGEuaW5kaWNhdG9yVVVJRC5pbmRpY2F0b3JTZXRJZCArIFwiJ10vX2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2lkIGVxICdcIiArIGRhdGEuaW5kaWNhdG9yVVVJRC5pbmRpY2F0b3JTZXRJZCArIFwiJ10vaW5zdGFuY2VzL3V1aWRcIiwgc3VicHJvY2Vzcywge30pWzBdO1xuICAgICAgICAgICAgICAgIGlmIChpbmRpY2F0b3JVVUlEID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW2NhdGVnb3J5L3Rlcm0gZXEgJ1wiICsgZGF0YS5pbmRpY2F0b3JVVUlELmluZGljYXRvclNldElkICsgXCInXS9faWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cblxuXG4gICAgICAgICAgICByZXNvbHZlKGluZGljYXRvclVVSUQpO1xuXG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YS5pbmRpY2F0b3IgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgZGF0YS5pbmRpY2F0b3IuaW5kaWNhdG9yU2V0SWQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIHhwYXRoID0gJy9tb2RlbC9wZW5kaW5nL2RhdGEvJyArIGRhdGEuaW5kaWNhdG9yLmluZGljYXRvclNldElkICsgJy8nICsgZGF0YS5pbmRpY2F0b3IuZWxlbWVudElkO1xuXG4gICAgICAgICAgICB2YXIgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3NUeXBlID0gSlNPTi54cGF0aChcIi9jb25maWcvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tfaWQgZXEgL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWRdL3R5cGVcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuXG4gICAgICAgICAgICBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCBfaWQgPSAvc3VicHJvY2Vzc2VzW19pZCA9IFwiICsgcGFydCArIFwiXS9faWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHJlcGxhY2VkUGF0aCA9IHJlcGxhY2VBbGwoeHBhdGgsICcjU0VRVUVOQ0UjJywgc2VxKTtcblxuICAgICAgICAgICAgdmFyIHZhbGlkRGF0ZSA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9kYXRlcy92YWxpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIGNvbmNhdFZhbGlkRGF0ZSA9IFwiJ1wiICsgdmFsaWREYXRlICsgXCInXCI7XG4gICAgICAgICAgICB2YXIgbmV3UGF0aCA9IHJlcGxhY2VBbGwocmVwbGFjZWRQYXRoLCAnI0VORF9EQVRFIycsIGNvbmNhdFZhbGlkRGF0ZSk7XG4gICAgICAgICAgICB2YXIgZG90UmVwbGFjZWQgPSByZXBsYWNlQWxsKG5ld1BhdGgsICdbLl0nLCAnLycpO1xuICAgICAgICAgICAgdmFyIHJldFZhbHVlID0gSlNPTi54cGF0aChkb3RSZXBsYWNlZCwgaW5kT2JqZWN0LCB7fSlbMF07XG5cbiAgICAgICAgICAgIHJlc29sdmUocmV0VmFsdWUpO1xuXG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YS5zeXN0ZW0gIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgIHJlc29sdmUoXCJFUlJPUjogVW5pbXBsZW1lbnRlZCBzeXN0ZW0gdHlwZSBmb3VuZC5cIik7XG5cbiAgICAgICAgfSBlbHNlIGlmIChkYXRhLnZhcmlhYmxlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogVGFrZW4gb3V0IG9mIHNjaGVtYVxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NJbnN0YW5jZVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkZXNjcmlwdGlvblwiOiBcInZhbHVlIG9mIHRoZSB2YXJpYWJsZSBzdWJQcm9jZXNzSW5zdGFuY2UgdmFyaWFibGUgY3VycmVudCBzdWJwcm9jZXNzSW5zdGFuY2VcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwic3RlcFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkZXNjcmlwdGlvblwiOiBcInZhbHVlIG9mIHRoZSB2YXJpYWJsZSBpbiB0aGUgY3VycmVudCBzdGVwXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcInN1YlByb2Nlc3NJZFwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJkZXNjcmlwdGlvblwiOiBcInZhbHVlIG9mIHRoZSBjdXJyZW50IGFwcGxpY2FpdG9uIElEXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAqIFxuICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKGRhdGEudmFyaWFibGUucHJvZmlsZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgIHZhciB2YXJpYWJsZU5hbWUgPSBkYXRhLnZhcmlhYmxlLnByb2ZpbGU7XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvZmlsZUlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvZmlsZVZhcmlhYmxlRmlsZU5hbWUgPSBwcm9maWxlSWQgKyAnOnZhcmlhYmxlcyc7XG5cbiAgICAgICAgICAgICAgICBkYW8uZ2V0KHByb2ZpbGVWYXJpYWJsZUZpbGVOYW1lKS50aGVuKGZ1bmN0aW9uKGZpbGUpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gZXZhbCgnZmlsZS4nICsgdmFyaWFibGVOYW1lKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9iaiA9PSAnb2JqZWN0Jykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VxID0gSlNPTi54cGF0aChcImNvdW50KC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3NUeXBlID0gSlNPTi54cGF0aChcIi9jb25maWcvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1tfaWQgZXEgL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaWRdL3R5cGVcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vcHJlY2VkaW5nLXNpYmxpbmc6Om5vZGUoKVtpZCA9IC9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2lkIGFuZCBfaWQgPSAvc3VicHJvY2Vzc2VzW19pZCA9IFwiICsgcGFydCArIFwiXS9faWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlUGF0aCA9IFwiL1wiICsgdmFyaWFibGVOYW1lICsgXCJbc2VxIGVxICdcIiArIHNlcSArIFwiJ10vdmFsdWVcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXRWYWx1ZSA9IEpTT04ueHBhdGgodmFsdWVQYXRoLCBmaWxlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJldFZhbHVlKTtcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygb2JqID09ICdzdHJpbmcnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob2JqKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChcIkVSUk9SOiBQcm9maWxlIHZhcmlhYmxlcyBub3QgZm91bmRcIik7XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZWplY3QoXCJFUlJPUjogVW5pbXBsZW1lbnRlZCBwcm9maWxlIHR5cGUgZm91bmQuXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSBpZiAoZGF0YS5pbmRpY2F0b3JXcmFwcGVyICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZGF0YS5pbmRpY2F0b3JXcmFwcGVyLmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBpbmRpY2F0b3JTZXQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIGVsZW1lbnRwYXRoID0gcmVwbGFjZUFsbChkYXRhLmluZGljYXRvcldyYXBwZXIucGF0aCwgXCJbLl1cIiwgXCIvXCIpXG4gICAgICAgICAgICB2YXIgeHBhdGggPSAnLycgKyBlbGVtZW50cGF0aFxuICAgICAgICAgICAgdmFyIHZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICByZXNvbHZlKHZhbHVlKTtcblxuICAgICAgICB9IGVsc2UgaWYgKGRhdGEuY2FsY3VsYXRlZCAhPSB1bmRlZmluZWQpIHtcblxuXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSAnJztcbiAgICAgICAgICAgIHZhciBzZXBhcmF0b3IgPSBkYXRhLmNhbGN1bGF0ZWQuc2VwYXJhdG9yO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEuY2FsY3VsYXRlZC5lbGVtZW50cy5sZW5ndGggLSAxOyBpKyspIHtcblxuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cyA9IGRhdGEuY2FsY3VsYXRlZC5lbGVtZW50cztcblxuICAgICAgICAgICAgICAgIHZhciBwb3NzaWJsZUl0ZW1zID0gW1wiZWxlbWVudFByb3BlcnR5XCIsIFwiY29uc3RhbnRWYWx1ZVwiLCBcImVsZW1lbnRXcmFwcGVyXCIsIFwiY3VycmVudERhdGVcIiwgXCJyYW5kb21EaWdpdHNcIiwgXCJwcm9maWxlT2JqZWN0RWxlbWVudFwiLCBcInByb2ZpbGVPYmplY3RXcmFwcGVyXCIsIFwiY3VycmVudEZpbmFuY2lhbFllYXJcIl07XG4gICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhlbGVtZW50c1tpXSwgcG9zc2libGVJdGVtcykpIHtcblxuICAgICAgICAgICAgICAgICAgICBjYXNlICdlbGVtZW50UHJvcGVydHknOlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldCA9IGVsZW1lbnRzW2ldLmVsZW1lbnRQcm9wZXJ0eS5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgaW5kaWNhdG9yU2V0ICsgXCInXS9pbnN0YW5jZXMvdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgaW5kaWNhdG9yVVVJRCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cGF0aCA9IHJlcGxhY2VBbGwoZWxlbWVudHNbaV0uZWxlbWVudFByb3BlcnR5LmVsZW1lbnRJZCwgXCJbLl1cIiwgXCIvXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeHBhdGggPSAnL21vZGVsL3BlbmRpbmcvZGF0YS8nICsgaW5kaWNhdG9yU2V0ICsgJy8nICsgZWxlbWVudHBhdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlICsgc2VwYXJhdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cblxuICAgICAgICAgICAgICAgICAgICBjYXNlICdjb25zdGFudFZhbHVlJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IGVsZW1lbnRzW2ldLmNvbnN0YW50VmFsdWUudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlICsgc2VwYXJhdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZWxlbWVudFdyYXBwZXInOlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldCA9IGVsZW1lbnRzW2ldLmVsZW1lbnRXcmFwcGVyLmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBpbmRpY2F0b3JTZXQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRwYXRoID0gcmVwbGFjZUFsbChlbGVtZW50c1tpXS5lbGVtZW50V3JhcHBlci5lbGVtZW50SWQsIFwiWy5dXCIsIFwiL1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy8nICsgZWxlbWVudHBhdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlICsgc2VwYXJhdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cblxuICAgICAgICAgICAgICAgICAgICBjYXNlICdjdXJyZW50RGF0ZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBmb3JtYXREYXRlKG5ldyBEYXRlKCkpICsgc2VwYXJhdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAncmFuZG9tRGlnaXRzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaWdpdHMgPSBlbGVtZW50c1tpXS5yYW5kb21EaWdpdHMuZGlnaXRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmRvbSA9IE1hdGgucmFuZG9tKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXhwID0gTWF0aC5wb3coMTAsIGRpZ2l0cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW50UGFydCA9IChyYW5kb20gKiBleHApIF4gMFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGludFBhcnQgKyBzZXBhcmF0b3I7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBjYXNlICdwcm9maWxlT2JqZWN0RWxlbWVudCc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JTZXQgPSBlbGVtZW50c1tpXS5wcm9maWxlT2JqZWN0RWxlbWVudC5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnYXBwUHJvZmlsZSddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRwYXRoID0gcmVwbGFjZUFsbChlbGVtZW50c1tpXS5wcm9maWxlT2JqZWN0RWxlbWVudC5lbGVtZW50SWQsIFwiWy5dXCIsIFwiL1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy9tb2RlbC9wZW5kaW5nL2RhdGEvJyArIGluZGljYXRvclNldCArICcvJyArIGVsZW1lbnRwYXRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGl0ZW1WYWx1ZSArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Byb2ZpbGVPYmplY3RXcmFwcGVyJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldCA9IGVsZW1lbnRzW2ldLnByb2ZpbGVPYmplY3RXcmFwcGVyLmluZGljYXRvclNldElkO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tjYXRlZ29yeS90ZXJtIGVxICdhcHBQcm9maWxlJ11cIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLnByb2ZpbGVPYmplY3RXcmFwcGVyLndyYXBwZXJFbGVtZW50SWQsIFwiWy5dXCIsIFwiL1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhwYXRoID0gJy8nICsgZWxlbWVudHBhdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlICsgc2VwYXJhdG9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2N1cnJlbnRGaW5hbmNpYWxZZWFyJzpcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0RGF0ZSA9IGVsZW1lbnRzW2ldLmN1cnJlbnRGaW5hbmNpYWxZZWFyLnN0YXJ0RGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGFydE1vbnRoID0gZWxlbWVudHNbaV0uY3VycmVudEZpbmFuY2lhbFllYXIuc3RhcnRNb250aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaW5hbmNpYWxZZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpICsgXCItXCIgKyBzdGFydE1vbnRoICsgXCItXCIgKyBzdGFydERhdGU7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgZmluYW5jaWFsWWVhciArIHNlcGFyYXRvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBpID0gZGF0YS5jYWxjdWxhdGVkLmVsZW1lbnRzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB2YXIgZWxlbWVudHMgPSBkYXRhLmNhbGN1bGF0ZWQuZWxlbWVudHM7XG5cbiAgICAgICAgICAgIHZhciBwb3NzaWJsZUl0ZW1zID0gW1wiZWxlbWVudFByb3BlcnR5XCIsIFwiY29uc3RhbnRWYWx1ZVwiLCBcImVsZW1lbnRXcmFwcGVyXCIsIFwiY3VycmVudERhdGVcIiwgXCJyYW5kb21EaWdpdHNcIiwgXCJwcm9maWxlT2JqZWN0RWxlbWVudFwiLCBcInByb2ZpbGVPYmplY3RXcmFwcGVyXCIsIFwiY3VycmVudEZpbmFuY2lhbFllYXJcIl07XG4gICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGVsZW1lbnRzW2ldLCBwb3NzaWJsZUl0ZW1zKSkge1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnZWxlbWVudFByb3BlcnR5JzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldCA9IGVsZW1lbnRzW2ldLmVsZW1lbnRQcm9wZXJ0eS5pbmRpY2F0b3JTZXRJZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclVVSUQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vaW5kaWNhdG9yc1tpZCBlcSAnXCIgKyBpbmRpY2F0b3JTZXQgKyBcIiddL2luc3RhbmNlcy91dWlkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbX2lkIGVxICdcIiArIGluZGljYXRvclVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50cGF0aCA9IHJlcGxhY2VBbGwoZWxlbWVudHNbaV0uZWxlbWVudFByb3BlcnR5LmVsZW1lbnRJZCwgXCJbLl1cIiwgXCIvXCIpXG4gICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvbW9kZWwvcGVuZGluZy9kYXRhLycgKyBpbmRpY2F0b3JTZXQgKyAnLycgKyBlbGVtZW50cGF0aDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuXG4gICAgICAgICAgICAgICAgY2FzZSAnY29uc3RhbnRWYWx1ZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IGVsZW1lbnRzW2ldLmNvbnN0YW50VmFsdWUudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnZWxlbWVudFdyYXBwZXInOlxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZWxlbWVudHNbaV0uZWxlbWVudFdyYXBwZXIuaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JVVUlEID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHV1aWQgKyBcIiddL2luZGljYXRvcnNbaWQgZXEgJ1wiICsgaW5kaWNhdG9yU2V0ICsgXCInXS9pbnN0YW5jZXMvdXVpZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kT2JqZWN0ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyBpbmRpY2F0b3JVVUlEICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLmVsZW1lbnRXcmFwcGVyLmVsZW1lbnRJZCwgXCJbLl1cIiwgXCIvXCIpXG4gICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvJyArIGVsZW1lbnRwYXRoO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbVZhbHVlID0gSlNPTi54cGF0aCh4cGF0aCwgaW5kT2JqZWN0LCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpdGVtVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cbiAgICAgICAgICAgICAgICBjYXNlICdjdXJyZW50RGF0ZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZSArIGZvcm1hdERhdGUobmV3IERhdGUoKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAncmFuZG9tRGlnaXRzJzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRpZ2l0cyA9IGVsZW1lbnRzW2ldLnJhbmRvbURpZ2l0cy5kaWdpdHM7XG4gICAgICAgICAgICAgICAgICAgIHZhciByYW5kb20gPSBNYXRoLnJhbmRvbSgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXhwID0gTWF0aC5wb3coMTAsIGRpZ2l0cyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbnRQYXJ0ID0gKHJhbmRvbSAqIGV4cCkgXiAwXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBpbnRQYXJ0O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3Byb2ZpbGVPYmplY3RFbGVtZW50JzpcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZWxlbWVudHNbaV0ucHJvZmlsZU9iamVjdEVsZW1lbnQuaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnYXBwUHJvZmlsZSddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLnByb2ZpbGVPYmplY3RFbGVtZW50LmVsZW1lbnRJZCwgXCJbLl1cIiwgXCIvXCIpXG4gICAgICAgICAgICAgICAgICAgIHZhciB4cGF0aCA9ICcvbW9kZWwvcGVuZGluZy9kYXRhLycgKyBpbmRpY2F0b3JTZXQgKyAnLycgKyBlbGVtZW50cGF0aDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3Byb2ZpbGVPYmplY3RXcmFwcGVyJzpcblxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9yU2V0ID0gZWxlbWVudHNbaV0ucHJvZmlsZU9iamVjdFdyYXBwZXIuaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbY2F0ZWdvcnkvdGVybSBlcSAnYXBwUHJvZmlsZSddXCIsIGFwcC5TQ09QRS53b3JrZmxvdywge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHBhdGggPSByZXBsYWNlQWxsKGVsZW1lbnRzW2ldLnByb2ZpbGVPYmplY3RXcmFwcGVyLndyYXBwZXJFbGVtZW50SWQsIFwiWy5dXCIsIFwiL1wiKVxuICAgICAgICAgICAgICAgICAgICB2YXIgeHBhdGggPSAnLycgKyBlbGVtZW50cGF0aDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1WYWx1ZSA9IEpTT04ueHBhdGgoeHBhdGgsIGluZE9iamVjdCwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlICsgaXRlbVZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2N1cnJlbnRGaW5hbmNpYWxZZWFyJzpcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnREYXRlID0gZWxlbWVudHNbaV0uY3VycmVudEZpbmFuY2lhbFllYXIuc3RhcnREYXRlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnRNb250aCA9IGVsZW1lbnRzW2ldLmN1cnJlbnRGaW5hbmNpYWxZZWFyLnN0YXJ0TW9udGg7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmaW5hbmNpYWxZZWFyID0gbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpICsgXCItXCIgKyBzdGFydE1vbnRoICsgXCItXCIgKyBzdGFydERhdGU7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWUgKyBmaW5hbmNpYWxZZWFyO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuXG5cblxuICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG5cbiAgICAgICAgfSBlbHNlIGlmIChkYXRhLnN1YlByb2Nlc3MgIT0gdW5kZWZpbmVkKSB7XG5cblxuICAgICAgICAgICAgdmFyIHBhdGggPSBkYXRhLnN1YlByb2Nlc3MucGF0aDtcblxuICAgICAgICAgICAgdmFyIGFyciA9IHBhdGguc3BsaXQoXCIuXCIpO1xuICAgICAgICAgICAgdmFyIHBhdGhJdGVtcyA9IFwiXCI7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHBhdGhJdGVtcyA9IHBhdGhJdGVtcyArIFwiWydcIiArIGFycltpXSArIFwiJ11cIjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHN1YnByb2Nlc3MgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGV2YWwoXCJzdWJwcm9jZXNzXCIgKyBwYXRoSXRlbXMpO1xuICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSlcblxuXG4gICAgICAgIH1cblxuICAgIH0pO1xuXG5cblxufTtcblxuXG5mdW5jdGlvbiByZXBsYWNlQWxsKHR4dCwgcmVwbGFjZSwgd2l0aF90aGlzKSB7XG4gICAgaWYgKHR5cGVvZiB0eHQucmVwbGFjZSAhPSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlcGxhY2UgKyAnICcgKyB3aXRoX3RoaXMpO1xuICAgICAgICBjb25zb2xlLmxvZyh0eHQpO1xuICAgIH1cbiAgICByZXR1cm4gdHh0LnJlcGxhY2UobmV3IFJlZ0V4cChyZXBsYWNlLCAnZycpLCB3aXRoX3RoaXMpO1xufVxuXG5mdW5jdGlvbiBmb3JtYXREYXRlKGRhdGUpIHtcblxuICAgIHZhciBkYXkgPSBkYXRlLmdldERhdGUoKTtcbiAgICB2YXIgbW9udGhJbmRleCA9IGRhdGUuZ2V0TW9udGgoKTtcbiAgICB2YXIgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcblxuICAgIHJldHVybiBkYXkgKyAnLScgKyBtb250aEluZGV4ICsgJy0nICsgeWVhcjtcbn1cblxuXG5mdW5jdGlvbiBjb21wYXJlKHN1YmplY3QsIG9wZXJhdG9yLCB2YWx1ZSkge1xuICAgIHN3aXRjaCAob3BlcmF0b3IpIHtcbiAgICAgICAgY2FzZSAnPic6XG4gICAgICAgICAgICByZXR1cm4gc3ViamVjdCA+IHZhbHVlO1xuICAgICAgICBjYXNlICc8JzpcbiAgICAgICAgICAgIHJldHVybiBzdWJqZWN0IDwgdmFsdWU7XG4gICAgICAgIGNhc2UgJz49JzpcbiAgICAgICAgICAgIHJldHVybiBzdWJqZWN0ID49IHZhbHVlO1xuICAgICAgICBjYXNlICc8PSc6XG4gICAgICAgICAgICByZXR1cm4gc3ViamVjdCA8PSB2YWx1ZTtcbiAgICAgICAgY2FzZSAnPT0nOlxuICAgICAgICAgICAgcmV0dXJuIHN1YmplY3QgPT0gdmFsdWU7XG4gICAgICAgIGNhc2UgJyE9JzpcbiAgICAgICAgICAgIHJldHVybiBzdWJqZWN0ICE9IHZhbHVlO1xuICAgIH1cbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSB7XG5cbiAgICBnZXRMYW5ndWFnZU1lc3NhZ2U6IGdldExhbmd1YWdlTWVzc2FnZSxcbiAgICBnZXROb2RlVmFsdWU6IGdldE5vZGVWYWx1ZSxcbiAgICBjb21wYXJlOiBjb21wYXJlXG5cbn0iLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlsID0gcmVxdWlyZSgndXRpbGl0eScpO1xuXG4vKipcbiAqIFVzZXIgSW50ZXJmYWNlIE1vZHVsZVxuICpcbiAqIEBtb2R1bGUgbGliL3VpXG4gKiBAYXV0aG9yIEJyZW50IEdvcmRvblxuICogQHZlcnNpb24gMC4xLjBcbiAqIEBkZXNjcmlwdGlvbiB0ZXN0IGRlc2NyaXB0aW9uXG4gKlxuICovXG5cbiAvKipcbiAgKiBHZXQgYWxsIHByb2Nlc3Mgc3ViLXByb2Nlc3NlcyB1c2VyIGludGVyZmFjZSBkYXRhXG4gICpcbiAgKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gcHJvY2VzcyBpZFxuICAqIEBwYXJhbSB7c3RyaW5nfSBsYW5nIC0gdGhlIHVzZXIgcHJlZmZlcmVkIGxhbmdhdWdlXG4gICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAgKlxuICAqIEBleGFtcGxlICcnXG4gICpcbiAgKiBAcmV0dXJuICcnXG4gICpcbiAgKi9cbiBmdW5jdGlvbiBnZXRQcm9jZXNzKHByb2Nlc3NJZCwgbGFuZywgX1dGSW5zdGFuY2Upe1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhciBwcm9jZXNzTW9kZWwgPSBbXTtcbiAgICAgIHZhciBwcm9jZXNzSW5zdGFuY2UgPSBbXTtcbiAgICBcdF9XRkluc3RhbmNlLmluc3RhbmNlLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ocHJvY2Vzc0l0ZW0pe1xuICAgIFx0XHRpZiAocHJvY2Vzc0l0ZW0uaWQgPT0gcHJvY2Vzc0lkKSB7XG4gICAgXHRcdFx0cHJvY2Vzc0luc3RhbmNlID0gcHJvY2Vzc0l0ZW07XG4gICAgXHRcdH1cbiAgICBcdH0pXG4gICAgICAvLyBjb25zb2xlLmxvZyhwcm9jZXNzSW5zdGFuY2Uuc3ViUHJvY2Vzc2VzLmxlbmd0aCk7XG4gICAgICB1dGlsLnN5bmNMb29wKHByb2Nlc3NJbnN0YW5jZS5zdWJQcm9jZXNzZXMubGVuZ3RoLCBmdW5jdGlvbihsb29wKXtcbiAgXHRcdFx0dmFyIGNvdW50ZXIgPSBsb29wLml0ZXJhdGlvbigpO1xuICAgICAgICB2YXIgcHJvY2Vzc1NlcSA9IHByb2Nlc3NJbnN0YW5jZS5zZXE7XG4gICAgICAgIHZhciBzdWJQcm9jZXNzSWQgPSBwcm9jZXNzSW5zdGFuY2Uuc3ViUHJvY2Vzc2VzW2NvdW50ZXJdLmlkO1xuICAgICAgICB2YXIgc3ViUHJvY2Vzc1NlcSA9IHByb2Nlc3NJbnN0YW5jZS5zdWJQcm9jZXNzZXNbY291bnRlcl0uc2VxO1xuICAgICAgICBnZXRTdWJQcm9jZXNzKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBsYW5nLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihtb2RlbCl7XG4gICAgICAgICAgLy8gY29uc29sZS5sb2cobW9kZWwpO1xuICAgICAgICAgIHByb2Nlc3NNb2RlbC5wdXNoKG1vZGVsKTtcbiAgICAgICAgICBsb29wLm5leHQoKTtcbiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhwcm9jZXNzTW9kZWwpO1xuICBcdFx0XHR9LCBmdW5jdGlvbihlcnIpe1xuICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2Nlc3NNb2RlbCk7XG4gIFx0XHRcdFx0bG9vcC5icmVhaygpO1xuICBcdFx0XHRcdHJlamVjdChlcnIpO1xuICBcdFx0XHR9KTtcbiAgXHRcdH0sIGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2Nlc3NNb2RlbCk7XG4gIFx0XHRcdHJlc29sdmUocHJvY2Vzc01vZGVsKTtcbiAgXHRcdH0pO1xuICAgIH0gY2F0Y2goZXJyKXtcbiAgICAgIHJlamVjdChlcnIpO1xuICAgIH1cbiAgfSlcbn07XG5cbiAvKipcbiAgKiBHZXQgU3ViUHJvY2VzcyB1c2VyIGludGVyZmFjZSBkYXRhXG4gICpcbiAgKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gcHJvY2VzcyBpZFxuICAqIEBwYXJhbSB7bnVtYmVyfSBwcm9jZXNzU2VxIC0gdGhlIFdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgc2VxXG4gICogQHBhcmFtIHtzdHJpbmd9IHN1YlByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN1Yi1wcm9jZXNzIGlkXG4gICogQHBhcmFtIHtudW1iZXJ9IHN1YlByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2Ugc3ViLXByb2Nlc3Mgc2VxXG4gICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAgKlxuICAqIEBleGFtcGxlICcnXG4gICpcbiAgKiBAcmV0dXJuICcnXG4gICpcbiAgKi9cbmZ1bmN0aW9uIGdldFN1YlByb2Nlc3MocHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIGxhbmcsIF9XRkluc3RhbmNlKXtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHRyeSB7XG4gICAgICB2YXIgbW9kZWwgPSB7XG4gICAgICAgIGlkOiAnJyxcbiAgICAgICAgc2VxOiAnJyxcbiAgICAgICAgbmFtZTogJycsXG4gICAgICAgIGhlbHA6ICcnLFxuICAgICAgICBkYXRlczogJycsXG4gICAgICAgIHN0ZXA6ICcnXG4gICAgICB9O1xuICAgICAgdmFyIHN1YlByb2Nlc3MgPSBbXTtcbiAgICBcdHZhciBzdWJQcm9jZXNzQ29uZiA9IFtdO1xuICAgIFx0X1dGSW5zdGFuY2UuaW5zdGFuY2UucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihwcm9jZXNzSXRlbSl7XG4gICAgXHRcdGlmIChwcm9jZXNzSXRlbS5pZCA9PSBwcm9jZXNzSWQgJiYgcHJvY2Vzc0l0ZW0uc2VxID09IHByb2Nlc3NTZXEpIHtcbiAgICBcdFx0XHR2YXIgc3BMZW5ndGggPSBwcm9jZXNzSXRlbS5zdWJQcm9jZXNzZXMubGVuZ3RoO1xuICAgIFx0XHRcdHByb2Nlc3NJdGVtLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzc0l0ZW0pe1xuICAgIFx0XHRcdFx0aWYgKHN1YlByb2Nlc3NJdGVtLmlkID09IHN1YlByb2Nlc3NJZCAmJiBzdWJQcm9jZXNzSXRlbS5zZXEgPT0gc3ViUHJvY2Vzc1NlcSAmJiBzdWJQcm9jZXNzSXRlbS5jb21wbGV0ZSA9PSBmYWxzZSkge1xuICAgIFx0XHRcdFx0XHRzdWJQcm9jZXNzID0gc3ViUHJvY2Vzc0l0ZW07XG4gICAgXHRcdFx0XHR9XG4gICAgXHRcdFx0fSlcbiAgICBcdFx0fVxuICAgIFx0fSlcbiAgICBcdC8vIEdldCB0aGUgY3VycmVudCBzdWJQcm9jZXNzIGNvbmZpZ3VyYXRpb25cbiAgICBcdF9XRkluc3RhbmNlLmNvbmZpZy5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHByb2Nlc3NDb25maWcpe1xuICAgIFx0XHRpZiAocHJvY2Vzc0NvbmZpZy5faWQgPT0gcHJvY2Vzc0lkKSB7XG4gICAgXHRcdFx0cHJvY2Vzc0NvbmZpZy5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NDb25maWcpe1xuICAgIFx0XHRcdFx0aWYgKHN1YlByb2Nlc3NDb25maWcuX2lkID09IHN1YlByb2Nlc3NJZCkge1xuICAgIFx0XHRcdFx0XHRzdWJQcm9jZXNzQ29uZiA9IHN1YlByb2Nlc3NDb25maWc7XG4gICAgXHRcdFx0XHR9XG4gICAgXHRcdFx0fSlcbiAgICBcdFx0fVxuICAgIFx0fSlcbiAgICAgIC8vIFVwZGF0ZSB0aGUgbW9kZWxcbiAgICAgIG1vZGVsLmlkID0gc3ViUHJvY2Vzc0NvbmYuX2lkO1xuICAgICAgbW9kZWwuc2VxID0gc3ViUHJvY2Vzcy5zZXE7XG4gICAgICBtb2RlbC5uYW1lID0gdXRpbC5nZXROYW1lKHN1YlByb2Nlc3NDb25mLm5hbWUsIGxhbmcpO1xuICAgICAgbW9kZWwuaGVscCA9IHV0aWwuZ2V0TmFtZShzdWJQcm9jZXNzQ29uZi5oZWxwLCBsYW5nKTtcbiAgICAgIG1vZGVsLmRhdGVzID0gc3ViUHJvY2Vzcy5kYXRlcztcbiAgICAgIG1vZGVsLnN0ZXAgPSBzdWJQcm9jZXNzLnN0ZXA7XG4gICAgICByZXNvbHZlKG1vZGVsKTtcbiAgICB9IGNhdGNoKGVycikge1xuICAgICAgcmVqZWN0KGVycik7XG4gICAgfVxuICB9KVxufTtcblxuXG5cblxuZnVuY3Rpb24gcHJlcGFyZU5vdGlmaWNhdGlvblNjcmVlbigpe1xuXG4gIFwiXCJcbn07XG5cbiBtb2R1bGUuZXhwb3J0cyA9IHtcblxuICBnZXRQcm9jZXNzOiBnZXRQcm9jZXNzXG5cbiB9XG4iLCIndXNlIHN0cmljdCc7XG5cblxuZnVuY3Rpb24gZ2V0KCkge1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgfSk7XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuXG4gICAgZ2V0OiBnZXRcblxufSIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWwgPSByZXF1aXJlKCd1dGlsaXR5Jyk7XG52YXIgYWN0aW9uc01vZHVsZSA9IHJlcXVpcmUoJy4vYWN0aW9ucycpO1xudmFyIGhlbHBlciA9IHJlcXVpcmUoJy4vaGVscGVyJyk7XG52YXIgZm9ybSA9IHJlcXVpcmUoJy4vZm9ybScpO1xuXG4vKipcbiAqIFByb2Nlc3MgTW9kdWxlXG4gKlxuICogQG1vZHVsZSBsaWIvcHJvY2Vzc1xuICogQGF1dGhvciBIYXNhbiBBYmJhc1xuICogQHZlcnNpb24gMC4yLjFcbiAqIEBkZXNjcmlwdGlvbiBXb3JrZmxvdyBpbXBsZW1lbnRhdGlvbiBjaGFuZ2VkIGFzIHBlciBuZXcgc2NoZW1hIGltcGxlbWVudGF0aW9uXG4gKlxuICovXG5cbi8qKlxuICogQ291bnQgYW4gYXJyYXkgb2YgaXRlbXNcbiAqXG4gKiBAcGFyYW0ge0FycmF5fSBhcnIgLSB0aGUgYXJyYXkgZGF0YVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gY291bnQoYXJyKSB7XG4gICAgaWYgKGFyciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBhcnIubGVuZ3RoO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cblxufTtcblxuLyoqXG4gKiBQcm9jZXNzIHByZS1yZXF1aXNpdGVzXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IHByZXJlcXVpc2l0ZXMgLSB0aGUgcHJlLXJlcXVpc2l0ZXMgY29uZmlnIGRhdGFcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIHByZVJlcXVpc2l0ZXMocHJlcmVxdWlzaXRlcywgX1dGSW5zdGFuY2UsIHNwdXVpZCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgLy8gVW5jb21tZW50IGJlbG93IHNlY3Rpb24gd2hlbiByZWFkeSB0byBpbXBsZW1lbnRcbiAgICAgICAgdmFyIGNvbXBsZXRlZCA9IFtdO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdXRpbC5zeW5jTG9vcChwcmVyZXF1aXNpdGVzLmxlbmd0aCwgZnVuY3Rpb24obG9vcCkge1xuICAgICAgICAgICAgICAgIHZhciBjb3VudGVyID0gbG9vcC5pdGVyYXRpb24oKTtcbiAgICAgICAgICAgICAgICBwcmVSZXF1aXNpdGUocHJlcmVxdWlzaXRlc1tjb3VudGVyXSwgX1dGSW5zdGFuY2UsIHNwdXVpZCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGFsbCBwcmUtcmVxdWlzaXRlcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LlxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWQucHVzaCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgbG9vcC5uZXh0KCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZC5wdXNoKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgbG9vcC5icmVhaygpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChjb21wbGV0ZWQuZXZlcnkoQm9vbGVhbikpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1ByZS1yZXF1aXNpdGVzIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywge30pO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGUHJlUmVxdWlzaXRlRXJyb3InLCAnTm90IGFsbCBwcmUtcmVxdWlzaXRlcyBwYXNzZWQuJyk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgcHJlLXJlcXVpc2l0ZSwgZXhlY3V0ZSB0aGUgcHJlLXJlcXVpc2l0ZSBjb25kaXRpb24uXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IHByZXJlcXVpc2l0ZSAtIHRoZSBwcmUtcmVxdWlzaXRlIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZVxuICogUHJvY2Vzcy5wcmVSZXF1aXNpdGUoY29uZmlnLCBjb3VudGVyLCBpbnN0YW5jZSwgZG9jKTtcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBwcmVSZXF1aXNpdGUocHJlcmVxdWlzaXRlLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG5cblxuICAgICAgICBpZiAocHJlcmVxdWlzaXRlLmNoZWNrLm51bWJlclByb2Nlc3NJbnN0YW5jZXMgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgIHZhciBudW1iZXJQcm9jZXNzSW5zdGFuY2VzID0gcHJlcmVxdWlzaXRlLmNoZWNrLm51bWJlclByb2Nlc3NJbnN0YW5jZXM7XG4gICAgICAgICAgICB2YXIgX2ZpbHRlck9wZXJhdG9yID0gbnVtYmVyUHJvY2Vzc0luc3RhbmNlcy5vcGVyYXRvcjtcbiAgICAgICAgICAgIHZhciB4cGF0aE9wZXJhdG9yID0gJyc7XG4gICAgICAgICAgICBzd2l0Y2ggKF9maWx0ZXJPcGVyYXRvcikge1xuICAgICAgICAgICAgICAgIGNhc2UgJ2dyZWF0ZXJUaGFuJzpcbiAgICAgICAgICAgICAgICAgICAgeHBhdGhPcGVyYXRvciA9ICdndCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2xlc3NUaGFuJzpcbiAgICAgICAgICAgICAgICAgICAgeHBhdGhPcGVyYXRvciA9ICdsdCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2dyZWF0ZXJUaGFuRXF1YWwnOlxuICAgICAgICAgICAgICAgICAgICB4cGF0aE9wZXJhdG9yID0gJ2dlJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbGVzc1RoYW5FcXVhbCc6XG4gICAgICAgICAgICAgICAgICAgIHhwYXRoT3BlcmF0b3IgPSAnbGUnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdlcXVhbFRvJzpcbiAgICAgICAgICAgICAgICAgICAgeHBhdGhPcGVyYXRvciA9ICdlcSc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ25vdEVxdWFsVG8nOlxuICAgICAgICAgICAgICAgICAgICB4cGF0aE9wZXJhdG9yID0gJ25lJztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBfc3VicHJvY2Vzc0lkID0gbnVtYmVyUHJvY2Vzc0luc3RhbmNlcy5zdWJQcm9jZXNzSWQ7XG4gICAgICAgICAgICB2YXIgX2ZpbHRlckVsZW1lbnQgPSBcInN0ZXAvc3RhdHVzXCI7XG4gICAgICAgICAgICB2YXIgX2ZpbHRlclZhbHVlID0gbnVtYmVyUHJvY2Vzc0luc3RhbmNlcy50eXBlO1xuICAgICAgICAgICAgdmFyIGlubmVyWHBhdGggPSBcIi9cIiArIF9maWx0ZXJFbGVtZW50ICsgXCJbLiBlcSAnXCIgKyBfZmlsdGVyVmFsdWUgKyBcIiddXCI7XG5cbiAgICAgICAgICAgIHZhciBmdWxsUGF0aCA9IFwiY291bnQoL3N1YnByb2Nlc3Nlc1tpZCBlcSAnXCIgKyBfc3VicHJvY2Vzc0lkICsgXCInXVwiICsgaW5uZXJYcGF0aCArIFwiKVwiO1xuXG4gICAgICAgICAgICB2YXIgcHJlcmVxUHJvY2Vzc1R5cGUgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBfc3VicHJvY2Vzc0lkICsgXCInXS90eXBlXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgcGFydCA9IGxpYnJhcnkuZ2V0U3VicHJvZmlsZVN1YnByb2Nlc3NJZHMoKTtcblxuICAgICAgICAgICAgaWYgKGFwcC5wcm9maWxlLnN1YnByb2ZpbGVJZCAhPSB1bmRlZmluZWQgJiYgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9ICcnICYmIHByZXJlcVByb2Nlc3NUeXBlICE9IHVuZGVmaW5lZCAmJiBwcmVyZXFQcm9jZXNzVHlwZSA9PSBQUk9DRVNTX1RZUEVfU1VCUFJPRklMRSkge1xuICAgICAgICAgICAgICAgIGZ1bGxQYXRoID0gXCJjb3VudCgvc3VicHJvY2Vzc2VzW2lkIGVxICdcIiArIF9zdWJwcm9jZXNzSWQgKyBcIicgYW5kIF9pZCA9IFwiICsgcGFydCArIFwiXVwiICsgaW5uZXJYcGF0aCArIFwiKVwiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc3ViamVjdENvdW50ID0gSlNPTi54cGF0aChmdWxsUGF0aCwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIHZhciBjb3VudFZhbHVlID0gcHJlcmVxdWlzaXRlLmNoZWNrLm51bWJlclByb2Nlc3NJbnN0YW5jZXMuY291bnQ7XG4gICAgICAgICAgICB2YXIgY29tcGFyZSA9IHV0aWwuY29tcGFyZShzdWJqZWN0Q291bnQsIHByZXJlcXVpc2l0ZS5jaGVjay5udW1iZXJQcm9jZXNzSW5zdGFuY2VzLm9wZXJhdG9yLCBwYXJzZUludChjb3VudFZhbHVlKSk7XG5cblxuICAgICAgICAgICAgaWYgKGNvbXBhcmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnUHJlLXJlcXVpc2l0ZXMgcGFzc2VkLicsIHt9KTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gaGVscGVyLmdldExhbmd1YWdlTWVzc2FnZShwcmVyZXF1aXNpdGUubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgdmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZQcmVSZXF1aXNpdGVFcnJvcicsIG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICB9IGVsc2UgaWYgKHByZXJlcXVpc2l0ZS5jaGVjay52YXJpYWJsZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgdmFyIHNjb3BlID0gcHJlcmVxdWlzaXRlLmNoZWNrLnZhcmlhYmxlLnNjb3BlO1xuICAgICAgICAgICAgdmFyIGZpbGVOYW1lID0gJyc7XG5cbiAgICAgICAgICAgIGlmIChzY29wZSA9PSBcInByb2ZpbGVcIikge1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb2ZpbGVJZCA9IF9XRkluc3RhbmNlLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgZmlsZU5hbWUgPSBwcm9maWxlSWQgKyAnOnZhcmlhYmxlcyc7XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2NvcGUgPT0gXCJzdWJQcm9maWxlU3ViUHJvY2Vzc0luc3RhbmNlXCIpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzdWJQcm9maWxlSWQgPSBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQ7XG4gICAgICAgICAgICAgICAgZmlsZU5hbWUgPSBzdWJQcm9maWxlSWQgKyAnOnZhcmlhYmxlcyc7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KFwiRVJST1I6IFNjb3BlICdcIiArIHNjb3BlICsgXCInIG5vdCBpbXBsZW1lbnRlZCBpbiBwcmUtcmVxdWlzaXRlc1wiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZGFvLmdldChmaWxlTmFtZSkudGhlbihmdW5jdGlvbihmaWxlKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgdmFyaWFibGVOYW1lID0gcHJlcmVxdWlzaXRlLmNoZWNrLnZhcmlhYmxlLm5hbWU7XG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IGV2YWwoJ2ZpbGUuJyArIHZhcmlhYmxlTmFtZSk7XG4gICAgICAgICAgICAgICAgdmFyIHN1YmplY3RWYWx1ZUNhbGN1bGF0ZWQ7XG5cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9iaiA9PSAnb2JqZWN0Jykge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSBKU09OLnhwYXRoKFwiY291bnQoL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9wcmVjZWRpbmctc2libGluZzo6bm9kZSgpW2lkID0gL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZF0pXCIsIF9XRkluc3RhbmNlLCB7fSlbMF0gKyAxO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3VicHJvY2Vzc1R5cGUgPSBKU09OLnhwYXRoKFwiL2NvbmZpZy9wcm9jZXNzZXMvc3ViUHJvY2Vzc2VzW19pZCBlcSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXS90eXBlXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0ID0gbGlicmFyeS5nZXRTdWJwcm9maWxlU3VicHJvY2Vzc0lkcygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3VicHJvY2Vzc1R5cGUgPT0gUFJPQ0VTU19UWVBFX1NVQlBST0ZJTEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcSA9IEpTT04ueHBhdGgoXCJjb3VudCgvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3ByZWNlZGluZy1zaWJsaW5nOjpub2RlKClbaWQgPSAvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkIGFuZCBfaWQgPSAvc3VicHJvY2Vzc2VzW19pZCA9IFwiICsgcGFydCArIFwiXS9faWRdKVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdICsgMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWVQYXRoID0gXCIvXCIgKyB2YXJpYWJsZU5hbWUgKyBcIltzZXEgZXEgJ1wiICsgc2VxICsgXCInXS92YWx1ZVwiO1xuICAgICAgICAgICAgICAgICAgICBzdWJqZWN0VmFsdWVDYWxjdWxhdGVkID0gSlNPTi54cGF0aCh2YWx1ZVBhdGgsIGZpbGUsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIG9iaiA9PSAnc3RyaW5nJykge1xuXG4gICAgICAgICAgICAgICAgICAgIHN1YmplY3RWYWx1ZUNhbGN1bGF0ZWQgPSBvYmo7XG5cbiAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgIHZhciBpbnB1dFZhbHVlID0gcHJlcmVxdWlzaXRlLmNoZWNrLnZhcmlhYmxlLnZhbHVlLmRhdGE7XG4gICAgICAgICAgICAgICAgdmFyIGlucHV0RGF0YVR5cGUgPSBwcmVyZXF1aXNpdGUuY2hlY2sudmFyaWFibGUudmFsdWUuZGF0YVR5cGUuZGF0YVR5cGU7XG5cbiAgICAgICAgICAgICAgICB2YXIgZmluYWxWYWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAoaW5wdXREYXRhVHlwZSA9PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlID0gTnVtYmVyKGlucHV0VmFsdWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhVHlwZSA9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBmaW5hbFZhbHVlID0gaW5wdXRWYWx1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YVR5cGUgPT0gJ2ludGVnZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBwYXJzZUludChpbnB1dFZhbHVlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGlucHV0RGF0YVR5cGUgPT0gJ2RlY2ltYWwnKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBwYXJzZUZsb2F0KGlucHV0VmFsdWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5wdXREYXRhVHlwZSA9PSAnZGF0ZScgfHwgaW5wdXREYXRhVHlwZSA9PSAnZGF0ZVRpbWUnKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpbmFsVmFsdWUgPSBpbnB1dFZhbHVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBjb21wYXJlID0gdXRpbC5jb21wYXJlKHN1YmplY3RWYWx1ZUNhbGN1bGF0ZWQsIHByZXJlcXVpc2l0ZS5jaGVjay52YXJpYWJsZS5vcGVyYXRvciwgZmluYWxWYWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKGNvbXBhcmUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1ZhcmlhYmxlIFByZS1yZXF1aXNpdGVzIHBhc3NlZC4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IGhlbHBlci5nZXRMYW5ndWFnZU1lc3NhZ2UocHJlcmVxdWlzaXRlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywgbWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcblxuICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gaGVscGVyLmdldExhbmd1YWdlTWVzc2FnZShwcmVyZXF1aXNpdGUubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgdmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZQcmVSZXF1aXNpdGVFcnJvcjonLCBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRlByZVJlcXVpc2l0ZUVycm9yJywgJ1ByZS1yZXF1aXNpdGUgdHlwZSBub3QgZGVmaW5lZC4nKTtcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG5cbiAgICAgICAgfVxuXG5cblxuICAgIH0pO1xufTtcblxuLyoqXG4gKiBQcm9jZXNzIHByZS1hY3Rpb25zc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBwcmVBY3Rpb25zIC0gdGhlIHByZS1hY3Rpb25zIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgY3VycmVudCB3b3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gcHJlQWN0aW9ucyhwcmVBY3Rpb25zLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB2YXIgY29tcGxldGVkID0gW107XG4gICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgIHZhciBzcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgcHJvY2Vzc0lEID0gc3BPYmplY3RbXCJtZXRhLWRhdGFcIl0ucHJvY2Vzc0NvbmZpZ0lkO1xuICAgICAgICAgICAgdmFyIHByb2Nlc3NJZCA9IHNwT2JqZWN0W1wibWV0YS1kYXRhXCJdLnN1YlByb2Nlc3NDb25maWdJZDtcbiAgICAgICAgICAgIHZhciBwcm9jZXNzU0VRID0gc3BPYmplY3RbXCJtZXRhLWRhdGFcIl0uc3ViUHJvY2Vzc0luc1NlcTtcbiAgICAgICAgICAgIHZhciBwcm9jZXNzU2VxID0gc3BPYmplY3RbXCJtZXRhLWRhdGFcIl0uc3ViUHJvY2Vzc0luc1NlcTtcblxuICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NDb25maWdPYmplY3QgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgcHJvY2Vzc0lEICsgXCInXS9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHByb2Nlc3NJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG4gICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3N0ZXBcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIHV0aWwuc3luY0xvb3AocHJlQWN0aW9ucy5sZW5ndGgsIGZ1bmN0aW9uKGxvb3ApIHtcbiAgICAgICAgICAgICAgICB2YXIgY291bnRlciA9IGxvb3AuaXRlcmF0aW9uKCk7XG4gICAgICAgICAgICAgICAgYWN0aW9uKHByZUFjdGlvbnNbY291bnRlcl0sIHByb2Nlc3NJRCwgcHJvY2Vzc1NFUSwgcHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzQ29uZmlnT2JqZWN0LCBzdGVwT2JqZWN0LCBfV0ZJbnN0YW5jZSwge30sIHNwdXVpZCkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIGFsbCBwcmUtcmVxdWlzaXRlcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LlxuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWQucHVzaCh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgbG9vcC5uZXh0KCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZC5wdXNoKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgbG9vcC5icmVhaygpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmIChjb21wbGV0ZWQuZXZlcnkoQm9vbGVhbikpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1ByZS1hY3Rpb25zIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywge30pO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGUHJlUmVxdWlzaXRlRXJyb3InLCAnTm90IGFsbCBwcmUtYWN0aW9ucyBwYXNzZWQuJyk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFdvcmtmbG93IGdldCBzdWItcHJvY2VzcyBkYXRhLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBpZCAtIHRoZSBzdWJQcm9jZXNzIGNvbmZpZyBpZFxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSBcIlwiXG4gKlxuICogQHJldHVybiBcIlwiXG4gKlxuICovXG5mdW5jdGlvbiBnZXRTdWJQcm9jZXNzKGlkLCBfV0ZJbnN0YW5jZSkge1xuICAgIGlmIChfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3MpIHtcbiAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzLmlkID09IGlkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN1YlByb2Nlc3M7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG4gICAgfVxuXG59O1xuXG4vKipcbiAqIFByb2Nlc3Mgc3ViLXByb2Nlc3NcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gcHJvY2VzcyAtIHRoZSBjdXJyZW50IHByb2Nlc3MgaWQgYW5kIHNlcVxuICogQHBhcmFtIHtvYmplY3R9IHN1YlByb2Nlc3MgLSB0aGUgc3ViLXByb2Nlc3MgaWQgYW5kIHNlcVxuICogQHBhcmFtIHtvYmplY3R9IGRhdGEgLSB0aGUgdXNlciBpbnB1dCBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgY3VycmVudCB3b3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gc3ViUHJvY2Vzcyhwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3VicHJvZmlsZUlkLCBkYXRhLCBfV0ZJbnN0YW5jZSkge1xuICAgIC8vIEdldCB0aGUgY3VycmVudCBwcm9jZXNzIHN1YlByb2Nlc3MgaW5zdGFuY2VcbiAgICAvLyB2YXIgc3ViUHJvY2Vzc1NlcSA9IDE7XG4gICAgdmFyIHN1YlByb2Nlc3MgPSBbXTtcbiAgICB2YXIgcHJvY2Vzc0NvbmYgPSBbXTtcbiAgICB2YXIgc3ViUHJvY2Vzc0NvbmYgPSBbXTtcbiAgICBfV0ZJbnN0YW5jZS5pbnN0YW5jZS5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialByb2Nlc3MpIHtcbiAgICAgICAgaWYgKG9ialByb2Nlc3MuaWQgPT0gcHJvY2Vzc0lkICYmIG9ialByb2Nlc3Muc2VxID09IHByb2Nlc3NTZXEpIHtcbiAgICAgICAgICAgIHZhciBzcExlbmd0aCA9IG9ialByb2Nlc3Muc3ViUHJvY2Vzc2VzLmxlbmd0aDtcbiAgICAgICAgICAgIG9ialByb2Nlc3Muc3ViUHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpTdWJQcm9jZXNzKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9ialN1YlByb2Nlc3MuaWQgPT0gc3ViUHJvY2Vzc0lkICYmIG9ialN1YlByb2Nlc3Muc2VxID09IHN1YlByb2Nlc3NTZXEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHV1aWQgPSBvYmpTdWJQcm9jZXNzLnV1aWQ7XG4gICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24oc3ViUHJvY2Vzc0l0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzSXRlbS5faWQgPT0gdXVpZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3MgPSBzdWJQcm9jZXNzSXRlbTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgfSk7XG4gICAgLy8gR2V0IHRoZSBjdXJyZW50IHN1YlByb2Nlc3MgY29uZmlndXJhdGlvblxuICAgIF9XRkluc3RhbmNlLmNvbmZpZy5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHByb2Nlc3NDb25maWcpIHtcbiAgICAgICAgaWYgKHByb2Nlc3NDb25maWcuX2lkID09IHByb2Nlc3NJZCkge1xuICAgICAgICAgICAgcHJvY2Vzc0NvbmYgPSBwcm9jZXNzQ29uZmlnO1xuICAgICAgICAgICAgcHJvY2Vzc0NvbmZpZy5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NDb25maWcpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3ViUHJvY2Vzc0NvbmZpZy5faWQgPT0gc3ViUHJvY2Vzc0lkKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NDb25mID0gc3ViUHJvY2Vzc0NvbmZpZztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgIH0pO1xuXG4gICAgLy9UT0RPOiBDaGFuZ2UgcmVxdWlyZWQgdG8gbW92ZSBpc0FjdGl2ZSB0byBzdWJQcm9jZXNzIGZpbGUuSGVyZVxuICAgIHZhciBncm91cEtleSA9ICcnO1xuICAgIHZhciBiYXNlVVVJRCA9IGRhdGEuYmFzZVVVSUQ7XG5cbiAgICBpZiAoYmFzZVVVSUQgIT0gdW5kZWZpbmVkICYmIGJhc2VVVUlEICE9ICcnICYmIGJhc2VVVUlELmxlbmd0aCA+IDApIHtcblxuICAgICAgICB2YXIgcHJldmlvdXNPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgYmFzZVVVSUQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgIGdyb3VwS2V5ID0gcHJldmlvdXNPYmplY3QuZ3JvdXBLZXk7XG5cbiAgICB9IGVsc2Uge1xuXG4gICAgICAgIHZhciBjYXJkSW5kTGlzdCA9ICcnO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN1YlByb2Nlc3NDb25mLmluZGljYXRvcnMubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICBjYXJkSW5kTGlzdCA9IGNhcmRJbmRMaXN0ICsgXCInXCIgKyBzdWJQcm9jZXNzQ29uZi5pbmRpY2F0b3JzW2ldLl9pZCArIFwiJyxcIjtcbiAgICAgICAgfVxuICAgICAgICBjYXJkSW5kTGlzdCA9IGNhcmRJbmRMaXN0ICsgXCInXCIgKyBzdWJQcm9jZXNzQ29uZi5pbmRpY2F0b3JzW2ldLl9pZCArIFwiJ1wiO1xuICAgICAgICB2YXIgc2luZ2xlQ2FyZCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tzZXRJZCA9IChcIiArIGNhcmRJbmRMaXN0ICsgXCIpIGFuZCBjYXJkaW5hbGl0eSBlcSAnc2luZ2xlJ11cIiwgYXBwLlNDT1BFLkFQUF9DT05GSUcsIHt9KS5sZW5ndGg7XG5cbiAgICAgICAgaWYgKHN1YlByb2Nlc3NDb25mLmluc3RhbmNlVHlwZS5uZXdTZXF1ZW5jZSAhPSB1bmRlZmluZWQgfHwgc2luZ2xlQ2FyZCA+IDApIHtcbiAgICAgICAgICAgIHZhciBwcmV2aW91c09iamVjdCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzW2lkIGVxICdcIiArIHByb2Nlc3NJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgIGlmIChwcmV2aW91c09iamVjdCAhPSB1bmRlZmluZWQgJiYgcHJldmlvdXNPYmplY3Quc3ViUHJvY2Vzc2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBncm91cEtleSA9IHByZXZpb3VzT2JqZWN0LnN1YlByb2Nlc3Nlc1swXS5ncm91cEtleTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZ3JvdXBLZXkgPSBnZW5lcmF0ZVVVSUQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdyb3VwS2V5ID0gZ2VuZXJhdGVVVUlEKCk7XG5cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciBjb3VudFN1YnByb2Nlc3NJbkNvbnRleHQgPSBKU09OLnhwYXRoKFwiY291bnQoL3Byb2Nlc3Nlcy9zdWJQcm9jZXNzZXNbZ3JvdXBLZXkgZXEgJ1wiICsgZ3JvdXBLZXkgKyBcIiddKVwiLCBfV0ZJbnN0YW5jZS5pbnN0YW5jZSwge30pWzBdO1xuICAgIHZhciBsYWJlbCA9IGRhdGEubGFiZWw7XG4gICAgdmFyIHN1YlByb2Nlc3NPYmplY3RJZCA9IGdlbmVyYXRlVVVJRCgpO1xuXG5cblxuXG5cblxuICAgIHZhciBtb2RlbCA9IHtcbiAgICAgICAgX2lkOiBzdWJQcm9jZXNzT2JqZWN0SWQsXG4gICAgICAgIGlkOiBzdWJQcm9jZXNzSWQsXG4gICAgICAgIHR5cGU6ICd3b3JrZmxvd0luc3RhbmNlU3ViUHJvY2VzcycsXG4gICAgICAgIGRhdGVUaW1lQ3JlYXRlZDogbW9tZW50KCkuZm9ybWF0KCksXG4gICAgICAgIGR1ZURhdGVUaW1lOiBtb21lbnQoKS5mb3JtYXQoKSxcbiAgICAgICAgc2VxOiBzdWJQcm9jZXNzU2VxLFxuICAgICAgICBpbml0aWF0ZWQ6IGZhbHNlLFxuICAgICAgICBkYXRlczoge1xuICAgICAgICAgICAgY3JlYXRlZDogJycsXG4gICAgICAgICAgICB2YWxpZDogJycsXG4gICAgICAgICAgICBzdGFydDogJycsXG4gICAgICAgICAgICBkdWU6ICcnLFxuICAgICAgICAgICAgY2xvc2VkOiAnJ1xuICAgICAgICB9LFxuICAgICAgICBjb21wbGV0ZTogZmFsc2UsXG4gICAgICAgIGluZGljYXRvcnM6IFtdLFxuICAgICAgICBzdGVwOiB7fSxcbiAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICBncm91cEtleTogZ3JvdXBLZXksXG4gICAgICAgIGxhYmVsOiBsYWJlbCxcbiAgICAgICAgY2hhbm5lbHM6IFtcbiAgICAgICAgICAgIFwiY29tbXVuaXR5X1wiICsgYXBwLlNDT1BFLmdldENvbW11bml0eUlkKCksXG4gICAgICAgICAgICBcInByb2ZpbGVfXCIgKyBhcHAuU0NPUEUucHJvZmlsZUlkLFxuICAgICAgICAgICAgXCJhcHBsaWNhdGlvbl9cIiArIGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkLFxuICAgICAgICAgICAgXCJjb21tdW5pdHlfXCIgKyBhcHAuU0NPUEUuZ2V0Q29tbXVuaXR5SWQoKSArIFwiX2FwcGxpY2F0aW9uX1wiICsgYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWRcbiAgICAgICAgXSxcbiAgICAgICAgaGlzdG9yeTogW10sXG4gICAgICAgIC8vbWV0YSBpbmZvcm1hdGlvbiBhZGRlZCBmb3Igc2VydmVyIHNpZGUgY29uZmxpY3QgbWFuYWdlbWVudCBhbmQgbWVyZ2VyXG4gICAgICAgIFwibWV0YS1kYXRhXCI6IHtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uSWQ6IGFwcC5TQ09QRS5hcHBsaWNhdGlvbklkLFxuICAgICAgICAgICAgY29tbXVuaXR5SWQ6IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpLFxuICAgICAgICAgICAgcHJvZmlsZUlkOiBhcHAuU0NPUEUucHJvZmlsZUlkLFxuICAgICAgICAgICAgc3VicHJvZmlsZUlkOiBzdWJwcm9maWxlSWQgPT0gdW5kZWZpbmVkID8gJycgOiBzdWJwcm9maWxlSWQsXG4gICAgICAgICAgICBwcm9jZXNzQ29uZmlnSWQ6IHByb2Nlc3NJZCxcbiAgICAgICAgICAgIHN1YlByb2Nlc3NDb25maWdJZDogc3ViUHJvY2Vzc0lkLFxuICAgICAgICAgICAgc3ViUHJvY2Vzc0luc1NlcTogY291bnRTdWJwcm9jZXNzSW5Db250ZXh0ICsgMVxuICAgICAgICB9LFxuICAgICAgICBtZXNzYWdlczogW10sXG4gICAgICAgIHNwU3RhdHVzOiAnJ1xuICAgIH07XG5cbiAgICBpZiAoYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkICE9IHVuZGVmaW5lZCAmJiBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQgIT0gXCJcIikge1xuICAgICAgICBtb2RlbC5jaGFubmVscy5wdXNoKFwicHJvZmlsZV9cIiArIGFwcC5TQ09QRS5wcm9maWxlSWQgKyBcIl9zdWJwcm9maWxlX1wiICsgYXBwLnByb2ZpbGUuc3VicHJvZmlsZUlkKTtcbiAgICAgICAgbW9kZWwuY2hhbm5lbHMucHVzaChcInN1YnByb2ZpbGVfXCIgKyBhcHAucHJvZmlsZS5zdWJwcm9maWxlSWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIG1vZGVsLmNoYW5uZWxzLnB1c2goXCJwcm9maWxlX1wiICsgYXBwLlNDT1BFLnByb2ZpbGVJZCArIFwiX3N1YnByb2ZpbGVfXCIgKyAwKTtcbiAgICAgICAgbW9kZWwuY2hhbm5lbHMucHVzaChcInN1YnByb2ZpbGVfXCIgKyAwKTtcbiAgICB9XG5cbiAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMucHVzaChtb2RlbCk7XG4gICAgLy8gUmV0dXJuIGEgcHJvbWlzZVxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgLy8gQ2F0Y2ggYWxsIHVuY2F1Z2h0IGVycm9yc1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gMS4gUHJvY2VzcyB0aGUgcHJlLWFjdGlvbnNcbiAgICAgICAgICAgIHZhciBwcmVBY3Rpb25zQ29uZiA9IHByb2Nlc3NDb25mLnByZUFjdGlvbnM7XG4gICAgICAgICAgICAvL2FjdGlvbihhY3Rpb25zW2NvdW50ZXJdLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2Vzcywgc3RlcCwgX1dGSW5zdGFuY2UsIGRhdGEsIHV1aWQpXG4gICAgICAgICAgICBwcmVBY3Rpb25zKHByZUFjdGlvbnNDb25mLCBfV0ZJbnN0YW5jZSwgc3ViUHJvY2Vzc09iamVjdElkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIC8vIDIuIFByb2Nlc3MgdGhlIHByZS1yZXF1aXNpdGVzXG4gICAgICAgICAgICAgICAgdmFyIHByZXJlcXVpc2l0ZUNvbmYgPSBwcm9jZXNzQ29uZi5wcmVyZXF1aXNpdGVzO1xuICAgICAgICAgICAgICAgIHByZVJlcXVpc2l0ZXMocHJlcmVxdWlzaXRlQ29uZiwgX1dGSW5zdGFuY2UsIHN1YlByb2Nlc3NPYmplY3RJZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gMy4gSW5pdGlhdGUgdGhlIHN1YlByb2Nlc3NcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluaXRpYXRlQ29uZiA9IHN1YlByb2Nlc3NDb25mLmluaXRpYXRlO1xuICAgICAgICAgICAgICAgICAgICBpbml0aWF0ZShpbml0aWF0ZUNvbmYsIHN1YlByb2Nlc3MsIGRhdGEpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1VwZGF0ZSB0aGUgc3ViUHJvY2VzcyBtb2RlbFxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuaW5pdGlhdGVkID0gcmVzdWx0LmRhdGEuaW5pdGlhdGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuZGF0ZXMgPSByZXN1bHQuZGF0YS5kYXRlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEV4ZWN1dGUgdGhlIGZpcnN0IHN0ZXBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwSWQgPSBzdWJQcm9jZXNzQ29uZi5zdGVwc1swXS5faWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNpdGlvbklkID0gc3ViUHJvY2Vzc0NvbmYuc3RlcHNbMF0udHJhbnNpdGlvblswXS5faWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcFNlcSA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGVwKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHN0ZXBTZXEsIGRhdGEsIF9XRkluc3RhbmNlLCBzdWJQcm9jZXNzT2JqZWN0SWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLnN0ZXAgPSByZXN1bHQuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9ycyhzdWJQcm9jZXNzQ29uZi5pbmRpY2F0b3JzLCBfV0ZJbnN0YW5jZSwgbW9kZWwuX2lkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmluZGljYXRvcnMgPSByZXN1bHQxLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBFeGVjdXRlIHRoZSB0cmFuc2l0aW9ucywgaWYgYXV0b1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TdWJwcm9jZXNzIHBvc3RBY3Rpb25zIHJlbW92ZWQgZnJvbSBoZXJlIGFzIHRoZXkgc2hvdWxkIGJlIGV4ZWN1dGVkIGF0IHRoZSBlbmQgb2YgdGhlIHN1YlByb2Nlc3MsIG1lYW5zIGF0IGxhc3Qgc3RlcCBhZnRlciB0cmFuc2l0aW9uLCBqdXN0IGJlZm9yZSBmaW5pc2guXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENhbiBhZGQgaGlzdG9yeSBvYmplY3QgaGVyZSBpbiBjYXNlIGZvciBmaXJzdCBzdGVwLCBpLmUgaW5pdGlhbGlzYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1vZGVsLmhpc3RvcnkucHVzaChyZXN1bHQuZGF0YSk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MocmVzdWx0MS5tZXNzYWdlLCBtb2RlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMgPSBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhKG9iai5faWQgPT0gc3ViUHJvY2Vzc09iamVjdElkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIF9XRkluc3RhbmNlLnN1YnByb2Nlc3NlcyA9IF9XRkluc3RhbmNlLnN1YnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIShvYmouX2lkID09IHN1YlByb2Nlc3NPYmplY3RJZCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzID0gX1dGSW5zdGFuY2Uuc3VicHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICEob2JqLl9pZCA9PSBzdWJQcm9jZXNzT2JqZWN0SWQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFByb2Nlc3MgaW5pdGlhdGVcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gaW5pdGlhdGUgLSB0aGUgaW5pdGlhdGUgY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIC0gdGhlIHVzZXIgaW5wdXQgZGF0YVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gaW5pdGlhdGUoaW5pdGlhdGUsIHN1YlByb2Nlc3MsIGRhdGEpIHtcbiAgICB2YXIgY29tcGxldGVkID0gW107XG4gICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgICAgaW5pdGlhdGVkOiBmYWxzZSxcbiAgICAgICAgZGF0ZXM6IHtcbiAgICAgICAgICAgIGNyZWF0ZWQ6ICcnLFxuICAgICAgICAgICAgdmFsaWQ6ICcnLFxuICAgICAgICAgICAgc3RhcnQ6ICcnLFxuICAgICAgICAgICAgZHVlOiAnJyxcbiAgICAgICAgICAgIGNsb3NlZDogJydcbiAgICAgICAgfVxuXG4gICAgfTtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgaWYgKGluaXRpYXRlLnVzZXIgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LmRhdGVzLmNyZWF0ZWQgPSBkYXRhLmNyZWF0ZWREYXRlO1xuICAgICAgICAgICAgICAgIGlmIChpbml0aWF0ZS51c2VyLnZhbGlkRGF0ZS5fdHlwZSA9PSAndXNlclNlbGVjdGVkJyB8fCBpbml0aWF0ZS51c2VyLnZhbGlkRGF0ZS5fdHlwZSA9PSAnYXV0b1NlbGVjdGVkJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS52YWxpZERhdGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuZGF0ZXMudmFsaWQgPSBkYXRhLnZhbGlkRGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRlcy52YWxpZCA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zdWJzdHJpbmcoMCwgMTApO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5pdGlhdGUudXNlci5kdWVEYXRlLl90eXBlID09ICd1c2VyU2VsZWN0ZWQnIHx8IGluaXRpYXRlLnVzZXIuZHVlRGF0ZS5fdHlwZSA9PSAnYXV0b1NlbGVjdGVkJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5kdWVEYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRlcy5kdWUgPSBkYXRhLmR1ZURhdGU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1dGlsLndhcm4oJ1dGSW5pdGlhdGVFcnJvcicsICdObyBkdWUgZGF0ZSBwYXNzZWQgaW4gLSB7ZGF0YS5kdWVEYXRlfScpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXN1bHQuZGF0ZXMuc3RhcnQgPSBkYXRhLmZpcnN0RGF0ZTtcblxuXG5cbiAgICAgICAgICAgICAgICByZXN1bHQuaW5pdGlhdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnU3ViLVByb2Nlc3MgaW5pdGlhdGUgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5pdGlhdGUuYXV0byAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgcmVzdWx0LmRhdGVzLmNyZWF0ZWQgPSBkYXRhLmNyZWF0ZWREYXRlO1xuXG4gICAgICAgICAgICAgICAgaWYgKGluaXRpYXRlLmRhdGVzLnZhbGlkLl90eXBlID09ICd1c2VyU2VsZWN0ZWQnIHx8IGluaXRpYXRlLmRhdGVzLnZhbGlkLl90eXBlID09ICdhdXRvU2VsZWN0ZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnZhbGlkRGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuZGF0ZXMudmFsaWQgPSBkYXRhLnZhbGlkRGF0ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHV0aWwud2FybignV0ZJbml0aWF0ZUVycm9yJywgJ05vIHZhbGlkIGRhdGUgcGFzc2VkIGluIC0ge2RhdGEudmFsaWREYXRlfScpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5pdGlhdGUuZGF0ZXMuZHVlLl90eXBlID09ICd1c2VyU2VsZWN0ZWQnIHx8IGluaXRpYXRlLmRhdGVzLmR1ZS5fdHlwZSA9PSAnYXV0b1NlbGVjdGVkJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5kdWVEYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRlcy5kdWUgPSBkYXRhLmR1ZURhdGU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1dGlsLndhcm4oJ1dGSW5pdGlhdGVFcnJvcicsICdObyBkdWUgZGF0ZSBwYXNzZWQgaW4gLSB7ZGF0YS5kdWVEYXRlfScpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXN1bHQuaW5pdGlhdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnU3ViLVByb2Nlc3MgaW5pdGlhdGUgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCByZXN1bHQpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7Ki9cblxuICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgIHZhciBlcnJvciA9IHV0aWwuZXJyb3IoJ1dGSW5pdGlhdGVFcnJvcicsICdJbml0aWF0ZSB0eXBlOiAnICsgaW5pdGlhdGUuX3R5cGUgKyAnIG5vdCBkZWZpbmVkLicpO1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHN1YlByb2Nlc3MuY29tcGxldGUgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpbml0KCk7XG4gICAgICAgIH0gZWxzZSBpZiAoIXN1YlByb2Nlc3MuY29tcGxldGUpIHtcbiAgICAgICAgICAgIGlmIChpbml0aWF0ZS5wYXJhbGxlbEluc3RhbmNlcykge1xuICAgICAgICAgICAgICAgIGluaXQoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZJbml0aWF0ZUVycm9yJywgJ1N1Yi1wcm9jZXNzOiAnICsgc3ViUHJvY2Vzcy5pZCArICcgc3RpbGwgYWN0aXZlIGFuZCBwYXJhbGxlbCBpbnN0YW5jZXMgYXJlIG5vdCBhbGxvd2VkLicpO1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgfSk7XG59O1xuXG4vKipcbiAqIFByb2Nlc3Mgc3RlcFxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgY3VycmVudCBwcm9jZXNzIGlkXG4gKiBAcGFyYW0ge3N0cmluZ30gc3ViUHJvY2Vzc0lkIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3MgaWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGVwSWQgLSB0aGUgY3VycmVudCBzdWItcHJvY2VzcyBzdGVwIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gc3RlcFNlcSAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIHN0ZXAgaW5zdGFuY2UgY291bnRlciAvIHNlcXVlbmNlXG4gKiBAcGFyYW0ge29iamVjdH0gZGF0YSAtIHRoZSB1c2VyIGlucHV0IGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IF9XRkluc3RhbmNlIGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBzdGVwKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHN0ZXBTZXEsIGRhdGEsIF9XRkluc3RhbmNlLCBzcHV1aWQpIHtcblxuICAgIC8vIERlZmF1bHQgc3RlcCBtb2RlbFxuICAgIHZhciBtb2RlbCA9IHtcbiAgICAgICAga2V5OiBnZW5lcmF0ZVVVSUQoKSxcbiAgICAgICAgaWQ6ICcnLFxuICAgICAgICBzZXE6ICcnLFxuICAgICAgICBzdGF0dXM6ICcnLFxuICAgICAgICBtZXNzYWdlOiAnJyxcbiAgICAgICAgYXNzaWduZWRUbzoge1xuICAgICAgICAgICAgdXNlcklkOiAnJyxcbiAgICAgICAgICAgIG5hbWU6ICcnLFxuICAgICAgICAgICAgZGF0ZVRpbWU6ICcnLFxuICAgICAgICAgICAgdHlwZTogJycsXG4gICAgICAgICAgICBkdWVEYXRlVGltZTogJycsXG4gICAgICAgICAgICBieTogJydcbiAgICAgICAgfSxcbiAgICAgICAgYXNzaWdubWVudEhpc3Rvcnk6IFtdLFxuICAgICAgICBkYXRlVGltZUNyZWF0ZWQ6IG1vbWVudCgpLmZvcm1hdCgpLFxuICAgICAgICBkdWVEYXRlVGltZTogbW9tZW50KCkuZm9ybWF0KCksXG4gICAgICAgIHRyYW5zaXRpb246IHtcbiAgICAgICAgICAgIHRyYW5zaXRpb25JZDogJycsXG4gICAgICAgICAgICBkYXRlVGltZTogJycsXG4gICAgICAgICAgICB1c2VySWQ6ICcnXG4gICAgICAgIH0sXG4gICAgICAgIGFzc2lnbm1lbnQ6IHt9LFxuICAgICAgICBjb21tZW50OiAnJ1xuICAgIH07XG5cbiAgICB2YXIgc3ViUHJvY2VzcyA9IHt9O1xuXG4gICAgdmFyIHV1aWQgPSAnJztcbiAgICB2YXIgaW5zdFN1YlByb2Nlc3M7XG4gICAgdmFyIHN0ZXAgPSB7fTtcblxuICAgIHZhciB0cmFuc2l0aW9uSWQgPSAnJztcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvL0dldCB0aGUgY3VycmVudCBzdWJQcm9jZXNzIGluc3RhbmNlIGRhdGFcbiAgICAgICAgICAgIF9XRkluc3RhbmNlLmluc3RhbmNlLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqUHJvY2Vzcykge1xuICAgICAgICAgICAgICAgIGlmIChvYmpQcm9jZXNzLmlkID09IHByb2Nlc3NJZCAmJiBvYmpQcm9jZXNzLnNlcSA9PSBwcm9jZXNzU2VxKSB7XG4gICAgICAgICAgICAgICAgICAgIG9ialByb2Nlc3Muc3ViUHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpTdWJQcm9jZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqU3ViUHJvY2Vzcy5pZCA9PSBzdWJQcm9jZXNzSWQgJiYgb2JqU3ViUHJvY2Vzcy5zZXEgPT0gc3ViUHJvY2Vzc1NlcSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV1aWQgPSBvYmpTdWJQcm9jZXNzLnV1aWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NJdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN1YlByb2Nlc3NJdGVtLl9pZCA9PSB1dWlkKSB7XG4gICAgICAgICAgICAgICAgICAgIGluc3RTdWJQcm9jZXNzID0gc3ViUHJvY2Vzc0l0ZW07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgX1dGSW5zdGFuY2UuY29uZmlnLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24ob2JqUHJvY2Vzcykge1xuICAgICAgICAgICAgICAgIGlmIChvYmpQcm9jZXNzLl9pZCA9PSBwcm9jZXNzSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgb2JqUHJvY2Vzcy5zdWJQcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKG9ialN1YlByb2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmpTdWJQcm9jZXNzLl9pZCA9PSBzdWJQcm9jZXNzSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzID0gb2JqU3ViUHJvY2VzcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpTdWJQcm9jZXNzLnN0ZXBzLmZpbHRlcihmdW5jdGlvbihvYmpTdGVwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmpTdGVwLl9pZCA9PSBzdGVwSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXAgPSBvYmpTdGVwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgc3ViLXByb2Nlc3Mgc3RlcCBkYXRhXG4gICAgICAgICAgICBtb2RlbC5pZCA9IHN0ZXBJZDtcbiAgICAgICAgICAgIG1vZGVsLnNlcSA9IHN0ZXBTZXE7XG5cbiAgICAgICAgICAgIHZhciBpbnN0YW5jZVN0YXR1cyA9ICcnO1xuICAgICAgICAgICAgaWYgKHN0ZXAuc2V0SW5zdGFuY2VTdGF0dXNUby5Ob3RTdGFydGVkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGluc3RhbmNlU3RhdHVzID0gXCJOb3RTdGFydGVkXCI7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0ZXAuc2V0SW5zdGFuY2VTdGF0dXNUby5DcmVhdGVkICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGluc3RhbmNlU3RhdHVzID0gXCJDcmVhdGVkXCI7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0ZXAuc2V0SW5zdGFuY2VTdGF0dXNUby5JblByb2dyZXNzICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGluc3RhbmNlU3RhdHVzID0gXCJJblByb2dyZXNzXCI7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN0ZXAuc2V0SW5zdGFuY2VTdGF0dXNUby5TdWJtaXR0ZWQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VTdGF0dXMgPSBcIlN1Ym1pdHRlZFwiO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChzdGVwLnNldEluc3RhbmNlU3RhdHVzVG8uQ29tcGxldGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VTdGF0dXMgPSBcIkNvbXBsZXRlXCI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBsYW5ndWFnZSA9IHNlcnZpY2UuZ2V0TGFuZ3VhZ2UoKTtcblxuICAgICAgICAgICAgbW9kZWwuc3RhdHVzID0gaW5zdGFuY2VTdGF0dXM7XG4gICAgICAgICAgICBtb2RlbC5tZXNzYWdlID0gZXZhbChcInN0ZXAuc2V0SW5zdGFuY2VTdGF0dXNUby5cIiArIGluc3RhbmNlU3RhdHVzICsgXCIubGFiZWwuaTE4bi5cIiArIGxhbmd1YWdlKTtcbiAgICAgICAgICAgIG1vZGVsLmNvbW1lbnQgPSBkYXRhLmNvbW1lbnQgIT09IHVuZGVmaW5lZCA/IGRhdGEuY29tbWVudCA6ICcnO1xuICAgICAgICAgICAgdmFyIGluZGljYXRvcnMgPSBpbnN0U3ViUHJvY2VzcyAhPT0gdW5kZWZpbmVkID8gaW5zdFN1YlByb2Nlc3MuaW5kaWNhdG9ycyA6IFtdO1xuXG4gICAgICAgICAgICB2YXIgdXBkYXRlU1BJbmRpY2F0b3JPYmplY3QgPSBmdW5jdGlvbihpbmRpY2F0b3JzLCBfV0ZJbnN0YW5jZSkge1xuXG4gICAgICAgICAgICAgICAgaWYgKGluZGljYXRvcnMubGVuZ3RoID4gMCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5kaWNhdG9ycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvck9iamVjdCA9IGluZGljYXRvcnNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXVpZCA9IGluZGljYXRvck9iamVjdC5pbnN0YW5jZXNbMF0udXVpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cGRhdGVkU2VxID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9tb2RlbC9wZW5kaW5nL3NlcVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yT2JqZWN0Lmluc3RhbmNlc1swXS5zZXEgPSB1cGRhdGVkU2VxO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB2YXIgY2xlYXJTUFN0YXR1cyA9IGZ1bmN0aW9uKHNwdXVpZCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIG9iaiA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgb2JqLnNwU3RhdHVzID0gXCJcIjtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGluZGljYXRvckRvY3MocHJvY2Vzc0lkLCBpbmRpY2F0b3JzLCBtb2RlbCwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgdXVpZCA9IHNwdXVpZDtcblxuICAgICAgICAgICAgICAgIGlmIChzdGVwLmZ1bmN0aW9uLmFjdGlvbnMgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbnMoc3RlcC5mdW5jdGlvbi5hY3Rpb25zLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2VzcywgbW9kZWwsIF9XRkluc3RhbmNlLCBkYXRhLCBzcHV1aWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVTUEluZGljYXRvck9iamVjdChpbmRpY2F0b3JzLCBfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zaXRpb25JZCA9IHN0ZXAudHJhbnNpdGlvblswXS5faWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3RlcElkLCB0cmFuc2l0aW9uSWQsIGRhdGEsIF9XRkluc3RhbmNlLCBzcHV1aWQsIG1vZGVsKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnVHJhbnNpdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LicsIHJlc3VsdC5kYXRhLnN0ZXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RlcC5mdW5jdGlvbi50YXNrICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBNYWtlIGFzc2lnbm1lbnRzXG4gICAgICAgICAgICAgICAgICAgIHRhc2socHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdGVwLmZ1bmN0aW9uLnRhc2ssIHNwdXVpZCwgbW9kZWwpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZVNQSW5kaWNhdG9yT2JqZWN0KGluZGljYXRvcnMsIF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdUYXNrIGF3YWl0aW5nIHVzZXIgYWN0aW9uLicsIG1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzdGVwLmZ1bmN0aW9uLnNlcnZlciAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTWFrZSBhc3NpZ25tZW50c1xuICAgICAgICAgICAgICAgICAgICBjbGVhclNQU3RhdHVzKHNwdXVpZCk7XG4gICAgICAgICAgICAgICAgICAgIHNlcnZlcihzdGVwLmZ1bmN0aW9uLnNlcnZlciwgcHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN1YlByb2Nlc3MsIG1vZGVsLCBfV0ZJbnN0YW5jZSwgZGF0YSwgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVTUEluZGljYXRvck9iamVjdChpbmRpY2F0b3JzLCBfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnU2VydmVyIGF3YWl0aW5nIHNlcnZlciByZXNwb25zZS4nLCBtb2RlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pO1xufTtcblxuLyoqXG4gKiBQcm9jZXNzIGluZGljYXRvciB1cGRhdGVzXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IGFjdGlvbnMgLSB0aGUgYWN0aW9ucyBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IHN1YlByb2Nlc3MgLSB0aGUgY3VycmVudCBzdWItcHJvY2VzcyBmb3JtIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgY3VycmVudCB3b3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gaW5kaWNhdG9ycyhpbmRpY2F0b3JzLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKSB7XG4gICAgdmFyIG1vZGVsID0gW107XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGFycmF5ID0gSlNPTi54cGF0aChcImluZGljYXRvcnNbZm46Y291bnQoLi93b3JrZmxvd3MvcHJvY2Vzc2VzW3N1YlByb2Nlc3NVVUlEIGVxICdcIiArIHNwdXVpZCArIFwiJ10pIGd0IDBdXCIsIF9XRkluc3RhbmNlLCB7fSk7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGFycmF5Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGluZGljYXRvciA9IGFycmF5W2pdO1xuICAgICAgICAgICAgICAgIHZhciBpbmRpY2F0b3JNb2RlbCA9IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZXM6IFtdXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlTW9kZWwgPSB7XG4gICAgICAgICAgICAgICAgICAgIHV1aWQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJycsXG4gICAgICAgICAgICAgICAgICAgIGtleTogJycsXG4gICAgICAgICAgICAgICAgICAgIHNlcTogMSxcbiAgICAgICAgICAgICAgICAgICAgcmV2OiAnJ1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGluZGljYXRvck1vZGVsLmlkID0gaW5kaWNhdG9yLmNhdGVnb3J5LnRlcm07XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VNb2RlbC51dWlkID0gaW5kaWNhdG9yLl9pZDtcbiAgICAgICAgICAgICAgICBpbnN0YW5jZU1vZGVsLnJldiA9IGluZGljYXRvci5fcmV2O1xuICAgICAgICAgICAgICAgIGluc3RhbmNlTW9kZWwudGl0bGUgPSBpbmRpY2F0b3IudGl0bGU7XG4gICAgICAgICAgICAgICAgaW5zdGFuY2VNb2RlbC5rZXkgPSAnJztcbiAgICAgICAgICAgICAgICBpbnN0YW5jZU1vZGVsLnNlcSA9IGluZGljYXRvci5tb2RlbC5wZW5kaW5nLnNlcTsgLy8gaW5kaWNhdG9yIHNlcSBudW1iZXIgaGVyZSB3aGljaCBpcyBnZXR0aW5nIHVwZGF0ZWQuXG4gICAgICAgICAgICAgICAgaW5kaWNhdG9yTW9kZWwuaW5zdGFuY2VzLnB1c2goaW5zdGFuY2VNb2RlbCk7XG4gICAgICAgICAgICAgICAgbW9kZWwucHVzaChpbmRpY2F0b3JNb2RlbCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdQcm9jZXNzIGluZGljYXRvciBtb2RlbCB1cGRhdGVkLicsIG1vZGVsKTtcbiAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pXG59O1xuXG4vKipcbiAqIFByb2Nlc3MgYXNzaWduIHVzZXJcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvY2Vzc0lkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2UgcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdWJQcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdWItcHJvY2VzcyBpZFxuICogQHBhcmFtIHtudW1iZXJ9IHN1YlByb2Nlc3NTZXEgLSB0aGUgV29ya2Zsb3cgaW5zdGFuY2Ugc3ViLXByb2Nlc3Mgc2VxXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RlcElkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gc3RlcCBpZFxuICogQHBhcmFtIHtzdHJpbmd9IHRyYW5zaXRpb25JZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHRyYW5zaXRpb24gaWRcbiAqIEBwYXJhbSB7b2JqZWN0fSB1c2VyIC0gdGhlIHVzZXIgdG8gYXNzaWduIHRvXG4gKiBAcGFyYW0ge29iamVjdH0gX1dGSW5zdGFuY2UgLSB0aGUgY3VycmVudCB3b3JrZmxvdyBjb25zdHJ1Y3RvciBpbnN0YW5jZVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gYXNzaWduVXNlcihwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgdXNlciwgdXVpZCwgX1dGSW5zdGFuY2UpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgIC8vIEdldCB0aGUgY3VycmVudCBzdWJQcm9jZXNzIGluc3RhbmNlIGRhdGFcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgIF9XRkluc3RhbmNlLmluc3RhbmNlLnByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24gKG9ialByb2Nlc3MpIHtcbiAgICAgICAgICAgICAgICBpZiAob2JqUHJvY2Vzcy5pZCA9PSBwcm9jZXNzSWQgJiYgb2JqUHJvY2Vzcy5zZXEgPT0gcHJvY2Vzc1NlcSkge1xuICAgICAgICAgICAgICAgICAgICBvYmpQcm9jZXNzLnN1YlByb2Nlc3Nlcy5maWx0ZXIoZnVuY3Rpb24gKG9ialN1YlByb2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmpTdWJQcm9jZXNzLmlkID09IHN1YlByb2Nlc3NJZCAmJiBvYmpTdWJQcm9jZXNzLnNlcSA9PSBzdWJQcm9jZXNzU2VxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXVpZCA9IG9ialN1YlByb2Nlc3MudXVpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICBfV0ZJbnN0YW5jZS5zdWJwcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHN1YlByb2Nlc3NJdGVtKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN1YlByb2Nlc3NJdGVtLl9pZCA9PSB1dWlkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vQWRkZWQgdG8gaHN0b3J5XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzSXRlbS5zdGVwLmFzc2lnbm1lbnRIaXN0b3J5ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25tZW50SGlzdG9yeSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWJQcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8udXNlcklkICE9IFwiXCIgJiYgc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLm5hbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25tZW50SGlzdG9yeS5wdXNoKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvKSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIHVzZXIgZGV0YWlsc1xuICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8udXNlcklkID0gdXNlci5pZDtcbiAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLm5hbWUgPSB1c2VyLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUby5kYXRlVGltZSA9IG1vbWVudCgpLmZvcm1hdCgpO1xuICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8udHlwZSA9IEFTU0lHTk1FTlRfVFlQRV9SRUFTU0lHTk1FTlQ7XG4gICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUby5kdWVEYXRlVGltZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBzdWJQcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8uYnkgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBpbmRpY2F0b3JzIHVzZXIgZGV0YWlsc1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kaWNhdG9ycyA9IHN1YlByb2Nlc3NJdGVtLmluZGljYXRvcnM7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW5kaWNhdG9ycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvciA9IGluZGljYXRvcnNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGluZGljYXRvci5pbnN0YW5jZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSBpbmRpY2F0b3IuaW5zdGFuY2VzW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZG9jID0gX1dGSW5zdGFuY2UuaW5kaWNhdG9yc1trXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlLnV1aWQgPT0gZG9jLl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jLndvcmtmbG93cy5maWx0ZXIoZnVuY3Rpb24od29ya2Zsb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAod29ya2Zsb3cuaWQgPT0gX1dGSW5zdGFuY2UuY29uZmlnLl9pZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JrZmxvdy5wcm9jZXNzZXMuZmlsdGVyKGZ1bmN0aW9uKHByb2Nlc3NJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2Vzc0l0ZW0uaWQgPT0gcHJvY2Vzc0lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSB1c2VyIGlkIGFuZCBuYW1lIGluIHRoZSBkb2N1bWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUby51c2VySWQgPSB1c2VyLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NJdGVtLnN0ZXAuYXNzaWduZWRUby5uYW1lID0gdXNlci5uYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vU2VuZCBhc3NpZ24gdXNlciBub3RpZmljYXRpb24gZnJvbSBoZXJlXG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddL25vdGlmaWNhdGlvbnNcIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbiAhPSB1bmRlZmluZWQgJiYgbm90aWZpY2F0aW9uLnJlQXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24ucmVBc3NpZ25tZW50Tm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3VjY2VzcyA9IHV0aWwuc3VjY2VzcygnVXNlciBhc3NpZ25lZCBzdWNjZXNzZnVsbHkuIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJywgc3ViUHJvY2Vzc0l0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShmYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInLCBzdWJQcm9jZXNzSXRlbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuXG5cblxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogUHJvY2VzcyBpbmRpY2F0b3IgZG9jdW1lbnQgdXBkYXRlc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBhY3Rpb25zIC0gdGhlIGFjdGlvbnMgY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBzdWJQcm9jZXNzIC0gdGhlIGN1cnJlbnQgc3ViLXByb2Nlc3MgZm9ybSBjb25maWcgZGF0YVxuICogQHBhcmFtIHtvYmplY3R9IF9XRkluc3RhbmNlIC0gdGhlIGN1cnJlbnQgd29ya2Zsb3cgY29uc3RydWN0b3IgaW5zdGFuY2VcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cbmZ1bmN0aW9uIGluZGljYXRvckRvY3MocHJvY2Vzc0lkLCBpbmRpY2F0b3JzLCBzdGVwLCBfV0ZJbnN0YW5jZSkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgaW5kaWNhdG9yIHNlY3Rpb25zIG9mIHRoZSBzdWJQcm9jZXNzXG4gICAgICAgICAgICBpZiAoaW5kaWNhdG9ycyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSB1dGlsLmVycm9yKCdXRkluZGljYXRvcnNVcGRhdGUnLCAnSW5kaWNhdG9ycyBwYXJhbWV0ZXIgaXMgcmVxdWlyZWQuIC0gVmFsdWU6ICcgKyBpbmRpY2F0b3JzKVxuICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluZGljYXRvcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvciA9IGluZGljYXRvcnNbaV07XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaW5kaWNhdG9yLmluc3RhbmNlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluc3RhbmNlID0gaW5kaWNhdG9yLmluc3RhbmNlc1tqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgX1dGSW5zdGFuY2UuaW5kaWNhdG9ycy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkb2MgPSBfV0ZJbnN0YW5jZS5pbmRpY2F0b3JzW2tdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnN0YW5jZS51dWlkID09IGRvYy5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jLndvcmtmbG93cy5maWx0ZXIoZnVuY3Rpb24od29ya2Zsb3cpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3b3JrZmxvdy5pZCA9PSBfV0ZJbnN0YW5jZS5jb25maWcuX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd29ya2Zsb3cucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihwcm9jZXNzSXRlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2Vzc0l0ZW0uaWQgPT0gcHJvY2Vzc0lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzSXRlbS5zdGVwLmlkID0gc3RlcC5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NJdGVtLnN0ZXAuc2VxID0gc3RlcC5zZXE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzSXRlbS5zdGVwLnN0YXR1cyA9IHN0ZXAuc3RhdHVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3RlcC5tZXNzYWdlID0gc3RlcC5tZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3RlcC5hc3NpZ25lZFRvLnVzZXJJZCA9IHN0ZXAuYXNzaWduZWRUby51c2VySWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzSXRlbS5zdGVwLmFzc2lnbmVkVG8ubmFtZSA9IHN0ZXAuYXNzaWduZWRUby5uYW1lO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0l0ZW0uc3RlcC5jb21tZW50ID0gc3RlcC5jb21tZW50ICE9PSB1bmRlZmluZWQgPyBzdGVwLmNvbW1lbnQgOiAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdJbmRpY2F0b3IgZG9jdW1lbnRzIHdvcmtmbG93IHByb2Nlc3MgbW9kZWwgdXBkYXRlZC4nLCBfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShzdWNjZXNzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KVxufTtcblxuLyoqXG4gKiBQcm9jZXNzIGFjdGlvbnNcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gYWN0aW9ucyAtIHRoZSBhY3Rpb25zIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gc3ViUHJvY2VzcyAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIGZvcm0gY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5cbmZ1bmN0aW9uIGFjdGlvbnMoYWN0aW9ucywgcHJvY2Vzc0lkLCBwcm9jZXNzU2VxLCBzdWJQcm9jZXNzSWQsIHN1YlByb2Nlc3NTZXEsIHN1YlByb2Nlc3MsIHN0ZXAsIF9XRkluc3RhbmNlLCBkYXRhLCB1dWlkKSB7XG4gICAgdmFyIGFyckFjdGlvbnMgPSBbXTtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHV0aWwuc3luY0xvb3AoYWN0aW9ucy5sZW5ndGgsIGZ1bmN0aW9uKGxvb3ApIHtcbiAgICAgICAgICAgIHZhciBjb3VudGVyID0gbG9vcC5pdGVyYXRpb24oKTtcbiAgICAgICAgICAgIGFjdGlvbihhY3Rpb25zW2NvdW50ZXJdLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2Vzcywgc3RlcCwgX1dGSW5zdGFuY2UsIGRhdGEsIHV1aWQpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXRBY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogYWN0aW9uc1tjb3VudGVyXS5faWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXE6IGNvdW50ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiByZXN1bHRcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICBhcnJBY3Rpb25zLnB1c2gocmV0QWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgbG9vcC5uZXh0KCk7XG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvb3AuYnJlYWsoKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0FjdGlvbnMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCBhcnJBY3Rpb25zKTtcbiAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufTtcblxuLyoqXG4gKiBQcm9jZXNzIGFjdGlvblxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBhY3Rpb24gLSB0aGUgYWN0aW9uIGNvbmZpZyBkYXRhXG4gKiBAcGFyYW0ge29iamVjdH0gc3ViUHJvY2VzcyAtIHRoZSBjdXJyZW50IHN1Yi1wcm9jZXNzIGZvcm0gY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBhY3Rpb24oYWN0aW9uLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2Vzcywgc3RlcCwgX1dGSW5zdGFuY2UsIGRhdGEsIHV1aWQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgaWYgKGFjdGlvbi5tZXRob2QgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgbWV0aG9kUG9zc2libGVJdGVtcyA9IFtcImZvcm1cIiwgXCJpbmRpY2F0b3JcIiwgXCJwcm9maWxlXCIsIFwic3ViUHJvY2Vzc0luc3RhbmNlXCIsIFwic3RlcFwiLCBcImNvbW11bml0eVwiLCBcImFwcGxpY2F0aW9uXCIsIFwidXNlclwiLCBcInNkb1wiLCBcInBlcmZvcm1hbmNlXCIsIFwidGF4b25vbXlcIiwgXCJ2YXJpYWJsZXNcIiwgXCJub3RpZmljYXRpb25cIiwgXCJyZXBvcnRcIiwgXCJ3b3JrZXJcIiwgXCJwYXJ0aWNpcGFudHNcIl07XG4gICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2QsIG1ldGhvZFBvc3NpYmxlSXRlbXMpKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnZm9ybSc6XG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpb24ubWV0aG9kLmZvcm0uY3JlYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHByb2Nlc3NJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3RlcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwcm9jZXNzU2VxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChzdWJQcm9jZXNzU2VxKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmNyZWF0ZVR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEuYmFzZVVVSUQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtLmNyZWF0ZShhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5tZXRob2QuZm9ybS5hdXRob3Jpc2UgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc0lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChzdWJQcm9jZXNzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwcm9jZXNzU2VxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChzdWJQcm9jZXNzU2VxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5jcmVhdGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmJhc2VVVUlEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uYXV0aG9yaXNlKGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5mb3JtLnVuZHJhZnQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmNyZWF0ZVR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEuYmFzZVVVSUQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5zZXRVbkRyYWZ0KGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5mb3JtLmRyYWZ0ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5jcmVhdGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmJhc2VVVUlEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uc2V0RHJhZnQoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24ubWV0aG9kLmZvcm0uY2xvc2UgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzcy5pbmRpY2F0b3JzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5jcmVhdGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmJhc2VVVUlEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uY2xvc2UoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24ubWV0aG9kLmZvcm0uYXV0aG9yaXNlQW5kQ3JlYXRlTmV3U2VxICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHByb2Nlc3NJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc1NlcSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzc1NlcSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEuY3JlYXRlVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2godXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5iYXNlVVVJRCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtLmF1dGhvcmlzZShhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIG5ldyBzZXF1ZW5jZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc0lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHN0ZXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwcm9jZXNzU2VxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3ViUHJvY2Vzc1NlcSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmNyZWF0ZVR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2godXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5jcmVhdGUoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vRWQgY3JlYXRpb24gb2YgbmV3IHNlcXVlbmNlXG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdpbmRpY2F0b3InOlxuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3IuY3JlYXRlICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFwiTm90IGltcGxlbWVudGVkXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3IuaW5zdGFudGlhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJOb3QgaW1wbGVtZW50ZWRcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24ubWV0aG9kLmluZGljYXRvci5zZXRWYWx1ZSAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGggPSBhY3Rpb24ubWV0aG9kLmluZGljYXRvci5zZXRWYWx1ZS5wYXRoO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWxwZXIuZ2V0Tm9kZVZhbHVlKGFjdGlvbi5tZXRob2QuaW5kaWNhdG9yLnNldFZhbHVlLmRhdGEsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGFWYWx1ZSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goX1dGSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocGF0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKGRhdGFWYWx1ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtLnVwZGF0ZUluZGljYXRvcihhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5tZXRob2QuaW5kaWNhdG9yLnVwZGF0ZVN0YXR1cyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldElkID0gYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3IuaW5kaWNhdG9yU2V0SWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKF9XRkluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvbi5tZXRob2QuaW5kaWNhdG9yLnVwZGF0ZVN0YXR1cyAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhdHVzID0gYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3IudXBkYXRlU3RhdHVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChzdGF0dXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChpbmRpY2F0b3JTZXRJZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gS2VlcCBpbmRpY2F0b3IgZnVuY3Rpb25zIGluIGluZGlhdG9yIGZpbGUgaXN0ZWFkIG9mIGZvcm0gZmlsZS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtLm1hcmtVcGRhdGVJbmRpY2F0b3IoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJBY3Rpb24gaW5kaWNhdG9yIHN1YiB0eXBlIG5vdCBmb3VuZC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24ubWV0aG9kLmluZGljYXRvci5zZXRXcmFwcGVyRWxlbWVudCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGggPSBhY3Rpb24ubWV0aG9kLmluZGljYXRvci5zZXRXcmFwcGVyRWxlbWVudC5wYXRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGljYXRvclNldElkID0gYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3Iuc2V0V3JhcHBlckVsZW1lbnQuaW5kaWNhdG9yU2V0SWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUoYWN0aW9uLm1ldGhvZC5pbmRpY2F0b3Iuc2V0V3JhcHBlckVsZW1lbnQuZGF0YSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YVZhbHVlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJncy5wdXNoKHV1aWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YVZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goaW5kaWNhdG9yU2V0SWQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS51cGRhdGVJbmRpY2F0b3JXcmFwcGVyKGFyZ3MpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdwcm9maWxlJzpcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvbi5tZXRob2QucHJvZmlsZS5jcmVhdGUgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2gocHJvY2Vzc0lkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goZGF0YS5jcmVhdGVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaCh1dWlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhLmJhc2VVVUlEKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm0uY3JlYXRlUHJvZmlsZShhcmdzKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5tZXRob2QucHJvZmlsZS5zZXRTdGF0dXNUbyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSBhY3Rpb24ubWV0aG9kLnByb2ZpbGUuc2V0U3RhdHVzVG87XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MucHVzaChfV0ZJbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2godXVpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzLnB1c2goc3RhdHVzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybS5zZXRTdGF0dXMoYXJncykudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3N1YlByb2Nlc3NJbnN0YW5jZSc6XG4gICAgICAgICAgICAgICAgICAgIHZhciBzcFBvc3NpYmxlSXRlbXMgPSBbXCJpbnN0YW50aWF0ZVwiLCBcImF1dGhvcmlzZVwiLCBcImNsb3NlXCIsIFwic2V0VmFyaWFibGVcIiwgXCJzZXRTdGF0dXNUb1wiLCBcInNldFN0YXR1c01zZ1RvXCIsIFwic2V0VGl0bGVcIiwgXCJzZXRWYWxpZERhdGVcIiwgXCJzZXRTUFN0YXR1c1wiXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhhY3Rpb24ubWV0aG9kLnN1YlByb2Nlc3NJbnN0YW5jZSwgc3BQb3NzaWJsZUl0ZW1zKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzZXRUaXRsZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShhY3Rpb24ubWV0aG9kLnN1YlByb2Nlc3NJbnN0YW5jZS5zZXRUaXRsZSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YVZhbHVlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5zdWJQcm9jZXNzSW5zdGFuY2Uuc2V0VGl0bGUoYWN0aW9uLm1ldGhvZC5zdWJQcm9jZXNzSW5zdGFuY2Uuc2V0VGl0bGUsIHV1aWQsIGRhdGFWYWx1ZSwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL3VwZGF0ZSBzdWJwcm9jZXNzIGxhYmVsIGluIHdvcmtmbG93IGluc3RhbmNlIHByb2Nlc3Mgb2JqZWN0OiBUT0RPXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NldFZhbGlkRGF0ZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShhY3Rpb24ubWV0aG9kLnN1YlByb2Nlc3NJbnN0YW5jZS5zZXRWYWxpZERhdGUsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKGRhdGFWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLnN1YlByb2Nlc3NJbnN0YW5jZS5zZXRWYWxpZERhdGUoYWN0aW9uLm1ldGhvZC5zdWJQcm9jZXNzSW5zdGFuY2Uuc2V0VmFsaWREYXRlLCB1dWlkLCBkYXRhVmFsdWUsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdXBkYXRlIHN1YnByb2Nlc3MgbGFiZWwgaW4gd29ya2Zsb3cgaW5zdGFuY2UgcHJvY2VzcyBvYmplY3Q6IFRPRE9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzZXRTUFN0YXR1cyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZShhY3Rpb24ubWV0aG9kLnN1YlByb2Nlc3NJbnN0YW5jZS5zZXRTUFN0YXR1cywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnNNb2R1bGUuc3ViUHJvY2Vzc0luc3RhbmNlLnNldFNQU3RhdHVzKGFjdGlvbi5tZXRob2Quc3ViUHJvY2Vzc0luc3RhbmNlLnNldFNQU3RhdHVzLCB1dWlkLCBkYXRhVmFsdWUsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vdXBkYXRlIHN1YnByb2Nlc3MgbGFiZWwgaW4gd29ya2Zsb3cgaW5zdGFuY2UgcHJvY2VzcyBvYmplY3Q6IFRPRE9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdCBpbiBzdWJwcm9jZXNzIGFjdGlvbi5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdzdGVwJzpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnY29tbXVuaXR5JzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbW11bml0eVBvc3NpYmxlSXRlbXMgPSBbXCJjcmVhdGVDb21tdW5pdHlcIiwgXCJyZWxlYXNlQWRvcHRlZEFwcGxpY2F0aW9uXCIsIFwidXNlckpvaW5Db21tdW5pdHlcIl07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoYWN0aW9uLm1ldGhvZC5jb21tdW5pdHksIGNvbW11bml0eVBvc3NpYmxlSXRlbXMpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZUNvbW11bml0eSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUuY29tbXVuaXR5LmNyZWF0ZUNvbW11bml0eShhY3Rpb24ubWV0aG9kLmNvbW11bml0eS5jcmVhdGVDb21tdW5pdHksIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JlbGVhc2VBZG9wdGVkQXBwbGljYXRpb24nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLmNvbW11bml0eS5yZWxlYXNlQWRvcHRlZEFwcGxpY2F0aW9uKGFjdGlvbi5tZXRob2QuY29tbXVuaXR5LnJlbGVhc2VBZG9wdGVkQXBwbGljYXRpb24sIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3VzZXJKb2luQ29tbXVuaXR5JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5jb21tdW5pdHkudXNlckpvaW5Db21tdW5pdHkoYWN0aW9uLm1ldGhvZC5jb21tdW5pdHkudXNlckpvaW5Db21tdW5pdHksIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdhcHBsaWNhdGlvbic6XG4gICAgICAgICAgICAgICAgICAgIHZhciBhcHBsaWNhdGlvblBvc3NpYmxlSXRlbXMgPSBbXCJjcmVhdGVBcHBEZWZpbml0aW9uXCIsIFwiYnVpbGRBcHBsaWNhdGlvblwiLCBcImFwcGxpY2F0aW9uQWRvcHRpb25cIl07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoYWN0aW9uLm1ldGhvZC5hcHBsaWNhdGlvbiwgYXBwbGljYXRpb25Qb3NzaWJsZUl0ZW1zKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjcmVhdGVBcHBEZWZpbml0aW9uJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5hcHBsaWNhdGlvbi5jcmVhdGVBcHBEZWZpbml0aW9uKGFjdGlvbi5tZXRob2QuYXBwbGljYXRpb24uY3JlYXRlQXBwRGVmaW5pdGlvbiwgdXVpZCwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnYnVpbGRBcHBsaWNhdGlvbic6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUuYXBwbGljYXRpb24uYnVpbGRBcHBsaWNhdGlvbihhY3Rpb24ubWV0aG9kLmFwcGxpY2F0aW9uLmJ1aWxkQXBwbGljYXRpb24sIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FwcGxpY2F0aW9uQWRvcHRpb24nOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLmFwcGxpY2F0aW9uLmFwcGxpY2F0aW9uQWRvcHRpb24oYWN0aW9uLm1ldGhvZC5hcHBsaWNhdGlvbi5hcHBsaWNhdGlvbkFkb3B0aW9uLCB1dWlkLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICd1c2VyJzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXJQb3NzaWJsZUl0ZW1zID0gW1wiYWRkVG9Sb2xlXCJdO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2QudXNlciwgdXNlclBvc3NpYmxlSXRlbXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdhZGRUb1JvbGUnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnVzZXIuYWRkVG9Sb2xlKGFjdGlvbi5tZXRob2QudXNlci5hZGRUb1JvbGUsIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2RvJzpcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNkb1Bvc3NpYmxlSXRlbXMgPSBbXCJjcmVhdGVcIiwgXCJlbnJvbGxDb3Vyc2VcIl07XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoYWN0aW9uLm1ldGhvZC5zZG8sIHNkb1Bvc3NpYmxlSXRlbXMpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUuc2RvLmNyZWF0ZShhY3Rpb24ubWV0aG9kLnNkby5jcmVhdGUsIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdlbnJvbGxDb3Vyc2UnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnNkby5lbnJvbGxDb3Vyc2UoYWN0aW9uLm1ldGhvZC5zZG8uZW5yb2xsQ291cnNlLCB1dWlkLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdwZXJmb3JtYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgIHZhciBwZXJmb3JtYW5jZVBvc3NpYmxlSXRlbXMgPSBbXCJ1bmxvY2tQZXJpb2RcIiwgXCJsb2NrUGVyZm9ybWFuY2VNb2RlbFwiLCBcInNldE1vZGVsU3RhdHVzXCJdO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2QucGVyZm9ybWFuY2UsIHBlcmZvcm1hbmNlUG9zc2libGVJdGVtcykpIHtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd1bmxvY2tQZXJpb2QnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnBlcmZvcm1hbmNlLnVubG9ja1BlcmlvZChhY3Rpb24ubWV0aG9kLnBlcmZvcm1hbmNlLnVubG9ja1BlcmlvZCwgdXVpZCwgX1dGSW5zdGFuY2UpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NldE1vZGVsU3RhdHVzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5wZXJmb3JtYW5jZS5zZXRNb2RlbFN0YXR1cyhhY3Rpb24ubWV0aG9kLnBlcmZvcm1hbmNlLnNldE1vZGVsU3RhdHVzLCB1dWlkLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbG9ja1BlcmZvcm1hbmNlTW9kZWwnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnBlcmZvcm1hbmNlLmxvY2tQZXJmb3JtYW5jZU1vZGVsKGFjdGlvbi5tZXRob2QucGVyZm9ybWFuY2UubG9ja1BlcmZvcm1hbmNlTW9kZWwsIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJObyBtZXRob2QgZm91bmQgZnJvbSBpbXBsZW1lbnRlZCBsaXN0LlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAndGF4b25vbXknOlxuICAgICAgICAgICAgICAgICAgICB2YXIgdGF4b25vbXlQb3NzaWJsZUl0ZW1zID0gW1wiY3JlYXRlXCJdO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2QudGF4b25vbXksIHRheG9ub215UG9zc2libGVJdGVtcykpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnY3JlYXRlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS50YXhvbm9teS5jcmVhdGUoYWN0aW9uLm1ldGhvZC50YXhvbm9teS5jcmVhdGUsIHV1aWQsIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICd2YXJpYWJsZXMnOlxuICAgICAgICAgICAgICAgICAgICB2YXIgdmFyaWFibGVzUG9zc2libGVJdGVtcyA9IFtcInNldFZhcmlhYmxlXCJdO1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5RXhpc3RzKGFjdGlvbi5tZXRob2QudmFyaWFibGVzLCB2YXJpYWJsZXNQb3NzaWJsZUl0ZW1zKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzZXRWYXJpYWJsZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS52YXJpYWJsZXMuc2V0VmFyaWFibGUoYWN0aW9uLm1ldGhvZC52YXJpYWJsZXMuc2V0VmFyaWFibGUsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdub3RpZmljYXRpb24nOlxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLm5vdGlmaWNhdGlvbi5zZW5kTm90aWZpY2F0aW9uV29ya2VyKGFjdGlvbi5tZXRob2Qubm90aWZpY2F0aW9uLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdyZXBvcnQnOlxuICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICogXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVwb3J0UG9zc2libGVJdGVtcyA9IFtcImNyZWF0ZVBlcmZvcm1hbmNlUmVwb3J0XCIsIFwiY3JlYXRlUmVwb3J0XCIsIFwic2RvUmVwb3J0XCIsIFwiZXhlY3V0ZVJlcG9ydFwiLCBcInJlcXVlc3RSZXBvcnRcIiwgXCJnZW5lcmF0ZVZpZXdcIiwgXCJnZW5lcmF0ZUJhc2ljVmlld1wiLCBcImdlbmVyYXRlVW5pb25WaWV3XCIsIFwic2RvUmVwb3J0TXVsdGlwbGVcIiwgXCJzdWJwcm9maWxlUXVhcnRlcmx5UmVwb3J0XCJdO1xuXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocHJvcGVydHlFeGlzdHMoYWN0aW9uLm1ldGhvZC5yZXBvcnQsIHJlcG9ydFBvc3NpYmxlSXRlbXMpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZVBlcmZvcm1hbmNlUmVwb3J0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5yZXBvcnQuY3JlYXRlUGVyZm9ybWFuY2VSZXBvcnQoYWN0aW9uLm1ldGhvZC5yZXBvcnQuY3JlYXRlUGVyZm9ybWFuY2VSZXBvcnQsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZVJlcG9ydCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucmVwb3J0LmNyZWF0ZVJlcG9ydChhY3Rpb24ubWV0aG9kLnJlcG9ydC5jcmVhdGVSZXBvcnQsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzZG9SZXBvcnQnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnJlcG9ydC5zZG9SZXBvcnQoYWN0aW9uLm1ldGhvZC5yZXBvcnQuc2RvUmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZXhlY3V0ZVJlcG9ydCc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucmVwb3J0LmV4ZWN1dGVSZXBvcnQoYWN0aW9uLm1ldGhvZC5yZXBvcnQuZXhlY3V0ZVJlcG9ydCwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2dlbmVyYXRlVmlldyc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucmVwb3J0LmdlbmVyYXRlVmlldyhhY3Rpb24ubWV0aG9kLnJlcG9ydC5nZW5lcmF0ZVZpZXcsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdyZXF1ZXN0UmVwb3J0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5yZXBvcnQucmVxdWVzdFJlcG9ydChhY3Rpb24ubWV0aG9kLnJlcG9ydC5yZXF1ZXN0UmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZ2VuZXJhdGVCYXNpY1ZpZXcnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnJlcG9ydC5nZW5lcmF0ZUJhc2ljVmlldyhhY3Rpb24ubWV0aG9kLnJlcG9ydC5nZW5lcmF0ZUJhc2ljVmlldywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2dlbmVyYXRlVW5pb25WaWV3JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5yZXBvcnQuZ2VuZXJhdGVVbmlvblZpZXcoYWN0aW9uLm1ldGhvZC5yZXBvcnQuZ2VuZXJhdGVVbmlvblZpZXcsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3Nkb1JlcG9ydE11bHRpcGxlJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5yZXBvcnQuc2RvUmVwb3J0TXVsdGlwbGUoYWN0aW9uLm1ldGhvZC5yZXBvcnQuc2RvUmVwb3J0TXVsdGlwbGUsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdzdWJwcm9maWxlUXVhcnRlcmx5UmVwb3J0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5yZXBvcnQuc3VicHJvZmlsZVF1YXJ0ZXJseVJlcG9ydChhY3Rpb24ubWV0aG9kLnJlcG9ydC5zdWJwcm9maWxlUXVhcnRlcmx5UmVwb3J0LCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gbWV0aG9kIGZvdW5kIGZyb20gaW1wbGVtZW50ZWQgbGlzdC5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ3dvcmtlcic6XG4gICAgICAgICAgICAgICAgICAgIHZhciB3b3JrZXJQb3NzaWJsZUl0ZW1zID0gW1wic2VuZFdvcmtlclwiLCBcImV4ZWN1dGVMb2NhbFwiLCBcImNyZWF0ZVwiXTtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhhY3Rpb24ubWV0aG9kLndvcmtlciwgd29ya2VyUG9zc2libGVJdGVtcykpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc2VuZFdvcmtlcic6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS53b3JrZXIuc2VuZFdvcmtlcihhY3Rpb24ubWV0aG9kLndvcmtlci5zZW5kV29ya2VyLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdleGVjdXRlTG9jYWwnOlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUud29ya2VyLmV4ZWN1dGVMb2NhbChhY3Rpb24ubWV0aG9kLndvcmtlci5leGVjdXRlTG9jYWwsIF9XRkluc3RhbmNlLCB1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0ZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS53b3JrZXIuY3JlYXRlKGFjdGlvbi5tZXRob2Qud29ya2VyLmNyZWF0ZSwgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJObyBtZXRob2QgZm91bmQgZnJvbSBpbXBsZW1lbnRlZCBsaXN0LlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG5cblxuICAgICAgICAgICAgICAgIGNhc2UgJ3BhcnRpY2lwYW50cyc6XG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiBcbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0aWNpcGFudFBvc3NpYmxlSXRlbXMgPSBbXCJsaW5rUGFydGljaXBhbnRzXCIsIFwibW9udGhseUF0dGVuZGFuY2VcIiwgXCJtb250aGx5UHJvZ3Jlc3NTdW1tYXJ5XCIsIFwicGFydGljaXBhbnRDb250cmFjdHNcIl07XG5cbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChwcm9wZXJ0eUV4aXN0cyhhY3Rpb24ubWV0aG9kLnBhcnRpY2lwYW50cywgcGFydGljaXBhbnRQb3NzaWJsZUl0ZW1zKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdsaW5rUGFydGljaXBhbnRzJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5wYXJ0aWNpcGFudHMubGlua1BhcnRpY2lwYW50cyhhY3Rpb24ubWV0aG9kLnBhcnRpY2lwYW50cy5saW5rUGFydGljaXBhbnRzLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtb250aGx5QXR0ZW5kYW5jZSc6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbnNNb2R1bGUucGFydGljaXBhbnRzLm1vbnRobHlBdHRlbmRhbmNlKGFjdGlvbi5tZXRob2QucGFydGljaXBhbnRzLm1vbnRobHlBdHRlbmRhbmNlLCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtb250aGx5UHJvZ3Jlc3NTdW1tYXJ5JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYWN0aW9uc01vZHVsZS5wYXJ0aWNpcGFudHMubW9udGhseVByb2dyZXNzU3VtbWFyeShhY3Rpb24ubWV0aG9kLnBhcnRpY2lwYW50cy5tb250aGx5UHJvZ3Jlc3NTdW1tYXJ5LCBfV0ZJbnN0YW5jZSwgdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncGFydGljaXBhbnRDb250cmFjdHMnOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zTW9kdWxlLnBhcnRpY2lwYW50cy5wYXJ0aWNpcGFudENvbnRyYWN0cyhhY3Rpb24ubWV0aG9kLnBhcnRpY2lwYW50cy5wYXJ0aWNpcGFudENvbnRyYWN0cywgX1dGSW5zdGFuY2UsIHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChcIk5vIG1ldGhvZCBmb3VuZCBmcm9tIGltcGxlbWVudGVkIGxpc3QuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cblxuXG5cblxuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwibWV0aG9kIG5vdCBkZWZpbmVkIGluIGNvbmZpZ3VyYXRpb25cIik7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoXCJObyBtZXRob2QgZm91bmQgZnJvbSBpbXBsZW1lbnRlZCBsaXN0LlwiKTtcblxuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogUHJvY2VzcyB0YXNrc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSB0YXNrIC0gdGhlIHRhc2sgY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBpbnB1dERhdGEgLSB0aGUgdXNlciBpbnB1dCBkYXRhXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiB0YXNrKHN1YnByb2Nlc3NJRCwgc3VicHJvY2Vzc1NFUSwgdGFzaywgc3B1dWlkLCBtb2RlbCkge1xuXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXG4gICAgICAgIHZhciBfV0ZJbnN0YW5jZSA9IGFwcC5TQ09QRS53b3JrZmxvdztcbiAgICAgICAgdmFyIHByZUFjdGlvbnNDb25mID0gdGFzay5wcmVBY3Rpb25zO1xuICAgICAgICBwcmVBY3Rpb25zKHByZUFjdGlvbnNDb25mLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHByZUFjdGlvblJlc3VsdCkge1xuXG4gICAgICAgICAgICB2YXIgbGlzdCA9IFtdO1xuICAgICAgICAgICAgaWYgKHRhc2suYXNzaWduLnJvbGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFzc2lnblR5cGUgPSAncHJvZmlsZVJvbGUnO1xuICAgICAgICAgICAgICAgIHZhciBwcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIHZhciBpZCA9ICcnO1xuICAgICAgICAgICAgICAgIGlmICh0YXNrLmFzc2lnbi5yb2xlLnByb2ZpbGUgPT0gJ2N1cnJlbnQnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlkID0gX1dGSW5zdGFuY2UucHJvZmlsZTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRhc2suYXNzaWduLnJvbGUucHJvZmlsZSA9PSAnY29tbXVuaXR5Jykge1xuICAgICAgICAgICAgICAgICAgICBpZCA9IGFwcC5TQ09QRS5nZXRDb21tdW5pdHlJZCgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciByb2xlID0gdGFzay5hc3NpZ24ucm9sZS5yb2xlSWQ7XG5cbiAgICAgICAgICAgICAgICBsaWJyYXJ5LmdldFVzZXJzTGlzdEJ5Um9sZShpZCwgcm9sZSkudGhlbihmdW5jdGlvbihsaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsaXN0ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGlzdC5sZW5ndGggPiAxKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOZXcgcmVxdWlyZW1lbnQgaGVyZSB3aWxsIGF1dG9tYXRpY2FsbHkgYXNzaWduIHRoZSBzdGVwIHRvIGN1cnJlbnQgdXNlciBpZiB0aGlzIHVzZXIgZmFsbHMgdW5kZXIgdGhlIHByb3ZpZGVkIGdyb3VwLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJVTEUgSU5UUk9EVUNFRCBPTiAxNi1NQVJDSC0yMDE3XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgY3VycmVudCB1c2VyIGxpZXMgd2l0aGluIHRoZSBzcGVjaWZpZWQgcm9sZSwgaXQgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHRvIHRoYXQgdXNlci5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc0N1cnJlbnRVc2VyRXhpc3RJbkdpdmVuUm9sZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByb2xlc09iamVjdCA9IGxpYnJhcnkuZ2V0Q3VycmVudFVzZXJSb2xlcygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQ3VycmVudFVzZXJSb2xlMSA9IHJvbGVzT2JqZWN0LnByb2ZpbGUuaW5kZXhPZihyb2xlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNDdXJyZW50VXNlclJvbGUyID0gcm9sZXNPYmplY3QuY29tbXVuaXR5LmluZGV4T2Yocm9sZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQ3VycmVudFVzZXJSb2xlMyA9IHJvbGVzT2JqZWN0LmltcGxpY2l0LmluZGV4T2Yocm9sZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQ3VycmVudFVzZXJSb2xlNCA9IHJvbGVzT2JqZWN0LmFkb3B0aW9uLmluZGV4T2Yocm9sZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzQ3VycmVudFVzZXJSb2xlNSA9IHJvbGVzT2JqZWN0LnN1YnByb2ZpbGUuaW5kZXhPZihyb2xlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0N1cnJlbnRVc2VyUm9sZTEgPiAtMSB8fCBpc0N1cnJlbnRVc2VyUm9sZTIgPiAtMSB8fCBpc0N1cnJlbnRVc2VyUm9sZTMgPiAtMSB8fCBpc0N1cnJlbnRVc2VyUm9sZTQgPiAtMSB8fCBpc0N1cnJlbnRVc2VyUm9sZTUgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0N1cnJlbnRVc2VyRXhpc3RJbkdpdmVuUm9sZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNDdXJyZW50VXNlckV4aXN0SW5HaXZlblJvbGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDdXJyZW50VXNlckV4aXN0SW5HaXZlblJvbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWduZWUgPSBtb2RlbC5hc3NpZ25lZFRvO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXNzaWduZWUudXNlcklkICE9IFwiXCIgJiYgYXNzaWduZWUubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3T2JqID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhc3NpZ25lZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkucHVzaChuZXdPYmopO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5uYW1lID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VybmFtZSArIFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLnVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUudHlwZSA9IEFTU0lHTk1FTlRfVFlQRV9BVVRPO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5kdWVEYXRlVGltZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5ieSA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RpZmljYXRpb24gdGhhdCBpdHMgYmVlbiBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHRvIHlvdVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1NlbmQgYXNzaWduIHVzZXIgbm90aWZpY2F0aW9uIGZyb20gaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm90aWZpY2F0aW9uID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YnByb2Nlc3NJRCArIFwiJ10vbm90aWZpY2F0aW9uc1wiLCBfV0ZJbnN0YW5jZS5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vdGlmaWNhdGlvbiAhPSB1bmRlZmluZWQgJiYgbm90aWZpY2F0aW9uLmFzc2lnbm1lbnQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlciA9IHsgJ2lkJzogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQsICduYW1lJzogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VybmFtZSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYXNzaWdubWVudE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25lZCBzdWNjZXNzZnVsbHkuIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKS5jYXRjaChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihmYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2suYXNzaWduLmFzc2lnbm1lbnQgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSBtb2RlbC5hc3NpZ25tZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWNjZXB0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93XCI6IHRhc2suYXNzaWduLmFzc2lnbm1lbnQuYWNjZXB0LnNob3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCI6IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQuYWNjZXB0LmxhYmVsLmkxOG4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5hY2NlcHQgPSBhY2NlcHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQubWVzc2FnZSA9IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQubWVzc2FnZS5pMThuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1wiOiB0YXNrLmFzc2lnbi5hc3NpZ25tZW50LnJlamVjdC5zaG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LnJlamVjdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucmVqZWN0ID0gcmVqZWN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBwcm9maWxlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInJvbGVJZFwiOiByb2xlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwicm9sZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC52YWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnByb2ZpbGVSb2xlSWQgPSBpZDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDdXJyZW50VXNlckV4aXN0SW5HaXZlblJvbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9GaXJlIFByZS13b3JrQWN0aW9ucyBoZXJlXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzW3N1YlByb2Nlc3Nlcy91dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1t1dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBJZCA9IEpTT04ueHBhdGgoXCIvc3VicHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL3N0ZXAvaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBKU09OLnhwYXRoKFwiL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgcHJvY2Vzc0lkICsgXCInXS9zdWJQcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YlByb2Nlc3NJZCArIFwiJ10vc3RlcHNbX2lkIGVxICdcIiArIHN0ZXBJZCArIFwiJ11cIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFzay5wcmVXb3JrQWN0aW9ucyAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZVdvcmtBY3Rpb25zT2JqID0gdGFzay5wcmVXb3JrQWN0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZVdvcmtBY3Rpb25zKHByZVdvcmtBY3Rpb25zT2JqLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnQXNzaWdubWVudCBpcyBtYWRlLiBQcmUgd29yayBhY3Rpb25zIGZvdW5kIGFuZCBleGVjdXRlZCAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ0Fzc2lnbm1lbnQgaXMgbWFkZS4gTm8gcHJlIHdvcmsgYWN0aW9ucyBmb3VuZC4gJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90aWZpY2F0aW9uIHRoYXQgaXRzIGJlZW4gcmVsZWFzZWQgZm9yIGFjY2VwdGFuY2VcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm90aWZpY2F0aW9uID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YnByb2Nlc3NJRCArIFwiJ10vbm90aWZpY2F0aW9uc1wiLCBfV0ZJbnN0YW5jZS5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9pc3N1ZSBoZXJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24gIT0gdW5kZWZpbmVkICYmIG5vdGlmaWNhdGlvbi5hc3NpZ25tZW50QWNjZXB0YW5jZSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VyID0geyAnaWQnOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZCwgJ25hbWUnOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJuYW1lIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLm5vdGlmaWNhdGlvbi5hY2NlcHRhbmNlTm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHNwdXVpZCwgcm9sZSkudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnTm90aWZpY2F0aW9ucyByZXF1ZXN0IHN1Ym1pdHRlZCBmb3IgYWNjZXB0YW5jZS4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApLmNhdGNoKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnTm90aWZpY2F0aW9ucyBmYWlsZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWdubWVudCBub3RpZmljYXRpb24gZmFpbGVkIHRvIHVzZXIgVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnTm90aWZpY2F0aW9ucyBub3QgZm91bmQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpc3QubGVuZ3RoID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbXBsZW1lbnQgaGVyZSBwcmVXb3JrQWN0aW9uIGFzIHRoaXMgaXMgYXV0b21hdGljYWxseSBhc3NpZ25lZCBpbiBjYXNlIG9mIDEgdXNlciBhbmQgd2lsbCBub3QgZ28gdHJvdWdoIGFjY2VwdGFuY2UgZnVuY3Rpb24uXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlcklkID0gbGlzdFswXS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlcm5hbWUgPSBsaXN0WzBdLm5hbWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXNzaWduZWUudXNlcklkICE9IFwiXCIgJiYgYXNzaWduZWUubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdPYmogPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGFzc2lnbmVlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5LnB1c2gobmV3T2JqKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUubmFtZSA9IHVzZXJuYW1lICsgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS51c2VySWQgPSB1c2VySWQgKyBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUudHlwZSA9IEFTU0lHTk1FTlRfVFlQRV9BVVRPO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmR1ZURhdGVUaW1lID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuYnkgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YXNrLmFzc2lnbi5hc3NpZ25tZW50ICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gbW9kZWwuYXNzaWdubWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjY2VwdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwic2hvd1wiOiB0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5zaG93LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQuYWNjZXB0ID0gYWNjZXB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50Lm1lc3NhZ2UgPSBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50Lm1lc3NhZ2UuaTE4bik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWplY3QgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3Quc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIjogX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3QubGFiZWwuaTE4bilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnJlamVjdCA9IHJlamVjdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJwcm9maWxlSWRcIjogcHJvZmlsZUlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJyb2xlSWRcIjogcm9sZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcInJvbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5wcm9maWxlUm9sZUlkID0gaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RpZmljYXRpb24gdGhhdCBpdHMgYmVlbiBhdXRvbWF0aWNhbGx5IGFzc2lnbmVkIHRvIHlvdVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU2VuZCBhc3NpZ24gdXNlciBub3RpZmljYXRpb24gZnJvbSBoZXJlXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbm90aWZpY2F0aW9uID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHN1YnByb2Nlc3NJRCArIFwiJ10vbm90aWZpY2F0aW9uc1wiLCBfV0ZJbnN0YW5jZS5jb25maWcsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uICE9IHVuZGVmaW5lZCAmJiBub3RpZmljYXRpb24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXIgPSB7ICdpZCc6IHVzZXJJZCwgJ25hbWUnOiB1c2VybmFtZSB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zTW9kdWxlLm5vdGlmaWNhdGlvbi5hc3NpZ25tZW50Tm90aWZpY2F0aW9uKG5vdGlmaWNhdGlvbiwgX1dGSW5zdGFuY2UsIHNwdXVpZCwgdXNlcikudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlciBhc3NpZ25lZCBzdWNjZXNzZnVsbHkuIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihmYWlsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXIgYXNzaWdubWVudCBub3RpZmljYXRpb24gZmFpbGVkIHRvIHVzZXIgVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0ZpcmUgUHJlLXdvcmtBY3Rpb25zIGhlcmVcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzSWQgPSBKU09OLnhwYXRoKFwiL2luc3RhbmNlL3Byb2Nlc3Nlc1tzdWJQcm9jZXNzZXMvdXVpZCBlcSAnXCIgKyBzcHV1aWQgKyBcIiddL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1t1dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcElkID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vc3RlcC9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbX2lkIGVxICdcIiArIHByb2Nlc3NJZCArIFwiJ10vc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJQcm9jZXNzSWQgKyBcIiddL3N0ZXBzW19pZCBlcSAnXCIgKyBzdGVwSWQgKyBcIiddXCIsIF9XRkluc3RhbmNlLmNvbmZpZywge30pWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2sucHJlV29ya0FjdGlvbnMgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZVdvcmtBY3Rpb25zT2JqID0gdGFzay5wcmVXb3JrQWN0aW9ucztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlV29ya0FjdGlvbnMocHJlV29ya0FjdGlvbnNPYmosIF9XRkluc3RhbmNlKS50aGVuKGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ0Fzc2lnbmVkIHRvIHRoZSBvbmx5IHVzZXIgaW4gcm9sZS4gUHJlIHdvcmsgYWN0aW9ucyBleGVjdXRlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ0Fzc2lnbmVkIHRvIHRoZSBvbmx5IHVzZXIgaW4gcm9sZS4gTm8gcHJlIHdvcmsgYWN0aW9ucyBmb3VuZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9DYXNlIHdoZXJlIHVzZXJzIGxpc3QgPSAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5uYW1lID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS51c2VySWQgPSBcIlwiO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFzc2lnbm1lbnQgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFzay5hc3NpZ24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXNzaWdubWVudCA9IG1vZGVsLmFzc2lnbm1lbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY2NlcHQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5hY2NlcHQuc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIjogX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5hY2NlcHQubGFiZWwuaTE4bilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LmFjY2VwdCA9IGFjY2VwdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5tZXNzYWdlID0gX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5tZXNzYWdlLmkxOG4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVqZWN0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93XCI6IHRhc2suYXNzaWduLmFzc2lnbm1lbnQucmVqZWN0LnNob3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImxhYmVsXCI6IF9nZXROYW1lQnlMYW5nKHRhc2suYXNzaWduLmFzc2lnbm1lbnQucmVqZWN0LmxhYmVsLmkxOG4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5yZWplY3QgPSByZWplY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicHJvZmlsZUlkXCI6IHByb2ZpbGVJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicm9sZUlkXCI6IHJvbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInR5cGVcIjogXCJyb2xlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQucHJvZmlsZVJvbGVJZCA9IGlkO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vV2lsbCBiZSBmaXJlZCBmcm9tIFRha2VBc3NpZ25tZW50IHBhdGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFwiTm8gdXNlcnMgZm91bmQgaW4gbGlzdC4gQXNzaWduaW5nIGJsYW5rIFwiKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRXJyb3IgaW4gZ2V0VXNlcnNMaXN0QnlSb2xlIHVuZGVmaW5lZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRXJyb3IgaW4gZ2V0VXNlcnNMaXN0QnlSb2xlJyk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0YXNrLmFzc2lnbi51c2VyICE9IHVuZGVmaW5lZCkge1xuXG4gICAgICAgICAgICAgICAgaGVscGVyLmdldE5vZGVWYWx1ZSh0YXNrLmFzc2lnbi51c2VyLnVzZXJOYW1lLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHVzZXJOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlbHBlci5nZXROb2RlVmFsdWUodGFzay5hc3NpZ24udXNlci51c2VySWQsIF9XRkluc3RhbmNlLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24odXNlcklkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VySWQgPSB1c2VySWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlcm5hbWUgPSB1c2VyTmFtZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5ID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25lZSA9IG1vZGVsLmFzc2lnbmVkVG87XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXNzaWduZWUudXNlcklkICE9IFwiXCIgJiYgYXNzaWduZWUubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld09iaiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXNzaWduZWUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeS5wdXNoKG5ld09iaik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5uYW1lID0gdXNlcm5hbWUgKyBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUudXNlcklkID0gdXNlcklkICsgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFzc2lnbmVlLmRhdGVUaW1lID0gbW9tZW50KCkuZm9ybWF0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS50eXBlID0gQVNTSUdOTUVOVF9UWVBFX0FVVE87XG4gICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25lZS5kdWVEYXRlVGltZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWduZWUuYnkgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZCArIFwiXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFzay5hc3NpZ24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhc3NpZ25tZW50ID0gbW9kZWwuYXNzaWdubWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWNjZXB0ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInNob3dcIjogdGFzay5hc3NpZ24uYXNzaWdubWVudC5hY2NlcHQuc2hvdyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJsYWJlbFwiOiBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50LmFjY2VwdC5sYWJlbC5pMThuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LmFjY2VwdCA9IGFjY2VwdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50Lm1lc3NhZ2UgPSBfZ2V0TmFtZUJ5TGFuZyh0YXNrLmFzc2lnbi5hc3NpZ25tZW50Lm1lc3NhZ2UuaTE4bik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzaG93XCI6IHRhc2suYXNzaWduLmFzc2lnbm1lbnQucmVqZWN0LnNob3csXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGFiZWxcIjogX2dldE5hbWVCeUxhbmcodGFzay5hc3NpZ24uYXNzaWdubWVudC5yZWplY3QubGFiZWwuaTE4bilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5yZWplY3QgPSByZWplY3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInByb2ZpbGVJZFwiOiBwcm9maWxlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwicm9sZUlkXCI6IHJvbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwidHlwZVwiOiBcInJvbGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3NpZ25tZW50LnZhbHVlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXNzaWdubWVudC5wcm9maWxlUm9sZUlkID0gaWQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdGlmaWNhdGlvbiB0aGF0IGl0cyBiZWVuIGF1dG9tYXRpY2FsbHkgYXNzaWduZWQgdG8geW91XG4gICAgICAgICAgICAgICAgICAgICAgICAvL1NlbmQgYXNzaWduIHVzZXIgbm90aWZpY2F0aW9uIGZyb20gaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbiA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBzdWJwcm9jZXNzSUQgKyBcIiddL25vdGlmaWNhdGlvbnNcIiwgX1dGSW5zdGFuY2UuY29uZmlnLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobm90aWZpY2F0aW9uICE9IHVuZGVmaW5lZCAmJiBub3RpZmljYXRpb24uYXNzaWdubWVudCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXNlciA9IHsgJ2lkJzogdXNlcklkLCAnbmFtZSc6IHVzZXJuYW1lIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uc01vZHVsZS5ub3RpZmljYXRpb24uYXNzaWdubWVudE5vdGlmaWNhdGlvbihub3RpZmljYXRpb24sIF9XRkluc3RhbmNlLCBzcHV1aWQsIHVzZXIpLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHN1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbmVkIHN1Y2Nlc3NmdWxseS4gVXNlcklkOiBcIicgKyB1c2VyLmlkICsgJ1wiLCBOYW1lOiBcIicgKyB1c2VyLm5hbWUgKyAnXCInKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICkuY2F0Y2goXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGZhaWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIGFzc2lnbm1lbnQgbm90aWZpY2F0aW9uIGZhaWxlZCB0byB1c2VyIFVzZXJJZDogXCInICsgdXNlci5pZCArICdcIiwgTmFtZTogXCInICsgdXNlci5uYW1lICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy9GaXJlIFByZS13b3JrQWN0aW9ucyBoZXJlXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJvY2Vzc0lkID0gSlNPTi54cGF0aChcIi9pbnN0YW5jZS9wcm9jZXNzZXNbc3ViUHJvY2Vzc2VzL3V1aWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pZFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YlByb2Nlc3NJZCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1t1dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vaWRcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGVwSWQgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9zdGVwL2lkXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RlcE9iamVjdCA9IEpTT04ueHBhdGgoXCIvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSWQgKyBcIiddL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3ViUHJvY2Vzc0lkICsgXCInXS9zdGVwc1tfaWQgZXEgJ1wiICsgc3RlcElkICsgXCInXVwiLCBfV0ZJbnN0YW5jZS5jb25maWcsIHt9KVswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhc2sucHJlV29ya0FjdGlvbnMgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJlV29ya0FjdGlvbnNPYmogPSB0YXNrLnByZVdvcmtBY3Rpb25zO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZVdvcmtBY3Rpb25zKHByZVdvcmtBY3Rpb25zT2JqLCBfV0ZJbnN0YW5jZSkudGhlbihmdW5jdGlvbihzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoJ0Fzc2lnbmVkIHRvIHRoZSBvbmx5IHVzZXIgaW4gcm9sZS4gUHJlIHdvcmsgYWN0aW9ucyBleGVjdXRlZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCdBc3NpZ25lZCB0byB0aGUgb25seSB1c2VyIGluIHJvbGUuIE5vIHByZSB3b3JrIGFjdGlvbnMgZm91bmQuJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRhc2suYXNzaWduLnN3aW1sYW5lICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoJ3N3aW1sYW5lJyk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1N3aW1sYW5lIGltcGxlbWVudGF0aW9uICEhJyk7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcblxuICAgICAgICAgICAgcmVqZWN0KGVycik7XG5cbiAgICAgICAgfSk7XG5cblxuXG5cbiAgICB9KTtcblxufTtcblxuXG5cbi8qKlxuICogUHJvY2VzcyB0YXNrc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSB0YXNrIC0gdGhlIHRhc2sgY29uZmlnIGRhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBpbnB1dERhdGEgLSB0aGUgdXNlciBpbnB1dCBkYXRhXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiBzZXJ2ZXIoc2VydmVyLCBwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgc3ViUHJvY2VzcywgbW9kZWwsIF9XRkluc3RhbmNlLCBkYXRhLCB1dWlkKSB7XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgLy92YXIgX1dGSW5zdGFuY2UgPSBhcHAuU0NPUEUud29ya2Zsb3c7XG4gICAgICAgIHZhciBwcm9maWxlSWQgPSBfV0ZJbnN0YW5jZS5wcm9maWxlO1xuICAgICAgICB2YXIgYWN0aW9uQmxvY2sgPSBzZXJ2ZXIuc2VydmVyQWN0aW9uWzBdO1xuICAgICAgICBpZiAobW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9IFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGFzc2lnbmVlID0gbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgaWYgKGFzc2lnbmVlLnVzZXJJZCAhPSBcIlwiICYmIGFzc2lnbmVlLm5hbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgdmFyIG5ld09iaiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoYXNzaWduZWUpKTtcbiAgICAgICAgICAgIG1vZGVsLmFzc2lnbm1lbnRIaXN0b3J5LnB1c2gobmV3T2JqKTtcbiAgICAgICAgfVxuICAgICAgICBhc3NpZ25lZS5uYW1lID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VybmFtZSArIFwiXCI7XG4gICAgICAgIGFzc2lnbmVlLnVzZXJJZCA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcbiAgICAgICAgYXNzaWduZWUuZGF0ZVRpbWUgPSBtb21lbnQoKS5mb3JtYXQoKTtcbiAgICAgICAgYXNzaWduZWUudHlwZSA9IEFTU0lHTk1FTlRfVFlQRV9BVVRPO1xuICAgICAgICBhc3NpZ25lZS5kdWVEYXRlVGltZSA9ICcnO1xuICAgICAgICBhc3NpZ25lZS5ieSA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIjtcblxuICAgICAgICBhY3Rpb24oYWN0aW9uQmxvY2ssIHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdWJQcm9jZXNzLCBtb2RlbCwgX1dGSW5zdGFuY2UsIGRhdGEsIHV1aWQpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKFwiTm8gdXNlcnMgZm91bmQgaW4gbGlzdC4gQXNzaWduaW5nIGJsYW5rIFwiKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgIHJlamVjdChcIlNlcnZlciBhY3Rpb24gZXJyb3IgZm91bmQgcmVqZWN0ZWRcIilcbiAgICAgICAgICAgIH0pO1xuICAgIH0pO1xuXG59O1xuXG4vKipcbiAqIFByb2Nlc3MgdHJhbnNpdGlvblxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcm9jZXNzSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBwcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gcHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBwcm9jZXNzIHNlcVxuICogQHBhcmFtIHtzdHJpbmd9IHN1YlByb2Nlc3NJZCAtIHRoZSBXb3JrZmxvdyBjb25maWcgLyBkZWZpbml0aW9uIHN1Yi1wcm9jZXNzIGlkXG4gKiBAcGFyYW0ge251bWJlcn0gc3ViUHJvY2Vzc1NlcSAtIHRoZSBXb3JrZmxvdyBpbnN0YW5jZSBzdWItcHJvY2VzcyBzZXFcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdGVwSWQgLSB0aGUgV29ya2Zsb3cgY29uZmlnIC8gZGVmaW5pdGlvbiBzdGVwIGlkXG4gKiBAcGFyYW0ge3N0cmluZ30gdHJhbnNpdGlvbklkIC0gdGhlIFdvcmtmbG93IGNvbmZpZyAvIGRlZmluaXRpb24gdHJhbnNpdGlvbiBpZFxuICogQHBhcmFtIHtvYmplY3R9IGRhdGEgLSBhbnkgYWRkaXRpb25hbCBkYXRhIHBhc3NlZCBpbiBhcyBrZXkgdmFsdWUgcGFpcnNcbiAqIEBwYXJhbSB7b2JqZWN0fSBfV0ZJbnN0YW5jZSAtIHRoZSBjdXJyZW50IHdvcmtmbG93IGNvbnN0cnVjdG9yIGluc3RhbmNlXG4gKlxuICogQGV4YW1wbGUgJydcbiAqXG4gKiBAcmV0dXJuICcnXG4gKlxuICovXG5mdW5jdGlvbiB0cmFuc2l0aW9uKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBzdGVwSWQsIHRyYW5zaXRpb25JZCwgZGF0YSwgX1dGSW5zdGFuY2UsIHNwdXVpZCwgbW9kZWwpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgc3RlcFNlcSA9IDA7XG4gICAgICAgICAgICB2YXIgbmV4dFN0ZXBJZCA9ICcnO1xuICAgICAgICAgICAgdmFyIG5leHRTdGVwU2VxID0gMDtcbiAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzID0gW107XG4gICAgICAgICAgICB2YXIgY3VycmVudFByb2Nlc3MgPSBfV0ZJbnN0YW5jZS5jb25maWcucHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpQcm9jZXNzKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9ialByb2Nlc3MuX2lkID09IHByb2Nlc3NJZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqUHJvY2VzcztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRTdWJQcm9jZXNzID0gY3VycmVudFByb2Nlc3NbMF0uc3ViUHJvY2Vzc2VzLmZpbHRlcihmdW5jdGlvbihvYmpTdWJQcm9jZXNzKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9ialN1YlByb2Nlc3MuX2lkID09IHN1YlByb2Nlc3NJZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqU3ViUHJvY2VzcztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGVwID0gY3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHMuZmlsdGVyKGZ1bmN0aW9uKG9ialN0ZXApIHtcbiAgICAgICAgICAgICAgICBpZiAob2JqU3RlcC5faWQgPT0gc3RlcElkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmpTdGVwO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB2YXIgdHJhbnNpdGlvbiA9IGN1cnJlbnRTdGVwWzBdLnRyYW5zaXRpb24uZmlsdGVyKGZ1bmN0aW9uKG9ialRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAob2JqVHJhbnNpdGlvbi5faWQgPT0gdHJhbnNpdGlvbklkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmpUcmFuc2l0aW9uO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGN1cnJlbnRTdWJQcm9jZXNzWzBdLnN0ZXBzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdWJQcm9jZXNzWzBdLnN0ZXBzW2ldLl9pZCA9PSBzdGVwSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RlcFNlcSA9IHBhcnNlSW50KGN1cnJlbnRTdWJQcm9jZXNzWzBdLnN0ZXBzW2ldLl9zZXEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjdXJyZW50U3ViUHJvY2Vzc1swXS5zdGVwcy5maWx0ZXIoZnVuY3Rpb24oc3RlcEl0ZW0pIHtcbiAgICAgICAgICAgICAgICBuZXh0U3RlcFNlcSA9IHN0ZXBTZXEgKyAxO1xuICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChzdGVwSXRlbS5fc2VxKSA9PSBuZXh0U3RlcFNlcSkge1xuICAgICAgICAgICAgICAgICAgICBuZXh0U3RlcElkID0gc3RlcEl0ZW0uX2lkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSlcblxuXG5cblxuICAgICAgICAgICAgdmFyIG1heFN0ZXBzID0gY3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHMubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIHNwaW5zdGFuY2VPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIHNwSW5zdGFuY2VTdGVwT2JqZWN0ID0gSlNPTi54cGF0aChcIi9zdWJwcm9jZXNzZXNbX2lkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vc3RlcFwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuXG4gICAgICAgICAgICAvLyBBZGRpbmcgc3RlcCBPYmplY3QgaW4gc3VicHJvY2VzcyBoaXN0b3J5IEZyb20gc2Vjb25kIHN0ZXAuIEFzIGZpcnN0IHN0ZXAgaXMgYWRkZWQgYXQgc3ViUHJvY2VzcygpIGZ1bmN0aW9uIFxuICAgICAgICAgICAgaWYgKHNwaW5zdGFuY2VPYmplY3QuaGlzdG9yeSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBzcGluc3RhbmNlT2JqZWN0Lmhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBwdXNoSW5kaWNhdG9yVG9Nb2RlbCA9IGZ1bmN0aW9uKG1vZGVsKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBJbiBib3RoICB0aGUgY2FzZXMgdGhlIGxpc3QgaXMgZGlmZmVybmV0IHRoYXQgbmVlZHMgdG8gYmUgbWFkZSBzYW1lLlxuXG4gICAgICAgICAgICAgICAgdmFyIGluZGljYXRvckxpc3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9pbmRpY2F0b3JzXCIsIF9XRkluc3RhbmNlLCB7fSk7XG4gICAgICAgICAgICAgICAgdmFyIGlzRmlyc3QgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoaW5kaWNhdG9yTGlzdCA9PSB1bmRlZmluZWQgfHwgaW5kaWNhdG9yTGlzdC5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBpc0ZpcnN0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaW5kaWNhdG9yTGlzdCA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1t3b3JrZmxvd3MvcHJvY2Vzc2VzW3N1YlByb2Nlc3NVVUlEIGVxICdcIiArIHNwdXVpZCArIFwiJ11dXCIsIF9XRkluc3RhbmNlLCB7fSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChtb2RlbC5pbmRpY2F0b3JzID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBtb2RlbC5pbmRpY2F0b3JzID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaW5kaWNhdG9yTGlzdC5sZW5ndGg7IGorKykge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0ZpcnN0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1dWlkID0gaW5kaWNhdG9yTGlzdFtqXS5faWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmV2ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9fcmV2XCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VxID0gaW5kaWNhdG9yTGlzdFtqXS5tb2RlbC5wZW5kaW5nLnNlcTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGF0dXMgPSBpbmRpY2F0b3JMaXN0W2pdLm1vZGVsLnBlbmRpbmcuc3RhdHVzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZE9iamVjdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dWlkOiB1dWlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldjogcmV2LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcTogc2VxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogc3RhdHVzXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC5pbmRpY2F0b3JzLnB1c2goaW5kT2JqZWN0KTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXVpZCA9IGluZGljYXRvckxpc3Rbal0uaW5zdGFuY2VzWzBdLnV1aWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmV2ID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9fcmV2XCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VxID0gSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW19pZCBlcSAnXCIgKyB1dWlkICsgXCInXS9tb2RlbC9wZW5kaW5nL3NlcVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXR1cyA9IEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tfaWQgZXEgJ1wiICsgdXVpZCArIFwiJ10vbW9kZWwvcGVuZGluZy9zdGF0dXNcIiwgX1dGSW5zdGFuY2UsIHt9KVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRPYmplY3QgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXVpZDogdXVpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXY6IHJldixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXE6IHNlcSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHN0YXR1c1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuaW5kaWNhdG9ycy5wdXNoKGluZE9iamVjdCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkZWxldGUgbW9kZWwuYXNzaWduZWRUbztcbiAgICAgICAgICAgICAgICBkZWxldGUgbW9kZWwuYXNzaWdubWVudDtcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9kZWw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFkZCBpbmZvcm1hdGlvbiB0byB0cmFuc3Rpb24gb2JqZWN0LlxuICAgICAgICAgICAgdmFyIHRybk9iamVjdCA9IHtcbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uSWQ6IHRyYW5zaXRpb25bMF0uX2lkLFxuICAgICAgICAgICAgICAgIGRhdGVUaW1lOiBtb21lbnQoKS5mb3JtYXQoKSxcbiAgICAgICAgICAgICAgICB1c2VySWQ6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkICsgXCJcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG1vZGVsICE9IHVuZGVmaW5lZCAmJiBPYmplY3Qua2V5cyhtb2RlbCkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIG1vZGVsLnRyYW5zaXRpb24gPSB0cm5PYmplY3Q7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNwSW5zdGFuY2VTdGVwT2JqZWN0LnRyYW5zaXRpb24gPSB0cm5PYmplY3Q7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGNvcHkgY3VycmVudCBhc3NpZ25lZFRvIHRvIHJlQXNzaWdubWVudCBvYmplY3RcblxuICAgICAgICAgICAgaWYgKG1vZGVsICE9IHVuZGVmaW5lZCAmJiBPYmplY3Qua2V5cyhtb2RlbCkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGlmIChtb2RlbC5hc3NpZ25tZW50SGlzdG9yeSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWwuYXNzaWdubWVudEhpc3RvcnkgPSBbXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGFzc2lnbmVlT2JqID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShtb2RlbC5hc3NpZ25lZFRvKSk7XG4gICAgICAgICAgICAgICAgaWYgKGFzc2lnbmVlT2JqLnVzZXJJZCAhPSBcIlwiICYmIGFzc2lnbmVlT2JqLm5hbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICBtb2RlbC5hc3NpZ25tZW50SGlzdG9yeS5wdXNoKGFzc2lnbmVlT2JqKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHNwSW5zdGFuY2VTdGVwT2JqZWN0LmFzc2lnbm1lbnRIaXN0b3J5ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzcEluc3RhbmNlU3RlcE9iamVjdC5hc3NpZ25tZW50SGlzdG9yeSA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgYXNzaWduZWVPYmogPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHNwSW5zdGFuY2VTdGVwT2JqZWN0LmFzc2lnbmVkVG8pKTtcbiAgICAgICAgICAgICAgICBpZiAoYXNzaWduZWVPYmoudXNlcklkICE9IFwiXCIgJiYgYXNzaWduZWVPYmoubmFtZSAhPSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHNwSW5zdGFuY2VTdGVwT2JqZWN0LmFzc2lnbm1lbnRIaXN0b3J5LnB1c2goYXNzaWduZWVPYmopO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGhpc3RvcnlNb2RlbDtcbiAgICAgICAgICAgIGlmIChtb2RlbCAhPSB1bmRlZmluZWQgJiYgT2JqZWN0LmtleXMobW9kZWwpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBoaXN0b3J5TW9kZWwgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG1vZGVsKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGhpc3RvcnlNb2RlbCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoc3BJbnN0YW5jZVN0ZXBPYmplY3QpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBpbmRNb2RlbEluU3RlcCA9IHB1c2hJbmRpY2F0b3JUb01vZGVsKGhpc3RvcnlNb2RlbCk7XG4gICAgICAgICAgICBzcGluc3RhbmNlT2JqZWN0Lmhpc3RvcnkucHVzaChpbmRNb2RlbEluU3RlcCk7XG5cbiAgICAgICAgICAgIGlmICh0cmFuc2l0aW9uWzBdLnRyYW5zaXRpb25BY3Rpb24uZ29Ub1N0ZXAgIT0gdW5kZWZpbmVkKSB7XG5cblxuXG4gICAgICAgICAgICAgICAgdmFyIG5leHRTZXEgPSBwYXJzZUludChjdXJyZW50U3RlcFswXS5fc2VxKSArIHBhcnNlSW50KHRyYW5zaXRpb25bMF0udHJhbnNpdGlvbkFjdGlvbi5nb1RvU3RlcC5kZWZhdWx0KTtcbiAgICAgICAgICAgICAgICB2YXIgbmV4dElkID0gJyc7XG4gICAgICAgICAgICAgICAgY3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHMuZmlsdGVyKGZ1bmN0aW9uKHN0ZXBJdGVtKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KHN0ZXBJdGVtLl9zZXEpID09IG5leHRTdGVwU2VxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0SWQgPSBzdGVwSXRlbS5faWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgc3RlcChwcm9jZXNzSWQsIHByb2Nlc3NTZXEsIHN1YlByb2Nlc3NJZCwgc3ViUHJvY2Vzc1NlcSwgbmV4dElkLCBuZXh0U2VxLCBkYXRhLCBfV0ZJbnN0YW5jZSwgc3B1dWlkKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobmV4dFNlcSA9PSBtYXhTdGVwcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ0FsbCBTdGVwIHRyYW5zaXRpb25zIGhhdmUgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0NvbXBsZXRlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXA6IHJlc3VsdC5kYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdGVwIHRyYW5zaXRpb24gY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0NvbXBsZXRlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwOiByZXN1bHQuZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSBlbHNlIGlmICh0cmFuc2l0aW9uWzBdLnRyYW5zaXRpb25BY3Rpb24uZ29Ub1N0ZXBJZCAhPSB1bmRlZmluZWQpIHtcblxuXG5cbiAgICAgICAgICAgICAgICB2YXIgZ29Ub1N0ZXBJZCA9IHRyYW5zaXRpb25bMF0udHJhbnNpdGlvbkFjdGlvbi5nb1RvU3RlcElkLnN0ZXBJZDtcbiAgICAgICAgICAgICAgICB2YXIgZ29Ub1N0ZXBTZXEgPSAxO1xuXG4gICAgICAgICAgICAgICAgY3VycmVudFN1YlByb2Nlc3NbMF0uc3RlcHMuZmlsdGVyKGZ1bmN0aW9uKHN0ZXBJdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGVwSXRlbS5faWQgPT0gZ29Ub1N0ZXBJZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ29Ub1N0ZXBTZXEgPSBwYXJzZUludChzdGVwSXRlbS5fc2VxKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBzdGVwKHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0lkLCBzdWJQcm9jZXNzU2VxLCBnb1RvU3RlcElkLCBnb1RvU3RlcFNlcSwgZGF0YSwgX1dGSW5zdGFuY2UsIHNwdXVpZCkudGhlbihmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdvVG9TdGVwU2VxID09IG1heFN0ZXBzIHx8IHJlc3VsdC5kYXRhLnN0YXR1cyA9PSAnQ29tcGxldGUnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdBbGwgU3RlcCB0cmFuc2l0aW9ucyBoYXZlIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkuJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1YlByb2Nlc3NDb21wbGV0ZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwOiByZXN1bHQuZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdTdGVwIHRyYW5zaXRpb24gY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0NvbXBsZXRlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGVwOiByZXN1bHQuZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHN1Y2Nlc3MpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHJhbnNpdGlvblswXS50cmFuc2l0aW9uQWN0aW9uLnN0b3AgIT0gdW5kZWZpbmVkKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBBcyB0aGlzIGlzIHRoZSBsYXN0IHN0ZXAgKHdoZXJlIHN0b3AgaXMgZGVmaWVkKSAsIHN1YlByb2Nlc3MgcG9zdEFjdGlvbnMgc2hvdWxkIGNvbWUgaGVyZS5cblxuICAgICAgICAgICAgICAgIHZhciBwb3N0QWN0aW9uc0NvbmYgPSBjdXJyZW50UHJvY2Vzc1swXS5wb3N0QWN0aW9ucztcbiAgICAgICAgICAgICAgICBwb3N0QWN0aW9ucyhwb3N0QWN0aW9uc0NvbmYsIF9XRkluc3RhbmNlLCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1N0ZXAgdHJhbnNpdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LldvcmtmbG93IHN0b3BwZWQuJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ViUHJvY2Vzc0NvbXBsZXRlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RlcDogbW9kZWxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG5cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cbi8qKlxuICogUHJvY2VzcyBwb3N0QWN0aW9uc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBwb3N0QWN0aW9ucyAtIHRoZSBwb3N0QWN0aW9ucyBjb25maWcgZGF0YVxuICpcbiAqIEBleGFtcGxlICcnXG4gKlxuICogQHJldHVybiAnJ1xuICpcbiAqL1xuZnVuY3Rpb24gcG9zdEFjdGlvbnMocG9zdEFjdGlvbnMsIF9XRkluc3RhbmNlLCBzcHV1aWQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHZhciBjb21wbGV0ZWQgPSBbXTtcbiAgICAgICAgdHJ5IHtcblxuXG4gICAgICAgICAgICB2YXIgc3BPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIHByb2Nlc3NJRCA9IHNwT2JqZWN0W1wibWV0YS1kYXRhXCJdLnByb2Nlc3NDb25maWdJZDtcbiAgICAgICAgICAgIHZhciBwcm9jZXNzSWQgPSBzcE9iamVjdFtcIm1ldGEtZGF0YVwiXS5zdWJQcm9jZXNzQ29uZmlnSWQ7XG4gICAgICAgICAgICB2YXIgcHJvY2Vzc1NFUSA9IHNwT2JqZWN0W1wibWV0YS1kYXRhXCJdLnN1YlByb2Nlc3NJbnNTZXE7XG4gICAgICAgICAgICB2YXIgcHJvY2Vzc1NlcSA9IHNwT2JqZWN0W1wibWV0YS1kYXRhXCJdLnN1YlByb2Nlc3NJbnNTZXE7XG5cbiAgICAgICAgICAgIHZhciBzdWJQcm9jZXNzQ29uZmlnT2JqZWN0ID0gSlNPTi54cGF0aChcIi9jb25maWcvcHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBwcm9jZXNzSUQgKyBcIiddL3N1YlByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgcHJvY2Vzc0lkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9zdGVwXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG5cblxuICAgICAgICAgICAgdXRpbC5zeW5jTG9vcChwb3N0QWN0aW9ucy5sZW5ndGgsIGZ1bmN0aW9uKGxvb3ApIHtcbiAgICAgICAgICAgICAgICB2YXIgY291bnRlciA9IGxvb3AuaXRlcmF0aW9uKCk7XG4gICAgICAgICAgICAgICAgYWN0aW9uKHBvc3RBY3Rpb25zW2NvdW50ZXJdLCBwcm9jZXNzSUQsIHByb2Nlc3NTRVEsIHByb2Nlc3NJZCwgcHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0NvbmZpZ09iamVjdCwgc3RlcE9iamVjdCwgX1dGSW5zdGFuY2UsIHt9LCBzcHV1aWQpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBhbGwgcHJlLXJlcXVpc2l0ZXMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS5cbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGVkLnB1c2godHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGxvb3AubmV4dCgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWQucHVzaChmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIGxvb3AuYnJlYWsoKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoY29tcGxldGVkLmV2ZXJ5KEJvb2xlYW4pKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdQb3N0LWFjdGlvbnMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZQcmVBY3Rpb25zRXJyb3InLCAnTm90IGFsbCBwb3N0LWFjdGlvbnMgcGFzc2VkLicpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH1cblxuICAgIH0pO1xufTtcblxuLypcbmZ1bmN0aW9uIHNlbmROb3RpZmljYXRpb25zKHVzZXJzTGlzdCwgc3B1dWlkKXtcblxuICAvLyBnZXQgdXNlcnMgbGlzdCBcbiAgLy8gc2VuIG5vdGlmaWNhdGlvbnMgdG8gdXNlcnMgeSBhZGRpbmcgY2hhbm5lbHMgdG8gdGhlbVxuXG4gIHZhciBjaGFubmVsQXJyYXkgPSBbXTtcblxuICBmb3IoaT0wO2k8dXNlcnNMaXN0Lmxlbmd0aDsgaSsrKXtcbiAgICBjaGFubmVsQXJyYXkucHVzaChcInVzZXJfXCIrdXNlcnNMaXN0W2ldLmlkKTtcbiAgfVxuXG4gIGFzc2lnblRvVXNlcnMocHJvY2Vzc1dvcmtmbG93TWVzc2FnZShOT1RJRklDQVRJT05fVVNFUl9NU0dfQUNDRVBULCBzcHV1aWQpLCBjaGFubmVsQXJyYXkpO1xuXG59OyovXG5cbi8qZnVuY3Rpb24gYXNzaWduVG9Vc2VycyhtZXNzYWdlLCBjaGFubmVsQXJyYXkpe1xuXG4gICAgIHZhciBjaGFubmVscyA9IGNoYW5uZWxBcnJheTtcblxuICAgICB2YXIgbm90aWZpY2F0aW9uID0gIHsgXG4gICAgICAgICAgXCJfaWRcIjogZ2VuZXJhdGVVVUlEKCksXG4gICAgICAgICAgXCJjaGFubmVsc1wiOmNoYW5uZWxzLFxuICAgICAgICAgIFwibWVzc2FnZVwiOiBtZXNzYWdlLFxuICAgICAgICAgIFwibWVzc2FnZVR5cGVcIjogXCJpbmZvXCIsXG4gICAgICAgICAgXCJjcmVhdGVkRGF0ZVRpbWVcIjogbW9tZW50KCkuZm9ybWF0KCksXG4gICAgICAgICAgXCJyZWFkXCI6IGZhbHNlLFxuICAgICAgICAgIFwicmVhZERhdGVUaW1lXCI6IFwiXCIsXG4gICAgICAgICAgXCJ0eXBlXCI6IFwibm90aWZpY2F0aW9uXCIsXG4gICAgICAgICAgXCJzZW5kZXJVc2VySWRcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWRcbiAgICAgICB9O1xuXG4gICAgICAgY29uc29sZS5sb2cobm90aWZpY2F0aW9uKTtcbiAgICAgICBkYW8udXBzZXJ0KG5vdGlmaWNhdGlvbik7XG5cbiAgfTsqL1xuXG5mdW5jdGlvbiBwcm9jZXNzV29ya2Zsb3dNZXNzYWdlKG1lc3NhZ2UsIHNwdXVpZCkge1xuXG4gICAgdmFyIHJlcGxhY2VkTXNnID0gbWVzc2FnZTtcblxuICAgIGlmIChyZXBsYWNlZE1zZy5pbmRleE9mKCcjSU5TVEFOQ0VfTEFCRUwnKSAhPT0gLTEpIHtcbiAgICAgICAgdmFyIHZhbCA9IEpTT04ueHBhdGgoXCIvaW5zdGFuY2UvcHJvY2Vzc2VzL3N1YlByb2Nlc3Nlc1t1dWlkIGVxICdcIiArIHNwdXVpZCArIFwiJ10vbGFiZWxcIiwgYXBwLlNDT1BFLndvcmtmbG93LCB7fSlbMF07XG4gICAgICAgIHJlcGxhY2VkTXNnID0gcmVwbGFjZWRNc2cucmVwbGFjZSgnI0lOU1RBTkNFX0xBQkVMJywgdmFsKTtcblxuICAgIH1cblxuICAgIGlmIChyZXBsYWNlZE1zZy5pbmRleE9mKCcjVVNFUl9OQU1FJykgIT09IC0xKSB7XG4gICAgICAgIHZhciB2YWwgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgc3B1dWlkICsgXCInXS9zdGVwL2Fzc2lnbmVkVG8vbmFtZVwiLCBhcHAuU0NPUEUud29ya2Zsb3csIHt9KVswXTtcbiAgICAgICAgcmVwbGFjZWRNc2cgPSByZXBsYWNlZE1zZy5yZXBsYWNlKCcjVVNFUl9OQU1FJywgdmFsKTtcblxuICAgIH1cblxuICAgIGlmIChyZXBsYWNlZE1zZy5pbmRleE9mKCcjUFJPRklMRV9USVRMRScpICE9PSAtMSkge1xuICAgICAgICB2YXIgdmFsID0gYXBwLnByb2ZpbGUudGl0bGU7XG4gICAgICAgIHJlcGxhY2VkTXNnID0gcmVwbGFjZWRNc2cucmVwbGFjZSgnI1BST0ZJTEVfVElUTEUnLCB2YWwpO1xuXG4gICAgfVxuXG4gICAgaWYgKHJlcGxhY2VkTXNnLmluZGV4T2YoJyNQUk9GSUxFX1RZUEUnKSAhPT0gLTEpIHtcbiAgICAgICAgdmFyIHZhbCA9IGFwcC5TQ09QRS5BUFBfQ09ORklHLm5hbWU7XG4gICAgICAgIHJlcGxhY2VkTXNnID0gcmVwbGFjZWRNc2cucmVwbGFjZSgnI1BST0ZJTEVfVFlQRScsIHZhbCk7XG5cbiAgICB9XG5cbiAgICBpZiAocmVwbGFjZWRNc2cuaW5kZXhPZignI1ZBUl9TUFVVSUQnKSAhPT0gLTEpIHtcbiAgICAgICAgdmFyIHZhbCA9IHNwdXVpZDtcbiAgICAgICAgcmVwbGFjZWRNc2cgPSByZXBsYWNlZE1zZy5yZXBsYWNlKCcjVkFSX1NQVVVJRCcsIHZhbCk7XG5cbiAgICB9XG5cbiAgICByZXR1cm4gcmVwbGFjZWRNc2c7XG59O1xuXG5mdW5jdGlvbiBfZ2V0TmFtZShhcnIsIGxhbmcpIHtcbiAgICBpZiAoYXJyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChhcnJbaV0uX2xhbmcgPT09IGxhbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXJyW2ldLnZhbHVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgIH1cblxufTtcblxuZnVuY3Rpb24gX2dldE5hbWVCeUxhbmcob2JqKSB7XG4gICAgcmV0dXJuIGxpYnJhcnkuZ2V0TmFtZUJ5TGFuZyhvYmopO1xufTtcblxuXG5cblxuXG4vKipcbiAqIFByb2Nlc3MgcHJlV29ya0FjdGlvbnNcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gcHJlV29ya0FjdGlvbnMgLSB0aGUgcHJlV29ya0FjdGlvbnMgY29uZmlnIGRhdGFcbiAqXG4gKiBAZXhhbXBsZSAnJ1xuICpcbiAqIEByZXR1cm4gJydcbiAqXG4gKi9cblxuZnVuY3Rpb24gcHJlV29ya0FjdGlvbnMocHJlV29ya0FjdGlvbnMsIF9XRkluc3RhbmNlKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB2YXIgY29tcGxldGVkID0gW107XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgc3ViUHJvY2Vzc0NvbmZpZ09iamVjdCA9IEpTT04ueHBhdGgoXCIvY29uZmlnL3Byb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgYXBwLnByb2Nlc3NJRCArIFwiJ10vc3ViUHJvY2Vzc2VzW19pZCBlcSAnXCIgKyBhcHAucHJvY2Vzc0lkICsgXCInXVwiLCBfV0ZJbnN0YW5jZSwge30pWzBdO1xuICAgICAgICAgICAgdmFyIHN0ZXBPYmplY3QgPSBKU09OLnhwYXRoKFwiL3N1YnByb2Nlc3Nlc1tfaWQgZXEgJ1wiICsgYXBwLlNDT1BFLnByb2Nlc3NVVUlEICsgXCInXS9zdGVwXCIsIF9XRkluc3RhbmNlLCB7fSlbMF07XG4gICAgICAgICAgICB1dGlsLnN5bmNMb29wKHByZVdvcmtBY3Rpb25zLmxlbmd0aCwgZnVuY3Rpb24obG9vcCkge1xuICAgICAgICAgICAgICAgIHZhciBjb3VudGVyID0gbG9vcC5pdGVyYXRpb24oKTtcbiAgICAgICAgICAgICAgICBhY3Rpb24ocHJlV29ya0FjdGlvbnNbY291bnRlcl0sIGFwcC5wcm9jZXNzSUQsIGFwcC5wcm9jZXNzU0VRLCBhcHAucHJvY2Vzc0lkLCBhcHAucHJvY2Vzc1NlcSwgc3ViUHJvY2Vzc0NvbmZpZ09iamVjdCwgc3RlcE9iamVjdCwgX1dGSW5zdGFuY2UsIHt9LCBhcHAuU0NPUEUucHJvY2Vzc1VVSUQpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBhbGwgcHJlLXJlcXVpc2l0ZXMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS5cbiAgICAgICAgICAgICAgICAgICAgY29tcGxldGVkLnB1c2godHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGxvb3AubmV4dCgpO1xuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZWQucHVzaChmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIGxvb3AuYnJlYWsoKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBpZiAoY29tcGxldGVkLmV2ZXJ5KEJvb2xlYW4pKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWNjZXNzID0gdXRpbC5zdWNjZXNzKCdQcmVXb3JrLWFjdGlvbnMgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4nLCB7fSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3VjY2Vzcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yID0gdXRpbC5lcnJvcignV0ZQcmVBY3Rpb25zRXJyb3InLCAnTm90IGFsbCBwcmUtd29yay1hY3Rpb25zIHBhc3NlZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9XG5cbiAgICB9KTtcbn07XG5cblxubW9kdWxlLmV4cG9ydHMgPSB7XG5cbiAgICBwcmVSZXF1aXNpdGVzOiBwcmVSZXF1aXNpdGVzLFxuICAgIHByZUFjdGlvbnM6IHByZUFjdGlvbnMsXG4gICAgcG9zdEFjdGlvbnM6IHBvc3RBY3Rpb25zLFxuICAgIHByZVdvcmtBY3Rpb25zOiBwcmVXb3JrQWN0aW9ucyxcbiAgICBzdWJQcm9jZXNzOiBzdWJQcm9jZXNzLFxuICAgIGluZGljYXRvckRvY3M6IGluZGljYXRvckRvY3MsXG4gICAgdGFzazogdGFzayxcbiAgICB0cmFuc2l0aW9uOiB0cmFuc2l0aW9uLFxuICAgIGFzc2lnblVzZXI6IGFzc2lnblVzZXJcblxufSIsIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBVdGlsaXR5IE1vZHVsZVxuICpcbiAqIEBtb2R1bGUgbGliL3V0aWxcbiAqXG4gKiBAYXV0aG9yIEJyZW50IEdvcmRvblxuICogQHZlcnNpb24gMC4xLjBcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFdvcmtmbG93IHV0aWxpdHkgbW9kdWxlIHVzZWQgdG8gZm9ybWF0IHRoZSByZXR1cm4gYW5kIGVycm9yIG9iamVjdHMsIGFuZFxuICogY29udGFpbnMgc29tZSBvdGhlciB1dGlsaXR5IGZ1bmN0aW9ucyBzdWNoIGFzIGEgc3luYyBsb29wIGFuZCBjb21wYXJlLlxuICpcbiAqL1xuXG4vKipcbiAqIFN1Y2Nlc3MgYmxvY2sgcmV0dXJuIG9iamVjdCwgY29udGFpbnMgYSBtZXNzYWdlIGFuZCBvcHRpb25hbCBkYXRhIG9iamVjdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSAtIHRoZSBzdWNjZXNzIG1lc3NhZ2VcbiAqIEBwYXJhbSB7c3RyaW5nfE9iamVjdH0gW2RhdGFdIC0gdGhlIHN1Y2Nlc3MgcmV0dXJuZWQgZGF0YVxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBSZXR1cm4gc3VjY2VzcyB3aXRob3V0IGEgZGF0YSBibG9ja1xuICogdmFyIHN1Y2Nlc3MgPSB1dGlsLnN1Y2Nlc3MoJ1N1Y2Nlc3MgbWVzc2FnZSBnb2VzIGhlcmUuLi4nKTtcbiAqXG4gKiBAcmV0dXJuIHtPYmplY3R9IC0gd2l0aCBtZXNzYWdlIGFuZCBkYXRhIHByb3BlcnRpZXNcbiAqXG4gKi9cbmZ1bmN0aW9uIHN1Y2Nlc3MobWVzc2FnZSwgZGF0YSl7XG5cdHJldHVybiB7XG5cdFx0bWVzc2FnZTogbWVzc2FnZSxcblx0XHRkYXRhOiBkYXRhXG5cdH07XG59O1xuXG4vKipcbiAqIFdhcm5pbmcgYmxvY2sgcmV0dXJuIG9iamVjdCwgY29udGFpbnMgYSBtZXNzYWdlIGFuZCBvcHRpb25hbCBkYXRhIG9iamVjdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSAtIHRoZSB3YXJuaW5nIG1lc3NhZ2VcbiAqIEBwYXJhbSB7c3RyaW5nfE9iamVjdH0gW2RhdGFdIC0gdGhlIHJldHVybmVkIGRhdGFcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gUmV0dXJuIHN1Y2Nlc3Mgd2l0aG91dCBhIGRhdGEgYmxvY2tcbiAqIHZhciBzdWNjZXNzID0gdXRpbC53YXJuKCdXYXJuaW5nIG1lc3NhZ2UgZ29lcyBoZXJlLi4uJyk7XG4gKlxuICogQHJldHVybiB7T2JqZWN0fSB3aXRoIG1lc3NhZ2UgYW5kIGRhdGEgcHJvcGVydGllcywgYW5kIGxvZ3MgdGhlIHdhcm5pbmcgdG8gdGhlIGNvbnNvbGUuXG4gKlxuICovXG5mdW5jdGlvbiB3YXJuKG1lc3NhZ2UsIGRhdGEpe1xuXHRjb25zb2xlLndhcm4oZGF0YSk7XG5cdHJldHVybiB7XG5cdFx0d2FybmluZzogbWVzc2FnZSxcblx0XHRkYXRhOiBkYXRhXG5cdH07XG59O1xuXG4vKipcbiAqIEVycm9yIGJsb2NrIEpTIGVycm9yIG9iamVjdCwgY29udGFpbnMgYSBjb2RlIGFuZCBtZXNzYWdlIGZvciB0aGUgZXJyb3IuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGNvZGUgLSB0aGUgZXJyb3IgY29kZVxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2UgLSB0aGUgZXJyb3IgbWVzc2FnZVxuICpcbiAqIEBleGFtcGxlXG4gKiB2YXIgc3VjY2VzcyA9IHV0aWwuZXJyb3IoJ0Vycm9yMDAxJywnRXJyb3IgbWVzc2FnZSBnb2VzIGhlcmUuLi4nKTtcbiAqXG4gKiBAcmV0dXJuIHtPYmplY3R9IHdpdGggYSBjb2RlIGFuZCBtZXNzYWdlIHByb3BlcnRpZXMuXG4gKlxuICovXG5mdW5jdGlvbiBlcnJvcihjb2RlLCBtZXNzYWdlKXtcblx0dmFyIGVyciA9IG5ldyBFcnJvcignJyk7XG5cdGVyci5uYW1lID0gY29kZTtcblx0ZXJyLm1lc3NhZ2UgPSBtZXNzYWdlO1xuXHRyZXR1cm4gZXJyO1xufTtcblxuLyoqXG4gKiBBIGxvb3Agd2hpY2ggY2FuIGxvb3AgWCBhbW91bnQgb2YgdGltZXMsIHdoaWNoIGNhcnJpZXMgb3V0XG4gKiBhc3luY2hyb25vdXMgY29kZSwgYnV0IHdhaXRzIGZvciB0aGF0IGNvZGUgdG8gY29tcGxldGUgYmVmb3JlIGxvb3BpbmcuXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IGl0ZXJhdGlvbnMgLSB0aGUgbnVtYmVyIG9mIGl0ZXJhdGlvbnMgdG8gY2Fycnkgb3V0XG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBwcm9jZXNzIC0gdGhlIGNvZGUvZnVuY3Rpb24gd2UncmUgcnVubmluZyBmb3IgZXZlcnlcbiAqIGl0ZXJhdGlvblxuICogQHBhcmFtIHtmdW5jdGlvbn0gZXhpdCAtIGFuIG9wdGlvbmFsIGNhbGxiYWNrIHRvIGNhcnJ5IG91dCBvbmNlIHRoZSBsb29wXG4gKiBoYXMgY29tcGxldGVkXG4gKlxuICogQGV4YW1wbGVcbiAqIHV0aWwuc3luY0xvb3AoNSwgZnVuY3Rpb24obG9vcCl7XG4gKiBcdHZhciBjb3VudGVyID0gbG9vcC5pdGVyYXRpb24oKTtcbiAqIFx0Ly8gQWRkIGFzeW5jIGNhbGxzIGhlcmUuLlxuICpcbiAqIH0sIGZ1bmN0aW9uKCl7XG4gKiBcdC8vIE9uIGNvbXBsZXRlIHBlcmZvcm0gYWN0aW9ucyBoZXJlLi4uXG4gKlxuICogfSk7XG4gKlxuICogQHJldHVybiB7T2JqZWN0fSB0aGUgbG9vcCBjb250cm9sIG9iamVjdC5cbiAqXG4gKi9cbmZ1bmN0aW9uIHN5bmNMb29wKGl0ZXJhdGlvbnMsIHByb2Nlc3MsIGV4aXQpe1xuICAgIHZhciBpbmRleCA9IDAsXG4gICAgICAgIGRvbmUgPSBmYWxzZSxcbiAgICAgICAgc2hvdWxkRXhpdCA9IGZhbHNlO1xuICAgIHZhciBsb29wID0ge1xuICAgICAgICBuZXh0OmZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBpZihkb25lKXtcbiAgICAgICAgICAgICAgICBpZihzaG91bGRFeGl0ICYmIGV4aXQpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXhpdCgpOyAvLyBFeGl0IGlmIHdlJ3JlIGRvbmVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBJZiB3ZSdyZSBub3QgZmluaXNoZWRcbiAgICAgICAgICAgIGlmKGluZGV4IDwgaXRlcmF0aW9ucyl7XG4gICAgICAgICAgICAgICAgaW5kZXgrKzsgLy8gSW5jcmVtZW50IG91ciBpbmRleFxuICAgICAgICAgICAgICAgIHByb2Nlc3MobG9vcCk7IC8vIFJ1biBvdXIgcHJvY2VzcywgcGFzcyBpbiB0aGUgbG9vcFxuICAgICAgICAgICAgLy8gT3RoZXJ3aXNlIHdlJ3JlIGRvbmVcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZG9uZSA9IHRydWU7IC8vIE1ha2Ugc3VyZSB3ZSBzYXkgd2UncmUgZG9uZVxuICAgICAgICAgICAgICAgIGlmKGV4aXQpIGV4aXQoKTsgLy8gQ2FsbCB0aGUgY2FsbGJhY2sgb24gZXhpdFxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBpdGVyYXRpb246ZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHJldHVybiBpbmRleCAtIDE7IC8vIFJldHVybiB0aGUgbG9vcCBudW1iZXIgd2UncmUgb25cbiAgICAgICAgfSxcbiAgICAgICAgYnJlYWs6ZnVuY3Rpb24oZW5kKXtcbiAgICAgICAgICAgIGRvbmUgPSB0cnVlOyAvLyBFbmQgdGhlIGxvb3BcbiAgICAgICAgICAgIHNob3VsZEV4aXQgPSBlbmQ7IC8vIFBhc3NpbmcgZW5kIGFzIHRydWUgbWVhbnMgd2Ugc3RpbGwgY2FsbCB0aGUgZXhpdCBjYWxsYmFja1xuICAgICAgICB9XG4gICAgfTtcbiAgICBsb29wLm5leHQoKTtcbiAgICByZXR1cm4gbG9vcDtcbn07XG5cbmZ1bmN0aW9uIGNvbXBhcmUoc3ViamVjdCwgb3BlcmF0b3IsIHZhbHVlKSB7XG4gIFx0c3dpdGNoIChvcGVyYXRvcikge1xuICBcdFx0Y2FzZSAnZ3JlYXRlclRoYW4nOlxuXHRcdFx0cmV0dXJuIHN1YmplY3QgPiB2YWx1ZTtcblx0XHRjYXNlICdsZXNzVGhhbic6XG5cdFx0XHRyZXR1cm4gc3ViamVjdCA8IHZhbHVlO1xuXHRcdGNhc2UgJ2dyZWF0ZXJUaGFuRXF1YWwnOlxuXHRcdFx0cmV0dXJuIHN1YmplY3QgPj0gdmFsdWU7XG5cdFx0Y2FzZSAnbGVzc1RoYW5FcXVhbCc6XG5cdFx0XHRyZXR1cm4gc3ViamVjdCA8PSB2YWx1ZTtcblx0XHRjYXNlICdlcXVhbFRvJzpcblx0XHRcdHJldHVybiBzdWJqZWN0ID09PSB2YWx1ZTtcblx0XHRjYXNlICdub3RFcXVhbFRvJzpcblx0XHRcdHJldHVybiBzdWJqZWN0ICE9PSB2YWx1ZTtcbiAgXHR9XG59O1xuXG5mdW5jdGlvbiBnZXROYW1lKGFyciwgbGFuZyl7XG5cdGlmIChhcnIgIT09IHVuZGVmaW5lZCkge1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aCA7IGkrKykge1xuXHRcdFx0aWYgKGFycltpXS5pMThuLl9sYW5nID09PSBsYW5nKSB7XG5cdFx0XHRcdHJldHVybiBhcnJbaV0uaTE4bi52YWx1ZTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG5cbiBcdHN1Y2Nlc3M6IHN1Y2Nlc3MsXG4gXHR3YXJuOiB3YXJuLFxuIFx0ZXJyb3I6IGVycm9yLFxuIFx0c3luY0xvb3A6IHN5bmNMb29wLFxuIFx0Y29tcGFyZTogY29tcGFyZSxcblx0Z2V0TmFtZTogZ2V0TmFtZVxuXG4gfVxuIl19
